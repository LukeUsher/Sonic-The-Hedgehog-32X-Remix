00000000                            ;  =========================================================================
00000000                            ; |           Sonic the Hedgehog Disassembly for Sega Mega Drive            |
00000000                            ;  =========================================================================
00000000                            ;
00000000                            ; Disassembly created by Hivebrain
00000000                            ; thanks to drx, Stealth and Esrael L.G. Neto
00000000                            ; ReadySonic modifications by Mercury
00000000                            ; ReadySonic ported to latest SVN by SoullessSentinel
00000000                            ;
00000000                            ; 32X port by SoullessSentinel
00000000                            ; ===========================================================================
00000000                            
00000000                            	include	"(Mercury) Fixes.asm"	;Mercury Fix List
00000000                            ; ELECTIVE MODS
00000000                            ; ================================================================================
00000000                            
00000000                            ; TODO: Hard code these into the rom, make them switchable by Options menu
00000000                            
00000000                            ; Name: Wall Jump
00000000                            ; Function: Gives Sonic a Wall Jump ability
00000000                            ; Date: 2011-02-02 (Feb), 2011-02-03 (Feb), 2011-02-05 (Feb)
00000000                            ; Depends On: Constants, Macros
00000000 =00000001                  WallJumpActive: = 1
00000000                            
00000000                            ; Name: Move Lamppost VRAM
00000000                            ; Function: Moves the Lamppost tiles in VRAM to allow for things like dust or the Insta-Shield to fit instead.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  MoveLamppostVRAM: = 1
00000000                            
00000000                            ; Name: UseDMAQueue
00000000                            ; Function: Uses a DMA queue to load Sonic's art, freeing RAM and allowing Spin Dash dust or the Insta-Shield to function.
00000000                            ; Date: 2011-02-11 (Feb)
00000000                            ; Thanks To: Sonic Retro How-To by (various)
00000000 =00000001                  UseDMAQueue: = 1
00000000                            
00000000                            ; Name: Spin Dash
00000000                            ; Function: Enables the Sonic 2 Spin Dash
00000000                            ; Date: 2011-02-10 (Feb)
00000000                            ; Thanks To: Sonic Retro How-To by (various)
00000000 =00000001                  SpinDashActive: = 1
00000000 =00000001                  	SpinDashDustActive: = SpinDashActive*MoveLamppostVRAM*UseDMAQueue*1	; activates animated dust sprite when Spin Dashing
00000000 =00000001                  	SpinDashCancel: = SpinDashActive*1	; makes Sonic stop Spin Dashing if the A/B/C button is let up for long enough
00000000 =00000001                  	SpinDashNoRevDown: = SpinDashActive*1	; makes the Spin Dash not rev down as long as A/B/C button is held down
00000000 =00000001                  	SpinDashCameraLag: = SpinDashActive*1	; makes the camera lag behind when Sonic launches
00000000                            ; Notes: You should also apply the following fixes to avoid bugs: Walking In Air Fix, Pushing While Walking Fix, High Speed Camera Fix, Caterkiller Fix
00000000                            
00000000                            ; Name: Dash CD
00000000                            ; Function: Enables the Sonic CD Dash (aka Super Peel Out).
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  DashCDActive: = 1
00000000                            
00000000                            ; Name: Balance CD
00000000                            ; Function: Uses the Sonic CD balancing sprites (forward and back) instead of Sonic 1's.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  BalanceCDActive: = 1
00000000                            
00000000                            ; Name: Insta-Shield
00000000                            ; Function: Enables the Sonic 3/K Insta-Shield.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000000                  InstaShieldActive: = 0
00000000                            ; Notes: Not yet functional
00000000                            
00000000                            ; Name: Simple Cheat Entry
00000000                            ; Function: Enters Level Select, Debug Mode, Slow Mo, and extended Sound Test cheats automatically upon U,D,L,R,A,Start
00000000                            ; Date: 2011-02-05 (Feb)
00000000 =00000001                  SimpleCheatEntry: = 1
00000000                            
00000000                            ; Name: Monitor Art Optimise
00000000                            ; Function: Shuffles the Monitor Art in order to free 8 free tiles (useful for modding HUD)
00000000                            ; Date: 2011-02-09 (Feb)
00000000 =00000001                  MonitorArtOptimise: = 1
00000000                            
00000000                            ; Name: HUD Centiseconds
00000000                            ; Function: Adds Sonic CD-style centiseconds to the HUD
00000000                            ; Date: 2011-02-05 (Feb), 2011-02-07 (Feb), 2011-02-09 (Feb)
00000000 =00000001                  HUDCentiseconds: = MonitorArtOptimise*1
00000000                            
00000000                            ; Name: Chunks In ROM
00000000                            ; Function: Loads Chunks (256x256) directly from ROM, freeing a huge amount of RAM ($0000-$A3FF)
00000000                            ; Date: 2011-02-05 (Feb)
00000000                            ; Thanks To: Sonic Retro How-To by FraGag
00000000 =00000001                  ChunksInROM: = 1
00000000                            
00000000                            ; Name: Blocks In ROM
00000000                            ; Function: Similar to "Chunks In ROM" only with Blocks (16x16), freeing a huge amount of RAM ($B000-$C7FF)
00000000                            ; Date: 2011-04-19 (Apr)
00000000 =00000001                  BlocksInROM: = 1
00000000                            
00000000                            ; Name: HUD Has Leading Zeroes
00000000                            ; Function: Gives Rings, Score and Lives leading zeroes (i.e. 001 as opposed to 1)
00000000                            ; Date: 2011-02-09 (Feb)
00000000                            ; Thanks to: Markey Jester
00000000 =00000000                  HUDHasLeadingZeroes: = 0
00000000                            
00000000                            ; Name: TIME/RINGS Flash Fix
00000000                            ; Function: Makes TIME and RINGS words in the HUD flash under the correct circumstances
00000000                            ; Date: 2011-02-07 (Feb), 2011-02-08 (Feb)
00000000                            ; Thanks To: 
00000000 =00000001                  TimeRingsFlashFix: = 1
00000000 =00000001                  	TimeRingsFlashFixNotRed: = TimeRingsFlashFix*1	; when true, "TIME" and "RINGS" will flash on and off instead of flashing red. Useful when changing palettes.
00000000                            
00000000                            ; Name: Dynamic Special Stage Walls 
00000000                            ; Function: Dynamically loads the wall art in the Special Stages to free VRAM (for things like the HUD)
00000000                            ; Date: 2011-02-05 (Feb), 2011-02-06 (Feb), 2011-02-07 (Feb)
00000000 =00000000                  DynamicSpecialStageWalls: = 0
00000000                            
00000000                            ; Name: HUD In Special Stage
00000000                            ; Function: Adds HUD to Special Stage. Also useful for adding a decreasing time limit to Special Stage
00000000                            ; Date: 2011-02-05 (Feb), 2011-02-06 (Feb), 2011-02-07 (Feb), 2011-02-08 (Feb)
00000000                            ; Depends On: Dynamic Special Stage Walls
00000000 =00000000                  HUDInSpecialStage: = DynamicSpecialStageWalls*1
00000000 =00000000                  	HUDInSpecialStageType: = 0	; 0=normal; 1=score not shown; 2=score & time not shown; 3=rings only
00000000                            	
00000000                            ; Name: Time Limit in Special Stage
00000000                            ; Function: If HUDInSpecialStage is active, the Special Stage has a working 9:59 time limit anyway, but this makes it a decreasing one with custom values
00000000                            ; Date: 2011-02-08 (Feb)
00000000                            ; Depends On: Dynamic Special Stage Walls, HUD In Special Stage, Time Rings Flash Fix
00000000 =00000000                  TimeLimitInSpecialStage: = HUDInSpecialStage*TimeRingsFlashFix*1
00000000 =00001E00                  	TimeLimitInSpecialStagePinch: = $00001E00	; "pinch" threshold that time must reach in order to trigger "TIME" to flash. Format: $000MSSCC
00000000 =00010000                  	TimeLimitInSpecialStageStart: = $00010000	; time on the clock to start with when Special Stage is entered. Format: $000MSSCC
00000000                            		;IMPORTANT! TimeLimitInSpecialStageStart must always end in 00,
00000000                            
00000000                            ; Name: Title Screen Palette Fix
00000000                            ; Function: Uses the proper GHZ palette on the Title Screen
00000000                            ; Date: 2011-02-07 (Feb)
00000000 =00000001                  TitleScreenPaletteFix: = 1
00000000                            
00000000                            ; Name: Special Stage Jump Fix
00000000                            ; Function: Gives Sonic variable jump height in the Special Stage to be more fair and consistent with the rest of the game
00000000                            ; Date: 2011-02-07 (Feb)
00000000 =00000001                  SpecialStageJumpFix: = 1
00000000                            
00000000                            ; Name: Warm Palette Mod
00000000                            ; Function: Gives the game a Chaotix-like shine that helps mask the palette changes and update the look
00000000                            ; Date: 2011-02-07 (Feb)
00000000 =00000000                  WarmPaletteMod: = 0
00000000                            ; Notes: Not yet functional.
00000000                            
00000000                            ; Name: Shield Art Mod
00000000                            ; Function: Attempts to improve the look of the shield.
00000000                            ; Date: 2011-02-12 (Feb)
00000000 =00000001                  ShieldArtMod: = 1	; set to 1 to simply make the mirroring less obvious; set to 2 to make it solid, smooth and more like Chaotix's shield art.
00000000                            	; It's not recommended to set this to 2 unless Warm Palette Mod is on.
00000000                            
00000000                            ; Name: Sonic CD Roll Jump
00000000                            ; Function: Makes the Roll Jump work like Sonic CD (Sonic can still control his horizontal trajectory). Frees up a status bit for Sonic.
00000000                            ; Date: 2011-02-09 (Feb)
00000000 =00000001                  SonicCDRollJump: = 1
00000000                            
00000000                            ; Name: Rebound Mod
00000000                            ; Function: Makes rebounding from enemies/monitors after rolling off a cliff onto them function the same as if they were jumped on - the rebound is cut short if the jump button is released.
00000000                            ; Date: 2011-02-12 (Feb)
00000000 =00000001                  ReboundMod: = 1
00000000                            
00000000                            ; Name: Enable Press Start Button Message
00000000                            ; Function: Makes the "Press Start Button" message appear correctly on the Title Screen
00000000                            ; Date: 2011-02-09 (Feb)
00000000 =00000001                  EnablePSBMessage: = 1
00000000                            
00000000                            ; Name: Limit LZ Block Rising Speed
00000000                            ; Function: Limits the rising speed of blocks in LZ so that Sonic can jump off them more comfortably.
00000000                            ; Date: 2011-02-10 (Feb)
00000000 =00000001                  LimitLZBlockRisingSpeed: = 1
00000000                            
00000000                            ; Name: Skip Check Sum Check
00000000                            ; Function: Skips the Check Sum check in order to speed up the game booting, plus frees the 4 bytes of RAM with the 'init' string in them
00000000                            ; Date: 2011-02-10 (Feb)
00000000 =00000001                  SkipCheckSumCheck: = 1
00000000                            
00000000                            ; Name: Speed Up Score Tally
00000000                            ; Function: Allows the player to hold a button to speed up the score tally
00000000                            ; Date: 2011-02-10 (Feb)
00000000 =00000001                  SpeedUpScoreTally: = 1
00000000                            
00000000                            ; Name: Spike SFX Fix
00000000                            ; Function: Makes the proper sound effect play when Sonic is harmed by Spikes/LZ Harpoons.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  SpikeSFXFix: = 1
00000000                            
00000000                            ; Name: Rolling Turn Around Fix
00000000                            ; Function: Prevents Sonic from turning around while rolling (which without this fix could be abused to roll in place forever).
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  RollingTurnAroundFix: = 1
00000000                            
00000000                            ; Name: Scroll Delay
00000000                            ; Function: Adds a delay before the screen begins to scroll when looking up and down. This is essential if adding the Spin Dash or Super Peel Out.
00000000                            ; Date: 2011-02-11 (Feb)
00000000                            ; Thanks To: Sonic Retro How-To by shobiz
00000000 =00000001                  ScrollDelay: = 1
00000000 =00000078                  	ScrollDelayTime: = 120	; number of steps before the screen starts to scroll.
00000000                            	
00000000                            ; Name: Look Shift Fix
00000000                            ; Function: Fixing the looking up/down camera shift so that it stops at zone boundaries, preventing a delay when returning to the neutral position.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  LookShiftFix: = 1
00000000                            
00000000                            ; Name: Spike Fix
00000000                            ; Function: Prevents spikes from harming Sonic while he's flashing.
00000000                            ; Date: 2011-02-11 (Feb)
00000000                            ; Thanks To: Sonic Retro How-To by FraGag
00000000 =00000001                  SpikeFix: = 1
00000000                            
00000000                            ; Name: Caterkiller Fix
00000000                            ; Function: Makes it safe to roll into the caterkiller from the front at high speeds without fear of being hurt some times and not others.
00000000                            ; Date: 2011-02-11 (Feb)
00000000 =00000001                  CaterkillerFix: = 1
00000000                            
00000000                            ; Name: Custom Demo Delay
00000000                            ; Function: Makes it possible to customise how long the Title Screen waits before going to a demo.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000001                  CustomDemoDelay: = 1
00000000 =00000280                  	CustomDemoDelayTime: = $280	; delay until demo is played; default is $178; use -1 for never (will return to Sega Screen eventually, though).
00000000                            
00000000                            ; Name: Orbinaut Animation Tweak
00000000                            ; Function: Makes Orbinaut "notice" Sonic at a closer range so that it's more likely to happen onscreen, and "get angry" quicker.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000001                  OrbinautAnimationTweak: = 1
00000000 =00000080                  	OrbinautAnimationTweakRange: = $80	; horizontal range in pixels at which Sonic is noticed by the Orbinaut
00000000 =00000008                  	OrbinautAnimationTweakSpeed: = $8	; animation speed of the Orbinaut's "getting angry" animation
00000000                            	
00000000                            ; Name: SLZ Orbinaut Behaviour Mod
00000000                            ; Function: Makes the SLZ Orbinauts beatable by giving them behaviour similar to Sonic 4's.
00000000                            ; Date: 2011-03-06 (Mar)
00000000 =00000001                  SLZOrbinautBehaviourMod: = 1
00000000                            	
00000000                            ; Name: Newtron Behaviour Tweak
00000000                            ; Function: Slightly alters the behaviour of Newtrons.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000003                  NewtronBehaviourTweak: = 3
00000000                            	; set to 1 to make red-blue Newtrons vulnerable after they finish appearing but before they land
00000000                            	; set to 2 to make yellow-green Newtrons reappear once Sonic leaves the vicinity and returns
00000000                            	; set to 3 for both of the above
00000000                            
00000000                            ; Name: Lost Rings Flash
00000000                            ; Function: Makes Lost Rings flash before they disappear.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000001                  LostRingsFlash: = 1
00000000 =00000050                  	LostRingsFlashTime: = 80	; number of steps of life the rings need to have left before they start to flash.
00000000                            	
00000000                            ; Name: FZ Boss Invuln Mod
00000000                            ; Function: Allows you to customise the number of steps the FZ Boss's invulnerability lasts.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000001                  FZBossInvulnMod: = 1
00000000 =00000020                  	FZBossInvulnModTime: = $20	; default is $64.
00000000                            
00000000                            ; Name: Disable Speed Cap
00000000                            ; Function: Disables the speed cap in the air and on the ground.
00000000                            ; Date: 2011-03-02 (Mar)
00000000 =00000003                  DisableSpeedCap: = 3
00000000                            	; set to 1 to remove ground speed cap
00000000                            	; set to 2 to remove air speed cap
00000000                            	; set to 3 for both of the above
00000000                            	
00000000                            ; Name: Giant Ring Art Loads With End Sign
00000000                            ; Function: Makes the Giant Ring art load when End Sign's does, avoiding some issues.
00000000                            ; Date: 2011-03-03 (Mar)
00000000                            ; Depends On: MZ2 Layout Fix
00000000 =00000001                  GiantRingArtLoadsWithEndSign: = 1
00000000                            
00000000                            ; Name: Special Stage Index Increases Only If Won
00000000                            ; Function: Makes the Special Stage index not increase when you fail the stage, allowing you to practise the stages more easily because next time you enter one it'll be the same one you failed last time.
00000000                            ; Date: 2011-03-09 (Mar)
00000000 =00000001                  SpecialStageIndexIncreasesOnlyIfWon: = 1
00000000                            
00000000                            ; Name: Special Stages Still Appear With All Emeralds
00000000                            ; Function: Makes the Special Stages still accessible even once all emeralds are collected. Of course more emeralds aren't possible to be collected; they are replaced with Continues, making use of the unused 1-up item in the Special Stages.
00000000                            ; Date: 2011-03-09 (Mar)
00000000 =00000001                  SpecialStagesStillAppearWithAllEmeralds: = 1
00000000                            	
00000000                            ; Name: Giant Rings In SBZ
00000000                            ; Function: Adds Giant Rings (and therefore extra shots at the Special Stage) to SBZ1 and SBZ2.
00000000                            ; Date: 2011-03-03 (Mar)
00000000                            ; Modifies: levels\sbz2.bin, objpos\sbz1.bin, objpos\sbz1 (JP1).bin, objpos\sbz2.bin
00000000 =00000001                  GiantRingsInSBZ: = GiantRingArtLoadsWithEndSign*1
00000000 =000004DA                  	GiantRingsInSBZArtLoc1: = $4DA	; originally $400, this is where the Giant Ring art is loaded into VRAM
00000000 =00000568                  	GiantRingsInSBZArtLoc2: = $568	; originally $518, this is where the SBZ Crumbling Floor art is loaded into VRAM
00000000 =000003A0                  	GiantRingsInSBZArtLoc3: = $3A0	; originally $400, this is where the SBZ Eggman art is loaded into VRAM
00000000 =000004C0                  	GiantRingsInSBZArtLoc4: = $4C0	; originally $4A0, this is where the SBZ Eggman Switch art is loaded into VRAM
00000000                            
00000000                            ; Name: Padding Active
00000000                            ; Function: Pads the ROM with a value until it reaches a certain number of megs
00000000                            ; Date: 2011-02-27 (Feb)
00000000 =00000001                  PaddingActive: = 1
00000000 =000000FF                  	PaddingValue: = $FF
00000000 =00000001                  	PaddingMegs: = 1
00000000                            	
00000000                            ; Name: Quarterloop Fix
00000000                            ; Function: Makes Sonic behave better when running back down quarterloops by using Sonic 2's code.
00000000                            ; Date: 2011-03-15 (Mar)
00000000 =00000001                  QuarterloopFix: = 1
00000000                            
00000000                            ; Name: Magnetic Rings
00000000                            ; Function: Gives Rings ability to be attracted to Sonic while he has a Shield.
00000000                            ; Date: 2011-03-24 (Mar)
00000000 =00000001                  MagneticRings: = 1
00000000                            
00000000                            ; Name:  Rings Bounce At Zone Bottom
00000000                            ; Function: Rings will bounce off of the bottom boundary of the Zone, making SYZ boss more fair.
00000000                            ; Date: 2011-04-19 (Apr)
00000000 =00000001                  RingsBounceAtZoneBottom: = 1
00000000                            
00000000                            ; VARIABLES
00000000                            ; ================================================================================
00000000                            
00000000                            
00000000 =FFFFFEB3                  v_cameralag:	= $FFFFFEB3	; camera lag after launching Spin Dash (1 byte)
00000000                            
00000000 =FFFFFEBE                  v_scrolldelay:	= $FFFFFEBE	; scroll delay timer
00000000                            
00000000 =FFFFFEBF                  v_centstep:	= $FFFFFEBF	; value used to increment centiseconds
00000000                            
00000000                            ; CONSTANTS
00000000                            ; ================================================================================
00000000                            
00000000                            ; Sonic Status Bits
00000000 =00000000                  staFacing:	equ 0
00000000 =00000001                  staAir:		equ 1
00000000 =00000002                  staSpin:	equ 2
00000000 =00000003                  staOnObj:	equ 3
00000000 =00000004                  staRollJump:equ 4
00000000 =00000005                  staPush:	equ 5
00000000 =00000006                  staWater:	equ 6
00000000                            
00000000 =00000001                  staDash:	equ 1
00000000                            
00000000 =00000000                  staSpinDash:	equ 0
00000000                            
00000000                            ; Sonic OST Bytes
00000000 =0000002C                  obWallJump:	equ $2C	; Wall Jump flag
00000000                            			; $2D reserved, as well
00000000 =00000030                  obInvuln:	equ $30	; Invulnerable (blinking) timer
00000000                            			; $31 reserved as well
00000000 =00000032                  obInvinc:	equ $32	; Invincibility timer
00000000                            			; $33 reserved as well
00000000 =00000034                  obShoes:	equ $34	; Speed Shoes timer
00000000                            			; $35 reserved as well
00000000                            			
00000000 =00000036                  obFrontAngle:	equ $36
00000000 =00000037                  obRearAngle:	equ $37
00000000                            			
00000000 =00000038                  obOnWheel:	equ $38	; on convex wheel flag
00000000                            
00000000 =00000039                  obStatus2:	equ $39	; status for abilities such as Spin Dash
00000000                            
00000000 =0000003A                  obRevSpeed:	equ $3A	; rev speed for Spin Dash or Dash
00000000                            			; $3B reserved as well
00000000                            
00000000 =0000003A                  obRestartTimer:	equ $3A ; level restart timer
00000000 =0000003C                  obJumping:	equ $3C	; jumping flag
00000000 =0000003D                  obPlatformID:	equ $3D	; ost slot of the object Sonic's on top of
00000000 =0000003E                  obLRLock:	equ $3E	; flag for preventing left and right input
00000000                            
00000000                            ; MACROS
00000000                            ; ================================================================================
00000000                            
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; SpriteMap macro usage
00000000                            ; l = left coordinate
00000000                            ; t = top coordinate
00000000                            ; w = width (in tiles)
00000000                            ; h = height (in tiles)
00000000                            ; x = horizontal mirroring 1=yes 0=no
00000000                            ; y = vertical mirroring 1=yes 0=no
00000000                            ; pri = priority 1=always on top
00000000                            ; pal = palette index (0...3)
00000000                            ; ind = starting tile index
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            SpriteMap:	macro	l, t, w, h, x, y, pri, pal, ind
00000000                            		dc.b	t
00000000                            		dc.b	(h-1)|((w-1)<<2)
00000000                            		dc.b	(pri<<7)|(pal<<5)|(y<<4)|(x<<3)|(ind>>8)
00000000                            		dc.b	ind&0xFF
00000000                            		dc.b	l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; DynPLC macro usage
00000000                            ; n = number of tiles
00000000                            ; i = starting tile index
00000000                            ; o = offset (optional), i.e. Art_SonicSpinDash-Art_Sonic
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            DynPLC:		macro	n, i, o
00000000                            		if (narg=2)
00000000                            		dc.b	((n-1)<<4)|(i>>8)
00000000                            		dc.b	i&$FF
00000000                            		else
00000000                            		dc.b	((n-1)<<4)|((i+((o)>>5))>>8)
00000000                            		dc.b	(i+((o)>>5))&$FF
00000000                            		endc
00000000                            		endm
00000000                            		endm
00000000                            	include	"Variables.asm"
00000000                            ; Variables (v) and Flags (f)
00000000                            
00000000 =FFFFFC00                  v_regbuffer:			= $FFFFFC00	; stores registers d0-a7 during an error event ($40 bytes)
00000000 =FFFFFC40                  v_spbuffer:				= $FFFFFC40	; stores most recent sp address (4 bytes)
00000000 =FFFFFC44                  v_errortype:			= $FFFFFC44	; error type
00000000                            
00000000 =00FF0000                  v_256x256:				=   $FF0000	; 256x256 tile mappings ($4 bytes bytes)
00000000 =FFFFA400                  v_lvllayout:			= $FFFFA400	; level and background layouts ($400 bytes)
00000000                            
00000000 =FFFFAA00                  v_ngfx_buffer:			= $FFFFAA00	; Nemesis graphics decompression buffer ($200 bytes)
00000000 =FFFFAC00                  v_spritequeue:			= $FFFFAC00	; sprite display queue, in order of priority ($400 bytes)
00000000                            
00000000 =FFFFB000                  ProcessDMAQueue:		= $FFFFB000	; DMA Queue routine (Needs to be here because of RV bit setting
00000000                            
00000000 =FFFFCB00                  v_tracksonic:			= $FFFFCB00	; position tracking data for Sonic ($100 bytes)
00000000 =FFFFCC00                  v_hscrolltablebuffer:	= $FFFFCC00 ; scrolling table data ($400 bytes)
00000000 =FFFFC8FC                  VDP_Command_Buffer_Slot	= $FFFFC8FC	
00000000 =FFFFC800                  VDP_Command_Buffer 		= $FFFFC800
00000000 =FFFFD000                  v_objspace:				= $FFFFD000	; object variable space ($40 bytes per object) ($2000 bytes)
00000000 =FFFFD000                  v_player:				= v_objspace; object variable space for Sonic ($40 bytes)
00000000 =FFFFD800                  v_lvlobjspace:			= $FFFFD800	; level object variable space ($1800 bytes)
00000000                            
00000000                            ; =================================================================================
00000000                            ; From here on, no longer relative to sound driver RAM
00000000                            ; =================================================================================
00000000                            
00000000 =FFFFF600                  v_gamemode:		= $FFFFF600	; game mode (00=Sega; 04=Title; 08=Demo; 0C=Level; 10=SS; 14=Cont; 18=End; 1C=Credit; +8C=PreLevel)
00000000 =FFFFF602                  v_jpadhold2:	= $FFFFF602	; joypad input - held, duplicate
00000000 =FFFFF603                  v_jpadpress2:	= $FFFFF603	; joypad input - pressed, duplicate
00000000 =FFFFF604                  v_jpadhold1:	= $FFFFF604	; joypad input - held
00000000 =FFFFF605                  v_jpadpress1:	= $FFFFF605	; joypad input - pressed
00000000                            
00000000 =FFFFF60C                  v_vdp_buffer1:	= $FFFFF60C	; VDP instruction buffer (2 bytes)
00000000                            
00000000                            
00000000 =FFFFF614                  v_demolength:	= $FFFFF614	; the length of a demo in frames (2 bytes)
00000000 =FFFFF616                  v_scrposy_dup:	= $FFFFF616	; screen position y (duplicate) (2 bytes)
00000000 =FFFFF61A                  v_scrposx_dup:	= $FFFFF61A	; screen position x (duplicate) (2 bytes)
00000000                            
00000000 =FFFFF624                  v_hbla_hreg:	= $FFFFF624	; VDP H.interrupt register buffer (8Axx) (2 bytes)
00000000 =FFFFF625                  v_hbla_line:	= $FFFFF625	; screen line where water starts and palette is changed by HBlank
00000000 =FFFFF626                  v_pfade_start:	= $FFFFF626	; palette fading - start position in bytes
00000000 =FFFFF627                  v_pfade_size:	= $FFFFF627	; palette fading - number of colours
00000000 =FFFFF62A                  v_vbla_routine:	= $FFFFF62A	; VBlank - routine counter
00000000 =FFFFF62C                  v_spritecount:	= $FFFFF62C	; number of sprites on-screen
00000000 =FFFFF632                  v_pcyc_num:		= $FFFFF632	; palette cycling - current reference number (2 bytes)
00000000 =FFFFF634                  v_pcyc_time:	= $FFFFF634	; palette cycling - time until the next change (2 bytes)
00000000 =FFFFF636                  v_random:		= $FFFFF636	; pseudo random number buffer (4 bytes)
00000000 =FFFFF63A                  f_pause:		= $FFFFF63A	; flag set to pause the game (2 bytes)
00000000 =FFFFF640                  v_vdp_buffer2:	= $FFFFF640	; VDP instruction buffer (2 bytes)
00000000 =FFFFF644                  f_hbla_pal:		= $FFFFF644	; flag set to change palette during HBlank (0000 = no; 0001 = change) (2 bytes)
00000000 =FFFFF646                  v_waterpos1:	= $FFFFF646	; water height, actual (2 bytes)
00000000 =FFFFF648                  v_waterpos2:	= $FFFFF648	; water height, ignoring sway (2 bytes)
00000000 =FFFFF64A                  v_waterpos3:	= $FFFFF64A	; water height, next target (2 bytes)
00000000 =FFFFF64C                  f_water:		= $FFFFF64C	; flag set for water
00000000 =FFFFF64D                  v_wtr_routine:	= $FFFFF64D	; water event - routine counter
00000000 =FFFFF64E                  f_wtr_state:	= $FFFFF64E	; water palette state when water is above/below the screen (00 = partly/all dry; 01 = all underwater)
00000000                            
00000000 =FFFFF650                  v_pal_buffer:	= $FFFFF650	; palette data buffer (used for palette cycling) ($30 bytes)
00000000 =FFFFF680                  v_plc_buffer:	= $FFFFF680	; pattern load cues buffer (maximum $10 PLCs) ($60 bytes)
00000000 =FFFFF6E0                  v_ptrnemcode:	= $FFFFF6E0	; pointer for nemesis decompression code ($1502 or $150C) (4 bytes)
00000000                            
00000000 =FFFFF6F8                  f_plc_execute:	= $FFFFF6F8	; flag set for pattern load cue execution (2 bytes)
00000000                            
00000000 =FFFFF700                  v_screenposx:	= $FFFFF700	; screen position x (2 bytes)
00000000 =FFFFF704                  v_screenposy:	= $FFFFF704	; screen position y (2 bytes)
00000000                            
00000000 =FFFFF720                  v_limitleft1:	= $FFFFF720	; left level boundary (2 bytes)
00000000 =FFFFF722                  v_limitright1:	= $FFFFF722	; right level boundary (2 bytes)
00000000 =FFFFF724                  v_limittop1:	= $FFFFF724	; top level boundary (2 bytes)
00000000 =FFFFF726                  v_limitbtm1:	= $FFFFF726	; bottom level boundary (2 bytes)
00000000 =FFFFF728                  v_limitleft2:	= $FFFFF728	; left level boundary (2 bytes)
00000000 =FFFFF72A                  v_limitright2:	= $FFFFF72A	; right level boundary (2 bytes)
00000000 =FFFFF72C                  v_limittop2:	= $FFFFF72C	; top level boundary (2 bytes)
00000000 =FFFFF72E                  v_limitbtm2:	= $FFFFF72E	; bottom level boundary (2 bytes)
00000000                            
00000000 =FFFFF732                  v_limitleft3:	= $FFFFF732	; left level boundary, at the end of an act (2 bytes)
00000000                            
00000000 =FFFFF73A                  v_scrshiftx:	= $FFFFF73A	; screen shift as Sonic moves horizontally
00000000                            
00000000 =FFFFF73E                  v_lookshift:	= $FFFFF73E	; screen shift when Sonic looks up/down (2 bytes)
00000000 =FFFFF742                  v_dle_routine:	= $FFFFF742	; dynamic level event - routine counter
00000000 =FFFFF744                  f_nobgscroll:	= $FFFFF744	; flag set to cancel background scrolling
00000000                            
00000000 =FFFFF754                  v_bgscroll1:	= $FFFFF754	; background scrolling variable 1
00000000 =FFFFF756                  v_bgscroll2:	= $FFFFF756	; background scrolling variable 2
00000000 =FFFFF758                  v_bgscroll3:	= $FFFFF758	; background scrolling variable 3
00000000 =FFFFF75C                  f_bgscrollvert:	= $FFFFF75C	; flag for vertical background scrolling
00000000 =FFFFF760                  v_sonspeedmax:	= $FFFFF760	; Sonic's maximum speed (2 bytes)
00000000 =FFFFF762                  v_sonspeedacc:	= $FFFFF762	; Sonic's acceleration (2 bytes)
00000000 =FFFFF764                  v_sonspeeddec:	= $FFFFF764	; Sonic's deceleration (2 bytes)
00000000 =FFFFF766                  v_sonframenum:	= $FFFFF766	; frame to display for Sonic
00000000 =FFFFF767                  f_sonframechg:	= $FFFFF767	; flag set to update Sonic's sprite frame
00000000 =FFFFF768                  v_anglebuffer:	= $FFFFF768	; angle of collision block that Sonic or object is standing on
00000000                            
00000000 =FFFFF76C                  v_opl_routine:	= $FFFFF76C	; ObjPosLoad - routine counter
00000000 =FFFFF76E                  v_opl_screen:	= $FFFFF76E	; ObjPosLoad - screen variable
00000000 =FFFFF770                  v_opl_data:	= $FFFFF770	; ObjPosLoad - data buffer ($10 bytes)
00000000                            
00000000 =FFFFF780                  v_ssangle:	= $FFFFF780	; Special Stage angle (2 bytes)
00000000 =FFFFF782                  v_ssrotate:	= $FFFFF782	; Special Stage rotation speed (2 bytes)
00000000                            
00000000 =FFFFF790                  v_btnpushtime1:	= $FFFFF790	; button push duration - in level (2 bytes)
00000000 =FFFFF792                  v_btnpushtime2:	= $FFFFF792	; button push duration - in demo (2 bytes)
00000000 =FFFFF794                  v_palchgspeed:	= $FFFFF794	; palette fade/transition speed (0 is fastest) (2 bytes)
00000000 =FFFFF796                  v_collindex:	= $FFFFF796	; ROM address for collision index of current level (4 bytes)
00000000 =FFFFF79A                  v_palss_num:	= $FFFFF79A	; palette cycling in Special Stage - reference number (2 bytes)
00000000 =FFFFF79C                  v_palss_time:	= $FFFFF79C	; palette cycling in Special Stage - time until next change (2 bytes)
00000000                            
00000000 =FFFFF7A4                  v_obj31ypos:	= $FFFFF7A4	; y-position of object 31 (MZ stomper) (2 bytes)
00000000 =FFFFF7A7                  v_bossstatus:	= $FFFFF7A7	; status of boss and prison capsule (01 = boss defeated; 02 = prison opened)
00000000 =FFFFF7A8                  v_trackpos:		= $FFFFF7A8	; position tracking reference number (2 bytes)
00000000 =FFFFF7A9                  v_trackbyte:	= $FFFFF7A9	; low byte for position tracking
00000000 =FFFFF7AA                  f_lockscreen:	= $FFFFF7AA	; flag set to lock screen during bosses
00000000 =FFFFF7AC                  v_256loop1:		= $FFFFF7AC	; 256x256 level tile which contains a loop (GHZ/SLZ)
00000000 =FFFFF7AD                  v_256loop2:		= $FFFFF7AD	; 256x256 level tile which contains a loop (GHZ/SLZ)
00000000 =FFFFF7AE                  v_256roll1:		= $FFFFF7AE	; 256x256 level tile which contains a roll tunnel (GHZ)
00000000 =FFFFF7AF                  v_256roll2:		= $FFFFF7AF	; 256x256 level tile which contains a roll tunnel (GHZ)
00000000 =FFFFF7B0                  v_lani0_frame:	= $FFFFF7B0	; level graphics animation 0 - current frame
00000000 =FFFFF7B1                  v_lani0_time:	= $FFFFF7B1	; level graphics animation 0 - time until next frame
00000000 =FFFFF7B2                  v_lani1_frame:	= $FFFFF7B2	; level graphics animation 1 - current frame
00000000 =FFFFF7B3                  v_lani1_time:	= $FFFFF7B3	; level graphics animation 1 - time until next frame
00000000 =FFFFF7B4                  v_lani2_frame:	= $FFFFF7B4	; level graphics animation 2 - current frame
00000000 =FFFFF7B5                  v_lani2_time:	= $FFFFF7B5	; level graphics animation 2 - time until next frame
00000000 =FFFFF7B6                  v_lani3_frame:	= $FFFFF7B6	; level graphics animation 3 - current frame
00000000 =FFFFF7B7                  v_lani3_time:	= $FFFFF7B7	; level graphics animation 3 - time until next frame
00000000 =FFFFF7B8                  v_lani4_frame:	= $FFFFF7B8	; level graphics animation 4 - current frame
00000000 =FFFFF7B9                  v_lani4_time:	= $FFFFF7B9	; level graphics animation 4 - time until next frame
00000000 =FFFFF7BA                  v_lani5_frame:	= $FFFFF7BA	; level graphics animation 5 - current frame
00000000 =FFFFF7BB                  v_lani5_time:	= $FFFFF7BB	; level graphics animation 5 - time until next frame
00000000 =FFFFF7BE                  v_gfxbigring:	= $FFFFF7BE	; settings for giant ring graphics loading (2 bytes)
00000000 =FFFFF7C0                  f_conveyrev:	= $FFFFF7C0	; flag set to reverse conveyor belts in LZ/SBZ
00000000 =FFFFF7C1                  v_obj63:		= $FFFFF7C1	; object 63 (LZ/SBZ platforms) variables (6 bytes)
00000000 =FFFFF7C7                  f_wtunnelmode:	= $FFFFF7C7	; LZ water tunnel mode
00000000 =FFFFF7C8                  f_lockmulti:	= $FFFFF7C8	; flag set to lock controls, lock Sonic's position & animation
00000000 =FFFFF7C9                  f_wtunnelallow:	= $FFFFF7C9	; LZ water tunnels (00 = enabled; 01 = disabled)
00000000 =FFFFF7CA                  f_jumponly:		= $FFFFF7CA	; flag set to lock controls apart from jumping
00000000 =FFFFF7CB                  v_obj6B:		= $FFFFF7CB	; object 6B (SBZ stomper) variable
00000000 =FFFFF7CC                  f_lockctrl:		= $FFFFF7CC	; flag set to lock controls during ending sequence
00000000 =FFFFF7CD                  f_bigring:		= $FFFFF7CD	; flag set when Sonic collects the giant ring
00000000 =FFFFF7D0                  v_itembonus:	= $FFFFF7D0	; item bonus from broken enemies, blocks etc. (2 bytes)
00000000 =FFFFF7D2                  v_timebonus:	= $FFFFF7D2	; time bonus at the end of an act (2 bytes)
00000000 =FFFFF7D4                  v_ringbonus:	= $FFFFF7D4	; ring bonus at the end of an act (2 bytes)
00000000 =FFFFF7D6                  f_endactbonus:	= $FFFFF7D6	; time/ring bonus update flag at the end of an act
00000000 =FFFFF7D7                  v_sonicend:		= $FFFFF7D7	; routine counter for Sonic in the ending sequence
00000000 =FFFFF7E0                  f_switch:		= $FFFFF7E0	; flags set when Sonic stands on a switch ($10 bytes)
00000000 =FFFFF7F0                  Anim_Counters	= $FFFFF7F0	; $FFFFF7F0-$FFFFF7FF
00000000 =FFFFF800                  v_spritetablebuffer:	= $FFFFF800 ; sprite table ($200 bytes)
00000000 =FFFFFA00                  v_pal_water_dup:	= $FFFFFA00 ; duplicate underwater palette, used for transitions ($80 bytes)
00000000 =FFFFFA80                  v_pal_water:	= $FFFFFA80	; main underwater palette ($80 bytes)
00000000 =FFFFFB00                  v_pal_dry:	= $FFFFFB00	; main palette ($80 bytes)
00000000 =FFFFFB80                  v_pal_dry_dup:	= $FFFFFB80	; duplicate palette, used for transitions ($80 bytes)
00000000 =FFFFFC00                  v_objstate:	= $FFFFFC00	; object state list ($200 bytes)
00000000 =FFFFFE02                  f_restart:	= $FFFFFE02	; restart level flag (2 bytes)
00000000 =FFFFFE04                  v_framecount:	= $FFFFFE04	; frame counter (adds 1 every frame) (2 bytes)
00000000 =FFFFFE05                  v_framebyte:	= v_framecount+1; low byte for frame counter
00000000 =FFFFFE06                  v_debugitem:	= $FFFFFE06	; debug item currently selected (NOT the object number of the item)
00000000 =FFFFFE08                  v_debuguse:	= $FFFFFE08	; debug mode use & routine counter (when Sonic is a ring/item) (2 bytes)
00000000 =FFFFFE0A                  v_debugxspeed:	= $FFFFFE0A	; debug mode - horizontal speed
00000000 =FFFFFE0B                  v_debugyspeed:	= $FFFFFE0B	; debug mode - vertical speed
00000000 =FFFFFE0C                  v_vbla_count:	= $FFFFFE0C	; vertical interrupt counter (adds 1 every VBlank) (4 bytes)
00000000 =FFFFFE0E                  v_vbla_word:	= v_vbla_count+2 ; low word for vertical interrupt counter (2 bytes)
00000000 =FFFFFE0F                  v_vbla_byte:	= v_vbla_word+1	; low byte for vertical interrupt counter
00000000 =FFFFFE10                  v_zone:		= $FFFFFE10	; current zone number
00000000 =FFFFFE11                  v_act:		= $FFFFFE11	; current act number
00000000 =FFFFFE12                  v_lives:	= $FFFFFE12	; number of lives
00000000 =FFFFFE14                  v_air:		= $FFFFFE14	; air remaining while underwater (2 bytes)
00000000 =FFFFFE15                  v_airbyte:	= v_air+1	; low byte for air
00000000 =FFFFFE16                  v_lastspecial:	= $FFFFFE16	; last special stage number
00000000 =FFFFFE18                  v_continues:	= $FFFFFE18	; number of continues
00000000 =FFFFFE1A                  f_timeover:	= $FFFFFE1A	; time over flag
00000000 =FFFFFE1B                  v_lifecount:	= $FFFFFE1B	; lives counter value (for actual number, see "v_lives")
00000000 =FFFFFE1C                  f_lifecount:	= $FFFFFE1C	; lives counter update flag
00000000 =FFFFFE1D                  f_ringcount:	= $FFFFFE1D	; ring counter update flag
00000000 =FFFFFE1E                  f_timecount:	= $FFFFFE1E	; time counter update flag
00000000 =FFFFFE1F                  f_scorecount:	= $FFFFFE1F	; score counter update flag
00000000 =FFFFFE20                  v_rings:	= $FFFFFE20	; rings (2 bytes)
00000000 =FFFFFE21                  v_ringbyte:	= v_rings+1	; low byte for rings
00000000 =FFFFFE22                  v_time:		= $FFFFFE22	; time (4 bytes)
00000000 =FFFFFE23                  v_timemin:	= $FFFFFE23	; time - minutes
00000000 =FFFFFE24                  v_timesec:	= $FFFFFE24	; time - seconds
00000000 =FFFFFE25                  v_timecent:	= $FFFFFE25	; time - centiseconds
00000000 =FFFFFE26                  v_score:	= $FFFFFE26	; score (4 bytes)
00000000 =FFFFFE2C                  v_shield:	= $FFFFFE2C	; shield status (00 = no; 01 = yes)
00000000 =FFFFFE2D                  v_invinc:	= $FFFFFE2D	; invinciblity status (00 = no; 01 = yes)
00000000 =FFFFFE2E                  v_shoes:	= $FFFFFE2E	; speed shoes status (00 = no; 01 = yes)
00000000 =FFFFFE30                  v_lastlamp:	= $FFFFFE30	; number of the last lamppost you hit
00000000 =FFFFFE32                  v_lamp_xpos:	= v_lastlamp+2	; x-axis for Sonic to respawn at lamppost (2 bytes)
00000000 =FFFFFE34                  v_lamp_ypos:	= v_lastlamp+4	; y-axis for Sonic to respawn at lamppost (2 bytes)
00000000 =FFFFFE36                  v_lamp_rings:	= v_lastlamp+6	; rings stored at lamppost (2 bytes)
00000000 =FFFFFE38                  v_lamp_time:	= v_lastlamp+8	; time stored at lamppost (2 bytes)
00000000 =FFFFFE3C                  v_lamp_dle:	= v_lastlamp+$C	; dynamic level event routine counter at lamppost
00000000 =FFFFFE3E                  v_lamp_limitbtm:= v_lastlamp+$E	; level bottom boundary at lamppost (2 bytes)
00000000 =FFFFFE40                  v_lamp_scrx:	= v_lastlamp+$10 ; x-axis screen at lamppost (2 bytes)
00000000 =FFFFFE42                  v_lamp_scry:	= v_lastlamp+$12 ; y-axis screen at lamppost (2 bytes)
00000000                            
00000000 =FFFFFE50                  v_lamp_wtrpos:	= v_lastlamp+$20 ; water position at lamppost (2 bytes)
00000000 =FFFFFE52                  v_lamp_wtrrout:	= v_lastlamp+$22 ; water routine at lamppost
00000000 =FFFFFE53                  v_lamp_wtrstat:	= v_lastlamp+$23 ; water state at lamppost
00000000 =FFFFFE54                  v_lamp_lives:	= v_lastlamp+$24 ; lives counter at lamppost
00000000 =FFFFFE57                  v_emeralds:		= $FFFFFE57	; number of chaos emeralds
00000000 =FFFFFE58                  v_emldlist:		= $FFFFFE58	; which individual emeralds you have (00 = no; 01 = yes) (6 bytes)
00000000 =FFFFFE5E                  v_oscillate:	= $FFFFFE5E	; values which oscillate - for swinging platforms, et al ($42 bytes)
00000000                            
00000000 =FFFFFEC0                  v_ani0_time:	= $FFFFFEC0	; synchronised sprite animation 0 - time until next frame (used for synchronised animations)
00000000 =FFFFFEC1                  v_ani0_frame:	= $FFFFFEC1	; synchronised sprite animation 0 - current frame
00000000 =FFFFFEC2                  v_ani1_time:	= $FFFFFEC2	; synchronised sprite animation 1 - time until next frame
00000000 =FFFFFEC3                  v_ani1_frame:	= $FFFFFEC3	; synchronised sprite animation 1 - current frame
00000000 =FFFFFEC4                  v_ani2_time:	= $FFFFFEC4	; synchronised sprite animation 2 - time until next frame
00000000 =FFFFFEC5                  v_ani2_frame:	= $FFFFFEC5	; synchronised sprite animation 2 - current frame
00000000 =FFFFFEC6                  v_ani3_time:	= $FFFFFEC6	; synchronised sprite animation 3 - time until next frame
00000000 =FFFFFEC7                  v_ani3_frame:	= $FFFFFEC7	; synchronised sprite animation 3 - current frame
00000000 =FFFFFEC8                  v_ani3_buf:		= $FFFFFEC8	; synchronised sprite animation 3 - info buffer (2 bytes)
00000000 =FFFFFEF0                  v_limittopdb:	= $FFFFFEF0	; level upper boundary, buffered for debug mode (2 bytes)
00000000 =FFFFFEF2                  v_limitbtmdb:	= $FFFFFEF2	; level bottom boundary, buffered for debug mode (2 bytes)
00000000                            
00000000 =FFFFFF80                  v_levseldelay:	= $FFFFFF80	; level select - time until change when up/down is held (2 bytes)
00000000 =FFFFFF82                  v_levselitem:	= $FFFFFF82	; level select - item selected (2 bytes)
00000000 =FFFFFF84                  v_levselsound:	= $FFFFFF84	; level select - sound selected (2 bytes)
00000000 =FFFFFF8C                  v_optionsbox:	= $FFFFFF8C
00000000 =FFFFFFC0                  v_scorecopy:	= $FFFFFFC0	; score, duplicate (4 bytes)
00000000 =FFFFFFC0                  v_scorelife:	= $FFFFFFC0	; points required for an extra life (4 bytes) (JP1 only)
00000000 =FFFFFFE0                  f_levselcheat:	= $FFFFFFE0	; level select cheat flag
00000000 =FFFFFFE1                  f_slomocheat:	= $FFFFFFE1	; slow motion & frame advance cheat flag
00000000 =FFFFFFE2                  f_debugcheat:	= $FFFFFFE2	; debug mode cheat flag
00000000 =FFFFFFE3                  f_creditscheat:	= $FFFFFFE3	; hidden credits & press start cheat flag
00000000 =FFFFFFE4                  v_title_dcount:	= $FFFFFFE4	; number of times the d-pad is pressed on title screen (2 bytes)
00000000 =FFFFFFE6                  v_title_ccount:	= $FFFFFFE6	; number of times C is pressed on title screen (2 bytes)
00000000                            
00000000 =FFFFFFF0                  f_demo:			= $FFFFFFF0	; demo mode flag (0 = no; 1 = yes; $8001 = ending) (2 bytes)
00000000 =FFFFFFF2                  v_demonum:		= $FFFFFFF2	; demo level number (not the same as the level number) (2 bytes)
00000000 =FFFFFFF4                  v_creditsnum:	= $FFFFFFF4	; credits index number (2 bytes)
00000000 =FFFFFFF8                  v_megadrive:	= $FFFFFFF8	; Megadrive machine type
00000000 =FFFFFFFA                  f_debugmode:	= $FFFFFFFA	; debug mode flag (sometimes 2 bytes)
00000000 =FFFFFFFC                  v_init:			= $FFFFFFFC	; 'init' text string (4 bytes)
00000000 =FFFFFFFC                  v_init:			= $FFFFFFFC	; 'init' text string (4 bytes)
00000000                            	include	"Constants.asm"
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; Constants
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            ; SMPS Control Registers
00000000 =00A01BA8                  zPalFlag:		equ $A01BA8
00000000 =00A01BA9                  zTempoSpeedup:		equ $A01BA9
00000000 =00A01BAA                  zMusicNumber:		equ $A01BAA			
00000000 =00A01BAB                  zSFXNumber0:		equ $A01BAB			
00000000 =00A01BAC                  zSFXNumber1:		equ $A01BAC				
00000000 =00A01BAD                  zPauseFlag:		equ $A01BAD
00000000                            
00000000                            ; 32X Control Registers
00000000 =00A15000                  MARS_BASE:		equ $A15000
00000000 =00A15100                  MARS_CONTROL:		equ $A15100
00000000 =00A15102                  MARS_INT_CTRL:		equ $A15102
00000000 =00A15104                  MARS_ROM_BANK:		equ $A15104
00000000 =00A15106                  MARS_DREQ_CTRL:		equ $A15106
00000000 =00A15108                  MARS_DREQ_SRC:		equ $A15108
00000000 =00A1510C                  MARS_DREQ_DEST:		equ $A1510C
00000000 =00A15110                  MARS_DREQ_LENGTH:	equ $A15110
00000000 =00A15112                  MARS_FIFO:		equ $A15112
00000000 =00A1511A                  MARS_SEGA_TV:		equ $A1511A
00000000                            
00000000                            ; Communication Registers
00000000 =00A15120                  MARS_SYS_COMM0:		equ $A15120
00000000 =00A15122                  MARS_SYS_COMM2:		equ $A15122
00000000 =00A15124                  MARS_SYS_COMM4:		equ $A15124
00000000 =00A15126                  MARS_SYS_COMM6:		equ $A15126
00000000 =00A15128                  MARS_SYS_COMM8:		equ $A15128
00000000 =00A1512A                  MARS_SYS_COMMA:		equ $A1512A
00000000 =00A1512C                  MARS_SYS_COMMC:		equ $A1512C
00000000 =00A1512E                  MARS_SYS_COMME:		equ $A1512E
00000000                            
00000000                            ; PWM Registers
00000000 =00A15130                  MARS_PWM_CTRL:		equ $A15130
00000000 =00A15132                  MARS_PWM_CYCLE:		equ $A15132
00000000 =00A15134                  MARS_LEFT_PULSE:	equ $A15134
00000000 =00A15136                  MARS_RIGHT_PULSE:	equ $A15136
00000000 =00A15138                  MARS_MONO_PULSE:	equ $A15138
00000000                            
00000000 =00006978                  Size_of_SegaPCM:	equ $6978
00000000                            
00000000                            ; VDP addressses
00000000 =00C00000                  vdp_data_port:		equ $C00000
00000000 =00C00004                  vdp_control_port:	equ $C00004
00000000 =00C00008                  vdp_counter:		equ $C00008
00000000                            
00000000 =00C00011                  psg_input:		equ $C00011
00000000                            
00000000                            ; Z80 addresses
00000000 =00A00000                  z80_ram:		equ $A00000	; start of Z80 RAM
00000000 =00A000EA                  z80_dac3_pitch:		equ $A000EA
00000000 =00A01FFD                  z80_dac_status:		equ $A01FFD
00000000 =00A01FFF                  z80_dac_sample:		equ $A01FFF
00000000 =00A02000                  z80_ram_end:		equ $A02000	; end of non-reserved Z80 RAM
00000000 =00A10001                  z80_version:		equ $A10001
00000000 =00A10002                  z80_port_1_data:	equ $A10002
00000000 =00A10008                  z80_port_1_control:	equ $A10008
00000000 =00A1000A                  z80_port_2_control:	equ $A1000A
00000000 =00A1000C                  z80_expansion_control:	equ $A1000C
00000000 =00A11100                  z80_bus_request:	equ $A11100
00000000 =00A11200                  z80_reset:		equ $A11200
00000000 =00A04000                  ym2612_a0: 		equ $A04000
00000000 =00A04001                  ym2612_d0: 		equ $A04001
00000000 =00A04002                  ym2612_a1: 		equ $A04002
00000000 =00A04003                  ym2612_d1: 		equ $A04003
00000000                            
00000000 =00A14000                  security_addr:		equ $A14000
00000000                            
00000000                            ; VRAM data
00000000 =0000C000                  vram_fg:		equ $C000	; foreground namespace
00000000 =0000E000                  vram_bg:		equ $E000	; background namespace
00000000 =0000F000                  vram_sonic:		equ $F000	; Sonic graphics
00000000 =0000F800                  vram_sprites:		equ $F800	; sprite table
00000000 =0000FC00                  vram_hscroll:		equ $FC00	; horizontal scroll table
00000000                            
00000000                            ; Game modes
00000000                            id_Sega:		equ ptr_GM_Sega-GameModeArray		; $00
00000000                            id_Title:		equ ptr_GM_Title-GameModeArray		; $04
00000000                            id_Demo:		equ ptr_GM_Demo-GameModeArray		; $08
00000000                            id_Level:		equ ptr_GM_Level-GameModeArray		; $0C
00000000                            id_Special:		equ ptr_GM_Special-GameModeArray	; $10
00000000                            id_Continue:		equ ptr_GM_Cont-GameModeArray		; $14
00000000                            id_Ending:		equ ptr_GM_Ending-GameModeArray		; $18
00000000                            id_Credits:		equ ptr_GM_Credits-GameModeArray	; $1C
00000000                            id_LevelSelect:		equ ptr_GM_LevelSelect-GameModeArray	; $20
00000000                            id_Options:		equ ptr_GM_Options-GameModeArray 	; $24
00000000                            id_SaveScreen:		equ ptr_GM_SaveScreen-GameModeArray 	; $28
00000000                            
00000000                            ; Levels
00000000 =00000000                  id_GHZ:		equ 0
00000000 =00000001                  id_LZ:		equ 1
00000000 =00000002                  id_MZ:		equ 2
00000000 =00000003                  id_SLZ:		equ 3
00000000 =00000004                  id_SYZ:		equ 4
00000000 =00000005                  id_SBZ:		equ 5
00000000 =00000006                  id_EndZ:	equ 6
00000000                            id_SS:		equ ZoneCount	; 7 by default
00000000                            
00000000                            ; Colours
00000000 =00000000                  cBlack:		equ $000		; colour black
00000000 =00000EEE                  cWhite:		equ $EEE		; colour white
00000000 =00000E00                  cBlue:		equ $E00		; colour blue
00000000 =000000E0                  cGreen:		equ $0E0		; colour green
00000000 =0000000E                  cRed:		equ $00E		; colour red
00000000 =000000EE                  cYellow:	equ cGreen+cRed		; colour yellow
00000000 =00000EE0                  cAqua:		equ cGreen+cBlue	; colour aqua
00000000 =00000E0E                  cMagenta:	equ cBlue+cRed		; colour magenta
00000000                            
00000000                            ; Joypad input
00000000 =00000080                  btnStart:	equ %10000000 ; Start button	($80)
00000000 =00000040                  btnA:		equ %01000000 ; A		($40)
00000000 =00000020                  btnC:		equ %00100000 ; C		($20)
00000000 =00000010                  btnB:		equ %00010000 ; B		($10)
00000000 =00000008                  btnR:		equ %00001000 ; Right		($08)
00000000 =00000004                  btnL:		equ %00000100 ; Left		($04)
00000000 =00000002                  btnDn:		equ %00000010 ; Down		($02)
00000000 =00000001                  btnUp:		equ %00000001 ; Up		($01)
00000000 =0000000F                  btnDir:		equ %00001111 ; Any direction	($0F)
00000000 =00000070                  btnABC:		equ %01110000 ; A, B or C	($70)
00000000 =00000007                  bitStart:	equ 7
00000000 =00000006                  bitA:		equ 6
00000000 =00000005                  bitC:		equ 5
00000000 =00000004                  bitB:		equ 4
00000000 =00000003                  bitR:		equ 3
00000000 =00000002                  bitL:		equ 2
00000000 =00000001                  bitDn:		equ 1
00000000 =00000000                  bitUp:		equ 0
00000000                            
00000000                            ; Object variables
00000000 =00000001                  obRender:	equ 1	; bitfield for x/y flip, display mode
00000000 =00000002                  obGfx:		equ 2	; palette line & VRAM setting (2 bytes)
00000000 =00000004                  obMap:		equ 4	; mappings address (4 bytes)
00000000 =00000008                  obX:		equ 8	; x-axis position (2-4 bytes)
00000000 =0000000A                  obScreenY:	equ $A	; y-axis position for screen-fixed items (2 bytes)
00000000 =0000000C                  obY:		equ $C	; y-axis position (2-4 bytes)
00000000 =00000010                  obVelX:		equ $10	; x-axis velocity (2 bytes)
00000000 =00000012                  obVelY:		equ $12	; y-axis velocity (2 bytes)
00000000 =00000014                  obInertia:	equ $14	; potential speed (2 bytes)
00000000 =00000016                  obHeight:	equ $16	; height/2
00000000 =00000017                  obWidth:	equ $17	; width/2
00000000 =00000018                  obPriority:	equ $18	; sprite stack priority -- 0 is front
00000000 =00000019                  obActWid:	equ $19	; action width
00000000 =0000001A                  obFrame:	equ $1A	; current frame displayed
00000000 =0000001B                  obAniFrame:	equ $1B	; current frame in animation script
00000000 =0000001C                  obAnim:		equ $1C	; current animation
00000000 =0000001D                  obNextAni:	equ $1D	; next animation
00000000 =0000001E                  obTimeFrame:	equ $1E	; time to next frame
00000000 =0000001F                  obDelayAni:	equ $1F	; time to delay animation
00000000 =00000020                  obColType:	equ $20	; collision response type
00000000 =00000021                  obColProp:	equ $21	; collision extra property
00000000 =00000022                  obStatus:	equ $22	; orientation or mode
00000000 =00000023                  obRespawnNo:	equ $23	; respawn list index number
00000000 =00000024                  obRoutine:	equ $24	; routine number
00000000 =00000025                  ob2ndRout:	equ $25	; secondary routine number
00000000 =00000026                  obAngle:	equ $26	; angle
00000000 =00000028                  obSubtype:	equ $28	; object subtype
00000000 =00000025                  obSolid:	equ ob2ndRout ; solid status flag
00000000                            
00000000                            ; Animation flags
00000000 =000000FF                  afEnd:		equ $FF	; return to beginning of animation
00000000 =000000FE                  afBack:		equ $FE	; go back (specified number) bytes
00000000 =000000FD                  afChange:	equ $FD	; run specified animation
00000000 =000000FC                  afRoutine:	equ $FC	; increment routine counter
00000000 =000000FB                  afReset:	equ $FB	; reset animation and 2nd object routine counter
00000000 =000000FA                  af2ndRoutine:	equ $FA	; increment 2nd routine counter
00000000                            
00000000                            ; Background music
00000000 =00000001                  bgm_GHZ:	equ $01
00000000 =00000002                  bgm_LZ:		equ $02
00000000 =00000003                  bgm_MZ:		equ $03
00000000 =00000004                  bgm_SLZ:	equ $04
00000000 =00000005                  bgm_SYZ:	equ $05
00000000 =00000006                  bgm_SBZ:	equ $06
00000000 =00000007                  bgm_Invincible:	equ $07
00000000 =00000008                  bgm_ExtraLife:	equ $08
00000000 =00000009                  bgm_SS:		equ $09
00000000 =0000000A                  bgm_Title:	equ $0A
00000000 =0000000B                  bgm_Ending:	equ $0B
00000000 =0000000C                  bgm_Boss:	equ $0C
00000000 =0000000D                  bgm_FZ:		equ $0D
00000000 =0000000E                  bgm_GotThrough:	equ $0E
00000000 =0000000F                  bgm_GameOver:	equ $0F
00000000 =00000010                  bgm_Continue:	equ $10
00000000 =00000011                  bgm_Credits:	equ $11
00000000 =00000012                  bgm_Drowning:	equ $12
00000000 =00000013                  bgm_Emerald:	equ $13
00000000 =000000E1                  bgm_Fade:	equ $E1
00000000 =000000E1                  bgm_Stop:	equ $E1
00000000                            
00000000                            ; Sound effects
00000000 =00000062                  sfx_Jump:	equ $62
00000000 =00000063                  sfx_Lamppost:	equ $63
00000000 =000000A2                  sfx_A2:		equ $A2
00000000 =00000035                  sfx_Death:	equ $35
00000000 =00000036                  sfx_Skid:	equ $36
00000000 =000000A5                  sfx_A5:		equ $A5
00000000 =00000037                  sfx_HitSpikes:	equ $37
00000000 =00000069                  sfx_Push:	equ $69
00000000 =0000006A                  sfx_SSGoal:	equ $6A
00000000 =0000006B                  sfx_SSItem:	equ $6B
00000000 =0000006C                  sfx_Splash:	equ $6C
00000000 =000000AB                  sfx_AB:		equ $AB
00000000 =0000006E                  sfx_HitBoss:	equ $6E
00000000 =00000038                  sfx_Bubble:	equ $38
00000000 =00000070                  sfx_Fireball:	equ $70
00000000 =00000071                  sfx_Shield:	equ $71
00000000 =000000D8                  sfx_Saw:	equ $D8
00000000 =00000079                  sfx_Electric:	equ $79
00000000 =0000003B                  sfx_Drown:	equ $3B
00000000 =00000048                  sfx_Flamethrower:equ $48
00000000 =000000AA                  sfx_Bumper:	equ $AA
00000000 =00000033                  sfx_Ring:	equ $33
00000000 =00000052                  sfx_SpikesMove:	equ $52
00000000 =0000006F                  sfx_Rumbling:	equ $6F
00000000 =000000B8                  sfx_B8:		equ $B8
00000000 =00000059                  sfx_Collapse:	equ $59
00000000 =000000B5                  sfx_SSGlass:	equ $B5
00000000 =0000006D                  sfx_Door:	equ $6D
00000000 =00000073                  sfx_Teleport:	equ $73
00000000 =0000005F                  sfx_ChainStomp:	equ $5F
00000000 =0000003C                  sfx_Roll:	equ $3C
00000000 =000000AC                  sfx_Continue:	equ $AC
00000000 =00000047                  sfx_Basaran:	equ $47
00000000 =0000003D                  sfx_BreakItem:	equ $3D
00000000 =000000A9                  sfx_Warning:	equ $A9
00000000 =000000B3                  sfx_GiantRing:	equ $B3
00000000 =000000B4                  sfx_Bomb:	equ $B4
00000000 =000000B0                  sfx_Cash:	equ $B0
00000000 =000000B9                  sfx_RingLoss:	equ $B9
00000000 =000000D2                  sfx_ChainRise:	equ $D2
00000000 =000000D5                  sfx_Burning:	equ $D5
00000000 =0000008C                  sfx_Bonus:	equ $8C
00000000 =000000AF                  sfx_EnterSS:	equ $AF
00000000 =00000059                  sfx_WallSmash:	equ $59
00000000 =000000B1                  sfx_Spring:	equ $B1
00000000 =0000005B                  sfx_Switch:	equ $5B
00000000 =00000034                  sfx_RingLeft:	equ $34
00000000 =000000CF                  sfx_Signpost:	equ $CF
00000000 =000000DB                  sfx_Waterfall:	equ $DB
00000000 =000000FF                  sfx_Sega:	equ $FF
00000000 =000000AB                  sfx_SpinDash:	equ $AB
00000000 =000000B6                  sfx_SpinRelease:equ $B6
00000000 =000000B6                  sfx_SpinRelease:equ $B6
00000000                            	include	"Macros.asm"
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; Align and pad
00000000                            ; input: length to align to, value to use as padding (default is 0)
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            align:	macro
00000000                            	if (narg=1)
00000000                            	dcb.b \1-(*%\1),0
00000000                            	else
00000000                            	dcb.b \1-(*%\1),\2
00000000                            	endc
00000000                            	endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; Set a VRAM address via the VDP control port.
00000000                            ; input: 16-bit VRAM address, control port (default is ($C00004).l)
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            locVRAM:	macro loc,controlport
00000000                            		if (narg=1)
00000000                            		move.l	#($40000000+((loc&$3FFF)<<16)+((loc&$C000)>>14)),(vdp_control_port).l
00000000                            		else
00000000                            		move.l	#($40000000+((loc&$3FFF)<<16)+((loc&$C000)>>14)),controlport
00000000                            		endc
00000000                            		endm
00000000                            
00000000                            locVRAMd0:	macro loc
00000000                            		move.l	#($40000000+((loc&$3FFF)<<16)+((loc&$C000)>>14)),d0
00000000                            		endm
00000000                            		
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; DMA copy data from 68K (ROM/RAM) to the VRAM
00000000                            ; input: source, length, destination
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            writeVRAM:	macro
00000000                            		lea	(vdp_control_port).l,a5
00000000                            		move.l	#$94000000+(((\2>>1)&$FF00)<<8)+$9300+((\2>>1)&$FF),(a5)
00000000                            		move.l	#$96000000+(((\1>>1)&$FF00)<<8)+$9500+((\1>>1)&$FF),(a5)
00000000                            		move.w	#$9700+((((\1>>1)&$FF0000)>>16)&$7F),(a5)
00000000                            		move.w	#$4000+(\3&$3FFF),(a5)
00000000                            		move.w	#$80+((\3&$C000)>>14),(v_vdp_buffer2).w
00000000                            		move.w	(v_vdp_buffer2).w,(a5)
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; DMA copy data from 68K (ROM/RAM) to the CRAM
00000000                            ; input: source, length, destination
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            writeCRAM:	macro
00000000                            		lea	(vdp_control_port).l,a5
00000000                            		move.l	#$94000000+(((\2>>1)&$FF00)<<8)+$9300+((\2>>1)&$FF),(a5)
00000000                            		move.l	#$96000000+(((\1>>1)&$FF00)<<8)+$9500+((\1>>1)&$FF),(a5)
00000000                            		move.w	#$9700+((((\1>>1)&$FF0000)>>16)&$7F),(a5)
00000000                            		move.w	#$C000+(\3&$3FFF),(a5)
00000000                            		move.w	#$80+((\3&$C000)>>14),(v_vdp_buffer2).w
00000000                            		move.w	(v_vdp_buffer2).w,(a5)
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; DMA fill VRAM with a value
00000000                            ; input: value, length, destination
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            fillVRAM:	macro value,length,loc
00000000                            		lea	(vdp_control_port).l,a5
00000000                            		move.w	#$8F01,(a5)
00000000                            		move.l	#$94000000+((length&$FF00)<<8)+$9300+(length&$FF),(a5)
00000000                            		move.w	#$9780,(a5)
00000000                            		move.l	#$40000080+((loc&$3FFF)<<16)+((loc&$C000)>>14),(a5)
00000000                            		move.w	#value,(vdp_data_port).l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; Copy a tilemap from 68K (ROM/RAM) to the VRAM without using DMA
00000000                            ; input: source, destination, width [cells], height [cells]
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            copyTilemap:	macro source,loc,width,height
00000000                            		lea	(source).l,a1
00000000                            		move.l	#$40000000+((loc&$3FFF)<<16)+((loc&$C000)>>14),d0
00000000                            		moveq	#width,d1
00000000                            		moveq	#height,d2
00000000                            		bsr.w	TilemapToVRAM
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; stop the Z80
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            stopZ80:	macro
00000000                            		move.w	#$100,(z80_bus_request).l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; wait for Z80 to stop
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            waitZ80:	macro
00000000                            	@wait:	btst	#0,(z80_bus_request).l
00000000                            		bne.s	@wait
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; reset the Z80
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            resetZ80:	macro
00000000                            		move.w	#$100,(z80_reset).l
00000000                            		endm
00000000                            
00000000                            resetZ80a:	macro
00000000                            		move.w	#0,(z80_reset).l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; start the Z80
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            startZ80:	macro
00000000                            		move.w	#0,(z80_bus_request).l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; disable interrupts
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            disable_ints:	macro
00000000                            		move	#$2700,sr
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; enable interrupts
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            enable_ints:	macro
00000000                            		move	#$2300,sr
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; long conditional jumps
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            jhi:		macro loc
00000000                            		bls.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jcc:		macro loc
00000000                            		bcs.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jhs:		macro loc
00000000                            		jcc	loc
00000000                            		endm
00000000                            
00000000                            jls:		macro loc
00000000                            		bhi.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jcs:		macro loc
00000000                            		bcc.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jlo:		macro loc
00000000                            		jcs	loc
00000000                            		endm
00000000                            
00000000                            jeq:		macro loc
00000000                            		bne.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jne:		macro loc
00000000                            		beq.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jgt:		macro loc
00000000                            		ble.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jge:		macro loc
00000000                            		blt.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jle:		macro loc
00000000                            		bgt.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jlt:		macro loc
00000000                            		bge.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jpl:		macro loc
00000000                            		bmi.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            jmi:		macro loc
00000000                            		bpl.s	@nojump
00000000                            		jmp	loc
00000000                            	@nojump:
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; check if object moves out of range
00000000                            ; input: location to jump to if out of range, x-axis pos (obX(a0) by default)
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            out_of_range:	macro exit,pos
00000000                            		if (narg=2)
00000000                            		move.w	pos,d0		; get object position (if specified as not obX)
00000000                            		else
00000000                            		move.w	obX(a0),d0	; get object position
00000000                            		endc
00000000                            		andi.w	#$FF80,d0	; round down to nearest $80
00000000                            		move.w	(v_screenposx).w,d1 ; get screen position
00000000                            		subi.w	#128,d1
00000000                            		andi.w	#$FF80,d1
00000000                            		sub.w	d1,d0		; approx distance between object and screen
00000000                            		cmpi.w	#128+320+192,d0
00000000                            		bhi.\0	exit
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; play a sound effect or music
00000000                            ; input: track, terminate routine (leave blank to not terminate)
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            music:		macro track,terminate
00000000                            		move.w	#track,d0
00000000                            		if (narg=1)
00000000                            		jsr	(PlaySound).l
00000000                            		else
00000000                            		jmp	(PlaySound).l
00000000                            		endc
00000000                            		endm
00000000                            
00000000                            sfx:		macro track,terminate
00000000                            		move.w	#track,d0
00000000                            		if (narg=1)
00000000                            		jsr	(PlaySound_Special).l
00000000                            		else
00000000                            		jmp	(PlaySound_Special).l
00000000                            		endc
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; bankswitch between SRAM and ROM
00000000                            ; (remember to enable SRAM in the header first!)
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            gotoSRAM:	macro
00000000                            		move.b  #1,($A130F1).l
00000000                            		endm
00000000                            
00000000                            gotoROM:	macro
00000000                            		move.b  #0,($A130F1).l
00000000                            		endm
00000000                            
00000000                            ; ---------------------------------------------------------------------------
00000000                            ; compare the size of an index with ZoneCount constant
00000000                            ; (should be used immediately after the index)
00000000                            ; input: index address, element size
00000000                            ; ---------------------------------------------------------------------------
00000000                            
00000000                            zonewarning:	macro loc,elementsize
00000000                            	@end:
00000000                            		if (@end-loc)-(ZoneCount*elementsize)<>0
00000000                            		inform 1,"Size of \loc ($%h) does not match ZoneCount ($\#ZoneCount).",(@end-loc)/elementsize
00000000                            		endc
00000000                            		endm
00000000                            		endm
00000000                            
00000000 =00000001                  EnableSRAM:	= 1	; change to 1 to enable SRAM
00000000 =00000001                  BackupSRAM:	= 1
00000000 =00000003                  AddressSRAM:	= 3	; 0 = odd+even; 2 = even only; 3 = odd only
00000000                            
00000000 =00000001                  Revision:	= 1	; change to 1 for JP1 revision
00000000                            
00000000 =00000007                  ZoneCount:	= 7	; discrete zones are: GHZ, MZ, SYZ, LZ, SLZ, SBZ and Ending
00000000                            
00000000                            ; ===========================================================================
00000000                            
00000000                            StartOfRom:
00000000 0000 0000 0000 0000 0000+  		dc.l $0000000,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
00000020 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
00000040 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
00000060 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
00000080 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
000000A0 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
000000C0 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
000000E0 0000 0000 0000 0000 0000+  		dc.l ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS,ICD_MARS
00000100                            		
00000100 5345 4741 204D 4547 4120+  		dc.b "SEGA MEGA DRIVE " 					; Hardware system ID
00000110 2843 2953 4547 4120 3139+  		dc.b "(C)SEGA 1991.APR" 					; Release date
00000120 534F 4E49 4320 5448 4520+  		dc.b "SONIC THE HEDGEHOG 32X REMIX                    "	 	; Domestic name
00000150 534F 4E49 4320 5448 4520+  		dc.b "SONIC THE HEDGEHOG 32X REMIX                    "	 	; International name
00000180 474D 2030 3030 3034 3034+  		dc.b "GM 00004049-01"						; Version
0000018E 0000                       		dc.w 0								; Checksum
00000190 4A20 2020 2020 2020 2020+  		dc.b "J               " 					; I/O support
000001A0 0000 0000                  		dc.l StartOfRom							; ROM start
000001A4 0000 0000                  		dc.l EndOfRom-$02200000						; ROM end
000001A8 00FF 0000                  		dc.l $FF0000							; RAM start
000001AC 00FF FFFF                  		dc.l $FFFFFF							; RAM end
000001B0                            		
000001B0 5241 F820                  		dc.b $52, $41, $A0+(BackupSRAM<<6)+(AddressSRAM<<3), $20	
000001B4 0020 0001                  		dc.l $200001							; SRAM start 	($200001)
000001B8 0020 3FFF                  		dc.l $203FFF							; SRAM end 	($203FFF)
000001BC 2020 2020 2020 2020 2020+  		dc.b "                                                    "	; Notes
000001F0 4A55 4520 2020 2020 2020+  		dc.b "JUE             " 					; Region
00000200                            		
00000200                            ; ---------------------------------------------------------------------------
00000200                            ; Exception Vectors
00000200                            ; ---------------------------------------------------------------------------
00000200 4EF9 0000 0000             		jmp	(Init32X).l		; Reset
00000206 4EF9 0000 0000             		jmp	(BusError).l		; Bus Error
0000020C 4EF9 0000 0000             		jmp	(AddressError).l	; Address Error
00000212 4EF9 0000 0000             		jmp	(IllegalInstr).l	; Illegal Instruction
00000218 4EF9 0000 0000             		jmp	(ZeroDivide).l		; Divide by Zero
0000021E 4EF9 0000 0000             		jmp	(ChkInstr).l		; CHK Instruction
00000224 4EF9 0000 0000             		jmp	(TrapvInstr).l		; TRAPV Instruction
0000022A 4EF9 0000 0000             		jmp	(PrivilegeViol).l	; Privilege Violation
00000230 4EF9 0000 0000             		jmp	(Trace).l		; Trace
00000236 4EF9 0000 0000             		jmp	(Line1010Emu).l		; LINE 1010
0000023C 4EF9 0000 0000             		jmp	(Line1111Emu).l		; LINE 1111
00000242 0000 0000 0000 0000 0000+  		ds.w	36
0000028A 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Spurious Interrupt
00000290 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Level 1 Interrupt
00000296 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Level 2 Interrupt
0000029C 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Level 3 Interrupt
000002A2 4EF9 0000 0000             		jmp	(HBlank).l		; Level 4 Interrupt (HBLANK)
000002A8 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Level 5 Interrupt
000002AE 4EF9 0000 0000             		jmp	(VBlank).l		; Level 6 Interrupt (V-Blank)
000002B4 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Level 7 Interrupt
000002BA 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #0
000002C0 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #1
000002C6 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #2
000002CC 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #3
000002D2 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #4
000002D8 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #5
000002DE 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #6
000002E4 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #7
000002EA 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #8
000002F0 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #9
000002F6 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #10
000002FC 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #11
00000302 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #12
00000308 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #13
0000030E 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #14
00000314 4EF9 0000 0000             		jmp	(ErrorTrap).l		; Trap #15
0000031A 0000 0000 0000 0000 0000+  		ds.w	$53
000003C0                            	
000003C0                            ; ---------------------------------------------------------------------------
000003C0                            ; SH2 Setup data
000003C0                            ; ---------------------------------------------------------------------------	
000003C0                            MarsInitHeader:
000003C0 4D41 5253 2047 414D 4520+  		dc.b	"MARS GAME       "		; Module name
000003D0 0000 0000                  		dc.l	$00000000				; Version
000003D4                            	
000003D4 0000 0000                  		dc.l	SH2_BINARY				; Source address
000003D8 0000 0000                  		dc.l	$00000000				; Destination address (SH2 memory)
000003DC 0000 0000                  		dc.l	SH2_END-SH2_BINARY		; Size
000003E0                            	
000003E0 0600 0240                  		dc.l	$06000240				; M-SH2 entry point
000003E4 0600 0244                  		dc.l	$06000244				; S-SH2 entry point
000003E8                            	
000003E8 0600 0000                  		dc.l	$06000000				; M-SH2 VBR address
000003EC 0600 0120                  		dc.l	$06000120				; S-SH2 VBR address
000003F0                            	
000003F0                            ; ---------------------------------------------------------------------------
000003F0                            ; 32X IPL/Security code
000003F0                            ; ---------------------------------------------------------------------------	
000003F0                            ICD_MARS:
000003F0 287C FFFF FFC0 23FC 0000+  		dc.w	$287C,$FFFF,$FFC0,$23FC,$0000,$0000,$00A1,$5128
00000400 46FC 2700 4BF9 00A1 0000+  		dc.w	$46FC,$2700,$4BF9,$00A1,$0000,$7001,$0CAD,$4D41
00000410 5253 30EC 6600 03E6 082D+  		dc.w	$5253,$30EC,$6600,$03E6,$082D,$0007,$5101,$67F8
00000420 4AAD 0008 6710 4A6D 000C+  		dc.w	$4AAD,$0008,$6710,$4A6D,$000C,$670A,$082D,$0000
00000430 5101 6600 03B8 102D 0001+  		dc.w	$5101,$6600,$03B8,$102D,$0001,$0200,$000F,$6706
00000440 2B78 055A 4000 7200 2C41+  		dc.w	$2B78,$055A,$4000,$7200,$2C41,$4E66,$41F9,$0000
00000450 04D4 6100 0152 6100 0176+  		dc.w	$04D4,$6100,$0152,$6100,$0176,$47F9,$0000,$04E8
00000460 43F9 00A0 0000 45F9 00C0+  		dc.w	$43F9,$00A0,$0000,$45F9,$00C0,$0011,$3E3C,$0100
00000470 7000 3B47 1100 3B47 1200+  		dc.w	$7000,$3B47,$1100,$3B47,$1200,$012D,$1100,$66FA
00000480 7425 12DB 51CA FFFC 3B40+  		dc.w	$7425,$12DB,$51CA,$FFFC,$3B40,$1200,$3B40,$1100
00000490 3B47 1200 149B 149B 149B+  		dc.w	$3B47,$1200,$149B,$149B,$149B,$149B,$41F9,$0000
000004A0 04C0 43F9 00FF 0000 22D8+  		dc.w	$04C0,$43F9,$00FF,$0000,$22D8,$22D8,$22D8,$22D8
000004B0 22D8 22D8 22D8 22D8 41F9+  		dc.w	$22D8,$22D8,$22D8,$22D8,$41F9,$00FF,$0000,$4ED0
000004C0 1B7C 0001 5101 41F9 0000+  		dc.w	$1B7C,$0001,$5101,$41F9,$0000,$06BC,$D1FC,$0088
000004D0 0000 4ED0 0404 303C 076C+  		dc.w	$0000,$4ED0,$0404,$303C,$076C,$0000,$0000,$FF00
000004E0 8137 0002 0100 0000 AF01+  		dc.w	$8137,$0002,$0100,$0000,$AF01,$D91F,$1127,$0021
000004F0 2600 F977 EDB0 DDE1 FDE1+  		dc.w	$2600,$F977,$EDB0,$DDE1,$FDE1,$ED47,$ED4F,$D1E1
00000500 F108 D9C1 D1E1 F1F9 F3ED+  		dc.w	$F108,$D9C1,$D1E1,$F1F9,$F3ED,$5636,$E9E9,$9FBF
00000510 DFFF 4D41 5253 2049 6E69+  		dc.w	$DFFF,$4D41,$5253,$2049,$6E69,$7469,$616C,$2026
00000520 2053 6563 7572 6974 7920+  		dc.w	$2053,$6563,$7572,$6974,$7920,$5072,$6F67,$7261
00000530 6D20 2020 2020 2020 2020+  		dc.w	$6D20,$2020,$2020,$2020,$2020,$2043,$6172,$7472
00000540 6964 6765 2056 6572 7369+  		dc.w	$6964,$6765,$2056,$6572,$7369,$6F6E,$2020,$2020
00000550 436F 7079 7269 6768 7420+  		dc.w	$436F,$7079,$7269,$6768,$7420,$5345,$4741,$2045
00000560 4E54 4552 5052 4953 4553+  		dc.w	$4E54,$4552,$5052,$4953,$4553,$2C4C,$5444,$2E20
00000570 3139 3934 2020 2020 2020+  		dc.w	$3139,$3934,$2020,$2020,$2020,$2020,$2020,$2020
00000580 2020 2020 2020 2020 2020+  		dc.w	$2020,$2020,$2020,$2020,$2020,$2020,$2020,$2020
00000590 2020 2020 2020 524F 4D20+  		dc.w	$2020,$2020,$2020,$524F,$4D20,$5665,$7273,$696F
000005A0 6E20 312E 3000 48E7 C040+  		dc.w	$6E20,$312E,$3000,$48E7,$C040,$43F9,$00C0,$0004
000005B0 3011 303C 8000 323C 0100+  		dc.w	$3011,$303C,$8000,$323C,$0100,$3E3C,$0012,$1018
000005C0 3280 D041 51CF FFF8 4CDF+  		dc.w	$3280,$D041,$51CF,$FFF8,$4CDF,$0203,$4E75,$48E7
000005D0 81C0 41F9 0000 063E 43F9+  		dc.w	$81C0,$41F9,$0000,$063E,$43F9,$00C0,$0004,$3298
000005E0 3298 3298 3298 3298 3298+  		dc.w	$3298,$3298,$3298,$3298,$3298,$3298,$2298,$3341
000005F0 FFFC 3011 0800 0001 66F8+  		dc.w	$FFFC,$3011,$0800,$0001,$66F8,$3298,$3298,$7000
00000600 22BC C000 0000 7E0F 3340+  		dc.w	$22BC,$C000,$0000,$7E0F,$3340,$FFFC,$3340,$FFFC
00000610 3340 FFFC 3340 FFFC 51CF+  		dc.w	$3340,$FFFC,$3340,$FFFC,$51CF,$FFEE,$22BC,$4000
00000620 0010 7E09 3340 FFFC 3340+  		dc.w	$0010,$7E09,$3340,$FFFC,$3340,$FFFC,$3340,$FFFC
00000630 3340 FFFC 51CF FFEE 4CDF+  		dc.w	$3340,$FFFC,$51CF,$FFEE,$4CDF,$0381,$4E75,$8114
00000640 8F01 93FF 94FF 9500 9600+  		dc.w	$8F01,$93FF,$94FF,$9500,$9600,$9780,$4000,$0080
00000650 8104 8F02 48E7 C140 43F9+  		dc.w	$8104,$8F02,$48E7,$C140,$43F9,$00A1,$5180,$08A9
00000660 0007 FF80 66F8 3E3C 00FF+  		dc.w	$0007,$FF80,$66F8,$3E3C,$00FF,$7000,$7200,$337C
00000670 00FF 0004 3341 0006 3340+  		dc.w	$00FF,$0004,$3341,$0006,$3340,$0008,$4E71,$0829
00000680 0001 000B 66F8 0641 0100+  		dc.w	$0001,$000B,$66F8,$0641,$0100,$51CF,$FFE8,$4CDF
00000690 0283 4E75 48E7 8180 41F9+  		dc.w	$0283,$4E75,$48E7,$8180,$41F9,$00A1,$5200,$08A8
000006A0 0007 FF00 66F8 3E3C 001F+  		dc.w	$0007,$FF00,$66F8,$3E3C,$001F,$20C0,$20C0,$20C0
000006B0 20C0 51CF FFF6 4CDF 0181+  		dc.w	$20C0,$51CF,$FFF6,$4CDF,$0181,$4E75,$41F9,$00FF
000006C0 0000 3E3C 07FF 7000 20C0+  		dc.w	$0000,$3E3C,$07FF,$7000,$20C0,$20C0,$20C0,$20C0
000006D0 20C0 20C0 20C0 20C0 51CF+  		dc.w	$20C0,$20C0,$20C0,$20C0,$51CF,$FFEE,$3B7C,$0000
000006E0 1200 7E0A 51CF FFFE 43F9+  		dc.w	$1200,$7E0A,$51CF,$FFFE,$43F9,$00A1,$5100,$7000
000006F0 2340 0020 2340 0024 1B7C+  		dc.w	$2340,$0020,$2340,$0024,$1B7C,$0003,$5101,$2E79
00000700 0088 0000 0891 0007 66FA+  		dc.w	$0088,$0000,$0891,$0007,$66FA,$7000,$3340,$0002
00000710 3340 0004 3340 0006 2340+  		dc.w	$3340,$0004,$3340,$0006,$2340,$0008,$2340,$000C
00000720 3340 0010 3340 0030 3340+  		dc.w	$3340,$0010,$3340,$0030,$3340,$0032,$3340,$0038
00000730 3340 0080 3340 0082 08A9+  		dc.w	$3340,$0080,$3340,$0082,$08A9,$0000,$008B,$66F8
00000740 6100 FF12 08E9 0000 008B+  		dc.w	$6100,$FF12,$08E9,$0000,$008B,$67F8,$6100,$FF06
00000750 08A9 0000 008B 6100 FF3C+  		dc.w	$08A9,$0000,$008B,$6100,$FF3C,$303C,$0040,$2229
00000760 0020 0C81 5351 4552 6700+  		dc.w	$0020,$0C81,$5351,$4552,$6700,$0092,$303C,$0080
00000770 2229 0020 0C81 5344 4552+  		dc.w	$2229,$0020,$0C81,$5344,$4552,$6700,$0080,$21FC
00000780 0088 02A2 0070 303C 0002+  		dc.w	$0088,$02A2,$0070,$303C,$0002,$7200,$122D,$0001
00000790 1429 0080 E14A 8242 0801+  		dc.w	$1429,$0080,$E14A,$8242,$0801,$000F,$660A,$0801
000007A0 0006 6700 0058 6008 0801+  		dc.w	$0006,$6700,$0058,$6008,$0801,$0006,$6600,$004E
000007B0 7020 41F9 0088 0000 3C28+  		dc.w	$7020,$41F9,$0088,$0000,$3C28,$018E,$4A46,$6700
000007C0 0010 3429 0028 0C42 0000+  		dc.w	$0010,$3429,$0028,$0C42,$0000,$67F6,$B446,$662C
000007D0 7000 2340 0028 2340 002C+  		dc.w	$7000,$2340,$0028,$2340,$002C,$3E14,$2C7C,$FFFF
000007E0 FFC0 4CD6 7FF9 44FC 0000+  		dc.w	$FFC0,$4CD6,$7FF9,$44FC,$0000,$6014,$43F9,$00A1
000007F0 5100 3340 0006 303C 8000+  		dc.w	$5100,$3340,$0006,$303C,$8000,$6004,$44FC,$0001
00000800 4EF9 0000 0000             		jmp		Init32X
00000806                            ICD_MARS_END:
00000806                            
00000806                            	OBJ $880000+ICD_MARS_END
00880806                            ; ===========================================================================
00880806                            
00880806                            ErrorTrap:
00880806 4E71                       		nop	
00880808 4E71                       		nop	
0088080A 60FA                       		bra.s	ErrorTrap
0088080C                            ; ===========================================================================
0088080C                            
0088080C                            Init32X:
0088080C 41F9 00A1 5000             		lea     MARS_BASE,a0
00880812                            		
00880812                            @waitformaster
00880812 2028 0120                  		move.l  0x0120(a0), d0
00880816 0C80 4D5F 4F4B             		cmpi.l  #"M_OK", d0 
0088081C 66F4                       		bne.b   @waitformaster
0088081E                            @waitforslave
0088081E 2028 0124                  		move.l  0x0124(a0), d0
00880822 0C80 535F 4F4B             		cmpi.l  #"S_OK", d0  
00880828 66F4                       		bne.b   @waitforslave
0088082A                            
0088082A 41F9 00A1 5000             		lea     MARS_BASE,a0
00880830                            										
00880830 7000                       		moveq   #0,d0
00880832 2140 0120                  		move.l  d0,0x0120(a0)           ; Tell Master SH2 we can continue
00880836 2140 0124                  		move.l  d0,0x0124(a0)           ; Same for Slaves
0088083A                            
0088083A 33FC 0001 00A1 5104        		move.w 	#1, MARS_ROM_BANK		
00880842                            
00880842                            InitMD:
00880842 4FF9 00FF FE00             		lea	($FFFE00).l,a7		; Set the stack pointer
00880848                            
00880848 1039 00A1 0001             		move.b	(z80_version).l,d0
0088084E 0200 00C0                  		andi.b	#$C0,d0
00880852 11C0 FFF8                  		move.b	d0,(v_megadrive).w 	; get region setting
00880856                            
00880856                            GameInit:
00880856 6100 0000                  		bsr.w	VDPSetupGame
0088085A 6100 0000                  		bsr.w	SoundDriverLoad
0088085E 6100 0000                  		bsr.w	JoypadInit
00880862 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; set Game Mode to Sega Screen
00880868                            
00880868                            MainGameLoop:
00880868 1038 F600                  		move.b	(v_gamemode).w,d0 	; load Game Mode
0088086C 0240 001C                  		andi.w	#$1C,d0
00880870 4EBB 0000                  		jsr	GameModeArray(pc,d0.w) ; jump to apt location in ROM
00880874 60F2                       		bra.s	MainGameLoop
00880876                            ; ===========================================================================
00880876                            ; ---------------------------------------------------------------------------
00880876                            ; Main game mode array
00880876                            ; ---------------------------------------------------------------------------
00880876                            
00880876                            GameModeArray:
00880876                            
00880876                            ptr_GM_Sega:	
00880876 6000 0000                  		bra.w	GM_Sega		; Sega Screen ($00)
0088087A                            ptr_GM_Title:	
0088087A 6000 0000                  		bra.w	GM_Title	; Title	Screen ($04)
0088087E                            ptr_GM_Demo:	
0088087E 6000 0000                  		bra.w	GM_Level	; Demo Mode ($08)
00880882                            ptr_GM_Level:	
00880882 6000 0000                  		bra.w	GM_Level	; Normal Level ($0C)
00880886                            ptr_GM_Special:	
00880886 6000 0000                  		bra.w	GM_Special	; Special Stage	($10)
0088088A                            ptr_GM_Cont:	
0088088A 6000 0000                  		bra.w	GM_Continue	; Continue Screen ($14)
0088088E                            ptr_GM_Ending:	
0088088E 6000 0000                  		bra.w	GM_Ending	; End of game sequence ($18)
00880892                            ptr_GM_Credits:	
00880892 6000 0000                  		bra.w	GM_Credits	; Credits ($1C)
00880896 4E75                       		rts		
00880898                            ; ===========================================================================
00880898                            
00880898                            BusError:
00880898 4EF9 0088 0806             		jmp	ErrorTrap
0088089E 11FC 0002 FC44             		move.b	#2,(v_errortype).w
008808A4 6000 0000                  		bra.w	ErrorHandler
008808A8                            
008808A8                            AddressError:
008808A8 4EF9 0088 0806             		jmp	ErrorTrap
008808AE 11FC 0004 FC44             		move.b	#4,(v_errortype).w
008808B4 6000 0000                  		bra.w	ErrorHandler
008808B8                            
008808B8                            IllegalInstr:
008808B8 4EF9 0088 0806             		jmp	ErrorTrap
008808BE 11FC 0006 FC44             		move.b	#6,(v_errortype).w
008808C4 54AF 0002                  		addq.l	#2,2(sp)
008808C8 6000 0000                  		bra.w	loc_462
008808CC                            
008808CC                            ZeroDivide:
008808CC 4EF9 0088 0806             		jmp	ErrorTrap
008808D2 11FC 0008 FC44             		move.b	#8,(v_errortype).w
008808D8 6000 0000                  		bra.w	loc_462
008808DC                            
008808DC                            ChkInstr:
008808DC 4EF9 0088 0806             		jmp	ErrorTrap
008808E2 11FC 000A FC44             		move.b	#$A,(v_errortype).w
008808E8 6000 0000                  		bra.w	loc_462
008808EC                            
008808EC                            TrapvInstr:
008808EC 4EF9 0088 0806             		jmp	ErrorTrap
008808F2 11FC 000C FC44             		move.b	#$C,(v_errortype).w
008808F8 6000 0000                  		bra.w	loc_462
008808FC                            
008808FC                            PrivilegeViol:
008808FC 4EF9 0088 0806             		jmp	ErrorTrap
00880902 11FC 000E FC44             		move.b	#$E,(v_errortype).w
00880908 6000 0000                  		bra.w	loc_462
0088090C                            
0088090C                            Trace:
0088090C 4EF9 0088 0806             		jmp	ErrorTrap
00880912 11FC 0010 FC44             		move.b	#$10,(v_errortype).w
00880918 6000 0000                  		bra.w	loc_462
0088091C                            
0088091C                            Line1010Emu:
0088091C 4EF9 0088 0806             		jmp	ErrorTrap
00880922 11FC 0012 FC44             		move.b	#$12,(v_errortype).w
00880928 54AF 0002                  		addq.l	#2,2(sp)
0088092C 6000 0000                  		bra.w	loc_462
00880930                            
00880930                            Line1111Emu:
00880930 4EF9 0088 0806             		jmp	ErrorTrap
00880936 11FC 0014 FC44             		move.b	#$14,(v_errortype).w
0088093C 54AF 0002                  		addq.l	#2,2(sp)
00880940 6000 0000                  		bra.w	loc_462
00880944                            
00880944                            ErrorExcept:
00880944 4EF9 0088 0806             		jmp	ErrorTrap
0088094A 11FC 0000 FC44             		move.b	#0,(v_errortype).w
00880950 6000 0000                  		bra.w	loc_462
00880954                            ; ==========================================================================
00880954                            
00880954                            ErrorHandler:
00880954 46FC 2700                  		disable_ints
00880958 544F                       		addq.w	#2,sp
0088095A 21DF FC40                  		move.l	(sp)+,(v_spbuffer).w
0088095E 544F                       		addq.w	#2,sp
00880960 48F8 FFFF FC00             		movem.l	d0-a7,(v_regbuffer).w
00880966 6100 0000                  		bsr.w	ShowErrorMessage
0088096A 202F 0002                  		move.l	2(sp),d0
0088096E 6100 0000                  		bsr.w	ShowErrorValue
00880972 2038 FC40                  		move.l	(v_spbuffer).w,d0
00880976 6100 0000                  		bsr.w	ShowErrorValue
0088097A 6000                       		bra.s	loc_478
0088097C                            ; ===========================================================================
0088097C                            
0088097C                            loc_462:
0088097C 46FC 2700                  		disable_ints
00880980 48F8 FFFF FC00             		movem.l	d0-a7,(v_regbuffer).w
00880986 6100 0000                  		bsr.w	ShowErrorMessage
0088098A 202F 0002                  		move.l	2(sp),d0
0088098E 6100 0000                  		bsr.w	ShowErrorValue
00880992                            
00880992                            loc_478:
00880992 6100 0000                  		bsr.w	ErrorWaitForC
00880996 4CF8 FFFF FC00             		movem.l	(v_regbuffer).w,d0-a7
0088099C 46FC 2300                  		enable_ints
008809A0 4E73                       		rte	
008809A2                            
008809A2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008809A2                            
008809A2                            
008809A2                            ShowErrorMessage:
008809A2 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
008809B2 41F9 0000 0000             		lea	(Art_Text).l,a0
008809B8 323C 027F                  		move.w	#$27F,d1
008809BC                            	@loadgfx:
008809BC 3C98                       		move.w	(a0)+,(a6)
008809BE 51C9 FFFC                  		dbf	d1,@loadgfx
008809C2                            
008809C2 7000                       		moveq	#0,d0		; clear	d0
008809C4 1038 FC44                  		move.b	(v_errortype).w,d0 ; load error code
008809C8 303B 0000                  		move.w	ErrorText(pc,d0.w),d0
008809CC 41FB 0000                  		lea	ErrorText(pc,d0.w),a0
008809DA 7212                       		moveq	#$12,d1		; number of characters (minus 1)
008809DC                            
008809DC                            	@showchars:
008809DC 7000                       		moveq	#0,d0
008809DE 1018                       		move.b	(a0)+,d0
008809E0 0640 0790                  		addi.w	#$790,d0
008809E4 3C80                       		move.w	d0,(a6)
008809E6 51C9 FFF4                  		dbf	d1,@showchars	; repeat for number of characters
008809EA 4E75                       		rts	
008809EC                            ; End of function ShowErrorMessage
008809EC                            
008809EC                            ; ===========================================================================
008809EC                            ErrorText:	
008809EC 0000 0000                  		dc.w @exception-ErrorText, @bus-ErrorText
008809F0 0000 0000                  		dc.w @address-ErrorText, @illinstruct-ErrorText
008809F4 0000 0000                  		dc.w @zerodivide-ErrorText, @chkinstruct-ErrorText
008809F8 0000 0000                  		dc.w @trapv-ErrorText, @privilege-ErrorText
008809FC 0000 0000                  		dc.w @trace-ErrorText, @line1010-ErrorText
00880A00 0000                       		dc.w @line1111-ErrorText
00880A02                            			
00880A02 4552 524F 5220 4558 4345+  @exception:	dc.b "ERROR EXCEPTION    "
00880A15 4255 5320 4552 524F 5220+  @bus:		dc.b "BUS ERROR          "
00880A28 4144 4452 4553 5320 4552+  @address:	dc.b "ADDRESS ERROR      "
00880A3B 494C 4C45 4741 4C20 494E+  @illinstruct:	dc.b "ILLEGAL INSTRUCTION"
00880A4E 4045 524F 2044 4956 4944+  @zerodivide:	dc.b "@ERO DIVIDE        "
00880A61 4348 4B20 494E 5354 5255+  @chkinstruct:	dc.b "CHK INSTRUCTION    "
00880A74 5452 4150 5620 494E 5354+  @trapv:		dc.b "TRAPV INSTRUCTION  "
00880A87 5052 4956 494C 4547 4520+  @privilege:	dc.b "PRIVILEGE VIOLATION"
00880A9A 5452 4143 4520 2020 2020+  @trace:		dc.b "TRACE              "
00880AAD 4C49 4E45 2031 3031 3020+  @line1010:	dc.b "LINE 1010 EMULATOR "
00880AC0 4C49 4E45 2031 3131 3120+  @line1111:	dc.b "LINE 1111 EMULATOR "
00880AD4 00                         		even
00880AD4                            
00880AD4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00880AD4                            
00880AD4                            
00880AD4                            ShowErrorValue:
00880AD4 3CBC 07CA                  		move.w	#$7CA,(a6)	; display "$" symbol
00880AD8 7407                       		moveq	#7,d2
00880ADA                            
00880ADA                            	@loop:
00880ADA E998                       		rol.l	#4,d0
00880ADC 6100                       		bsr.s	@shownumber	; display 8 numbers
00880ADE 51CA FFFA                  		dbf	d2,@loop
00880AE2 4E75                       		rts	
00880AE4                            ; End of function ShowErrorValue
00880AE4                            
00880AE4                            
00880AE4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00880AE4                            
00880AE4                            
00880AE4                            @shownumber:
00880AE4 3200                       		move.w	d0,d1
00880AE6 0241 000F                  		andi.w	#$F,d1
00880AEA 0C41 000A                  		cmpi.w	#$A,d1
00880AEE 6500                       		bcs.s	@chars0to9
00880AF0 5E41                       		addq.w	#7,d1		; add 7 for characters A-F
00880AF2                            
00880AF2                            	@chars0to9:
00880AF2 0641 07C0                  		addi.w	#$7C0,d1
00880AF6 3C81                       		move.w	d1,(a6)
00880AF8 4E75                       		rts	
00880AFA                            ; End of function sub_5CA
00880AFA                            
00880AFA                            
00880AFA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00880AFA                            
00880AFA                            
00880AFA                            ErrorWaitForC:				; XREF: loc_478
00880AFA 6100 0000                  		bsr.w	ReadJoypads
00880AFE 0C38 0020 F605             		cmpi.b	#btnC,(v_jpadpress1).w ; is button C pressed?
00880B04 6600 FFF4                  		bne.w	ErrorWaitForC	; if not, branch
00880B08 4E75                       		rts	
00880B0A                            ; End of function ErrorWaitForC
00880B0A                            
00880B0A                            ; ===========================================================================
00880B0A                            
00880B0A                            Art_Text:	
00880B0A                            		incbin	"artunc\menutext.bin" ; text used in level select and debug mode
0088102A                            		even
0088102A                            
0088102A                            ; ===========================================================================
0088102A                            ; ---------------------------------------------------------------------------
0088102A                            ; Vertical interrupt
0088102A                            ; ---------------------------------------------------------------------------
0088102A                            
0088102A                            VBlank:					; XREF: Vectors
0088102A 48E7 FFFE                  		movem.l	d0-a6,-(sp)
0088102E                            
0088102E                            ; TODO:
0088102E                            		; FIND A MUCH BETTER WAY TO DO THIS
0088102E                            		; THIS USES PRECIOUS VBLANK CYCLES!
0088102E                            		; Lookup table maybe?
0088102E                            		
0088102E                            VBlank_32X:		
0088102E 0C38 0000 F600             		cmpi.b	#id_Title,(v_gamemode).w
00881034 6700                       		beq.s	@Title		
00881036 0C38 0000 F600             		cmpi.b	#id_Continue,(v_gamemode).w
0088103C 6700                       		beq.s	@Continue				
0088103E 0C38 0000 F600             		cmpi.b	#id_Sega,(v_gamemode).w
00881044 6700                       		beq.s	@Sega
00881046 0C38 0000 F600             		cmp.b	#id_Special,(v_gamemode).w
0088104C 6700                       		beq.s	@Special	
0088104E                            		
0088104E 23FC 0060 0020 00C0 0004   		move.l	#$600020,(vdp_control_port).l	;program the control port
00881058 3039 00C0 0000             		move.w	($c00000).l,d0					;get the colour (3,0)		
0088105E                            		
0088105E 6000 0000                  		bra @VBlank_Continue
00881062                            @Sega:
00881062                            @Continue:
00881062 23FC 0000 0020 00C0 0004   		move.l	#$20,(vdp_control_port).l		;program the control port
0088106C 3039 00C0 0000             		move.w	($c00000).l,d0					;get the colour (0,0)		
00881072 6000 0000                  		bra		@VBlank_Continue
00881076                            
00881076                            	
00881076                            @Title:
00881076 23FC 0040 0020 00C0 0004   		move.l	#$400020,(vdp_control_port).l	;program the control port
00881080 3039 00C0 0000             		move.w	($c00000).l,d0					;get the colour (2,0)
00881086 6000 0000                  		bra		@VBlank_Continue
0088108A                            	
0088108A                            @Special:
0088108A 303C 0400                  		move.w	#$0400, d0
0088108E                            			
0088108E                            @VBlank_Continue:
0088108E 33C0 00A1 5122             		move.w	d0, MARS_SYS_COMM2				; Tell 32X background colour	
00881094                            
00881094                            VBlank_MD:
00881094 4A38 F62A                  		tst.b	(v_vbla_routine).w
00881098 6700                       		beq.s	VBla_00
0088109A 3039 00C0 0004             		move.w	(vdp_control_port).l,d0
008810A0 23FC 4000 0010 00C0 0004   		move.l	#$40000010,(vdp_control_port).l
008810AA 23F8 F616 00C0 0000        		move.l	(v_scrposy_dup).w,(vdp_data_port).l ; send screen y-axis pos. to VSRAM
008810B2 0838 0006 FFF8             		btst	#6,(v_megadrive).w 					; is Megadrive PAL?
008810B8 6700                       		beq.s	@notPAL								; if not, branch
008810BA                            
008810BA 303C 0700                  		move.w	#$700,d0
008810BE                            	@waitPAL:
008810BE 51C8 FFFE                  		dbf	d0,@waitPAL
008810C2                            
008810C2                            	@notPAL:
008810C2 1038 F62A                  		move.b	(v_vbla_routine).w,d0
008810C6 11FC 0000 F62A             		move.b	#0,(v_vbla_routine).w
008810CC 31FC 0001 F644             		move.w	#1,(f_hbla_pal).w
008810D2 0240 003E                  		andi.w	#$3E,d0
008810D6 303B 0000                  		move.w	VBla_Index(pc,d0.w),d0
008810DA 4EBB 0000                  		jsr	VBla_Index(pc,d0.w)
008810DE                            
008810DE                            VBla_Exit:				; XREF: VBla_08
008810DE 52B8 FE0C                  		addq.l	#1,(v_vbla_count).w
008810E2 4CDF 7FFF                  		movem.l	(sp)+,d0-a6
008810E6 4E73                       		rte	
008810E8                            ; ===========================================================================
008810E8 0000 0000                  VBla_Index:	dc.w VBla_00-VBla_Index, VBla_02-VBla_Index
008810EC 0000 0000                  		dc.w VBla_04-VBla_Index, VBla_06-VBla_Index
008810F0 0000 0000                  		dc.w VBla_08-VBla_Index, VBla_0A-VBla_Index
008810F4 0000 0000                  		dc.w VBla_0C-VBla_Index, VBla_0E-VBla_Index
008810F8 0000 0000                  		dc.w VBla_10-VBla_Index, VBla_12-VBla_Index
008810FC 0000 0000                  		dc.w VBla_14-VBla_Index, VBla_16-VBla_Index
00881100 0000                       		dc.w VBla_0C-VBla_Index
00881102                            ; ===========================================================================
00881102                            
00881102                            VBla_00:				; XREF: VBlank; VBla_Index
00881102 0C38 0000 F600             		cmpi.b	#$80+id_Level,(v_gamemode).w
00881108 6700                       		beq.s	@islevel
0088110A 0C38 0000 F600             		cmpi.b	#id_Level,(v_gamemode).w ; is game on a level?
00881110 6600 FFCC                  		bne.w	VBla_Exit	; if not, branch
00881114                            
00881114                            	@islevel:
00881114 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; is level LZ ?
0088111A 6600 FFC2                  		bne.w	VBla_Exit	; if not, branch
0088111E                            
0088111E 3039 00C0 0004             		move.w	(vdp_control_port).l,d0
00881124 0838 0006 FFF8             		btst	#6,(v_megadrive).w ; is Megadrive PAL?
0088112A 6700                       		beq.s	@notPAL		; if not, branch
0088112C                            
0088112C 303C 0700                  		move.w	#$700,d0
00881130                            	@waitPAL:
00881130 51C8 FFFE                  		dbf	d0,@waitPAL
00881134                            
00881134                            	@notPAL:
00881134 31FC 0001 F644             		move.w	#1,(f_hbla_pal).w ; set HBlank flag
0088113A                            
0088113A 4A38 F64E                  		tst.b	(f_wtr_state).w	; is water above top of screen?
0088113E 6600                       		bne.s	@waterabove 	; if yes, branch
00881140                            
00881140 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
00881164 6000                       		bra.s	@waterbelow
00881166                            
00881166                            @waterabove:
00881166 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_water,$80,0
0088118A                            
0088118A                            	@waterbelow:
0088118A 3AB8 F624                  		move.w	(v_hbla_hreg).w,(a5)
0088118E 6000 FF4E                  		bra.w	VBla_Exit
00881192                            ; ===========================================================================
00881192                            
00881192                            VBla_02:				; XREF: VBla_Index
00881192 6100 0000                  		bsr.w	sub_106E
00881196                            
00881196                            VBla_14:				; XREF: VBla_Index
00881196 4A78 F614                  		tst.w	(v_demolength).w
0088119A 6700 0000                  		beq.w	@end
0088119E 5378 F614                  		subq.w	#1,(v_demolength).w
008811A2                            
008811A2                            	@end:
008811A2 4E75                       		rts	
008811A4                            ; ===========================================================================
008811A4                            
008811A4                            VBla_04:				; XREF: VBla_Index
008811A4 6100 0000                  		bsr.w	sub_106E
008811A8 6100 0000                  		bsr.w	sub_6886
008811AC 6100 0000                  		bsr.w	sub_1642
008811B0 4A78 F614                  		tst.w	(v_demolength).w
008811B4 6700 0000                  		beq.w	@end
008811B8 5378 F614                  		subq.w	#1,(v_demolength).w
008811BC                            
008811BC                            	@end:
008811BC 4E75                       		rts	
008811BE                            ; ===========================================================================
008811BE                            
008811BE                            VBla_06:				; XREF: VBla_Index
008811BE 6100 0000                  		bsr.w	sub_106E
008811C2 4E75                       		rts	
008811C4                            ; ===========================================================================
008811C4                            
008811C4                            VBla_10:				; XREF: VBla_Index
008811C4 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w ; is game on special stage?
008811CA 6700 0000                  		beq.w	VBla_0A		; if yes, branch
008811CE                            
008811CE                            VBla_08:				; XREF: VBla_Index
008811CE 33FC 0100 00A1 1100        		stopZ80
008811D6 0839 0000 00A1 1100 66F6   		waitZ80
008811E0 6100 0000                  		bsr.w	ReadJoypads
008811E4 4A38 F64E                  		tst.b	(f_wtr_state).w
008811E8 6600                       		bne.s	@waterabove
008811EA                            
008811EA 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
0088120E 6000                       		bra.s	@waterbelow
00881210                            
00881210                            @waterabove:
00881210 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_water,$80,0
00881234                            
00881234                            	@waterbelow:
00881234 3AB8 F624                  		move.w	(v_hbla_hreg).w,(a5)
00881238                            
00881238 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_hscrolltablebuffer,$380,vram_hscroll
0088125C 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_spritetablebuffer,$280,vram_sprites
00881280                            		
00881280 4EB9 FFFF B000             		jsr	(ProcessDMAQueue).l
00881286                            		
00881286                            	@nochg:
00881286 33FC 0000 00A1 1100        		startZ80
0088128E 4CF8 00FF F700             		movem.l	(v_screenposx).w,d0-d7
00881294 48F8 00FF FF10             		movem.l	d0-d7,($FFFFFF10).w
0088129A 4CF8 0003 F754             		movem.l	(v_bgscroll1).w,d0-d1
008812A0 48F8 0003 FF30             		movem.l	d0-d1,($FFFFFF30).w
008812A6 0C38 0060 F625             		cmpi.b	#96,(v_hbla_line).w
008812AC 6400                       		bcc.s	Demo_Time
008812AE 11FC 0001 F64F             		move.b	#1,($FFFFF64F).w
008812B4 588F                       		addq.l	#4,sp
008812B6 6000 FE26                  		bra.w	VBla_Exit
008812BA                            
008812BA                            ; ---------------------------------------------------------------------------
008812BA                            ; Subroutine to	run a demo for an amount of time
008812BA                            ; ---------------------------------------------------------------------------
008812BA                            
008812BA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008812BA                            
008812BA                            
008812BA                            Demo_Time:				; XREF: VBlank; HBlank
008812BA 6100 0000                  		bsr.w	LoadTilesAsYouMove
008812BE 4EB9 0000 0000             		jsr	AnimateLevelGfx
008812C4 4EB9 0000 0000             		jsr	HUD_Update
008812CA 6100 0000                  		bsr.w	sub_165E
008812CE 4A78 F614                  		tst.w	(v_demolength).w ; is there time left on the demo?
008812D2 6700 0000                  		beq.w	@end		; if not, branch
008812D6 5378 F614                  		subq.w	#1,(v_demolength).w ; subtract 1 from time left
008812DA                            
008812DA                            	@end:
008812DA 4E75                       		rts	
008812DC                            ; End of function Demo_Time
008812DC                            
008812DC                            ; ===========================================================================
008812DC                            
008812DC                            VBla_0A:				; XREF: VBla_Index
008812DC 33FC 0100 00A1 1100        		stopZ80
008812E4 0839 0000 00A1 1100 66F6   		waitZ80
008812EE 6100 0000                  		bsr.w	ReadJoypads
008812F2 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
00881316 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_spritetablebuffer,$280,vram_sprites
0088133A 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_hscrolltablebuffer,$380,vram_hscroll
0088135E 33FC 0000 00A1 1100        		startZ80
00881366 6100 0000                  		bsr.w	PalCycle_SS
0088136A                            		
0088136A 4EB9 FFFF B000             		jsr	(ProcessDMAQueue).l
00881370                            		
00881370                            	@nochg:
00881370                            	
00881370                            	
00881370 4A78 F614                  		tst.w	(v_demolength).w
00881374 6700 0000                  		beq.w	@end
00881378 5378 F614                  		subq.w	#1,(v_demolength).w
0088137C                            
0088137C                            	@end:
0088137C 4E75                       		rts	
0088137E                            ; ===========================================================================
0088137E                            
0088137E                            VBla_0C:				; XREF: VBla_Index
0088137E 33FC 0100 00A1 1100        		stopZ80
00881386 0839 0000 00A1 1100 66F6   		waitZ80
00881390 6100 0000                  		bsr.w	ReadJoypads
00881394 4A38 F64E                  		tst.b	(f_wtr_state).w
00881398 6600                       		bne.s	@waterabove
0088139A                            
0088139A 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
008813BE 6000                       		bra.s	@waterbelow
008813C0                            
008813C0                            @waterabove:
008813C0 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_water,$80,0
008813E4                            
008813E4                            	@waterbelow:
008813E4 3AB8 F624                  		move.w	(v_hbla_hreg).w,(a5)
008813E8 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_hscrolltablebuffer,$380,vram_hscroll
0088140C 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_spritetablebuffer,$280,vram_sprites
00881430 4EB9 FFFF B000             		jsr	(ProcessDMAQueue).l
00881436                            		
00881436                            	@nochg:
00881436 33FC 0000 00A1 1100        		startZ80
0088143E 4CF8 00FF F700             		movem.l	(v_screenposx).w,d0-d7
00881444 48F8 00FF FF10             		movem.l	d0-d7,($FFFFFF10).w
0088144A 4CF8 0003 F754             		movem.l	(v_bgscroll1).w,d0-d1
00881450 48F8 0003 FF30             		movem.l	d0-d1,($FFFFFF30).w
00881456 6100 0000                  		bsr.w	LoadTilesAsYouMove
0088145A 4EB9 0000 0000             		jsr	AnimateLevelGfx
00881460 4EB9 0000 0000             		jsr	HUD_Update
00881466 6100 0000                  		bsr.w	sub_1642
0088146A 4E75                       		rts	
0088146C                            ; ===========================================================================
0088146C                            
0088146C                            VBla_0E:				; XREF: VBla_Index
0088146C 6100 0000                  		bsr.w	sub_106E
00881470 5238 F628                  		addq.b	#1,($FFFFF628).w
00881474 11FC 000E F62A             		move.b	#$E,(v_vbla_routine).w
0088147A 4E75                       		rts	
0088147C                            ; ===========================================================================
0088147C                            
0088147C                            VBla_12:				; XREF: VBla_Index
0088147C 6100 0000                  		bsr.w	sub_106E
00881480 3AB8 F624                  		move.w	(v_hbla_hreg).w,(a5)
00881484 6000 0000                  		bra.w	sub_1642
00881488                            ; ===========================================================================
00881488                            
00881488                            VBla_16:				; XREF: VBla_Index
00881488 33FC 0100 00A1 1100        		stopZ80
00881490 0839 0000 00A1 1100 66F6   		waitZ80
0088149A 6100 0000                  		bsr.w	ReadJoypads
0088149E 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
008814C2 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_spritetablebuffer,$280,vram_sprites
008814E6 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_hscrolltablebuffer,$380,vram_hscroll
0088150A 33FC 0000 00A1 1100        		startZ80
00881512 4EB9 FFFF B000             		jsr	(ProcessDMAQueue).l
00881518                            		
00881518                            	@nochg:
00881518                            	
00881518                            	
00881518 4A78 F614                  		tst.w	(v_demolength).w
0088151C 6700 0000                  		beq.w	@end
00881520 5378 F614                  		subq.w	#1,(v_demolength).w
00881524                            
00881524                            	@end:
00881524 4E75                       		rts	
00881526                            
00881526                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881526                            
00881526                            
00881526                            sub_106E:				; XREF: VBla_02; et al
00881526 6100 0000                  		bsr.w	ReadJoypads
0088152A 4A38 F64E                  		tst.b	(f_wtr_state).w ; is water above top of screen?
0088152E 6600                       		bne.s	@waterabove	; if yes, branch
00881530 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_dry,$80,0
00881554 6000                       		bra.s	@waterbelow
00881556                            
00881556                            	@waterabove:
00881556 4BF9 00C0 0004 2ABC 9400+  		writeCRAM	v_pal_water,$80,0
0088157A                            
0088157A                            	@waterbelow:
0088157A 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_spritetablebuffer,$280,vram_sprites
0088159E 4BF9 00C0 0004 2ABC 9401+  		writeVRAM	v_hscrolltablebuffer,$380,vram_hscroll
008815C2 4E75                       		rts	
008815C4                            ; End of function sub_106E
008815C4                            
008815C4                            ; ---------------------------------------------------------------------------
008815C4                            ; Horizontal interrupt
008815C4                            ; ---------------------------------------------------------------------------
008815C4                            
008815C4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008815C4                            
008815C4                            
008815C4                            HBlank:
008815C4 46FC 2700                  		disable_ints						
008815C8 4A78 F644                  		tst.w	(f_hbla_pal).w	; is palette set to change?
008815CC 6700                       		beq.s	@nochg		; if not, branch
008815CE 31FC 0000 F644             		move.w	#0,(f_hbla_pal).w
008815D4 48E7 00C0                  		movem.l	a0-a1,-(sp)
008815D8 43F9 00C0 0000             		lea	(vdp_data_port).l,a1
008815DE 41F8 FA80                  		lea	(v_pal_water).w,a0 ; get palette from CRAM
008815E2 237C C000 0000 0004        		move.l	#$C0000000,4(a1) ; set VDP to CRAM write
008815EA 2298                       		move.l	(a0)+,(a1)	; move palette to CRAM
008815EC 2298                       		move.l	(a0)+,(a1)
008815EE 2298                       		move.l	(a0)+,(a1)
008815F0 2298                       		move.l	(a0)+,(a1)
008815F2 2298                       		move.l	(a0)+,(a1)
008815F4 2298                       		move.l	(a0)+,(a1)
008815F6 2298                       		move.l	(a0)+,(a1)
008815F8 2298                       		move.l	(a0)+,(a1)
008815FA 2298                       		move.l	(a0)+,(a1)
008815FC 2298                       		move.l	(a0)+,(a1)
008815FE 2298                       		move.l	(a0)+,(a1)
00881600 2298                       		move.l	(a0)+,(a1)
00881602 2298                       		move.l	(a0)+,(a1)
00881604 2298                       		move.l	(a0)+,(a1)
00881606 2298                       		move.l	(a0)+,(a1)
00881608 2298                       		move.l	(a0)+,(a1)
0088160A 2298                       		move.l	(a0)+,(a1)
0088160C 2298                       		move.l	(a0)+,(a1)
0088160E 2298                       		move.l	(a0)+,(a1)
00881610 2298                       		move.l	(a0)+,(a1)
00881612 2298                       		move.l	(a0)+,(a1)
00881614 2298                       		move.l	(a0)+,(a1)
00881616 2298                       		move.l	(a0)+,(a1)
00881618 2298                       		move.l	(a0)+,(a1)
0088161A 2298                       		move.l	(a0)+,(a1)
0088161C 2298                       		move.l	(a0)+,(a1)
0088161E 2298                       		move.l	(a0)+,(a1)
00881620 2298                       		move.l	(a0)+,(a1)
00881622 2298                       		move.l	(a0)+,(a1)
00881624 2298                       		move.l	(a0)+,(a1)
00881626 2298                       		move.l	(a0)+,(a1)
00881628 2298                       		move.l	(a0)+,(a1)
0088162A 337C 8ADF 0004             		move.w	#$8A00+223,4(a1) ; reset HBlank register
00881630 4CDF 0300                  		movem.l	(sp)+,a0-a1
00881634 4A38 F64F                  		tst.b	($FFFFF64F).w
00881638 6600                       		bne.s	loc_119E
0088163A                            
0088163A                            	@nochg:
0088163A 4E73                       		rte	
0088163C                            ; ===========================================================================
0088163C                            
0088163C                            loc_119E:
0088163C 4238 F64F                  		clr.b	($FFFFF64F).w
00881640 48E7 FFFE                  		movem.l	d0-a6,-(sp)
00881644 6100 FC74                  		bsr.w	Demo_Time
00881648                            		;jsr	UpdateMusic
00881648 4CDF 7FFF                  		movem.l	(sp)+,d0-a6
0088164C 4E73                       		rte	
0088164E                            ; End of function HBlank
0088164E                            
0088164E                            ; ---------------------------------------------------------------------------
0088164E                            ; Subroutine to	initialise joypads
0088164E                            ; ---------------------------------------------------------------------------
0088164E                            
0088164E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088164E                            
0088164E                            
0088164E                            JoypadInit:				; XREF: GameClrRAM
0088164E 33FC 0100 00A1 1100        		stopZ80
00881656 0839 0000 00A1 1100 66F6   		waitZ80
00881660 7040                       		moveq	#$40,d0
00881662 13C0 00A1 0009             		move.b	d0,($A10009).l	; init port 1 (joypad 1)
00881668 13C0 00A1 000B             		move.b	d0,($A1000B).l	; init port 2 (joypad 2)
0088166E 13C0 00A1 000D             		move.b	d0,($A1000D).l	; init port 3 (expansion)
00881674 33FC 0000 00A1 1100        		startZ80
0088167C 4E75                       		rts	
0088167E                            ; End of function JoypadInit
0088167E                            
0088167E                            ; ---------------------------------------------------------------------------
0088167E                            ; Subroutine to	read joypad input, and send it to the RAM
0088167E                            ; ---------------------------------------------------------------------------
0088167E                            
0088167E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088167E                            
0088167E                            
0088167E                            ReadJoypads:				; XREF: VBlank, HBlank
0088167E 41F8 F604                  		lea	(v_jpadhold1).w,a0 ; address where joypad states are written
00881682 43F9 00A1 0003             		lea	($A10003).l,a1	; first	joypad port
00881688 6100                       		bsr.s	@read		; do the first joypad
0088168A 5449                       		addq.w	#2,a1		; do the second	joypad
0088168C                            
0088168C                            	@read:
0088168C 12BC 0000                  		move.b	#0,(a1)
00881690 4E71                       		nop	
00881692 4E71                       		nop	
00881694 1011                       		move.b	(a1),d0
00881696 E508                       		lsl.b	#2,d0
00881698 0200 00C0                  		andi.b	#$C0,d0
0088169C 12BC 0040                  		move.b	#$40,(a1)
008816A0 4E71                       		nop	
008816A2 4E71                       		nop	
008816A4 1211                       		move.b	(a1),d1
008816A6 0201 003F                  		andi.b	#$3F,d1
008816AA 8001                       		or.b	d1,d0
008816AC 4600                       		not.b	d0
008816AE 1210                       		move.b	(a0),d1
008816B0 B101                       		eor.b	d0,d1
008816B2 10C0                       		move.b	d0,(a0)+
008816B4 C200                       		and.b	d0,d1
008816B6 10C1                       		move.b	d1,(a0)+
008816B8 4E75                       		rts	
008816BA                            ; End of function ReadJoypads
008816BA                            
008816BA                            
008816BA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008816BA                            
008816BA                            
008816BA                            VDPSetupGame:				; XREF: GameClrRAM; ChecksumError
008816BA 41F9 00C0 0004             		lea	(vdp_control_port).l,a0
008816C0 43F9 00C0 0000             		lea	(vdp_data_port).l,a1
008816C6 45F9 0000 0000             		lea	(VDPSetupArray).l,a2
008816CC 7E12                       		moveq	#$12,d7
008816CE                            
008816CE                            	@setreg:
008816CE 309A                       		move.w	(a2)+,(a0)
008816D0 51CF FFFC                  		dbf	d7,@setreg	; set the VDP registers
008816D4                            
008816D4 3039 0000 0000             		move.w	(VDPSetupArray+2).l,d0
008816DA 31C0 F60C                  		move.w	d0,(v_vdp_buffer1).w
008816DE 31FC 8ADF F624             		move.w	#$8A00+223,(v_hbla_hreg).w
008816E4 7000                       		moveq	#0,d0
008816E6 23FC C000 0000 00C0 0004   		move.l	#$C0000000,(vdp_control_port).l ; set VDP to CRAM write
008816F0 3E3C 003F                  		move.w	#$3F,d7
008816F4                            
008816F4                            	@clrCRAM:
008816F4 3280                       		move.w	d0,(a1)
008816F6 51CF FFFC                  		dbf	d7,@clrCRAM	; clear	the CRAM
008816FA                            
008816FA 42B8 F616                  		clr.l	(v_scrposy_dup).w
008816FE 42B8 F61A                  		clr.l	(v_scrposx_dup).w
00881702 2F01                       		move.l	d1,-(sp)
00881704 4BF9 00C0 0004 3ABC 8F01+  		fillVRAM	0,$FFFF,0
00881726                            
00881726                            	@waitforDMA:
00881726 3215                       		move.w	(a5),d1
00881728 0801 0001                  		btst	#1,d1		; is DMA (fillVRAM) still running?
0088172C 66F8                       		bne.s	@waitforDMA	; if yes, branch
0088172E                            
0088172E 3ABC 8F02                  		move.w	#$8F02,(a5)	; set VDP increment size
00881732 221F                       		move.l	(sp)+,d1
00881734 4E75                       		rts	
00881736                            ; End of function VDPSetupGame
00881736                            
00881736                            ; ===========================================================================
00881736 8004                       VDPSetupArray:	dc.w $8004		; 8-colour mode
00881738 8134                       		dc.w $8134		; enable V.interrupts, enable DMA
0088173A 8230                       		dc.w $8200+(vram_fg>>10) ; set foreground nametable address
0088173C 8328                       		dc.w $8300+($A000>>10)	; set window nametable address
0088173E 8407                       		dc.w $8400+(vram_bg>>13) ; set background nametable address
00881740 857C                       		dc.w $8500+(vram_sprites>>9) ; set sprite table address
00881742 8600                       		dc.w $8600		; unused
00881744 8700                       		dc.w $8700		; set background colour (palette entry 0)
00881746 8800                       		dc.w $8800		; unused
00881748 8900                       		dc.w $8900		; unused
0088174A 8A00                       		dc.w $8A00		; default H.interrupt register
0088174C 8B00                       		dc.w $8B00		; full-screen vertical scrolling
0088174E 8C81                       		dc.w $8C81		; 40-cell display mode
00881750 8D3F                       		dc.w $8D00+(vram_hscroll>>10) ; set background hscroll address
00881752 8E00                       		dc.w $8E00		; unused
00881754 8F02                       		dc.w $8F02		; set VDP increment size
00881756 9001                       		dc.w $9001		; 64-cell hscroll size
00881758 9100                       		dc.w $9100		; window horizontal position
0088175A 9200                       		dc.w $9200		; window vertical position
0088175C                            
0088175C                            ; ---------------------------------------------------------------------------
0088175C                            ; Subroutine to	clear the screen
0088175C                            ; ---------------------------------------------------------------------------
0088175C                            
0088175C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088175C                            
0088175C                            
0088175C                            ClearScreen:
0088175C 4BF9 00C0 0004 3ABC 8F01+  		fillVRAM	0,$FFF,vram_fg ; clear foreground namespace
0088177E                            
0088177E                            	@wait1:
0088177E 3215                       		move.w	(a5),d1
00881780 0801 0001                  		btst	#1,d1
00881784 66F8                       		bne.s	@wait1
00881786                            
00881786 3ABC 8F02                  		move.w	#$8F02,(a5)
0088178A 4BF9 00C0 0004 3ABC 8F01+  		fillVRAM	0,$FFF,vram_bg ; clear background namespace
008817AC                            
008817AC                            	@wait2:
008817AC 3215                       		move.w	(a5),d1
008817AE 0801 0001                  		btst	#1,d1
008817B2 66F8                       		bne.s	@wait2
008817B4                            
008817B4 3ABC 8F02                  		move.w	#$8F02,(a5)
008817B8                            
008817B8 42B8 F616                  		clr.l	(v_scrposy_dup).w
008817BC 42B8 F61A                  		clr.l	(v_scrposx_dup).w
008817C0                            
008817C0 43F8 F800                  		lea	(v_spritetablebuffer).w,a1
008817C4 7000                       		moveq	#0,d0
008817C6 323C 00A0                  		move.w	#$A0,d1
008817CA                            
008817CA                            	@clearsprites:
008817CA 22C0                       		move.l	d0,(a1)+
008817CC 51C9 FFFC                  		dbf	d1,@clearsprites ; clear sprite table (in RAM)
008817D0                            
008817D0 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
008817D4 7000                       		moveq	#0,d0
008817D6 323C 0100                  		move.w	#$100,d1
008817DA                            
008817DA                            	@clearhscroll:
008817DA 22C0                       		move.l	d0,(a1)+
008817DC 51C9 FFFC                  		dbf	d1,@clearhscroll ; clear hscroll table (in RAM)
008817E0 4E75                       		rts	
008817E2                            ; End of function ClearScreen
008817E2                            
008817E2                            ; ---------------------------------------------------------------------------
008817E2                            ; Subroutine to	load the sound driver
008817E2                            ; ---------------------------------------------------------------------------
008817E2                            
008817E2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008817E2                            
008817E2                            
008817E2                            SoundDriverLoad:			; XREF: GameClrRAM; GM_Title
008817E2 4E71                       		nop	
008817E4 33FC 0100 00A1 1100        		stopZ80
008817EC 33FC 0100 00A1 1200        		resetZ80
008817F4                            		
008817F4 41F9 0000 0000             		lea	(SoundDriver).l,a0	; load sound driver
008817FA 43F9 00A0 0000             		lea	(z80_ram).l,a1		; target Z80 RAM
00881800 303C 1FFF                  		move.w	#$1FFF, d0
00881804                            @WriteData		
00881804 12D8                       		move.b (a0)+, (a1)+
00881806 51C8 FFFC                  		dbf	d0, @WriteData
0088180A                            	
0088180A 0838 0006 FFF8             		btst	#6,(v_megadrive).w	; Is megadrive pal?
00881810 6700                       		beq.s	@notPal				; If not, branch
00881812 13FC 0001 00A0 1BA8        		move.b	#1,(zPalFlag).l		; set PAL mode flag in Z80 driver
0088181A                            @notPal
0088181A                            
0088181A 33FC 0000 00A1 1200        		resetZ80a
00881822 4E71                       		nop	
00881824 4E71                       		nop	
00881826 4E71                       		nop	
00881828 4E71                       		nop	
0088182A 33FC 0100 00A1 1200        		resetZ80
00881832 33FC 0000 00A1 1100        		startZ80
0088183A 4E75                       		rts	
0088183C                            ; End of function SoundDriverLoad
0088183C                            
0088183C                            		include	"_incObj\sub PlaySound.asm"
0088183C                            ; ---------------------------------------------------------------------------
0088183C                            ; Subroutine to	play a music track
0088183C                            
0088183C                            ; input:
0088183C                            ;	d0 = track to play
0088183C                            ; ---------------------------------------------------------------------------
0088183C                            
0088183C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088183C                            
0088183C                            
0088183C                            ; ---------------------------------------------------------------------------
0088183C                            ; Subroutine to	play a sound or	music track
0088183C                            ; ---------------------------------------------------------------------------
0088183C                             
0088183C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088183C                             
0088183C                             
0088183C                            PlaySound:
0088183C 0C40 00FB                  		cmpi.w	#$FB,d0
00881840 6D00                       		blt.s	PlayNotSpecialFlag
00881842 6200                       		bhi.s	TestForNormalSpeed
00881844 303C 0008                  		move	#8,d0
00881848 4EF9 0000 0000             		jmp	SetTempo
0088184E                             
0088184E                            TestForNormalSpeed:
0088184E 0C40 00FC                  		cmpi.w	#$FC,d0
00881852 6600                       		bne.s	PlayNotSpecialFlag
00881854 4240                       		clr.w	d0
00881856 4EF9 0000 0000             		jmp	SetTempo
0088185C                             
0088185C                            PlayNotSpecialFlag:
0088185C 33FC 0100 00A1 1100        		stopZ80
00881864 13C0 00A0 1BAA             		move.b	d0,(zMusicNumber).l
0088186A 33FC 0000 00A1 1100        		startZ80
00881872 4E75                       		rts
00881874                            ; End of function PlaySound
00881874                             
00881874                            ; ---------------------------------------------------------------------------
00881874                            ; Exclusive sound/music subroutine
00881874                            ; ---------------------------------------------------------------------------
00881874                             
00881874                             
00881874                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881874                              
00881874                            PlaySound_Ex:
00881874 4A28 0004                  		tst.b	4(A0)
00881878 6A00                       		bpl.s	SkipPlaySound_Special
0088187A                             
0088187A                            
0088187A                            ; ---------------------------------------------------------------------------
0088187A                            ; Unused sound/music subroutine
0088187A                            ; ---------------------------------------------------------------------------
0088187A                             
0088187A                            PlaySound_Unk:
0088187A 4E71                       		nop
0088187C                            ; ---------------------------------------------------------------------------
0088187C                            ; Subroutine to	play a special sound/music (FB-FF)
0088187C                            ; ---------------------------------------------------------------------------
0088187C                             
0088187C                            PlaySound_Special:
0088187C 33FC 0100 00A1 1100        		stopz80
00881884 B039 00A0 1BAB             		cmp.b	(zSFXNumber0).l,d0
0088188A 6700                       		beq.s	PlaySound_Special1
0088188C 4A39 00A0 1BAB             		tst.b	(zSFXNumber0).l
00881892 6600                       		bne.s	PlaySound_Special0
00881894 13C0 00A0 1BAB             		move.b	d0,(zSFXNumber0).l
0088189A 33FC 0000 00A1 1100        		startz80
008818A2 4E75                       		rts
008818A4                             
008818A4                            PlaySound_Special0:
008818A4 13C0 00A0 1BAC             		move.b	d0,(zSFXNumber1).l
008818AA                             
008818AA                            PlaySound_Special1:
008818AA 33FC 0000 00A1 1100        		startz80
008818B2                             
008818B2                            SkipPlaySound_Special:
008818B2 4E75                       		rts
008818B4                            ; End of function PlaySound_Special
008818B4                             
008818B4                            ; ---------------------------------------------------------------------------
008818B4                            ; Subroutine to change the music tempo
008818B4                            ; ---------------------------------------------------------------------------
008818B4                             
008818B4                            SetTempo:
008818B4 33FC 0100 00A1 1100        		stopz80
008818BC 13C0 00A0 1BA9             		move.b	d0,(zTempoSpeedup).l
008818C2 33FC 0000 00A1 1100        		startz80
008818CA 4E75                       		rts
008818CA 4E75                       		rts
008818CC                            		include	"_inc\PauseGame.asm"
008818CC                            ; ---------------------------------------------------------------------------
008818CC                            ; Subroutine to	pause the game
008818CC                            ; ---------------------------------------------------------------------------
008818CC                            
008818CC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008818CC                            
008818CC                            
008818CC                            PauseGame:				; XREF: Level_MainLoop; et al
008818CC 4E71                       		nop	
008818CE 4A38 FE12                  		tst.b	(v_lives).w	; do you have any lives	left?
008818D2 6700                       		beq.s	Unpause		; if not, branch
008818D4 4A78 F63A                  		tst.w	(f_pause).w	; is game already paused?
008818D8 6600                       		bne.s	Pause_StopGame	; if yes, branch
008818DA 0838 0007 F605             		btst	#bitStart,(v_jpadpress1).w ; is Start button pressed?
008818E0 6700                       		beq.s	Pause_DoNothing	; if not, branch
008818E2                            
008818E2                            Pause_StopGame:
008818E2 31FC 0001 F63A             		move.w	#1,(f_pause).w	; freeze time
008818E8 33FC 0100 00A1 1100        		stopz80
008818F0 13FC 0001 00A0 1BAD        		move.b	#1,(zPauseFlag).l
008818F8 33FC 0000 00A1 1100        		startz80
00881900                            Pause_Loop:
00881900 11FC 0010 F62A             		move.b	#$10,(v_vbla_routine).w
00881906 6100 0000                  		bsr.w	WaitForVBla
0088190A 4A38 FFE1                  		tst.b	(f_slomocheat).w ; is slow-motion cheat on?
0088190E 6700                       		beq.s	Pause_ChkStart	; if not, branch
00881910 0838 0006 F605             		btst	#bitA,(v_jpadpress1).w ; is button A pressed?
00881916 6700                       		beq.s	Pause_ChkBC	; if not, branch
00881918 11FC 0000 F600             		move.b	#id_Title,(v_gamemode).w ; set game mode to 4 (title screen)
0088191E 4E71                       		nop	
00881920 6000                       		bra.s	Pause_EndMusic
00881922                            ; ===========================================================================
00881922                            
00881922                            Pause_ChkBC:
00881922 0838 0004 F604             		btst	#bitB,(v_jpadhold1).w ; is button B pressed?
00881928 6600                       		bne.s	Pause_SlowMo	; if yes, branch
0088192A 0838 0005 F605             		btst	#bitC,(v_jpadpress1).w ; is button C pressed?
00881930 6600                       		bne.s	Pause_SlowMo	; if yes, branch
00881932                            
00881932                            Pause_ChkStart:
00881932 0838 0007 F605             		btst	#bitStart,(v_jpadpress1).w ; is Start button pressed?
00881938 67C6                       		beq.s	Pause_Loop	; if not, branch
0088193A                            
0088193A                            Pause_EndMusic:	
0088193A 33FC 0100 00A1 1100        		stopz80
00881942 13FC 0080 00A0 1BAD        		move.b	#$80,(zPauseFlag).l
0088194A 33FC 0000 00A1 1100        		startz80
00881952                            
00881952                            Unpause:
00881952 31FC 0000 F63A             		move.w	#0,(f_pause).w	; unpause the game
00881958                            
00881958                            Pause_DoNothing:
00881958 4E75                       		rts	
0088195A                            ; ===========================================================================
0088195A                            
0088195A                            Pause_SlowMo:
0088195A 31FC 0001 F63A             		move.w	#1,(f_pause).w
00881960 33FC 0100 00A1 1100        		stopZ80
00881968 13FC 0080 00A0 1BAD        		move.b	#$80,(zPauseFlag).l
00881970 33FC 0000 00A1 1100        		startZ80
00881978 4E75                       		rts	
0088197A                            ; End of function PauseGame
0088197A                            ; End of function PauseGame
0088197A                            
0088197A                            ; ---------------------------------------------------------------------------
0088197A                            ; Subroutine to	copy a tile map from RAM to VRAM namespace
0088197A                            
0088197A                            ; input:
0088197A                            ;	a1 = tile map address
0088197A                            ;	d0 = VRAM address
0088197A                            ;	d1 = width (cells)
0088197A                            ;	d2 = height (cells)
0088197A                            ; ---------------------------------------------------------------------------
0088197A                            
0088197A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088197A                            
0088197A                            
0088197A                            TilemapToVRAM:				; XREF: GM_Sega; GM_Title; SS_BGLoad
0088197A 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
00881980 283C 0080 0000             		move.l	#$800000,d4
00881986                            
00881986                            	Tilemap_Line:
00881986 2D40 0004                  		move.l	d0,4(a6)
0088198A 3601                       		move.w	d1,d3
0088198C                            
0088198C                            	Tilemap_Cell:
0088198C 3C99                       		move.w	(a1)+,(a6)	; write value to namespace
0088198E 51CB FFFC                  		dbf	d3,Tilemap_Cell
00881992 D084                       		add.l	d4,d0		; goto next line
00881994 51CA FFF0                  		dbf	d2,Tilemap_Line
00881998 4E75                       		rts	
0088199A                            ; End of function TilemapToVRAM
0088199A                            
0088199A                            		include	"_inc\(Mercury) DMA Queue.asm"
0088199A                            ; ---------------------------------------------------------------------------
0088199A                            ; Subroutine for queueing VDP commands (seems to only queue transfers to VRAM),
0088199A                            ; to be issued the next time ProcessDMAQueue is called.
0088199A                            ; Can be called a maximum of 18 times before the buffer needs to be cleared
0088199A                            ; by issuing the commands (this subroutine DOES check for overflow)
0088199A                            ; ---------------------------------------------------------------------------
0088199A                            
0088199A                            ; ||||||||||||||| S U B R O U T I N E |||||||||||||||||||||||||||||||||||||||
0088199A                            
0088199A                            ; sub_144E: DMA_68KtoVRAM: QueueCopyToVRAM: QueueVDPCommand: Add_To_DMA_Queue:
0088199A                            QueueDMATransfer:
0088199A 2278 C8FC                  	movea.l	(VDP_Command_Buffer_Slot).w,a1
0088199E B2FC C8FC                  	cmpa.w	#VDP_Command_Buffer_Slot,a1
008819A2 6700                       	beq.s	QueueDMATransfer_Done ; return if there's no more room in the buffer
008819A4                            
008819A4                            	; piece together some VDP commands and store them for later...
008819A4 303C 9300                  	move.w	#$9300,d0 ; command to specify DMA transfer length & $00FF
008819A8 1003                       	move.b	d3,d0
008819AA 32C0                       	move.w	d0,(a1)+ ; store command
008819AC                            
008819AC 303C 9400                  	move.w	#$9400,d0 ; command to specify DMA transfer length & $FF00
008819B0 E04B                       	lsr.w	#8,d3
008819B2 1003                       	move.b	d3,d0
008819B4 32C0                       	move.w	d0,(a1)+ ; store command
008819B6                            
008819B6 303C 9500                  	move.w	#$9500,d0 ; command to specify source address & $0001FE
008819BA E289                       	lsr.l	#1,d1
008819BC 1001                       	move.b	d1,d0
008819BE 32C0                       	move.w	d0,(a1)+ ; store command
008819C0                            
008819C0 303C 9600                  	move.w	#$9600,d0 ; command to specify source address & $01FE00
008819C4 E089                       	lsr.l	#8,d1
008819C6 1001                       	move.b	d1,d0
008819C8 32C0                       	move.w	d0,(a1)+ ; store command
008819CA                            
008819CA 303C 9700                  	move.w	#$9700,d0 ; command to specify source address & $FE0000
008819CE E089                       	lsr.l	#8,d1
008819D0 1001                       	move.b	d1,d0
008819D2 32C0                       	move.w	d0,(a1)+ ; store command
008819D4                            
008819D4 0282 0000 FFFF             	andi.l	#$FFFF,d2 ; command to specify destination address and begin DMA
008819DA E58A                       	lsl.l	#2,d2
008819DC E44A                       	lsr.w	#2,d2
008819DE 4842                       	swap	d2
008819E0 0082 4000 0080             	ori.l	#$40000080,d2 ; set bits to specify VRAM transfer
008819E6 22C2                       	move.l	d2,(a1)+ ; store command
008819E8                            
008819E8 21C9 C8FC                  	move.l	a1,(VDP_Command_Buffer_Slot).w ; set the next free slot address
008819EC B2FC C8FC                  	cmpa.w	#VDP_Command_Buffer_Slot,a1
008819F0 6700                       	beq.s	QueueDMATransfer_Done ; return if there's no more room in the buffer
008819F2 32BC 0000                  	move.w	#0,(a1) ; put a stop token at the end of the used part of the buffer
008819F6                            ; return_14AA:
008819F6                            QueueDMATransfer_Done:
008819F6 4E75                       	rts
008819F8                            ; End of function QueueDMATransfer
008819F8                            
008819F8                            
008819F8                            ; ---------------------------------------------------------------------------
008819F8                            ; Subroutine to copy the DMA Queue code to ram
008819F8                            ; Needed because it modifies the RV bit, breaking rom mapping
008819F8                            ; ---------------------------------------------------------------------------
008819F8                            ; ||||||||||||||| S U B R O U T I N E |||||||||||||||||||||||||||||||||||||||
008819F8                            
008819F8                            LoadDMARoutine:
008819F8 41F9 0000 0000             		lea	(ProcessDMAQueue_ROM).l,a0	; load sound driver
008819FE 43F9 FFFF B000             		lea	(ProcessDMAQueue).l,a1		; target Z80 RAM
00881A04 303C 0000                  		move.w	#ProcessDMAQueue_End-ProcessDMAQueue_ROM, d0
00881A08                            @WriteData		
00881A08 12D8                       		move.b (a0)+, (a1)+
00881A0A 51C8 FFFC                  		dbf	d0, @WriteData	
00881A0E 4E75                       		rts
00881A10                            
00881A10                            ; ---------------------------------------------------------------------------
00881A10                            ; Subroutine for issuing all VDP commands that were queued
00881A10                            ; (by earlier calls to QueueDMATransfer)
00881A10                            ; Resets the queue when it's done
00881A10                            ; ---------------------------------------------------------------------------
00881A10                            ; ||||||||||||||| S U B R O U T I N E |||||||||||||||||||||||||||||||||||||||
00881A10                            
00881A10                            ; sub_14AC: CopyToVRAM: IssueVDPCommands: Process_DMA: Process_DMA_Queue:
00881A10                            ProcessDMAQueue_ROM:	
00881A10 33FC 0100 00A1 1100        	stopz80							; Stop the Z80, as it depends on 32X mapping
00881A18 13FC 0001 00A1 5107        	move.b  #1,	MARS_DREQ_CTRL+1	; Set RV bit (Disable 32X mapping for DMA)
00881A20                            	
00881A20 4BF9 00C0 0004             	lea	($C00004).l,a5
00881A26 43F8 C800                  	lea	(VDP_Command_Buffer).w,a1
00881A2A                            ; loc_14B6:
00881A2A                            ProcessDMAQueue_Loop:
00881A2A 3019                       	move.w	(a1)+,d0
00881A2C 6700                       	beq.s	ProcessDMAQueue_Done ; branch if we reached a stop token
00881A2E                            	; issue a set of VDP commands...
00881A2E 3A80                       	move.w	d0,(a5)		; transfer length
00881A30 3A99                       	move.w	(a1)+,(a5)	; transfer length
00881A32 3A99                       	move.w	(a1)+,(a5)	; source address
00881A34 3A99                       	move.w	(a1)+,(a5)	; source address
00881A36 3A99                       	move.w	(a1)+,(a5)	; source address
00881A38 3A99                       	move.w	(a1)+,(a5)	; destination
00881A3A 3A99                       	move.w	(a1)+,(a5)	; destination
00881A3C B2FC C8FC                  	cmpa.w	#$C8FC,a1
00881A40 66E8                       	bne.s	ProcessDMAQueue_Loop ; loop if we haven't reached the end of the buffer
00881A42                            ; loc_14CE:
00881A42                            ProcessDMAQueue_Done:
00881A42 31FC 0000 C800             	move.w	#0,(VDP_Command_Buffer).w
00881A48 21FC FFFF C800 C8FC        	move.l	#VDP_Command_Buffer,(VDP_Command_Buffer_Slot).w
00881A50 13FC 0000 00A1 5107        	move.b  #0,	MARS_DREQ_CTRL+1	; Clear RV bit, re-enable 32X mapping	
00881A58 33FC 0000 00A1 1100        	startz80						; Restart Z80
00881A60 4E75                       	rts
00881A62                            ProcessDMAQueue_End:
00881A62                            ; End of function ProcessDMAQueue
00881A62                            ; End of function ProcessDMAQueue
00881A62                            	
00881A62                            		include	"_inc\Nemesis Decompression.asm"
00881A62                            ; ---------------------------------------------------------------------------
00881A62                            ; Nemesis decompression	algorithm
00881A62                            ; ---------------------------------------------------------------------------
00881A62                            
00881A62                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881A62                            
00881A62                            
00881A62                            NemDec:
00881A62 48E7 FFDC                  		movem.l	d0-a1/a3-a5,-(sp)
00881A66 47F9 0000 0000             		lea	(loc_1502).l,a3
00881A6C 49F9 00C0 0000             		lea	(vdp_data_port).l,a4
00881A72 6000                       		bra.s	loc_145C
00881A74                            ; ===========================================================================
00881A74 48E7 FFDC                  		movem.l	d0-a1/a3-a5,-(sp)
00881A78 47F9 0000 0000             		lea	(loc_1518).l,a3
00881A7E                            
00881A7E                            loc_145C:
00881A7E 43F8 AA00                  		lea	(v_ngfx_buffer).w,a1
00881A82 3418                       		move.w	(a0)+,d2
00881A84 E34A                       		lsl.w	#1,d2
00881A86 6400                       		bcc.s	loc_146A
00881A88 D6FC 000A                  		adda.w	#$A,a3
00881A8C                            
00881A8C                            loc_146A:
00881A8C E54A                       		lsl.w	#2,d2
00881A8E 3A42                       		movea.w	d2,a5
00881A90 7608                       		moveq	#8,d3
00881A92 7400                       		moveq	#0,d2
00881A94 7800                       		moveq	#0,d4
00881A96 6100 0000                  		bsr.w	NemDec4
00881A9A 1A18                       		move.b	(a0)+,d5
00881A9C E145                       		asl.w	#8,d5
00881A9E 1A18                       		move.b	(a0)+,d5
00881AA0 3C3C 0010                  		move.w	#$10,d6
00881AA4 6100                       		bsr.s	NemDec2
00881AA6 4CDF 3BFF                  		movem.l	(sp)+,d0-a1/a3-a5
00881AAA 4E75                       		rts	
00881AAC                            ; End of function NemDec
00881AAC                            
00881AAC                            
00881AAC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881AAC                            
00881AAC                            
00881AAC                            NemDec2:				; XREF: NemDec
00881AAC 3E06                       		move.w	d6,d7
00881AAE 5147                       		subq.w	#8,d7
00881AB0 3205                       		move.w	d5,d1
00881AB2 EE69                       		lsr.w	d7,d1
00881AB4 0C01 00FC                  		cmpi.b	#-4,d1
00881AB8 6400                       		bcc.s	loc_14D6
00881ABA 0241 00FF                  		andi.w	#$FF,d1
00881ABE D241                       		add.w	d1,d1
00881AC0 1031 1000                  		move.b	(a1,d1.w),d0
00881AC4 4880                       		ext.w	d0
00881AC6 9C40                       		sub.w	d0,d6
00881AC8 0C46 0009                  		cmpi.w	#9,d6
00881ACC 6400                       		bcc.s	loc_14B2
00881ACE 5046                       		addq.w	#8,d6
00881AD0 E145                       		asl.w	#8,d5
00881AD2 1A18                       		move.b	(a0)+,d5
00881AD4                            
00881AD4                            loc_14B2:
00881AD4 1231 1001                  		move.b	1(a1,d1.w),d1
00881AD8 3001                       		move.w	d1,d0
00881ADA 0241 000F                  		andi.w	#$F,d1
00881ADE 0240 00F0                  		andi.w	#$F0,d0
00881AE2                            
00881AE2                            loc_14C0:				; XREF: NemDec3
00881AE2 E848                       		lsr.w	#4,d0
00881AE4                            
00881AE4                            loc_14C2:				; XREF: NemDec3
00881AE4 E98C                       		lsl.l	#4,d4
00881AE6 8801                       		or.b	d1,d4
00881AE8 5343                       		subq.w	#1,d3
00881AEA 6600                       		bne.s	loc_14D0
00881AEC 4ED3                       		jmp	(a3)
00881AEE                            ; End of function NemDec2
00881AEE                            
00881AEE                            
00881AEE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881AEE                            
00881AEE                            
00881AEE                            NemDec3:				; XREF: loc_1502
00881AEE 7800                       		moveq	#0,d4
00881AF0 7608                       		moveq	#8,d3
00881AF2                            
00881AF2                            loc_14D0:				; XREF: NemDec2
00881AF2 51C8 FFF0                  		dbf	d0,loc_14C2
00881AF6 60B4                       		bra.s	NemDec2
00881AF8                            ; ===========================================================================
00881AF8                            
00881AF8                            loc_14D6:				; XREF: NemDec2
00881AF8 5D46                       		subq.w	#6,d6
00881AFA 0C46 0009                  		cmpi.w	#9,d6
00881AFE 6400                       		bcc.s	loc_14E4
00881B00 5046                       		addq.w	#8,d6
00881B02 E145                       		asl.w	#8,d5
00881B04 1A18                       		move.b	(a0)+,d5
00881B06                            
00881B06                            loc_14E4:				; XREF: NemDec3
00881B06 5F46                       		subq.w	#7,d6
00881B08 3205                       		move.w	d5,d1
00881B0A EC69                       		lsr.w	d6,d1
00881B0C 3001                       		move.w	d1,d0
00881B0E 0241 000F                  		andi.w	#$F,d1
00881B12 0240 0070                  		andi.w	#$70,d0
00881B16 0C46 0009                  		cmpi.w	#9,d6
00881B1A 64C6                       		bcc.s	loc_14C0
00881B1C 5046                       		addq.w	#8,d6
00881B1E E145                       		asl.w	#8,d5
00881B20 1A18                       		move.b	(a0)+,d5
00881B22 60BE                       		bra.s	loc_14C0
00881B24                            ; End of function NemDec3
00881B24                            
00881B24                            ; ===========================================================================
00881B24                            
00881B24                            loc_1502:				; XREF: NemDec
00881B24 2884                       		move.l	d4,(a4)
00881B26 534D                       		subq.w	#1,a5
00881B28 380D                       		move.w	a5,d4
00881B2A 66C2                       		bne.s	NemDec3
00881B2C 4E75                       		rts	
00881B2E                            ; ===========================================================================
00881B2E B982                       		eor.l	d4,d2
00881B30 2882                       		move.l	d2,(a4)
00881B32 534D                       		subq.w	#1,a5
00881B34 380D                       		move.w	a5,d4
00881B36 66B6                       		bne.s	NemDec3
00881B38 4E75                       		rts	
00881B3A                            ; ===========================================================================
00881B3A                            
00881B3A                            loc_1518:				; XREF: NemDec
00881B3A 28C4                       		move.l	d4,(a4)+
00881B3C 534D                       		subq.w	#1,a5
00881B3E 380D                       		move.w	a5,d4
00881B40 66AC                       		bne.s	NemDec3
00881B42 4E75                       		rts	
00881B44                            ; ===========================================================================
00881B44 B982                       		eor.l	d4,d2
00881B46 28C2                       		move.l	d2,(a4)+
00881B48 534D                       		subq.w	#1,a5
00881B4A 380D                       		move.w	a5,d4
00881B4C 66A0                       		bne.s	NemDec3
00881B4E 4E75                       		rts	
00881B50                            
00881B50                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881B50                            
00881B50                            
00881B50                            NemDec4:				; XREF: NemDec
00881B50 1018                       		move.b	(a0)+,d0
00881B52                            
00881B52                            loc_1530:
00881B52 0C00 00FF                  		cmpi.b	#-1,d0
00881B56 6600                       		bne.s	loc_1538
00881B58 4E75                       		rts	
00881B5A                            ; ===========================================================================
00881B5A                            
00881B5A                            loc_1538:				; XREF: NemDec4
00881B5A 3E00                       		move.w	d0,d7
00881B5C                            
00881B5C                            loc_153A:
00881B5C 1018                       		move.b	(a0)+,d0
00881B5E 0C00 0080                  		cmpi.b	#$80,d0
00881B62 64EE                       		bcc.s	loc_1530
00881B64 1200                       		move.b	d0,d1
00881B66 0247 000F                  		andi.w	#$F,d7
00881B6A 0241 0070                  		andi.w	#$70,d1
00881B6E 8E41                       		or.w	d1,d7
00881B70 0240 000F                  		andi.w	#$F,d0
00881B74 1200                       		move.b	d0,d1
00881B76 E149                       		lsl.w	#8,d1
00881B78 8E41                       		or.w	d1,d7
00881B7A 7208                       		moveq	#8,d1
00881B7C 9240                       		sub.w	d0,d1
00881B7E 6600                       		bne.s	loc_1568
00881B80 1018                       		move.b	(a0)+,d0
00881B82 D040                       		add.w	d0,d0
00881B84 3387 0000                  		move.w	d7,(a1,d0.w)
00881B88 60D2                       		bra.s	loc_153A
00881B8A                            ; ===========================================================================
00881B8A                            
00881B8A                            loc_1568:				; XREF: NemDec4
00881B8A 1018                       		move.b	(a0)+,d0
00881B8C E368                       		lsl.w	d1,d0
00881B8E D040                       		add.w	d0,d0
00881B90 7A01                       		moveq	#1,d5
00881B92 E36D                       		lsl.w	d1,d5
00881B94 5345                       		subq.w	#1,d5
00881B96                            
00881B96                            loc_1574:
00881B96 3387 0000                  		move.w	d7,(a1,d0.w)
00881B9A 5440                       		addq.w	#2,d0
00881B9C 51CD FFF8                  		dbf	d5,loc_1574
00881BA0 60BA                       		bra.s	loc_153A
00881BA2                            ; End of function NemDec4
00881BA2                            ; End of function NemDec4
00881BA2                            
00881BA2                            ; ---------------------------------------------------------------------------
00881BA2                            ; Subroutines to load pattern load cues
00881BA2                            
00881BA2                            ; input:
00881BA2                            ;	d0 = pattern load cue number
00881BA2                            ; ---------------------------------------------------------------------------
00881BA2                            
00881BA2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881BA2                            
00881BA2                            
00881BA2                            AddPLC:
00881BA2 48E7 0060                  		movem.l	a1-a2,-(sp)
00881BA6 43F9 0000 0000             		lea	(ArtLoadCues).l,a1
00881BAC D040                       		add.w	d0,d0
00881BAE 3031 0000                  		move.w	(a1,d0.w),d0
00881BB2 43F1 0000                  		lea	(a1,d0.w),a1	; jump to relevant PLC
00881BB6 45F8 F680                  		lea	(v_plc_buffer).w,a2 ; PLC buffer space
00881BBA                            
00881BBA                            	@findspace:
00881BBA 4A92                       		tst.l	(a2)		; is space available in RAM?
00881BBC 6700                       		beq.s	@copytoRAM	; if yes, branch
00881BBE 5C4A                       		addq.w	#6,a2		; if not, try next space
00881BC0 60F8                       		bra.s	@findspace
00881BC2                            ; ===========================================================================
00881BC2                            
00881BC2                            @copytoRAM:
00881BC2 3019                       		move.w	(a1)+,d0	; get length of PLC
00881BC4 6B00                       		bmi.s	@skip
00881BC6                            
00881BC6                            	@loop:
00881BC6 24D9                       		move.l	(a1)+,(a2)+
00881BC8 34D9                       		move.w	(a1)+,(a2)+	; copy PLC to RAM
00881BCA 51C8 FFFA                  		dbf	d0,@loop	; repeat for length of PLC
00881BCE                            
00881BCE                            	@skip:
00881BCE 4CDF 0600                  		movem.l	(sp)+,a1-a2
00881BD2 4E75                       		rts	
00881BD4                            ; End of function AddPLC
00881BD4                            
00881BD4                            
00881BD4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881BD4                            
00881BD4                            
00881BD4                            NewPLC:
00881BD4 48E7 0060                  		movem.l	a1-a2,-(sp)
00881BD8 43F9 0000 0000             		lea	(ArtLoadCues).l,a1
00881BDE D040                       		add.w	d0,d0
00881BE0 3031 0000                  		move.w	(a1,d0.w),d0
00881BE4 43F1 0000                  		lea	(a1,d0.w),a1	; jump to relevant PLC
00881BE8 6100                       		bsr.s	ClearPLC	; erase any data in PLC buffer space
00881BEA 45F8 F680                  		lea	(v_plc_buffer).w,a2
00881BEE 3019                       		move.w	(a1)+,d0	; get length of PLC
00881BF0 6B00                       		bmi.s	@skip
00881BF2                            
00881BF2                            	@loop:
00881BF2 24D9                       		move.l	(a1)+,(a2)+
00881BF4 34D9                       		move.w	(a1)+,(a2)+	; copy PLC to RAM
00881BF6 51C8 FFFA                  		dbf	d0,@loop	; repeat for length of PLC
00881BFA                            
00881BFA                            	@skip:
00881BFA 4CDF 0600                  		movem.l	(sp)+,a1-a2
00881BFE 4E75                       		rts	
00881C00                            ; End of function NewPLC
00881C00                            
00881C00                            ; ---------------------------------------------------------------------------
00881C00                            ; Subroutine to	clear the pattern load cues
00881C00                            ; ---------------------------------------------------------------------------
00881C00                            
00881C00                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881C00                            
00881C00                            
00881C00                            ClearPLC:				; XREF: NewPLC
00881C00 45F8 F680                  		lea	(v_plc_buffer).w,a2 ; PLC buffer space in RAM
00881C04 701F                       		moveq	#$1F,d0
00881C06                            
00881C06                            	@loop:
00881C06 429A                       		clr.l	(a2)+
00881C08 51C8 FFFC                  		dbf	d0,@loop
00881C0C 4E75                       		rts	
00881C0E                            ; End of function ClearPLC
00881C0E                            
00881C0E                            ; ---------------------------------------------------------------------------
00881C0E                            ; Subroutine to	use graphics listed in a pattern load cue
00881C0E                            ; ---------------------------------------------------------------------------
00881C0E                            
00881C0E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881C0E                            
00881C0E                            
00881C0E                            RunPLC:					; XREF: GM_Level; et al
00881C0E 4AB8 F680                  		tst.l	(v_plc_buffer).w
00881C12 6700                       		beq.s	Rplc_Exit
00881C14 4A78 F6F8                  		tst.w	(f_plc_execute).w
00881C18 6600                       		bne.s	Rplc_Exit
00881C1A 2078 F680                  		movea.l	(v_plc_buffer).w,a0
00881C1E 47F9 0088 1B24             		lea	(loc_1502).l,a3
00881C24 43F8 AA00                  		lea	(v_ngfx_buffer).w,a1
00881C28 3418                       		move.w	(a0)+,d2
00881C2A 6A00                       		bpl.s	loc_160E
00881C2C D6FC 000A                  		adda.w	#$A,a3
00881C30                            
00881C30                            loc_160E:
00881C30 0242 7FFF                  		andi.w	#$7FFF,d2
00881C34                            		;move.w	d2,(f_plc_execute).w	;Mercury LZ After End Sign PLC Bugfix
00881C34 6100 FF1A                  		bsr.w	NemDec4
00881C38 1A18                       		move.b	(a0)+,d5
00881C3A E145                       		asl.w	#8,d5
00881C3C 1A18                       		move.b	(a0)+,d5
00881C3E 7C10                       		moveq	#$10,d6
00881C40 7000                       		moveq	#0,d0
00881C42 21C8 F680                  		move.l	a0,(v_plc_buffer).w
00881C46 21CB F6E0                  		move.l	a3,(v_ptrnemcode).w
00881C4A 21C0 F6E4                  		move.l	d0,($FFFFF6E4).w
00881C4E 21C0 F6E8                  		move.l	d0,($FFFFF6E8).w
00881C52 21C0 F6EC                  		move.l	d0,($FFFFF6EC).w
00881C56 21C5 F6F0                  		move.l	d5,($FFFFF6F0).w
00881C5A 21C6 F6F4                  		move.l	d6,($FFFFF6F4).w
00881C5E                            		
00881C5E 31C2 F6F8                  		move.w	d2,(f_plc_execute).w	;Mercury LZ After End Sign PLC Bugfix
00881C62                            
00881C62                            Rplc_Exit:
00881C62 4E75                       		rts	
00881C64                            ; End of function RunPLC
00881C64                            
00881C64                            
00881C64                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881C64                            
00881C64                            
00881C64                            sub_1642:				; XREF: VBla_04; VBla_12
00881C64 4A78 F6F8                  		tst.w	(f_plc_execute).w
00881C68 6700 0000                  		beq.w	locret_16DA
00881C6C 31FC 0009 F6FA             		move.w	#9,($FFFFF6FA).w
00881C72 7000                       		moveq	#0,d0
00881C74 3038 F684                  		move.w	($FFFFF684).w,d0
00881C78 0678 0120 F684             		addi.w	#$120,($FFFFF684).w
00881C7E 6000                       		bra.s	loc_1676
00881C80                            ; End of function sub_1642
00881C80                            
00881C80                            
00881C80                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881C80                            
00881C80                            
00881C80                            sub_165E:				; XREF: Demo_Time
00881C80 4A78 F6F8                  		tst.w	(f_plc_execute).w
00881C84 6700                       		beq.s	locret_16DA
00881C86 31FC 0003 F6FA             		move.w	#3,($FFFFF6FA).w
00881C8C 7000                       		moveq	#0,d0
00881C8E 3038 F684                  		move.w	($FFFFF684).w,d0
00881C92 0678 0060 F684             		addi.w	#$60,($FFFFF684).w
00881C98                            
00881C98                            loc_1676:				; XREF: sub_1642
00881C98 49F9 00C0 0004             		lea	(vdp_control_port).l,a4
00881C9E E588                       		lsl.l	#2,d0
00881CA0 E448                       		lsr.w	#2,d0
00881CA2 0040 4000                  		ori.w	#$4000,d0
00881CA6 4840                       		swap	d0
00881CA8 2880                       		move.l	d0,(a4)
00881CAA 594C                       		subq.w	#4,a4
00881CAC 2078 F680                  		movea.l	(v_plc_buffer).w,a0
00881CB0 2678 F6E0                  		movea.l	(v_ptrnemcode).w,a3
00881CB4 2038 F6E4                  		move.l	($FFFFF6E4).w,d0
00881CB8 2238 F6E8                  		move.l	($FFFFF6E8).w,d1
00881CBC 2438 F6EC                  		move.l	($FFFFF6EC).w,d2
00881CC0 2A38 F6F0                  		move.l	($FFFFF6F0).w,d5
00881CC4 2C38 F6F4                  		move.l	($FFFFF6F4).w,d6
00881CC8 43F8 AA00                  		lea	(v_ngfx_buffer).w,a1
00881CCC                            
00881CCC                            loc_16AA:				; XREF: sub_165E
00881CCC 3A7C 0008                  		movea.w	#8,a5
00881CD0 6100 FE1C                  		bsr.w	NemDec3
00881CD4 5378 F6F8                  		subq.w	#1,(f_plc_execute).w
00881CD8 6700                       		beq.s	loc_16DC
00881CDA 5378 F6FA                  		subq.w	#1,($FFFFF6FA).w
00881CDE 66EC                       		bne.s	loc_16AA
00881CE0 21C8 F680                  		move.l	a0,(v_plc_buffer).w
00881CE4 21CB F6E0                  		move.l	a3,(v_ptrnemcode).w
00881CE8 21C0 F6E4                  		move.l	d0,($FFFFF6E4).w
00881CEC 21C1 F6E8                  		move.l	d1,($FFFFF6E8).w
00881CF0 21C2 F6EC                  		move.l	d2,($FFFFF6EC).w
00881CF4 21C5 F6F0                  		move.l	d5,($FFFFF6F0).w
00881CF8 21C6 F6F4                  		move.l	d6,($FFFFF6F4).w
00881CFC                            
00881CFC                            locret_16DA:				; XREF: sub_1642
00881CFC 4E75                       		rts	
00881CFE                            ; ===========================================================================
00881CFE                            
00881CFE                            loc_16DC:				; XREF: sub_165E
00881CFE 41F8 F680                  		lea	(v_plc_buffer).w,a0
00881D02 7015                       		moveq	#$15,d0
00881D04                            
00881D04                            loc_16E2:				; XREF: sub_165E
00881D04 20E8 0006                  		move.l	6(a0),(a0)+
00881D08 51C8 FFFA                  		dbf	d0,loc_16E2
00881D0C 4E75                       		rts	
00881D0E                            ; End of function sub_165E
00881D0E                            
00881D0E                            ; ---------------------------------------------------------------------------
00881D0E                            ; Subroutine to	execute	the pattern load cue
00881D0E                            ; ---------------------------------------------------------------------------
00881D0E                            
00881D0E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881D0E                            
00881D0E                            
00881D0E                            QuickPLC:
00881D0E 43F9 0000 0000             		lea	(ArtLoadCues).l,a1 ; load the PLC index
00881D14 D040                       		add.w	d0,d0
00881D16 3031 0000                  		move.w	(a1,d0.w),d0
00881D1A 43F1 0000                  		lea	(a1,d0.w),a1
00881D1E 3219                       		move.w	(a1)+,d1	; get length of PLC
00881D20                            
00881D20                            	Qplc_Loop:
00881D20 2059                       		movea.l	(a1)+,a0	; get art pointer
00881D22 7000                       		moveq	#0,d0
00881D24 3019                       		move.w	(a1)+,d0	; get VRAM address
00881D26 E588                       		lsl.l	#2,d0
00881D28 E448                       		lsr.w	#2,d0
00881D2A 0040 4000                  		ori.w	#$4000,d0
00881D2E 4840                       		swap	d0
00881D30 23C0 00C0 0004             		move.l	d0,(vdp_control_port).l ; converted VRAM address to VDP format
00881D36 6100 FD2A                  		bsr.w	NemDec		; decompress
00881D3A 51C9 FFE4                  		dbf	d1,Qplc_Loop	; repeat for length of PLC
00881D3E 4E75                       		rts	
00881D40                            ; End of function QuickPLC
00881D40                            
00881D40                            		include	"_inc\Enigma Decompression.asm"
00881D40                            ; ---------------------------------------------------------------------------
00881D40                            ; Enigma decompression algorithm
00881D40                            ; ---------------------------------------------------------------------------
00881D40                            
00881D40                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881D40                            
00881D40                            
00881D40                            EniDec:
00881D40 48E7 FF7C                  		movem.l	d0-d7/a1-a5,-(sp)
00881D44 3640                       		movea.w	d0,a3
00881D46 1018                       		move.b	(a0)+,d0
00881D48 4880                       		ext.w	d0
00881D4A 3A40                       		movea.w	d0,a5
00881D4C 1818                       		move.b	(a0)+,d4
00881D4E E70C                       		lsl.b	#3,d4
00881D50 3458                       		movea.w	(a0)+,a2
00881D52 D4CB                       		adda.w	a3,a2
00881D54 3858                       		movea.w	(a0)+,a4
00881D56 D8CB                       		adda.w	a3,a4
00881D58 1A18                       		move.b	(a0)+,d5
00881D5A E145                       		asl.w	#8,d5
00881D5C 1A18                       		move.b	(a0)+,d5
00881D5E 7C10                       		moveq	#$10,d6
00881D60                            
00881D60                            loc_173E:				; XREF: loc_1768
00881D60 7007                       		moveq	#7,d0
00881D62 3E06                       		move.w	d6,d7
00881D64 9E40                       		sub.w	d0,d7
00881D66 3205                       		move.w	d5,d1
00881D68 EE69                       		lsr.w	d7,d1
00881D6A 0241 007F                  		andi.w	#$7F,d1
00881D6E 3401                       		move.w	d1,d2
00881D70 0C41 0040                  		cmpi.w	#$40,d1
00881D74 6400                       		bcc.s	loc_1758
00881D76 7006                       		moveq	#6,d0
00881D78 E24A                       		lsr.w	#1,d2
00881D7A                            
00881D7A                            loc_1758:
00881D7A 6100 0000                  		bsr.w	sub_188C
00881D7E 0242 000F                  		andi.w	#$F,d2
00881D82 E849                       		lsr.w	#4,d1
00881D84 D241                       		add.w	d1,d1
00881D86 4EFB 1000                  		jmp	loc_17B4(pc,d1.w)
00881D8A                            ; End of function EniDec
00881D8A                            
00881D8A                            ; ===========================================================================
00881D8A                            
00881D8A                            loc_1768:				; XREF: loc_17B4
00881D8A 32CA                       		move.w	a2,(a1)+
00881D8C 524A                       		addq.w	#1,a2
00881D8E 51CA FFFA                  		dbf	d2,loc_1768
00881D92 60CC                       		bra.s	loc_173E
00881D94                            ; ===========================================================================
00881D94                            
00881D94                            loc_1772:				; XREF: loc_17B4
00881D94 32CC                       		move.w	a4,(a1)+
00881D96 51CA FFFC                  		dbf	d2,loc_1772
00881D9A 60C4                       		bra.s	loc_173E
00881D9C                            ; ===========================================================================
00881D9C                            
00881D9C                            loc_177A:				; XREF: loc_17B4
00881D9C 6100 0000                  		bsr.w	loc_17DC
00881DA0                            
00881DA0                            loc_177E:
00881DA0 32C1                       		move.w	d1,(a1)+
00881DA2 51CA FFFC                  		dbf	d2,loc_177E
00881DA6 60B8                       		bra.s	loc_173E
00881DA8                            ; ===========================================================================
00881DA8                            
00881DA8                            loc_1786:				; XREF: loc_17B4
00881DA8 6100 0000                  		bsr.w	loc_17DC
00881DAC                            
00881DAC                            loc_178A:
00881DAC 32C1                       		move.w	d1,(a1)+
00881DAE 5241                       		addq.w	#1,d1
00881DB0 51CA FFFA                  		dbf	d2,loc_178A
00881DB4 60AA                       		bra.s	loc_173E
00881DB6                            ; ===========================================================================
00881DB6                            
00881DB6                            loc_1794:				; XREF: loc_17B4
00881DB6 6100 0000                  		bsr.w	loc_17DC
00881DBA                            
00881DBA                            loc_1798:
00881DBA 32C1                       		move.w	d1,(a1)+
00881DBC 5341                       		subq.w	#1,d1
00881DBE 51CA FFFA                  		dbf	d2,loc_1798
00881DC2 609C                       		bra.s	loc_173E
00881DC4                            ; ===========================================================================
00881DC4                            
00881DC4                            loc_17A2:				; XREF: loc_17B4
00881DC4 0C42 000F                  		cmpi.w	#$F,d2
00881DC8 6700                       		beq.s	loc_17C4
00881DCA                            
00881DCA                            loc_17A8:
00881DCA 6100 0000                  		bsr.w	loc_17DC
00881DCE 32C1                       		move.w	d1,(a1)+
00881DD0 51CA FFF8                  		dbf	d2,loc_17A8
00881DD4 608A                       		bra.s	loc_173E
00881DD6                            ; ===========================================================================
00881DD6                            
00881DD6                            loc_17B4:				; XREF: EniDec
00881DD6 60B2                       		bra.s	loc_1768
00881DD8                            ; ===========================================================================
00881DD8 60B0                       		bra.s	loc_1768
00881DDA                            ; ===========================================================================
00881DDA 60B8                       		bra.s	loc_1772
00881DDC                            ; ===========================================================================
00881DDC 60B6                       		bra.s	loc_1772
00881DDE                            ; ===========================================================================
00881DDE 60BC                       		bra.s	loc_177A
00881DE0                            ; ===========================================================================
00881DE0 60C6                       		bra.s	loc_1786
00881DE2                            ; ===========================================================================
00881DE2 60D2                       		bra.s	loc_1794
00881DE4                            ; ===========================================================================
00881DE4 60DE                       		bra.s	loc_17A2
00881DE6                            ; ===========================================================================
00881DE6                            
00881DE6                            loc_17C4:				; XREF: loc_17A2
00881DE6 5348                       		subq.w	#1,a0
00881DE8 0C46 0010                  		cmpi.w	#$10,d6
00881DEC 6600                       		bne.s	loc_17CE
00881DEE 5348                       		subq.w	#1,a0
00881DF0                            
00881DF0                            loc_17CE:
00881DF0 3008                       		move.w	a0,d0
00881DF2 E248                       		lsr.w	#1,d0
00881DF4 6400                       		bcc.s	loc_17D6
00881DF6 5248                       		addq.w	#1,a0
00881DF8                            
00881DF8                            loc_17D6:
00881DF8 4CDF 3EFF                  		movem.l	(sp)+,d0-d7/a1-a5
00881DFC 4E75                       		rts	
00881DFE                            ; ===========================================================================
00881DFE                            
00881DFE                            loc_17DC:				; XREF: loc_17A2
00881DFE 360B                       		move.w	a3,d3
00881E00 1204                       		move.b	d4,d1
00881E02 D201                       		add.b	d1,d1
00881E04 6400                       		bcc.s	loc_17EE
00881E06 5346                       		subq.w	#1,d6
00881E08 0D05                       		btst	d6,d5
00881E0A 6700                       		beq.s	loc_17EE
00881E0C 0043 8000                  		ori.w	#$8000,d3
00881E10                            
00881E10                            loc_17EE:
00881E10 D201                       		add.b	d1,d1
00881E12 6400                       		bcc.s	loc_17FC
00881E14 5346                       		subq.w	#1,d6
00881E16 0D05                       		btst	d6,d5
00881E18 6700                       		beq.s	loc_17FC
00881E1A 0643 4000                  		addi.w	#$4000,d3
00881E1E                            
00881E1E                            loc_17FC:
00881E1E D201                       		add.b	d1,d1
00881E20 6400                       		bcc.s	loc_180A
00881E22 5346                       		subq.w	#1,d6
00881E24 0D05                       		btst	d6,d5
00881E26 6700                       		beq.s	loc_180A
00881E28 0643 2000                  		addi.w	#$2000,d3
00881E2C                            
00881E2C                            loc_180A:
00881E2C D201                       		add.b	d1,d1
00881E2E 6400                       		bcc.s	loc_1818
00881E30 5346                       		subq.w	#1,d6
00881E32 0D05                       		btst	d6,d5
00881E34 6700                       		beq.s	loc_1818
00881E36 0043 1000                  		ori.w	#$1000,d3
00881E3A                            
00881E3A                            loc_1818:
00881E3A D201                       		add.b	d1,d1
00881E3C 6400                       		bcc.s	loc_1826
00881E3E 5346                       		subq.w	#1,d6
00881E40 0D05                       		btst	d6,d5
00881E42 6700                       		beq.s	loc_1826
00881E44 0043 0800                  		ori.w	#$800,d3
00881E48                            
00881E48                            loc_1826:
00881E48 3205                       		move.w	d5,d1
00881E4A 3E06                       		move.w	d6,d7
00881E4C 9E4D                       		sub.w	a5,d7
00881E4E 6400                       		bcc.s	loc_1856
00881E50 3C07                       		move.w	d7,d6
00881E52 0646 0010                  		addi.w	#$10,d6
00881E56 4447                       		neg.w	d7
00881E58 EF69                       		lsl.w	d7,d1
00881E5A 1A10                       		move.b	(a0),d5
00881E5C EF3D                       		rol.b	d7,d5
00881E5E DE47                       		add.w	d7,d7
00881E60 CA7B 7000                  		and.w	word_186C-2(pc,d7.w),d5
00881E64 D245                       		add.w	d5,d1
00881E66                            
00881E66                            loc_1844:				; XREF: loc_1868
00881E66 300D                       		move.w	a5,d0
00881E68 D040                       		add.w	d0,d0
00881E6A C27B 0000                  		and.w	word_186C-2(pc,d0.w),d1
00881E6E D243                       		add.w	d3,d1
00881E70 1A18                       		move.b	(a0)+,d5
00881E72 E14D                       		lsl.w	#8,d5
00881E74 1A18                       		move.b	(a0)+,d5
00881E76 4E75                       		rts	
00881E78                            ; ===========================================================================
00881E78                            
00881E78                            loc_1856:				; XREF: loc_1826
00881E78 6700                       		beq.s	loc_1868
00881E7A EE69                       		lsr.w	d7,d1
00881E7C 300D                       		move.w	a5,d0
00881E7E D040                       		add.w	d0,d0
00881E80 C27B 0000                  		and.w	word_186C-2(pc,d0.w),d1
00881E84 D243                       		add.w	d3,d1
00881E86 300D                       		move.w	a5,d0
00881E88 6000                       		bra.s	sub_188C
00881E8A                            ; ===========================================================================
00881E8A                            
00881E8A                            loc_1868:				; XREF: loc_1856
00881E8A 7C10                       		moveq	#$10,d6
00881E8C                            
00881E8C                            loc_186A:
00881E8C 60D8                       		bra.s	loc_1844
00881E8E                            ; ===========================================================================
00881E8E 0001 0003 0007 000F 001F+  word_186C:	dc.w 1,	3, 7, $F, $1F, $3F, $7F, $FF, $1FF, $3FF, $7FF
00881EA4 0FFF 1FFF 3FFF 7FFF FFFF   		dc.w $FFF, $1FFF, $3FFF, $7FFF,	$FFFF	; XREF: loc_1856
00881EAE                            
00881EAE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881EAE                            
00881EAE                            
00881EAE                            sub_188C:				; XREF: EniDec
00881EAE 9C40                       		sub.w	d0,d6
00881EB0 0C46 0009                  		cmpi.w	#9,d6
00881EB4 6400                       		bcc.s	locret_189A
00881EB6 5046                       		addq.w	#8,d6
00881EB8 E145                       		asl.w	#8,d5
00881EBA 1A18                       		move.b	(a0)+,d5
00881EBC                            
00881EBC                            locret_189A:
00881EBC 4E75                       		rts	
00881EBE                            ; End of function sub_188C
00881EBE                            ; End of function sub_188C
00881EBE                            		include	"_inc\Kosinski Decompression.asm"
00881EBE                            ; ---------------------------------------------------------------------------
00881EBE                            ; Kosinski decompression algorithm
00881EBE                            
00881EBE                            ; input:
00881EBE                            ;	a0 = source address
00881EBE                            ;	a1 = destination address
00881EBE                            
00881EBE                            ; usage:
00881EBE                            ;	lea	(source).l,a0
00881EBE                            ;	lea	(destination).l,a1
00881EBE                            ;	bsr.w	KosDec
00881EBE                            ; ---------------------------------------------------------------------------
00881EBE                            
00881EBE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881EBE                            
00881EBE                            
00881EBE                            KosDec:
00881EBE                            
00881EBE 558F                       		subq.l	#2,sp	; make space for 2 bytes on the stack
00881EC0 1F58 0001                  		move.b	(a0)+,1(sp)
00881EC4 1E98                       		move.b	(a0)+,(sp)
00881EC6 3A17                       		move.w	(sp),d5	; get first description field
00881EC8 780F                       		moveq	#$F,d4	; set to loop for 16 bits
00881ECA                            
00881ECA                            Kos_Loop:
00881ECA E24D                       		lsr.w	#1,d5	; shift bit into the c flag
00881ECC 40C6                       		move	sr,d6
00881ECE 51CC 0000                  		dbf	d4,@chkbit
00881ED2 1F58 0001                  		move.b	(a0)+,1(sp)
00881ED6 1E98                       		move.b	(a0)+,(sp)
00881ED8 3A17                       		move.w	(sp),d5
00881EDA 780F                       		moveq	#$F,d4
00881EDC                            
00881EDC                            	@chkbit:
00881EDC 44C6                       		move	d6,ccr	; was the bit set?
00881EDE 6400                       		bcc.s	Kos_RLE	; if not, branch
00881EE0                            
00881EE0 12D8                       		move.b	(a0)+,(a1)+ ; copy byte as-is
00881EE2 60E6                       		bra.s	Kos_Loop
00881EE4                            ; ===========================================================================
00881EE4                            
00881EE4                            Kos_RLE:				; XREF: KosDec
00881EE4 7600                       		moveq	#0,d3
00881EE6 E24D                       		lsr.w	#1,d5	; get next bit
00881EE8 40C6                       		move	sr,d6
00881EEA 51CC 0000                  		dbf	d4,@chkbit
00881EEE 1F58 0001                  		move.b	(a0)+,1(sp)
00881EF2 1E98                       		move.b	(a0)+,(sp)
00881EF4 3A17                       		move.w	(sp),d5
00881EF6 780F                       		moveq	#$F,d4
00881EF8                            
00881EF8                            	@chkbit:
00881EF8 44C6                       		move	d6,ccr	; was the bit set?
00881EFA 6500                       		bcs.s	Kos_SeparateRLE ; if yes, branch
00881EFC                            
00881EFC E24D                       		lsr.w	#1,d5	; shift bit into the x flag
00881EFE 51CC 0000                  		dbf	d4,@loop1
00881F02 1F58 0001                  		move.b	(a0)+,1(sp)
00881F06 1E98                       		move.b	(a0)+,(sp)
00881F08 3A17                       		move.w	(sp),d5
00881F0A 780F                       		moveq	#$F,d4
00881F0C                            
00881F0C                            	@loop1:
00881F0C E353                       		roxl.w	#1,d3	; get high repeat count bit
00881F0E E24D                       		lsr.w	#1,d5
00881F10 51CC 0000                  		dbf	d4,@loop2
00881F14 1F58 0001                  		move.b	(a0)+,1(sp)
00881F18 1E98                       		move.b	(a0)+,(sp)
00881F1A 3A17                       		move.w	(sp),d5
00881F1C 780F                       		moveq	#$F,d4
00881F1E                            
00881F1E                            	@loop2:
00881F1E E353                       		roxl.w	#1,d3	; get low repeat count bit
00881F20 5243                       		addq.w	#1,d3	; increment repeat count
00881F22 74FF                       		moveq	#-1,d2
00881F24 1418                       		move.b	(a0)+,d2 ; calculate offset
00881F26 6000                       		bra.s	Kos_RLELoop
00881F28                            ; ===========================================================================
00881F28                            
00881F28                            Kos_SeparateRLE:			; XREF: Kos_RLE
00881F28 1018                       		move.b	(a0)+,d0 ; get first byte
00881F2A 1218                       		move.b	(a0)+,d1 ; get second byte
00881F2C 74FF                       		moveq	#-1,d2
00881F2E 1401                       		move.b	d1,d2
00881F30 EB4A                       		lsl.w	#5,d2
00881F32 1400                       		move.b	d0,d2	; calculate offset
00881F34 0241 0007                  		andi.w	#7,d1	; does a third byte need to be read?
00881F38 6700                       		beq.s	Kos_SeparateRLE2 ; if yes, branch
00881F3A 1601                       		move.b	d1,d3	; copy repeat count
00881F3C 5243                       		addq.w	#1,d3	; increment
00881F3E                            
00881F3E                            Kos_RLELoop:
00881F3E 1031 2000                  		move.b	(a1,d2.w),d0 ; copy appropriate byte
00881F42 12C0                       		move.b	d0,(a1)+ ; repeat
00881F44 51CB FFF8                  		dbf	d3,Kos_RLELoop
00881F48 6080                       		bra.s	Kos_Loop
00881F4A                            ; ===========================================================================
00881F4A                            
00881F4A                            Kos_SeparateRLE2:			; XREF: Kos_SeparateRLE
00881F4A 1218                       		move.b	(a0)+,d1
00881F4C 6700                       		beq.s	Kos_Done ; 0 indicates end of compressed data
00881F4E 0C01 0001                  		cmpi.b	#1,d1
00881F52 6700 FF76                  		beq.w	Kos_Loop ; 1 indicates new description to be read
00881F56 1601                       		move.b	d1,d3	; otherwise, copy repeat count
00881F58 60E4                       		bra.s	Kos_RLELoop
00881F5A                            ; ===========================================================================
00881F5A                            
00881F5A                            Kos_Done:				; XREF: Kos_SeparateRLE2
00881F5A 548F                       		addq.l	#2,sp	; restore stack pointer
00881F5C 4E75                       		rts	
00881F5E                            ; End of function KosDec
00881F5E                            ; End of function KosDec
00881F5E                            
00881F5E                            		include	"_inc\PaletteCycle.asm"
00881F5E                            ; ---------------------------------------------------------------------------
00881F5E                            ; Palette cycling routine loading subroutine
00881F5E                            ; ---------------------------------------------------------------------------
00881F5E                            
00881F5E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881F5E                            
00881F5E                            
00881F5E                            PaletteCycle:				; XREF: GotoDemo; Level_MainLoop; End_MainLoop
00881F5E 7400                       		moveq	#0,d2
00881F60 7000                       		moveq	#0,d0
00881F62 1038 FE10                  		move.b	(v_zone).w,d0	; get level number
00881F66 D040                       		add.w	d0,d0
00881F68 303B 0000                  		move.w	PCycle_Index(pc,d0.w),d0
00881F6C 4EFB 0000                  		jmp	PCycle_Index(pc,d0.w) ; jump to relevant palette routine
00881F70                            ; End of function PaletteCycle
00881F70                            
00881F70                            ; ===========================================================================
00881F70                            ; ---------------------------------------------------------------------------
00881F70                            ; Palette cycling routines
00881F70                            ; ---------------------------------------------------------------------------
00881F70 0000                       PCycle_Index:	dc.w PCycle_GHZ-PCycle_Index
00881F72 0000                       		dc.w PCycle_LZ-PCycle_Index
00881F74 0000                       		dc.w PCycle_MZ-PCycle_Index
00881F76 0000                       		dc.w PalCycle_SLZ-PCycle_Index
00881F78 0000                       		dc.w PalCycle_SYZ-PCycle_Index
00881F7A 0000                       		dc.w PalCycle_SBZ-PCycle_Index
00881F7C 0000                       		dc.w PCycle_GHZ-PCycle_Index
00881F7E                            
00881F7E                            
00881F7E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881F7E                            
00881F7E                            
00881F7E                            PCycle_Title:				; XREF: GM_TitleScr
00881F7E 41F9 0000 0000             		lea	(Pal_TitleCyc).l,a0
00881F84 6000                       		bra.s	PCycGHZ_Go
00881F86                            ; ===========================================================================
00881F86                            
00881F86                            PCycle_GHZ:				; XREF: PCycle_Index
00881F86 41F9 0000 0000             		lea	(Pal_GHZCyc).l,a0
00881F8C                            
00881F8C                            PCycGHZ_Go:
00881F8C 5378 F634                  		subq.w	#1,(v_pcyc_time).w ; decrement timer
00881F90 6A00                       		bpl.s	PCycGHZ_Skip	; if time remains, branch
00881F92                            
00881F92 31FC 0005 F634             		move.w	#5,(v_pcyc_time).w ; reset timer to 5 frames
00881F98 3038 F632                  		move.w	(v_pcyc_num).w,d0 ; get cycle number
00881F9C 5278 F632                  		addq.w	#1,(v_pcyc_num).w ; increment cycle number
00881FA0 0240 0003                  		andi.w	#3,d0		; if cycle > 3, reset to 0
00881FA4 E748                       		lsl.w	#3,d0
00881FA6 43F8 FB50                  		lea	(v_pal_dry+$50).w,a1
00881FAA 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00881FAE 22B0 0004                  		move.l	4(a0,d0.w),(a1)	; copy palette data to RAM
00881FB2                            
00881FB2                            PCycGHZ_Skip:
00881FB2 4E75                       		rts	
00881FB4                            ; End of function PCycle_GHZ
00881FB4                            
00881FB4                            
00881FB4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00881FB4                            
00881FB4                            
00881FB4                            PCycle_LZ:				; XREF: PCycle_Index
00881FB4                            ; Waterfalls
00881FB4 5378 F634                  		subq.w	#1,(v_pcyc_time).w ; decrement timer
00881FB8 6A00                       		bpl.s	PCycLZ_Skip1	; if time remains, branch
00881FBA                            
00881FBA 31FC 0002 F634             		move.w	#2,(v_pcyc_time).w ; reset timer to 2 frames
00881FC0 3038 F632                  		move.w	(v_pcyc_num).w,d0
00881FC4 5278 F632                  		addq.w	#1,(v_pcyc_num).w ; increment cycle number
00881FC8 0240 0003                  		andi.w	#3,d0		; if cycle > 3, reset to 0
00881FCC E748                       		lsl.w	#3,d0
00881FCE 41F9 0000 0000             		lea	(Pal_LZCyc1).l,a0
00881FD4 0C38 0003 FE11             		cmpi.b	#3,(v_act).w	; check if level is SBZ3
00881FDA 6600                       		bne.s	PCycLZ_NotSBZ3
00881FDC 41F9 0000 0000             		lea	(Pal_SBZ3Cyc1).l,a0 ; load SBZ3	palette instead
00881FE2                            
00881FE2                            	PCycLZ_NotSBZ3:
00881FE2 43F8 FB56                  		lea	(v_pal_dry+$56).w,a1
00881FE6 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00881FEA 22B0 0004                  		move.l	4(a0,d0.w),(a1)
00881FEE 43F8 FAD6                  		lea	(v_pal_water+$56).w,a1
00881FF2 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00881FF6 22B0 0004                  		move.l	4(a0,d0.w),(a1)
00881FFA                            
00881FFA                            PCycLZ_Skip1:
00881FFA                            ; Conveyor belts
00881FFA 3038 FE04                  		move.w	(v_framecount).w,d0
00881FFE 0240 0007                  		andi.w	#7,d0
00882002 103B 0000                  		move.b	PCycLZ_Seq(pc,d0.w),d0 ; get byte from palette sequence
00882006 6700                       		beq.s	PCycLZ_Skip2	; if byte is 0, branch
00882008 7201                       		moveq	#1,d1
0088200A 4A38 F7C0                  		tst.b	(f_conveyrev).w	; have conveyor belts been reversed?
0088200E 6700                       		beq.s	PCycLZ_NoRev	; if not, branch
00882010 4441                       		neg.w	d1
00882012                            
00882012                            	PCycLZ_NoRev:
00882012 3038 F650                  		move.w	(v_pal_buffer).w,d0
00882016 0240 0003                  		andi.w	#3,d0
0088201A D041                       		add.w	d1,d0
0088201C 0C40 0003                  		cmpi.w	#3,d0
00882020 6500                       		bcs.s	loc_1A0A
00882022 3200                       		move.w	d0,d1
00882024 7000                       		moveq	#0,d0
00882026 4A41                       		tst.w	d1
00882028 6A00                       		bpl.s	loc_1A0A
0088202A 7002                       		moveq	#2,d0
0088202C                            
0088202C                            loc_1A0A:
0088202C 31C0 F650                  		move.w	d0,(v_pal_buffer).w
00882030 D040                       		add.w	d0,d0
00882032 3200                       		move.w	d0,d1
00882034 D040                       		add.w	d0,d0
00882036 D041                       		add.w	d1,d0
00882038 41F9 0000 0000             		lea	(Pal_LZCyc2).l,a0
0088203E 43F8 FB76                  		lea	(v_pal_dry+$76).w,a1
00882042 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00882046 32B0 0004                  		move.w	4(a0,d0.w),(a1)
0088204A 41F9 0000 0000             		lea	(Pal_LZCyc3).l,a0
00882050 43F8 FAF6                  		lea	(v_pal_water+$76).w,a1
00882054 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00882058 32B0 0004                  		move.w	4(a0,d0.w),(a1)
0088205C                            
0088205C                            PCycLZ_Skip2:
0088205C 4E75                       		rts	
0088205E                            ; End of function PCycle_LZ
0088205E                            
0088205E                            ; ===========================================================================
0088205E 0100 0001 0000 0100        PCycLZ_Seq:	dc.b 1,	0, 0, 1, 0, 0, 1, 0
00882066                            ; ===========================================================================
00882066                            
00882066                            PCycle_MZ:				; XREF: PCycle_Index
00882066 4E75                       		rts	
00882068                            
00882068                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882068                            
00882068                            
00882068                            PalCycle_SLZ:				; XREF: PCycle_Index
00882068 5378 F634                  		subq.w	#1,(v_pcyc_time).w
0088206C 6A00                       		bpl.s	locret_1A80
0088206E 31FC 0007 F634             		move.w	#7,(v_pcyc_time).w
00882074 3038 F632                  		move.w	(v_pcyc_num).w,d0
00882078 5240                       		addq.w	#1,d0
0088207A 0C40 0006                  		cmpi.w	#6,d0
0088207E 6500                       		bcs.s	loc_1A60
00882080 7000                       		moveq	#0,d0
00882082                            
00882082                            loc_1A60:
00882082 31C0 F632                  		move.w	d0,(v_pcyc_num).w
00882086 3200                       		move.w	d0,d1
00882088 D241                       		add.w	d1,d1
0088208A D041                       		add.w	d1,d0
0088208C D040                       		add.w	d0,d0
0088208E 41F9 0000 0000             		lea	(Pal_SLZCyc).l,a0
00882094 43F8 FB56                  		lea	(v_pal_dry+$56).w,a1
00882098 32B0 0000                  		move.w	(a0,d0.w),(a1)
0088209C 2370 0002 0004             		move.l	2(a0,d0.w),4(a1)
008820A2                            
008820A2                            locret_1A80:
008820A2 4E75                       		rts	
008820A4                            ; End of function PalCycle_SLZ
008820A4                            
008820A4                            
008820A4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008820A4                            
008820A4                            
008820A4                            PalCycle_SYZ:				; XREF: PCycle_Index
008820A4 5378 F634                  		subq.w	#1,(v_pcyc_time).w
008820A8 6A00                       		bpl.s	locret_1AC6
008820AA 31FC 0005 F634             		move.w	#5,(v_pcyc_time).w
008820B0 3038 F632                  		move.w	(v_pcyc_num).w,d0
008820B4 5278 F632                  		addq.w	#1,(v_pcyc_num).w
008820B8 0240 0003                  		andi.w	#3,d0
008820BC E548                       		lsl.w	#2,d0
008820BE 3200                       		move.w	d0,d1
008820C0 D040                       		add.w	d0,d0
008820C2 41F9 0000 0000             		lea	(Pal_SYZCyc1).l,a0
008820C8 43F8 FB6E                  		lea	(v_pal_dry+$6E).w,a1
008820CC 22F0 0000                  		move.l	(a0,d0.w),(a1)+
008820D0 22B0 0004                  		move.l	4(a0,d0.w),(a1)
008820D4 41F9 0000 0000             		lea	(Pal_SYZCyc2).l,a0
008820DA 43F8 FB76                  		lea	(v_pal_dry+$76).w,a1
008820DE 32B0 1000                  		move.w	(a0,d1.w),(a1)
008820E2 3370 1002 0004             		move.w	2(a0,d1.w),4(a1)
008820E8                            
008820E8                            locret_1AC6:
008820E8 4E75                       		rts	
008820EA                            ; End of function PalCycle_SYZ
008820EA                            
008820EA                            
008820EA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008820EA                            
008820EA                            
008820EA                            PalCycle_SBZ:				; XREF: PCycle_Index
008820EA 45F9 0000 0000             		lea	(Pal_SBZCycList1).l,a2
008820F0 4A38 FE11                  		tst.b	(v_act).w
008820F4 6700                       		beq.s	loc_1ADA
008820F6 45F9 0000 0000             		lea	(Pal_SBZCycList2).l,a2
008820FC                            
008820FC                            loc_1ADA:
008820FC 43F8 F650                  		lea	(v_pal_buffer).w,a1
00882100 321A                       		move.w	(a2)+,d1
00882102                            
00882102                            loc_1AE0:
00882102 5311                       		subq.b	#1,(a1)
00882104 6B00                       		bmi.s	loc_1AEA
00882106 5489                       		addq.l	#2,a1
00882108 5C8A                       		addq.l	#6,a2
0088210A 6000                       		bra.s	loc_1B06
0088210C                            ; ===========================================================================
0088210C                            
0088210C                            loc_1AEA:				; XREF: PalCycle_SBZ
0088210C 12DA                       		move.b	(a2)+,(a1)+
0088210E 1011                       		move.b	(a1),d0
00882110 5200                       		addq.b	#1,d0
00882112 B01A                       		cmp.b	(a2)+,d0
00882114 6500                       		bcs.s	loc_1AF6
00882116 7000                       		moveq	#0,d0
00882118                            
00882118                            loc_1AF6:
00882118 12C0                       		move.b	d0,(a1)+
0088211A 0240 000F                  		andi.w	#$F,d0
0088211E D040                       		add.w	d0,d0
00882120 305A                       		movea.w	(a2)+,a0
00882122 365A                       		movea.w	(a2)+,a3
00882124 36B0 0000                  		move.w	(a0,d0.w),(a3)
00882128                            
00882128                            loc_1B06:				; XREF: PalCycle_SBZ
00882128 51C9 FFD8                  		dbf	d1,loc_1AE0
0088212C 5378 F634                  		subq.w	#1,(v_pcyc_time).w
00882130 6A00                       		bpl.s	locret_1B64
00882132 41F9 0000 0000             		lea	(Pal_SBZCyc4).l,a0
00882138 31FC 0001 F634             		move.w	#1,(v_pcyc_time).w
0088213E 4A38 FE11                  		tst.b	(v_act).w
00882142 6700                       		beq.s	loc_1B2E
00882144 41F9 0000 0000             		lea	(Pal_SBZCyc10).l,a0
0088214A 31FC 0000 F634             		move.w	#0,(v_pcyc_time).w
00882150                            
00882150                            loc_1B2E:
00882150 72FF                       		moveq	#-1,d1
00882152 4A38 F7C0                  		tst.b	(f_conveyrev).w
00882156 6700                       		beq.s	loc_1B38
00882158 4441                       		neg.w	d1
0088215A                            
0088215A                            loc_1B38:
0088215A 3038 F632                  		move.w	(v_pcyc_num).w,d0
0088215E 0240 0003                  		andi.w	#3,d0
00882162 D041                       		add.w	d1,d0
00882164 0C40 0003                  		cmpi.w	#3,d0
00882168 6500                       		bcs.s	loc_1B52
0088216A 3200                       		move.w	d0,d1
0088216C 7000                       		moveq	#0,d0
0088216E 4A41                       		tst.w	d1
00882170 6A00                       		bpl.s	loc_1B52
00882172 7002                       		moveq	#2,d0
00882174                            
00882174                            loc_1B52:
00882174 31C0 F632                  		move.w	d0,(v_pcyc_num).w
00882178 D040                       		add.w	d0,d0
0088217A 43F8 FB58                  		lea	(v_pal_dry+$58).w,a1
0088217E 22F0 0000                  		move.l	(a0,d0.w),(a1)+
00882182 32B0 0004                  		move.w	4(a0,d0.w),(a1)
00882186                            
00882186                            locret_1B64:
00882186 4E75                       		rts	
00882188                            ; End of function PalCycle_SBZ
00882188                            ; End of function PalCycle_SBZ
00882188                            
00882188                            Pal_TitleCyc:	incbin	"palette\Cycle - Title Screen Water.bin"
008821A8                            Pal_GHZCyc:	incbin	"palette\Cycle - GHZ.bin"
008821C8                            Pal_LZCyc1:	incbin	"palette\Cycle - LZ Waterfall.bin"
008821E8                            Pal_LZCyc2:	incbin	"palette\Cycle - LZ Conveyor Belt.bin"
008821FA                            Pal_LZCyc3:	incbin	"palette\Cycle - LZ Conveyor Belt Underwater.bin"
0088220C                            Pal_SBZ3Cyc1:	incbin	"palette\Cycle - SBZ3 Waterfall.bin"
00882274                            Pal_SLZCyc:	incbin	"palette\Cycle - SLZ.bin"
00882298                            Pal_SYZCyc1:	incbin	"palette\Cycle - SYZ1.bin"
008822B8                            Pal_SYZCyc2:	incbin	"palette\Cycle - SYZ2.bin"
008822C8                            
008822C8                            		include	"_inc\SBZ Palette Scripts.asm"
008822C8                            ; ---------------------------------------------------------------------------
008822C8                            ; Scrap Brain Zone palette cycling script
008822C8                            ; ---------------------------------------------------------------------------
008822C8                            
008822C8                            mSBZp:	macro
008822C8                            	dc.b \1, \2
008822C8                            	dc.l \3
008822C8                            	dc.w \4
008822C8                            	endm
008822C8                            
008822C8                            ; duration in frames, number of colours, palette address, RAM address
008822C8                            
008822C8                            Pal_SBZCycList1:
008822C8 0000                       	dc.w ((end_SBZCycList1-Pal_SBZCycList1-2)/6)-1
008822CA 0708 0000 0000 FB50        	mSBZp	7,8,Pal_SBZCyc1,$FB50
008822D2 0D08 0000 0000 FB52        	mSBZp	$D,8,Pal_SBZCyc2,$FB52
008822DA 0E08 0000 0000 FB6E        	mSBZp	$E,8,Pal_SBZCyc3,$FB6E
008822E2 0B08 0000 0000 FB70        	mSBZp	$B,8,Pal_SBZCyc5,$FB70
008822EA 0708 0000 0000 FB72        	mSBZp	7,8,Pal_SBZCyc6,$FB72
008822F2 1C10 0000 0000 FB7E        	mSBZp	$1C,$10,Pal_SBZCyc7,$FB7E
008822FA 0303 0000 0000 FB78        	mSBZp	3,3,Pal_SBZCyc8,$FB78
00882302 0303 0000 0000 FB7A        	mSBZp	3,3,Pal_SBZCyc8+2,$FB7A
0088230A 0303 0000 0000 FB7C        	mSBZp	3,3,Pal_SBZCyc8+4,$FB7C
00882312                            end_SBZCycList1:
00882312                            	even
00882312                            
00882312                            Pal_SBZCycList2:
00882312 0000                       	dc.w ((end_SBZCycList2-Pal_SBZCycList2-2)/6)-1
00882314 0708 0000 0000 FB50        	mSBZp	7,8,Pal_SBZCyc1,$FB50
0088231C 0D08 0000 0000 FB52        	mSBZp	$D,8,Pal_SBZCyc2,$FB52
00882324 0908 0000 0000 FB70        	mSBZp	9,8,Pal_SBZCyc9,$FB70
0088232C 0708 0000 0000 FB72        	mSBZp	7,8,Pal_SBZCyc6,$FB72
00882334 0303 0000 0000 FB78        	mSBZp	3,3,Pal_SBZCyc8,$FB78
0088233C 0303 0000 0000 FB7A        	mSBZp	3,3,Pal_SBZCyc8+2,$FB7A
00882344 0303 0000 0000 FB7C        	mSBZp	3,3,Pal_SBZCyc8+4,$FB7C
0088234C                            end_SBZCycList2:
0088234C                            	even
0088234C                            	even
0088234C                            
0088234C                            Pal_SBZCyc1:	incbin	"palette\Cycle - SBZ 1.bin"
0088235C                            Pal_SBZCyc2:	incbin	"palette\Cycle - SBZ 2.bin"
0088236C                            Pal_SBZCyc3:	incbin	"palette\Cycle - SBZ 3.bin"
0088237C                            Pal_SBZCyc4:	incbin	"palette\Cycle - SBZ 4.bin"
00882388                            Pal_SBZCyc5:	incbin	"palette\Cycle - SBZ 5.bin"
00882398                            Pal_SBZCyc6:	incbin	"palette\Cycle - SBZ 6.bin"
008823A8                            Pal_SBZCyc7:	incbin	"palette\Cycle - SBZ 7.bin"
008823C8                            Pal_SBZCyc8:	incbin	"palette\Cycle - SBZ 8.bin"
008823D2                            Pal_SBZCyc9:	incbin	"palette\Cycle - SBZ 9.bin"
008823E2                            Pal_SBZCyc10:	incbin	"palette\Cycle - SBZ 10.bin"
008823EE                            ; ---------------------------------------------------------------------------
008823EE                            ; Subroutine to	fade in from black
008823EE                            ; ---------------------------------------------------------------------------
008823EE                            
008823EE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008823EE                            
008823EE                            
008823EE                            PaletteFadeIn:
008823EE 31FC 003F F626             		move.w	#$003F,(v_pfade_start).w ; set start position = 0; size = $40
008823F4                            
008823F4                            PalFadeIn_Alt:				; start position and size are already set
008823F4 7000                       		moveq	#0,d0
008823F6 41F8 FB00                  		lea	(v_pal_dry).w,a0
008823FA 1038 F626                  		move.b	(v_pfade_start).w,d0
008823FE D0C0                       		adda.w	d0,a0
00882400 7200                       		moveq	#cBlack,d1
00882402 1038 F627                  		move.b	(v_pfade_size).w,d0
00882406                            
00882406                            	@fill:
00882406 30C1                       		move.w	d1,(a0)+
00882408 51C8 FFFC                  		dbf	d0,@fill 	; fill palette with black
0088240C                            
0088240C 383C 0015                  		move.w	#$15,d4
00882410                            
00882410                            	@mainloop:
00882410 11FC 0012 F62A             		move.b	#$12,(v_vbla_routine).w
00882416 6100 0000                  		bsr.w	WaitForVBla
0088241A 6100                       		bsr.s	FadeIn_FromBlack
0088241C 6100 F7F0                  		bsr.w	RunPLC
00882420 51CC FFEE                  		dbf	d4,@mainloop
00882424 4E75                       		rts	
00882426                            ; End of function PaletteFadeIn
00882426                            
00882426                            
00882426                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882426                            
00882426                            
00882426                            FadeIn_FromBlack:			; XREF: PaletteFadeIn
00882426 7000                       		moveq	#0,d0
00882428 41F8 FB00                  		lea	(v_pal_dry).w,a0
0088242C 43F8 FB80                  		lea	(v_pal_dry_dup).w,a1
00882430 1038 F626                  		move.b	(v_pfade_start).w,d0
00882434 D0C0                       		adda.w	d0,a0
00882436 D2C0                       		adda.w	d0,a1
00882438 1038 F627                  		move.b	(v_pfade_size).w,d0
0088243C                            
0088243C                            	@addcolour:
0088243C 6100                       		bsr.s	FadeIn_AddColour ; increase colour
0088243E 51C8 FFFC                  		dbf	d0,@addcolour	; repeat for size of palette
00882442                            
00882442 0C38 0001 FE10             		cmpi.b	#1,(v_zone).w	; is level Labyrinth?
00882448 6600                       		bne.s	@exit		; if not, branch
0088244A                            
0088244A 7000                       		moveq	#0,d0
0088244C 41F8 FA80                  		lea	(v_pal_water).w,a0
00882450 43F8 FA00                  		lea	(v_pal_water_dup).w,a1
00882454 1038 F626                  		move.b	(v_pfade_start).w,d0
00882458 D0C0                       		adda.w	d0,a0
0088245A D2C0                       		adda.w	d0,a1
0088245C 1038 F627                  		move.b	(v_pfade_size).w,d0
00882460                            
00882460                            	@addcolour2:
00882460 6100                       		bsr.s	FadeIn_AddColour ; increase colour again
00882462 51C8 FFFC                  		dbf	d0,@addcolour2 ; repeat
00882466                            
00882466                            @exit:
00882466 4E75                       		rts	
00882468                            ; End of function FadeIn_FromBlack
00882468                            
00882468                            
00882468                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882468                            
00882468                            
00882468                            FadeIn_AddColour:			; XREF: FadeIn_FromBlack
00882468                            @addblue:
00882468 3419                       		move.w	(a1)+,d2
0088246A 3610                       		move.w	(a0),d3
0088246C B642                       		cmp.w	d2,d3		; is colour already at threshold level?
0088246E 6700                       		beq.s	@next		; if yes, branch
00882470 3203                       		move.w	d3,d1
00882472 0641 0200                  		addi.w	#$200,d1	; increase blue	value
00882476 B242                       		cmp.w	d2,d1		; has blue reached threshold level?
00882478 6200                       		bhi.s	@addgreen	; if yes, branch
0088247A 30C1                       		move.w	d1,(a0)+	; update palette
0088247C 4E75                       		rts	
0088247E                            ; ===========================================================================
0088247E                            
0088247E                            @addgreen:
0088247E 3203                       		move.w	d3,d1
00882480 0641 0020                  		addi.w	#$20,d1		; increase green value
00882484 B242                       		cmp.w	d2,d1
00882486 6200                       		bhi.s	@addred
00882488 30C1                       		move.w	d1,(a0)+	; update palette
0088248A 4E75                       		rts	
0088248C                            ; ===========================================================================
0088248C                            
0088248C                            @addred:
0088248C 5458                       		addq.w	#2,(a0)+	; increase red value
0088248E 4E75                       		rts	
00882490                            ; ===========================================================================
00882490                            
00882490                            @next:
00882490 5448                       		addq.w	#2,a0		; next colour
00882492 4E75                       		rts	
00882494                            ; End of function FadeIn_AddColour
00882494                            
00882494                            
00882494                            ; ---------------------------------------------------------------------------
00882494                            ; Subroutine to fade out to black
00882494                            ; ---------------------------------------------------------------------------
00882494                            
00882494                            
00882494                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882494                            
00882494                            
00882494                            PaletteFadeOut:
00882494 31FC 003F F626             		move.w	#$003F,(v_pfade_start).w ; start position = 0; size = $40
0088249A 383C 0015                  		move.w	#$15,d4
0088249E                            
0088249E                            	@mainloop:
0088249E 11FC 0012 F62A             		move.b	#$12,(v_vbla_routine).w
008824A4 6100 0000                  		bsr.w	WaitForVBla
008824A8 6100                       		bsr.s	FadeOut_ToBlack
008824AA 6100 F762                  		bsr.w	RunPLC
008824AE 51CC FFEE                  		dbf	d4,@mainloop
008824B2 4E75                       		rts	
008824B4                            ; End of function PaletteFadeOut
008824B4                            
008824B4                            
008824B4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008824B4                            
008824B4                            
008824B4                            FadeOut_ToBlack:			; XREF: PaletteFadeOut
008824B4 7000                       		moveq	#0,d0
008824B6 41F8 FB00                  		lea	(v_pal_dry).w,a0
008824BA 1038 F626                  		move.b	(v_pfade_start).w,d0
008824BE D0C0                       		adda.w	d0,a0
008824C0 1038 F627                  		move.b	(v_pfade_size).w,d0
008824C4                            
008824C4                            	@decolour:
008824C4 6100                       		bsr.s	FadeOut_DecColour ; decrease colour
008824C6 51C8 FFFC                  		dbf	d0,@decolour	; repeat for size of palette
008824CA                            
008824CA 7000                       		moveq	#0,d0
008824CC 41F8 FA80                  		lea	(v_pal_water).w,a0
008824D0 1038 F626                  		move.b	(v_pfade_start).w,d0
008824D4 D0C0                       		adda.w	d0,a0
008824D6 1038 F627                  		move.b	(v_pfade_size).w,d0
008824DA                            
008824DA                            	@decolour2:
008824DA 6100                       		bsr.s	FadeOut_DecColour
008824DC 51C8 FFFC                  		dbf	d0,@decolour2
008824E0 4E75                       		rts	
008824E2                            ; End of function FadeOut_ToBlack
008824E2                            
008824E2                            
008824E2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008824E2                            
008824E2                            
008824E2                            FadeOut_DecColour:			; XREF: FadeOut_ToBlack
008824E2                            @dered:
008824E2 3410                       		move.w	(a0),d2
008824E4 6700                       		beq.s	@next
008824E6 3202                       		move.w	d2,d1
008824E8 0241 000E                  		andi.w	#$E,d1
008824EC 6700                       		beq.s	@degreen
008824EE 5558                       		subq.w	#2,(a0)+	; decrease red value
008824F0 4E75                       		rts	
008824F2                            ; ===========================================================================
008824F2                            
008824F2                            @degreen:
008824F2 3202                       		move.w	d2,d1
008824F4 0241 00E0                  		andi.w	#$E0,d1
008824F8 6700                       		beq.s	@deblue
008824FA 0458 0020                  		subi.w	#$20,(a0)+	; decrease green value
008824FE 4E75                       		rts	
00882500                            ; ===========================================================================
00882500                            
00882500                            @deblue:
00882500 3202                       		move.w	d2,d1
00882502 0241 0E00                  		andi.w	#$E00,d1
00882506 6700                       		beq.s	@next
00882508 0458 0200                  		subi.w	#$200,(a0)+	; decrease blue	value
0088250C 4E75                       		rts	
0088250E                            ; ===========================================================================
0088250E                            
0088250E                            @next:
0088250E 5448                       		addq.w	#2,a0
00882510 4E75                       		rts	
00882512                            ; End of function FadeOut_DecColour
00882512                            
00882512                            ; ---------------------------------------------------------------------------
00882512                            ; Subroutine to	fade in from white (Special Stage)
00882512                            ; ---------------------------------------------------------------------------
00882512                            
00882512                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882512                            
00882512                            
00882512                            PaletteWhiteIn:				; XREF: GM_Special
00882512 31FC 003F F626             		move.w	#$003F,(v_pfade_start).w ; start position = 0; size = $40
00882518 7000                       		moveq	#0,d0
0088251A 41F8 FB00                  		lea	(v_pal_dry).w,a0
0088251E 1038 F626                  		move.b	(v_pfade_start).w,d0
00882522 D0C0                       		adda.w	d0,a0
00882524 323C 0EEE                  		move.w	#cWhite,d1
00882528 1038 F627                  		move.b	(v_pfade_size).w,d0
0088252C                            
0088252C                            	@fill:
0088252C 30C1                       		move.w	d1,(a0)+
0088252E 51C8 FFFC                  		dbf	d0,@fill 	; fill palette with white
00882532                            
00882532 383C 0015                  		move.w	#$15,d4
00882536                            
00882536                            	@mainloop:
00882536 11FC 0012 F62A             		move.b	#$12,(v_vbla_routine).w
0088253C 6100 0000                  		bsr.w	WaitForVBla
00882540 6100                       		bsr.s	WhiteIn_FromWhite
00882542 6100 F6CA                  		bsr.w	RunPLC
00882546 51CC FFEE                  		dbf	d4,@mainloop
0088254A 4E75                       		rts	
0088254C                            ; End of function PaletteWhiteIn
0088254C                            
0088254C                            
0088254C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088254C                            
0088254C                            
0088254C                            WhiteIn_FromWhite:			; XREF: PaletteWhiteIn
0088254C 7000                       		moveq	#0,d0
0088254E 41F8 FB00                  		lea	(v_pal_dry).w,a0
00882552 43F8 FB80                  		lea	(v_pal_dry_dup).w,a1
00882556 1038 F626                  		move.b	(v_pfade_start).w,d0
0088255A D0C0                       		adda.w	d0,a0
0088255C D2C0                       		adda.w	d0,a1
0088255E 1038 F627                  		move.b	(v_pfade_size).w,d0
00882562                            
00882562                            	@decolour:
00882562 6100                       		bsr.s	WhiteIn_DecColour ; decrease colour
00882564 51C8 FFFC                  		dbf	d0,@decolour	; repeat for size of palette
00882568                            
00882568 0C38 0001 FE10             		cmpi.b	#1,(v_zone).w	; is level Labyrinth?
0088256E 6600                       		bne.s	@exit		; if not, branch
00882570 7000                       		moveq	#0,d0
00882572 41F8 FA80                  		lea	(v_pal_water).w,a0
00882576 43F8 FA00                  		lea	(v_pal_water_dup).w,a1
0088257A 1038 F626                  		move.b	(v_pfade_start).w,d0
0088257E D0C0                       		adda.w	d0,a0
00882580 D2C0                       		adda.w	d0,a1
00882582 1038 F627                  		move.b	(v_pfade_size).w,d0
00882586                            
00882586                            	@decolour2:
00882586 6100                       		bsr.s	WhiteIn_DecColour
00882588 51C8 FFFC                  		dbf	d0,@decolour2
0088258C                            
0088258C                            	@exit:
0088258C 4E75                       		rts	
0088258E                            ; End of function WhiteIn_FromWhite
0088258E                            
0088258E                            
0088258E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088258E                            
0088258E                            
0088258E                            WhiteIn_DecColour:			; XREF: WhiteIn_FromWhite
0088258E                            @deblue:
0088258E 3419                       		move.w	(a1)+,d2
00882590 3610                       		move.w	(a0),d3
00882592 B642                       		cmp.w	d2,d3
00882594 6700                       		beq.s	@next
00882596 3203                       		move.w	d3,d1
00882598 0441 0200                  		subi.w	#$200,d1	; decrease blue	value
0088259C 6500                       		blo.s	@degreen
0088259E B242                       		cmp.w	d2,d1
008825A0 6500                       		blo.s	@degreen
008825A2 30C1                       		move.w	d1,(a0)+
008825A4 4E75                       		rts	
008825A6                            ; ===========================================================================
008825A6                            
008825A6                            @degreen:
008825A6 3203                       		move.w	d3,d1
008825A8 0441 0020                  		subi.w	#$20,d1		; decrease green value
008825AC 6500                       		blo.s	@dered
008825AE B242                       		cmp.w	d2,d1
008825B0 6500                       		blo.s	@dered
008825B2 30C1                       		move.w	d1,(a0)+
008825B4 4E75                       		rts	
008825B6                            ; ===========================================================================
008825B6                            
008825B6                            @dered:
008825B6 5558                       		subq.w	#2,(a0)+	; decrease red value
008825B8 4E75                       		rts	
008825BA                            ; ===========================================================================
008825BA                            
008825BA                            @next:
008825BA 5448                       		addq.w	#2,a0
008825BC 4E75                       		rts	
008825BE                            ; End of function WhiteIn_DecColour
008825BE                            
008825BE                            ; ---------------------------------------------------------------------------
008825BE                            ; Subroutine to fade to white (Special Stage)
008825BE                            ; ---------------------------------------------------------------------------
008825BE                            
008825BE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008825BE                            
008825BE                            
008825BE                            PaletteWhiteOut:			; XREF: GM_Special
008825BE 31FC 003F F626             		move.w	#$003F,(v_pfade_start).w ; start position = 0; size = $40
008825C4 383C 0015                  		move.w	#$15,d4
008825C8                            
008825C8                            	@mainloop:
008825C8 11FC 0012 F62A             		move.b	#$12,(v_vbla_routine).w
008825CE 6100 0000                  		bsr.w	WaitForVBla
008825D2 6100                       		bsr.s	WhiteOut_ToWhite
008825D4 6100 F638                  		bsr.w	RunPLC
008825D8 51CC FFEE                  		dbf	d4,@mainloop
008825DC 4E75                       		rts	
008825DE                            ; End of function PaletteWhiteOut
008825DE                            
008825DE                            
008825DE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008825DE                            
008825DE                            
008825DE                            WhiteOut_ToWhite:			; XREF: PaletteWhiteOut
008825DE 7000                       		moveq	#0,d0
008825E0 41F8 FB00                  		lea	(v_pal_dry).w,a0
008825E4 1038 F626                  		move.b	(v_pfade_start).w,d0
008825E8 D0C0                       		adda.w	d0,a0
008825EA 1038 F627                  		move.b	(v_pfade_size).w,d0
008825EE                            
008825EE                            	@addcolour:
008825EE 6100                       		bsr.s	WhiteOut_AddColour
008825F0 51C8 FFFC                  		dbf	d0,@addcolour
008825F4                            
008825F4 7000                       		moveq	#0,d0
008825F6 41F8 FA80                  		lea	(v_pal_water).w,a0
008825FA 1038 F626                  		move.b	(v_pfade_start).w,d0
008825FE D0C0                       		adda.w	d0,a0
00882600 1038 F627                  		move.b	(v_pfade_size).w,d0
00882604                            
00882604                            	@addcolour2:
00882604 6100                       		bsr.s	WhiteOut_AddColour
00882606 51C8 FFFC                  		dbf	d0,@addcolour2
0088260A 4E75                       		rts	
0088260C                            ; End of function WhiteOut_ToWhite
0088260C                            
0088260C                            
0088260C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088260C                            
0088260C                            
0088260C                            WhiteOut_AddColour:			; XREF: WhiteOut_ToWhite
0088260C                            @addred:
0088260C 3410                       		move.w	(a0),d2
0088260E 0C42 0EEE                  		cmpi.w	#cWhite,d2
00882612 6700                       		beq.s	@next
00882614 3202                       		move.w	d2,d1
00882616 0241 000E                  		andi.w	#$E,d1
0088261A 0C41 000E                  		cmpi.w	#cRed,d1
0088261E 6700                       		beq.s	@addgreen
00882620 5458                       		addq.w	#2,(a0)+	; increase red value
00882622 4E75                       		rts	
00882624                            ; ===========================================================================
00882624                            
00882624                            @addgreen:
00882624 3202                       		move.w	d2,d1
00882626 0241 00E0                  		andi.w	#$E0,d1
0088262A 0C41 00E0                  		cmpi.w	#cGreen,d1
0088262E 6700                       		beq.s	@addblue
00882630 0658 0020                  		addi.w	#$20,(a0)+	; increase green value
00882634 4E75                       		rts	
00882636                            ; ===========================================================================
00882636                            
00882636                            @addblue:
00882636 3202                       		move.w	d2,d1
00882638 0241 0E00                  		andi.w	#$E00,d1
0088263C 0C41 0E00                  		cmpi.w	#cBlue,d1
00882640 6700                       		beq.s	@next
00882642 0658 0200                  		addi.w	#$200,(a0)+	; increase blue	value
00882646 4E75                       		rts	
00882648                            ; ===========================================================================
00882648                            
00882648                            @next:
00882648 5448                       		addq.w	#2,a0
0088264A 4E75                       		rts	
0088264C                            ; End of function WhiteOut_AddColour
0088264C                            
0088264C                            ; ---------------------------------------------------------------------------
0088264C                            ; Palette cycling routine - Sega logo
0088264C                            ; ---------------------------------------------------------------------------
0088264C                            
0088264C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088264C                            
0088264C                            
0088264C                            PalCycle_Sega:				; XREF: GM_Sega
0088264C 4A38 F635                  		tst.b	(v_pcyc_time+1).w
00882650 6600                       		bne.s	loc_206A
00882652 43F8 FB20                  		lea	(v_pal_dry+$20).w,a1
00882656 41F9 0000 0000             		lea	(Pal_Sega1).l,a0
0088265C 7205                       		moveq	#5,d1
0088265E 3038 F632                  		move.w	(v_pcyc_num).w,d0
00882662                            
00882662                            loc_2020:
00882662 6A00                       		bpl.s	loc_202A
00882664 5448                       		addq.w	#2,a0
00882666 5341                       		subq.w	#1,d1
00882668 5440                       		addq.w	#2,d0
0088266A 60F6                       		bra.s	loc_2020
0088266C                            ; ===========================================================================
0088266C                            
0088266C                            loc_202A:				; XREF: PalCycle_Sega
0088266C 3400                       		move.w	d0,d2
0088266E 0242 001E                  		andi.w	#$1E,d2
00882672 6600                       		bne.s	loc_2034
00882674 5440                       		addq.w	#2,d0
00882676                            
00882676                            loc_2034:
00882676 0C40 0060                  		cmpi.w	#$60,d0
0088267A 6400                       		bcc.s	loc_203E
0088267C 3398 0000                  		move.w	(a0)+,(a1,d0.w)
00882680                            
00882680                            loc_203E:
00882680 5440                       		addq.w	#2,d0
00882682 51C9 FFE8                  		dbf	d1,loc_202A
00882686                            
00882686 3038 F632                  		move.w	(v_pcyc_num).w,d0
0088268A 5440                       		addq.w	#2,d0
0088268C 3400                       		move.w	d0,d2
0088268E 0242 001E                  		andi.w	#$1E,d2
00882692 6600                       		bne.s	loc_2054
00882694 5440                       		addq.w	#2,d0
00882696                            
00882696                            loc_2054:
00882696 0C40 0064                  		cmpi.w	#$64,d0
0088269A 6D00                       		blt.s	loc_2062
0088269C 31FC 0401 F634             		move.w	#$401,(v_pcyc_time).w
008826A2 70F4                       		moveq	#-$C,d0
008826A4                            
008826A4                            loc_2062:
008826A4 31C0 F632                  		move.w	d0,(v_pcyc_num).w
008826A8 7001                       		moveq	#1,d0
008826AA 4E75                       		rts	
008826AC                            ; ===========================================================================
008826AC                            
008826AC                            loc_206A:				; XREF: loc_202A
008826AC 5338 F634                  		subq.b	#1,(v_pcyc_time).w
008826B0 6A00                       		bpl.s	loc_20BC
008826B2 11FC 0004 F634             		move.b	#4,(v_pcyc_time).w
008826B8 3038 F632                  		move.w	(v_pcyc_num).w,d0
008826BC 0640 000C                  		addi.w	#$C,d0
008826C0 0C40 0030                  		cmpi.w	#$30,d0
008826C4 6500                       		bcs.s	loc_2088
008826C6 7000                       		moveq	#0,d0
008826C8 4E75                       		rts	
008826CA                            ; ===========================================================================
008826CA                            
008826CA                            loc_2088:				; XREF: loc_206A
008826CA 31C0 F632                  		move.w	d0,(v_pcyc_num).w
008826CE 41F9 0000 0000             		lea	(Pal_Sega2).l,a0
008826D4 41F0 0000                  		lea	(a0,d0.w),a0
008826D8 43F8 FB04                  		lea	(v_pal_dry+$04).w,a1
008826DC 22D8                       		move.l	(a0)+,(a1)+
008826DE 22D8                       		move.l	(a0)+,(a1)+
008826E0 3298                       		move.w	(a0)+,(a1)
008826E2 43F8 FB20                  		lea	(v_pal_dry+$20).w,a1
008826E6 7000                       		moveq	#0,d0
008826E8 722C                       		moveq	#$2C,d1
008826EA                            
008826EA                            loc_20A8:
008826EA 3400                       		move.w	d0,d2
008826EC 0242 001E                  		andi.w	#$1E,d2
008826F0 6600                       		bne.s	loc_20B2
008826F2 5440                       		addq.w	#2,d0
008826F4                            
008826F4                            loc_20B2:
008826F4 3390 0000                  		move.w	(a0),(a1,d0.w)
008826F8 5440                       		addq.w	#2,d0
008826FA 51C9 FFEE                  		dbf	d1,loc_20A8
008826FE                            
008826FE                            loc_20BC:
008826FE 7001                       		moveq	#1,d0
00882700 4E75                       		rts	
00882702                            ; End of function PalCycle_Sega
00882702                            
00882702                            ; ===========================================================================
00882702                            
00882702                            Pal_Sega1:	incbin	"palette\Sega1.bin"
0088270E                            Pal_Sega2:	incbin	"palette\Sega2.bin"
0088273E                            
0088273E                            ; ---------------------------------------------------------------------------
0088273E                            ; Subroutines to load palettes
0088273E                            
0088273E                            ; input:
0088273E                            ;	d0 = index number for palette
0088273E                            ; ---------------------------------------------------------------------------
0088273E                            
0088273E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088273E                            
0088273E                            
0088273E                            PalLoad1:
0088273E 43F9 0000 0000             		lea	(PalPointers).l,a1
00882744 E748                       		lsl.w	#3,d0
00882746 D2C0                       		adda.w	d0,a1
00882748 2459                       		movea.l	(a1)+,a2	; get palette data address
0088274A 3659                       		movea.w	(a1)+,a3	; get target RAM address
0088274C D6FC 0080                  		adda.w	#$80,a3		; skip to "main" RAM address
00882750 3E19                       		move.w	(a1)+,d7	; get length of palette data
00882752                            
00882752                            	@loop:
00882752 26DA                       		move.l	(a2)+,(a3)+	; move data to RAM
00882754 51CF FFFC                  		dbf	d7,@loop
00882758 4E75                       		rts	
0088275A                            ; End of function PalLoad1
0088275A                            
0088275A                            
0088275A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088275A                            
0088275A                            
0088275A                            PalLoad2:
0088275A 43F9 0000 0000             		lea	(PalPointers).l,a1
00882760 E748                       		lsl.w	#3,d0
00882762 D2C0                       		adda.w	d0,a1
00882764 2459                       		movea.l	(a1)+,a2	; get palette data address
00882766 3659                       		movea.w	(a1)+,a3	; get target RAM address
00882768 3E19                       		move.w	(a1)+,d7	; get length of palette
0088276A                            
0088276A                            	@loop:
0088276A 26DA                       		move.l	(a2)+,(a3)+	; move data to RAM
0088276C 51CF FFFC                  		dbf	d7,@loop
00882770 4E75                       		rts	
00882772                            ; End of function PalLoad2
00882772                            
00882772                            ; ---------------------------------------------------------------------------
00882772                            ; Underwater palette loading subroutine
00882772                            ; ---------------------------------------------------------------------------
00882772                            
00882772                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882772                            
00882772                            
00882772                            PalLoad3_Water:
00882772 43F9 0000 0000             		lea	(PalPointers).l,a1
00882778 E748                       		lsl.w	#3,d0
0088277A D2C0                       		adda.w	d0,a1
0088277C 2459                       		movea.l	(a1)+,a2	; get palette data address
0088277E 3659                       		movea.w	(a1)+,a3	; get target RAM address
00882780 96FC 0080                  		suba.w	#$80,a3		; skip to "main" RAM address
00882784 3E19                       		move.w	(a1)+,d7	; get length of palette data
00882786                            
00882786                            	@loop:
00882786 26DA                       		move.l	(a2)+,(a3)+	; move data to RAM
00882788 51CF FFFC                  		dbf	d7,@loop
0088278C 4E75                       		rts	
0088278E                            ; End of function PalLoad3_Water
0088278E                            
0088278E                            
0088278E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088278E                            
0088278E                            
0088278E                            PalLoad4_Water:
0088278E 43F9 0000 0000             		lea	(PalPointers).l,a1
00882794 E748                       		lsl.w	#3,d0
00882796 D2C0                       		adda.w	d0,a1
00882798 2459                       		movea.l	(a1)+,a2	; get palette data address
0088279A 3659                       		movea.w	(a1)+,a3	; get target RAM address
0088279C 96FC 0100                  		suba.w	#$100,a3
008827A0 3E19                       		move.w	(a1)+,d7	; get length of palette data
008827A2                            
008827A2                            	@loop:
008827A2 26DA                       		move.l	(a2)+,(a3)+	; move data to RAM
008827A4 51CF FFFC                  		dbf	d7,@loop
008827A8 4E75                       		rts	
008827AA                            ; End of function PalLoad4_Water
008827AA                            
008827AA                            ; ===========================================================================
008827AA                            
008827AA                            		include	"_inc\Palette Pointers.asm"
008827AA                            ; ---------------------------------------------------------------------------
008827AA                            ; Palette pointers
008827AA                            ; ---------------------------------------------------------------------------
008827AA                            
008827AA                            palp:	macro paladdress,ramaddress,colours
008827AA                            	dc.l paladdress
008827AA                            	dc.w ramaddress, (colours>>1)-1
008827AA                            	endm
008827AA                            
008827AA                            PalPointers:
008827AA                            
008827AA                            ; palette address, RAM address, colours
008827AA                            
008827AA 0000 0000 FB00 001F        ptr_Pal_SegaBG:		palp	Pal_SegaBG,$FB00,$40		; 0 - Sega logo
008827B2                            
008827B2 0000 0000 FB00 001F        ptr_Pal_Title:		palp	Pal_Title,$FB00,$40		; 1 - title screen
008827BA 0000 0000 FB00 001F        ptr_Pal_LevelSel:	palp	Pal_LevelSel,$FB00,$40		; 2 - level select
008827C2 0000 0000 FB00 0007        ptr_Pal_Sonic:		palp	Pal_Sonic,$FB00,$10		; 3 - Sonic
008827CA                            Pal_Levels:
008827CA 0000 0000 FB20 0017        ptr_Pal_GHZ:		palp	Pal_GHZ,$FB20, $30		; 4 - GHZ
008827D2 0000 0000 FB20 0017        ptr_Pal_LZ:		palp	Pal_LZ,$FB20,$30		; 5 - LZ
008827DA 0000 0000 FB20 0017        ptr_Pal_MZ:		palp	Pal_MZ,$FB20,$30		; 6 - MZ
008827E2 0000 0000 FB20 0017        ptr_Pal_SLZ:		palp	Pal_SLZ,$FB20,$30		; 7 - SLZ
008827EA 0000 0000 FB20 0017        ptr_Pal_SYZ:		palp	Pal_SYZ,$FB20,$30		; 8 - SYZ
008827F2 0000 0000 FB20 0017        ptr_Pal_SBZ1:		palp	Pal_SBZ1,$FB20,$30		; 9 - SBZ1
008827FA 0000 0000 FB00 001F        ptr_Pal_Special:	palp	Pal_Special,$FB00,$40		; $A (10) - special stage
00882802 0000 0000 FB00 001F        ptr_Pal_LZWater:	palp	Pal_LZWater,$FB00,$40		; $B (11) - LZ underwater
0088280A 0000 0000 FB20 0017        ptr_Pal_SBZ3:		palp	Pal_SBZ3,$FB20,$30		; $C (12) - SBZ3
00882812 0000 0000 FB00 001F        ptr_Pal_SBZ3Water:	palp	Pal_SBZ3Water,$FB00,$40		; $D (13) - SBZ3 underwater
0088281A 0000 0000 FB20 0017        ptr_Pal_SBZ2:		palp	Pal_SBZ2,$FB20,$30		; $E (14) - SBZ2
00882822 0000 0000 FB00 0007        ptr_Pal_LZSonWater:	palp	Pal_LZSonWater,$FB00,$10	; $F (15) - LZ Sonic underwater
0088282A 0000 0000 FB00 0007        ptr_Pal_SBZ3SonWat:	palp	Pal_SBZ3SonWat,$FB00,$10	; $10 (16) - SBZ3 Sonic underwater
00882832 0000 0000 FB00 001F        ptr_Pal_SSResult:	palp	Pal_SSResult,$FB00,$40		; $11 (17) - special stage results
0088283A 0000 0000 FB00 000F        ptr_Pal_Continue:	palp	Pal_Continue,$FB00,$20		; $12 (18) - special stage results continue
00882842 0000 0000 FB00 001F        ptr_Pal_Ending:		palp	Pal_Ending,$FB00,$40		; $13 (19) - ending sequence
0088284A                            			even
0088284A                            
0088284A                            
0088284A =00000000                  palid_SegaBG:		equ (ptr_Pal_SegaBG-PalPointers)/8
0088284A =00000001                  palid_Title:		equ (ptr_Pal_Title-PalPointers)/8
0088284A =00000002                  palid_LevelSel:		equ (ptr_Pal_LevelSel-PalPointers)/8
0088284A =00000003                  palid_Sonic:		equ (ptr_Pal_Sonic-PalPointers)/8
0088284A =00000004                  palid_GHZ:		equ (ptr_Pal_GHZ-PalPointers)/8
0088284A =00000005                  palid_LZ:		equ (ptr_Pal_LZ-PalPointers)/8
0088284A =00000006                  palid_MZ:		equ (ptr_Pal_MZ-PalPointers)/8
0088284A =00000007                  palid_SLZ:		equ (ptr_Pal_SLZ-PalPointers)/8
0088284A =00000008                  palid_SYZ:		equ (ptr_Pal_SYZ-PalPointers)/8
0088284A =00000009                  palid_SBZ1:		equ (ptr_Pal_SBZ1-PalPointers)/8
0088284A =0000000A                  palid_Special:		equ (ptr_Pal_Special-PalPointers)/8
0088284A =0000000B                  palid_LZWater:		equ (ptr_Pal_LZWater-PalPointers)/8
0088284A =0000000C                  palid_SBZ3:		equ (ptr_Pal_SBZ3-PalPointers)/8
0088284A =0000000D                  palid_SBZ3Water:	equ (ptr_Pal_SBZ3Water-PalPointers)/8
0088284A =0000000E                  palid_SBZ2:		equ (ptr_Pal_SBZ2-PalPointers)/8
0088284A =0000000F                  palid_LZSonWater:	equ (ptr_Pal_LZSonWater-PalPointers)/8
0088284A =00000010                  palid_SBZ3SonWat:	equ (ptr_Pal_SBZ3SonWat-PalPointers)/8
0088284A =00000011                  palid_SSResult:		equ (ptr_Pal_SSResult-PalPointers)/8
0088284A =00000012                  palid_Continue:		equ (ptr_Pal_Continue-PalPointers)/8
0088284A =00000013                  palid_Ending:		equ (ptr_Pal_Ending-PalPointers)/8
0088284A =00000013                  palid_Ending:		equ (ptr_Pal_Ending-PalPointers)/8
0088284A                            
0088284A                            ; ---------------------------------------------------------------------------
0088284A                            ; Palette data
0088284A                            ; ---------------------------------------------------------------------------
0088284A                            Pal_SegaBG:	incbin	"palette\Sega Background.bin"
008828CA                            Pal_Title:	incbin	"palette\Title Screen.bin"
0088294A                            Pal_LevelSel:	incbin	"palette\Level Select.bin"
008829CA                            
008829CA                            Pal_Sonic:	incbin	"palette\Sonic.bin"
008829EA                            Pal_GHZ:	incbin	"palette\Green Hill Zone.bin"
00882A4A                            
00882A4A                            Pal_LZ:		incbin	"palette\Labyrinth Zone.bin"
00882AAA                            Pal_LZWater:	incbin	"palette\Labyrinth Zone Underwater.bin"
00882B2A                            
00882B2A                            Pal_MZ:		incbin	"palette\Marble Zone.bin"
00882B8A                            Pal_SLZ:	incbin	"palette\Star Light Zone.bin"
00882BEA                            
00882BEA                            Pal_SYZ:	incbin	"palette\Spring Yard Zone.bin"
00882C4A                            Pal_SBZ1:	incbin	"palette\SBZ Act 1.bin"
00882CAA                            Pal_SBZ2:	incbin	"palette\SBZ Act 2.bin"
00882D0A                            Pal_Special:	incbin	"palette\Special Stage.bin"
00882D8A                            Pal_SBZ3:	incbin	"palette\SBZ Act 3.bin"
00882DEA                            Pal_SBZ3Water:	incbin	"palette\SBZ Act 3 Underwater.bin"
00882E6A                            Pal_LZSonWater:	incbin	"palette\Sonic - LZ Underwater.bin"
00882E8A                            Pal_SBZ3SonWat:	incbin	"palette\Sonic - SBZ3 Underwater.bin"
00882EAA                            Pal_SSResult:	incbin	"palette\Special Stage Results.bin"
00882F2A                            Pal_Continue:	incbin	"palette\Special Stage Continue Bonus.bin"
00882F6A                            Pal_Ending:	incbin	"palette\Ending.bin"
00882FEA                            
00882FEA                            ; ---------------------------------------------------------------------------
00882FEA                            ; Subroutine to	wait for VBlank routines to complete
00882FEA                            ; ---------------------------------------------------------------------------
00882FEA                            
00882FEA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882FEA                            
00882FEA                            
00882FEA                            WaitForVBla:				; XREF: PauseGame
00882FEA 46FC 2300                  		enable_ints
00882FEE                            
00882FEE                            	@wait:
00882FEE 4A38 F62A                  		tst.b	(v_vbla_routine).w ; has VBlank routine finished?
00882FF2 66FA                       		bne.s	@wait		; if not, branch
00882FF4 4E75                       		rts	
00882FF6                            ; End of function WaitForVBla
00882FF6                            
00882FF6                            		include	"_incObj\sub RandomNumber.asm"
00882FF6                            ; ---------------------------------------------------------------------------
00882FF6                            ; Subroutine to	generate a pseudo-random number	in d0
00882FF6                            ; ---------------------------------------------------------------------------
00882FF6                            
00882FF6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00882FF6                            
00882FF6                            
00882FF6                            RandomNumber:
00882FF6 2238 F636                  		move.l	(v_random).w,d1
00882FFA 6600                       		bne.s	@scramble	; if d0 is not 0, branch
00882FFC 223C 2A6D 365A             		move.l	#$2A6D365A,d1	; if do is 0, use seed number
00883002                            
00883002                            	@scramble:
00883002 2001                       		move.l	d1,d0
00883004 E581                       		asl.l	#2,d1
00883006 D280                       		add.l	d0,d1
00883008 E781                       		asl.l	#3,d1
0088300A D280                       		add.l	d0,d1
0088300C 3001                       		move.w	d1,d0
0088300E 4841                       		swap	d1
00883010 D041                       		add.w	d1,d0
00883012 3200                       		move.w	d0,d1
00883014 4841                       		swap	d1
00883016 21C1 F636                  		move.l	d1,(v_random).w
0088301A 4E75                       		rts	
0088301A 4E75                       		rts	
0088301C                            		include	"_incObj\sub CalcSine.asm"
0088301C                            ; ---------------------------------------------------------------------------
0088301C                            ; Subroutine calculate a sine
0088301C                            
0088301C                            ; input:
0088301C                            ;	d0 = angle
0088301C                            
0088301C                            ; output:
0088301C                            ;	d0 = sine
0088301C                            ;	d1 = cosine
0088301C                            ; ---------------------------------------------------------------------------
0088301C                            
0088301C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088301C                            
0088301C                            
0088301C                            CalcSine:				; XREF: SS_BGAnimate; et al
0088301C 0240 00FF                  		andi.w	#$FF,d0
00883020 D040                       		add.w	d0,d0
00883022 0640 0080                  		addi.w	#$80,d0
00883026 323B 0000                  		move.w	Sine_Data(pc,d0.w),d1
0088302A 0440 0080                  		subi.w	#$80,d0
0088302E 303B 0000                  		move.w	Sine_Data(pc,d0.w),d0
00883032 4E75                       		rts	
00883034                            ; End of function CalcSine
00883034                            
00883034                            ; ===========================================================================
00883034                            
00883034                            Sine_Data:	incbin	"misc\sinewave.bin"	; values for a 360 sine wave
008832B4                            
008832B4                            ; ===========================================================================
008832B4                            
008832B4                            	
008832B4                            	
008832B4                            		include	"_incObj\sub CalcAngle.asm"
008832B4                            ; ---------------------------------------------------------------------------
008832B4                            ; Subroutine calculate an angle
008832B4                            
008832B4                            ; input:
008832B4                            ;	d1 = x-axis distance
008832B4                            ;	d2 = y-axis distance
008832B4                            
008832B4                            ; output:
008832B4                            ;	d0 = angle
008832B4                            ; ---------------------------------------------------------------------------
008832B4                            
008832B4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008832B4                            
008832B4                            
008832B4                            CalcAngle:
008832B4 48E7 1800                  		movem.l	d3-d4,-(sp)
008832B8 7600                       		moveq	#0,d3
008832BA 7800                       		moveq	#0,d4
008832BC 3601                       		move.w	d1,d3
008832BE 3802                       		move.w	d2,d4
008832C0 8843                       		or.w	d3,d4
008832C2 6700                       		beq.s	loc_2D04
008832C4 3802                       		move.w	d2,d4
008832C6 4A43                       		tst.w	d3
008832C8 6A00 0000                  		bpl.w	loc_2CC2
008832CC 4443                       		neg.w	d3
008832CE                            
008832CE                            loc_2CC2:
008832CE 4A44                       		tst.w	d4
008832D0 6A00 0000                  		bpl.w	loc_2CCA
008832D4 4444                       		neg.w	d4
008832D6                            
008832D6                            loc_2CCA:
008832D6 B843                       		cmp.w	d3,d4
008832D8 6400 0000                  		bcc.w	loc_2CDC
008832DC E18C                       		lsl.l	#8,d4
008832DE 88C3                       		divu.w	d3,d4
008832E0 7000                       		moveq	#0,d0
008832E2 103B 4000                  		move.b	Angle_Data(pc,d4.w),d0
008832E6 6000                       		bra.s	loc_2CE6
008832E8                            ; ===========================================================================
008832E8                            
008832E8                            loc_2CDC:
008832E8 E18B                       		lsl.l	#8,d3
008832EA 86C4                       		divu.w	d4,d3
008832EC 7040                       		moveq	#$40,d0
008832EE 903B 3000                  		sub.b	Angle_Data(pc,d3.w),d0
008832F2                            
008832F2                            loc_2CE6:
008832F2 4A41                       		tst.w	d1
008832F4 6A00 0000                  		bpl.w	loc_2CF2
008832F8 4440                       		neg.w	d0
008832FA 0640 0080                  		addi.w	#$80,d0
008832FE                            
008832FE                            loc_2CF2:
008832FE 4A42                       		tst.w	d2
00883300 6A00 0000                  		bpl.w	loc_2CFE
00883304 4440                       		neg.w	d0
00883306 0640 0100                  		addi.w	#$100,d0
0088330A                            
0088330A                            loc_2CFE:
0088330A 4CDF 0018                  		movem.l	(sp)+,d3-d4
0088330E 4E75                       		rts	
00883310                            ; ===========================================================================
00883310                            
00883310                            loc_2D04:
00883310 303C 0040                  		move.w	#$40,d0
00883314 4CDF 0018                  		movem.l	(sp)+,d3-d4
00883318 4E75                       		rts	
0088331A                            ; End of function CalcAngle
0088331A                            
0088331A                            ; ===========================================================================
0088331A                            
0088331A                            Angle_Data:	incbin	misc\angles.bin
0088341C                            
0088341C                            ; ===========================================================================
0088341C                            ; ===========================================================================
0088341C                            
0088341C                            ; ---------------------------------------------------------------------------
0088341C                            ; Sega screen
0088341C                            ; ---------------------------------------------------------------------------
0088341C                            
0088341C                            GM_Sega:				; XREF: GameModeArray
0088341C 103C 00E1                  		move.b	#bgm_Stop,d0
00883420 6100 E45A                  		bsr.w	PlaySound_Special ; stop music
00883424 6100 E7DA                  		bsr.w	ClearPLC
00883428 6100 F06A                  		bsr.w	PaletteFadeOut
0088342C 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00883432 3CBC 8004                  		move.w	#$8004,(a6)	; use 8-colour mode
00883436 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
0088343A 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
0088343E 3CBC 8700                  		move.w	#$8700,(a6)	; set background colour (palette entry 0)
00883442 3CBC 8B00                  		move.w	#$8B00,(a6)	; full-screen vertical scrolling
00883446 4238 F64E                  		clr.b	(f_wtr_state).w
0088344A 46FC 2700                  		disable_ints
0088344E 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00883452 0200 00BF                  		andi.b	#$BF,d0
00883456 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
0088345C 6100 E2FE                  		bsr.w	ClearScreen
0088346A 41F9 0000 0000             		lea	(Nem_SegaLogo).l,a0 ; load Sega	logo patterns
00883470 6100 E5F0                  		bsr.w	NemDec
00883474 43F9 00FF 0000             		lea	($FF0000).l,a1
0088347A 41F9 0000 0000             		lea	(Eni_SegaLogo).l,a0 ; load Sega	logo mappings
00883480 303C 0000                  		move.w	#0,d0
00883484 6100 E8BA                  		bsr.w	EniDec
00883488                            
00883488 43F9 00FF 0000 203C 6510+  		copyTilemap	$FF0000,$E510,$17,7
0088349C 43F9 00FF 0180 203C 4000+  		copyTilemap	$FF0180,$C000,$27,$1B
008834B0                            	
008834B0 4A38 FFF8                  		tst.b   (v_megadrive).w	; is console Japanese?
008834B4 6B00                       		bmi.s   @loadpal
008834B6 43F9 00FF 0A40 203C 453A+  		copyTilemap	$FF0A40,$C53A,2,1 ; hide "TM" with a white rectxs = ((signed char)((xs)>>8))
008834CA                            
008834CA                            	@loadpal:
008834CA 7000                       		moveq	#palid_SegaBG,d0
008834CC 6100 F28C                  		bsr.w	PalLoad2	; load Sega logo palette
008834D0 31FC FFF6 F632             		move.w	#-$A,(v_pcyc_num).w
008834D6 31FC 0000 F634             		move.w	#0,(v_pcyc_time).w
008834DC 31FC 0000 F662             		move.w	#0,(v_pal_buffer+$12).w
008834E2 31FC 0000 F660             		move.w	#0,(v_pal_buffer+$10).w
008834E8 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
008834EC 0000 0040                  		ori.b	#$40,d0
008834F0 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
008834F6                            
008834F6                            Sega_WaitPal:
008834F6 11FC 0002 F62A             		move.b	#2,(v_vbla_routine).w
008834FC 6100 FAEC                  		bsr.w	WaitForVBla
00883500 6100 F14A                  		bsr.w	PalCycle_Sega
00883504 66F0                       		bne.s	Sega_WaitPal
00883506                            
00883506 103C 00FF                  		move.b	#sfx_Sega,d0
0088350A 6100 E370                  		bsr.w	PlaySound_Special ; play "SEGA"	sound
0088350E 11FC 0014 F62A             		move.b	#$14,(v_vbla_routine).w
00883514 6100 FAD4                  		bsr.w	WaitForVBla
00883518 31FC 0080 F614             		move.w	#$80,(v_demolength).w
0088351E                            
0088351E                            Sega_WaitEnd:
0088351E 11FC 0002 F62A             		move.b	#2,(v_vbla_routine).w
00883524 6100 FAC4                  		bsr.w	WaitForVBla
00883528 4A78 F614                  		tst.w	(v_demolength).w
0088352C 6700                       		beq.s	Sega_GotoTitle
0088352E 0238 0080 F605             		andi.b	#btnStart,(v_jpadpress1).w ; is Start button pressed?
00883534 67E8                       		beq.s	Sega_WaitEnd	; if not, branch
00883536 70FE                       		moveq	#-2,d0
00883538 6100 E302                  		bsr.w	PlaySound				; Stop SEGA sound
0088353C                            
0088353C                            Sega_GotoTitle:
0088353C 11FC 0000 F600             		move.b	#id_Title,(v_gamemode).w ; go to title screen
00883542 4E75                       		rts	
00883544                            ; ===========================================================================
00883544                            
00883544                            ; ---------------------------------------------------------------------------
00883544                            ; Title	screen
00883544                            ; ---------------------------------------------------------------------------
00883544                            
00883544                            GM_Title:				; XREF: GameModeArray
00883544 4EB9 0088 19F8             		jsr	LoadDMARoutine
0088354A                            
0088354A 103C 00E1                  		move.b	#bgm_Stop,d0
0088354E 6100 E32C                  		bsr.w	PlaySound_Special ; stop music
00883552 6100 E6AC                  		bsr.w	ClearPLC
00883556 6100 EF3C                  		bsr.w	PaletteFadeOut
0088355A 46FC 2700                  		disable_ints
0088355E                            
0088355E 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00883564 3CBC 8004                  		move.w	#$8004,(a6)	; 8-colour mode
00883568 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
0088356C 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
00883570 3CBC 9001                  		move.w	#$9001,(a6)	; 64-cell hscroll size
00883574 3CBC 9200                  		move.w	#$9200,(a6)	; window vertical position
00883578 3CBC 8B03                  		move.w	#$8B03,(a6)
0088357C 3CBC 8720                  		move.w	#$8720,(a6)	; set background colour (palette line 2, entry 0)
00883580 4238 F64E                  		clr.b	(f_wtr_state).w
00883584 6100 E1D6                  		bsr.w	ClearScreen
00883588                            
00883588 43F8 D000                  		lea	(v_objspace).w,a1
0088358C 7000                       		moveq	#0,d0
0088358E 323C 07FF                  		move.w	#$7FF,d1
00883592                            
00883592                            	Tit_ClrObj1:
00883592 22C0                       		move.l	d0,(a1)+
00883594 51C9 FFFC                  		dbf	d1,Tit_ClrObj1	; fill object space ($D000-$EFFF) with 0
00883598                            
008835A2 41F9 0000 0000             		lea	(Nem_CreditText).l,a0 ;	load alphabet
008835A8 6100 E4B8                  		bsr.w	NemDec
008835AC                            
008835AC 43F8 FB80                  		lea	(v_pal_dry_dup).w,a1
008835B0 7000                       		moveq	#cBlack,d0
008835B2 323C 001F                  		move.w	#$1F,d1
008835B6                            
008835B6                            	Tit_ClrPal:
008835B6 22C0                       		move.l	d0,(a1)+
008835B8 51C9 FFFC                  		dbf	d1,Tit_ClrPal	; fill palette with 0 (black)
008835BC                            
008835BC 7003                       		moveq	#palid_Sonic,d0	; load Sonic's palette
008835BE 6100 F17E                  		bsr.w	PalLoad1
008835C2 11FC 0000 D080             		move.b	#id_CreditsText,(v_objspace+$80).w ; load "SONIC TEAM PRESENTS" object
008835C8 4EB9 0000 0000             		jsr	ExecuteObjects
008835CE 4EB9 0000 0000             		jsr	BuildSprites
008835D4 6100 EE18                  		bsr.w	PaletteFadeIn
008835D8 46FC 2700                  		disable_ints
008835E6 41F9 0000 0000             		lea	(Nem_TitleFg).l,a0 ; load title	screen patterns
008835EC 6100 E474                  		bsr.w	NemDec
008835FA 41F9 0000 0000             		lea	(Nem_TitleSonic).l,a0 ;	load Sonic title screen	patterns
00883600 6100 E460                  		bsr.w	NemDec
0088360E 41F9 0000 0000             		lea	(Nem_TitleTM).l,a0 ; load "TM" patterns
00883614 6100 E44C                  		bsr.w	NemDec
00883618 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
00883626 4BF9 0088 0B0A             		lea	(Art_Text).l,a5	; load level select font
0088362C 323C 028F                  		move.w	#$28F,d1
00883630                            
00883630                            	Tit_LoadText:
00883630 3C9D                       		move.w	(a5)+,(a6)
00883632 51C9 FFFC                  		dbf	d1,Tit_LoadText	; load level select font
00883636                            
00883636                            	;Mercury Game Over When Drowning Fix
00883636 11FC 0000 F744             		move.b	#0,(f_nobgscroll).w
0088363C                            	;end Game Over When Drowning Fix
0088363C                            		
0088363C 11FC 0000 FE30             		move.b	#0,(v_lastlamp).w ; clear lamppost counter
00883642 31FC 0000 FE08             		move.w	#0,(v_debuguse).w ; disable debug item placement mode
00883648 31FC 0000 FFF0             		move.w	#0,(f_demo).w	; disable debug mode
0088364E 31FC 0000 FE10             		move.w	#0,(v_zone).w	; set level to GHZ (00)
00883654 31FC 0000 F634             		move.w	#0,(v_pcyc_time).w ; disable palette cycling
0088365A 6100 0000                  		bsr.w	LevelSizeLoad
0088365E 6100 0000                  		bsr.w	DeformLayers
00883662                            
00883662 23FC 0000 0000 00FF 0004   		move.l	#Blk16_GHZ,(v_256x256+4).l	; store the ROM address for the block mappings
0088366C 23FC 0000 0000 00FF 0000   		move.l	#Blk256_GHZ,(v_256x256).l	; store the ROM address for the chunk mappings	
00883676                            		
00883676 6100 0000                  		bsr.w	LevelLayoutLoad		
0088367A 6100 EE18                  		bsr.w	PaletteFadeOut
0088367E 46FC 2700                  		disable_ints
00883682 6100 E0D8                  		bsr.w	ClearScreen
00883686                            		
00883686 4BF9 00C0 0004             		lea		(vdp_control_port).l,a5
0088368C 4DF9 00C0 0000             		lea		(vdp_data_port).l,a6
00883692 47F8 F708                  		lea		($FFFFF708).w,a3
00883696 49F8 A440                  		lea		(v_lvllayout+$40).w,a4
0088369A 343C 6000                  		move.w	#$6000,d2
0088369E 6100 0000                  		bsr.w	DrawChunks		
008836A2                            		
008836A2 43F9 0000 0000 203C 4206+  		copyTilemap	Eni_Title,$C206,$21,$15
008836B6                            
008836C0 41F9 0000 0000             		lea	(Nem_GHZ_1st).l,a0 ; load GHZ patterns
008836C6 6100 E39A                  		bsr.w	NemDec
008836CA                            		
008836CA 7001                       		moveq	#palid_Title,d0	; load title screen palette
008836CC 6100 F070                  		bsr.w	PalLoad1
008836D0                            		
008836D0 103C 000A                  		move.b	#bgm_Title,d0	; play title screen music
008836D4 6100 E1A6                  		bsr.w	PlaySound_Special
008836D8 11FC 0000 FFFA             		move.b	#0,(f_debugmode).w ; disable debug mode
008836DE                            		
008836DE 41F8 D080                  		lea	(v_objspace+$80).w,a0
008836E2 4EB9 0000 0000             		jsr	DeleteObject	; clear object RAM to make room for the "Press Start Button" object
008836E8                            
008836E8 11FC 0000 D040             		move.b	#id_TitleSonic,(v_objspace+$40).w ; load big Sonic object
008836EE 11FC 0000 D080             		move.b	#id_PSBTM,(v_objspace+$80).w ; load "PRESS START BUTTON" object
008836F4                            
008836F4 11FC 0000 D0C0             		move.b	#id_PSBTM,(v_objspace+$C0).w ; load "TM" object
008836FA 11FC 0003 D0DA             		move.b	#3,(v_objspace+$C0+obFrame).w
00883700                            
00883700 11FC 0000 D100             		move.b	#id_PSBTM,(v_objspace+$100).w ; load object which hides part of Sonic
00883706 11FC 0002 D11A             		move.b	#2,(v_objspace+$100+obFrame).w
0088370C 4EB9 0000 0000             		jsr	ExecuteObjects
00883712 6100 0000                  		bsr.w	DeformLayers
00883716 4EB9 0000 0000             		jsr	BuildSprites
0088371C 7000                       		moveq	#plcid_Main,d0
0088371E 6100 E4B4                  		bsr.w	NewPLC
00883722 31FC 0000 FFE4             		move.w	#0,(v_title_dcount).w
00883728 31FC 0000 FFE6             		move.w	#0,(v_title_ccount).w
0088372E 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00883732 0000 0040                  		ori.b	#$40,d0
00883736 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
0088373C 6100 ECB0                  		bsr.w	PaletteFadeIn
00883740                            
00883740                            Tit_MainLoop:
00883740 11FC 0004 F62A             		move.b	#4,(v_vbla_routine).w
00883746 6100 F8A2                  		bsr.w	WaitForVBla
0088374A 4EB9 0000 0000             		jsr		ExecuteObjects
00883750 6100 0000                  		bsr.w	DeformLayers
00883754 4EB9 0000 0000             		jsr		BuildSprites
0088375A 6100 E822                  		bsr.w	PCycle_Title
0088375E 6100 E4AE                  		bsr.w	RunPLC
00883762                            
00883762 3038 D008                  		move.w	(v_objspace+obX).w,d0
00883766 5440                       		addq.w	#2,d0
00883768 31C0 D008                  		move.w	d0,(v_objspace+obX).w ; move 'Sonic' to the right
0088376C                            		
0088376C                            Tit_ChkRegion:
0088376C 41F9 0000 0000             		lea	(LevSelCode_US).l,a0 ; load US code
00883772                            
00883772                            Tit_EnterCheat:
00883772 3038 FFE4                  		move.w	(v_title_dcount).w,d0
00883776 D0C0                       		adda.w	d0,a0
00883778 1038 F605                  		move.b	(v_jpadpress1).w,d0 ; get button press
0088377C 0200 000F                  		andi.b	#btnDir,d0	; read only UDLR buttons
00883780 B010                       		cmp.b	(a0),d0		; does button press match the cheat code?
00883782 6600                       		bne.s	Tit_ResetCheat	; if not, branch
00883784 5278 FFE4                  		addq.w	#1,(v_title_dcount).w ; next button press
00883788 4A00                       		tst.b	d0
0088378A 6600                       		bne.s	Tit_CountC
0088378C 41F8 FFE0                  		lea		(f_levselcheat).w,a0
00883790 3238 FFE6                  		move.w	(v_title_ccount).w,d1
00883794 E249                       		lsr.w	#1,d1
00883796 0241 0003                  		andi.w	#3,d1
0088379A 6700                       		beq.s	Tit_PlayRing
0088379C 4A38 FFF8                  		tst.b	(v_megadrive).w
008837A0 6A00                       		bpl.s	Tit_PlayRing
008837A2 7201                       		moveq	#1,d1
008837A4 1181 1001                  		move.b	d1,1(a0,d1.w)	; cheat depends on how many times C is pressed
008837A8                            
008837A8                            	Tit_PlayRing:
008837A8                            	
008837A8 21FC 0101 0101 FFE0        		move.l	#$01010101,(f_levselcheat).w	; activate all cheats
008837BA                            	
008837BA 6000                       		bra.s	Tit_CountC
008837BC                            ; ===========================================================================
008837BC                            
008837BC                            Tit_ResetCheat:				; XREF: Title_EnterCheat
008837BC 4A00                       		tst.b	d0
008837BE 6700                       		beq.s	Tit_CountC
008837C0 0C78 0009 FFE4             		cmpi.w	#9,(v_title_dcount).w
008837C6 6700                       		beq.s	Tit_CountC
008837C8 31FC 0000 FFE4             		move.w	#0,(v_title_dcount).w ; reset UDLR counter
008837CE                            
008837CE                            Tit_CountC:
008837CE 1038 F605                  		move.b	(v_jpadpress1).w,d0
008837D2 0200 0020                  		andi.b	#btnC,d0	; is C button pressed?
008837D6 6700                       		beq.s	loc_3230	; if not, branch
008837D8 5278 FFE6                  		addq.w	#1,(v_title_ccount).w ; increment C counter
008837DC                            
008837DC                            loc_3230:
008837DC 0238 0080 F605             		andi.b	#btnStart,(v_jpadpress1).w ; check if Start is pressed
008837E2 6700 FF5C                  		beq.w	Tit_MainLoop	; if not, branch
008837E6                            
008837E6                            Tit_ChkLevSel:
008837E6 4A38 FFE0                  		tst.b	(f_levselcheat).w ; check if level select code is on
008837EA 6700 0000                  		beq.w	PlayLevel	; if not, play level
008837EE 0838 0006 F604             		btst	#bitA,(v_jpadhold1).w ; check if A is pressed
008837F4 6700 0000                  		beq.w	PlayLevel	; if not, play level
008837F8                            
008837F8 7002                       		moveq	#palid_LevelSel,d0
008837FA 6100 EF5E                  		bsr.w	PalLoad2	; load level select palette
008837FE 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
00883802 7000                       		moveq	#0,d0
00883804 323C 00DF                  		move.w	#$DF,d1
00883808                            
00883808                            	Tit_ClrScroll1:
00883808 22C0                       		move.l	d0,(a1)+
0088380A 51C9 FFFC                  		dbf	d1,Tit_ClrScroll1 ; clear scroll data (in RAM)
0088380E                            
0088380E 21C0 F616                  		move.l	d0,(v_scrposy_dup).w
00883812 46FC 2700                  		disable_ints
00883816 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
00883826 323C 03FF                  		move.w	#$3FF,d1
0088382A                            
0088382A                            	Tit_ClrScroll2:
0088382A 2C80                       		move.l	d0,(a6)
0088382C 51C9 FFFC                  		dbf	d1,Tit_ClrScroll2 ; clear scroll data (in VRAM)
00883830                            
00883830 6100 0000                  		bsr.w	LevSelTextLoad
00883834                            
00883834                            ; ---------------------------------------------------------------------------
00883834                            ; Level	Select
00883834                            ; ---------------------------------------------------------------------------
00883834                            
00883834                            LevelSelect:
00883834 11FC 0004 F62A             		move.b	#4,(v_vbla_routine).w
0088383A 6100 F7AE                  		bsr.w	WaitForVBla
0088383E 6100 0000                  		bsr.w	LevSelControls
00883842 6100 E3CA                  		bsr.w	RunPLC
00883846 4AB8 F680                  		tst.l	(v_plc_buffer).w
0088384A 66E8                       		bne.s	LevelSelect
0088384C 0238 00F0 F605             		andi.b	#btnABC+btnStart,(v_jpadpress1).w ; is A, B, C, or Start pressed?
00883852 67E0                       		beq.s	LevelSelect	; if not, branch
00883854 3038 FF82                  		move.w	(v_levselitem).w,d0
00883858 0C40 0014                  		cmpi.w	#$14,d0		; have you selected item $14 (sound test)?
0088385C 6600                       		bne.s	LevSel_Level_SS	; if not, go to	Level/SS subroutine
0088385E 3038 FF84                  		move.w	(v_levselsound).w,d0
00883862                            
00883862                            LevSel_PlaySnd:
00883862 6100 E018                  		bsr.w	PlaySound_Special
00883866 60CC                       		bra.s	LevelSelect
00883868                            ; ===========================================================================
00883868                            
00883868                            LevSel_Ending:				; XREF: LevelSelect
00883868 11FC 0000 F600             		move.b	#id_Ending,(v_gamemode).w ; set screen mode to $18 (Ending)
0088386E 31FC 0600 FE10             		move.w	#(id_EndZ<<8),(v_zone).w ; set level to 0600 (Ending)
00883874 4E75                       		rts	
00883876                            ; ===========================================================================
00883876                            
00883876                            LevSel_Credits:				; XREF: LevelSelect
00883876 11FC 0000 F600             		move.b	#id_Credits,(v_gamemode).w ; set screen mode to $1C (Credits)
0088387C 103C 0011                  		move.b	#bgm_Credits,d0
00883880 6100 DFFA                  		bsr.w	PlaySound_Special ; play credits music
00883884 31FC 0000 FFF4             		move.w	#0,(v_creditsnum).w
0088388A 4E75                       		rts	
0088388C                            ; ===========================================================================
0088388C                            
0088388C                            LevSel_Level_SS:			; XREF: LevelSelect
0088388C D040                       		add.w	d0,d0
0088388E 303B 0000                  		move.w	LevSel_Ptrs(pc,d0.w),d0 ; load level number
00883892 6B00 FFA0                  		bmi.w	LevelSelect
00883896 0C40 0000                  		cmpi.w	#id_SS*$100,d0	; check	if level is 0700 (Special Stage)
0088389A 6600                       		bne.s	LevSel_Level	; if not, branch
0088389C 11FC 0000 F600             		move.b	#id_Special,(v_gamemode).w ; set screen mode to $10 (Special Stage)
008838A2 4278 FE10                  		clr.w	(v_zone).w	; clear	level
008838A6 11FC 0003 FE12             		move.b	#3,(v_lives).w	; set lives to 3
008838AC 7000                       		moveq	#0,d0
008838AE 31C0 FE20                  		move.w	d0,(v_rings).w	; clear rings
008838B2 21C0 FE22                  		move.l	d0,(v_time).w	; clear time
008838B6 21C0 FE26                  		move.l	d0,(v_score).w	; clear score
008838BA                            
008838BA 21FC 0000 1388 FFC0        		move.l	#5000,(v_scorelife).w ; extra life is awarded at 50000 points
008838C2 4E75                       		rts	
008838C4                            ; ===========================================================================
008838C4                            
008838C4                            LevSel_Level:				; XREF: LevSel_Level_SS
008838C4 0240 3FFF                  		andi.w	#$3FFF,d0
008838C8 31C0 FE10                  		move.w	d0,(v_zone).w	; set level number
008838CC                            
008838CC                            PlayLevel:
008838CC 11FC 0000 F600             		move.b	#id_Level,(v_gamemode).w ; set screen mode to $0C (level)
008838D2 11FC 0003 FE12             		move.b	#3,(v_lives).w	; set lives to 3
008838D8 7000                       		moveq	#0,d0
008838DA 31C0 FE20                  		move.w	d0,(v_rings).w	; clear rings
008838DE 21C0 FE22                  		move.l	d0,(v_time).w	; clear time
008838E2 21C0 FE26                  		move.l	d0,(v_score).w	; clear score
008838E6 11C0 FE16                  		move.b	d0,(v_lastspecial).w ; clear special stage number
008838EA 11C0 FE57                  		move.b	d0,(v_emeralds).w ; clear emeralds
008838EE 21C0 FE58                  		move.l	d0,(v_emldlist).w ; clear emeralds
008838F2 21C0 FE5C                  		move.l	d0,(v_emldlist+4).w ; clear emeralds
008838F6 11C0 FE18                  		move.b	d0,(v_continues).w ; clear continues
008838FA                            
008838FA 21FC 0000 1388 FFC0        		move.l	#5000,(v_scorelife).w ; extra life is awarded at 50000 points
00883902 103C 00E0                  		move.b	#$E0,d0
00883906 6100 DF74                  		bsr.w	PlaySound_Special ; fade out music
0088390A 4E75                       		rts	
0088390C                            ; ===========================================================================
0088390C                            ; ---------------------------------------------------------------------------
0088390C                            ; Level	select - level pointers
0088390C                            ; ---------------------------------------------------------------------------
0088390C                            LevSel_Ptrs:
0088390C 0000                       		dc.b id_GHZ, 0
0088390E 0001                       		dc.b id_GHZ, 1
00883910 0002                       		dc.b id_GHZ, 2
00883912 0200                       		dc.b id_MZ, 0
00883914 0201                       		dc.b id_MZ, 1
00883916 0202                       		dc.b id_MZ, 2
00883918 0400                       		dc.b id_SYZ, 0
0088391A 0401                       		dc.b id_SYZ, 1
0088391C 0402                       		dc.b id_SYZ, 2
0088391E 0100                       		dc.b id_LZ, 0
00883920 0101                       		dc.b id_LZ, 1
00883922 0102                       		dc.b id_LZ, 2
00883924 0300                       		dc.b id_SLZ, 0
00883926 0301                       		dc.b id_SLZ, 1
00883928 0302                       		dc.b id_SLZ, 2
0088392A 0500                       		dc.b id_SBZ, 0
0088392C 0501                       		dc.b id_SBZ, 1
0088392E 0103                       		dc.b id_LZ, 3
00883930 0502                       		dc.b id_SBZ, 2
00883932 0000                       		dc.b id_SS, 0		; Special Stage
00883934 8000                       		dc.w $8000		; Sound Test
00883936                            		even
00883936                            ; ---------------------------------------------------------------------------
00883936                            ; Level	select codes
00883936                            ; ---------------------------------------------------------------------------
00883936                            LevSelCode_J:	
00883936 0102 0202 0408 00FF        		dc.b btnUp,btnDn,btnDn,btnDn,btnL,btnR,0,$FF
0088393E                            		even
0088393E                            
0088393E 0102 0408 00FF             LevSelCode_US:	dc.b btnUp,btnDn,btnL,btnR,0,$FF
00883944                            		even
00883944                            ; ===========================================================================
00883944                            
00883944                            ; ---------------------------------------------------------------------------
00883944                            ; Subroutine to	change what you're selecting in the level select
00883944                            ; ---------------------------------------------------------------------------
00883944                            
00883944                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00883944                            
00883944                            
00883944                            LevSelControls:				; XREF: LevelSelect
00883944 1238 F605                  		move.b	(v_jpadpress1).w,d1
00883948 0201 0003                  		andi.b	#btnUp+btnDn,d1	; is up/down pressed and held?
0088394C 6600                       		bne.s	LevSel_UpDown	; if yes, branch
0088394E 5378 FF80                  		subq.w	#1,(v_levseldelay).w ; subtract 1 from time to next move
00883952 6A00                       		bpl.s	LevSel_SndTest	; if time remains, branch
00883954                            
00883954                            LevSel_UpDown:
00883954 31FC 000B FF80             		move.w	#$B,(v_levseldelay).w ; reset time delay
0088395A 1238 F604                  		move.b	(v_jpadhold1).w,d1
0088395E 0201 0003                  		andi.b	#btnUp+btnDn,d1	; is up/down pressed?
00883962 6700                       		beq.s	LevSel_SndTest	; if not, branch
00883964 3038 FF82                  		move.w	(v_levselitem).w,d0
00883968 0801 0000                  		btst	#bitUp,d1	; is up	pressed?
0088396C 6700                       		beq.s	LevSel_Down	; if not, branch
0088396E 5340                       		subq.w	#1,d0		; move up 1 selection
00883970 6400                       		bcc.s	LevSel_Down
00883972 7014                       		moveq	#$14,d0		; if selection moves below 0, jump to selection	$14
00883974                            
00883974                            LevSel_Down:
00883974 0801 0001                  		btst	#bitDn,d1	; is down pressed?
00883978 6700                       		beq.s	LevSel_Refresh	; if not, branch
0088397A 5240                       		addq.w	#1,d0		; move down 1 selection
0088397C 0C40 0015                  		cmpi.w	#$15,d0
00883980 6500                       		bcs.s	LevSel_Refresh
00883982 7000                       		moveq	#0,d0		; if selection moves above $14,	jump to	selection 0
00883984                            
00883984                            LevSel_Refresh:
00883984 31C0 FF82                  		move.w	d0,(v_levselitem).w ; set new selection
00883988 6100 0000                  		bsr.w	LevSelTextLoad	; refresh text
0088398C 4E75                       		rts	
0088398E                            ; ===========================================================================
0088398E                            
0088398E                            LevSel_SndTest:				; XREF: LevSelControls
0088398E 0C78 0014 FF82             		cmpi.w	#$14,(v_levselitem).w 	; is item $14 selected?
00883994 6600                       		bne.s	LevSel_NoMove		; if not, branch
00883996 1238 F605                  		move.b	(v_jpadpress1).w,d1
0088399A 0201 000C                  		andi.b	#btnR+btnL,d1		; is left/right	pressed?
0088399E 6700                       		beq.s	LevSel_NoMove		; if not, branch
008839A0 3038 FF84                  		move.w	(v_levselsound).w,d0
008839A4 0801 0002                  		btst	#bitL,d1		; is left pressed?
008839A8 6700                       		beq.s	LevSel_Right		; if not, branch
008839AA 5340                       		subq.w	#1,d0			; subtract 1 from sound	test
008839AC                            LevSel_Right:
008839AC 0801 0003                  		btst	#bitR,d1		; is right pressed?
008839B0 6700                       		beq.s	LevSel_Refresh2		; if not, branch
008839B2 5240                       		addq.w	#1,d0			; add 1	to sound test
008839B4 0C40 00FF                  		cmpi.w	#$FF,d0
008839B8                            
008839B8                            LevSel_Refresh2:
008839B8 31C0 FF84                  		move.w	d0,(v_levselsound).w	; set sound test number
008839BC 6100 0000                  		bsr.w	LevSelTextLoad		; refresh text
008839C0                            
008839C0                            LevSel_NoMove:
008839C0 4E75                       		rts	
008839C2                            ; End of function LevSelControls
008839C2                            
008839C2                            ; ---------------------------------------------------------------------------
008839C2                            ; Subroutine to load level select text
008839C2                            ; ---------------------------------------------------------------------------
008839C2                            
008839C2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008839C2                            
008839C2                            
008839C2                            LevSelTextLoad:				; XREF: GM_Title
008839C2                            
008839C2 =62100003                  	textpos:	= ($40000000+(($E210&$3FFF)<<16)+(($E210&$C000)>>14))
008839C2                            					; $E210 is a VRAM address
008839C2                            
008839C2 43F9 0000 0000             		lea	(LevelMenuText).l,a1
008839C8 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
008839CE 283C 6210 0003             		move.l	#textpos,d4	; text position on screen
008839D4 363C E680                  		move.w	#$E680,d3	; VRAM setting (4th palette, $680th tile)
008839D8 7214                       		moveq	#$14,d1		; number of lines of text
008839DA                            
008839DA                            	LevSel_DrawAll:
008839DA 2D44 0004                  		move.l	d4,4(a6)
008839DE 6100 0000                  		bsr.w	LevSel_ChgLine	; draw line of text
008839E2 0684 0080 0000             		addi.l	#$800000,d4	; jump to next line
008839E8 51C9 FFF0                  		dbf	d1,LevSel_DrawAll
008839EC                            
008839EC 7000                       		moveq	#0,d0
008839EE 3038 FF82                  		move.w	(v_levselitem).w,d0
008839F2 3200                       		move.w	d0,d1
008839F4 283C 6210 0003             		move.l	#textpos,d4
008839FA EF48                       		lsl.w	#7,d0
008839FC 4840                       		swap	d0
008839FE D880                       		add.l	d0,d4
00883A00 43F9 0000 0000             		lea	(LevelMenuText).l,a1
00883A06 E749                       		lsl.w	#3,d1
00883A08 3001                       		move.w	d1,d0
00883A0A D241                       		add.w	d1,d1
00883A0C D240                       		add.w	d0,d1
00883A0E D2C1                       		adda.w	d1,a1
00883A10 363C C680                  		move.w	#$C680,d3	; VRAM setting (3rd palette, $680th tile)
00883A14 2D44 0004                  		move.l	d4,4(a6)
00883A18 6100 0000                  		bsr.w	LevSel_ChgLine	; recolour selected line
00883A1C 363C E680                  		move.w	#$E680,d3
00883A20 0C78 0014 FF82             		cmpi.w	#$14,(v_levselitem).w
00883A26 6600                       		bne.s	LevSel_DrawSnd
00883A28 363C C680                  		move.w	#$C680,d3
00883A2C                            
00883A2C                            LevSel_DrawSnd:
00883A36 3038 FF84                  		move.w	(v_levselsound).w,d0
00883A3A 1400                       		move.b	d0,d2
00883A3C E808                       		lsr.b	#4,d0
00883A3E 6100 0000                  		bsr.w	LevSel_ChgSnd	; draw 1st digit
00883A42 1002                       		move.b	d2,d0
00883A44 6100 0000                  		bsr.w	LevSel_ChgSnd	; draw 2nd digit
00883A48 4E75                       		rts	
00883A4A                            ; End of function LevSelTextLoad
00883A4A                            
00883A4A                            
00883A4A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00883A4A                            
00883A4A                            
00883A4A                            LevSel_ChgSnd:				; XREF: LevSelTextLoad
00883A4A 0240 000F                  		andi.w	#$F,d0
00883A4E 0C00 000A                  		cmpi.b	#$A,d0		; is digit $A-$F?
00883A52 6500                       		bcs.s	LevSel_Numb	; if not, branch
00883A54 0600 0007                  		addi.b	#7,d0		; use alpha characters
00883A58                            
00883A58                            	LevSel_Numb:
00883A58 D043                       		add.w	d3,d0
00883A5A 3C80                       		move.w	d0,(a6)
00883A5C 4E75                       		rts	
00883A5E                            ; End of function LevSel_ChgSnd
00883A5E                            
00883A5E                            
00883A5E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00883A5E                            
00883A5E                            
00883A5E                            LevSel_ChgLine:				; XREF: LevSelTextLoad
00883A5E 7417                       		moveq	#$17,d2		; number of characters per line
00883A60                            
00883A60                            	LevSel_LineLoop:
00883A60 7000                       		moveq	#0,d0
00883A62 1019                       		move.b	(a1)+,d0	; get character
00883A64 6A00                       		bpl.s	LevSel_CharOk	; branch if valid
00883A66 3CBC 0000                  		move.w	#0,(a6)		; use blank character
00883A6A 51CA FFF4                  		dbf	d2,LevSel_LineLoop
00883A6E 4E75                       		rts	
00883A70                            
00883A70                            
00883A70                            	LevSel_CharOk:
00883A70 D043                       		add.w	d3,d0		; combine char with VRAM setting
00883A72 3C80                       		move.w	d0,(a6)		; send to VRAM
00883A74 51CA FFEA                  		dbf	d2,LevSel_LineLoop
00883A78 4E75                       		rts	
00883A7A                            ; End of function LevSel_ChgLine
00883A7A                            
00883A7A                            ; ===========================================================================
00883A7A                            ; ---------------------------------------------------------------------------
00883A7A                            ; Level	select menu text
00883A7A                            ; ---------------------------------------------------------------------------
00883A7A                            LevelMenuText:
00883A7A                            		incbin	"misc\Level Select Text (JP1).bin"
00883C72                            		even
00883C72                            ; ---------------------------------------------------------------------------
00883C72                            ; Music	playlist
00883C72                            ; ---------------------------------------------------------------------------
00883C72 0102 0304 0506 0D          MusicList:	dc.b bgm_GHZ, bgm_LZ, bgm_MZ, bgm_SLZ, bgm_SYZ, bgm_SBZ, bgm_FZ
00883C7A 00                         		even
00883C7A                            ; ===========================================================================
00883C7A                            
00883C7A                            	
00883C7A                            ; ---------------------------------------------------------------------------
00883C7A                            ; Level
00883C7A                            ; ---------------------------------------------------------------------------
00883C7A                            
00883C7A                            GM_Level:				; XREF: GameModeArray
00883C7A 08F8 0007 F600             		bset	#7,(v_gamemode).w ; add $80 to screen mode (for pre level sequence)
00883C80 4A78 FFF0                  		tst.w	(f_demo).w
00883C84 6B00                       		bmi.s	Level_NoMusicFade
00883C86 103C 00E1                  		move.b	#bgm_Fade,d0
00883C8A 6100 DBF0                  		bsr.w	PlaySound_Special ; fade out music
00883C8E                            
00883C8E                            	Level_NoMusicFade:
00883C8E 6100 DF70                  		bsr.w	ClearPLC
00883C92 6100 E800                  		bsr.w	PaletteFadeOut
00883C96 4A78 FFF0                  		tst.w	(f_demo).w	; is an ending sequence demo running?
00883C9A 6B00                       		bmi.s	Level_ClrRam	; if yes, branch
00883C9C 46FC 2700                  		disable_ints
00883CAA 41F9 0000 0000             		lea	(Nem_TitleCard).l,a0 ; load title card patterns
00883CB0 6100 DDB0                  		bsr.w	NemDec
00883CB4 46FC 2300                  		enable_ints
00883CB8 7000                       		moveq	#0,d0
00883CBA 1038 FE10                  		move.b	(v_zone).w,d0
00883CBE E948                       		lsl.w	#4,d0
00883CC0 45F9 0000 0000             		lea	(LevelHeaders).l,a2
00883CC6 45F2 0000                  		lea	(a2,d0.w),a2
00883CCA 7000                       		moveq	#0,d0
00883CCC 1012                       		move.b	(a2),d0
00883CCE 6700                       		beq.s	loc_37FC
00883CD0 6100 DED0                  		bsr.w	AddPLC		; load level patterns
00883CD4                            
00883CD4                            loc_37FC:
00883CD4 7000                       		moveq	#plcid_Main2,d0
00883CD6 6100 DECA                  		bsr.w	AddPLC		; load standard	patterns
00883CDA                            
00883CDA                            Level_ClrRam:
00883CDA 43F8 D000                  		lea	(v_objspace).w,a1
00883CDE 7000                       		moveq	#0,d0
00883CE0 323C 07FF                  		move.w	#$7FF,d1
00883CE4                            
00883CE4                            	Level_ClrObjRam:
00883CE4 22C0                       		move.l	d0,(a1)+
00883CE6 51C9 FFFC                  		dbf	d1,Level_ClrObjRam ; clear object RAM
00883CEA                            
00883CEA 43F8 F628                  		lea	($FFFFF628).w,a1
00883CEE 7000                       		moveq	#0,d0
00883CF0 323C 0015                  		move.w	#$15,d1
00883CF4                            
00883CF4                            	Level_ClrVars1:
00883CF4 22C0                       		move.l	d0,(a1)+
00883CF6 51C9 FFFC                  		dbf	d1,Level_ClrVars1 ; clear misc variables
00883CFA                            
00883CFA 43F8 F700                  		lea	(v_screenposx).w,a1
00883CFE 7000                       		moveq	#0,d0
00883D00 323C 003F                  		move.w	#$3F,d1
00883D04                            
00883D04                            	Level_ClrVars2:
00883D04 22C0                       		move.l	d0,(a1)+
00883D06 51C9 FFFC                  		dbf	d1,Level_ClrVars2 ; clear misc variables
00883D0A                            
00883D0A 43F8 FE60                  		lea	(v_oscillate+2).w,a1
00883D0E 7000                       		moveq	#0,d0
00883D10 323C 0047                  		move.w	#$47,d1
00883D14                            
00883D14                            	Level_ClrVars3:
00883D14 22C0                       		move.l	d0,(a1)+
00883D16 51C9 FFFC                  		dbf	d1,Level_ClrVars3 ; clear object variables
00883D1A                            
00883D1A 46FC 2700                  		disable_ints
00883D1E 6100 DA3C                  		bsr.w	ClearScreen
00883D22 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00883D28 3CBC 8B03                  		move.w	#$8B03,(a6)	; line scroll mode
00883D2C 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
00883D30 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
00883D34 3CBC 857C                  		move.w	#$8500+(vram_sprites>>9),(a6) ; set sprite table address
00883D38 3CBC 9001                  		move.w	#$9001,(a6)		; 64-cell hscroll size
00883D3C 3CBC 8004                  		move.w	#$8004,(a6)		; 8-colour mode
00883D40 3CBC 8720                  		move.w	#$8720,(a6)		; set background colour (line 3; colour 0)
00883D44 31FC 8ADF F624             		move.w	#$8A00+223,(v_hbla_hreg).w ; set palette change position (for water)
00883D4A 3CB8 F624                  		move.w	(v_hbla_hreg).w,(a6)
00883D4E                            		
00883D4E 4278 C800                  		clr.w	($FFFFC800).w
00883D52 21FC FFFF C800 C8FC        		move.l	#$FFFFC800,($FFFFC8FC).w
00883D5A                            		
00883D5A 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; is level LZ?
00883D60 6600                       		bne.s	Level_LoadPal	; if not, branch
00883D62                            
00883D62 3CBC 8014                  		move.w	#$8014,(a6)	; enable H-interrupts
00883D66 7000                       		moveq	#0,d0
00883D68 1038 FE11                  		move.b	(v_act).w,d0
00883D6C D040                       		add.w	d0,d0
00883D6E 43F9 0000 0000             		lea	(WaterHeight).l,a1 ; load water	height array
00883D74 3031 0000                  		move.w	(a1,d0.w),d0
00883D78 31C0 F646                  		move.w	d0,(v_waterpos1).w ; set water heights
00883D7C 31C0 F648                  		move.w	d0,(v_waterpos2).w
00883D80 31C0 F64A                  		move.w	d0,(v_waterpos3).w
00883D84 4238 F64D                  		clr.b	(v_wtr_routine).w ; clear water routine counter
00883D88 4238 F64E                  		clr.b	(f_wtr_state).w	; clear	water state
00883D8C 11FC 0001 F64C             		move.b	#1,(f_water).w	; enable water
00883D92                            
00883D92                            Level_LoadPal:
00883D92 31FC 001E FE14             		move.w	#30,(v_air).w
00883D98 46FC 2300                  		enable_ints
00883D9C 7003                       		moveq	#palid_Sonic,d0
00883D9E 6100 E9BA                  		bsr.w	PalLoad2	; load Sonic's palette
00883DA2 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; is level LZ?
00883DA8 6600                       		bne.s	Level_GetBgm	; if not, branch
00883DAA                            
00883DAA 700F                       		moveq	#palid_LZSonWater,d0 ; palette number $F (LZ)
00883DAC 0C38 0003 FE11             		cmpi.b	#3,(v_act).w	; is act number 3?
00883DB2 6600                       		bne.s	Level_WaterPal	; if not, branch
00883DB4 7010                       		moveq	#palid_SBZ3SonWat,d0 ; palette number $10 (SBZ3)
00883DB6                            
00883DB6                            	Level_WaterPal:
00883DB6 6100 E9BA                  		bsr.w	PalLoad3_Water	; load underwater palette
00883DBA 4A38 FE30                  		tst.b	(v_lastlamp).w
00883DBE 6700                       		beq.s	Level_GetBgm
00883DC0 11F8 FE53 F64E             		move.b	($FFFFFE53).w,(f_wtr_state).w
00883DC6                            
00883DC6                            Level_GetBgm:
00883DC6 4A78 FFF0                  		tst.w	(f_demo).w
00883DCA 6B00                       		bmi.s	Level_SkipTtlCard
00883DCC 7000                       		moveq	#0,d0
00883DCE 1038 FE10                  		move.b	(v_zone).w,d0
00883DD2 0C78 0103 FE10             		cmpi.w	#(id_LZ<<8)+3,(v_zone).w ; is level SBZ3?
00883DD8 6600                       		bne.s	Level_BgmNotLZ4	; if not, branch
00883DDA 7005                       		moveq	#5,d0		; use 5th music (SBZ)
00883DDC                            
00883DDC                            	Level_BgmNotLZ4:
00883DDC 0C78 0502 FE10             		cmpi.w	#(id_SBZ<<8)+2,(v_zone).w ; is level FZ?
00883DE2 6600                       		bne.s	Level_PlayBgm	; if not, branch
00883DE4 7006                       		moveq	#6,d0		; use 6th music (FZ)
00883DE6                            
00883DE6                            	Level_PlayBgm:
00883DE6 43F9 0088 3C72             		lea	(MusicList).l,a1 ; load	music playlist
00883DEC 1031 0000                  		move.b	(a1,d0.w),d0
00883DF0 6100 DA4A                  		bsr.w	PlaySound	; play music
00883DF4 11FC 0000 D080             		move.b	#id_TitleCard,(v_objspace+$80).w ; load title card object
00883DFA                            
00883DFA                            Level_TtlCardLoop:
00883DFA 11FC 000C F62A             		move.b	#$C,(v_vbla_routine).w
00883E00 6100 F1E8                  		bsr.w	WaitForVBla
00883E04 4EB9 0000 0000             		jsr	ExecuteObjects
00883E0A 4EB9 0000 0000             		jsr	BuildSprites
00883E10 6100 DDFC                  		bsr.w	RunPLC
00883E14 3038 D108                  		move.w	(v_objspace+$108).w,d0
00883E18 B078 D130                  		cmp.w	(v_objspace+$130).w,d0 ; has title card sequence finished?
00883E1C 66DC                       		bne.s	Level_TtlCardLoop ; if not, branch
00883E1E 4AB8 F680                  		tst.l	(v_plc_buffer).w ; are there any items in the pattern load cue?
00883E22 66D6                       		bne.s	Level_TtlCardLoop ; if yes, branch
00883E24 4EB9 0000 0000             		jsr	Hud_Base	; load basic HUD gfx
00883E2A                            
00883E2A                            	Level_SkipTtlCard:
00883E2A 7003                       		moveq	#palid_Sonic,d0
00883E2C 6100 E910                  		bsr.w	PalLoad1	; load Sonic's palette
00883E30 6100 0000                  		bsr.w	LevelSizeLoad
00883E34 6100 0000                  		bsr.w	DeformLayers
00883E38 08F8 0002 F754             		bset	#2,(v_bgscroll1).w
00883E3E 6100 0000                  		bsr.w	LevelDataLoad ; load block mappings and palettes
00883E42 6100 0000                  		bsr.w	LoadTilesFromStart
00883E46 4EB9 0000 0000             		jsr	FloorLog_Unk
00883E4C 6100 0000                  		bsr.w	ColIndexLoad
00883E50 6100 0000                  		bsr.w	LZWaterFeatures
00883E54 11FC 0000 D000             		move.b	#id_SonicPlayer,(v_objspace).w ; load Sonic object
00883E5A 4A78 FFF0                  		tst.w	(f_demo).w
00883E5E 6B00                       		bmi.s	Level_ChkDebug
00883E60 11FC 0000 D040             		move.b	#id_HUD,(v_objspace+$40).w ; load HUD object
00883E66                            
00883E66                            Level_ChkDebug:
00883E66 4A38 FFE2                  		tst.b	(f_debugcheat).w ; has debug cheat been entered?
00883E6A 6700                       		beq.s	Level_ChkWater	; if not, branch
00883E6C 0838 0006 F604             		btst	#bitA,(v_jpadhold1).w ; is A button held?
00883E72 6700                       		beq.s	Level_ChkWater	; if not, branch
00883E74 11FC 0001 FFFA             		move.b	#1,(f_debugmode).w ; enable debug mode
00883E7A                            
00883E7A                            Level_ChkWater:
00883E7A 31FC 0000 F602             		move.w	#0,(v_jpadhold2).w
00883E80 31FC 0000 F604             		move.w	#0,(v_jpadhold1).w
00883E86 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; is level LZ?
00883E8C 6600                       		bne.s	Level_LoadObj	; if not, branch
00883E8E 11FC 0000 D780             		move.b	#id_WaterSurface,(v_objspace+$780).w ; load water surface object
00883E94 31FC 0060 D788             		move.w	#$60,(v_objspace+$780+obX).w
00883E9A 11FC 0000 D7C0             		move.b	#id_WaterSurface,(v_objspace+$7C0).w
00883EA0 31FC 0120 D7C8             		move.w	#$120,(v_objspace+$7C0+obX).w
00883EA6                            
00883EA6                            Level_LoadObj:
00883EA6 4EB9 0000 0000             		jsr	ObjPosLoad
00883EAC 4EB9 0000 0000             		jsr	ExecuteObjects
00883EB2 4EB9 0000 0000             		jsr	BuildSprites
00883EB8 7000                       		moveq	#0,d0
00883EBA 4A38 FE30                  		tst.b	(v_lastlamp).w	; are you starting from	a lamppost?
00883EBE 6600                       		bne.s	Level_SkipClr	; if yes, branch
00883EC0 31C0 FE20                  		move.w	d0,(v_rings).w	; clear rings
00883EC4 21C0 FE22                  		move.l	d0,(v_time).w	; clear time
00883EC8                            		
00883EC8 11C0 FEBF                  		move.b	d0,(v_centstep).w
00883ECC                            		
00883ECC 11C0 FE1B                  		move.b	d0,(v_lifecount).w ; clear lives counter
00883ED0                            
00883ED0                            	Level_SkipClr:
00883ED0 11C0 FE1A                  		move.b	d0,(f_timeover).w
00883ED4 11C0 FE2C                  		move.b	d0,(v_shield).w	; clear shield
00883ED8 11C0 FE2D                  		move.b	d0,(v_invinc).w	; clear invincibility
00883EDC 11C0 FE2E                  		move.b	d0,(v_shoes).w	; clear speed shoes
00883EE0 11C0 FE2F                  		move.b	d0,($FFFFFE2F).w
00883EE4 31C0 FE08                  		move.w	d0,(v_debuguse).w
00883EE8 31C0 FE02                  		move.w	d0,(f_restart).w
00883EEC 31C0 FE04                  		move.w	d0,(v_framecount).w
00883EF0 6100 0000                  		bsr.w	OscillateNumInit
00883EF4 11FC 0001 FE1F             		move.b	#1,(f_scorecount).w ; update score counter
00883EFA 11FC 0001 FE1D             		move.b	#1,(f_ringcount).w ; update rings counter
00883F00                            		
00883F00                            	
00883F00 31FC 0000 F790             		move.w	#0,(v_btnpushtime1).w
00883F06 43F9 0000 0000             		lea	(DemoDataPtr).l,a1 ; load demo data
00883F0C 7000                       		moveq	#0,d0
00883F0E 1038 FE10                  		move.b	(v_zone).w,d0
00883F12 E548                       		lsl.w	#2,d0
00883F14 2271 0000                  		movea.l	(a1,d0.w),a1
00883F18 4A78 FFF0                  		tst.w	(f_demo).w	; is demo mode on?
00883F1C 6A00                       		bpl.s	Level_Demo	; if yes, branch
00883F1E 43F9 0000 0000             		lea	(DemoEndDataPtr).l,a1 ; load ending demo data
00883F24 3038 FFF4                  		move.w	(v_creditsnum).w,d0
00883F28 5340                       		subq.w	#1,d0
00883F2A E548                       		lsl.w	#2,d0
00883F2C 2271 0000                  		movea.l	(a1,d0.w),a1
00883F30                            
00883F30                            Level_Demo:
00883F30 11E9 0001 F792             		move.b	1(a1),(v_btnpushtime2).w ; load key press duration
00883F36 5338 F792                  		subq.b	#1,(v_btnpushtime2).w ; subtract 1 from duration
00883F3A 31FC 0708 F614             		move.w	#1800,(v_demolength).w
00883F40 4A78 FFF0                  		tst.w	(f_demo).w
00883F44 6A00                       		bpl.s	Level_ChkWaterPal
00883F46 31FC 021C F614             		move.w	#540,(v_demolength).w
00883F4C 0C78 0004 FFF4             		cmpi.w	#4,(v_creditsnum).w
00883F52 6600                       		bne.s	Level_ChkWaterPal
00883F54 31FC 01FE F614             		move.w	#510,(v_demolength).w
00883F5A                            
00883F5A                            Level_ChkWaterPal:
00883F5A 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; is level LZ/SBZ3?
00883F60 6600                       		bne.s	Level_Delay	; if not, branch
00883F62 700B                       		moveq	#palid_LZWater,d0 ; palette $B (LZ underwater)
00883F64 0C38 0003 FE11             		cmpi.b	#3,(v_act).w	; is level SBZ3?
00883F6A 6600                       		bne.s	Level_WtrNotSbz	; if not, branch
00883F6C 700D                       		moveq	#palid_SBZ3Water,d0 ; palette $D (SBZ3 underwater)
00883F6E                            
00883F6E                            	Level_WtrNotSbz:
00883F6E 6100 E81E                  		bsr.w	PalLoad4_Water
00883F72                            
00883F72                            Level_Delay:
00883F72 323C 0003                  		move.w	#3,d1
00883F76                            
00883F76                            	Level_DelayLoop:
00883F76 11FC 0008 F62A             		move.b	#8,(v_vbla_routine).w
00883F7C 6100 F06C                  		bsr.w	WaitForVBla
00883F80 51C9 FFF4                  		dbf	d1,Level_DelayLoop
00883F84                            
00883F84 31FC 202F F626             		move.w	#$202F,(v_pfade_start).w ; fade in 2nd, 3rd & 4th palette lines
00883F8A 6100 E468                  		bsr.w	PalFadeIn_Alt
00883F8E 4A78 FFF0                  		tst.w	(f_demo).w	; is an ending sequence demo running?
00883F92 6B00                       		bmi.s	Level_ClrCardArt ; if yes, branch
00883F94 5438 D0A4                  		addq.b	#2,(v_objspace+$80+obRoutine).w ; make title card move
00883F98 5838 D0E4                  		addq.b	#4,(v_objspace+$C0+obRoutine).w
00883F9C 5838 D124                  		addq.b	#4,(v_objspace+$100+obRoutine).w
00883FA0 5838 D164                  		addq.b	#4,(v_objspace+$140+obRoutine).w
00883FA4 6000                       		bra.s	Level_StartGame
00883FA6                            ; ===========================================================================
00883FA6                            
00883FA6                            Level_ClrCardArt:
00883FA6 7000                       		moveq	#plcid_Explode,d0
00883FA8 4EB9 0088 1BA2             		jsr	(AddPLC).l	; load explosion gfx
00883FAE 7000                       		moveq	#0,d0
00883FB0 1038 FE10                  		move.b	(v_zone).w,d0
00883FB4 0640 0000                  		addi.w	#plcid_GHZAnimals,d0
00883FB8 4EB9 0088 1BA2             		jsr	(AddPLC).l	; load animal gfx (level no. + $15)
00883FBE                            
00883FBE                            Level_StartGame:
00883FBE                            		
00883FBE 11FC 0001 FE1E             		move.b	#1,(f_timecount).w ; update time counter
00883FC4                            		
00883FC4 08B8 0007 F600             		bclr	#7,(v_gamemode).w ; subtract $80 from mode to end pre-level stuff
00883FCA                            
00883FCA                            ; ---------------------------------------------------------------------------
00883FCA                            ; Main level loop (when	all title card and loading sequences are finished)
00883FCA                            ; ---------------------------------------------------------------------------
00883FCA                            
00883FCA                            Level_MainLoop:
00883FCA 6100 D900                  		bsr.w	PauseGame
00883FCE 11FC 0008 F62A             		move.b	#8,(v_vbla_routine).w
00883FD4 6100 F014                  		bsr.w	WaitForVBla
00883FD8 5278 FE04                  		addq.w	#1,(v_framecount).w ; add 1 to level timer
00883FDC 6100 0000                  		bsr.w	MoveSonicInDemo
00883FE0 6100 0000                  		bsr.w	LZWaterFeatures
00883FE4 4EB9 0000 0000             		jsr	ExecuteObjects
00883FEA                            
00883FEA 4A78 FE02                  		tst.w   (f_restart).w
00883FEE 6600 FC8A                  		bne     GM_Level
00883FF2                            
00883FF2 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode being used?
00883FF6 6600                       		bne.s	Level_DoScroll	; if yes, branch
00883FF8 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w ; has Sonic just died?
00883FFE 6400                       		bcc.s	Level_SkipScroll ; if yes, branch
00884000                            
00884000                            	Level_DoScroll:
00884000 6100 0000                  		bsr.w	DeformLayers
00884004                            
00884004                            	Level_SkipScroll:
00884004 4EB9 0000 0000             		jsr	BuildSprites
0088400A 4EB9 0000 0000             		jsr	ObjPosLoad
00884010 6100 DF4C                  		bsr.w	PaletteCycle
00884014 6100 DBF8                  		bsr.w	RunPLC
00884018 6100 0000                  		bsr.w	OscillateNumDo
0088401C 6100 0000                  		bsr.w	SynchroAnimate
00884020 6100 0000                  		bsr.w	SignpostArtLoad
00884024                            
00884024 0C38 0000 F600             		cmpi.b	#id_Demo,(v_gamemode).w
0088402A 6700                       		beq.s	Level_ChkDemo	; if mode is 8 (demo), branch
0088402C                            
0088402C 0C38 0000 F600             		cmpi.b	#id_Level,(v_gamemode).w
00884032 6700 FF96                  		beq.w	Level_MainLoop	; if mode is $C (level), branch
00884036 4E75                       		rts	
00884038                            ; ===========================================================================
00884038                            
00884038                            Level_ChkDemo:
00884038 4A78 FE02                  		tst.w	(f_restart).w	; is level set to restart?
0088403C 6600                       		bne.s	Level_EndDemo	; if yes, branch
0088403E 4A78 F614                  		tst.w	(v_demolength).w ; is there time left on the demo?
00884042 6700                       		beq.s	Level_EndDemo	; if not, branch
00884044 0C38 0000 F600             		cmpi.b	#id_Demo,(v_gamemode).w
0088404A 6700 FF7E                  		beq.w	Level_MainLoop	; if mode is 8 (demo), branch
0088404E 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; go to Sega screen
00884054 4E75                       		rts	
00884056                            ; ===========================================================================
00884056                            
00884056                            Level_EndDemo:
00884056 0C38 0000 F600             		cmpi.b	#id_Demo,(v_gamemode).w
0088405C 6600                       		bne.s	Level_FadeDemo	; if mode is 8 (demo), branch
0088405E 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; go to Sega screen
00884064 4A78 FFF0                  		tst.w	(f_demo).w	; is demo mode on & not ending sequence?
00884068 6A00                       		bpl.s	Level_FadeDemo	; if yes, branch
0088406A 11FC 0000 F600             		move.b	#id_Credits,(v_gamemode).w ; go to credits
00884070                            
00884070                            Level_FadeDemo:
00884070 31FC 003C F614             		move.w	#$3C,(v_demolength).w
00884076 31FC 003F F626             		move.w	#$3F,(v_pfade_start).w
0088407C 4278 F794                  		clr.w	(v_palchgspeed).w
00884080                            
00884080                            	Level_FDLoop:
00884080 11FC 0008 F62A             		move.b	#8,(v_vbla_routine).w
00884086 6100 EF62                  		bsr.w	WaitForVBla
0088408A 6100 0000                  		bsr.w	MoveSonicInDemo
0088408E 4EB9 0000 0000             		jsr	ExecuteObjects
00884094 4EB9 0000 0000             		jsr	BuildSprites
0088409A 4EB9 0000 0000             		jsr	ObjPosLoad
008840A0 5378 F794                  		subq.w	#1,(v_palchgspeed).w
008840A4 6A00                       		bpl.s	loc_3BC8
008840A6 31FC 0002 F794             		move.w	#2,(v_palchgspeed).w
008840AC 6100 E406                  		bsr.w	FadeOut_ToBlack
008840B0                            
008840B0                            loc_3BC8:
008840B0 4A78 F614                  		tst.w	(v_demolength).w
008840B4 66CA                       		bne.s	Level_FDLoop
008840B6 4E75                       		rts	
008840B8                            ; ===========================================================================
008840B8                            
008840B8                            		include	"_inc\LZWaterFeatures.asm"
008840B8                            ; ---------------------------------------------------------------------------
008840B8                            ; Subroutine to	do special water effects in Labyrinth Zone
008840B8                            ; ---------------------------------------------------------------------------
008840B8                            
008840B8                            LZWaterFeatures:			; XREF: GM_Level
008840B8 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
008840BE 6600                       		bne.s	@notlabyrinth	; if not, branch
008840C0                            
008840C0 4A38 F744                  		tst.b   (f_nobgscroll).w
008840C4 6600                       		bne.s	@setheight
008840C6                            
008840C6 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w ; has Sonic just died?
008840CC 6400                       		bcc.s	@setheight	; if yes, skip other effects
008840CE                            
008840CE 6100 0000                  		bsr.w	LZWindTunnels
008840D2 6100 0000                  		bsr.w	LZWaterSlides
008840D6 6100 0000                  		bsr.w	LZDynamicWater
008840DA                            
008840DA                            @setheight:
008840DA 4238 F64E                  		clr.b	(f_wtr_state).w
008840DE 7000                       		moveq	#0,d0
008840E0 1038 FE60                  		move.b	(v_oscillate+2).w,d0
008840E4 E248                       		lsr.w	#1,d0
008840E6 D078 F648                  		add.w	(v_waterpos2).w,d0
008840EA 31C0 F646                  		move.w	d0,(v_waterpos1).w
008840EE 3038 F646                  		move.w	(v_waterpos1).w,d0
008840F2 9078 F704                  		sub.w	(v_screenposy).w,d0
008840F6 6400                       		bcc.s	@isbelow
008840F8 4A40                       		tst.w	d0
008840FA 6A00                       		bpl.s	@isbelow	; if water is below top of screen, branch
008840FC                            
008840FC 11FC 00DF F625             		move.b	#223,(v_hbla_line).w
00884102 11FC 0001 F64E             		move.b	#1,(f_wtr_state).w ; screen is all underwater
00884108                            
00884108                            	@isbelow:
00884108 0C40 00DF                  		cmpi.w	#223,d0		; is water within 223 pixels of top of screen?
0088410C 6500                       		bcs.s	@isvisible	; if yes, branch
0088410E 303C 00DF                  		move.w	#223,d0
00884112                            
00884112                            	@isvisible:
00884112 11C0 F625                  		move.b	d0,(v_hbla_line).w ; set water surface as on-screen
00884116                            
00884116                            @notlabyrinth:
00884116 4E75                       		rts	
00884118                            ; ===========================================================================
00884118                            ; ---------------------------------------------------------------------------
00884118                            ; Initial water heights
00884118                            ; ---------------------------------------------------------------------------
00884118 00B8                       WaterHeight:	dc.w $B8	; Labyrinth 1
0088411A 0328                       		dc.w $328	; Labyrinth 2
0088411C 0900                       		dc.w $900	; Labyrinth 3
0088411E 0228                       		dc.w $228	; Scrap Brain 3
00884120                            		even
00884120                            ; ===========================================================================
00884120                            
00884120                            ; ---------------------------------------------------------------------------
00884120                            ; Labyrinth dynamic water routines
00884120                            ; ---------------------------------------------------------------------------
00884120                            
00884120                            LZDynamicWater:				; XREF: LZWaterFeatures
00884120 7000                       		moveq	#0,d0
00884122 1038 FE11                  		move.b	(v_act).w,d0
00884126 D040                       		add.w	d0,d0
00884128 303B 0000                  		move.w	DynWater_Index(pc,d0.w),d0
0088412C 4EBB 0000                  		jsr	DynWater_Index(pc,d0.w)
00884130 7200                       		moveq	#0,d1
00884132 1238 F64C                  		move.b	(f_water).w,d1
00884136 3038 F64A                  		move.w	(v_waterpos3).w,d0
0088413A 9078 F648                  		sub.w	(v_waterpos2).w,d0
0088413E 6700                       		beq.s	@exit		; if water level is correct, branch
00884140 6400                       		bcc.s	@movewater	; if water level is too high, branch
00884142 4441                       		neg.w	d1		; set water to move up instead
00884144                            
00884144                            	@movewater:
00884144 D378 F648                  		add.w	d1,(v_waterpos2).w ; move water up/down
00884148                            
00884148                            	@exit:
00884148 4E75                       		rts	
0088414A                            ; ===========================================================================
0088414A 0000                       DynWater_Index:	dc.w DynWater_LZ1-DynWater_Index
0088414C 0000                       		dc.w DynWater_LZ2-DynWater_Index
0088414E 0000                       		dc.w DynWater_LZ3-DynWater_Index
00884150 0000                       		dc.w DynWater_SBZ3-DynWater_Index
00884152                            ; ===========================================================================
00884152                            
00884152                            DynWater_LZ1:				; XREF: DynWater_Index
00884152 3038 F700                  		move.w	(v_screenposx).w,d0
00884156 1438 F64D                  		move.b	(v_wtr_routine).w,d2
0088415A 6600                       		bne.s	@routine2
0088415C 323C 00B8                  		move.w	#$B8,d1		; water height
00884160 0C40 0600                  		cmpi.w	#$600,d0	; has screen reached next position?
00884164 6500                       		bcs.s	@setwater	; if not, branch
00884166 323C 0108                  		move.w	#$108,d1
0088416A 0C78 0200 D00C             		cmpi.w	#$200,(v_player+obY).w ; is Sonic above $200 y-axis?
00884170 6500                       		bcs.s	@sonicishigh	; if yes, branch
00884172 0C40 0C00                  		cmpi.w	#$C00,d0
00884176 6500                       		bcs.s	@setwater
00884178 323C 0318                  		move.w	#$318,d1
0088417C 0C40 1080                  		cmpi.w	#$1080,d0
00884180 6500                       		bcs.s	@setwater
00884182 11FC 0080 F7E5             		move.b	#$80,(f_switch+5).w
00884188 323C 05C8                  		move.w	#$5C8,d1
0088418C 0C40 1380                  		cmpi.w	#$1380,d0
00884190 6500                       		bcs.s	@setwater
00884192 323C 03A8                  		move.w	#$3A8,d1
00884196 B278 F648                  		cmp.w	(v_waterpos2).w,d1 ; has water reached last height?
0088419A 6600                       		bne.s	@setwater	; if not, branch
0088419C 11FC 0001 F64D             		move.b	#1,(v_wtr_routine).w ; use second routine next
008841A2                            
008841A2                            	@setwater:
008841A2 31C1 F64A                  		move.w	d1,(v_waterpos3).w
008841A6 4E75                       		rts	
008841A8                            ; ===========================================================================
008841A8                            
008841A8                            @sonicishigh:
008841A8 0C40 0C80                  		cmpi.w	#$C80,d0
008841AC 65F4                       		bcs.s	@setwater
008841AE 323C 00E8                  		move.w	#$E8,d1
008841B2 0C40 1500                  		cmpi.w	#$1500,d0
008841B6 65EA                       		bcs.s	@setwater
008841B8 323C 0108                  		move.w	#$108,d1
008841BC 60E4                       		bra.s	@setwater
008841BE                            ; ===========================================================================
008841BE                            
008841BE                            @routine2:
008841BE 5302                       		subq.b	#1,d2
008841C0 6600                       		bne.s	@skip
008841C2 0C78 02E0 D00C             		cmpi.w	#$2E0,(v_player+obY).w ; is Sonic above $2E0 y-axis?
008841C8 6400                       		bcc.s	@skip		; if not, branch
008841CA 323C 03A8                  		move.w	#$3A8,d1
008841CE 0C40 1300                  		cmpi.w	#$1300,d0
008841D2 6500                       		bcs.s	@setwater2
008841D4 323C 0108                  		move.w	#$108,d1
008841D8 11FC 0002 F64D             		move.b	#2,(v_wtr_routine).w
008841DE                            
008841DE                            	@setwater2:
008841DE 31C1 F64A                  		move.w	d1,(v_waterpos3).w
008841E2                            
008841E2                            	@skip:
008841E2 4E75                       		rts	
008841E4                            ; ===========================================================================
008841E4                            
008841E4                            DynWater_LZ2:				; XREF: DynWater_Index
008841E4 3038 F700                  		move.w	(v_screenposx).w,d0
008841E8 323C 0328                  		move.w	#$328,d1
008841EC 0C40 0500                  		cmpi.w	#$500,d0
008841F0 6500                       		bcs.s	@setwater
008841F2 323C 03C8                  		move.w	#$3C8,d1
008841F6 0C40 0B00                  		cmpi.w	#$B00,d0
008841FA 6500                       		bcs.s	@setwater
008841FC 323C 0428                  		move.w	#$428,d1
00884200                            
00884200                            	@setwater:
00884200 31C1 F64A                  		move.w	d1,(v_waterpos3).w
00884204 4E75                       		rts	
00884206                            ; ===========================================================================
00884206                            
00884206                            DynWater_LZ3:				; XREF: DynWater_Index
00884206 3038 F700                  		move.w	(v_screenposx).w,d0
0088420A 1438 F64D                  		move.b	(v_wtr_routine).w,d2
0088420E 6600                       		bne.s	@routine2
00884210                            
00884210 323C 0900                  		move.w	#$900,d1
00884214 0C40 0600                  		cmpi.w	#$600,d0	; has screen reached position?
00884218 6500                       		bcs.s	@setwaterlz3	; if not, branch
0088421A 0C78 03C0 D00C             		cmpi.w	#$3C0,(v_player+obY).w
00884220 6500                       		bcs.s	@setwaterlz3
00884222 0C78 0600 D00C             		cmpi.w	#$600,(v_player+obY).w ; is Sonic in a y-axis range?
00884228 6400                       		bcc.s	@setwaterlz3	; if not, branch
0088422A                            
0088422A 323C 04C8                  		move.w	#$4C8,d1	; set new water height
0088422E 11FC 004B A506             		move.b	#$4B,(v_lvllayout+$106).w ; update level layout
00884234 11FC 0001 F64D             		move.b	#1,(v_wtr_routine).w ; use second routine next
0088423A 303C 006F                  		move.w	#sfx_Rumbling,d0
0088423E 6100 D63C                  		bsr.w	PlaySound_Special ; play sound $B7 (rumbling)
00884242                            
00884242                            	@setwaterlz3:
00884242 31C1 F64A                  		move.w	d1,(v_waterpos3).w
00884246 31C1 F648                  		move.w	d1,(v_waterpos2).w ; change water height instantly
0088424A 4E75                       		rts	
0088424C                            ; ===========================================================================
0088424C                            
0088424C                            @routine2:
0088424C 5302                       		subq.b	#1,d2
0088424E 6600                       		bne.s	@routine3
00884250 323C 04C8                  		move.w	#$4C8,d1
00884254 0C40 0770                  		cmpi.w	#$770,d0
00884258 6500                       		bcs.s	@setwater2
0088425A 323C 0308                  		move.w	#$308,d1
0088425E 0C40 1400                  		cmpi.w	#$1400,d0
00884262 6500                       		bcs.s	@setwater2
00884264 0C78 0508 F64A             		cmpi.w	#$508,(v_waterpos3).w
0088426A 6700                       		beq.s	@sonicislow
0088426C 0C78 0600 D00C             		cmpi.w	#$600,(v_player+obY).w ; is Sonic below $600 y-axis?
00884272 6400                       		bcc.s	@sonicislow	; if yes, branch
00884274 0C78 0280 D00C             		cmpi.w	#$280,(v_player+obY).w
0088427A 6400                       		bcc.s	@setwater2
0088427C                            
0088427C                            @sonicislow:
0088427C 323C 0508                  		move.w	#$508,d1
00884280 31C1 F648                  		move.w	d1,(v_waterpos2).w
00884284 0C40 1770                  		cmpi.w	#$1770,d0
00884288 6500                       		bcs.s	@setwater2
0088428A 11FC 0002 F64D             		move.b	#2,(v_wtr_routine).w
00884290                            
00884290                            	@setwater2:
00884290 31C1 F64A                  		move.w	d1,(v_waterpos3).w
00884294 4E75                       		rts	
00884296                            ; ===========================================================================
00884296                            
00884296                            @routine3:
00884296 5302                       		subq.b	#1,d2
00884298 6600                       		bne.s	@routine4
0088429A 323C 0508                  		move.w	#$508,d1
0088429E 0C40 1860                  		cmpi.w	#$1860,d0
008842A2 6500                       		bcs.s	@setwater3
008842A4 323C 0188                  		move.w	#$188,d1
008842A8 0C40 1AF0                  		cmpi.w	#$1AF0,d0
008842AC 6400                       		bcc.s	@loc_3DC6
008842AE B278 F648                  		cmp.w	(v_waterpos2).w,d1
008842B2 6600                       		bne.s	@setwater3
008842B4                            
008842B4                            	@loc_3DC6:
008842B4 11FC 0003 F64D             		move.b	#3,(v_wtr_routine).w
008842BA                            
008842BA                            	@setwater3:
008842BA 31C1 F64A                  		move.w	d1,(v_waterpos3).w
008842BE 4E75                       		rts	
008842C0                            ; ===========================================================================
008842C0                            
008842C0                            @routine4:
008842C0 5302                       		subq.b	#1,d2
008842C2 6600                       		bne.s	@routine5
008842C4 323C 0188                  		move.w	#$188,d1
008842C8 0C40 1AF0                  		cmpi.w	#$1AF0,d0
008842CC 6500                       		bcs.s	@setwater4
008842CE 323C 0900                  		move.w	#$900,d1
008842D2 0C40 1BC0                  		cmpi.w	#$1BC0,d0
008842D6 6500                       		bcs.s	@setwater4
008842D8 11FC 0004 F64D             		move.b	#4,(v_wtr_routine).w
008842DE 31FC 0608 F64A             		move.w	#$608,(v_waterpos3).w
008842E4 31FC 07C0 F648             		move.w	#$7C0,(v_waterpos2).w
008842EA 11FC 0001 F7E8             		move.b	#1,(f_switch+8).w
008842F0 4E75                       		rts	
008842F2                            ; ===========================================================================
008842F2                            
008842F2                            @setwater4:
008842F2 31C1 F64A                  		move.w	d1,(v_waterpos3).w
008842F6 31C1 F648                  		move.w	d1,(v_waterpos2).w
008842FA 4E75                       		rts	
008842FC                            ; ===========================================================================
008842FC                            
008842FC                            @routine5:
008842FC 0C40 1E00                  		cmpi.w	#$1E00,d0	; has screen passed final position?
00884300 6500                       		bcs.s	@dontset	; if not, branch
00884302 31FC 0128 F64A             		move.w	#$128,(v_waterpos3).w
00884308                            
00884308                            	@dontset:
00884308 4E75                       		rts	
0088430A                            ; ===========================================================================
0088430A                            
0088430A                            DynWater_SBZ3:				; XREF: DynWater_Index
0088430A 323C 0228                  		move.w	#$228,d1
0088430E 0C78 0F00 F700             		cmpi.w	#$F00,(v_screenposx).w
00884314 6500                       		bcs.s	@setwater
00884316 323C 04C8                  		move.w	#$4C8,d1
0088431A                            
0088431A                            	@setwater:
0088431A 31C1 F64A                  		move.w	d1,(v_waterpos3).w
0088431E 4E75                       		rts
00884320                            
00884320                            ; ---------------------------------------------------------------------------
00884320                            ; Labyrinth Zone "wind tunnels"	subroutine
00884320                            ; ---------------------------------------------------------------------------
00884320                            
00884320                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884320                            
00884320                            
00884320                            LZWindTunnels:				; XREF: LZWaterFeatures
00884320 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	being used?
00884324 6600 0000                  		bne.w	@quit	; if yes, branch
00884328 45F9 0000 0000             		lea	(LZWind_Data+8).l,a2
0088432E 7000                       		moveq	#0,d0
00884330 1038 FE11                  		move.b	(v_act).w,d0	; get act number
00884334 E748                       		lsl.w	#3,d0		; multiply by 8
00884336 D4C0                       		adda.w	d0,a2		; add to address for data
00884338 7200                       		moveq	#0,d1
0088433A 4A38 FE11                  		tst.b	(v_act).w	; is act number 1?
0088433E 6600                       		bne.s	@notact1	; if not, branch
00884340 7201                       		moveq	#1,d1
00884342 514A                       		subq.w	#8,a2		; use different data for act 1
00884344                            
00884344                            	@notact1:
00884344 43F8 D000                  		lea	(v_player).w,a1
00884348                            
00884348                            @chksonic:
00884348 3029 0008                  		move.w	obX(a1),d0
0088434C B052                       		cmp.w	(a2),d0
0088434E 6500 0000                  		bcs.w	@chknext
00884352 B06A 0004                  		cmp.w	4(a2),d0
00884356 6400 0000                  		bcc.w	@chknext
0088435A 3429 000C                  		move.w	obY(a1),d2
0088435E B46A 0002                  		cmp.w	2(a2),d2
00884362 6500                       		bcs.s	@chknext
00884364 B46A 0006                  		cmp.w	6(a2),d2
00884368 6400                       		bcc.s	@chknext	; branch if Sonic is outside a range
0088436A 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088436E 0200 003F                  		andi.b	#$3F,d0		; does VInt counter fall on 0, $40, $80 or $C0?
00884372 6600                       		bne.s	@skipsound	; if not, branch
0088437E                            
0088437E                            	@skipsound:
0088437E 4A38 F7C9                  		tst.b	(f_wtunnelallow).w ; are wind tunnels disabled?
00884382 6600 0000                  		bne.w	@quit	; if yes, branch
00884386 0C29 0004 0024             		cmpi.b	#4,obRoutine(a1) ; is Sonic hurt/dying?
0088438C 6400                       		bcc.s	@clrquit	; if yes, branch
0088438E 11FC 0001 F7C7             		move.b	#1,(f_wtunnelmode).w
00884394 0440 0080                  		subi.w	#$80,d0
00884398 B052                       		cmp.w	(a2),d0
0088439A 6400                       		bcc.s	@movesonic
0088439C 7002                       		moveq	#2,d0
0088439E 0C38 0001 FE11             		cmpi.b	#1,(v_act).w	; is act number 2?
008843A4 6600                       		bne.s	@notact2	; if not, branch
008843A6 4440                       		neg.w	d0
008843A8                            
008843A8                            	@notact2:
008843A8 D169 000C                  		add.w	d0,obY(a1)	; adjust Sonic's y-axis for curve of tunnel
008843AC                            
008843AC                            @movesonic:
008843AC 5869 0008                  		addq.w	#4,obX(a1)
008843B0 337C 0400 0010             		move.w	#$400,obVelX(a1) ; move Sonic horizontally
008843B6 337C 0000 0012             		move.w	#0,obVelY(a1)
008843BC 137C 000F 001C             		move.b	#$F,obAnim(a1)	; use floating animation
008843C2 08E9 0001 0022             		bset	#1,obStatus(a1)
008843C8 0838 0000 F602             		btst	#0,(v_jpadhold2).w ; is up pressed?
008843CE 6700                       		beq.s	@down		; if not, branch
008843D0 5369 000C                  		subq.w	#1,obY(a1)	; move Sonic up on pole
008843D4                            
008843D4                            	@down:
008843D4 0838 0001 F602             		btst	#1,(v_jpadhold2).w ; is down being pressed?
008843DA 6700                       		beq.s	@end		; if not, branch
008843DC 5269 000C                  		addq.w	#1,obY(a1)	; move Sonic down on pole
008843E0                            
008843E0                            	@end:
008843E0 4E75                       		rts	
008843E2                            ; ===========================================================================
008843E2                            
008843E2                            @chknext:
008843E2 504A                       		addq.w	#8,a2		; use second set of values (act 1 only)
008843E4 51C9 FF62                  		dbf	d1,@chksonic	; on act 1, repeat for a second tunnel
008843E8 4A38 F7C7                  		tst.b	(f_wtunnelmode).w ; is Sonic still in a tunnel?
008843EC 6700                       		beq.s	@quit		; if yes, branch
008843EE 137C 0000 001C             		move.b	#0,obAnim(a1)	; use walking animation
008843F4                            
008843F4                            @clrquit:
008843F4 4238 F7C7                  		clr.b	(f_wtunnelmode).w ; finish tunnel
008843F8                            
008843F8                            @quit:
008843F8 4E75                       		rts	
008843FA                            ; End of function LZWindTunnels
008843FA                            
008843FA                            ; ===========================================================================
008843FA                            
008843FA                            		;    left, top,  right, bottom boundaries
008843FA 0A80 0300 0C10 0380        LZWind_Data:	dc.w $A80, $300, $C10,  $380 ; act 1 values (set 1)
00884402 0F80 0100 1410 0180        		dc.w $F80, $100, $1410,	$180 ; act 1 values (set 2)
0088440A 0460 0400 0710 0480        		dc.w $460, $400, $710,  $480 ; act 2 values
00884412 0A20 0600 1610 06E0        		dc.w $A20, $600, $1610, $6E0 ; act 3 values
0088441A 0C80 0600 13D0 0680        		dc.w $C80, $600, $13D0, $680 ; SBZ act 3 values
00884422                            		even
00884422                            
00884422                            ; ---------------------------------------------------------------------------
00884422                            ; Labyrinth Zone water slide subroutine
00884422                            ; ---------------------------------------------------------------------------
00884422                            
00884422                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884422                            
00884422                            
00884422                            LZWaterSlides:				; XREF: LZWaterFeatures
00884422 43F8 D000                  		lea	(v_player).w,a1
00884426 0829 0001 0022             		btst	#1,obStatus(a1)	; is Sonic jumping?
0088442C 6600                       		bne.s	loc_3F6A	; if not, branch
0088442E 3029 000C                  		move.w	obY(a1),d0
00884432 E248                       		lsr.w	#1,d0
00884434 0240 0380                  		andi.w	#$380,d0
00884438 1229 0008                  		move.b	obX(a1),d1
0088443C 0241 007F                  		andi.w	#$7F,d1
00884440 D041                       		add.w	d1,d0
00884442 45F8 A400                  		lea	(v_lvllayout).w,a2
00884446 1032 0000                  		move.b	(a2,d0.w),d0
0088444A 45FA 0000                  		lea	byte_3FCF(pc),a2
0088444E 7206                       		moveq	#6,d1
00884450                            
00884450                            loc_3F62:
00884450 B022                       		cmp.b	-(a2),d0
00884452 57C9 FFFC                  		dbeq	d1,loc_3F62
00884456 6700                       		beq.s	LZSlide_Move
00884458                            
00884458                            loc_3F6A:
00884458 4A38 F7CA                  		tst.b	(f_jumponly).w
0088445C 6700                       		beq.s	locret_3F7A
0088445E 337C 0005 003E             		move.w	#5,$3E(a1)
00884464 4238 F7CA                  		clr.b	(f_jumponly).w
00884468                            
00884468                            locret_3F7A:
00884468 4E75                       		rts	
0088446A                            ; ===========================================================================
0088446A                            
0088446A                            LZSlide_Move:
0088446A 0C41 0003                  		cmpi.w	#3,d1
0088446E 6400                       		bcc.s	loc_3F84
00884470 4E71                       		nop	
00884472                            
00884472                            loc_3F84:
00884472 08A9 0000 0022             		bclr	#0,obStatus(a1)
00884478 103B 1000                  		move.b	byte_3FC0(pc,d1.w),d0
0088447C 1340 0014                  		move.b	d0,obInertia(a1)
00884480 6A00                       		bpl.s	loc_3F9A
00884482 08E9 0000 0022             		bset	#0,obStatus(a1)
00884488                            
00884488                            loc_3F9A:
00884488 4229 0015                  		clr.b	obInertia+1(a1)
0088448C 137C 0000 001C             		move.b	#id_WaterSlide,obAnim(a1) ; use Sonic's "sliding" animation
00884492 11FC 0001 F7CA             		move.b	#1,(f_jumponly).w ; lock controls (except jumping)
00884498 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088449C 0200 001F                  		andi.b	#$1F,d0
008844A0 6600                       		bne.s	locret_3FBE
008844AC                            
008844AC                            locret_3FBE:
008844AC 4E75                       		rts	
008844AE                            ; End of function LZWaterSlides
008844AE                            
008844AE                            ; ===========================================================================
008844AE 0AF5 0AF6 F5F4 0B00 0207+  byte_3FC0:	dc.b $A, $F5, $A, $F6, $F5, $F4, $B, 0,	2, 7, 3, $4C, $4B, 8, 4
008844BD 00                         byte_3FCF:	dc.b 0			; XREF: LZWaterSlides
008844BE                            		even
008844BE                            		even
008844BE                            		include	"_inc\MoveSonicInDemo.asm"
008844BE                            ; ---------------------------------------------------------------------------
008844BE                            ; Subroutine to	move Sonic in demo mode
008844BE                            ; ---------------------------------------------------------------------------
008844BE                            
008844BE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008844BE                            
008844BE                            
008844BE                            MoveSonicInDemo:			; XREF: Level_MainLoop; et al
008844BE 4A78 FFF0                  		tst.w	(f_demo).w	; is demo mode on?
008844C2 6600                       		bne.s	MDemo_On	; if yes, branch
008844C4 4E75                       		rts	
008844C6                            ; ===========================================================================
008844C6                            
008844C6                            ; This is an unused subroutine for recording a demo
008844C6                            
008844C6                            DemoRecorder:
008844C6 43F9 0008 0000             		lea	($80000).l,a1
008844CC 3038 F790                  		move.w	(v_btnpushtime1).w,d0
008844D0 D2C0                       		adda.w	d0,a1
008844D2 1038 F604                  		move.b	(v_jpadhold1).w,d0
008844D6 B011                       		cmp.b	(a1),d0
008844D8 6600                       		bne.s	@next
008844DA 5229 0001                  		addq.b	#1,1(a1)
008844DE 0C29 00FF 0001             		cmpi.b	#$FF,1(a1)
008844E4 6700                       		beq.s	@next
008844E6 4E75                       		rts	
008844E8                            
008844E8                            	@next:
008844E8 1340 0002                  		move.b	d0,2(a1)
008844EC 137C 0000 0003             		move.b	#0,3(a1)
008844F2 5478 F790                  		addq.w	#2,(v_btnpushtime1).w
008844F6 0278 03FF F790             		andi.w	#$3FF,(v_btnpushtime1).w
008844FC 4E75                       		rts	
008844FE                            ; ===========================================================================
008844FE                            
008844FE                            MDemo_On:				; XREF: MoveSonicInDemo
008844FE 4A38 F604                  		tst.b	(v_jpadhold1).w	; is start button pressed?
00884502 6A00                       		bpl.s	@dontquit	; if not, branch
00884504 4A78 FFF0                  		tst.w	(f_demo).w	; is this an ending sequence demo?
00884508 6B00                       		bmi.s	@dontquit	; if yes, branch
0088450A 11FC 0000 F600             		move.b	#id_Title,(v_gamemode).w ; go to title screen
00884510                            
00884510                            	@dontquit:
00884510 43F9 0000 0000             		lea	(DemoDataPtr).l,a1
00884516 7000                       		moveq	#0,d0
00884518 1038 FE10                  		move.b	(v_zone).w,d0
0088451C 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w ; is this a special stage?
00884522 6600                       		bne.s	@notspecial	; if not, branch
00884524 7006                       		moveq	#6,d0		; use demo #6
00884526                            
00884526                            	@notspecial:
00884526 E548                       		lsl.w	#2,d0
00884528 2271 0000                  		movea.l	(a1,d0.w),a1	; fetch address for demo data
0088452C 4A78 FFF0                  		tst.w	(f_demo).w	; is this an ending sequence demo?
00884530 6A00                       		bpl.s	@notcredits	; if not, branch
00884532 43F9 0000 0000             		lea	(DemoEndDataPtr).l,a1
00884538 3038 FFF4                  		move.w	(v_creditsnum).w,d0
0088453C 5340                       		subq.w	#1,d0
0088453E E548                       		lsl.w	#2,d0
00884540 2271 0000                  		movea.l	(a1,d0.w),a1	; fetch address for credits demo
00884544                            
00884544                            	@notcredits:
00884544 3038 F790                  		move.w	(v_btnpushtime1).w,d0
00884548 D2C0                       		adda.w	d0,a1
0088454A 1011                       		move.b	(a1),d0
0088454C 41F8 F604                  		lea	(v_jpadhold1).w,a0
00884550 1200                       		move.b	d0,d1
00884552                            		
00884552 1428 FFFE                  		move.b	-2(a0),d2
00884556                            	;end Demo Playback Fix
00884556                            	
00884556 B500                       		eor.b	d2,d0
00884558 10C1                       		move.b	d1,(a0)+
0088455A C001                       		and.b	d1,d0
0088455C 10C0                       		move.b	d0,(a0)+
0088455E 5338 F792                  		subq.b	#1,(v_btnpushtime2).w
00884562 6400                       		bcc.s	@end
00884564 11E9 0003 F792             		move.b	3(a1),(v_btnpushtime2).w
0088456A 5478 F790                  		addq.w	#2,(v_btnpushtime1).w
0088456E                            
0088456E                            	@end:
0088456E 4E75                       		rts	
00884570                            ; End of function MoveSonicInDemo
00884570                            
00884570                            ; ===========================================================================
00884570                            ; ---------------------------------------------------------------------------
00884570                            ; Demo sequence	pointers
00884570                            ; ---------------------------------------------------------------------------
00884570 0000 0000                  DemoDataPtr:	dc.l Demo_GHZ		; demos run after the title screen
00884574 0000 0000                  		dc.l Demo_GHZ
00884578 0000 0000                  		dc.l Demo_MZ
0088457C 0000 0000                  		dc.l Demo_MZ
00884580 0000 0000                  		dc.l Demo_SYZ
00884584 0000 0000                  		dc.l Demo_SYZ
00884588 0000 0000                  		dc.l Demo_SS
0088458C 0000 0000                  		dc.l Demo_SS
00884590                            
00884590 0000 0000                  DemoEndDataPtr:	dc.l Demo_EndGHZ1	; demos run during the credits
00884594 0000 0000                  		dc.l Demo_EndMZ
00884598 0000 0000                  		dc.l Demo_EndSYZ
0088459C 0000 0000                  		dc.l Demo_EndLZ
008845A0 0000 0000                  		dc.l Demo_EndSLZ
008845A4 0000 0000                  		dc.l Demo_EndSBZ1
008845A8 0000 0000                  		dc.l Demo_EndSBZ2
008845AC 0000 0000                  		dc.l Demo_EndGHZ2
008845B0                            
008845B0 008B 0837 0042 085C 006A+  		dc.b 0,	$8B, 8,	$37, 0,	$42, 8,	$5C, 0,	$6A, 8,	$5F, 0,	$2F, 8,	$2C
008845C0 0021 0803 2830 0808 002E+  		dc.b 0,	$21, 8,	3, $28,	$30, 8,	8, 0, $2E, 8, $15, 0, $F, 8, $46
008845D0 001A 08FF 08CA 0000 0000+  		dc.b 0,	$1A, 8,	$FF, 8,	$CA, 0,	0, 0, 0, 0, 0, 0, 0, 0,	0
008845E0                            		even
008845E0                            		even
008845E0                            
008845E0                            ; ---------------------------------------------------------------------------
008845E0                            ; Collision index pointer loading subroutine
008845E0                            ; ---------------------------------------------------------------------------
008845E0                            
008845E0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008845E0                            
008845E0                            
008845E0                            ColIndexLoad:				; XREF: GM_Level
008845E0 7000                       		moveq	#0,d0
008845E2 1038 FE10                  		move.b	(v_zone).w,d0
008845E6 E548                       		lsl.w	#2,d0
008845E8 21FB 0000 F796             		move.l	ColPointers(pc,d0.w),(v_collindex).w
008845EE 4E75                       		rts	
008845F0                            ; End of function ColIndexLoad
008845F0                            
008845F0                            ; ===========================================================================
008845F0                            ; ---------------------------------------------------------------------------
008845F0                            ; Collision index pointers
008845F0                            ; ---------------------------------------------------------------------------
008845F0 0000 0000                  ColPointers:	dc.l Col_GHZ
008845F4 0000 0000                  		dc.l Col_LZ
008845F8 0000 0000                  		dc.l Col_MZ
008845FC 0000 0000                  		dc.l Col_SLZ
00884600 0000 0000                  		dc.l Col_SYZ
00884604 0000 0000                  		dc.l Col_SBZ
00884608                            ;		dc.l Col_GHZ ; Pointer for Ending is missing by default.
00884608                            
00884608                            		include	"_inc\Oscillatory Routines.asm"
00884608                            ; ---------------------------------------------------------------------------
00884608                            ; Oscillating number subroutines
00884608                            ; ---------------------------------------------------------------------------
00884608                            
00884608                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884608                            
00884608                            ; Initialise the values
00884608                            
00884608                            OscillateNumInit:			; XREF: GM_Level
00884608 43F8 FE5E                  		lea	(v_oscillate).w,a1
0088460C 45F9 0000 0000             		lea	(@baselines).l,a2
00884612 7220                       		moveq	#$20,d1
00884614                            
00884614                            	@loop:
00884614 32DA                       		move.w	(a2)+,(a1)+	; copy baseline values to RAM
00884616 51C9 FFFC                  		dbf	d1,@loop
0088461A 4E75                       		rts	
0088461C                            
0088461C                            
0088461C                            ; ===========================================================================
0088461C 007C                       @baselines:	dc.w %0000000001111100	; oscillation direction bitfield
0088461E 0080 0000                  		dc.w $80, 0
00884622 0080 0000                  		dc.w $80, 0
00884626 0080 0000                  		dc.w $80, 0
0088462A 0080 0000                  		dc.w $80, 0
0088462E 0080 0000                  		dc.w $80, 0
00884632 0080 0000                  		dc.w $80, 0
00884636 0080 0000                  		dc.w $80, 0
0088463A 0080 0000                  		dc.w $80, 0
0088463E 0080 0000                  		dc.w $80, 0
00884642 50F0 011E                  		dc.w $50F0, $11E
00884646 2080 00B4                  		dc.w $2080, $B4
0088464A 3080 010E                  		dc.w $3080, $10E
0088464E 5080 01C2                  		dc.w $5080, $1C2
00884652 7080 0276                  		dc.w $7080, $276
00884656 0080 0000                  		dc.w $80, 0
0088465A 0080 0000                  		dc.w $80, 0
0088465E                            		even
0088465E                            
0088465E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088465E                            
0088465E                            ; Oscillate values
0088465E                            
0088465E                            OscillateNumDo:				; XREF: GM_Level
0088465E 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w ; has Sonic just died?
00884664 6400                       		bcc.s	@end		; if yes, branch
00884666 43F8 FE5E                  		lea	(v_oscillate).w,a1
0088466A 45F9 0000 0000             		lea	(@settings).l,a2
00884670 3619                       		move.w	(a1)+,d3	; get oscillation direction bitfield
00884672 720F                       		moveq	#$F,d1
00884674                            
00884674                            @loop:
00884674 341A                       		move.w	(a2)+,d2	; get frequency
00884676 381A                       		move.w	(a2)+,d4	; get amplitude
00884678 0303                       		btst	d1,d3		; check oscillation direction
0088467A 6600                       		bne.s	@down		; branch if 1
0088467C                            
0088467C                            	@up:
0088467C 3029 0002                  		move.w	2(a1),d0	; get current rate
00884680 D042                       		add.w	d2,d0		; add frequency
00884682 3340 0002                  		move.w	d0,2(a1)
00884686 D169 0000                  		add.w	d0,0(a1)	; add rate to value
0088468A B829 0000                  		cmp.b	0(a1),d4
0088468E 6200                       		bhi.s	@next
00884690 03C3                       		bset	d1,d3
00884692 6000                       		bra.s	@next
00884694                            
00884694                            	@down:
00884694 3029 0002                  		move.w	2(a1),d0
00884698 9042                       		sub.w	d2,d0
0088469A 3340 0002                  		move.w	d0,2(a1)
0088469E D169 0000                  		add.w	d0,0(a1)
008846A2 B829 0000                  		cmp.b	0(a1),d4
008846A6 6300                       		bls.s	@next
008846A8 0383                       		bclr	d1,d3
008846AA                            
008846AA                            	@next:
008846AA 5849                       		addq.w	#4,a1
008846AC 51C9 FFC6                  		dbf	d1,@loop
008846B0 31C3 FE5E                  		move.w	d3,(v_oscillate).w
008846B4                            
008846B4                            @end:
008846B4 4E75                       		rts	
008846B6                            ; End of function OscillateNumDo
008846B6                            
008846B6                            ; ===========================================================================
008846B6 0002 0010                  @settings:	dc.w 2,	$10	; frequency, amplitude
008846BA 0002 0018                  		dc.w 2,	$18
008846BE 0002 0020                  		dc.w 2,	$20
008846C2 0002 0030                  		dc.w 2,	$30
008846C6 0004 0020                  		dc.w 4,	$20
008846CA 0008 0008                  		dc.w 8,	8
008846CE 0008 0040                  		dc.w 8,	$40
008846D2 0004 0040                  		dc.w 4,	$40
008846D6 0002 0050                  		dc.w 2,	$50
008846DA 0002 0050                  		dc.w 2,	$50
008846DE 0002 0020                  		dc.w 2,	$20
008846E2 0003 0030                  		dc.w 3,	$30
008846E6 0005 0050                  		dc.w 5,	$50
008846EA 0007 0070                  		dc.w 7,	$70
008846EE 0002 0010                  		dc.w 2,	$10
008846F2 0002 0010                  		dc.w 2,	$10
008846F6                            		even
008846F6                            		even
008846F6                            
008846F6                            ; ---------------------------------------------------------------------------
008846F6                            ; Subroutine to	change synchronised animation variables (rings, giant rings)
008846F6                            ; ---------------------------------------------------------------------------
008846F6                            
008846F6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008846F6                            
008846F6                            
008846F6                            SynchroAnimate:				; XREF: GM_Level
008846F6                            
008846F6                            ; Used for GHZ spiked log
008846F6                            Sync1:
008846F6 5338 FEC0                  		subq.b	#1,(v_ani0_time).w ; has timer reached 0?
008846FA 6A00                       		bpl.s	Sync2		; if not, branch
008846FC 11FC 000B FEC0             		move.b	#$B,(v_ani0_time).w ; reset timer
00884702 5338 FEC1                  		subq.b	#1,(v_ani0_frame).w ; next frame
00884706 0238 0007 FEC1             		andi.b	#7,(v_ani0_frame).w ; max frame is 7
0088470C                            
0088470C                            ; Used for rings and giant rings
0088470C                            Sync2:
0088470C 5338 FEC2                  		subq.b	#1,(v_ani1_time).w
00884710 6A00                       		bpl.s	Sync3
00884712 11FC 0007 FEC2             		move.b	#7,(v_ani1_time).w
00884718 5238 FEC3                  		addq.b	#1,(v_ani1_frame).w
0088471C 0238 0003 FEC3             		andi.b	#3,(v_ani1_frame).w
00884722                            
00884722                            ; Used for nothing
00884722                            Sync3:
00884722 5338 FEC4                  		subq.b	#1,(v_ani2_time).w
00884726 6A00                       		bpl.s	Sync4
00884728 11FC 0007 FEC4             		move.b	#7,(v_ani2_time).w
0088472E 5238 FEC5                  		addq.b	#1,(v_ani2_frame).w
00884732 0C38 0006 FEC5             		cmpi.b	#6,(v_ani2_frame).w
00884738 6500                       		bcs.s	Sync4
0088473A 11FC 0000 FEC5             		move.b	#0,(v_ani2_frame).w
00884740                            
00884740                            ; Used for bouncing rings
00884740                            Sync4:
00884740 4A38 FEC6                  		tst.b	(v_ani3_time).w
00884744 6700                       		beq.s	SyncEnd
00884746 7000                       		moveq	#0,d0
00884748 1038 FEC6                  		move.b	(v_ani3_time).w,d0
0088474C D078 FEC8                  		add.w	(v_ani3_buf).w,d0
00884750 31C0 FEC8                  		move.w	d0,(v_ani3_buf).w
00884754 EF58                       		rol.w	#7,d0
00884756 0240 0003                  		andi.w	#3,d0
0088475A 11C0 FEC7                  		move.b	d0,(v_ani3_frame).w
0088475E 5338 FEC6                  		subq.b	#1,(v_ani3_time).w
00884762                            
00884762                            SyncEnd:
00884762 4E75                       		rts	
00884764                            ; End of function SynchroAnimate
00884764                            
00884764                            ; ---------------------------------------------------------------------------
00884764                            ; End-of-act signpost pattern loading subroutine
00884764                            ; ---------------------------------------------------------------------------
00884764                            
00884764                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884764                            
00884764                            
00884764                            SignpostArtLoad:			; XREF: GM_Level
00884764 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	being used?
00884768 6600 0000                  		bne.w	@exit		; if yes, branch
0088476C 0C38 0002 FE11             		cmpi.b	#2,(v_act).w	; is act number 02 (act 3)?
00884772 6700                       		beq.s	@exit		; if yes, branch
00884774                            
00884774 3038 F700                  		move.w	(v_screenposx).w,d0
00884778 3238 F72A                  		move.w	(v_limitright2).w,d1
0088477C 0441 0100                  		subi.w	#$100,d1
00884780 B041                       		cmp.w	d1,d0		; has Sonic reached the	edge of	the level?
00884782 6D00                       		blt.s	@exit		; if not, branch
00884784 4A38 FE1E                  		tst.b	(f_timecount).w
00884788 6700                       		beq.s	@exit
0088478A B278 F728                  		cmp.w	(v_limitleft2).w,d1
0088478E 6700                       		beq.s	@exit
00884790 31C1 F728                  		move.w	d1,(v_limitleft2).w ; move left boundary to current screen position
00884794                            		
00884794 31FC 0C40 F7BE             		move.w	#$C40,(v_gfxbigring).w	;set big ring gfx to load
0088479A                            		
0088479A 7000                       		moveq	#plcid_Signpost,d0
0088479C 6000 D436                  		bra.w	NewPLC		; load signpost	patterns
008847A0                            
008847A0                            	@exit:
008847A0 4E75                       		rts	
008847A2                            ; End of function SignpostArtLoad
008847A2                            
008847A2                            ; ===========================================================================
008847A2                            Demo_GHZ:	incbin	"demodata\Intro - GHZ.bin"
00884822                            Demo_MZ:	incbin	"demodata\Intro - MZ.bin"
00884952                            Demo_SYZ:	incbin	"demodata\Intro - SYZ.bin"
008849D2                            Demo_SS:	incbin	"demodata\Intro - Special Stage.bin"
00884AD2                            ; ===========================================================================
00884AD2                            
00884AD2                            ; ---------------------------------------------------------------------------
00884AD2                            ; Special Stage
00884AD2                            ; ---------------------------------------------------------------------------
00884AD2                            
00884AD2                            GM_Special:				; XREF: GameModeArray
00884AD2 303C 00AF                  		move.w	#sfx_EnterSS,d0
00884AD6 6100 CDA4                  		bsr.w	PlaySound_Special ; play special stage entry sound
00884ADA 6100 DAE2                  		bsr.w	PaletteWhiteOut
00884ADE 46FC 2700                  		disable_ints
00884AE2 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00884AE8 3CBC 8B03                  		move.w	#$8B03,(a6)	; line scroll mode
00884AEC 3CBC 8004                  		move.w	#$8004,(a6)	; 8-colour mode
00884AF0 31FC 8AAF F624             		move.w	#$8A00+175,(v_hbla_hreg).w
00884AF6 3CBC 9011                  		move.w	#$9011,(a6)	; 128-cell hscroll size
00884AFA 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00884AFE 0200 00BF                  		andi.b	#$BF,d0
00884B02 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
00884B08 6100 CC52                  		bsr.w	ClearScreen
00884B0C 46FC 2300                  		enable_ints
00884B10 4BF9 00C0 0004 3ABC 8F01+  		fillVRAM	0,$6FFF,$5000
00884B32                            
00884B32                            	SS_WaitForDMA:
00884B32 3215                       		move.w	(a5),d1		; read control port (vdp_control_port)
00884B34 0801 0001                  		btst	#1,d1		; is DMA running?
00884B38 66F8                       		bne.s	SS_WaitForDMA	; if yes, branch
00884B3A 3ABC 8F02                  		move.w	#$8F02,(a5)	; set VDP increment to 2 bytes
00884B3E 6100 0000                  		bsr.w	SS_BGLoad
00884B42 7000                       		moveq	#plcid_SpecialStage,d0
00884B44 6100 D1C8                  		bsr.w	QuickPLC	; load special stage patterns
00884B48                            
00884B48 43F8 D000                  		lea	(v_objspace).w,a1
00884B4C 7000                       		moveq	#0,d0
00884B4E 323C 07FF                  		move.w	#$7FF,d1
00884B52                            	SS_ClrObjRam:
00884B52 22C0                       		move.l	d0,(a1)+
00884B54 51C9 FFFC                  		dbf	d1,SS_ClrObjRam	; clear	the object RAM
00884B58                            
00884B58 43F8 F700                  		lea	(v_screenposx).w,a1
00884B5C 7000                       		moveq	#0,d0
00884B5E 323C 003F                  		move.w	#$3F,d1
00884B62                            	SS_ClrRam1:
00884B62 22C0                       		move.l	d0,(a1)+
00884B64 51C9 FFFC                  		dbf	d1,SS_ClrRam1	; clear	variables
00884B68                            
00884B68 43F8 FE60                  		lea	(v_oscillate+2).w,a1
00884B6C 7000                       		moveq	#0,d0
00884B6E 323C 0027                  		move.w	#$27,d1
00884B72                            	SS_ClrRam2:
00884B72 22C0                       		move.l	d0,(a1)+
00884B74 51C9 FFFC                  		dbf	d1,SS_ClrRam2	; clear	variables
00884B78                            
00884B78 43F8 AA00                  		lea	(v_ngfx_buffer).w,a1
00884B7C 7000                       		moveq	#0,d0
00884B7E 323C 007F                  		move.w	#$7F,d1
00884B82                            	SS_ClrNemRam:
00884B82 22C0                       		move.l	d0,(a1)+
00884B84 51C9 FFFC                  		dbf	d1,SS_ClrNemRam	; clear	Nemesis	buffer
00884B88                            
00884B88 4238 F64E                  		clr.b	(f_wtr_state).w
00884B8C 4278 FE02                  		clr.w	(f_restart).w
00884B90 700A                       		moveq	#palid_Special,d0
00884B92 6100 DBAA                  		bsr.w	PalLoad1	; load special stage palette
00884B96 4EB9 0000 0000             		jsr	SS_Load		; load SS layout data
00884B9C 21FC 0000 0000 F700        		move.l	#0,(v_screenposx).w
00884BA4 21FC 0000 0000 F704        		move.l	#0,(v_screenposy).w
00884BAC 11FC 0000 D000             		move.b	#id_SonicSpecial,(v_objspace).w ; load special stage Sonic object
00884BB2                            		
00884BB2                            		
00884BB2 6100 0000                  		bsr.w	PalCycle_SS
00884BB6 4278 F780                  		clr.w	(v_ssangle).w	; set stage angle to "upright"
00884BBA 31FC 0040 F782             		move.w	#$40,(v_ssrotate).w ; set stage rotation speed
00884BC0 303C 0009                  		move.w	#bgm_SS,d0
00884BC4 6100 CC76                  		bsr.w	PlaySound	; play special stage BG	music
00884BC8 31FC 0000 F790             		move.w	#0,(v_btnpushtime1).w
00884BCE 43F9 0088 4570             		lea	(DemoDataPtr).l,a1
00884BD4 7006                       		moveq	#6,d0
00884BD6 E548                       		lsl.w	#2,d0
00884BD8 2271 0000                  		movea.l	(a1,d0.w),a1
00884BDC 11E9 0001 F792             		move.b	1(a1),(v_btnpushtime2).w
00884BE2 5338 F792                  		subq.b	#1,(v_btnpushtime2).w
00884BE6 4278 FE20                  		clr.w	(v_rings).w
00884BEA 4238 FE1B                  		clr.b	(v_lifecount).w
00884BEE 31FC 0000 FE08             		move.w	#0,(v_debuguse).w
00884BF4 31FC 0708 F614             		move.w	#1800,(v_demolength).w
00884BFA 4A38 FFE2                  		tst.b	(f_debugcheat).w ; has debug cheat been entered?
00884BFE 6700                       		beq.s	SS_NoDebug	; if not, branch
00884C00 0838 0006 F604             		btst	#bitA,(v_jpadhold1).w ; is A button pressed?
00884C06 6700                       		beq.s	SS_NoDebug	; if not, branch
00884C08 11FC 0001 FFFA             		move.b	#1,(f_debugmode).w ; enable debug mode
00884C0E                            
00884C0E                            	SS_NoDebug:
00884C0E 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00884C12 0000 0040                  		ori.b	#$40,d0
00884C16 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
00884C1C 6100 D8F4                  		bsr.w	PaletteWhiteIn
00884C20                            
00884C20                            ; ---------------------------------------------------------------------------
00884C20                            ; Main Special Stage loop
00884C20                            ; ---------------------------------------------------------------------------
00884C20                            
00884C20                            SS_MainLoop:
00884C20 6100 CCAA                  		bsr.w	PauseGame
00884C24 11FC 000A F62A             		move.b	#$A,(v_vbla_routine).w
00884C2A 6100 E3BE                  		bsr.w	WaitForVBla
00884C2E                            		
00884C2E                            		
00884C2E 6100 F88E                  		bsr.w	MoveSonicInDemo
00884C32 31F8 F604 F602             		move.w	(v_jpadhold1).w,(v_jpadhold2).w
00884C38 4EB9 0000 0000             		jsr		ExecuteObjects
00884C3E 4EB9 0000 0000             		jsr		BuildSprites
00884C44 4EB9 0000 0000             		jsr		SS_ShowLayout
00884C4A 6100 0000                  		bsr.w	SS_BGAnimate
00884C4E 4A78 FFF0                  		tst.w	(f_demo).w	; is demo mode on?
00884C52 6700                       		beq.s	SS_ChkEnd	; if not, branch
00884C54 4A78 F614                  		tst.w	(v_demolength).w ; is there time left on the demo?
00884C58 6700 0000                  		beq.w	SS_ToSegaScreen	; if not, branch
00884C5C                            
00884C5C                            	SS_ChkEnd:
00884C5C 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w ; is game mode $10 (special stage)?
00884C62 6700 FFBC                  		beq.w	SS_MainLoop	; if yes, branch
00884C66                            
00884C66 4A78 FFF0                  		tst.w	(f_demo).w	; is demo mode on?
00884C6A                            
00884C6A 6600 0000                  		bne.w	SS_ToLevel
00884C6E                            
00884C6E 11FC 0000 F600             		move.b	#id_Level,(v_gamemode).w ; set screen mode to $0C (level)
00884C74 0C78 0503 FE10             		cmpi.w	#(id_SBZ<<8)+3,(v_zone).w ; is level number higher than FZ?
00884C7A 6500                       		bcs.s	SS_Finish	; if not, branch
00884C7C 4278 FE10                  		clr.w	(v_zone).w	; set to GHZ1
00884C80                            
00884C80                            SS_Finish:
00884C80 31FC 003C F614             		move.w	#60,(v_demolength).w ; set delay time to 1 second
00884C86 31FC 003F F626             		move.w	#$3F,(v_pfade_start).w
00884C8C 4278 F794                  		clr.w	(v_palchgspeed).w
00884C90                            
00884C90                            	SS_FinLoop:
00884C90 11FC 0016 F62A             		move.b	#$16,(v_vbla_routine).w
00884C96 6100 E352                  		bsr.w	WaitForVBla
00884C9A 6100 F822                  		bsr.w	MoveSonicInDemo
00884C9E 31F8 F604 F602             		move.w	(v_jpadhold1).w,(v_jpadhold2).w
00884CA4 4EB9 0000 0000             		jsr	ExecuteObjects
00884CAA 4EB9 0000 0000             		jsr	BuildSprites
00884CB0 4EB9 0000 0000             		jsr	SS_ShowLayout
00884CB6 6100 0000                  		bsr.w	SS_BGAnimate
00884CBA 5378 F794                  		subq.w	#1,(v_palchgspeed).w
00884CBE 6A00                       		bpl.s	loc_47D4
00884CC0 31FC 0002 F794             		move.w	#2,(v_palchgspeed).w
00884CC6 6100 D916                  		bsr.w	WhiteOut_ToWhite
00884CCA                            
00884CCA                            loc_47D4:
00884CCA 4A78 F614                  		tst.w	(v_demolength).w
00884CCE 66C0                       		bne.s	SS_FinLoop
00884CD0                            
00884CD0 46FC 2700                  		disable_ints
00884CD4 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00884CDA 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
00884CDE 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
00884CE2 3CBC 9001                  		move.w	#$9001,(a6)		; 64-cell hscroll size
00884CE6 6100 CA74                  		bsr.w	ClearScreen
00884CF4 41F9 0000 0000             		lea	(Nem_TitleCard).l,a0 ; load title card patterns
00884CFA 6100 CD66                  		bsr.w	NemDec
00884CFE 4EB9 0000 0000             		jsr	Hud_Base
00884D04                            		
00884D04 4278 C800                  		clr.w	($FFFFC800).w
00884D08 21FC FFFF C800 C8FC        		move.l	#$FFFFC800,($FFFFC8FC).w
00884D10                            		
00884D10 46FC 2300                  		move	#$2300,sr
00884D14 7011                       		moveq	#palid_SSResult,d0
00884D16 6100 DA42                  		bsr.w	PalLoad2	; load results screen palette
00884D1A 7000                       		moveq	#plcid_Main,d0
00884D1C 6100 CEB6                  		bsr.w	NewPLC
00884D20 7000                       		moveq	#plcid_SSResult,d0
00884D22 6100 CE7E                  		bsr.w	AddPLC		; load results screen patterns
00884D26 11FC 0001 FE1F             		move.b	#1,(f_scorecount).w ; update score counter
00884D2C 11FC 0001 F7D6             		move.b	#1,(f_endactbonus).w ; update ring bonus counter
00884D32 3038 FE20                  		move.w	(v_rings).w,d0
00884D36 C0FC 000A                  		mulu.w	#10,d0		; multiply rings by 10
00884D3A 31C0 F7D4                  		move.w	d0,(v_ringbonus).w ; set rings bonus
00884D48                            
00884D48 43F8 D000                  		lea	(v_objspace).w,a1
00884D4C 7000                       		moveq	#0,d0
00884D4E 323C 07FF                  		move.w	#$7FF,d1
00884D52                            	SS_EndClrObjRam:
00884D52 22C0                       		move.l	d0,(a1)+
00884D54 51C9 FFFC                  		dbf	d1,SS_EndClrObjRam ; clear object RAM
00884D58                            
00884D58 11FC 007E D5C0             		move.b	#$7E,(v_objspace+$5C0).w ; load results screen object
00884D5E                            
00884D5E                            SS_NormalExit:
00884D5E 6100 CB6C                  		bsr.w	PauseGame
00884D62 11FC 000C F62A             		move.b	#$C,(v_vbla_routine).w
00884D68 6100 E280                  		bsr.w	WaitForVBla
00884D6C 4EB9 0000 0000             		jsr	ExecuteObjects
00884D72 4EB9 0000 0000             		jsr	BuildSprites
00884D78 6100 CE94                  		bsr.w	RunPLC
00884D7C 4A78 FE02                  		tst.w	(f_restart).w
00884D80 67DC                       		beq.s	SS_NormalExit
00884D82 4AB8 F680                  		tst.l	(v_plc_buffer).w
00884D86 66D6                       		bne.s	SS_NormalExit
00884D88 303C 00AF                  		move.w	#sfx_EnterSS,d0
00884D8C 6100 CAEE                  		bsr.w	PlaySound_Special ; play special stage exit sound
00884D90 6100 D82C                  		bsr.w	PaletteWhiteOut
00884D94 4E75                       		rts	
00884D96                            ; ===========================================================================
00884D96                            
00884D96                            SS_ToSegaScreen:
00884D96 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; goto Sega screen
00884D9C 4E75                       		rts
00884D9E                            
00884D9E 0C38 0000 F600             SS_ToLevel:	cmpi.b	#id_Level,(v_gamemode).w
00884DA4 67F0                       		beq.s	SS_ToSegaScreen
00884DA6 4E75                       		rts
00884DA8                            
00884DA8                            ; ---------------------------------------------------------------------------
00884DA8                            ; Special stage	background loading subroutine
00884DA8                            ; ---------------------------------------------------------------------------
00884DA8                            
00884DA8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884DA8                            
00884DA8                            
00884DA8                            SS_BGLoad:				; XREF: GM_Special
00884DA8 43F9 00FF 0000             		lea	($FF0000).l,a1
00884DAE 41F9 0000 0000             		lea	(Eni_SSBg1).l,a0 ; load	mappings for the birds and fish
00884DB4 303C 4051                  		move.w	#$4051,d0
00884DB8 6100 CF86                  		bsr.w	EniDec
00884DBC 263C 5000 0001             		move.l	#$50000001,d3
00884DC2 45F9 00FF 0080             		lea	($FF0080).l,a2
00884DC8 7E06                       		moveq	#6,d7
00884DCA                            
00884DCA                            loc_48BE:
00884DCA 2003                       		move.l	d3,d0
00884DCC 7C03                       		moveq	#3,d6
00884DCE 7800                       		moveq	#0,d4
00884DD0 0C47 0003                  		cmpi.w	#3,d7
00884DD4 6400                       		bcc.s	loc_48CC
00884DD6 7801                       		moveq	#1,d4
00884DD8                            
00884DD8                            loc_48CC:
00884DD8 7A07                       		moveq	#7,d5
00884DDA                            
00884DDA                            loc_48CE:
00884DDA 224A                       		movea.l	a2,a1
00884DDC 0A04 0001                  		eori.b	#1,d4
00884DE0 6600                       		bne.s	loc_48E2
00884DE2 0C47 0006                  		cmpi.w	#6,d7
00884DE6 6600                       		bne.s	loc_48F2
00884DE8 43F9 00FF 0000             		lea	($FF0000).l,a1
00884DEE                            
00884DEE                            loc_48E2:
00884DEE 48E7 F800                  		movem.l	d0-d4,-(sp)
00884DF2 7207                       		moveq	#7,d1
00884DF4 7407                       		moveq	#7,d2
00884DF6 6100 CB82                  		bsr.w	TilemapToVRAM
00884DFA 4CDF 001F                  		movem.l	(sp)+,d0-d4
00884DFE                            
00884DFE                            loc_48F2:
00884DFE 0680 0010 0000             		addi.l	#$100000,d0
00884E04 51CD FFD4                  		dbf	d5,loc_48CE
00884E08 0680 0380 0000             		addi.l	#$3800000,d0
00884E0E 0A04 0001                  		eori.b	#1,d4
00884E12 51CE FFC4                  		dbf	d6,loc_48CC
00884E16 0683 1000 0000             		addi.l	#$10000000,d3
00884E1C 6A00                       		bpl.s	loc_491C
00884E1E 4843                       		swap	d3
00884E20 0683 0000 C000             		addi.l	#$C000,d3
00884E26 4843                       		swap	d3
00884E28                            
00884E28                            loc_491C:
00884E28 D4FC 0080                  		adda.w	#$80,a2
00884E2C 51CF FF9C                  		dbf	d7,loc_48BE
00884E30 43F9 00FF 0000             		lea	($FF0000).l,a1
00884E36 41F9 0000 0000             		lea	(Eni_SSBg2).l,a0 ; load	mappings for the clouds
00884E3C 303C 4000                  		move.w	#$4000,d0
00884E40 6100 CEFE                  		bsr.w	EniDec
00884E44 43F9 00FF 0000             		lea	($FF0000).l,a1
00884E4A 203C 4000 0003             		move.l	#$40000003,d0
00884E50 723F                       		moveq	#$3F,d1
00884E52 741F                       		moveq	#$1F,d2
00884E54 6100 CB24                  		bsr.w	TilemapToVRAM
00884E58 43F9 00FF 0000             		lea	($FF0000).l,a1
00884E5E 203C 5000 0003             		move.l	#$50000003,d0
00884E64 723F                       		moveq	#$3F,d1
00884E66 743F                       		moveq	#$3F,d2
00884E68 6100 CB10                  		bsr.w	TilemapToVRAM
00884E6C 4E75                       		rts	
00884E6E                            ; End of function SS_BGLoad
00884E6E                            
00884E6E                            ; ---------------------------------------------------------------------------
00884E6E                            ; Palette cycling routine - special stage
00884E6E                            ; ---------------------------------------------------------------------------
00884E6E                            
00884E6E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00884E6E                            
00884E6E                            
00884E6E                            PalCycle_SS:				; XREF: VBla_0A; GM_Special
00884E6E 4A78 F63A                  		tst.w	(f_pause).w
00884E72 6600                       		bne.s	locret_49E6
00884E74 5378 F79C                  		subq.w	#1,(v_palss_time).w
00884E78 6A00                       		bpl.s	locret_49E6
00884E7A 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00884E80 3038 F79A                  		move.w	(v_palss_num).w,d0
00884E84 5278 F79A                  		addq.w	#1,(v_palss_num).w
00884E88 0240 001F                  		andi.w	#$1F,d0
00884E8C E548                       		lsl.w	#2,d0
00884E8E 41F9 0000 0000             		lea	(byte_4A3C).l,a0
00884E94 D0C0                       		adda.w	d0,a0
00884E96 1018                       		move.b	(a0)+,d0
00884E98 6A00                       		bpl.s	loc_4992
00884E9A 303C 01FF                  		move.w	#$1FF,d0
00884E9E                            
00884E9E                            loc_4992:
00884E9E 31C0 F79C                  		move.w	d0,(v_palss_time).w
00884EA2 7000                       		moveq	#0,d0
00884EA4 1018                       		move.b	(a0)+,d0
00884EA6 31C0 F7A0                  		move.w	d0,($FFFFF7A0).w
00884EAA 43F9 0000 0000             		lea	(byte_4ABC).l,a1
00884EB0 43F1 0000                  		lea	(a1,d0.w),a1
00884EB4 303C 8200                  		move.w	#-$7E00,d0
00884EB8 1019                       		move.b	(a1)+,d0
00884EBA 3C80                       		move.w	d0,(a6)
00884EBC 11D1 F616                  		move.b	(a1),(v_scrposy_dup).w
00884EC0 303C 8400                  		move.w	#-$7C00,d0
00884EC4 1018                       		move.b	(a0)+,d0
00884EC6 3C80                       		move.w	d0,(a6)
00884EC8 23FC 4000 0010 00C0 0004   		move.l	#$40000010,(vdp_control_port).l
00884ED2 23F8 F616 00C0 0000        		move.l	(v_scrposy_dup).w,(vdp_data_port).l
00884EDA 7000                       		moveq	#0,d0
00884EDC 1018                       		move.b	(a0)+,d0
00884EDE 6B00                       		bmi.s	loc_49E8
00884EE0 43F9 0000 0000             		lea	(Pal_SSCyc1).l,a1
00884EE6 D2C0                       		adda.w	d0,a1
00884EE8 45F8 FB4E                  		lea	(v_pal_dry+$4E).w,a2
00884EEC 24D9                       		move.l	(a1)+,(a2)+
00884EEE 24D9                       		move.l	(a1)+,(a2)+
00884EF0 24D9                       		move.l	(a1)+,(a2)+
00884EF2                            
00884EF2                            locret_49E6:
00884EF2 4E75                       		rts	
00884EF4                            ; ===========================================================================
00884EF4                            
00884EF4                            loc_49E8:				; XREF: PalCycle_SS
00884EF4 3238 F79E                  		move.w	($FFFFF79E).w,d1
00884EF8 0C40 008A                  		cmpi.w	#$8A,d0
00884EFC 6500                       		bcs.s	loc_49F4
00884EFE 5241                       		addq.w	#1,d1
00884F00                            
00884F00                            loc_49F4:
00884F00 C2FC 002A                  		mulu.w	#$2A,d1
00884F04 43F9 0000 0000             		lea	(Pal_SSCyc2).l,a1
00884F0A D2C1                       		adda.w	d1,a1
00884F0C 0240 007F                  		andi.w	#$7F,d0
00884F10 0880 0000                  		bclr	#0,d0
00884F14 6700                       		beq.s	loc_4A18
00884F16 45F8 FB6E                  		lea	(v_pal_dry+$6E).w,a2
00884F1A 24D1                       		move.l	(a1),(a2)+
00884F1C 24E9 0004                  		move.l	4(a1),(a2)+
00884F20 24E9 0008                  		move.l	8(a1),(a2)+
00884F24                            
00884F24                            loc_4A18:
00884F24 D2FC 000C                  		adda.w	#$C,a1
00884F28 45F8 FB5A                  		lea	(v_pal_dry+$5A).w,a2
00884F2C 0C40 000A                  		cmpi.w	#$A,d0
00884F30 6500                       		bcs.s	loc_4A2E
00884F32 0440 000A                  		subi.w	#$A,d0
00884F36 45F8 FB7A                  		lea	(v_pal_dry+$7A).w,a2
00884F3A                            
00884F3A                            loc_4A2E:
00884F3A 3200                       		move.w	d0,d1
00884F3C D040                       		add.w	d0,d0
00884F3E D041                       		add.w	d1,d0
00884F40 D2C0                       		adda.w	d0,a1
00884F42 24D9                       		move.l	(a1)+,(a2)+
00884F44 34D9                       		move.w	(a1)+,(a2)+
00884F46 4E75                       		rts	
00884F48                            ; End of function PalCycle_SS
00884F48                            
00884F48                            ; ===========================================================================
00884F48 0300 0792 0300 0790 0300+  byte_4A3C:	dc.b 3,	0, 7, $92, 3, 0, 7, $90, 3, 0, 7, $8E, 3, 0, 7,	$8C
00884F58                            					; XREF: PalCycle_SS
00884F58 0300 078B 0300 0780 0300+  		dc.b 3,	0, 7, $8B, 3, 0, 7, $80, 3, 0, 7, $82, 3, 0, 7,	$84
00884F68 0300 0786 0300 0788 0708+  		dc.b 3,	0, 7, $86, 3, 0, 7, $88, 7, 8, 7, 0, 7,	$A, 7, $C
00884F78 FF0C 0718 FF0C 0718 070A+  		dc.b $FF, $C, 7, $18, $FF, $C, 7, $18, 7, $A, 7, $C, 7,	8, 7, 0
00884F88 0300 0688 0300 0686 0300+  		dc.b 3,	0, 6, $88, 3, 0, 6, $86, 3, 0, 6, $84, 3, 0, 6,	$82
00884F98 0300 0681 0300 068A 0300+  		dc.b 3,	0, 6, $81, 3, 0, 6, $8A, 3, 0, 6, $8C, 3, 0, 6,	$8E
00884FA8 0300 0690 0300 0692 0702+  		dc.b 3,	0, 6, $90, 3, 0, 6, $92, 7, 2, 6, $24, 7, 4, 6,	$30
00884FB8 FF06 063C FF06 063C 0704+  		dc.b $FF, 6, 6,	$3C, $FF, 6, 6,	$3C, 7,	4, 6, $30, 7, 2, 6, $24
00884FC8                            		even
00884FC8 1001 1800 1801 2000 2001+  byte_4ABC:	dc.b $10, 1, $18, 0, $18, 1, $20, 0, $20, 1, $28, 0, $28, 1
00884FD6                            		even
00884FD6                            
00884FD6                            Pal_SSCyc1:	incbin	"palette\Cycle - Special Stage 1.bin"
00885056                            		even
00885056                            Pal_SSCyc2:	incbin	"palette\Cycle - Special Stage 2.bin"
00885128                            		even
00885128                            
00885128                            ; ---------------------------------------------------------------------------
00885128                            ; Subroutine to	make the special stage background animated
00885128                            ; ---------------------------------------------------------------------------
00885128                            
00885128                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00885128                            
00885128                            
00885128                            SS_BGAnimate:				; XREF: GM_Special
00885128 3038 F7A0                  		move.w	($FFFFF7A0).w,d0
0088512C 6600                       		bne.s	loc_4BF6
0088512E 31FC 0000 F70C             		move.w	#0,($FFFFF70C).w
00885134 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
0088513A                            
0088513A                            loc_4BF6:
0088513A 0C40 0008                  		cmpi.w	#8,d0
0088513E 6400                       		bcc.s	loc_4C4E
00885140 0C40 0006                  		cmpi.w	#6,d0
00885144 6600                       		bne.s	loc_4C10
00885146 5278 F718                  		addq.w	#1,($FFFFF718).w
0088514A 5278 F70C                  		addq.w	#1,($FFFFF70C).w
0088514E 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00885154                            
00885154                            loc_4C10:
00885154 7000                       		moveq	#0,d0
00885156 3038 F708                  		move.w	($FFFFF708).w,d0
0088515A 4440                       		neg.w	d0
0088515C 4840                       		swap	d0
0088515E 43F9 0000 0000             		lea	(byte_4CCC).l,a1
00885164 47F8 AA00                  		lea	(v_ngfx_buffer).w,a3
00885168 7609                       		moveq	#9,d3
0088516A                            
0088516A                            loc_4C26:
0088516A 302B 0002                  		move.w	2(a3),d0
0088516E 6100 DEAC                  		bsr.w	CalcSine
00885172 7400                       		moveq	#0,d2
00885174 1419                       		move.b	(a1)+,d2
00885176 C1C2                       		muls.w	d2,d0
00885178 E080                       		asr.l	#8,d0
0088517A 36C0                       		move.w	d0,(a3)+
0088517C 1419                       		move.b	(a1)+,d2
0088517E 4882                       		ext.w	d2
00885180 D55B                       		add.w	d2,(a3)+
00885182 51CB FFE6                  		dbf	d3,loc_4C26
00885186 47F8 AA00                  		lea	(v_ngfx_buffer).w,a3
0088518A 45F9 0000 0000             		lea	(byte_4CB8).l,a2
00885190 6000                       		bra.s	loc_4C7E
00885192                            ; ===========================================================================
00885192                            
00885192                            loc_4C4E:				; XREF: SS_BGAnimate
00885192 0C40 000C                  		cmpi.w	#$C,d0
00885196 6600                       		bne.s	loc_4C74
00885198 5378 F718                  		subq.w	#1,($FFFFF718).w
0088519C 47F8 AB00                  		lea	($FFFFAB00).w,a3
008851A0 243C 0001 8000             		move.l	#$18000,d2
008851A6 7206                       		moveq	#6,d1
008851A8                            
008851A8                            loc_4C64:
008851A8 2013                       		move.l	(a3),d0
008851AA 9082                       		sub.l	d2,d0
008851AC 26C0                       		move.l	d0,(a3)+
008851AE 0482 0000 2000             		subi.l	#$2000,d2
008851B4 51C9 FFF2                  		dbf	d1,loc_4C64
008851B8                            
008851B8                            loc_4C74:
008851B8 47F8 AB00                  		lea	($FFFFAB00).w,a3
008851BC 45F9 0000 0000             		lea	(byte_4CC4).l,a2
008851C2                            
008851C2                            loc_4C7E:
008851C2 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
008851C6 3038 F718                  		move.w	($FFFFF718).w,d0
008851CA 4440                       		neg.w	d0
008851CC 4840                       		swap	d0
008851CE 7600                       		moveq	#0,d3
008851D0 161A                       		move.b	(a2)+,d3
008851D2 3438 F70C                  		move.w	($FFFFF70C).w,d2
008851D6 4442                       		neg.w	d2
008851D8 0242 00FF                  		andi.w	#$FF,d2
008851DC E54A                       		lsl.w	#2,d2
008851DE                            
008851DE                            loc_4C9A:
008851DE 301B                       		move.w	(a3)+,d0
008851E0 544B                       		addq.w	#2,a3
008851E2 7200                       		moveq	#0,d1
008851E4 121A                       		move.b	(a2)+,d1
008851E6 5341                       		subq.w	#1,d1
008851E8                            
008851E8                            loc_4CA4:
008851E8 2380 2000                  		move.l	d0,(a1,d2.w)
008851EC 5842                       		addq.w	#4,d2
008851EE 0242 03FC                  		andi.w	#$3FC,d2
008851F2 51C9 FFF4                  		dbf	d1,loc_4CA4
008851F6 51CB FFE6                  		dbf	d3,loc_4C9A
008851FA 4E75                       		rts	
008851FC                            ; End of function SS_BGAnimate
008851FC                            
008851FC                            ; ===========================================================================
008851FC 0928 1810 2818 1030 1808+  byte_4CB8:	dc.b 9,	$28, $18, $10, $28, $18, $10, $30, $18,	8, $10,	0
00885208                            		even
00885208 0630 3030 2818 1818        byte_4CC4:	dc.b 6,	$30, $30, $30, $28, $18, $18, $18
00885210                            		even
00885210 0802 04FF 0203 08FF 0402+  byte_4CCC:	dc.b 8,	2, 4, $FF, 2, 3, 8, $FF, 4, 2, 2, 3, 8,	$FD, 4,	2, 2, 3, 2, $FF
00885224                            		even
00885224                            					; XREF: SS_BGAnimate
00885224                            ; ===========================================================================
00885224                            
00885224                            ; ---------------------------------------------------------------------------
00885224                            ; Continue screen
00885224                            ; ---------------------------------------------------------------------------
00885224                            
00885224                            GM_Continue:				; XREF: GameModeArray
00885224 6100 D26E                  		bsr.w	PaletteFadeOut
00885228 46FC 2700                  		disable_ints
0088522C 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00885230 0200 00BF                  		andi.b	#$BF,d0
00885234 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
0088523A 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00885240 3CBC 8004                  		move.w	#$8004,(a6)	; 8 colour mode
00885244 3CBC 8700                  		move.w	#$8700,(a6)	; background colour
00885248 6100 C512                  		bsr.w	ClearScreen
0088524C                            
0088524C 43F8 D000                  		lea	(v_objspace).w,a1
00885250 7000                       		moveq	#0,d0
00885252 323C 07FF                  		move.w	#$7FF,d1
00885256                            	Cont_ClrObjRam:
00885256 22C0                       		move.l	d0,(a1)+
00885258 51C9 FFFC                  		dbf	d1,Cont_ClrObjRam ; clear object RAM
0088525C                            
00885266 41F9 0000 0000             		lea	(Nem_TitleCard).l,a0 ; load title card patterns
0088526C 6100 C7F4                  		bsr.w	NemDec
0088527A 41F9 0000 0000             		lea	(Nem_ContSonic).l,a0 ; load Sonic patterns
00885280 6100 C7E0                  		bsr.w	NemDec
0088528E 41F9 0000 0000             		lea	(Nem_MiniSonic).l,a0 ; load continue screen patterns
00885294 6100 C7CC                  		bsr.w	NemDec
00885298 720A                       		moveq	#10,d1
0088529A 4EB9 0000 0000             		jsr	ContScrCounter	; run countdown	(start from 10)
008852A0 7012                       		moveq	#palid_Continue,d0
008852A2 6100 D49A                  		bsr.w	PalLoad1	; load continue	screen palette
008852A6 103C 0010                  		move.b	#bgm_Continue,d0
008852AA 6100 C590                  		bsr.w	PlaySound	; play continue	music
008852AE 31FC 0293 F614             		move.w	#659,(v_demolength).w ; set time delay to 11 seconds
008852B4 42B8 F700                  		clr.l	(v_screenposx).w
008852B8 21FC 0100 0000 F704        		move.l	#$1000000,(v_screenposy).w
008852C0 11FC 0000 D000             		move.b	#id_ContSonic,(v_objspace).w ; load Sonic object
008852C6 11FC 0000 D040             		move.b	#id_ContScrItem,(v_objspace+$40).w ; load continue screen objects
008852CC 11FC 0000 D080             		move.b	#id_ContScrItem,(v_objspace+$80).w
008852D2 11FC 0003 D098             		move.b	#3,(v_objspace+$80+obPriority).w
008852D8 11FC 0004 D09A             		move.b	#4,(v_objspace+$80+obFrame).w
008852DE 11FC 0000 D0C0             		move.b	#id_ContScrItem,(v_objspace+$C0).w
008852E4 11FC 0004 D0E4             		move.b	#4,(v_objspace+$C0+obRoutine).w
008852EA 4EB9 0000 0000             		jsr	ExecuteObjects
008852F0 4EB9 0000 0000             		jsr	BuildSprites
008852F6 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
008852FA 0000 0040                  		ori.b	#$40,d0
008852FE 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
00885304 6100 D0E8                  		bsr.w	PaletteFadeIn
00885308                            
00885308                            ; ---------------------------------------------------------------------------
00885308                            ; Continue screen main loop
00885308                            ; ---------------------------------------------------------------------------
00885308                            
00885308                            Cont_MainLoop:
00885308 11FC 0016 F62A             		move.b	#$16,(v_vbla_routine).w
0088530E 6100 DCDA                  		bsr.w	WaitForVBla
00885312 0C38 0006 D024             		cmpi.b	#6,(v_objspace+obRoutine).w
00885318 6400                       		bhs.s	loc_4DF2
0088531A 46FC 2700                  		disable_ints
0088531E 3238 F614                  		move.w	(v_demolength).w,d1
00885322 82FC 003C                  		divu.w	#$3C,d1
00885326 0281 0000 000F             		andi.l	#$F,d1
0088532C 4EB9 0000 0000             		jsr	ContScrCounter
00885332 46FC 2300                  		enable_ints
00885336                            
00885336                            loc_4DF2:
00885336 4EB9 0000 0000             		jsr	ExecuteObjects
0088533C 4EB9 0000 0000             		jsr	BuildSprites
00885342 0C78 0180 D008             		cmpi.w	#$180,(v_objspace+obX).w ; has Sonic run off screen?
00885348 6400                       		bcc.s	Cont_GotoLevel	; if yes, branch
0088534A 0C38 0006 D024             		cmpi.b	#6,(v_objspace+obRoutine).w
00885350 64B6                       		bcc.s	Cont_MainLoop
00885352 4A78 F614                  		tst.w	(v_demolength).w
00885356 6600 FFB0                  		bne.w	Cont_MainLoop
0088535A 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; go to Sega screen
00885360 4E75                       		rts	
00885362                            ; ===========================================================================
00885362                            
00885362                            Cont_GotoLevel:
00885362 11FC 0000 F600             		move.b	#id_Level,(v_gamemode).w ; set screen mode to $0C (level)
00885368 11FC 0003 FE12             		move.b	#3,(v_lives).w	; set lives to 3
0088536E 7000                       		moveq	#0,d0
00885370 31C0 FE20                  		move.w	d0,(v_rings).w	; clear rings
00885374 21C0 FE22                  		move.l	d0,(v_time).w	; clear time
00885378                            		
00885378 11C0 FEBF                  		move.b	d0,(v_centstep).w
0088537C                            		
0088537C 21C0 FE26                  		move.l	d0,(v_score).w	; clear score
00885380 11C0 FE30                  		move.b	d0,(v_lastlamp).w ; clear lamppost count
00885384 5338 FE18                  		subq.b	#1,(v_continues).w ; subtract 1 from continues
00885388 4E75                       		rts	
0088538A                            ; ===========================================================================
0088538A                            
0088538A                            		include	"_incObj\80 Continue Screen Elements.asm"
0088538A                            ; ---------------------------------------------------------------------------
0088538A                            ; Object 80 - Continue screen elements
0088538A                            ; ---------------------------------------------------------------------------
0088538A                            
0088538A                            ContScrItem:					; XREF: Obj_Index
0088538A 7000                       		moveq	#0,d0
0088538C 1028 0024                  		move.b	$24(a0),d0
00885390 323B 0000                  		move.w	CSI_Index(pc,d0.w),d1
00885394 4EFB 1000                  		jmp	CSI_Index(pc,d1.w)
00885398                            ; ===========================================================================
00885398 0000                       CSI_Index:	dc.w CSI_Main-CSI_Index
0088539A 0000                       		dc.w CSI_Display-CSI_Index
0088539C 0000                       		dc.w CSI_MakeMiniSonic-CSI_Index
0088539E 0000                       		dc.w CSI_ChkDel-CSI_Index
008853A0                            ; ===========================================================================
008853A0                            
008853A0                            CSI_Main:	; Routine 0
008853A0 5428 0024                  		addq.b	#2,obRoutine(a0)
008853A4 217C 0000 0000 0004        		move.l	#Map_ContScr,obMap(a0)
008853AC 317C 8500 0002             		move.w	#$8500,obGfx(a0)
008853B2 117C 0000 0001             		move.b	#0,obRender(a0)
008853B8 117C 003C 0019             		move.b	#$3C,obActWid(a0)
008853BE 317C 0120 0008             		move.w	#$120,obX(a0)
008853C4 317C 00C0 000A             		move.w	#$C0,obScreenY(a0)
008853CA 31FC 0000 FE20             		move.w	#0,(v_rings).w	; clear rings
008853D0                            
008853D0                            CSI_Display:	; Routine 2
008853D0 4EF9 0000 0000             		jmp	DisplaySprite
008853D6                            ; ===========================================================================
008853D6                            
008853D6                            	CSI_MiniSonicPos:
008853D6 0116 012A 0102 013E 00EE+  		dc.w $116, $12A, $102, $13E, $EE, $152, $DA, $166, $C6
008853E8 017A 00B2 018E 009E 01A2+  		dc.w $17A, $B2,	$18E, $9E, $1A2, $8A
008853F4                            
008853F4                            CSI_MakeMiniSonic:
008853F4                            		; Routine 4
008853F4 2248                       		movea.l	a0,a1
008853F6 45F9 0088 53D6             		lea	(CSI_MiniSonicPos).l,a2
008853FC 7200                       		moveq	#0,d1
008853FE 1238 FE18                  		move.b	(v_continues).w,d1
00885402 5501                       		subq.b	#2,d1
00885404 6400                       		bcc.s	CSI_MoreThan1
00885406 4EF9 0000 0000             		jmp	DeleteObject	; cancel if you have 0-1 continues
0088540C                            
0088540C                            	CSI_MoreThan1:
0088540C 7601                       		moveq	#1,d3
0088540E 0C01 000E                  		cmpi.b	#14,d1		; do you have fewer than 16 continues
00885412 6500                       		bcs.s	CSI_FewerThan16	; if yes, branch
00885414                            
00885414 7600                       		moveq	#0,d3
00885416 720E                       		moveq	#14,d1		; cap at 15 mini-Sonics
00885418                            
00885418                            	CSI_FewerThan16:
00885418 1401                       		move.b	d1,d2
0088541A 0202 0001                  		andi.b	#1,d2
0088541E                            
0088541E                            CSI_MiniSonicLoop:
0088541E 137C 0000 0000             		move.b	#id_ContScrItem,0(a1) ; load mini-Sonic object
00885424 335A 0008                  		move.w	(a2)+,obX(a1)	; use above data for x-axis position
00885428 4A02                       		tst.b	d2		; do you have an even number of continues?
0088542A 6700                       		beq.s	CSI_Even	; if yes, branch
0088542C 0469 000A 0008             		subi.w	#$A,obX(a1)	; shift mini-Sonics slightly to the right
00885432                            
00885432                            	CSI_Even:
00885432 337C 00D0 000A             		move.w	#$D0,obScreenY(a1)
00885438 137C 0006 001A             		move.b	#6,obFrame(a1)
0088543E 137C 0006 0024             		move.b	#6,obRoutine(a1)
00885444 237C 0000 0000 0004        		move.l	#Map_ContScr,obMap(a1)
0088544C 337C 8551 0002             		move.w	#$8551,obGfx(a1)
00885452 137C 0000 0001             		move.b	#0,obRender(a1)
00885458 43E9 0040                  		lea	$40(a1),a1
0088545C 51C9 FFC0                  		dbf	d1,CSI_MiniSonicLoop ; repeat for number of continues
00885460                            
00885460 43E9 FFC0                  		lea	-$40(a1),a1
00885464 1343 0028                  		move.b	d3,obSubtype(a1)
00885468                            
00885468                            CSI_ChkDel:	; Routine 6
00885468 4A28 0028                  		tst.b	obSubtype(a0)	; do you have 16 or more continues?
0088546C 6700                       		beq.s	CSI_Animate	; if yes, branch
0088546E 0C38 0006 D024             		cmpi.b	#6,(v_objspace+obRoutine).w ; is Sonic running?
00885474 6500                       		bcs.s	CSI_Animate	; if not, branch
00885476 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088547A 0200 0001                  		andi.b	#1,d0
0088547E 6600                       		bne.s	CSI_Animate
00885480 4A78 D010                  		tst.w	(v_objspace+obVelX).w ; is Sonic running?
00885484 6600                       		bne.s	CSI_Delete	; if yes, goto delete
00885486 4E75                       		rts	
00885488                            
00885488                            CSI_Animate:
00885488 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088548C 0200 000F                  		andi.b	#$F,d0
00885490 6600                       		bne.s	CSI_Display2
00885492 0868 0000 001A             		bchg	#0,obFrame(a0)
00885498                            
00885498                            	CSI_Display2:
00885498 4EF9 0000 0000             		jmp	DisplaySprite
0088549E                            ; ===========================================================================
0088549E                            
0088549E                            CSI_Delete:
0088549E 4EF9 0000 0000             		jmp	DeleteObject
0088549E 4EF9 0000 0000             		jmp	DeleteObject
008854A4                            		include	"_incObj\81 Continue Screen Sonic.asm"
008854A4                            ; ---------------------------------------------------------------------------
008854A4                            ; Object 81 - Sonic on the continue screen
008854A4                            ; ---------------------------------------------------------------------------
008854A4                            
008854A4                            ContSonic:				; XREF: Obj_Index
008854A4 7000                       		moveq	#0,d0
008854A6 1028 0024                  		move.b	obRoutine(a0),d0
008854AA 323B 0000                  		move.w	CSon_Index(pc,d0.w),d1
008854AE 4EBB 1000                  		jsr	CSon_Index(pc,d1.w)
008854B2 4EF9 0000 0000             		jmp	DisplaySprite
008854B8                            ; ===========================================================================
008854B8 0000                       CSon_Index:	dc.w CSon_Main-CSon_Index
008854BA 0000                       		dc.w CSon_ChkLand-CSon_Index
008854BC 0000                       		dc.w CSon_Animate-CSon_Index
008854BE 0000                       		dc.w CSon_Run-CSon_Index
008854C0                            ; ===========================================================================
008854C0                            
008854C0                            CSon_Main:	; Routine 0
008854C0 5428 0024                  		addq.b	#2,obRoutine(a0)
008854C4 317C 00A0 0008             		move.w	#$A0,obX(a0)
008854CA 317C 00C0 000C             		move.w	#$C0,obY(a0)
008854D0 217C 0000 0000 0004        		move.l	#Map_Sonic,obMap(a0)
008854D8 317C 0780 0002             		move.w	#$780,obGfx(a0)
008854DE 117C 0004 0001             		move.b	#4,obRender(a0)
008854E4 117C 0002 0018             		move.b	#2,obPriority(a0)
008854EA 117C 0000 001C             		move.b	#id_Float3,obAnim(a0) ; use "floating" animation
008854F0 317C 0400 0012             		move.w	#$400,obVelY(a0) ; make Sonic fall from above
008854F6                            
008854F6                            CSon_ChkLand:	; Routine 2
008854F6 0C68 01A0 000C             		cmpi.w	#$1A0,obY(a0)	; has Sonic landed yet?
008854FC 6600                       		bne.s	CSon_ShowFall	; if not, branch
008854FE                            
008854FE 5428 0024                  		addq.b	#2,obRoutine(a0)
00885502 4268 0012                  		clr.w	obVelY(a0)	; stop Sonic falling
00885506 217C 0000 0000 0004        		move.l	#Map_ContScr,obMap(a0)
0088550E 317C 8500 0002             		move.w	#$8500,obGfx(a0)
00885514 117C 0000 001C             		move.b	#0,obAnim(a0)
0088551A 6000                       		bra.s	CSon_Animate
0088551C                            
0088551C                            CSon_ShowFall:
0088551C 4EB9 0000 0000             		jsr	ObjectMove
00885522 4EB9 0000 0000             		jsr	Sonic_Animate
00885528 4EF9 0000 0000             		jmp	Sonic_LoadGfx
0088552E                            ; ===========================================================================
0088552E                            
0088552E                            CSon_Animate:	; Routine 4
0088552E 4A38 F605                  		tst.b	(v_jpadpress1).w ; is Start button pressed?
00885532 6B00                       		bmi.s	CSon_GetUp	; if yes, branch
00885534 43F9 0000 0000             		lea	(AniScript_CSon).l,a1
0088553A 4EF9 0000 0000             		jmp	AnimateSprite
00885540                            
00885540                            CSon_GetUp:
00885540 5428 0024                  		addq.b	#2,obRoutine(a0)
00885544 217C 0000 0000 0004        		move.l	#Map_Sonic,obMap(a0)
0088554C 317C 0780 0002             		move.w	#$780,obGfx(a0)
00885552 117C 0000 001C             		move.b	#id_Float4,obAnim(a0) ; use "getting up" animation
00885558 4268 0014                  		clr.w	obInertia(a0)
0088555C 5168 000C                  		subq.w	#8,obY(a0)
00885560 103C 00E1                  		move.b	#bgm_Fade,d0
00885564 6100 C316                  		bsr.w	PlaySound_Special ; fade out music
00885568                            
00885568                            CSon_Run:	; Routine 6
00885568 0C68 0800 0014             		cmpi.w	#$800,obInertia(a0) ; check Sonic's inertia
0088556E 6600                       		bne.s	CSon_AddInertia	; if too low, branch
00885570 317C 1000 0010             		move.w	#$1000,obVelX(a0) ; move Sonic to the right
00885576 6000                       		bra.s	CSon_ShowRun
00885578                            
00885578                            CSon_AddInertia:
00885578 0668 0020 0014             		addi.w	#$20,obInertia(a0) ; increase inertia
0088557E                            
0088557E                            CSon_ShowRun:
0088557E 4EB9 0000 0000             		jsr	ObjectMove
00885584 4EB9 0000 0000             		jsr	Sonic_Animate
0088558A 4EF9 0000 0000             		jmp	Sonic_LoadGfx
0088558A 4EF9 0000 0000             		jmp	Sonic_LoadGfx
00885590                            		include	"_anim\Continue Screen Sonic.asm"
00885590                            ; ---------------------------------------------------------------------------
00885590                            ; Animation script - Sonic on the continue screen
00885590                            ; ---------------------------------------------------------------------------
00885590 0000                       AniScript_CSon:	dc.w A_CSon_1-AniScript_CSon
00885592 0401 0101 0102 0202 0303+  A_CSon_1:	dc.b 4,	1, 1, 1, 1, 2, 2, 2, 3,	3, afEnd
0088559E 00                         		even
0088559E 00                         		even
0088559E                            		include	"_maps\Continue Screen.asm"
0088559E                            ; ---------------------------------------------------------------------------
0088559E                            ; Sprite mappings - Continue screen
0088559E                            ; ---------------------------------------------------------------------------
0088559E 0000 0000                  Map_ContScr:	dc.w M_Cont_text-Map_ContScr, M_Cont_Sonic1-Map_ContScr
008855A2 0000 0000                  		dc.w M_Cont_Sonic2-Map_ContScr, M_Cont_Sonic3-Map_ContScr
008855A6 0000 0000                  		dc.w M_Cont_oval-Map_ContScr, M_Cont_Mini1-Map_ContScr
008855AA 0000 0000                  		dc.w M_Cont_Mini1-Map_ContScr, M_Cont_Mini2-Map_ContScr
008855AE 0B                         M_Cont_text:	dc.b $B
008855AF F805 0088 C4               		dc.b $F8, 5, 0,	$88, $C4 ; "CONTINUE", stars and countdown
008855B4 F805 00B2 D4               		dc.b $F8, 5, 0,	$B2, $D4
008855B9 F805 00AE E4               		dc.b $F8, 5, 0,	$AE, $E4
008855BE F805 00C2 F4               		dc.b $F8, 5, 0,	$C2, $F4
008855C3 F801 00A0 04               		dc.b $F8, 1, 0,	$A0, 4
008855C8 F805 00AE 0C               		dc.b $F8, 5, 0,	$AE, $C
008855CD F805 00C6 1C               		dc.b $F8, 5, 0,	$C6, $1C
008855D2 F805 0090 2C               		dc.b $F8, 5, 0,	$90, $2C
008855D7 3805 2021 E8               		dc.b $38, 5, $20, $21, $E8
008855DC 3805 2021 08               		dc.b $38, 5, $20, $21, 8
008855E1 3605 01FC F8               		dc.b $36, 5, 1,	$FC, $F8
008855E6 03                         M_Cont_Sonic1:	dc.b 3
008855E7 0405 0015 FC               		dc.b 4,	5, 0, $15, $FC	; Sonic	on floor
008855EC F40A 0006 EC               		dc.b $F4, $A, 0, 6, $EC
008855F1 F406 000F 04               		dc.b $F4, 6, 0,	$F, 4
008855F6 03                         M_Cont_Sonic2:	dc.b 3
008855F7 0405 0019 FC               		dc.b 4,	5, 0, $19, $FC	; Sonic	on floor #2
008855FC F40A 0006 EC               		dc.b $F4, $A, 0, 6, $EC
00885601 F406 000F 04               		dc.b $F4, 6, 0,	$F, 4
00885606 03                         M_Cont_Sonic3:	dc.b 3
00885607 0405 001D FC               		dc.b 4,	5, 0, $1D, $FC	; Sonic	on floor #3
0088560C F40A 0006 EC               		dc.b $F4, $A, 0, 6, $EC
00885611 F406 000F 04               		dc.b $F4, 6, 0,	$F, 4
00885616 02                         M_Cont_oval:	dc.b 2
00885617 6009 2000 E8               		dc.b $60, 9, $20, 0, $E8 ; circle on the floor
0088561C 6009 2800 00               		dc.b $60, 9, $28, 0, 0
00885621 01                         M_Cont_Mini1:	dc.b 1
00885622 0006 0012 00               		dc.b 0,	6, 0, $12, 0	; mini Sonic
00885627 01                         M_Cont_Mini2:	dc.b 1
00885628 0006 0018 00               		dc.b 0,	6, 0, $18, 0	; mini Sonic #2
0088562E 00                         		even
0088562E 00                         		even
0088562E                            
0088562E                            ; ===========================================================================
0088562E                            ; ---------------------------------------------------------------------------
0088562E                            ; Ending sequence in Green Hill	Zone
0088562E                            ; ---------------------------------------------------------------------------
0088562E                            
0088562E                            GM_Ending:				; XREF: GameModeArray
0088562E 103C 00E1                  		move.b	#bgm_Stop,d0
00885632 6100 C248                  		bsr.w	PlaySound_Special ; stop music
00885636 6100 CE5C                  		bsr.w	PaletteFadeOut
0088563A                            
0088563A 43F8 D000                  		lea	(v_objspace).w,a1
0088563E 7000                       		moveq	#0,d0
00885640 323C 07FF                  		move.w	#$7FF,d1
00885644                            	End_ClrObjRam:
00885644 22C0                       		move.l	d0,(a1)+
00885646 51C9 FFFC                  		dbf	d1,End_ClrObjRam ; clear object	RAM
0088564A                            
0088564A 43F8 F628                  		lea	($FFFFF628).w,a1
0088564E 7000                       		moveq	#0,d0
00885650 323C 0015                  		move.w	#$15,d1
00885654                            	End_ClrRam1:
00885654 22C0                       		move.l	d0,(a1)+
00885656 51C9 FFFC                  		dbf	d1,End_ClrRam1	; clear	variables
0088565A                            
0088565A 43F8 F700                  		lea	(v_screenposx).w,a1
0088565E 7000                       		moveq	#0,d0
00885660 323C 003F                  		move.w	#$3F,d1
00885664                            	End_ClrRam2:
00885664 22C0                       		move.l	d0,(a1)+
00885666 51C9 FFFC                  		dbf	d1,End_ClrRam2	; clear	variables
0088566A                            
0088566A 43F8 FE60                  		lea	(v_oscillate+2).w,a1
0088566E 7000                       		moveq	#0,d0
00885670 323C 0047                  		move.w	#$47,d1
00885674                            	End_ClrRam3:
00885674 22C0                       		move.l	d0,(a1)+
00885676 51C9 FFFC                  		dbf	d1,End_ClrRam3	; clear	variables
0088567A                            
0088567A 46FC 2700                  		disable_ints
0088567E 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
00885682 0200 00BF                  		andi.b	#$BF,d0
00885686 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
0088568C 6100 C0CE                  		bsr.w	ClearScreen
00885690 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00885696 3CBC 8B03                  		move.w	#$8B03,(a6)	; line scroll mode
0088569A 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
0088569E 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
008856A2 3CBC 857C                  		move.w	#$8500+(vram_sprites>>9),(a6) ; set sprite table address
008856A6 3CBC 9001                  		move.w	#$9001,(a6)		; 64-cell hscroll size
008856AA 3CBC 8004                  		move.w	#$8004,(a6)		; 8-colour mode
008856AE 3CBC 8720                  		move.w	#$8720,(a6)		; set background colour (line 3; colour 0)
008856B2 31FC 8ADF F624             		move.w	#$8A00+223,(v_hbla_hreg).w ; set palette change position (for water)
008856B8 3CB8 F624                  		move.w	(v_hbla_hreg).w,(a6)
008856BC 31FC 001E FE14             		move.w	#30,(v_air).w
008856C2 31FC 0600 FE10             		move.w	#id_EndZ<<8,(v_zone).w ; set level number to 0600 (extra flowers)
008856C8 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w ; do you have all 6 emeralds?
008856CE 6700                       		beq.s	End_LoadData	; if yes, branch
008856D0 31FC 0601 FE10             		move.w	#(id_EndZ<<8)+1,(v_zone).w ; set level number to 0601 (no flowers)
008856D6                            
008856D6                            End_LoadData:
008856D6 7000                       		moveq	#plcid_Ending,d0
008856D8 6100 C634                  		bsr.w	QuickPLC	; load ending sequence patterns
008856DC 4EB9 0000 0000             		jsr	Hud_Base
008856E2 6100 0000                  		bsr.w	LevelSizeLoad
008856E6 6100 0000                  		bsr.w	DeformLayers
008856EA 08F8 0002 F754             		bset	#2,(v_bgscroll1).w
008856F0 6100 0000                  		bsr.w	LevelDataLoad
008856F4 6100 0000                  		bsr.w	LoadTilesFromStart
008856F8 21FC 0000 0000 F796        		move.l	#Col_GHZ,(v_collindex).w ; load collision index
00885700 46FC 2300                  		enable_ints
00885704 41F9 0000 0000             		lea	(Kos_EndFlowers).l,a0 ;	load extra flower patterns
0088570A 43F8 9400                  		lea	($FFFF9400).w,a1 ; RAM address to buffer the patterns
0088570E 6100 C7AE                  		bsr.w	KosDec
00885712 7003                       		moveq	#palid_Sonic,d0
00885714 6100 D028                  		bsr.w	PalLoad1	; load Sonic's palette
00885718 303C 000B                  		move.w	#bgm_Ending,d0
0088571C 6100 C11E                  		bsr.w	PlaySound	; play ending sequence music
00885720 0838 0006 F604             		btst	#bitA,(v_jpadhold1).w ; is button A pressed?
00885726 6700                       		beq.s	End_LoadSonic	; if not, branch
00885728 11FC 0001 FFFA             		move.b	#1,(f_debugmode).w ; enable debug mode
0088572E                            
0088572E                            End_LoadSonic:
0088572E 11FC 0000 D000             		move.b	#id_SonicPlayer,(v_objspace).w ; load Sonic object
00885734 08F8 0000 D022             		bset	#0,(v_player+obStatus).w ; make Sonic face left
0088573A 11FC 0001 F7CC             		move.b	#1,(f_lockctrl).w ; lock controls
00885740 31FC 0400 F602             		move.w	#(btnL<<8),(v_jpadhold2).w ; move Sonic to the left
00885746 31FC F800 D014             		move.w	#$F800,(v_player+obInertia).w ; set Sonic's speed
0088574C 11FC 0000 D040             		move.b	#id_HUD,(v_objspace+$40).w ; load HUD object
00885752 4EB9 0000 0000             		jsr	ObjPosLoad
00885758 4EB9 0000 0000             		jsr	ExecuteObjects
0088575E 4EB9 0000 0000             		jsr	BuildSprites
00885764 7000                       		moveq	#0,d0
00885766 31C0 FE20                  		move.w	d0,(v_rings).w
0088576A 21C0 FE22                  		move.l	d0,(v_time).w
0088576E 11C0 FE1B                  		move.b	d0,(v_lifecount).w
00885772 11C0 FE2C                  		move.b	d0,(v_shield).w
00885776 11C0 FE2D                  		move.b	d0,(v_invinc).w
0088577A 11C0 FE2E                  		move.b	d0,(v_shoes).w
0088577E 11C0 FE2F                  		move.b	d0,($FFFFFE2F).w
00885782 31C0 FE08                  		move.w	d0,(v_debuguse).w
00885786 31C0 FE02                  		move.w	d0,(f_restart).w
0088578A 31C0 FE04                  		move.w	d0,(v_framecount).w
0088578E 6100 EE78                  		bsr.w	OscillateNumInit
00885792 11FC 0001 FE1F             		move.b	#1,(f_scorecount).w
00885798 11FC 0001 FE1D             		move.b	#1,(f_ringcount).w
0088579E 11FC 0000 FE1E             		move.b	#0,(f_timecount).w
008857A4 31FC 0708 F614             		move.w	#1800,(v_demolength).w
008857AA 11FC 0018 F62A             		move.b	#$18,(v_vbla_routine).w
008857B0 6100 D838                  		bsr.w	WaitForVBla
008857B4 3038 F60C                  		move.w	(v_vdp_buffer1).w,d0
008857B8 0000 0040                  		ori.b	#$40,d0
008857BC 33C0 00C0 0004             		move.w	d0,(vdp_control_port).l
008857C2 31FC 003F F626             		move.w	#$3F,(v_pfade_start).w
008857C8 6100 CC24                  		bsr.w	PaletteFadeIn
008857CC                            
008857CC                            ; ---------------------------------------------------------------------------
008857CC                            ; Main ending sequence loop
008857CC                            ; ---------------------------------------------------------------------------
008857CC                            
008857CC                            End_MainLoop:
008857CC 6100 C0FE                  		bsr.w	PauseGame
008857D0 11FC 0018 F62A             		move.b	#$18,(v_vbla_routine).w
008857D6 6100 D812                  		bsr.w	WaitForVBla
008857DA 5278 FE04                  		addq.w	#1,(v_framecount).w
008857DE 6100 0000                  		bsr.w	End_MoveSonic
008857E2 4EB9 0000 0000             		jsr	ExecuteObjects
008857E8 6100 0000                  		bsr.w	DeformLayers
008857EC 4EB9 0000 0000             		jsr	BuildSprites
008857F2 4EB9 0000 0000             		jsr	ObjPosLoad
008857F8 6100 C764                  		bsr.w	PaletteCycle
008857FC 6100 EE60                  		bsr.w	OscillateNumDo
00885800 6100 EEF4                  		bsr.w	SynchroAnimate
00885804 0C38 0000 F600             		cmpi.b	#id_Ending,(v_gamemode).w ; is game mode $18 (ending)?
0088580A 6700                       		beq.s	End_ChkEmerald	; if yes, branch
0088580C                            
0088580C 11FC 0000 F600             		move.b	#id_Credits,(v_gamemode).w ; goto credits
00885812 103C 0011                  		move.b	#bgm_Credits,d0
00885816 6100 C064                  		bsr.w	PlaySound_Special ; play credits music
0088581A 31FC 0000 FFF4             		move.w	#0,(v_creditsnum).w ; set credits index number to 0
00885820 4E75                       		rts	
00885822                            ; ===========================================================================
00885822                            
00885822                            End_ChkEmerald:
00885822 4A78 FE02                  		tst.w	(f_restart).w	; has Sonic released the emeralds?
00885826 6700 FFA4                  		beq.w	End_MainLoop	; if not, branch
0088582A                            
0088582A 4278 FE02                  		clr.w	(f_restart).w
0088582E 31FC 003F F626             		move.w	#$3F,(v_pfade_start).w
00885834 4278 F794                  		clr.w	(v_palchgspeed).w
00885838                            
00885838                            	End_AllEmlds:
00885838 6100 C092                  		bsr.w	PauseGame
0088583C 11FC 0018 F62A             		move.b	#$18,(v_vbla_routine).w
00885842 6100 D7A6                  		bsr.w	WaitForVBla
00885846 5278 FE04                  		addq.w	#1,(v_framecount).w
0088584A 6100 0000                  		bsr.w	End_MoveSonic
0088584E 4EB9 0000 0000             		jsr	ExecuteObjects
00885854 6100 0000                  		bsr.w	DeformLayers
00885858 4EB9 0000 0000             		jsr	BuildSprites
0088585E 4EB9 0000 0000             		jsr	ObjPosLoad
00885864 6100 EDF8                  		bsr.w	OscillateNumDo
00885868 6100 EE8C                  		bsr.w	SynchroAnimate
0088586C 5378 F794                  		subq.w	#1,(v_palchgspeed).w
00885870 6A00                       		bpl.s	End_SlowFade
00885872 31FC 0002 F794             		move.w	#2,(v_palchgspeed).w
00885878 6100 CD64                  		bsr.w	WhiteOut_ToWhite
0088587C                            
0088587C                            	End_SlowFade:
0088587C 4A78 FE02                  		tst.w	(f_restart).w
00885880 6700 FFB6                  		beq.w	End_AllEmlds
00885884 4278 FE02                  		clr.w	(f_restart).w
00885888 31FC 2E2F A480             		move.w	#$2E2F,(v_lvllayout+$80).w ; modify level layout
0088588E 4BF9 00C0 0004             		lea	(vdp_control_port).l,a5
00885894 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
0088589A 47F8 F700                  		lea	(v_screenposx).w,a3
0088589E 49F8 A400                  		lea	(v_lvllayout).w,a4
008858A2 343C 4000                  		move.w	#$4000,d2
008858A6 6100 0000                  		bsr.w	DrawChunks
008858AA 7013                       		moveq	#palid_Ending,d0
008858AC 6100 CE90                  		bsr.w	PalLoad1	; load ending palette
008858B0 6100 CC60                  		bsr.w	PaletteWhiteIn
008858B4 6000 FF16                  		bra.w	End_MainLoop
008858B8                            
008858B8                            ; ---------------------------------------------------------------------------
008858B8                            ; Subroutine controlling Sonic on the ending sequence
008858B8                            ; ---------------------------------------------------------------------------
008858B8                            
008858B8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008858B8                            
008858B8                            
008858B8                            End_MoveSonic:				; XREF: End_MainLoop
008858B8 1038 F7D7                  		move.b	(v_sonicend).w,d0
008858BC 6600                       		bne.s	End_MoveSon2
008858BE 0C78 0090 D008             		cmpi.w	#$90,(v_player+obX).w ; has Sonic passed $90 on x-axis?
008858C4 6400                       		bcc.s	End_MoveSonExit	; if not, branch
008858C6                            
008858C6 5438 F7D7                  		addq.b	#2,(v_sonicend).w
008858CA 11FC 0001 F7CC             		move.b	#1,(f_lockctrl).w ; lock player's controls
008858D0 31FC 0800 F602             		move.w	#(btnR<<8),(v_jpadhold2).w ; move Sonic to the right
008858D6 4E75                       		rts	
008858D8                            ; ===========================================================================
008858D8                            
008858D8                            End_MoveSon2:
008858D8 5500                       		subq.b	#2,d0
008858DA 6600                       		bne.s	End_MoveSon3
008858DC 0C78 00A0 D008             		cmpi.w	#$A0,(v_player+obX).w ; has Sonic passed $A0 on x-axis?
008858E2 6500                       		bcs.s	End_MoveSonExit	; if not, branch
008858E4                            
008858E4 5438 F7D7                  		addq.b	#2,(v_sonicend).w
008858E8 7000                       		moveq	#0,d0
008858EA 11C0 F7CC                  		move.b	d0,(f_lockctrl).w
008858EE 31C0 F602                  		move.w	d0,(v_jpadhold2).w ; stop Sonic moving
008858F2 31C0 D014                  		move.w	d0,(v_player+obInertia).w
008858F6 11FC 0081 F7C8             		move.b	#$81,(f_lockmulti).w ; lock controls & position
008858FC 11FC 0003 D01A             		move.b	#3,(v_player+obFrame).w
00885902 31FC 0000 D01C             		move.w	#(id_Wait<<8)+id_Wait,(v_player+obAnim).w ; use "standing" animation
00885908 11FC 0003 D01E             		move.b	#3,(v_player+obTimeFrame).w
0088590E 4E75                       		rts	
00885910                            ; ===========================================================================
00885910                            
00885910                            End_MoveSon3:
00885910 5500                       		subq.b	#2,d0
00885912 6600                       		bne.s	End_MoveSonExit
00885914 5438 F7D7                  		addq.b	#2,(v_sonicend).w
00885918 31FC 00A0 D008             		move.w	#$A0,(v_player+obX).w
0088591E 11FC 0000 D000             		move.b	#id_EndSonic,(v_objspace).w ; load Sonic ending sequence object
00885924 4278 D024                  		clr.w	(v_player+obRoutine).w
00885928                            
00885928                            End_MoveSonExit:
00885928 4E75                       		rts	
0088592A                            ; End of function End_MoveSonic
0088592A                            
0088592A                            ; ===========================================================================
0088592A                            
0088592A                            		include	"_incObj\87 Ending Sequence Sonic.asm"
0088592A                            ; ---------------------------------------------------------------------------
0088592A                            ; Object 87 - Sonic on ending sequence
0088592A                            ; ---------------------------------------------------------------------------
0088592A                            
0088592A                            EndSonic:				; XREF: Obj_Index
0088592A 7000                       		moveq	#0,d0
0088592C 1028 0025                  		move.b	ob2ndRout(a0),d0
00885930 323B 0000                  		move.w	ESon_Index(pc,d0.w),d1
00885934 4EBB 1000                  		jsr	ESon_Index(pc,d1.w)
00885938 4EF9 0000 0000             		jmp	DisplaySprite
0088593E                            ; ===========================================================================
0088593E 0000 0000                  ESon_Index:	dc.w ESon_Main-ESon_Index, ESon_MakeEmeralds-ESon_Index
00885942 0000 0000                  		dc.w Obj87_Animate-ESon_Index,	Obj87_LookUp-ESon_Index
00885946 0000 0000                  		dc.w Obj87_ClrObjRam-ESon_Index, Obj87_Animate-ESon_Index
0088594A 0000 0000                  		dc.w Obj87_MakeLogo-ESon_Index, Obj87_Animate-ESon_Index
0088594E 0000 0000                  		dc.w Obj87_Leap-ESon_Index, Obj87_Animate-ESon_Index
00885952                            
00885952 =00000030                  eson_time:	= $30	; time to wait between events
00885952                            ; ===========================================================================
00885952                            
00885952                            ESon_Main:	; Routine 0
00885952 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w ; do you have all 6 emeralds?
00885958 6700                       		beq.s	ESon_Main2	; if yes, branch
0088595A 0628 0010 0025             		addi.b	#$10,ob2ndRout(a0) ; else, skip emerald sequence
00885960 317C 00D8 0030             		move.w	#216,eson_time(a0)
00885966 4E75                       		rts	
00885968                            ; ===========================================================================
00885968                            
00885968                            ESon_Main2:
00885968 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088596C 217C 0000 0000 0004        		move.l	#Map_ESon,obMap(a0)
00885974 317C 03E1 0002             		move.w	#$3E1,obGfx(a0)
0088597A 117C 0004 0001             		move.b	#4,obRender(a0)
00885980 4228 0022                  		clr.b	obStatus(a0)
00885984 117C 0002 0018             		move.b	#2,obPriority(a0)
0088598A 117C 0000 001A             		move.b	#0,obFrame(a0)
00885990 317C 0050 0030             		move.w	#80,eson_time(a0) ; set duration for Sonic to pause
00885996                            
00885996                            ESon_MakeEmeralds:
00885996                            		; Routine 2
00885996 5368 0030                  		subq.w	#1,eson_time(a0) ; subtract 1 from duration
0088599A 6600                       		bne.s	ESon_Wait
0088599C 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008859A0 317C 0001 001C             		move.w	#1,obAnim(a0)
008859A6 11FC 0088 D400             		move.b	#$88,(v_objspace+$400).w ; load chaos emeralds objects
008859AC                            
008859AC                            	ESon_Wait:
008859AC 4E75                       		rts	
008859AE                            ; ===========================================================================
008859AE                            
008859AE                            Obj87_LookUp:	; Routine 6
008859AE 0C79 2000 00FF D43C        		cmpi.w	#$2000,((v_objspace&$FFFFFF)+$400+$3C).l
008859B6 6600                       		bne.s	locret_5480
008859B8 31FC 0001 FE02             		move.w	#1,(f_restart).w ; set level to	restart	(causes	flash)
008859BE 317C 005A 0030             		move.w	#90,eson_time(a0)
008859C4 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008859C8                            
008859C8                            locret_5480:
008859C8 4E75                       		rts	
008859CA                            ; ===========================================================================
008859CA                            
008859CA                            Obj87_ClrObjRam:
008859CA                            		; Routine 8
008859CA 5368 0030                  		subq.w	#1,eson_time(a0)
008859CE 6600                       		bne.s	ESon_Wait2
008859D0 43F8 D400                  		lea	(v_objspace+$400).w,a1
008859D4 323C 00FF                  		move.w	#$FF,d1
008859D8                            
008859D8                            Obj87_ClrLoop:
008859D8 4299                       		clr.l	(a1)+
008859DA 51C9 FFFC                  		dbf	d1,Obj87_ClrLoop ; clear the object RAM
008859DE 31FC 0001 FE02             		move.w	#1,(f_restart).w
008859E4 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008859E8 117C 0001 001C             		move.b	#1,obAnim(a0)
008859EE 317C 003C 0030             		move.w	#60,eson_time(a0)
008859F4                            
008859F4                            ESon_Wait2:
008859F4 4E75                       		rts	
008859F6                            ; ===========================================================================
008859F6                            
008859F6                            Obj87_MakeLogo:	; Routine $C
008859F6 5368 0030                  		subq.w	#1,eson_time(a0)
008859FA 6600                       		bne.s	ESon_Wait3
008859FC 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00885A00 317C 00B4 0030             		move.w	#180,eson_time(a0)
00885A06 117C 0002 001C             		move.b	#2,obAnim(a0)
00885A0C 11FC 0000 D400             		move.b	#id_EndSTH,(v_objspace+$400).w ; load "SONIC THE HEDGEHOG" object
00885A12                            
00885A12                            ESon_Wait3:
00885A12 4E75                       		rts	
00885A14                            ; ===========================================================================
00885A14                            
00885A14                            Obj87_Animate:	; Rountine 4, $A, $E, $12
00885A14 43F9 0000 0000             		lea	(AniScript_ESon).l,a1
00885A1A 4EF9 0000 0000             		jmp	AnimateSprite
00885A20                            ; ===========================================================================
00885A20                            
00885A20                            Obj87_Leap:	; Routine $10
00885A20 5368 0030                  		subq.w	#1,eson_time(a0)
00885A24 6600                       		bne.s	ESon_Wait4
00885A26 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00885A2A 217C 0000 0000 0004        		move.l	#Map_ESon,obMap(a0)
00885A32 317C 03E1 0002             		move.w	#$3E1,obGfx(a0)
00885A38 117C 0004 0001             		move.b	#4,obRender(a0)
00885A3E 4228 0022                  		clr.b	obStatus(a0)
00885A42 117C 0002 0018             		move.b	#2,obPriority(a0)
00885A48 117C 0005 001A             		move.b	#5,obFrame(a0)
00885A4E 117C 0002 001C             		move.b	#2,obAnim(a0)	; use "leaping"	animation
00885A54 11FC 0000 D400             		move.b	#id_EndSTH,(v_objspace+$400).w ; load "SONIC THE HEDGEHOG" object
00885A5A 60B8                       		bra.s	Obj87_Animate
00885A5C                            ; ===========================================================================
00885A5C                            
00885A5C                            ESon_Wait4:				; XREF: Obj87_Leap
00885A5C 4E75                       		rts	
00885A5C 4E75                       		rts	
00885A5E                            		include "_anim\Ending Sequence Sonic.asm"
00885A5E                            ; ---------------------------------------------------------------------------
00885A5E                            ; Animation script - Sonic on the ending sequence
00885A5E                            ; ---------------------------------------------------------------------------
00885A5E 0000                       AniScript_ESon:	dc.w byte_551C-AniScript_ESon
00885A60 0000                       		dc.w byte_552A-AniScript_ESon
00885A62 0000                       		dc.w byte_5534-AniScript_ESon
00885A64 0301 0001 0001 0001 0001+  byte_551C:	dc.b 3,	1, 0, 1, 0, 1, 0, 1, 0,	1, 0, 1, 2, $FA
00885A72 0503 0403 0403 0403 FA00   byte_552A:	dc.b 5,	3, 4, 3, 4, 3, 4, 3, $FA, 0
00885A7C 0305 0505 0607 FE01        byte_5534:	dc.b 3,	5, 5, 5, 6, 7, $FE, 1
00885A84                            		even
00885A84                            		even
00885A84                            		include	"_incObj\88 Ending Sequence Emeralds.asm"
00885A84                            ; ---------------------------------------------------------------------------
00885A84                            ; Object 88 - chaos emeralds on	the ending sequence
00885A84                            ; ---------------------------------------------------------------------------
00885A84                            
00885A84                            EndChaos:				; XREF: Obj_Index
00885A84 7000                       		moveq	#0,d0
00885A86 1028 0024                  		move.b	obRoutine(a0),d0
00885A8A 323B 0000                  		move.w	ECha_Index(pc,d0.w),d1
00885A8E 4EBB 1000                  		jsr	ECha_Index(pc,d1.w)
00885A92 4EF9 0000 0000             		jmp	DisplaySprite
00885A98                            ; ===========================================================================
00885A98 0000                       ECha_Index:	dc.w ECha_Main-ECha_Index
00885A9A 0000                       		dc.w ECha_Move-ECha_Index
00885A9C                            
00885A9C =00000038                  echa_origX:	= $38	; x-axis centre of emerald circle (2 bytes)
00885A9C =0000003A                  echa_origY:	= $3A	; y-axis centre of emerald circle (2 bytes)
00885A9C =0000003C                  echa_radius:	= $3C	; radius (2 bytes)
00885A9C =0000003E                  echa_angle:	= $3E	; angle for rotation (2 bytes)
00885A9C                            ; ===========================================================================
00885A9C                            
00885A9C                            ECha_Main:	; Routine 0
00885A9C 0C38 0002 D01A             		cmpi.b	#2,(v_player+obFrame).w
00885AA2 6700                       		beq.s	ECha_CreateEms
00885AA4 588F                       		addq.l	#4,sp
00885AA6 4E75                       		rts	
00885AA8                            ; ===========================================================================
00885AA8                            
00885AA8                            ECha_CreateEms:
00885AA8 3178 D008 0008             		move.w	(v_player+obX).w,obX(a0) ; match X position with Sonic
00885AAE 3178 D00C 000C             		move.w	(v_player+obY).w,obY(a0) ; match Y position with Sonic
00885AB4 2248                       		movea.l	a0,a1
00885AB6 7600                       		moveq	#0,d3
00885AB8 7401                       		moveq	#1,d2
00885ABA 7205                       		moveq	#5,d1
00885ABC                            
00885ABC                            	ECha_LoadLoop:
00885ABC 12BC 0000                  		move.b	#id_EndChaos,(a1) ; load chaos emerald object
00885AC0 5429 0024                  		addq.b	#2,obRoutine(a1)
00885AC4 237C 0000 0000 0004        		move.l	#Map_ECha,obMap(a1)
00885ACC 337C 03C5 0002             		move.w	#$3C5,obGfx(a1)
00885AD2 137C 0004 0001             		move.b	#4,obRender(a1)
00885AD8 137C 0001 0018             		move.b	#1,obPriority(a1)
00885ADE 3368 0008 0038             		move.w	obX(a0),echa_origX(a1)
00885AE4 3368 000C 003A             		move.w	obY(a0),echa_origY(a1)
00885AEA 1342 001C                  		move.b	d2,obAnim(a1)
00885AEE 1342 001A                  		move.b	d2,obFrame(a1)
00885AF2 5202                       		addq.b	#1,d2
00885AF4 1343 0026                  		move.b	d3,obAngle(a1)
00885AF8 0603 002A                  		addi.b	#$100/6,d3	; angle between each emerald
00885AFC 43E9 0040                  		lea	$40(a1),a1
00885B00 51C9 FFBA                  		dbf	d1,ECha_LoadLoop ; repeat 5 more times
00885B04                            
00885B04                            ECha_Move:	; Routine 2
00885B04 3028 003E                  		move.w	echa_angle(a0),d0
00885B08 D168 0026                  		add.w	d0,obAngle(a0)
00885B0C 1028 0026                  		move.b	obAngle(a0),d0
00885B10 4EB9 0088 301C             		jsr	(CalcSine).l
00885B16 7800                       		moveq	#0,d4
00885B18 1828 003C                  		move.b	echa_radius(a0),d4
00885B1C C3C4                       		muls.w	d4,d1
00885B1E E081                       		asr.l	#8,d1
00885B20 C1C4                       		muls.w	d4,d0
00885B22 E080                       		asr.l	#8,d0
00885B24 D268 0038                  		add.w	echa_origX(a0),d1
00885B28 D068 003A                  		add.w	echa_origY(a0),d0
00885B2C 3141 0008                  		move.w	d1,obX(a0)
00885B30 3140 000C                  		move.w	d0,obY(a0)
00885B34                            
00885B34                            	ECha_Expand:
00885B34 0C68 2000 003C             		cmpi.w	#$2000,echa_radius(a0)
00885B3A 6700                       		beq.s	ECha_Rotate
00885B3C 0668 0020 003C             		addi.w	#$20,echa_radius(a0) ; expand circle of emeralds
00885B42                            
00885B42                            	ECha_Rotate:
00885B42 0C68 2000 003E             		cmpi.w	#$2000,echa_angle(a0)
00885B48 6700                       		beq.s	ECha_Rise
00885B4A 0668 0020 003E             		addi.w	#$20,echa_angle(a0) ; move emeralds around the centre
00885B50                            
00885B50                            	ECha_Rise:
00885B50 0C68 0140 003A             		cmpi.w	#$140,echa_origY(a0)
00885B56 6700                       		beq.s	ECha_End
00885B58 5368 003A                  		subq.w	#1,echa_origY(a0) ; make circle rise
00885B5C                            
00885B5C                            ECha_End:
00885B5C 4E75                       		rts	
00885B5C 4E75                       		rts	
00885B5E                            		include	"_incObj\89 Ending Sequence STH.asm"
00885B5E                            ; ---------------------------------------------------------------------------
00885B5E                            ; Object 89 - "SONIC THE HEDGEHOG" text	on the ending sequence
00885B5E                            ; ---------------------------------------------------------------------------
00885B5E                            
00885B5E                            EndSTH:					; XREF: Obj_Index
00885B5E 7000                       		moveq	#0,d0
00885B60 1028 0024                  		move.b	$24(a0),d0
00885B64 323B 0000                  		move.w	ESth_Index(pc,d0.w),d1
00885B68                            
00885B68 4EBB 1000                  		jsr	ESth_Index(pc,d1.w)
00885B6C 4EF9 0000 0000             		jmp	DisplaySprite
00885B72                            
00885B72                            ; ===========================================================================
00885B72 0000                       ESth_Index:	dc.w ESth_Main-ESth_Index
00885B74 0000                       		dc.w ESth_Move-ESth_Index
00885B76 0000                       		dc.w ESth_GotoCredits-ESth_Index
00885B78                            
00885B78 =00000030                  esth_time:	= $30		; time until exit
00885B78                            ; ===========================================================================
00885B78                            
00885B78                            ESth_Main:	; Routine 0
00885B78 5428 0024                  		addq.b	#2,obRoutine(a0)
00885B7C 317C FFE0 0008             		move.w	#-$20,obX(a0)	; object starts	outside	the level boundary
00885B82 317C 00D8 000A             		move.w	#$D8,obScreenY(a0)
00885B88 217C 0000 0000 0004        		move.l	#Map_ESTH,obMap(a0)
00885B90 317C 05C5 0002             		move.w	#$5C5,obGfx(a0)
00885B96 117C 0000 0001             		move.b	#0,obRender(a0)
00885B9C 117C 0000 0018             		move.b	#0,obPriority(a0)
00885BA2                            
00885BA2                            ESth_Move:	; Routine 2
00885BA2 0C68 00C0 0008             		cmpi.w	#$C0,obX(a0)	; has object reached $C0?
00885BA8 6700                       		beq.s	ESth_Delay	; if yes, branch
00885BAA 0668 0010 0008             		addi.w	#$10,obX(a0)	; move object to the right
00885BB0 4E75                       		rts
00885BB2                            		
00885BB2                            
00885BB2                            ESth_Delay:
00885BB2 5428 0024                  		addq.b	#2,obRoutine(a0)
00885BB6 317C 012C 0030             		move.w	#300,esth_time(a0) ; set duration for delay (5 seconds)
00885BBC                            
00885BBC                            ESth_GotoCredits:
00885BBC                            		; Routine 4
00885BBC 5368 0030                  		subq.w	#1,esth_time(a0) ; subtract 1 from duration
00885BC0 6A00                       		bpl.s	ESth_Wait
00885BC2 11FC 0000 F600             		move.b	#id_Credits,(v_gamemode).w ; exit to credits
00885BC8                            
00885BC8                            	ESth_Wait:
00885BC8 4E75                       		rts
00885BC8 4E75                       		rts
00885BCA                            		include	"_maps\Ending Sequence Sonic.asm"
00885BCA                            ; ---------------------------------------------------------------------------
00885BCA                            ; Sprite mappings - Sonic on the ending	sequence
00885BCA                            ; ---------------------------------------------------------------------------
00885BCA 0000 0000                  Map_ESon:	dc.w M_ESon_Hold1-Map_ESon, M_ESon_Hold2-Map_ESon
00885BCE 0000 0000                  		dc.w M_ESon_Up-Map_ESon, M_ESon_Conf1-Map_ESon
00885BD2 0000 0000                  		dc.w M_ESon_Conf2-Map_ESon, M_ESon_Leap1-Map_ESon
00885BD6 0000 0000                  		dc.w M_ESon_Leap2-Map_ESon, M_ESon_Leap3-Map_ESon
00885BDA 02                         M_ESon_Hold1:	dc.b 2
00885BDB EC0B 0000 F8               		dc.b $EC, $B, 0, 0, $F8	; holding emeralds
00885BE0 0C0C 000C F0               		dc.b $C, $C, 0,	$C, $F0
00885BE5 03                         M_ESon_Hold2:	dc.b 3
00885BE6 FC0D 0010 F0               		dc.b $FC, $D, 0, $10, $F0 ; holding emeralds (glowing)
00885BEB EC0B 0000 F8               		dc.b $EC, $B, 0, 0, $F8
00885BF0 0C0C 000C F0               		dc.b $C, $C, 0,	$C, $F0
00885BF5 02                         M_ESon_Up:	dc.b 2
00885BF6 EC09 0018 F8               		dc.b $EC, 9, 0,	$18, $F8 ; looking up
00885BFB FC0E 001E F0               		dc.b $FC, $E, 0, $1E, $F0
00885C00 02                         M_ESon_Conf1:	dc.b 2
00885C01 EC09 002A F8               		dc.b $EC, 9, 0,	$2A, $F8 ; confused
00885C06 FC0E 0030 F0               		dc.b $FC, $E, 0, $30, $F0
00885C0B 02                         M_ESon_Conf2:	dc.b 2
00885C0C EC09 082A F0               		dc.b $EC, 9, 8,	$2A, $F0 ; confused #2
00885C11 FC0E 0830 F0               		dc.b $FC, $E, 8, $30, $F0
00885C16 03                         M_ESon_Leap1:	dc.b 3
00885C17 EC06 003C F0               		dc.b $EC, 6, 0,	$3C, $F0 ; leaping
00885C1C EC06 083C 00               		dc.b $EC, 6, 8,	$3C, 0
00885C21 040D 0042 F0               		dc.b 4,	$D, 0, $42, $F0
00885C26 07                         M_ESon_Leap2:	dc.b 7
00885C27 B20C 004A F8               		dc.b $B2, $C, 0, $4A, $F8 ; leaping #2
00885C2C BA0F 004E F0               		dc.b $BA, $F, 0, $4E, $F0
00885C31 BA05 005E 10               		dc.b $BA, 5, 0,	$5E, $10
00885C36 CA02 0062 10               		dc.b $CA, 2, 0,	$62, $10
00885C3B DA0C 0065 F0               		dc.b $DA, $C, 0, $65, $F0
00885C40 E208 0069 F8               		dc.b $E2, 8, 0,	$69, $F8
00885C45 EA05 006C F8               		dc.b $EA, 5, 0,	$6C, $F8
00885C4A 18                         M_ESon_Leap3:	dc.b $18
00885C4B 800F 0070 F8               		dc.b $80, $F, 0, $70, $F8 ; leaping #3
00885C50 900B 0080 E0               		dc.b $90, $B, 0, $80, $E0
00885C55 900B 008C 18               		dc.b $90, $B, 0, $8C, $18
00885C5A 980B 0098 30               		dc.b $98, $B, 0, $98, $30
00885C5F A00F 00A4 58               		dc.b $A0, $F, 0, $A4, $58
00885C64 8800 00B4 F0               		dc.b $88, 0, 0,	$B4, $F0
00885C69 8005 00B5 18               		dc.b $80, 5, 0,	$B5, $18
00885C6E A00F 00B9 F8               		dc.b $A0, $F, 0, $B9, $F8
00885C73 B00B 00C9 E0               		dc.b $B0, $B, 0, $C9, $E0
00885C78 B80F 00D5 38               		dc.b $B8, $F, 0, $D5, $38
00885C7D A805 00E5 48               		dc.b $A8, 5, 0,	$E5, $48
00885C82 C002 00E9 58               		dc.b $C0, 2, 0,	$E9, $58
00885C87 C00F 00EC F8               		dc.b $C0, $F, 0, $EC, $F8
00885C8C B80F 00FC 18               		dc.b $B8, $F, 0, $FC, $18
00885C91 B008 010C 18               		dc.b $B0, 8, 1,	$C, $18
00885C96 D80D 010F 30               		dc.b $D8, $D, 1, $F, $30
00885C9B D808 0117 18               		dc.b $D8, 8, 1,	$17, $18
00885CA0 D80F 011A D8               		dc.b $D8, $F, 1, $1A, $D8
00885CA5 E00D 012A F8               		dc.b $E0, $D, 1, $2A, $F8
00885CAA E000 0132 28               		dc.b $E0, 0, 1,	$32, $28
00885CAF D004 0133 E0               		dc.b $D0, 4, 1,	$33, $E0
00885CB4 E805 0135 C8               		dc.b $E8, 5, 1,	$35, $C8
00885CB9 F80C 0139 C8               		dc.b $F8, $C, 1, $39, $C8
00885CBE F006 013D F8               		dc.b $F0, 6, 1,	$3D, $F8
00885CC4 00                         		even
00885CC4 00                         		even
00885CC4                            		include	"_maps\Ending Sequence Emeralds.asm"
00885CC4                            ; ---------------------------------------------------------------------------
00885CC4                            ; Sprite mappings - chaos emeralds on the ending sequence
00885CC4                            ; ---------------------------------------------------------------------------
00885CC4 0000 0000                  Map_ECha:	dc.w M_ECha_1-Map_ECha, M_ECha_2-Map_ECha
00885CC8 0000 0000                  		dc.w M_ECha_3-Map_ECha, M_ECha_4-Map_ECha
00885CCC 0000 0000                  		dc.w M_ECha_5-Map_ECha, M_ECha_6-Map_ECha
00885CD0 0000                       		dc.w M_ECha_7-Map_ECha
00885CD2 01                         M_ECha_1:	dc.b 1
00885CD3 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
00885CD8 01                         M_ECha_2:	dc.b 1
00885CD9 F805 0004 F8               		dc.b $F8, 5, 0,	4, $F8
00885CDE 01                         M_ECha_3:	dc.b 1
00885CDF F805 4010 F8               		dc.b $F8, 5, $40, $10, $F8
00885CE4 01                         M_ECha_4:	dc.b 1
00885CE5 F805 2018 F8               		dc.b $F8, 5, $20, $18, $F8
00885CEA 01                         M_ECha_5:	dc.b 1
00885CEB F805 4014 F8               		dc.b $F8, 5, $40, $14, $F8
00885CF0 01                         M_ECha_6:	dc.b 1
00885CF1 F805 0008 F8               		dc.b $F8, 5, 0,	8, $F8
00885CF6 01                         M_ECha_7:	dc.b 1
00885CF7 F805 000C F8               		dc.b $F8, 5, 0,	$C, $F8
00885CFC                            		even
00885CFC                            		even
00885CFC                            		include	"_maps\Ending Sequence STH.asm"
00885CFC                            ; ---------------------------------------------------------------------------
00885CFC                            ; Sprite mappings - "SONIC THE HEDGEHOG" text on the ending sequence
00885CFC                            ; ---------------------------------------------------------------------------
00885CFC 0000                       Map_ESth:	dc.w M_ESth_1-Map_ESth
00885CFE 03                         M_ESth_1:	dc.b 3
00885CFF F00F 0000 D0               		dc.b $F0, $F, 0, 0, $D0
00885D04 F00F 0010 F0               		dc.b $F0, $F, 0, $10, $F0
00885D09 F00F 0020 10               		dc.b $F0, $F, 0, $20, $10
00885D0E                            		even
00885D0E                            		even
00885D0E                            
00885D0E                            ; ===========================================================================
00885D0E                            ; ---------------------------------------------------------------------------
00885D0E                            ; Credits ending sequence
00885D0E                            ; ---------------------------------------------------------------------------
00885D0E                            
00885D0E                            GM_Credits:				; XREF: GameModeArray
00885D0E 6100 BEF0                  		bsr.w	ClearPLC
00885D12 6100 C780                  		bsr.w	PaletteFadeOut
00885D16 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00885D1C 3CBC 8004                  		move.w	#$8004,(a6)		; 8-colour mode
00885D20 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
00885D24 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
00885D28 3CBC 9001                  		move.w	#$9001,(a6)		; 64-cell hscroll size
00885D2C 3CBC 9200                  		move.w	#$9200,(a6)		; window vertical position
00885D30 3CBC 8B03                  		move.w	#$8B03,(a6)		; line scroll mode
00885D34 3CBC 8720                  		move.w	#$8720,(a6)		; set background colour (line 3; colour 0)
00885D38 4238 F64E                  		clr.b	(f_wtr_state).w
00885D3C 6100 BA1E                  		bsr.w	ClearScreen
00885D40                            
00885D40 43F8 D000                  		lea	(v_objspace).w,a1
00885D44 7000                       		moveq	#0,d0
00885D46 323C 07FF                  		move.w	#$7FF,d1
00885D4A                            	Cred_ClrObjRam:
00885D4A 22C0                       		move.l	d0,(a1)+
00885D4C 51C9 FFFC                  		dbf	d1,Cred_ClrObjRam ; clear object RAM
00885D50                            
00885D5A 41F9 0000 0000             		lea	(Nem_CreditText).l,a0 ;	load credits alphabet patterns
00885D60 6100 BD00                  		bsr.w	NemDec
00885D64                            
00885D64 43F8 FB80                  		lea	(v_pal_dry_dup).w,a1
00885D68 7000                       		moveq	#0,d0
00885D6A 323C 001F                  		move.w	#$1F,d1
00885D6E                            	Cred_ClrPal:
00885D6E 22C0                       		move.l	d0,(a1)+
00885D70 51C9 FFFC                  		dbf	d1,Cred_ClrPal ; fill palette with black
00885D74                            
00885D74 7003                       		moveq	#palid_Sonic,d0
00885D76 6100 C9C6                  		bsr.w	PalLoad1	; load Sonic's palette
00885D7A 11FC 0000 D080             		move.b	#id_CreditsText,(v_objspace+$80).w ; load credits object
00885D80 4EB9 0000 0000             		jsr	ExecuteObjects
00885D86 4EB9 0000 0000             		jsr	BuildSprites
00885D8C 6100 0000                  		bsr.w	EndingDemoLoad
00885D90 7000                       		moveq	#0,d0
00885D92 1038 FE10                  		move.b	(v_zone).w,d0
00885D96 E948                       		lsl.w	#4,d0
00885D98 45F9 0000 0000             		lea	(LevelHeaders).l,a2
00885D9E 45F2 0000                  		lea	(a2,d0.w),a2
00885DA2 7000                       		moveq	#0,d0
00885DA4 1012                       		move.b	(a2),d0
00885DA6 6700                       		beq.s	Cred_SkipObjGfx
00885DA8 6100 BDF8                  		bsr.w	AddPLC		; load object graphics
00885DAC                            
00885DAC                            	Cred_SkipObjGfx:
00885DAC 7000                       		moveq	#plcid_Main2,d0
00885DAE 6100 BDF2                  		bsr.w	AddPLC		; load standard	level graphics
00885DB2 31FC 0078 F614             		move.w	#120,(v_demolength).w ; display a credit for 2 seconds
00885DB8 6100 C634                  		bsr.w	PaletteFadeIn
00885DBC                            
00885DBC                            Cred_WaitLoop:
00885DBC 11FC 0004 F62A             		move.b	#4,(v_vbla_routine).w
00885DC2 6100 D226                  		bsr.w	WaitForVBla
00885DC6 6100 BE46                  		bsr.w	RunPLC
00885DCA 4A78 F614                  		tst.w	(v_demolength).w ; have 2 seconds elapsed?
00885DCE 66EC                       		bne.s	Cred_WaitLoop	; if not, branch
00885DD0 4AB8 F680                  		tst.l	(v_plc_buffer).w ; have level gfx finished decompressing?
00885DD4 66E6                       		bne.s	Cred_WaitLoop	; if not, branch
00885DD6 0C78 0009 FFF4             		cmpi.w	#9,(v_creditsnum).w ; have the credits finished?
00885DDC 6700 0000                  		beq.w	TryAgainEnd	; if yes, branch
00885DE0 4E75                       		rts	
00885DE2                            
00885DE2                            ; ---------------------------------------------------------------------------
00885DE2                            ; Ending sequence demo loading subroutine
00885DE2                            ; ---------------------------------------------------------------------------
00885DE2                            
00885DE2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00885DE2                            
00885DE2                            
00885DE2                            EndingDemoLoad:				; XREF: GM_Credits
00885DE2 3038 FFF4                  		move.w	(v_creditsnum).w,d0
00885DE6 0240 000F                  		andi.w	#$F,d0
00885DEA D040                       		add.w	d0,d0
00885DEC 303B 0000                  		move.w	EndDemo_Levels(pc,d0.w),d0 ; load level	array
00885DF0 31C0 FE10                  		move.w	d0,(v_zone).w	; set level from level array
00885DF4 5278 FFF4                  		addq.w	#1,(v_creditsnum).w
00885DF8 0C78 0009 FFF4             		cmpi.w	#9,(v_creditsnum).w ; have credits finished?
00885DFE 6400                       		bcc.s	EndDemo_Exit	; if yes, branch
00885E00 31FC 8001 FFF0             		move.w	#$8001,(f_demo).w ; set demo+ending mode
00885E06 11FC 0000 F600             		move.b	#id_Demo,(v_gamemode).w ; set game mode to 8 (demo)
00885E0C 11FC 0003 FE12             		move.b	#3,(v_lives).w	; set lives to 3
00885E12 7000                       		moveq	#0,d0
00885E14 31C0 FE20                  		move.w	d0,(v_rings).w	; clear rings
00885E18 21C0 FE22                  		move.l	d0,(v_time).w	; clear time
00885E1C 21C0 FE26                  		move.l	d0,(v_score).w	; clear score
00885E20 11C0 FE30                  		move.b	d0,(v_lastlamp).w ; clear lamppost counter
00885E24 0C78 0004 FFF4             		cmpi.w	#4,(v_creditsnum).w ; is SLZ demo running?
00885E2A 6600                       		bne.s	EndDemo_Exit	; if not, branch
00885E2C 43F9 0000 0000             		lea	(EndDemo_LampVar).l,a1 ; load lamppost variables
00885E32 45F8 FE30                  		lea	(v_lastlamp).w,a2
00885E36 303C 0008                  		move.w	#8,d0
00885E3A                            
00885E3A                            	EndDemo_LampLoad:
00885E3A 24D9                       		move.l	(a1)+,(a2)+
00885E3C 51C8 FFFC                  		dbf	d0,EndDemo_LampLoad
00885E40                            
00885E40                            EndDemo_Exit:
00885E40 4E75                       		rts	
00885E42                            ; End of function EndingDemoLoad
00885E42                            
00885E42                            ; ===========================================================================
00885E42                            ; ---------------------------------------------------------------------------
00885E42                            ; Levels used in the end sequence demos
00885E42                            ; ---------------------------------------------------------------------------
00885E42                            EndDemo_Levels:	incbin	"misc\Demo Level Order - Ending.bin"
00885E52                            
00885E52                            ; ---------------------------------------------------------------------------
00885E52                            ; Lamppost variables in the end sequence demo (Star Light Zone)
00885E52                            ; ---------------------------------------------------------------------------
00885E52                            EndDemo_LampVar:
00885E52 0101                       		dc.b 1,	1		; number of the last lamppost
00885E54 0A00 062C                  		dc.w $A00, $62C		; x/y-axis position
00885E58 000D                       		dc.w 13			; rings
00885E5A 0000 0000                  		dc.l 0			; time
00885E5E 0000                       		dc.b 0,	0		; dynamic level event routine counter
00885E60 0800                       		dc.w $800		; level bottom boundary
00885E62 0957 05CC                  		dc.w $957, $5CC		; x/y axis screen position
00885E66 04AB 03A6 0000 028C 0000+  		dc.w $4AB, $3A6, 0, $28C, 0, 0 ; scroll info
00885E72 0308                       		dc.w $308		; water height
00885E74 0101                       		dc.b 1,	1		; water routine and state
00885E76                            ; ===========================================================================
00885E76                            ; ---------------------------------------------------------------------------
00885E76                            ; "TRY AGAIN" and "END"	screens
00885E76                            ; ---------------------------------------------------------------------------
00885E76                            
00885E76                            TryAgainEnd:				; XREF: GM_Credits
00885E76 6100 BD88                  		bsr.w	ClearPLC
00885E7A 6100 C618                  		bsr.w	PaletteFadeOut
00885E7E 4DF9 00C0 0004             		lea	(vdp_control_port).l,a6
00885E84 3CBC 8004                  		move.w	#$8004,(a6)	; use 8-colour mode
00885E88 3CBC 8230                  		move.w	#$8200+(vram_fg>>10),(a6) ; set foreground nametable address
00885E8C 3CBC 8407                  		move.w	#$8400+(vram_bg>>13),(a6) ; set background nametable address
00885E90 3CBC 9001                  		move.w	#$9001,(a6)	; 64-cell hscroll size
00885E94 3CBC 9200                  		move.w	#$9200,(a6)	; window vertical position
00885E98 3CBC 8B03                  		move.w	#$8B03,(a6)	; line scroll mode
00885E9C 3CBC 8720                  		move.w	#$8720,(a6)	; set background colour (line 3; colour 0)
00885EA0 4238 F64E                  		clr.b	(f_wtr_state).w
00885EA4 6100 B8B6                  		bsr.w	ClearScreen
00885EA8                            
00885EA8 43F8 D000                  		lea	(v_objspace).w,a1
00885EAC 7000                       		moveq	#0,d0
00885EAE 323C 07FF                  		move.w	#$7FF,d1
00885EB2                            	TryAg_ClrObjRam:
00885EB2 22C0                       		move.l	d0,(a1)+
00885EB4 51C9 FFFC                  		dbf	d1,TryAg_ClrObjRam ; clear object RAM
00885EB8                            
00885EB8 7000                       		moveq	#plcid_TryAgain,d0
00885EBA 6100 BE52                  		bsr.w	QuickPLC	; load "TRY AGAIN" or "END" patterns
00885EBE                            
00885EBE 43F8 FB80                  		lea	(v_pal_dry_dup).w,a1
00885EC2 7000                       		moveq	#0,d0
00885EC4 323C 001F                  		move.w	#$1F,d1
00885EC8                            	TryAg_ClrPal:
00885EC8 22C0                       		move.l	d0,(a1)+
00885ECA 51C9 FFFC                  		dbf	d1,TryAg_ClrPal ; fill palette with black
00885ECE                            
00885ECE 7013                       		moveq	#palid_Ending,d0
00885ED0 6100 C86C                  		bsr.w	PalLoad1	; load ending palette
00885ED4 4278 FBC0                  		clr.w	(v_pal_dry_dup+$40).w
00885ED8 11FC 0000 D080             		move.b	#id_EndEggman,(v_objspace+$80).w ; load Eggman object
00885EDE 4EB9 0000 0000             		jsr	ExecuteObjects
00885EE4 4EB9 0000 0000             		jsr	BuildSprites
00885EEA 31FC 0708 F614             		move.w	#1800,(v_demolength).w ; show screen for 30 seconds
00885EF0 6100 C4FC                  		bsr.w	PaletteFadeIn
00885EF4                            
00885EF4                            ; ---------------------------------------------------------------------------
00885EF4                            ; "TRY AGAIN" and "END"	screen main loop
00885EF4                            ; ---------------------------------------------------------------------------
00885EF4                            TryAg_MainLoop:
00885EF4 6100 B9D6                  		bsr.w	PauseGame
00885EF8 11FC 0004 F62A             		move.b	#4,(v_vbla_routine).w
00885EFE 6100 D0EA                  		bsr.w	WaitForVBla
00885F02 4EB9 0000 0000             		jsr	ExecuteObjects
00885F08 4EB9 0000 0000             		jsr	BuildSprites
00885F0E 0238 0080 F605             		andi.b	#btnStart,(v_jpadpress1).w ; is Start button pressed?
00885F14 6600                       		bne.s	TryAg_Exit	; if yes, branch
00885F16 4A78 F614                  		tst.w	(v_demolength).w ; has 30 seconds elapsed?
00885F1A 6700                       		beq.s	TryAg_Exit	; if yes, branch
00885F1C 0C38 0000 F600             		cmpi.b	#id_Credits,(v_gamemode).w
00885F22 67D0                       		beq.s	TryAg_MainLoop
00885F24                            
00885F24                            TryAg_Exit:
00885F24 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; goto Sega screen
00885F2A 4E75                       		rts	
00885F2C                            
00885F2C                            ; ===========================================================================
00885F2C                            
00885F2C                            		include	"_incObj\8B Try Again & End Eggman.asm"
00885F2C                            ; ---------------------------------------------------------------------------
00885F2C                            ; Object 8B - Eggman on "TRY AGAIN" and "END"	screens
00885F2C                            ; ---------------------------------------------------------------------------
00885F2C                            
00885F2C                            EndEggman:				; XREF: Obj_Index
00885F2C 7000                       		moveq	#0,d0
00885F2E 1028 0024                  		move.b	obRoutine(a0),d0
00885F32 323B 0000                  		move.w	EEgg_Index(pc,d0.w),d1
00885F36 4EBB 1000                  		jsr	EEgg_Index(pc,d1.w)
00885F3A 4EF9 0000 0000             		jmp	DisplaySprite
00885F40                            ; ===========================================================================
00885F40 0000                       EEgg_Index:	dc.w EEgg_Main-EEgg_Index
00885F42 0000                       		dc.w EEgg_Animate-EEgg_Index
00885F44 0000                       		dc.w EEgg_Juggle-EEgg_Index
00885F46 0000                       		dc.w EEgg_Wait-EEgg_Index
00885F48                            
00885F48 =00000030                  eegg_time:	= $30		; time between juggle motions
00885F48                            ; ===========================================================================
00885F48                            
00885F48                            EEgg_Main:	; Routine 0
00885F48 5428 0024                  		addq.b	#2,obRoutine(a0)
00885F4C 317C 0120 0008             		move.w	#$120,obX(a0)
00885F52 317C 00F4 000A             		move.w	#$F4,obScreenY(a0)
00885F58 217C 0000 0000 0004        		move.l	#Map_EEgg,obMap(a0)
00885F60 317C 03E1 0002             		move.w	#$3E1,obGfx(a0)
00885F66 117C 0000 0001             		move.b	#0,obRender(a0)
00885F6C 117C 0002 0018             		move.b	#2,obPriority(a0)
00885F72 117C 0002 001C             		move.b	#2,obAnim(a0)	; use "END" animation
00885F78 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w ; do you have all 6 emeralds?
00885F7E 6700                       		beq.s	EEgg_Animate	; if yes, branch
00885F80                            
00885F80 11FC 0000 D0C0             		move.b	#id_CreditsText,(v_objspace+$C0).w ; load credits object
00885F86 31FC 0009 FFF4             		move.w	#9,(v_creditsnum).w ; use "TRY AGAIN" text
00885F8C 11FC 0000 D800             		move.b	#id_TryChaos,(v_objspace+$800).w ; load emeralds object on "TRY AGAIN" screen
00885F92 117C 0000 001C             		move.b	#0,obAnim(a0)	; use "TRY AGAIN" animation
00885F98                            
00885F98                            EEgg_Animate:	; Routine 2
00885F98 43F9 0000 0000             		lea	(Ani_EEgg).l,a1
00885F9E 4EF9 0000 0000             		jmp	AnimateSprite
00885FA4                            ; ===========================================================================
00885FA4                            
00885FA4                            EEgg_Juggle:	; Routine 4
00885FA4 5428 0024                  		addq.b	#2,obRoutine(a0)
00885FA8 7002                       		moveq	#2,d0
00885FAA 0828 0000 001C             		btst	#0,obAnim(a0)
00885FB0 6700                       		beq.s	@noflip
00885FB2 4440                       		neg.w	d0
00885FB4                            
00885FB4                            	@noflip:
00885FB4 43F8 D800                  		lea	(v_objspace+$800).w,a1 ; get RAM address for emeralds
00885FB8 7205                       		moveq	#5,d1
00885FBA                            
00885FBA                            @emeraldloop:
00885FBA 1340 003E                  		move.b	d0,$3E(a1)
00885FBE 3400                       		move.w	d0,d2
00885FC0 E742                       		asl.w	#3,d2
00885FC2 D529 0026                  		add.b	d2,obAngle(a1)
00885FC6 43E9 0040                  		lea	$40(a1),a1
00885FCA 51C9 FFEE                  		dbf	d1,@emeraldloop
00885FCE 5228 001A                  		addq.b	#1,obFrame(a0)
00885FD2 317C 0070 0030             		move.w	#112,eegg_time(a0)
00885FD8                            
00885FD8                            EEgg_Wait:	; Routine 6
00885FD8 5368 0030                  		subq.w	#1,eegg_time(a0) ; decrement timer
00885FDC 6A00                       		bpl.s	@nochg		; branch if time remains
00885FDE 0868 0000 001C             		bchg	#0,obAnim(a0)
00885FE4 117C 0002 0024             		move.b	#2,obRoutine(a0) ; goto EEgg_Animate next
00885FEA                            
00885FEA                            	@nochg:
00885FEA 4E75                       		rts	
00885FEA 4E75                       		rts	
00885FEC                            		include "_anim\Try Again & End Eggman.asm"
00885FEC                            ; ---------------------------------------------------------------------------
00885FEC                            ; Animation script - Eggman on the "TRY AGAIN" and "END" screens
00885FEC                            ; ---------------------------------------------------------------------------
00885FEC 0000                       Ani_EEgg:	dc.w @tryagain1-Ani_EEgg
00885FEE 0000                       		dc.w @tryagain2-Ani_EEgg
00885FF0 0000                       		dc.w @end-Ani_EEgg
00885FF2 0500 FC01                  @tryagain1:	dc.b 5,	0, afRoutine, 1
00885FF6 0502 FC03                  @tryagain2:	dc.b 5,	2, afRoutine, 3
00885FFA 0704 0506 0504 0506 0504+  @end:		dc.b 7,	4, 5, 6, 5, 4, 5, 6, 5,	4, 5, 6, 5, 7, 5, 6, 5,	afEnd
0088600C                            		even
0088600C                            		even
0088600C                            		include	"_incObj\8C Try Again Emeralds.asm"
0088600C                            ; ---------------------------------------------------------------------------
0088600C                            ; Object 8C - chaos emeralds on	the "TRY AGAIN"	screen
0088600C                            ; ---------------------------------------------------------------------------
0088600C                            
0088600C                            TryChaos:				; XREF: Obj_Index
0088600C 7000                       		moveq	#0,d0
0088600E 1028 0024                  		move.b	obRoutine(a0),d0
00886012 323B 0000                  		move.w	TCha_Index(pc,d0.w),d1
00886016 4EBB 1000                  		jsr	TCha_Index(pc,d1.w)
0088601A 4EF9 0000 0000             		jmp	DisplaySprite
00886020                            ; ===========================================================================
00886020 0000                       TCha_Index:	dc.w TCha_Main-TCha_Index
00886022 0000                       		dc.w TCha_Move-TCha_Index
00886024                            ; ===========================================================================
00886024                            
00886024                            TCha_Main:	; Routine 0
00886024 2248                       		movea.l	a0,a1
00886026 7400                       		moveq	#0,d2
00886028 7600                       		moveq	#0,d3
0088602A 7205                       		moveq	#5,d1
0088602C 9238 FE57                  		sub.b	(v_emeralds).w,d1
00886030                            
00886030                            @makeemerald:				; XREF: loc_5B42
00886030 12BC 0000                  		move.b	#id_TryChaos,(a1) ; load emerald object
00886034 5429 0024                  		addq.b	#2,obRoutine(a1)
00886038 237C 0088 5CC4 0004        		move.l	#Map_ECha,obMap(a1)
00886040 337C 03C5 0002             		move.w	#$3C5,obGfx(a1)
00886046 137C 0000 0001             		move.b	#0,obRender(a1)
0088604C 137C 0001 0018             		move.b	#1,obPriority(a1)
00886052 337C 0104 0008             		move.w	#$104,obX(a1)
00886058 337C 0120 0038             		move.w	#$120,$38(a1)
0088605E 337C 00EC 000A             		move.w	#$EC,obScreenY(a1)
00886064 3369 000A 003A             		move.w	obScreenY(a1),$3A(a1)
0088606A 137C 001C 003C             		move.b	#$1C,$3C(a1)
00886070 47F8 FE58                  		lea	(v_emldlist).w,a3
00886074                            
00886074                            	@chkemerald:
00886074 7000                       		moveq	#0,d0
00886076 1038 FE57                  		move.b	(v_emeralds).w,d0
0088607A 5340                       		subq.w	#1,d0
0088607C 6500                       		bcs.s	@loc_5B42
0088607E                            
0088607E                            	@chkloop:
0088607E B433 0000                  		cmp.b	(a3,d0.w),d2
00886082 6600                       		bne.s	@notgot
00886084 5202                       		addq.b	#1,d2
00886086 60EC                       		bra.s	@chkemerald
00886088                            ; ===========================================================================
00886088                            
00886088                            	@notgot:
00886088 51C8 FFF4                  		dbf	d0,@chkloop
0088608C                            
0088608C                            @loc_5B42:
0088608C 1342 001A                  		move.b	d2,obFrame(a1)
00886090 5229 001A                  		addq.b	#1,obFrame(a1)
00886094 5202                       		addq.b	#1,d2
00886096 137C 0080 0026             		move.b	#$80,obAngle(a1)
0088609C 1343 001E                  		move.b	d3,obTimeFrame(a1)
008860A0 1343 001F                  		move.b	d3,obDelayAni(a1)
008860A4 0643 000A                  		addi.w	#10,d3
008860A8 43E9 0040                  		lea	$40(a1),a1
008860AC 51C9 FF82                  		dbf	d1,@makeemerald	; repeat 5 times
008860B0                            
008860B0                            TCha_Move:	; Routine 2
008860B0 4A68 003E                  		tst.w	$3E(a0)
008860B4 6700                       		beq.s	locret_5BBA
008860B6 4A28 001E                  		tst.b	obTimeFrame(a0)
008860BA 6700                       		beq.s	loc_5B78
008860BC 5328 001E                  		subq.b	#1,obTimeFrame(a0)
008860C0 6600                       		bne.s	loc_5B80
008860C2                            
008860C2                            loc_5B78:
008860C2 3028 003E                  		move.w	$3E(a0),d0
008860C6 D168 0026                  		add.w	d0,obAngle(a0)
008860CA                            
008860CA                            loc_5B80:
008860CA 1028 0026                  		move.b	obAngle(a0),d0
008860CE 6700                       		beq.s	loc_5B8C
008860D0 0C00 0080                  		cmpi.b	#$80,d0
008860D4 6600                       		bne.s	loc_5B96
008860D6                            
008860D6                            loc_5B8C:
008860D6 4268 003E                  		clr.w	$3E(a0)
008860DA 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0)
008860E0                            
008860E0                            loc_5B96:
008860E0 4EB9 0088 301C             		jsr	(CalcSine).l
008860E6 7800                       		moveq	#0,d4
008860E8 1828 003C                  		move.b	$3C(a0),d4
008860EC C3C4                       		muls.w	d4,d1
008860EE E081                       		asr.l	#8,d1
008860F0 C1C4                       		muls.w	d4,d0
008860F2 E080                       		asr.l	#8,d0
008860F4 D268 0038                  		add.w	$38(a0),d1
008860F8 D068 003A                  		add.w	$3A(a0),d0
008860FC 3141 0008                  		move.w	d1,obX(a0)
00886100 3140 000A                  		move.w	d0,obScreenY(a0)
00886104                            
00886104                            locret_5BBA:
00886104 4E75                       		rts	
00886104 4E75                       		rts	
00886106                            		include	"_maps\Try Again & End Eggman.asm"
00886106                            ; ---------------------------------------------------------------------------
00886106                            ; Sprite mappings - Robotnik on	the "TRY AGAIN"	and "END" screens
00886106                            ; ---------------------------------------------------------------------------
00886106 0000 0000                  Map_EEgg:	dc.w M_EEgg_Try1-Map_EEgg, M_EEgg_Try2-Map_EEgg
0088610A 0000 0000                  		dc.w M_EEgg_Try3-Map_EEgg, M_EEgg_Try4-Map_EEgg
0088610E 0000 0000                  		dc.w M_EEgg_End1-Map_EEgg, M_EEgg_End2-Map_EEgg
00886112 0000 0000                  		dc.w M_EEgg_End3-Map_EEgg, M_EEgg_End4-Map_EEgg
00886116 08                         M_EEgg_Try1:	dc.b 8
00886117 E905 0000 F0               		dc.b $E9, 5, 0,	0, $F0
0088611C F90C 0004 E0               		dc.b $F9, $C, 0, 4, $E0
00886121 E904 0008 00               		dc.b $E9, 4, 0,	8, 0
00886126 F10D 000A 00               		dc.b $F1, $D, 0, $A, 0
0088612B 0106 0023 F0               		dc.b 1,	6, 0, $23, $F0
00886130 0106 0823 00               		dc.b 1,	6, 8, $23, 0
00886135 1804 0029 EC               		dc.b $18, 4, 0,	$29, $EC
0088613A 1804 0829 04               		dc.b $18, 4, 8,	$29, 4
0088613F 08                         M_EEgg_Try2:	dc.b 8
00886140 E80D 0012 E0               		dc.b $E8, $D, 0, $12, $E0
00886145 F808 001A E8               		dc.b $F8, 8, 0,	$1A, $E8
0088614A E805 0800 00               		dc.b $E8, 5, 8,	0, 0
0088614F F80C 0804 00               		dc.b $F8, $C, 8, 4, 0
00886154 0006 001D F0               		dc.b 0,	6, 0, $1D, $F0
00886159 0006 081D 00               		dc.b 0,	6, 8, $1D, 0
0088615E 1804 0029 EC               		dc.b $18, 4, 0,	$29, $EC
00886163 1804 0829 04               		dc.b $18, 4, 8,	$29, 4
00886168 08                         M_EEgg_Try3:	dc.b 8
00886169 E904 0808 F0               		dc.b $E9, 4, 8,	8, $F0
0088616E F10D 080A E0               		dc.b $F1, $D, 8, $A, $E0
00886173 E905 0800 00               		dc.b $E9, 5, 8,	0, 0
00886178 F90C 0804 00               		dc.b $F9, $C, 8, 4, 0
0088617D 0106 0023 F0               		dc.b 1,	6, 0, $23, $F0
00886182 0106 0823 00               		dc.b 1,	6, 8, $23, 0
00886187 1804 0029 EC               		dc.b $18, 4, 0,	$29, $EC
0088618C 1804 0829 04               		dc.b $18, 4, 8,	$29, 4
00886191 08                         M_EEgg_Try4:	dc.b 8
00886192 E805 0000 F0               		dc.b $E8, 5, 0,	0, $F0
00886197 F80C 0004 E0               		dc.b $F8, $C, 0, 4, $E0
0088619C E80D 0812 00               		dc.b $E8, $D, 8, $12, 0
008861A1 F808 081A 00               		dc.b $F8, 8, 8,	$1A, 0
008861A6 0006 001D F0               		dc.b 0,	6, 0, $1D, $F0
008861AB 0006 081D 00               		dc.b 0,	6, 8, $1D, 0
008861B0 1804 0029 EC               		dc.b $18, 4, 0,	$29, $EC
008861B5 1804 0829 04               		dc.b $18, 4, 8,	$29, 4
008861BA 0C                         M_EEgg_End1:	dc.b $C
008861BB ED0A 002B E8               		dc.b $ED, $A, 0, $2B, $E8
008861C0 F500 0034 E0               		dc.b $F5, 0, 0,	$34, $E0
008861C5 0504 0035 F0               		dc.b 5,	4, 0, $35, $F0
008861CA 0D08 0037 E8               		dc.b $D, 8, 0, $37, $E8
008861CF ED0A 082B 00               		dc.b $ED, $A, 8, $2B, 0
008861D4 F500 0834 18               		dc.b $F5, 0, 8,	$34, $18
008861D9 0504 0835 00               		dc.b 5,	4, 8, $35, 0
008861DE 0D08 0837 00               		dc.b $D, 8, 8, $37, 0
008861E3 100D 0073 E0               		dc.b $10, $D, 0, $73, $E0
008861E8 100D 007B 00               		dc.b $10, $D, 0, $7B, 0
008861ED 1C0C 005B E0               		dc.b $1C, $C, 0, $5B, $E0
008861F2 1C0C 085B 00               		dc.b $1C, $C, 8, $5B, 0
008861F7 0A                         M_EEgg_End2:	dc.b $A
008861F8 D207 003A F0               		dc.b $D2, 7, 0,	$3A, $F0
008861FD DA00 0042 E8               		dc.b $DA, 0, 0,	$42, $E8
00886202 F207 0043 F0               		dc.b $F2, 7, 0,	$43, $F0
00886207 D207 083A 00               		dc.b $D2, 7, 8,	$3A, 0
0088620C DA00 0842 10               		dc.b $DA, 0, 8,	$42, $10
00886211 F207 0843 00               		dc.b $F2, 7, 8,	$43, 0
00886216 100D 0067 E8               		dc.b $10, $D, 0, $67, $E8
0088621B 1005 006F 08               		dc.b $10, 5, 0,	$6F, 8
00886220 1C0C 005F E0               		dc.b $1C, $C, 0, $5F, $E0
00886225 1C0C 085F 00               		dc.b $1C, $C, 8, $5F, 0
0088622A 0A                         M_EEgg_End3:	dc.b $A
0088622B C40B 004B E8               		dc.b $C4, $B, 0, $4B, $E8
00886230 E408 0057 E8               		dc.b $E4, 8, 0,	$57, $E8
00886235 EC00 005A F0               		dc.b $EC, 0, 0,	$5A, $F0
0088623A C40B 084B 00               		dc.b $C4, $B, 8, $4B, 0
0088623F E408 0857 00               		dc.b $E4, 8, 8,	$57, 0
00886244 EC00 085A 08               		dc.b $EC, 0, 8,	$5A, 8
00886249 100D 0067 E8               		dc.b $10, $D, 0, $67, $E8
0088624E 1005 006F 08               		dc.b $10, 5, 0,	$6F, 8
00886253 1C0C 0063 E0               		dc.b $1C, $C, 0, $63, $E0
00886258 1C0C 0863 00               		dc.b $1C, $C, 8, $63, 0
0088625D 0C                         M_EEgg_End4:	dc.b $C
0088625E F40A 002B E8               		dc.b $F4, $A, 0, $2B, $E8
00886263 FC00 0034 E0               		dc.b $FC, 0, 0,	$34, $E0
00886268 0C04 0035 F0               		dc.b $C, 4, 0, $35, $F0
0088626D 1408 0037 E8               		dc.b $14, 8, 0,	$37, $E8
00886272 F40A 082B 00               		dc.b $F4, $A, 8, $2B, 0
00886277 FC00 0834 18               		dc.b $FC, 0, 8,	$34, $18
0088627C 0C04 0835 00               		dc.b $C, 4, 8, $35, 0
00886281 1408 0837 00               		dc.b $14, 8, 8,	$37, 0
00886286 180C 0083 E0               		dc.b $18, $C, 0, $83, $E0
0088628B 180C 0087 00               		dc.b $18, $C, 0, $87, 0
00886290 1C0C 005B E0               		dc.b $1C, $C, 0, $5B, $E0
00886295 1C0C 085B 00               		dc.b $1C, $C, 8, $5B, 0
0088629A                            		even
0088629A                            		even
0088629A                            
0088629A                            ; ---------------------------------------------------------------------------
0088629A                            ; Ending sequence demos
0088629A                            ; ---------------------------------------------------------------------------
0088629A                            Demo_EndGHZ1:	incbin	"demodata\Ending - GHZ1.bin"
008862C8                            		even
008862C8                            Demo_EndMZ:	incbin	"demodata\Ending - MZ.bin"
00886308                            		even
00886308                            Demo_EndSYZ:	incbin	"demodata\Ending - SYZ.bin"
00886338                            		even
00886338                            Demo_EndLZ:	incbin	"demodata\Ending - LZ.bin"
00886368                            		even
00886368                            Demo_EndSLZ:	incbin	"demodata\Ending - SLZ.bin"
00886388                            		even
00886388                            Demo_EndSBZ1:	incbin	"demodata\Ending - SBZ1.bin"
008863A8                            		even
008863A8                            Demo_EndSBZ2:	incbin	"demodata\Ending - SBZ2.bin"
008863D8                            		even
008863D8                            Demo_EndGHZ2:	incbin	"demodata\Ending - GHZ2.bin"
00886408                            		even
00886408                            
00886408                            
00886408                            		include	"_inc\LevelSizeLoad & BgScrollSpeed (JP1).asm"
00886408                            ; ---------------------------------------------------------------------------
00886408                            ; Subroutine to	load level boundaries and start	locations
00886408                            ; ---------------------------------------------------------------------------
00886408                            
00886408                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886408                            
00886408                            
00886408                            LevelSizeLoad:				; XREF: GM_Title; GM_Level; GM_Ending
00886408 7000                       		moveq	#0,d0
0088640A 11C0 F740                  		move.b	d0,($FFFFF740).w
0088640E 11C0 F741                  		move.b	d0,($FFFFF741).w
00886412 11C0 F746                  		move.b	d0,($FFFFF746).w
00886416 11C0 F748                  		move.b	d0,($FFFFF748).w
0088641A 11C0 F742                  		move.b	d0,(v_dle_routine).w
0088641E 3038 FE10                  		move.w	(v_zone).w,d0
00886422 ED08                       		lsl.b	#6,d0
00886424 E848                       		lsr.w	#4,d0
00886426 3200                       		move.w	d0,d1
00886428 D040                       		add.w	d0,d0
0088642A D041                       		add.w	d1,d0
0088642C 41FB 0000                  		lea	LevelSizeArray(pc,d0.w),a0 ; load level	boundaries
00886430 3018                       		move.w	(a0)+,d0
00886432 31C0 F730                  		move.w	d0,($FFFFF730).w
00886436 2018                       		move.l	(a0)+,d0
00886438 21C0 F728                  		move.l	d0,(v_limitleft2).w
0088643C 21C0 F720                  		move.l	d0,(v_limitleft1).w
00886440 2018                       		move.l	(a0)+,d0
00886442 21C0 F72C                  		move.l	d0,(v_limittop2).w
00886446 21C0 F724                  		move.l	d0,(v_limittop1).w
0088644A 3038 F728                  		move.w	(v_limitleft2).w,d0
0088644E 0640 0240                  		addi.w	#$240,d0
00886452 31C0 F732                  		move.w	d0,(v_limitleft3).w
00886456 31FC 1010 F74A             		move.w	#$1010,($FFFFF74A).w
0088645C 3018                       		move.w	(a0)+,d0
0088645E 31C0 F73E                  		move.w	d0,(v_lookshift).w
00886462 6000 0000                  		bra.w	LevSz_ChkLamp
00886466                            ; ===========================================================================
00886466                            ; ---------------------------------------------------------------------------
00886466                            ; Level size array
00886466                            ; ---------------------------------------------------------------------------
00886466                            LevelSizeArray:	incbin	"misc\Level Size Array.bin"
008865B6                            		even
008865B6                            
008865B6                            ; ---------------------------------------------------------------------------
008865B6                            ; Ending start location array
008865B6                            ; ---------------------------------------------------------------------------
008865B6                            EndingStLocArray:
008865B6                            		include	"_inc\Start Location Array - Ending.asm"
008865B6                            ; ---------------------------------------------------------------------------
008865B6                            ; Ending start location array
008865B6                            ; ---------------------------------------------------------------------------
008865B6                            
008865B6                            		incbin	"startpos\ghz1 (Credits demo 1).bin"
008865BA                            		incbin	"startpos\mz2 (Credits demo).bin"
008865BE                            		incbin	"startpos\syz3 (Credits demo).bin"
008865C2                            		incbin	"startpos\lz3 (Credits demo).bin"
008865C6                            		incbin	"startpos\slz3 (Credits demo).bin"
008865CA                            		incbin	"startpos\sbz1 (Credits demo).bin"
008865CE                            		incbin	"startpos\sbz2 (Credits demo).bin"
008865D2                            		incbin	"startpos\ghz1 (Credits demo 2).bin"
008865D6                            		even
008865D6                            		even
008865D6                            
008865D6                            ; ===========================================================================
008865D6                            
008865D6                            LevSz_ChkLamp:				; XREF: LevelSizeLoad
008865D6 4A38 FE30                  		tst.b	(v_lastlamp).w	; have any lampposts been hit?
008865DA 6700                       		beq.s	LevSz_StartLoc	; if not, branch
008865DC                            
008865DC 4EB9 0000 0000             		jsr	Lamp_LoadInfo
008865E2 3238 D008                  		move.w	(v_player+obX).w,d1
008865E6 3038 D00C                  		move.w	(v_player+obY).w,d0
008865EA 6000                       		bra.s	LevSz_SkipStartPos
008865EC                            ; ===========================================================================
008865EC                            
008865EC                            LevSz_StartLoc:
008865EC 3038 FE10                  		move.w	(v_zone).w,d0
008865F0 ED08                       		lsl.b	#6,d0
008865F2 E848                       		lsr.w	#4,d0
008865F4 43FB 0000                  		lea	StartLocArray(pc,d0.w),a1 ; load Sonic's start location
008865F8 4A78 FFF0                  		tst.w	(f_demo).w	; is ending demo mode on?
008865FC 6A00                       		bpl.s	LevSz_SonicPos	; if not, branch
008865FE                            
008865FE 3038 FFF4                  		move.w	(v_creditsnum).w,d0
00886602 5340                       		subq.w	#1,d0
00886604 E548                       		lsl.w	#2,d0
00886606 43FB 00AE                  		lea	EndingStLocArray(pc,d0.w),a1 ; load Sonic's start location
0088660A                            
0088660A                            LevSz_SonicPos:
0088660A 7200                       		moveq	#0,d1
0088660C 3219                       		move.w	(a1)+,d1
0088660E 31C1 D008                  		move.w	d1,(v_player+obX).w ; set Sonic's position on x-axis
00886612 7000                       		moveq	#0,d0
00886614 3011                       		move.w	(a1),d0
00886616 31C0 D00C                  		move.w	d0,(v_player+obY).w ; set Sonic's position on y-axis
0088661A                            
0088661A                            SetScreen:
0088661A                            	LevSz_SkipStartPos:
0088661A                            	
0088661A 4238 FEB3                  		clr.b	(v_cameralag).w
0088661E 4278 F7A8                  		clr.w	(v_trackpos).w		; reset Sonic's position tracking index
00886622 45F8 CB00                  		lea	(v_tracksonic).w,a2	; load the tracking array into a2
00886626 743F                       		moveq	#63,d2			; begin a 64-step loop
00886628                            	@looppoint:
00886628 34C1                       		move.w	d1,(a2)+		; fill in X
0088662A 34C0                       		move.w	d0,(a2)+		; fill in Y
0088662C 51CA FFFA                  		dbf	d2,@looppoint		; loop
00886630                            	
00886630 0441 00A0                  		subi.w	#160,d1		; is Sonic more than 160px from left edge?
00886634 6400                       		bcc.s	SetScr_WithinLeft ; if yes, branch
00886636 7200                       		moveq	#0,d1
00886638                            
00886638                            	SetScr_WithinLeft:
00886638 3438 F72A                  		move.w	(v_limitright2).w,d2
0088663C B242                       		cmp.w	d2,d1		; is Sonic inside the right edge?
0088663E 6500                       		bcs.s	SetScr_WithinRight ; if yes, branch
00886640 3202                       		move.w	d2,d1
00886642                            
00886642                            	SetScr_WithinRight:
00886642 31C1 F700                  		move.w	d1,(v_screenposx).w ; set horizontal screen position
00886646                            
00886646 0440 0060                  		subi.w	#96,d0		; is Sonic within 96px of upper edge?
0088664A 6400                       		bcc.s	SetScr_WithinTop ; if yes, branch
0088664C 7000                       		moveq	#0,d0
0088664E                            
0088664E                            	SetScr_WithinTop:
0088664E B078 F72E                  		cmp.w	(v_limitbtm2).w,d0 ; is Sonic above the bottom edge?
00886652 6D00                       		blt.s	SetScr_WithinBottom ; if yes, branch
00886654 3038 F72E                  		move.w	(v_limitbtm2).w,d0
00886658                            
00886658                            	SetScr_WithinBottom:
00886658 31C0 F704                  		move.w	d0,(v_screenposy).w ; set vertical screen position
0088665C 6100 0000                  		bsr.w	BgScrollSpeed
00886660 7000                       		moveq	#0,d0
00886662 1038 FE10                  		move.b	(v_zone).w,d0
00886666 E508                       		lsl.b	#2,d0
00886668 21FB 0000 F7AC             		move.l	LoopTileNums(pc,d0.w),(v_256loop1).w
0088666E 4E75                       		rts
00886670                            ; ===========================================================================
00886670                            ; ---------------------------------------------------------------------------
00886670                            ; Sonic	start location array
00886670                            ; ---------------------------------------------------------------------------
00886670                            StartLocArray:	incbin	"misc\Start Location Array - Levels.bin"
008866E0                            		even
008866E0                            
008866E0                            ; ---------------------------------------------------------------------------
008866E0                            ; Which	256x256	tiles contain loops or roll-tunnels
008866E0                            ; ---------------------------------------------------------------------------
008866E0                            
008866E0                            LoopTileNums:
008866E0                            
008866E0                            ; 		loop	loop	tunnel	tunnel
008866E0                            
008866E0 B57F 1F20                  	dc.b	$B5,	$7F,	$1F,	$20	; Green Hill
008866E4 7F7F 7F7F                  	dc.b	$7F,	$7F,	$7F,	$7F	; Labyrinth
008866E8 7F7F 7F7F                  	dc.b	$7F,	$7F,	$7F,	$7F	; Marble
008866EC AAB4 7F7F                  	dc.b	$AA,	$B4,	$7F,	$7F	; Star Light
008866F0 7F7F 7F7F                  	dc.b	$7F,	$7F,	$7F,	$7F	; Spring Yard
008866F4 7F7F 7F7F                  	dc.b	$7F,	$7F,	$7F,	$7F	; Scrap Brain
008866F8 7F7F 7F7F                  	dc.b	$7F,	$7F,	$7F,	$7F	; Ending (Green Hill)
008866FC                            
008866FC                            		even
008866FC                            
008866FC                            ; ---------------------------------------------------------------------------
008866FC                            ; Subroutine to	set scroll speed of some backgrounds
008866FC                            ; ---------------------------------------------------------------------------
008866FC                            
008866FC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008866FC                            
008866FC                            
008866FC                            BgScrollSpeed:				; XREF: LevelSizeLoad
008866FC 4A38 FE30                  		tst.b	(v_lastlamp).w
00886700 6600                       		bne.s	loc_6206
00886702 31C0 F70C                  		move.w	d0,($FFFFF70C).w
00886706 31C0 F714                  		move.w	d0,($FFFFF714).w
0088670A 31C1 F708                  		move.w	d1,($FFFFF708).w
0088670E 31C1 F710                  		move.w	d1,($FFFFF710).w
00886712 31C1 F718                  		move.w	d1,($FFFFF718).w
00886716                            
00886716                            loc_6206:
00886716 7400                       		moveq	#0,d2
00886718 1438 FE10                  		move.b	(v_zone).w,d2
0088671C D442                       		add.w	d2,d2
0088671E 343B 2000                  		move.w	BgScroll_Index(pc,d2.w),d2
00886722 4EFB 2000                  		jmp	BgScroll_Index(pc,d2.w)
00886726                            ; End of function BgScrollSpeed
00886726                            
00886726                            ; ===========================================================================
00886726 0000 0000                  BgScroll_Index:	dc.w BgScroll_GHZ-BgScroll_Index, BgScroll_LZ-BgScroll_Index
0088672A 0000 0000                  		dc.w BgScroll_MZ-BgScroll_Index, BgScroll_SLZ-BgScroll_Index
0088672E 0000 0000                  		dc.w BgScroll_SYZ-BgScroll_Index, BgScroll_SBZ-BgScroll_Index
00886732 0000                       		dc.w BgScroll_End-BgScroll_Index
00886734                            ; ===========================================================================
00886734                            
00886734                            BgScroll_GHZ:				; XREF: BgScroll_Index
00886734 42B8 F708                  		clr.l	($FFFFF708).w
00886738 42B8 F70C                  		clr.l	($FFFFF70C).w
0088673C 42B8 F714                  		clr.l	($FFFFF714).w
00886740 42B8 F71C                  		clr.l	($FFFFF71C).w
00886744 45F8 A800                  		lea	($FFFFA800).w,a2
00886748 429A                       		clr.l	(a2)+
0088674A 429A                       		clr.l	(a2)+
0088674C 429A                       		clr.l	(a2)+
0088674E 4E75                       		rts
00886750                            ; ===========================================================================
00886750                            
00886750                            BgScroll_LZ:				; XREF: BgScroll_Index
00886750 E280                       		asr.l	#1,d0
00886752 31C0 F70C                  		move.w	d0,($FFFFF70C).w
00886756 4E75                       		rts	
00886758                            ; ===========================================================================
00886758                            
00886758                            BgScroll_MZ:				; XREF: BgScroll_Index
00886758 4E75                       		rts	
0088675A                            ; ===========================================================================
0088675A                            
0088675A                            BgScroll_SLZ:				; XREF: BgScroll_Index
0088675A E280                       		asr.l	#1,d0
0088675C 0640 00C0                  		addi.w	#$C0,d0
00886760 31C0 F70C                  		move.w	d0,($FFFFF70C).w
00886764 42B8 F708                  		clr.l	($FFFFF708).w
00886768 4E75                       		rts	
0088676A                            ; ===========================================================================
0088676A                            
0088676A                            BgScroll_SYZ:				; XREF: BgScroll_Index
0088676A E980                       		asl.l	#4,d0
0088676C 2400                       		move.l	d0,d2
0088676E E380                       		asl.l	#1,d0
00886770 D082                       		add.l	d2,d0
00886772 E080                       		asr.l	#8,d0
00886774 5240                       		addq.w	#1,d0
00886776 31C0 F70C                  		move.w	d0,($FFFFF70C).w
0088677A 42B8 F708                  		clr.l	($FFFFF708).w
0088677E 4E75                       		rts	
00886780                            ; ===========================================================================
00886780                            
00886780                            BgScroll_SBZ:				; XREF: BgScroll_Index
00886780 0240 07F8                  		andi.w	#$7F8,d0
00886784 E640                       		asr.w	#3,d0
00886786 5240                       		addq.w	#1,d0
00886788 31C0 F70C                  		move.w	d0,($FFFFF70C).w
0088678C 4E75                       		rts	
0088678E                            ; ===========================================================================
0088678E                            
0088678E                            BgScroll_End:				; XREF: BgScroll_Index
0088678E 3038 F700                  		move.w	(v_screenposx).w,d0
00886792 E240                       		asr.w	#1,d0
00886794 31C0 F708                  		move.w	d0,($FFFFF708).w
00886798 31C0 F710                  		move.w	d0,($FFFFF710).w
0088679C E440                       		asr.w	#2,d0
0088679E 3200                       		move.w	d0,d1
008867A0 D040                       		add.w	d0,d0
008867A2 D041                       		add.w	d1,d0
008867A4 31C0 F718                  		move.w	d0,($FFFFF718).w
008867A8 42B8 F70C                  		clr.l	($FFFFF70C).w
008867AC 42B8 F714                  		clr.l	($FFFFF714).w
008867B0 42B8 F71C                  		clr.l	($FFFFF71C).w
008867B4 45F8 A800                  		lea	($FFFFA800).w,a2
008867B8 429A                       		clr.l	(a2)+
008867BA 429A                       		clr.l	(a2)+
008867BC 429A                       		clr.l	(a2)+
008867BE 4E75                       		rts
008867BE 4E75                       		rts
008867C0                            		include	"_inc\DeformLayers (JP1).asm"
008867C0                            ; ---------------------------------------------------------------------------
008867C0                            ; Background layer deformation subroutines
008867C0                            ; ---------------------------------------------------------------------------
008867C0                            
008867C0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008867C0                            
008867C0                            
008867C0                            DeformLayers:				; XREF: GM_TitleScr; GM_Level; GM_Ending
008867C0 4A38 F744                  		tst.b	(f_nobgscroll).w
008867C4 6700                       		beq.s	loc_628E
008867C6 4E75                       		rts	
008867C8                            ; ===========================================================================
008867C8                            
008867C8                            loc_628E:
008867C8 4278 F754                  		clr.w	(v_bgscroll1).w
008867CC 4278 F756                  		clr.w	(v_bgscroll2).w
008867D0 4278 F758                  		clr.w	(v_bgscroll3).w
008867D4 4278 F75A                  		clr.w	($FFFFF75A).w
008867D8 6100 0000                  		bsr.w	ScrollHoriz
008867DC 6100 0000                  		bsr.w	ScrollVertical
008867E0 6100 0000                  		bsr.w	DynamicLevelEvents
008867E4 31F8 F704 F616             		move.w	(v_screenposy).w,(v_scrposy_dup).w
008867EA 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
008867F0 7000                       		moveq	#0,d0
008867F2 1038 FE10                  		move.b	(v_zone).w,d0
008867F6 D040                       		add.w	d0,d0
008867F8 303B 0000                  		move.w	Deform_Index(pc,d0.w),d0
008867FC 4EFB 0000                  		jmp	Deform_Index(pc,d0.w)
00886800                            ; End of function DeformLayers
00886800                            
00886800                            ; ===========================================================================
00886800                            ; ---------------------------------------------------------------------------
00886800                            ; Offset index for background layer deformation	code
00886800                            ; ---------------------------------------------------------------------------
00886800 0000 0000                  Deform_Index:	dc.w Deform_GHZ-Deform_Index, Deform_LZ-Deform_Index
00886804 0000 0000                  		dc.w Deform_MZ-Deform_Index, Deform_SLZ-Deform_Index
00886808 0000 0000                  		dc.w Deform_SYZ-Deform_Index, Deform_SBZ-Deform_Index
0088680C 0000                       		dc.w Deform_GHZ-Deform_Index
0088680E                            ; ---------------------------------------------------------------------------
0088680E                            ; Green	Hill Zone background layer deformation code
0088680E                            ; ---------------------------------------------------------------------------
0088680E                            
0088680E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088680E                            
0088680E                            
0088680E                            Deform_GHZ:				; XREF: Deform_Index
0088680E 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886812 48C4                       		ext.l	d4
00886814 EB84                       		asl.l	#5,d4
00886816 2204                       		move.l	d4,d1
00886818 E384                       		asl.l	#1,d4
0088681A D881                       		add.l	d1,d4
0088681C 7C00                       		moveq	#0,d6
0088681E 6100 0000                  		bsr	ScrollBlock5
00886822 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886826 48C4                       		ext.l	d4
00886828 EF84                       		asl.l	#7,d4
0088682A 7C00                       		moveq	#0,d6
0088682C 6100 0000                  		bsr	ScrollBlock4
00886830 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
00886834 3038 F704                  		move.w	(v_screenposy).w,d0
00886838 0240 07FF                  		andi.w	#$7FF,d0
0088683C EA48                       		lsr.w	#5,d0
0088683E 4440                       		neg.w	d0
00886840 0640 0020                  		addi.w	#$20,d0
00886844 6A00                       		bpl.s	loc_62F6
00886846 7000                       		moveq	#0,d0
00886848                            loc_62F6:
00886848 3800                       		move.w	d0,d4
0088684A 31C0 F618                  		move.w	d0,($FFFFF618).w
0088684E 3038 F700                  		move.w	(v_screenposx).w,d0
00886852 0C38 0000 F600             		cmpi.b	#id_Title,($FFFFF600).w
00886858 6600                       		bne.s	loc_630A
0088685A 7000                       		moveq	#0,d0
0088685C                            loc_630A:
0088685C 4440                       		neg.w	d0
0088685E 4840                       		swap.w	d0
00886860 45F8 A800                  		lea	($FFFFA800).w,a2
00886864 069A 0001 0000             		addi.l	#$10000,(a2)+
0088686A 069A 0000 C000             		addi.l	#$C000,(a2)+
00886870 069A 0000 8000             		addi.l	#$8000,(a2)+
00886876 3038 A800                  		move.w	($FFFFA800).w,d0
0088687A D078 F718                  		add.w	($FFFFF718).w,d0
0088687E 4440                       		neg.w	d0
00886880 323C 001F                  		move.w	#$1F,d1
00886884 9244                       		sub.w	d4,d1
00886886 6500                       		bcs.s	loc_633C
00886888                            loc_6336:		
00886888 22C0                       		move.l	d0,(a1)+
0088688A 51C9 FFFC                  		dbra	d1,loc_6336
0088688E                            loc_633C:
0088688E 3038 A804                  		move.w	($FFFFA804).w,d0
00886892 D078 F718                  		add.w	($FFFFF718).w,d0
00886896 4440                       		neg.w	d0
00886898 323C 000F                  		move.w	#$F,d1
0088689C                            loc_634A:		
0088689C 22C0                       		move.l	d0,(a1)+
0088689E 51C9 FFFC                  		dbra	d1,loc_634A
008868A2 3038 A808                  		move.w	($FFFFA808).w,d0
008868A6 D078 F718                  		add.w	($FFFFF718).w,d0
008868AA 4440                       		neg.w	d0
008868AC 323C 000F                  		move.w	#$F,d1
008868B0                            loc_635E:		
008868B0 22C0                       		move.l	d0,(a1)+
008868B2 51C9 FFFC                  		dbra	d1,loc_635E
008868B6 323C 002F                  		move.w	#$2F,d1
008868BA 3038 F718                  		move.w	($FFFFF718).w,d0
008868BE 4440                       		neg.w	d0
008868C0                            loc_636E:		
008868C0 22C0                       		move.l	d0,(a1)+
008868C2 51C9 FFFC                  		dbra	d1,loc_636E
008868C6 323C 0027                  		move.w	#$27,d1
008868CA 3038 F710                  		move.w	($FFFFF710).w,d0
008868CE 4440                       		neg.w	d0
008868D0                            loc_637E:		
008868D0 22C0                       		move.l	d0,(a1)+
008868D2 51C9 FFFC                  		dbra	d1,loc_637E
008868D6 3038 F710                  		move.w	($FFFFF710).w,d0
008868DA 3438 F700                  		move.w	(v_screenposx).w,d2
008868DE 9440                       		sub.w	d0,d2
008868E0 48C2                       		ext.l	d2
008868E2 E182                       		asl.l	#8,d2
008868E4 85FC 0068                  		divs.w	#$68,d2
008868E8 48C2                       		ext.l	d2
008868EA E182                       		asl.l	#8,d2
008868EC 7600                       		moveq	#0,d3
008868EE 3600                       		move.w	d0,d3
008868F0 323C 0047                  		move.w	#$47,d1
008868F4 D244                       		add.w	d4,d1
008868F6                            loc_63A4:		
008868F6 3003                       		move.w	d3,d0
008868F8 4440                       		neg.w	d0
008868FA 22C0                       		move.l	d0,(a1)+
008868FC 4843                       		swap.w	d3
008868FE D682                       		add.l	d2,d3
00886900 4843                       		swap.w	d3
00886902 51C9 FFF2                  		dbra	d1,loc_63A4
00886906 4E75                       		rts
00886908                            ; End of function Deform_GHZ
00886908                            
00886908                            ; ---------------------------------------------------------------------------
00886908                            ; Labyrinth Zone background layer deformation code
00886908                            ; ---------------------------------------------------------------------------
00886908                            
00886908                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886908                            
00886908                            
00886908                            Deform_LZ:				; XREF: Deform_Index
00886908 3838 F73A                  		move.w	(v_scrshiftx).w,d4
0088690C 48C4                       		ext.l	d4
0088690E EF84                       		asl.l	#7,d4
00886910 3A38 F73C                  		move.w	($FFFFF73C).w,d5
00886914 48C5                       		ext.l	d5
00886916 EF85                       		asl.l	#7,d5
00886918 6100 0000                  		bsr	ScrollBlock1
0088691C 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00886922 47F9 0000 0000             		lea	(Lz_Scroll_Data),a3
00886928 45F9 0000 0000             		lea	(Drown_WobbleData),a2
0088692E 1438 F7D8                  		move.b	($FFFFF7D8).w,d2
00886932 1602                       		move.b	d2,d3
00886934 0678 0080 F7D8             		addi.w	#$80,($FFFFF7D8).w
0088693A D478 F70C                  		add.w	($FFFFF70C).w,d2
0088693E 0242 00FF                  		andi.w	#$FF,d2
00886942 D678 F704                  		add.w	(v_screenposy).w,d3
00886946 0243 00FF                  		andi.w	#$FF,d3
0088694A 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
0088694E 323C 00DF                  		move.w	#$DF,d1
00886952 3038 F700                  		move.w	(v_screenposx).w,d0
00886956 4440                       		neg.w	d0
00886958 3C00                       		move.w	d0,d6
0088695A 4840                       		swap.w	d0
0088695C 3038 F708                  		move.w	($FFFFF708).w,d0
00886960 4440                       		neg.w	d0
00886962 3838 F646                  		move.w	(v_waterpos1).w,d4
00886966 3A38 F704                  		move.w	(v_screenposy).w,d5
0088696A                            loc_6418:		
0088696A BA44                       		cmp.w	d4,d5
0088696C 6C00                       		bge.s	loc_642A
0088696E 22C0                       		move.l	d0,(a1)+
00886970 5245                       		addq.w	#1,d5
00886972 5202                       		addq.b	#1,d2
00886974 5203                       		addq.b	#1,d3
00886976 51C9 FFF2                  		dbra	d1,loc_6418
0088697A 4E75                       		rts
0088697C                            loc_642A:
0088697C 1833 3000                  		move.b	(a3,d3),d4
00886980 4884                       		ext.w	d4
00886982 D846                       		add.w	d6,d4
00886984 32C4                       		move.w	d4,(a1)+
00886986 1832 2000                  		move.b	(a2,d2),d4
0088698A 4884                       		ext.w	d4
0088698C D840                       		add.w	d0,d4
0088698E 32C4                       		move.w	d4,(a1)+
00886990 5202                       		addq.b	#1,d2
00886992 5203                       		addq.b	#1,d3
00886994 51C9 FFE6                  		dbra	d1,loc_642A
00886998 4E75                       		rts
0088699A                            
0088699A                            Lz_Scroll_Data:
0088699A 0101 0202 0303 0303 0202+  		dc.b $01,$01,$02,$02,$03,$03,$03,$03,$02,$02,$01,$01,$00,$00,$00,$00
008869AA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
008869BA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
008869CA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
008869DA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
008869EA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
008869FA 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A0A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A1A FFFF FEFE FDFD FDFD FEFE+  		dc.b $FF,$FF,$FE,$FE,$FD,$FD,$FD,$FD,$FE,$FE,$FF,$FF,$00,$00,$00,$00
00886A2A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A3A 0101 0202 0303 0303 0202+  		dc.b $01,$01,$02,$02,$03,$03,$03,$03,$02,$02,$01,$01,$00,$00,$00,$00
00886A4A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A5A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A6A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A7A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A8A 0000 0000 0000 0000 0000+  		dc.b $00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00,$00
00886A9A                            ; End of function Deform_LZ
00886A9A                            
00886A9A                            ; ---------------------------------------------------------------------------
00886A9A                            ; Marble Zone background layer deformation code
00886A9A                            ; ---------------------------------------------------------------------------
00886A9A                            
00886A9A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886A9A                            
00886A9A                            
00886A9A                            Deform_MZ:				; XREF: Deform_Index
00886A9A 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886A9E 48C4                       		ext.l	d4
00886AA0 ED84                       		asl.l	#6,d4
00886AA2 2204                       		move.l	d4,d1
00886AA4 E384                       		asl.l	#1,d4
00886AA6 D881                       		add.l	d1,d4
00886AA8 7C02                       		moveq	#2,d6
00886AAA 6100 0000                  		bsr	ScrollBlock3
00886AAE 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886AB2 48C4                       		ext.l	d4
00886AB4 ED84                       		asl.l	#6,d4
00886AB6 7C06                       		moveq	#6,d6
00886AB8 6100 0000                  		bsr	ScrollBlock5
00886ABC 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886AC0 48C4                       		ext.l	d4
00886AC2 EF84                       		asl.l	#7,d4
00886AC4 7C04                       		moveq	#4,d6
00886AC6 6100 0000                  		bsr	ScrollBlock4
00886ACA 303C 0200                  		move.w	#$200,d0
00886ACE 3238 F704                  		move.w	(v_screenposy).w,d1
00886AD2 0441 01C8                  		subi.w	#$1C8,d1
00886AD6 6500                       		bcs.s	loc_6590
00886AD8 3401                       		move.w	d1,d2
00886ADA D241                       		add.w	d1,d1
00886ADC D242                       		add.w	d2,d1
00886ADE E441                       		asr.w	#2,d1
00886AE0 D041                       		add.w	d1,d0
00886AE2                            loc_6590:
00886AE2 31C0 F714                  		move.w	d0,($FFFFF714).w
00886AE6 31C0 F71C                  		move.w	d0,($FFFFF71C).w
00886AEA 6100 0000                  		bsr	ScrollBlock2
00886AEE 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00886AF4 1038 F756                  		move.b	(v_bgscroll2).w,d0
00886AF8 8038 F758                  		or.b	(v_bgscroll3).w,d0
00886AFC 8138 F75A                  		or.b	d0,($FFFFF75A).w
00886B00 4238 F756                  		clr.b	(v_bgscroll2).w
00886B04 4238 F758                  		clr.b	(v_bgscroll3).w
00886B08 43F8 A800                  		lea	($FFFFA800).w,a1
00886B0C 3438 F700                  		move.w	(v_screenposx).w,d2
00886B10 4442                       		neg.w	d2
00886B12 3002                       		move.w	d2,d0
00886B14 E440                       		asr.w	#2,d0
00886B16 9042                       		sub.w	d2,d0
00886B18 48C0                       		ext.l	d0
00886B1A E780                       		asl.l	#3,d0
00886B1C 81FC 0005                  		divs.w	#5,d0
00886B20 48C0                       		ext.l	d0
00886B22 E980                       		asl.l	#4,d0
00886B24 E180                       		asl.l	#8,d0
00886B26 7600                       		moveq	#0,d3
00886B28 3602                       		move.w	d2,d3
00886B2A E243                       		asr.w	#1,d3
00886B2C 323C 0004                  		move.w	#4,d1
00886B30                            loc_65DE:		
00886B30 32C3                       		move.w	d3,(a1)+
00886B32 4843                       		swap.w	d3
00886B34 D680                       		add.l	d0,d3
00886B36 4843                       		swap.w	d3
00886B38 51C9 FFF6                  		dbra	d1,loc_65DE
00886B3C 3038 F718                  		move.w	($FFFFF718).w,d0
00886B40 4440                       		neg.w	d0
00886B42 323C 0001                  		move.w	#1,d1
00886B46                            loc_65F4:		
00886B46 32C0                       		move.w	d0,(a1)+
00886B48 51C9 FFFC                  		dbra	d1,loc_65F4
00886B4C 3038 F710                  		move.w	($FFFFF710).w,d0
00886B50 4440                       		neg.w	d0
00886B52 323C 0008                  		move.w	#8,d1
00886B56                            loc_6604:		
00886B56 32C0                       		move.w	d0,(a1)+
00886B58 51C9 FFFC                  		dbra	d1,loc_6604
00886B5C 3038 F708                  		move.w	($FFFFF708).w,d0
00886B60 4440                       		neg.w	d0
00886B62 323C 000F                  		move.w	#$F,d1
00886B66                            loc_6614:		
00886B66 32C0                       		move.w	d0,(a1)+
00886B68 51C9 FFFC                  		dbra	d1,loc_6614
00886B6C 45F8 A800                  		lea	($FFFFA800).w,a2
00886B70 3038 F70C                  		move.w	($FFFFF70C).w,d0
00886B74 0440 0200                  		subi.w	#$200,d0
00886B78 3400                       		move.w	d0,d2
00886B7A 0C40 0100                  		cmpi.w	#$100,d0
00886B7E 6500                       		bcs.s	loc_6632
00886B80 303C 0100                  		move.w	#$100,d0
00886B84                            loc_6632:
00886B84 0240 01F0                  		andi.w	#$1F0,d0
00886B88 E648                       		lsr.w	#3,d0
00886B8A 45F2 0000                  		lea	(a2,d0),a2
00886B8E 6000 0000                  		bra	Bg_Scroll_X
00886B92                            ; End of function Deform_MZ
00886B92                            
00886B92                            ; ---------------------------------------------------------------------------
00886B92                            ; Star Light Zone background layer deformation code
00886B92                            ; ---------------------------------------------------------------------------
00886B92                            
00886B92                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886B92                            
00886B92                            
00886B92                            Deform_SLZ:				; XREF: Deform_Index
00886B92 3A38 F73C                  		move.w	($FFFFF73C).w,d5
00886B96 48C5                       		ext.l	d5
00886B98 EF85                       		asl.l	#7,d5
00886B9A 6100 0000                  		bsr	Bg_Scroll_Y
00886B9E 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00886BA4 43F8 A800                  		lea	($FFFFA800).w,a1
00886BA8 3438 F700                  		move.w	(v_screenposx).w,d2
00886BAC 4442                       		neg.w	d2
00886BAE 3002                       		move.w	d2,d0
00886BB0 E640                       		asr.w	#3,d0
00886BB2 9042                       		sub.w	d2,d0
00886BB4 48C0                       		ext.l	d0
00886BB6 E980                       		asl.l	#4,d0
00886BB8 81FC 001C                  		divs.w	#$1C,d0
00886BBC 48C0                       		ext.l	d0
00886BBE E980                       		asl.l	#4,d0
00886BC0 E180                       		asl.l	#8,d0
00886BC2 7600                       		moveq	#0,d3
00886BC4 3602                       		move.w	d2,d3
00886BC6 323C 001B                  		move.w	#$1B,d1
00886BCA                            loc_6678:		
00886BCA 32C3                       		move.w	d3,(a1)+
00886BCC 4843                       		swap.w	d3
00886BCE D680                       		add.l	d0,d3
00886BD0 4843                       		swap.w	d3
00886BD2 51C9 FFF6                  		dbra	d1,loc_6678
00886BD6 3002                       		move.w	d2,d0
00886BD8 E640                       		asr.w	#3,d0
00886BDA 3200                       		move.w	d0,d1
00886BDC E241                       		asr.w	#1,d1
00886BDE D041                       		add.w	d1,d0
00886BE0 323C 0004                  		move.w	#4,d1
00886BE4                            loc_6692:		
00886BE4 32C0                       		move.w	d0,(a1)+
00886BE6 51C9 FFFC                  		dbra	d1,loc_6692
00886BEA 3002                       		move.w	d2,d0
00886BEC E440                       		asr.w	#2,d0
00886BEE 323C 0004                  		move.w	#4,d1
00886BF2                            loc_66A0:		
00886BF2 32C0                       		move.w	d0,(a1)+
00886BF4 51C9 FFFC                  		dbra	d1,loc_66A0
00886BF8 3002                       		move.w	d2,d0
00886BFA E240                       		asr.w	#1,d0
00886BFC 323C 001D                  		move.w	#$1D,d1
00886C00                            loc_66AE:		
00886C00 32C0                       		move.w	d0,(a1)+
00886C02 51C9 FFFC                  		dbra	d1,loc_66AE
00886C06 45F8 A800                  		lea	($FFFFA800).w,a2
00886C0A 3038 F70C                  		move.w	($FFFFF70C).w,d0
00886C0E 3400                       		move.w	d0,d2
00886C10 0440 00C0                  		subi.w	#$C0,d0
00886C14 0240 03F0                  		andi.w	#$3F0,d0
00886C18 E648                       		lsr.w	#3,d0
00886C1A 45F2 0000                  		lea	(a2,d0),a2
00886C1E                            ;-------------------------------------------------------------------------------
00886C1E                            ;-------------------------------------------------------------------------------
00886C1E                            Bg_Scroll_X:
00886C1E 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
00886C22 323C 000E                  		move.w	#$E,d1
00886C26 3038 F700                  		move.w	(v_screenposx).w,d0
00886C2A 4440                       		neg.w	d0
00886C2C 4840                       		swap.w	d0
00886C2E 0242 000F                  		andi.w	#$F,d2
00886C32 D442                       		add.w	d2,d2
00886C34 301A                       		move.w	(a2)+,d0
00886C36 4EFB 2000                  		jmp	loc_66EA(pc,d2)
00886C3A                            Loop_Bg_Scroll_X:
00886C3A 301A                       		move.w	(a2)+,d0
00886C3C                            loc_66EA:		
00886C3C 22C0                       		move.l	d0,(a1)+
00886C3E 22C0                       		move.l	d0,(a1)+
00886C40 22C0                       		move.l	d0,(a1)+
00886C42 22C0                       		move.l	d0,(a1)+
00886C44 22C0                       		move.l	d0,(a1)+
00886C46 22C0                       		move.l	d0,(a1)+
00886C48 22C0                       		move.l	d0,(a1)+
00886C4A 22C0                       		move.l	d0,(a1)+
00886C4C 22C0                       		move.l	d0,(a1)+
00886C4E 22C0                       		move.l	d0,(a1)+
00886C50 22C0                       		move.l	d0,(a1)+
00886C52 22C0                       		move.l	d0,(a1)+
00886C54 22C0                       		move.l	d0,(a1)+
00886C56 22C0                       		move.l	d0,(a1)+
00886C58 22C0                       		move.l	d0,(a1)+
00886C5A 22C0                       		move.l	d0,(a1)+
00886C5C 51C9 FFDC                  		dbra	d1,Loop_Bg_Scroll_X
00886C60 4E75                       		rts
00886C62                            
00886C62                            ; ---------------------------------------------------------------------------
00886C62                            ; Spring Yard Zone background layer deformation	code
00886C62                            ; ---------------------------------------------------------------------------
00886C62                            
00886C62                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886C62                            
00886C62                            
00886C62                            Deform_SYZ:				; XREF: Deform_Index
00886C62 3A38 F73C                  		move.w	($FFFFF73C).w,d5
00886C66 48C5                       		ext.l	d5
00886C68 E985                       		asl.l	#4,d5
00886C6A 2205                       		move.l	d5,d1
00886C6C E385                       		asl.l	#1,d5
00886C6E DA81                       		add.l	d1,d5
00886C70 6100 0000                  		bsr	Bg_Scroll_Y
00886C74 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00886C7A 43F8 A800                  		lea	($FFFFA800).w,a1
00886C7E 3438 F700                  		move.w	(v_screenposx).w,d2
00886C82 4442                       		neg.w	d2
00886C84 3002                       		move.w	d2,d0
00886C86 E640                       		asr.w	#3,d0
00886C88 9042                       		sub.w	d2,d0
00886C8A 48C0                       		ext.l	d0
00886C8C E780                       		asl.l	#3,d0
00886C8E 81FC 0008                  		divs.w	#8,d0
00886C92 48C0                       		ext.l	d0
00886C94 E980                       		asl.l	#4,d0
00886C96 E180                       		asl.l	#8,d0
00886C98 7600                       		moveq	#0,d3
00886C9A 3602                       		move.w	d2,d3
00886C9C E243                       		asr.w	#1,d3
00886C9E 323C 0007                  		move.w	#7,d1
00886CA2                            loc_6750:		
00886CA2 32C3                       		move.w	d3,(a1)+
00886CA4 4843                       		swap.w	d3
00886CA6 D680                       		add.l	d0,d3
00886CA8 4843                       		swap.w	d3
00886CAA 51C9 FFF6                  		dbra	d1,loc_6750
00886CAE 3002                       		move.w	d2,d0
00886CB0 E640                       		asr.w	#3,d0
00886CB2 323C 0004                  		move.w	#4,d1
00886CB6                            loc_6764:		
00886CB6 32C0                       		move.w	d0,(a1)+
00886CB8 51C9 FFFC                  		dbra	d1,loc_6764
00886CBC 3002                       		move.w	d2,d0
00886CBE E440                       		asr.w	#2,d0
00886CC0 323C 0005                  		move.w	#5,d1
00886CC4                            loc_6772:		
00886CC4 32C0                       		move.w	d0,(a1)+
00886CC6 51C9 FFFC                  		dbra	d1,loc_6772
00886CCA 3002                       		move.w	d2,d0
00886CCC 3202                       		move.w	d2,d1
00886CCE E241                       		asr.w	#1,d1
00886CD0 9041                       		sub.w	d1,d0
00886CD2 48C0                       		ext.l	d0
00886CD4 E980                       		asl.l	#4,d0
00886CD6 81FC 000E                  		divs.w	#$E,d0
00886CDA 48C0                       		ext.l	d0
00886CDC E980                       		asl.l	#4,d0
00886CDE E180                       		asl.l	#8,d0
00886CE0 7600                       		moveq	#0,d3
00886CE2 3602                       		move.w	d2,d3
00886CE4 E243                       		asr.w	#1,d3
00886CE6 323C 000D                  		move.w	#$D,d1
00886CEA                            loc_6798:		
00886CEA 32C3                       		move.w	d3,(a1)+
00886CEC 4843                       		swap.w	d3
00886CEE D680                       		add.l	d0,d3
00886CF0 4843                       		swap.w	d3
00886CF2 51C9 FFF6                  		dbra	d1,loc_6798
00886CF6 45F8 A800                  		lea	($FFFFA800).w,a2
00886CFA 3038 F70C                  		move.w	($FFFFF70C).w,d0
00886CFE 3400                       		move.w	d0,d2
00886D00 0240 01F0                  		andi.w	#$1F0,d0
00886D04 E648                       		lsr.w	#3,d0
00886D06 45F2 0000                  		lea	(a2,d0),a2
00886D0A 6000 FF12                  		bra	Bg_Scroll_X
00886D0E                            ; End of function Deform_SYZ
00886D0E                            
00886D0E                            ; ---------------------------------------------------------------------------
00886D0E                            ; Scrap	Brain Zone background layer deformation	code
00886D0E                            ; ---------------------------------------------------------------------------
00886D0E                            
00886D0E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886D0E                            
00886D0E                            
00886D0E                            Deform_SBZ:				; XREF: Deform_Index
00886D0E 4A38 FE11                  		tst.b	(v_act).w
00886D12 6600 0000                  		bne	Bg_Scroll_SBz_2
00886D16 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886D1A 48C4                       		ext.l	d4
00886D1C EF84                       		asl.l	#7,d4
00886D1E 7C02                       		moveq	#2,d6
00886D20 6100 0000                  		bsr	ScrollBlock3
00886D24 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886D28 48C4                       		ext.l	d4
00886D2A ED84                       		asl.l	#6,d4
00886D2C 7C06                       		moveq	#6,d6
00886D2E 6100 0000                  		bsr	ScrollBlock5
00886D32 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886D36 48C4                       		ext.l	d4
00886D38 EB84                       		asl.l	#5,d4
00886D3A 2204                       		move.l	d4,d1
00886D3C E384                       		asl.l	#1,d4
00886D3E D881                       		add.l	d1,d4
00886D40 7C04                       		moveq	#4,d6
00886D42 6100 0000                  		bsr	ScrollBlock4
00886D46 7800                       		moveq	#0,d4
00886D48 3A38 F73C                  		move.w	($FFFFF73C).w,d5
00886D4C 48C5                       		ext.l	d5
00886D4E EB85                       		asl.l	#5,d5
00886D50 6100 0000                  		bsr	loc_6AF8
00886D54 3038 F70C                  		move.w	($FFFFF70C).w,d0
00886D58 31C0 F714                  		move.w	d0,($FFFFF714).w
00886D5C 31C0 F71C                  		move.w	d0,($FFFFF71C).w
00886D60 31C0 F618                  		move.w	d0,($FFFFF618).w
00886D64 1038 F756                  		move.b	(v_bgscroll2).w,d0
00886D68 8038 F75A                  		or.b	($FFFFF75A).w,d0
00886D6C 8138 F758                  		or.b	d0,(v_bgscroll3).w
00886D70 4238 F756                  		clr.b	(v_bgscroll2).w
00886D74 4238 F75A                  		clr.b	($FFFFF75A).w
00886D78 43F8 A800                  		lea	($FFFFA800).w,a1
00886D7C 3438 F700                  		move.w	(v_screenposx).w,d2
00886D80 4442                       		neg.w	d2
00886D82 E442                       		asr.w	#2,d2
00886D84 3002                       		move.w	d2,d0
00886D86 E240                       		asr.w	#1,d0
00886D88 9042                       		sub.w	d2,d0
00886D8A 48C0                       		ext.l	d0
00886D8C E780                       		asl.l	#3,d0
00886D8E 81FC 0004                  		divs.w	#4,d0
00886D92 48C0                       		ext.l	d0
00886D94 E980                       		asl.l	#4,d0
00886D96 E180                       		asl.l	#8,d0
00886D98 7600                       		moveq	#0,d3
00886D9A 3602                       		move.w	d2,d3
00886D9C 323C 0003                  		move.w	#3,d1
00886DA0                            loc_684E:		
00886DA0 32C3                       		move.w	d3,(a1)+
00886DA2 4843                       		swap.w	d3
00886DA4 D680                       		add.l	d0,d3
00886DA6 4843                       		swap.w	d3
00886DA8 51C9 FFF6                  		dbra	d1,loc_684E
00886DAC 3038 F718                  		move.w	($FFFFF718).w,d0
00886DB0 4440                       		neg.w	d0
00886DB2 323C 0009                  		move.w	#9,d1
00886DB6                            loc_6864:		
00886DB6 32C0                       		move.w	d0,(a1)+
00886DB8 51C9 FFFC                  		dbra	d1,loc_6864
00886DBC 3038 F710                  		move.w	($FFFFF710).w,d0
00886DC0 4440                       		neg.w	d0
00886DC2 323C 0006                  		move.w	#6,d1
00886DC6                            loc_6874:		
00886DC6 32C0                       		move.w	d0,(a1)+
00886DC8 51C9 FFFC                  		dbra	d1,loc_6874
00886DCC 3038 F708                  		move.w	($FFFFF708).w,d0
00886DD0 4440                       		neg.w	d0
00886DD2 323C 000A                  		move.w	#$A,d1
00886DD6                            loc_6884:		
00886DD6 32C0                       		move.w	d0,(a1)+
00886DD8 51C9 FFFC                  		dbra	d1,loc_6884
00886DDC 45F8 A800                  		lea	($FFFFA800).w,a2
00886DE0 3038 F70C                  		move.w	($FFFFF70C).w,d0
00886DE4 3400                       		move.w	d0,d2
00886DE6 0240 01F0                  		andi.w	#$1F0,d0
00886DEA E648                       		lsr.w	#3,d0
00886DEC 45F2 0000                  		lea	(a2,d0),a2
00886DF0 6000 FE2C                  		bra	Bg_Scroll_X
00886DF4                            ;-------------------------------------------------------------------------------
00886DF4                            Bg_Scroll_SBz_2:;loc_68A2:
00886DF4 3838 F73A                  		move.w	(v_scrshiftx).w,d4
00886DF8 48C4                       		ext.l	d4		
00886DFA ED84                       		asl.l	#6,d4
00886DFC 3A38 F73C                  		move.w	($FFFFF73C).w,d5
00886E00 48C5                       		ext.l	d5
00886E02 EB85                       		asl.l	#5,d5
00886E04 6100 0000                  		bsr	ScrollBlock1
00886E08 31F8 F70C F618             		move.w	($FFFFF70C).w,($FFFFF618).w
00886E0E 43F8 CC00                  		lea	(v_hscrolltablebuffer).w,a1
00886E12 323C 00DF                  		move.w	#223,d1
00886E16 3038 F700                  		move.w	(v_screenposx).w,d0
00886E1A 4440                       		neg.w	d0
00886E1C 4840                       		swap.w	d0
00886E1E 3038 F708                  		move.w	($FFFFF708).w,d0
00886E22 4440                       		neg.w	d0
00886E24                            loc_68D2:		
00886E24 22C0                       		move.l	d0,(a1)+
00886E26 51C9 FFFC                  		dbra	d1,loc_68D2
00886E2A 4E75                       		rts
00886E2C                            ; End of function Deform_SBZ
00886E2C                            
00886E2C                            ; ---------------------------------------------------------------------------
00886E2C                            ; Subroutine to	scroll the level horizontally as Sonic moves
00886E2C                            ; ---------------------------------------------------------------------------
00886E2C                            
00886E2C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886E2C                            
00886E2C                            
00886E2C                            ScrollHoriz:				; XREF: DeformLayers
00886E2C 3838 F700                  		move.w	(v_screenposx).w,d4 ; save old screen position
00886E30 6100                       		bsr.s	MoveScreenHoriz
00886E32 3038 F700                  		move.w	(v_screenposx).w,d0
00886E36 0240 0010                  		andi.w	#$10,d0
00886E3A 1238 F74A                  		move.b	($FFFFF74A).w,d1
00886E3E B300                       		eor.b	d1,d0
00886E40 6600                       		bne.s	locret_65B0
00886E42 0A38 0010 F74A             		eori.b	#$10,($FFFFF74A).w
00886E48 3038 F700                  		move.w	(v_screenposx).w,d0
00886E4C 9044                       		sub.w	d4,d0		; compare new with old screen position
00886E4E 6A00                       		bpl.s	SH_Forward
00886E50                            
00886E50 08F8 0002 F754             		bset	#2,(v_bgscroll1).w ; screen moves backward
00886E56 4E75                       		rts	
00886E58                            
00886E58                            	SH_Forward:
00886E58 08F8 0003 F754             		bset	#3,(v_bgscroll1).w ; screen moves forward
00886E5E                            
00886E5E                            locret_65B0:
00886E5E 4E75                       		rts	
00886E60                            ; End of function ScrollHoriz
00886E60                            
00886E60                            
00886E60                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886E60                            
00886E60                            
00886E60                            MoveScreenHoriz:			; XREF: ScrollHoriz
00886E60                            
00886E60 1238 FEB3                  		move.b	(v_cameralag).w,d1
00886E64 6700                       		beq.s	@cont1
00886E66 4A78 D010                  		tst.w	(v_player+obVelX).w	; is Sonic moving horizontally?
00886E6A 6600                       		bne.s	@cont0
00886E6C 4238 FEB3                  		clr.b	(v_cameralag).w	; clear lag
00886E70 6000                       		bra.s	@cont1
00886E72                            	
00886E72                            	@cont0:
00886E72 0401 0001                  		sub.b	#1,d1
00886E76 11C1 FEB3                  		move.b	d1,(v_cameralag).w
00886E7A E509                       		lsl.b	#2,d1
00886E7C 5801                       		addq.b	#4,d1
00886E7E 3038 F7A8                  		move.w	(v_trackpos).w,d0
00886E82 9001                       		sub.b	d1,d0
00886E84 43F8 CB00                  		lea	(v_tracksonic).w,a1
00886E88 3031 0000                  		move.w	(a1,d0.w),d0
00886E8C 0240 3FFF                  		and.w	#$3FFF,d0
00886E90 6000                       		bra.s	@cont2
00886E92                            
00886E92                            	@cont1:
00886E92 3038 D008                  		move.w	(v_player+obX).w,d0
00886E96                            
00886E96                            	@cont2:
00886E96 9078 F700                  		sub.w	(v_screenposx).w,d0 ; Sonic's distance from left edge of screen
00886E9A                            		
00886E9A 0440 0090                  		subi.w	#144,d0		; is distance less than 144px?
00886E9E 6500                       		bcs.s	SH_BehindMid	; if yes, branch
00886EA0 0440 0010                  		subi.w	#16,d0		; is distance more than 160px?
00886EA4 6400                       		bcc.s	SH_AheadOfMid	; if yes, branch
00886EA6 4278 F73A                  		clr.w	(v_scrshiftx).w
00886EAA 4E75                       		rts	
00886EAC                            ; ===========================================================================
00886EAC                            
00886EAC                            SH_AheadOfMid:
00886EAC 0C40 0010                  		cmpi.w	#16,d0		; is Sonic within 16px of middle area?
00886EB0 6500                       		bcs.s	SH_Ahead16	; if yes, branch
00886EB2 303C 0010                  		move.w	#16,d0		; set to 16 if greater
00886EB6                            
00886EB6                            	SH_Ahead16:
00886EB6 D078 F700                  		add.w	(v_screenposx).w,d0
00886EBA B078 F72A                  		cmp.w	(v_limitright2).w,d0
00886EBE 6D00                       		blt.s	SH_SetScreen
00886EC0 3038 F72A                  		move.w	(v_limitright2).w,d0
00886EC4                            
00886EC4                            SH_SetScreen:
00886EC4 3200                       		move.w	d0,d1
00886EC6 9278 F700                  		sub.w	(v_screenposx).w,d1
00886ECA E141                       		asl.w	#8,d1
00886ECC 31C0 F700                  		move.w	d0,(v_screenposx).w ; set new screen position
00886ED0 31C1 F73A                  		move.w	d1,(v_scrshiftx).w ; set distance for screen movement
00886ED4 4E75                       		rts	
00886ED6                            ; ===========================================================================
00886ED6                            
00886ED6                            SH_BehindMid:
00886ED6                            
00886ED6 0C40 FFF0                  		cmpi.w	#-$10,d0
00886EDA 6E00                       		bgt.s	@cont
00886EDC 303C FFF0                  		move.w	#-$10,d0	
00886EE0                            
00886EE0                            	@cont:
00886EE0                            	
00886EE0 D078 F700                  		add.w	(v_screenposx).w,d0
00886EE4 B078 F728                  		cmp.w	(v_limitleft2).w,d0
00886EE8 6EDA                       		bgt.s	SH_SetScreen
00886EEA 3038 F728                  		move.w	(v_limitleft2).w,d0
00886EEE 60D4                       		bra.s	SH_SetScreen
00886EF0                            ; End of function MoveScreenHoriz
00886EF0                            
00886EF0                            ; ===========================================================================
00886EF0 4A40                       		tst.w	d0
00886EF2 6A00                       		bpl.s	loc_6610
00886EF4 303C FFFE                  		move.w	#-2,d0
00886EF8 60DC                       		bra.s	SH_BehindMid
00886EFA                            
00886EFA                            loc_6610:
00886EFA 303C 0002                  		move.w	#2,d0
00886EFE 60AC                       		bra.s	SH_AheadOfMid
00886F00                            
00886F00                            ; ---------------------------------------------------------------------------
00886F00                            ; Subroutine to	scroll the level vertically as Sonic moves
00886F00                            ; ---------------------------------------------------------------------------
00886F00                            
00886F00                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00886F00                            
00886F00                            
00886F00                            ScrollVertical:				; XREF: DeformLayers
00886F00 7200                       		moveq	#0,d1
00886F02 3038 D00C                  		move.w	(v_player+obY).w,d0
00886F06 9078 F704                  		sub.w	(v_screenposy).w,d0 ; Sonic's distance from top of screen
00886F0A 0838 0002 D022             		btst	#2,(v_player+obStatus).w ; is Sonic rolling?
00886F10 6700                       		beq.s	SV_NotRolling	; if not, branch
00886F12 5B40                       		subq.w	#5,d0
00886F14                            
00886F14                            	SV_NotRolling:
00886F14 0838 0001 D022             		btst	#1,(v_player+obStatus).w ; is Sonic jumping?
00886F1A 6700                       		beq.s	loc_664A	; if not, branch
00886F1C                            
00886F1C 0640 0020                  		addi.w	#32,d0
00886F20 9078 F73E                  		sub.w	(v_lookshift).w,d0
00886F24 6500                       		bcs.s	loc_6696
00886F26 0440 0040                  		subi.w	#64,d0
00886F2A 6400                       		bcc.s	loc_6696
00886F2C 4A38 F75C                  		tst.b	(f_bgscrollvert).w
00886F30 6600                       		bne.s	loc_66A8
00886F32 6000                       		bra.s	loc_6656
00886F34                            ; ===========================================================================
00886F34                            
00886F34                            loc_664A:
00886F34 9078 F73E                  		sub.w	(v_lookshift).w,d0
00886F38 6600                       		bne.s	loc_665C
00886F3A 4A38 F75C                  		tst.b	(f_bgscrollvert).w
00886F3E 6600                       		bne.s	loc_66A8
00886F40                            
00886F40                            loc_6656:
00886F40 4278 F73C                  		clr.w	($FFFFF73C).w
00886F44 4E75                       		rts	
00886F46                            ; ===========================================================================
00886F46                            
00886F46                            loc_665C:
00886F46 0C78 0060 F73E             		cmpi.w	#$60,(v_lookshift).w
00886F4C 6600                       		bne.s	loc_6684
00886F4E 3238 D014                  		move.w	(v_player+obInertia).w,d1
00886F52 6A00                       		bpl.s	loc_666C
00886F54 4441                       		neg.w	d1
00886F56                            
00886F56                            loc_666C:
00886F56 0C41 0800                  		cmpi.w	#$800,d1
00886F5A 6400                       		bcc.s	loc_6696
00886F5C 323C 0600                  		move.w	#$600,d1
00886F60 0C40 0006                  		cmpi.w	#6,d0
00886F64 6E00                       		bgt.s	loc_66F6
00886F66 0C40 FFFA                  		cmpi.w	#-6,d0
00886F6A 6D00                       		blt.s	loc_66C0
00886F6C 6000                       		bra.s	loc_66AEa
00886F6E                            ; ===========================================================================
00886F6E                            
00886F6E                            loc_6684:
00886F6E 323C 0200                  		move.w	#$200,d1
00886F72 0C40 0002                  		cmpi.w	#2,d0
00886F76 6E00                       		bgt.s	loc_66F6
00886F78 0C40 FFFE                  		cmpi.w	#-2,d0
00886F7C 6D00                       		blt.s	loc_66C0
00886F7E 6000                       		bra.s	loc_66AEa
00886F80                            ; ===========================================================================
00886F80                            
00886F80                            loc_6696:
00886F80 323C 1000                  		move.w	#$1000,d1
00886F84 0C40 0010                  		cmpi.w	#$10,d0
00886F88 6E00                       		bgt.s	loc_66F6
00886F8A 0C40 FFF0                  		cmpi.w	#-$10,d0
00886F8E 6D00                       		blt.s	loc_66C0
00886F90 6000                       		bra.s	loc_66AEa
00886F92                            ; ===========================================================================
00886F92                            
00886F92                            loc_66A8:
00886F92 7000                       		moveq	#0,d0
00886F94 11C0 F75C                  		move.b	d0,(f_bgscrollvert).w
00886F98                            
00886F98                            loc_66AEa:
00886F98 7200                       		moveq	#0,d1
00886F9A 3200                       		move.w	d0,d1
00886F9C D278 F704                  		add.w	(v_screenposy).w,d1
00886FA0 4A40                       		tst.w	d0
00886FA2 6A00 0000                  		bpl.w	loc_6700
00886FA6 6000 0000                  		bra.w	loc_66CC
00886FAA                            ; ===========================================================================
00886FAA                            
00886FAA                            loc_66C0:
00886FAA 4441                       		neg.w	d1
00886FAC 48C1                       		ext.l	d1
00886FAE E181                       		asl.l	#8,d1
00886FB0 D2B8 F704                  		add.l	(v_screenposy).w,d1
00886FB4 4841                       		swap	d1
00886FB6                            
00886FB6                            loc_66CC:
00886FB6 B278 F72C                  		cmp.w	(v_limittop2).w,d1
00886FBA 6E00                       		bgt.s	loc_6724
00886FBC 0C41 FF00                  		cmpi.w	#-$100,d1
00886FC0 6E00                       		bgt.s	loc_66F0
00886FC2 0241 07FF                  		andi.w	#$7FF,d1
00886FC6 0278 07FF D00C             		andi.w	#$7FF,(v_player+obY).w
00886FCC 0278 07FF F704             		andi.w	#$7FF,(v_screenposy).w
00886FD2 0278 03FF F70C             		andi.w	#$3FF,($FFFFF70C).w
00886FD8 6000                       		bra.s	loc_6724
00886FDA                            ; ===========================================================================
00886FDA                            
00886FDA                            loc_66F0:
00886FDA 3238 F72C                  		move.w	(v_limittop2).w,d1
00886FDE 6000                       		bra.s	loc_6724
00886FE0                            ; ===========================================================================
00886FE0                            
00886FE0                            loc_66F6:
00886FE0 48C1                       		ext.l	d1
00886FE2 E181                       		asl.l	#8,d1
00886FE4 D2B8 F704                  		add.l	(v_screenposy).w,d1
00886FE8 4841                       		swap	d1
00886FEA                            
00886FEA                            loc_6700:
00886FEA B278 F72E                  		cmp.w	(v_limitbtm2).w,d1
00886FEE 6D00                       		blt.s	loc_6724
00886FF0 0441 0800                  		subi.w	#$800,d1
00886FF4 6500                       		bcs.s	loc_6720
00886FF6 0278 07FF D00C             		andi.w	#$7FF,(v_player+obY).w
00886FFC 0478 0800 F704             		subi.w	#$800,(v_screenposy).w
00887002 0278 03FF F70C             		andi.w	#$3FF,($FFFFF70C).w
00887008 6000                       		bra.s	loc_6724
0088700A                            ; ===========================================================================
0088700A                            
0088700A                            loc_6720:
0088700A 3238 F72E                  		move.w	(v_limitbtm2).w,d1
0088700E                            
0088700E                            loc_6724:
0088700E 3838 F704                  		move.w	(v_screenposy).w,d4
00887012 4841                       		swap	d1
00887014 2601                       		move.l	d1,d3
00887016 96B8 F704                  		sub.l	(v_screenposy).w,d3
0088701A E09B                       		ror.l	#8,d3
0088701C 31C3 F73C                  		move.w	d3,($FFFFF73C).w
00887020 21C1 F704                  		move.l	d1,(v_screenposy).w
00887024 3038 F704                  		move.w	(v_screenposy).w,d0
00887028 0240 0010                  		andi.w	#$10,d0
0088702C 1238 F74B                  		move.b	($FFFFF74B).w,d1
00887030 B300                       		eor.b	d1,d0
00887032 6600                       		bne.s	locret_6766
00887034 0A38 0010 F74B             		eori.b	#$10,($FFFFF74B).w
0088703A 3038 F704                  		move.w	(v_screenposy).w,d0
0088703E 9044                       		sub.w	d4,d0
00887040 6A00                       		bpl.s	loc_6760
00887042 08F8 0000 F754             		bset	#0,(v_bgscroll1).w
00887048 4E75                       		rts	
0088704A                            ; ===========================================================================
0088704A                            
0088704A                            loc_6760:
0088704A 08F8 0001 F754             		bset	#1,(v_bgscroll1).w
00887050                            
00887050                            locret_6766:
00887050 4E75                       		rts	
00887052                            ; End of function ScrollVertical
00887052                            
00887052                            
00887052                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887052                            
00887052                            
00887052                            ScrollBlock1:				; XREF: Deform_GHZ; et al
00887052 2438 F708                  		move.l	($FFFFF708).w,d2
00887056 2002                       		move.l	d2,d0
00887058 D084                       		add.l	d4,d0
0088705A 21C0 F708                  		move.l	d0,($FFFFF708).w
0088705E 2200                       		move.l	d0,d1
00887060 4841                       		swap.w	d1
00887062 0241 0010                  		andi.w	#$10,d1
00887066 1638 F74C                  		move.b	($FFFFF74C).w,d3
0088706A B701                       		eor.b	d3,d1
0088706C 6600                       		bne.s	loc_6AF8
0088706E 0A38 0010 F74C             		eori.b	#$10,($FFFFF74C).w
00887074 9082                       		sub.l	d2,d0
00887076 6A00                       		bpl.s	loc_6AF2
00887078 08F8 0002 F756             		bset	#2,(v_bgscroll2).w
0088707E 6000                       		bra.s	loc_6AF8
00887080                            loc_6AF2:
00887080 08F8 0003 F756             		bset	#3,(v_bgscroll2).w
00887086                            loc_6AF8:
00887086 2638 F70C                  		move.l	($FFFFF70C).w,d3
0088708A 2003                       		move.l	d3,d0
0088708C D085                       		add.l	d5,d0
0088708E 21C0 F70C                  		move.l	d0,($FFFFF70C).w
00887092 2200                       		move.l	d0,d1
00887094 4841                       		swap.w	d1
00887096 0241 0010                  		andi.w	#$10,d1
0088709A 1438 F74D                  		move.b	($FFFFF74D).w,d2
0088709E B501                       		eor.b	d2,d1
008870A0 6600                       		bne.s	loc_6B2C
008870A2 0A38 0010 F74D             		eori.b	#$10,($FFFFF74D).w
008870A8 9083                       		sub.l	d3,d0
008870AA 6A00                       		bpl.s	loc_6B26
008870AC 08F8 0000 F756             		bset	#0,(v_bgscroll2).w
008870B2 4E75                       		rts
008870B4                            loc_6B26:
008870B4 08F8 0001 F756             		bset	#1,(v_bgscroll2).w
008870BA                            loc_6B2C:
008870BA 4E75                       		rts
008870BC                            ; End of function ScrollBlock1
008870BC                            
008870BC                            Bg_Scroll_Y:
008870BC 2638 F70C                  		move.l	($FFFFF70C).w,d3
008870C0 2003                       		move.l	d3,d0
008870C2 D085                       		add.l	d5,d0
008870C4 21C0 F70C                  		move.l	d0,($FFFFF70C).w
008870C8 2200                       		move.l	d0,d1
008870CA 4841                       		swap.w	d1
008870CC 0241 0010                  		andi.w	#$10,d1
008870D0 1438 F74D                  		move.b	($FFFFF74D).w,d2
008870D4 B501                       		eor.b	d2,d1
008870D6 6600                       		bne.s	Exit_Bg_Scroll_Y
008870D8 0A38 0010 F74D             		eori.b	#$10,($FFFFF74D).w
008870DE 9083                       		sub.l	d3,d0
008870E0 6A00                       		bpl.s	loc_6B5C
008870E2 08F8 0004 F756             		bset	#4,(v_bgscroll2).w
008870E8 4E75                       		rts
008870EA                            loc_6B5C:
008870EA 08F8 0005 F756             		bset	#5,(v_bgscroll2).w
008870F0                            Exit_Bg_Scroll_Y:
008870F0 4E75                       		rts
008870F2                            
008870F2                            
008870F2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008870F2                            
008870F2                            
008870F2                            ScrollBlock2:				; XREF: Deform_SLZ
008870F2 3638 F70C                  		move.w	($FFFFF70C).w,d3
008870F6 31C0 F70C                  		move.w	d0,($FFFFF70C).w
008870FA 3200                       		move.w	d0,d1
008870FC 0241 0010                  		andi.w	#$10,d1
00887100 1438 F74D                  		move.b	($FFFFF74D).w,d2
00887104 B501                       		eor.b	d2,d1
00887106 6600                       		bne.s	Exit_Scroll_Block2
00887108 0A38 0010 F74D             		eori.b	#$10,($FFFFF74D).w
0088710E 9043                       		sub.w	d3,d0
00887110 6A00                       		bpl.s	loc_6B8C
00887112 08F8 0000 F756             		bset	#0,(v_bgscroll2).w
00887118 4E75                       		rts
0088711A                            loc_6B8C:
0088711A 08F8 0001 F756             		bset	#1,(v_bgscroll2).w
00887120                            Exit_Scroll_Block2:
00887120 4E75                       		rts
00887122                            ; End of function ScrollBlock2
00887122                            
00887122                            
00887122                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887122                            
00887122                            
00887122                            ScrollBlock3:				; XREF: Deform_GHZ; et al
00887122 2438 F708                  		move.l	($FFFFF708).w,d2
00887126 2002                       		move.l	d2,d0
00887128 D084                       		add.l	d4,d0
0088712A 21C0 F708                  		move.l	d0,($FFFFF708).w
0088712E 2200                       		move.l	d0,d1
00887130 4841                       		swap.w	d1
00887132 0241 0010                  		andi.w	#$10,d1
00887136 1638 F74C                  		move.b	($FFFFF74C).w,d3
0088713A B701                       		eor.b	d3,d1
0088713C 6600                       		bne.s	Exit_Scroll_Block3
0088713E 0A38 0010 F74C             		eori.b	#$10,($FFFFF74C).w
00887144 9082                       		sub.l	d2,d0
00887146 6A00                       		bpl.s	loc_6BC0
00887148 0DF8 F756                  		bset	d6,(v_bgscroll2).w
0088714C 6000                       		bra.s	Exit_Scroll_Block3
0088714E                            loc_6BC0:
0088714E 5206                       		addq.b	#1,d6
00887150 0DF8 F756                  		bset	d6,(v_bgscroll2).w
00887154                            Exit_Scroll_Block3:
00887154 4E75                       		rts
00887156                            ; End of function ScrollBlock3
00887156                            
00887156                            
00887156                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887156                            
00887156                            
00887156                            ScrollBlock4:				; XREF: Deform_GHZ
00887156 2438 F710                  		move.l	($FFFFF710).w,d2
0088715A 2002                       		move.l	d2,d0
0088715C D084                       		add.l	d4,d0
0088715E 21C0 F710                  		move.l	d0,($FFFFF710).w
00887162 2200                       		move.l	d0,d1
00887164 4841                       		swap.w	d1
00887166 0241 0010                  		andi.w	#$10,d1
0088716A 1638 F74E                  		move.b	($FFFFF74E).w,d3
0088716E B701                       		eor.b	d3,d1
00887170 6600                       		bne.s	Exit_Scroll_Block4
00887172 0A38 0010 F74E             		eori.b	#$10,($FFFFF74E).w
00887178 9082                       		sub.l	d2,d0
0088717A 6A00                       		bpl.s	loc_6BF4
0088717C 0DF8 F758                  		bset	d6,(v_bgscroll3).w
00887180 6000                       		bra.s	Exit_Scroll_Block4
00887182                            loc_6BF4:
00887182 5206                       		addq.b	#1,d6
00887184 0DF8 F758                  		bset	d6,(v_bgscroll3).w
00887188                            Exit_Scroll_Block4:
00887188 4E75                       		rts
0088718A                            ;-------------------------------------------------------------------------------
0088718A                            ScrollBlock5:
0088718A 2438 F718                  		move.l	($FFFFF718).w,d2
0088718E 2002                       		move.l	d2,d0
00887190 D084                       		add.l	d4,d0
00887192 21C0 F718                  		move.l	d0,($FFFFF718).w
00887196 2200                       		move.l	d0,d1
00887198 4841                       		swap.w	d1
0088719A 0241 0010                  		andi.w	#$10,d1
0088719E 1638 F750                  		move.b	($FFFFF750).w,d3
008871A2 B701                       		eor.b	d3,d1
008871A4 6600                       		bne.s	loc_6C2E
008871A6 0A38 0010 F750             		eori.b	#$10,($FFFFF750).w
008871AC 9082                       		sub.l	d2,d0
008871AE 6A00                       		bpl.s	loc_6C28
008871B0 0DF8 F75A                  		bset	d6,($FFFFF75A).w
008871B4 6000                       		bra.s	loc_6C2E
008871B6                            loc_6C28:
008871B6 5206                       		addq.b	#1,d6
008871B8 0DF8 F75A                  		bset	d6,($FFFFF75A).w
008871BC                            loc_6C2E:
008871BC 4E75                       		rts
008871BC 4E75                       		rts
008871BE                            
008871BE                            
008871BE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008871BE                            
008871BE                            
008871BE                            sub_6886:				; XREF: VBla_04
008871BE 4BF9 00C0 0004             		lea	(vdp_control_port).l,a5
008871C4 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
008871CA 45F8 F756                  		lea	(v_bgscroll2).w,a2
008871CE 47F8 F708                  		lea	($FFFFF708).w,a3
008871D2 49F8 A440                  		lea	(v_lvllayout+$40).w,a4
008871D6 343C 6000                  		move.w	#$6000,d2
008871DA 6100 0000                  		bsr.w	sub_6954
008871DE 45F8 F758                  		lea	(v_bgscroll3).w,a2
008871E2 47F8 F710                  		lea	($FFFFF710).w,a3
008871E6 6000 0000                  		bra.w	sub_69F4
008871EA                            ; End of function sub_6886
008871EA                            
008871EA                            ; ---------------------------------------------------------------------------
008871EA                            ; Subroutine to	display	correct	tiles as you move
008871EA                            ; ---------------------------------------------------------------------------
008871EA                            
008871EA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008871EA                            
008871EA                            
008871EA                            LoadTilesAsYouMove:			; XREF: Demo_Time
008871EA 4BF9 00C0 0004             		lea	(vdp_control_port).l,a5
008871F0 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
008871F6 45F8 FF32                  		lea	($FFFFFF32).w,a2
008871FA 47F8 FF18                  		lea	($FFFFFF18).w,a3
008871FE 49F8 A440                  		lea	(v_lvllayout+$40).w,a4
00887202 343C 6000                  		move.w	#$6000,d2
00887206 6100 0000                  		bsr.w	sub_6954
0088720A 45F8 FF34                  		lea	($FFFFFF34).w,a2
0088720E 47F8 FF20                  		lea	($FFFFFF20).w,a3
00887212 6100 0000                  		bsr.w	sub_69F4
00887216                            	
00887216 45F8 FF36                  		lea	($FFFFFF36).w,a2
0088721A 47F8 FF28                  		lea	($FFFFFF28).w,a3
0088721E 6100 0000                  		bsr.w	locj_6EA4
00887222                            
00887222 45F8 FF30                  		lea	($FFFFFF30).w,a2
00887226 47F8 FF10                  		lea	($FFFFFF10).w,a3
0088722A 49F8 A400                  		lea	(v_lvllayout).w,a4
0088722E 343C 4000                  		move.w	#$4000,d2
00887232 4A12                       		tst.b	(a2)
00887234 6700                       		beq.s	locret_6952
00887236 0892 0000                  		bclr	#0,(a2)
0088723A 6700                       		beq.s	loc_6908
0088723C 78F0                       		moveq	#-$10,d4
0088723E 7AF0                       		moveq	#-$10,d5
00887240 6100 0000                  		bsr.w	Calc_VRAM_Pos
00887244 78F0                       		moveq	#-$10,d4
00887246 7AF0                       		moveq	#-$10,d5
00887248 6100 0000                  		bsr.w	DrawTiles_LR
0088724C                            
0088724C                            loc_6908:
0088724C 0892 0001                  		bclr	#1,(a2)
00887250 6700                       		beq.s	loc_6922
00887252 383C 00E0                  		move.w	#$E0,d4
00887256 7AF0                       		moveq	#-$10,d5
00887258 6100 0000                  		bsr.w	Calc_VRAM_Pos
0088725C 383C 00E0                  		move.w	#$E0,d4
00887260 7AF0                       		moveq	#-$10,d5
00887262 6100 0000                  		bsr.w	DrawTiles_LR
00887266                            
00887266                            loc_6922:
00887266 0892 0002                  		bclr	#2,(a2)
0088726A 6700                       		beq.s	loc_6938
0088726C 78F0                       		moveq	#-$10,d4
0088726E 7AF0                       		moveq	#-$10,d5
00887270 6100 0000                  		bsr.w	Calc_VRAM_Pos
00887274 78F0                       		moveq	#-$10,d4
00887276 7AF0                       		moveq	#-$10,d5
00887278 6100 0000                  		bsr.w	DrawTiles_TB
0088727C                            
0088727C                            loc_6938:
0088727C 0892 0003                  		bclr	#3,(a2)
00887280 6700                       		beq.s	locret_6952
00887282 78F0                       		moveq	#-$10,d4
00887284 3A3C 0140                  		move.w	#$140,d5
00887288 6100 0000                  		bsr.w	Calc_VRAM_Pos
0088728C 78F0                       		moveq	#-$10,d4
0088728E 3A3C 0140                  		move.w	#$140,d5
00887292 6100 0000                  		bsr.w	DrawTiles_TB
00887296                            
00887296                            locret_6952:
00887296 4E75                       		rts	
00887298                            ; End of function LoadTilesAsYouMove
00887298                            
00887298                            
00887298                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887298                            
00887298                            
00887298                            sub_6954:				; XREF: sub_6886; LoadTilesAsYouMove
00887298 4A12                       		tst.b	(a2)
0088729A 6700 0000                  		beq.w	locret_69F2
0088729E 0892 0000                  		bclr	#0,(a2)
008872A2 6700                       		beq.s	loc_6972
008872A4 78F0                       		moveq	#-$10,d4
008872A6 7AF0                       		moveq	#-$10,d5
008872A8 6100 0000                  		bsr.w	Calc_VRAM_Pos
008872AC 78F0                       		moveq	#-$10,d4
008872AE 7AF0                       		moveq	#-$10,d5
008872B0                            
008872B0 6100 0000                  		bsr.w	DrawTiles_LR
008872B4                            
008872B4                            
008872B4                            loc_6972:
008872B4 0892 0001                  		bclr	#1,(a2)
008872B8 6700                       		beq.s	loc_698E
008872BA 383C 00E0                  		move.w	#$E0,d4
008872BE 7AF0                       		moveq	#-$10,d5
008872C0 6100 0000                  		bsr.w	Calc_VRAM_Pos
008872C4 383C 00E0                  		move.w	#$E0,d4
008872C8 7AF0                       		moveq	#-$10,d5
008872CA                            
008872CA 6100 0000                  		bsr.w	DrawTiles_LR
008872CE                            
008872CE                            loc_698E:
008872CE 0892 0002                  		bclr	#2,(a2)
008872D2                            
008872D2 6700                       		beq.s	locj_6D56
008872D4 78F0                       		moveq	#-$10,d4
008872D6 7AF0                       		moveq	#-$10,d5
008872D8 6100 0000                  		bsr.w	Calc_VRAM_Pos
008872DC 78F0                       		moveq	#-$10,d4
008872DE 7AF0                       		moveq	#-$10,d5
008872E0 6100 0000                  		bsr	DrawTiles_TB
008872E4                            locj_6D56:
008872E4 0892 0003                  		bclr	#3,(a2)
008872E8 6700                       		beq.s	locj_6D70
008872EA 78F0                       		moveq	#-$10,d4
008872EC 3A3C 0140                  		move.w	#$140,d5
008872F0 6100 0000                  		bsr	Calc_VRAM_Pos
008872F4 78F0                       		moveq	#-$10,d4
008872F6 3A3C 0140                  		move.w	#$140,d5
008872FA 6100 0000                  		bsr	DrawTiles_TB
008872FE                            locj_6D70:
008872FE 0892 0004                  		bclr	#4,(a2)
00887302 6700                       		beq.s	locj_6D88
00887304 78F0                       		moveq	#-$10,d4
00887306 7A00                       		moveq	#$00,d5
00887308 6100 0000                  		bsr	Calc_VRAM_Pos_2
0088730C 78F0                       		moveq	#-$10,d4
0088730E 7A00                       		moveq	#0,d5
00887310 7C1F                       		moveq	#$1F,d6
00887312 6100 0000                  		bsr	DrawTiles_LR_3
00887316                            locj_6D88:
00887316 0892 0005                  		bclr	#5,(a2)
0088731A 6700                       		beq.s	locret_69F2
0088731C 383C 00E0                  		move.w	#$00E0,d4
00887320 7A00                       		moveq	#0,d5
00887322 6100 0000                  		bsr	Calc_VRAM_Pos_2
00887326 383C 00E0                  		move.w	#$E0,d4
0088732A 7A00                       		moveq	#0,d5
0088732C 7C1F                       		moveq	#$1F,d6
0088732E 6100 0000                  		bsr	DrawTiles_LR_3
00887332                            
00887332                            locret_69F2:
00887332 4E75                       		rts	
00887334                            ; End of function sub_6954
00887334                            
00887334                            
00887334                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887334                            
00887334                            
00887334                            sub_69F4:				; XREF: sub_6886; LoadTilesAsYouMove
00887334 4A12                       			tst.b	(a2)
00887336 6700 0000                  			beq	locj_6DF2
0088733A 0C38 0005 FE10             			cmpi.b	#id_SBZ,(v_zone).w
00887340 6700 0000                  			beq	Draw_SBz
00887344 0892 0000                  			bclr	#0,(a2)
00887348 6700                       			beq.s	locj_6DD2
0088734A 383C 0070                  			move.w	#$70,d4
0088734E 7AF0                       			moveq	#-$10,d5
00887350 6100 0000                  			bsr	Calc_VRAM_Pos
00887354 383C 0070                  			move.w	#$70,d4
00887358 7AF0                       			moveq	#-$10,d5
0088735A 7C02                       			moveq	#2,d6
0088735C 6100 0000                  			bsr	DrawTiles_TB_2
00887360                            	locj_6DD2:
00887360 0892 0001                  			bclr	#1,(a2)
00887364 6700                       			beq.s	locj_6DF2
00887366 383C 0070                  			move.w	#$70,d4
0088736A 3A3C 0140                  			move.w	#$140,d5
0088736E 6100 0000                  			bsr	Calc_VRAM_Pos
00887372 383C 0070                  			move.w	#$70,d4
00887376 3A3C 0140                  			move.w	#$140,d5
0088737A 7C02                       			moveq	#2,d6
0088737C 6100 0000                  			bsr	DrawTiles_TB_2
00887380                            	locj_6DF2:
00887380 4E75                       			rts
00887382                            	locj_6DF4:
00887382 0000 0000 0006 0606 0606+  			dc.b $00,$00,$00,$00,$00,$06,$06,$06,$06,$06,$06,$06,$06,$06,$06,$04
00887392 0404 0404 0404 0202 0202+  			dc.b $04,$04,$04,$04,$04,$04,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008873A2 0200                       			dc.b $02,$00						
008873A4                            ;===============================================================================
008873A4                            	Draw_SBz:
008873A4 78F0                       			moveq	#-$10,d4
008873A6 0892 0000                  			bclr	#0,(a2)
008873AA 6600                       			bne.s	locj_6E28
008873AC 0892 0001                  			bclr	#1,(a2)
008873B0 6700                       			beq.s	locj_6E72
008873B2 383C 00E0                  			move.w	#$E0,d4
008873B6                            	locj_6E28:
008873B6 41F9 0088 7383             			lea	(locj_6DF4+1),A0
008873BC 3038 F70C                  			move.w	($FFFFF70C).w,d0
008873C0 D044                       			add.w	d4,d0
008873C2 0240 01F0                  			andi.w	#$1F0,d0
008873C6 E848                       			lsr.w	#4,d0
008873C8 1030 0000                  			move.b	(a0,d0),d0
008873CC 47F9 0000 0000             			lea	(locj_6FE4),a3
008873D2 3673 0000                  			move.w	(a3,d0),a3
008873D6 6700                       			beq.s	locj_6E5E
008873D8 7AF0                       			moveq	#-$10,d5
008873DA 48E7 0C00                  			movem.l	d4/d5,-(sp)
008873DE 6100 0000                  			bsr	Calc_VRAM_Pos
008873E2 4CDF 0030                  			movem.l	(sp)+,d4/d5
008873E6 6100 0000                  			bsr	DrawTiles_LR
008873EA 6000                       			bra.s	locj_6E72
008873EC                            ;===============================================================================
008873EC                            	locj_6E5E:
008873EC 7A00                       			moveq	#0,d5
008873EE 48E7 0C00                  			movem.l	d4/d5,-(sp)
008873F2 6100 0000                  			bsr	Calc_VRAM_Pos_2
008873F6 4CDF 0030                  			movem.l	(sp)+,d4/d5
008873FA 7C1F                       			moveq	#$1F,d6
008873FC 6100 0000                  			bsr	DrawTiles_LR_3
00887400                            	locj_6E72:
00887400 4A12                       			tst.b	(a2)
00887402 6600                       			bne.s	locj_6E78
00887404 4E75                       			rts
00887406                            ;===============================================================================			
00887406                            	locj_6E78:
00887406 78F0                       			moveq	#-$10,d4
00887408 7AF0                       			moveq	#-$10,d5
0088740A 1012                       			move.b	(a2),d0
0088740C 0200 00A8                  			andi.b	#$A8,d0
00887410 6700                       			beq.s	locj_6E8C
00887412 E208                       			lsr.b	#1,d0
00887414 1480                       			move.b	d0,(a2)
00887416 3A3C 0140                  			move.w	#$140,d5
0088741A                            	locj_6E8C:
0088741A 41F9 0088 7382             			lea	(locj_6DF4),a0
00887420 3038 F70C                  			move.w	($FFFFF70C).w,d0
00887424 0240 01F0                  			andi.w	#$1F0,d0
00887428 E848                       			lsr.w	#4,d0
0088742A 41F0 0000                  			lea	(a0,d0),a0
0088742E 6000 0000                  			bra	locj_6FEC						
00887432                            ;===============================================================================
00887432                            
00887432                            
00887432                            
00887432                            	locj_6EA4:
00887432 4A12                       			tst.b	(a2)
00887434 6700 0000                  			beq	locj_6EF0
00887438 0C38 0002 FE10             			cmpi.b	#id_MZ,(v_zone).w
0088743E 6700 0000                  			beq	Draw_Mz
00887442 0892 0000                  			bclr	#0,(a2)
00887446 6700                       			beq.s	locj_6ED0
00887448 383C 0040                  			move.w	#$40,d4
0088744C 7AF0                       			moveq	#-$10,d5
0088744E 6100 0000                  			bsr	Calc_VRAM_Pos
00887452 383C 0040                  			move.w	#$40,d4
00887456 7AF0                       			moveq	#-$10,d5
00887458 7C02                       			moveq	#2,d6
0088745A 6100 0000                  			bsr	DrawTiles_TB_2
0088745E                            	locj_6ED0:
0088745E 0892 0001                  			bclr	#1,(a2)
00887462 6700                       			beq.s	locj_6EF0
00887464 383C 0040                  			move.w	#$40,d4
00887468 3A3C 0140                  			move.w	#$140,d5
0088746C 6100 0000                  			bsr	Calc_VRAM_Pos
00887470 383C 0040                  			move.w	#$40,d4
00887474 3A3C 0140                  			move.w	#$140,d5
00887478 7C02                       			moveq	#2,d6
0088747A 6100 0000                  			bsr	DrawTiles_TB_2
0088747E                            	locj_6EF0:
0088747E 4E75                       			rts
00887480                            	locj_6EF2:
00887480 0000 0000 0000 0606 0404+  			dc.b $00,$00,$00,$00,$00,$00,$06,$06,$04,$04,$04,$04,$04,$04,$04,$04
00887490 0402 0202 0202 0202 0202+  			dc.b $04,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008874A0 0202 0202 0202 0202 0202+  			dc.b $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008874B0 0202 0202 0202 0202 0202+  			dc.b $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008874C0 0202 0202 0202 0202 0202+  			dc.b $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008874D0 0202 0202 0202 0202 0202+  			dc.b $02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02,$02
008874E0 0200                       			dc.b $02,$00
008874E2                            ;===============================================================================
008874E2                            	Draw_Mz:
008874E2 78F0                       			moveq	#-$10,d4
008874E4 0892 0000                  			bclr	#0,(a2)
008874E8 6600                       			bne.s	locj_6F66
008874EA 0892 0001                  			bclr	#1,(a2)
008874EE 6700                       			beq.s	locj_6FAE
008874F0 383C 00E0                  			move.w	#$E0,d4
008874F4                            	locj_6F66:
008874F4 41F9 0088 7481             			lea	(locj_6EF2+1),a0
008874FA 3038 F70C                  			move.w	($FFFFF70C).w,d0
008874FE 0440 0200                  			subi.w	#$200,d0
00887502 D044                       			add.w	d4,d0
00887504 0240 07F0                  			andi.w	#$7F0,d0
00887508 E848                       			lsr.w	#4,d0
0088750A 1030 0000                  			move.b	(a0,d0),d0
0088750E 367B 0000                  			move.w	locj_6FE4(pc,d0),a3
00887512 6700                       			beq.s	locj_6F9A
00887514 7AF0                       			moveq	#-$10,d5
00887516 48E7 0C00                  			movem.l	d4/d5,-(sp)
0088751A 6100 0000                  			bsr	Calc_VRAM_Pos
0088751E 4CDF 0030                  			movem.l	(sp)+,d4/d5
00887522 6100 0000                  			bsr	DrawTiles_LR
00887526 6000                       			bra.s	locj_6FAE
00887528                            ;===============================================================================
00887528                            	locj_6F9A:
00887528 7A00                       			moveq	#0,d5
0088752A 48E7 0C00                  			movem.l	d4/d5,-(sp)
0088752E 6100 0000                  			bsr	Calc_VRAM_Pos_2
00887532 4CDF 0030                  			movem.l	(sp)+,d4/d5
00887536 7C1F                       			moveq	#$1F,d6
00887538 6100 0000                  			bsr	DrawTiles_LR_3
0088753C                            	locj_6FAE:
0088753C 4A12                       			tst.b	(a2)
0088753E 6600                       			bne.s	locj_6FB4
00887540 4E75                       			rts
00887542                            ;===============================================================================			
00887542                            	locj_6FB4:
00887542 78F0                       			moveq	#-$10,d4
00887544 7AF0                       			moveq	#-$10,d5
00887546 1012                       			move.b	(a2),d0
00887548 0200 00A8                  			andi.b	#$A8,d0
0088754C 6700                       			beq.s	locj_6FC8
0088754E E208                       			lsr.b	#1,d0
00887550 1480                       			move.b	d0,(a2)
00887552 3A3C 0140                  			move.w	#$140,d5
00887556                            	locj_6FC8:
00887556 41F9 0088 7480             			lea	(locj_6EF2),a0
0088755C 3038 F70C                  			move.w	($FFFFF70C).w,d0
00887560 0440 0200                  			subi.w	#$200,d0
00887564 0240 07F0                  			andi.w	#$7F0,d0
00887568 E848                       			lsr.w	#4,d0
0088756A 41F0 0000                  			lea	(a0,d0),a0
0088756E 6000 0000                  			bra	locj_6FEC
00887572                            ;===============================================================================			
00887572                            	locj_6FE4:
00887572 FF18 FF18 FF20 FF28        			dc.b $FF,$18,$FF,$18,$FF,$20,$FF,$28
0088757A                            	locj_6FEC:
0088757A 7C0F                       			moveq	#$F,d6
0088757C 2E3C 0080 0000             			move.l	#$800000,d7
00887582                            	locj_6FF4:			
00887582 7000                       			moveq	#0,d0
00887584 1018                       			move.b	(a0)+,d0
00887586 0112                       			btst	d0,(a2)
00887588 6700                       			beq.s	locj_701C
0088758A 367B 00E6                  			move.w	locj_6FE4(pc,d0),a3
0088758E 48E7 0C80                  			movem.l	d4/d5/a0,-(sp)
00887592 48E7 0C00                  			movem.l	d4/d5,-(sp)
00887596 6100 0000                  			bsr	DrawBlocks
0088759A 4CDF 0030                  			movem.l	(sp)+,d4/d5
0088759E 6100 0000                  			bsr	Calc_VRAM_Pos
008875A2 6100 0000                  			bsr	DrawTiles
008875A6 4CDF 0130                  			movem.l	(sp)+,d4/d5/a0
008875AA                            	locj_701C:
008875AA 0644 0010                  			addi.w	#$10,d4
008875AE 51CE FFD2                  			dbra	d6,locj_6FF4
008875B2 4212                       			clr.b	(a2)
008875B4 4E75                       			rts			
008875B6                            
008875B6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008875B6                            
008875B6                            
008875B6                            DrawTiles_LR:				; XREF: LoadTilesAsYouMove
008875B6 7C15                       		moveq	#$15,d6
008875B8                            
008875B8                            DrawTiles_LR_2:				; XREF: sub_6954; DrawChunks
008875B8 2E3C 0080 0000             		move.l	#$800000,d7
008875BE 2200                       		move.l	d0,d1
008875C0                            
008875C0                            	@loop2:
008875C0 48E7 0C00                  		movem.l	d4-d5,-(sp)
008875C4 6100 0000                  		bsr.w	DrawBlocks
008875C8 2001                       		move.l	d1,d0
008875CA 6100 0000                  		bsr.w	DrawTiles
008875CE 5801                       		addq.b	#4,d1
008875D0 0201 007F                  		andi.b	#$7F,d1
008875D4 4CDF 0030                  		movem.l	(sp)+,d4-d5
008875D8 0645 0010                  		addi.w	#$10,d5
008875DC 51CE FFE2                  		dbf	d6,@loop2
008875E0 4E75                       		rts	
008875E2                            ; End of function DrawTiles_LR
008875E2                            
008875E2                            DrawTiles_LR_3:
008875E2 2E3C 0080 0000             		move.l	#$800000,d7
008875E8 2200                       		move.l	d0,d1
008875EA                            
008875EA                            	@loop:
008875EA 48E7 0C00                  		movem.l	d4-d5,-(sp)
008875EE 6100 0000                  		bsr.w	DrawBlocks_2
008875F2 2001                       		move.l	d1,d0
008875F4 6100 0000                  		bsr.w	DrawTiles
008875F8 5801                       		addq.b	#4,d1
008875FA 0201 007F                  		andi.b	#$7F,d1
008875FE 4CDF 0030                  		movem.l	(sp)+,d4-d5
00887602 0645 0010                  		addi.w	#$10,d5
00887606 51CE FFE2                  		dbf	d6,@loop
0088760A 4E75                       		rts	
0088760C                            ; End of function DrawTiles_LR_3
0088760C                            
0088760C                            
0088760C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088760C                            
0088760C                            
0088760C                            DrawTiles_TB:				; XREF: LoadTilesAsYouMove
0088760C 7C0F                       		moveq	#$F,d6
0088760E                            
0088760E                            DrawTiles_TB_2:				; XREF: sub_6954
0088760E 2E3C 0080 0000             		move.l	#$800000,d7
00887614 2200                       		move.l	d0,d1
00887616                            
00887616                            	@loop:
00887616 48E7 0C00                  		movem.l	d4-d5,-(sp)
0088761A 6100 0000                  		bsr.w	DrawBlocks
0088761E 2001                       		move.l	d1,d0
00887620 6100 0000                  		bsr.w	DrawTiles
00887624 0641 0100                  		addi.w	#$100,d1
00887628 0241 0FFF                  		andi.w	#$FFF,d1
0088762C 4CDF 0030                  		movem.l	(sp)+,d4-d5
00887630 0644 0010                  		addi.w	#$10,d4
00887634 51CE FFE0                  		dbf	d6,@loop
00887638 4E75                       		rts	
0088763A                            ; End of function DrawTiles_TB_2
0088763A                            
0088763A                            
0088763A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088763A                            
0088763A                            
0088763A                            DrawTiles:				; XREF: DrawTiles_LR_2; DrawTiles_TB_2
0088763A 8042                       		or.w	d2,d0
0088763C 4840                       		swap	d0
0088763E 0810 0004                  		btst	#4,(a0)
00887642 6600                       		bne.s	DrawFlipY
00887644 0810 0003                  		btst	#3,(a0)
00887648 6600                       		bne.s	DrawFlipX
0088764A 2A80                       		move.l	d0,(a5)
0088764C 2C99                       		move.l	(a1)+,(a6)
0088764E D087                       		add.l	d7,d0
00887650 2A80                       		move.l	d0,(a5)
00887652 2C99                       		move.l	(a1)+,(a6)
00887654 4E75                       		rts	
00887656                            ; ===========================================================================
00887656                            
00887656                            DrawFlipX:
00887656 2A80                       		move.l	d0,(a5)
00887658 2819                       		move.l	(a1)+,d4
0088765A 0A84 0800 0800             		eori.l	#$8000800,d4
00887660 4844                       		swap	d4
00887662 2C84                       		move.l	d4,(a6)
00887664 D087                       		add.l	d7,d0
00887666 2A80                       		move.l	d0,(a5)
00887668 2819                       		move.l	(a1)+,d4
0088766A 0A84 0800 0800             		eori.l	#$8000800,d4
00887670 4844                       		swap	d4
00887672 2C84                       		move.l	d4,(a6)
00887674 4E75                       		rts	
00887676                            ; ===========================================================================
00887676                            
00887676                            DrawFlipY:
00887676 0810 0003                  		btst	#3,(a0)
0088767A 6600                       		bne.s	DrawFlipXY
0088767C 2A80                       		move.l	d0,(a5)
0088767E 2A19                       		move.l	(a1)+,d5
00887680 2819                       		move.l	(a1)+,d4
00887682 0A84 1000 1000             		eori.l	#$10001000,d4
00887688 2C84                       		move.l	d4,(a6)
0088768A D087                       		add.l	d7,d0
0088768C 2A80                       		move.l	d0,(a5)
0088768E 0A85 1000 1000             		eori.l	#$10001000,d5
00887694 2C85                       		move.l	d5,(a6)
00887696 4E75                       		rts	
00887698                            ; ===========================================================================
00887698                            
00887698                            DrawFlipXY:
00887698 2A80                       		move.l	d0,(a5)
0088769A 2A19                       		move.l	(a1)+,d5
0088769C 2819                       		move.l	(a1)+,d4
0088769E 0A84 1800 1800             		eori.l	#$18001800,d4
008876A4 4844                       		swap	d4
008876A6 2C84                       		move.l	d4,(a6)
008876A8 D087                       		add.l	d7,d0
008876AA 2A80                       		move.l	d0,(a5)
008876AC 0A85 1800 1800             		eori.l	#$18001800,d5
008876B2 4845                       		swap	d5
008876B4 2C85                       		move.l	d5,(a6)
008876B6 4E75                       		rts	
008876B8                            ; End of function DrawTiles
008876B8                            
008876B8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008876B8                            
008876B8                            
008876B8                            DrawBlocks:				; XREF: DrawTiles_LR_2; DrawTiles_TB_2
008876B8 DA53                       		add.w	(a3),d5
008876BA                            DrawBlocks_2:
008876BA D86B 0004                  		add.w	4(a3),d4
008876BE                            			
008876BE 2279 00FF 0004             		movea.l	(v_256x256+4).l,a1
008876C4                            
008876C4                            
008876C4 3604                       		move.w	d4,d3
008876C6 E24B                       		lsr.w	#1,d3
008876C8 0243 0380                  		andi.w	#$380,d3
008876CC E64D                       		lsr.w	#3,d5
008876CE 3005                       		move.w	d5,d0
008876D0 EA48                       		lsr.w	#5,d0
008876D2 0240 007F                  		andi.w	#$7F,d0
008876D6 D043                       		add.w	d3,d0
008876D8                            		
008876D8                            
008876D8 7600                       		moveq	#0,d3
008876DA                            
008876DA 1634 0000                  		move.b	(a4,d0.w),d3
008876DE 6700                       		beq.s	locret_6C1E
008876E0 5303                       		subq.b	#1,d3
008876E2 0243 007F                  		andi.w	#$7F,d3
008876E6 EE5B                       		ror.w	#7,d3
008876E8 D844                       		add.w	d4,d4
008876EA 0244 01E0                  		andi.w	#$1E0,d4
008876EE 0245 001E                  		andi.w	#$1E,d5
008876F2 D644                       		add.w	d4,d3
008876F4 D645                       		add.w	d5,d3
008876F6                            		
008876F6                            
008876F6 D6B9 00FF 0000             		add.l	(v_256x256).l,d3
008876FC                            
008876FC 2043                       		movea.l	d3,a0
008876FE 3610                       		move.w	(a0),d3
00887700 0243 03FF                  		andi.w	#$3FF,d3
00887704 E74B                       		lsl.w	#3,d3
00887706 D2C3                       		adda.w	d3,a1
00887708                            
00887708                            locret_6C1E:
00887708 4E75                       		rts	
0088770A                            ; End of function DrawBlocks
0088770A                            
0088770A                            
0088770A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088770A                            
0088770A                            
0088770A                            Calc_VRAM_Pos:				; XREF: LoadTilesAsYouMove; et al
0088770A DA53                       		add.w	(a3),d5
0088770C                            Calc_VRAM_Pos_2:
0088770C D86B 0004                  		add.w	4(a3),d4
00887710                            
00887710 0244 00F0                  		andi.w	#$F0,d4
00887714 0245 01F0                  		andi.w	#$1F0,d5
00887718 E94C                       		lsl.w	#4,d4
0088771A E44D                       		lsr.w	#2,d5
0088771C D845                       		add.w	d5,d4
0088771E 7003                       		moveq	#3,d0
00887720 4840                       		swap	d0
00887722 3004                       		move.w	d4,d0
00887724 4E75                       		rts	
00887726                            ; End of function Calc_VRAM_Pos
00887726                            
00887726                            
00887726                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887726                            ; not used
00887726                            
00887726                            
00887726                            sub_6C3C:
00887726 D86B 0004                  		add.w	4(a3),d4
0088772A DA53                       		add.w	(a3),d5
0088772C 0244 00F0                  		andi.w	#$F0,d4
00887730 0245 01F0                  		andi.w	#$1F0,d5
00887734 E94C                       		lsl.w	#4,d4
00887736 E44D                       		lsr.w	#2,d5
00887738 D845                       		add.w	d5,d4
0088773A 7002                       		moveq	#2,d0
0088773C 4840                       		swap	d0
0088773E 3004                       		move.w	d4,d0
00887740 4E75                       		rts	
00887742                            ; End of function sub_6C3C
00887742                            
00887742                            ; ---------------------------------------------------------------------------
00887742                            ; Subroutine to	load tiles as soon as the level	appears
00887742                            ; ---------------------------------------------------------------------------
00887742                            
00887742                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887742                            
00887742                            
00887742                            LoadTilesFromStart:			; XREF: GM_Level; GM_Ending
00887742 4BF9 00C0 0004             		lea	(vdp_control_port).l,a5
00887748 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
0088774E 47F8 F700                  		lea	(v_screenposx).w,a3
00887752 49F8 A400                  		lea	(v_lvllayout).w,a4
00887756 343C 4000                  		move.w	#$4000,d2
0088775A 6100                       		bsr.s	DrawChunks
0088775C 47F8 F708                  		lea	($FFFFF708).w,a3
00887760 49F8 A440                  		lea	(v_lvllayout+$40).w,a4
00887764 343C 6000                  		move.w	#$6000,d2
00887768                            
00887768 4A38 FE10                  		tst.b	(v_zone).w
0088776C 6700 0000                  		beq	Draw_GHz_Bg
00887770 0C38 0002 FE10             		cmpi.b	#id_MZ,(v_zone).w
00887776 6700 0000                  		beq	Draw_Mz_Bg
0088777A 0C78 0500 FE10             		cmpi.w	#(id_SBZ<<8)+0,(v_zone).w
00887780 6700 0000                  		beq	Draw_SBz_Bg
00887784 0C38 0006 FE10             		cmpi.b	#id_EndZ,(v_zone).w
0088778A 6700 0000                  		beq	Draw_GHz_Bg
0088778E                            
0088778E                            ; End of function LoadTilesFromStart
0088778E                            
0088778E                            
0088778E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088778E                            
0088778E                            
0088778E                            DrawChunks:				; XREF: LoadTilesFromStart
0088778E 78F0                       		moveq	#-$10,d4
00887790 7C0F                       		moveq	#$F,d6
00887792                            
00887792                            	@loop:
00887792 48E7 0E00                  		movem.l	d4-d6,-(sp)
00887796 7A00                       		moveq	#0,d5
00887798 3204                       		move.w	d4,d1
0088779A 6100 FF6E                  		bsr.w	Calc_VRAM_Pos
0088779E 3801                       		move.w	d1,d4
008877A0 7A00                       		moveq	#0,d5
008877A2 7C1F                       		moveq	#$1F,d6
008877A4 6100 FE12                  		bsr.w	DrawTiles_LR_2
008877A8 4CDF 0070                  		movem.l	(sp)+,d4-d6
008877AC 0644 0010                  		addi.w	#$10,d4
008877B0 51CE FFE0                  		dbf	d6,@loop
008877B4 4E75                       		rts	
008877B6                            ; End of function DrawChunks
008877B6                            
008877B6                            	Draw_GHz_Bg:
008877B6 7800                       			moveq	#0,d4
008877B8 7C0F                       			moveq	#$F,d6
008877BA                            	locj_7224:			
008877BA 48E7 0E00                  			movem.l	d4-d6,-(sp)
008877BE 41F9 0000 0000             			lea	(locj_724a),a0
008877C4 3038 F70C                  			move.w	($FFFFF70C).w,d0
008877C8 D044                       			add.w	d4,d0
008877CA 0240 00F0                  			andi.w	#$F0,d0
008877CE 6100 0000                  			bsr	locj_72Ba
008877D2 4CDF 0070                  			movem.l	(sp)+,d4-d6
008877D6 0644 0010                  			addi.w	#$10,d4
008877DA 51CE FFDE                  			dbra	d6,locj_7224
008877DE 4E75                       			rts
008877E0                            	locj_724a:
008877E0 0000 0000 0606 0604 0404+  			dc.b $00,$00,$00,$00,$06,$06,$06,$04,$04,$04,$00,$00,$00,$00,$00,$00
008877F0                            ;-------------------------------------------------------------------------------
008877F0                            	Draw_Mz_Bg:;locj_725a:
008877F0 78F0                       			moveq	#-$10,d4
008877F2 7C0F                       			moveq	#$F,d6
008877F4                            	locj_725E:			
008877F4 48E7 0E00                  			movem.l	d4-d6,-(sp)
008877F8 41F9 0088 7481             			lea	(locj_6EF2+$01),a0
008877FE 3038 F70C                  			move.w	($FFFFF70C).w,d0
00887802 0440 0200                  			subi.w	#$200,d0
00887806 D044                       			add.w	d4,d0
00887808 0240 07F0                  			andi.w	#$7F0,d0
0088780C 6100 0000                  			bsr	locj_72Ba
00887810 4CDF 0070                  			movem.l	(sp)+,d4-d6
00887814 0644 0010                  			addi.w	#$10,d4
00887818 51CE FFDA                  			dbra	d6,locj_725E
0088781C 4E75                       			rts
0088781E                            ;-------------------------------------------------------------------------------
0088781E                            	Draw_SBz_Bg:;locj_7288:
0088781E 78F0                       			moveq	#-$10,d4
00887820 7C0F                       			moveq	#$F,d6
00887822                            	locj_728C:			
00887822 48E7 0E00                  			movem.l	d4-d6,-(sp)
00887826 41F9 0088 7383             			lea	(locj_6DF4+$01),a0
0088782C 3038 F70C                  			move.w	($FFFFF70C).w,d0
00887830 D044                       			add.w	d4,d0
00887832 0240 01F0                  			andi.w	#$1F0,d0
00887836 6100 0000                  			bsr	locj_72Ba
0088783A 4CDF 0070                  			movem.l	(sp)+,d4-d6
0088783E 0644 0010                  			addi.w	#$10,d4
00887842 51CE FFDE                  			dbra	d6,locj_728C
00887846 4E75                       			rts
00887848                            ;-------------------------------------------------------------------------------
00887848                            	locj_72B2:
00887848 F708 F708 F710 F718        			dc.b $F7,$08,$F7,$08,$F7,$10,$F7,$18
00887850                            	locj_72Ba:
00887850 E848                       			lsr.w	#4,d0
00887852 1030 0000                  			move.b	(a0,d0),d0
00887856 367B 00F0                  			move.w	locj_72B2(pc,d0),a3
0088785A 6700                       			beq.s	locj_72da
0088785C 7AF0                       			moveq	#-$10,d5
0088785E 48E7 0C00                  			movem.l	d4/d5,-(sp)
00887862 6100 FEA6                  			bsr	Calc_VRAM_Pos
00887866 4CDF 0030                  			movem.l	(sp)+,d4/d5
0088786A 6100 FD4A                  			bsr	DrawTiles_LR
0088786E 6000                       			bra.s	locj_72EE
00887870                            	locj_72da:
00887870 7A00                       			moveq	#0,d5
00887872 48E7 0C00                  			movem.l	d4/d5,-(sp)
00887876 6100 FE94                  			bsr	Calc_VRAM_Pos_2
0088787A 4CDF 0030                  			movem.l	(sp)+,d4/d5
0088787E 7C1F                       			moveq	#$1F,d6
00887880 6100 FD60                  			bsr	DrawTiles_LR_3
00887884                            	locj_72EE:
00887884 4E75                       			rts
00887886                            
00887886                            ; ---------------------------------------------------------------------------
00887886                            ; Subroutine to load basic level data
00887886                            ; ---------------------------------------------------------------------------
00887886                            
00887886                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887886                            
00887886                            
00887886                            LevelDataLoad:				; XREF: GM_Level; GM_Ending
00887886 7000                       		moveq	#0,d0
00887888 1038 FE10                  		move.b	(v_zone).w,d0
0088788C E948                       		lsl.w	#4,d0
0088788E 45F9 0000 0000             		lea	(LevelHeaders).l,a2
00887894 45F2 0000                  		lea	(a2,d0.w),a2
00887898 2F0A                       		move.l	a2,-(sp)
0088789A 588A                       		addq.l	#4,a2
0088789C                            		
0088789C                            
0088789C 23DA 00FF 0004             		move.l	(a2)+,(v_256x256+4).l	; store the ROM address for the block mappings
008878A2 02B9 00FF FFFF 00FF 0004   		andi.l	#$FFFFFF,(v_256x256+4).l
008878AC                            
008878AC 23DA 00FF 0000             		move.l	(a2)+,(v_256x256).l	; store the ROM address for the chunk mappings
008878B2                            
008878B2 6100 0000                  		bsr.w	LevelLayoutLoad
008878B6 301A                       		move.w	(a2)+,d0
008878B8 3012                       		move.w	(a2),d0
008878BA 0240 00FF                  		andi.w	#$FF,d0
008878BE 0C78 0103 FE10             		cmpi.w	#(id_LZ<<8)+3,(v_zone).w ; is level SBZ3 (LZ4) ?
008878C4 6600                       		bne.s	@notSBZ3	; if not, branch
008878C6 700C                       		moveq	#palid_SBZ3,d0	; use SB3 palette
008878C8                            
008878C8                            	@notSBZ3:
008878C8 0C78 0501 FE10             		cmpi.w	#(id_SBZ<<8)+1,(v_zone).w ; is level SBZ2?
008878CE 6700                       		beq.s	@isSBZorFZ	; if yes, branch
008878D0 0C78 0502 FE10             		cmpi.w	#(id_SBZ<<8)+2,(v_zone).w ; is level FZ?
008878D6 6600                       		bne.s	@normalpal	; if not, branch
008878D8                            
008878D8                            	@isSBZorFZ:
008878D8 700E                       		moveq	#palid_SBZ2,d0	; use SBZ2/FZ palette
008878DA                            
008878DA                            	@normalpal:
008878DA 6100 AE62                  		bsr.w	PalLoad1	; load palette (based on d0)
008878DE 245F                       		movea.l	(sp)+,a2
008878E0 584A                       		addq.w	#4,a2		; read number for 2nd PLC
008878E2 7000                       		moveq	#0,d0
008878E4 1012                       		move.b	(a2),d0
008878E6 6700                       		beq.s	@skipPLC	; if 2nd PLC is 0 (i.e. the ending sequence), branch
008878E8 6100 A2B8                  		bsr.w	AddPLC		; load pattern load cues
008878EC                            
008878EC                            	@skipPLC:
008878EC 4E75                       		rts	
008878EE                            ; End of function LevelDataLoad
008878EE                            
008878EE                            ; ---------------------------------------------------------------------------
008878EE                            ; Level	layout loading subroutine
008878EE                            ; ---------------------------------------------------------------------------
008878EE                            
008878EE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008878EE                            
008878EE                            
008878EE                            LevelLayoutLoad:			; XREF: GM_Title; LevelDataLoad
008878EE 47F8 A400                  		lea	(v_lvllayout).w,a3
008878F2 323C 01FF                  		move.w	#$1FF,d1
008878F6 7000                       		moveq	#0,d0
008878F8                            
008878F8                            LevLoad_ClrRam:
008878F8 26C0                       		move.l	d0,(a3)+
008878FA 51C9 FFFC                  		dbf	d1,LevLoad_ClrRam ; clear the RAM ($A400-A7FF)
008878FE                            
008878FE 47F8 A400                  		lea	(v_lvllayout).w,a3 ; RAM address for level layout
00887902 7200                       		moveq	#0,d1
00887904 6100 0000                  		bsr.w	LevelLayoutLoad2 ; load	level layout into RAM
00887908 47F8 A440                  		lea	(v_lvllayout+$40).w,a3 ; RAM address for background layout
0088790C 7202                       		moveq	#2,d1
0088790E                            ; End of function LevelLayoutLoad
0088790E                            
0088790E                            ; "LevelLayoutLoad2" is	run twice - for	the level and the background
0088790E                            
0088790E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088790E                            
0088790E                            
0088790E                            LevelLayoutLoad2:			; XREF: LevelLayoutLoad
0088790E 3038 FE10                  		move.w	(v_zone).w,d0
00887912 ED08                       		lsl.b	#6,d0
00887914 EA48                       		lsr.w	#5,d0
00887916 3400                       		move.w	d0,d2
00887918 D040                       		add.w	d0,d0
0088791A D042                       		add.w	d2,d0
0088791C D041                       		add.w	d1,d0
0088791E 43F9 0000 0000             		lea	(Level_Index).l,a1
00887924 3031 0000                  		move.w	(a1,d0.w),d0
00887928 43F1 0000                  		lea	(a1,d0.w),a1
0088792C 7200                       		moveq	#0,d1
0088792E 3401                       		move.w	d1,d2
00887930 1219                       		move.b	(a1)+,d1	; load level width (in tiles)
00887932 1419                       		move.b	(a1)+,d2	; load level height (in	tiles)
00887934                            
00887934                            LevLoad_NumRows:
00887934 3001                       		move.w	d1,d0
00887936 204B                       		movea.l	a3,a0
00887938                            
00887938                            LevLoad_Row:
00887938 10D9                       		move.b	(a1)+,(a0)+
0088793A 51C8 FFFC                  		dbf	d0,LevLoad_Row	; load 1 row
0088793E 47EB 0080                  		lea	$80(a3),a3	; do next row
00887942 51CA FFF0                  		dbf	d2,LevLoad_NumRows ; repeat for	number of rows
00887946 4E75                       		rts	
00887948                            ; End of function LevelLayoutLoad2
00887948                            
00887948                            		include	"_inc\DynamicLevelEvents.asm"
00887948                            ; ---------------------------------------------------------------------------
00887948                            ; Dynamic level events
00887948                            ; ---------------------------------------------------------------------------
00887948                            
00887948                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00887948                            
00887948                            
00887948                            DynamicLevelEvents:			; XREF: DeformLayers
00887948                            
00887948                            	;Mercury Exit DLE In Special Stage And Title
00887948 0C38 0000 F600             		cmpi.b	#id_Title,(v_gamemode).w	;exit if on the Title
0088794E 6700                       		beq.s	DLE_NoChg
00887950 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w	;exit if in a Special Stage
00887956 6700                       		beq.s	DLE_NoChg
00887958                            	;end Exit DLE In Special Stage And Title
00887958                            	
00887958 7000                       		moveq	#0,d0
0088795A 1038 FE10                  		move.b	(v_zone).w,d0
0088795E D040                       		add.w	d0,d0
00887960 303B 0000                  		move.w	DLE_Index(pc,d0.w),d0
00887964 4EBB 0000                  		jsr	DLE_Index(pc,d0.w) ; run level-specific events
00887968 7202                       		moveq	#2,d1
0088796A 3038 F726                  		move.w	(v_limitbtm1).w,d0
0088796E 9078 F72E                  		sub.w	(v_limitbtm2).w,d0 ; has lower level boundary changed recently?
00887972 6700                       		beq.s	DLE_NoChg	; if not, branch
00887974 6400                       		bcc.s	loc_6DAC
00887976                            
00887976 4441                       		neg.w	d1
00887978 3038 F704                  		move.w	(v_screenposy).w,d0
0088797C B078 F726                  		cmp.w	(v_limitbtm1).w,d0
00887980 6300                       		bls.s	loc_6DA0
00887982 31C0 F72E                  		move.w	d0,(v_limitbtm2).w
00887986 0278 FFFE F72E             		andi.w	#$FFFE,(v_limitbtm2).w
0088798C                            
0088798C                            loc_6DA0:
0088798C D378 F72E                  		add.w	d1,(v_limitbtm2).w
00887990 11FC 0001 F75C             		move.b	#1,(f_bgscrollvert).w
00887996                            
00887996                            DLE_NoChg:
00887996 4E75                       		rts	
00887998                            ; ===========================================================================
00887998                            
00887998                            loc_6DAC:
00887998 3038 F704                  		move.w	(v_screenposy).w,d0
0088799C 5040                       		addq.w	#8,d0
0088799E B078 F72E                  		cmp.w	(v_limitbtm2).w,d0
008879A2 6500                       		bcs.s	loc_6DC4
008879A4 0838 0001 D022             		btst	#1,(v_player+obStatus).w
008879AA 6700                       		beq.s	loc_6DC4
008879AC D241                       		add.w	d1,d1
008879AE D241                       		add.w	d1,d1
008879B0                            
008879B0                            loc_6DC4:
008879B0 D378 F72E                  		add.w	d1,(v_limitbtm2).w
008879B4 11FC 0001 F75C             		move.b	#1,(f_bgscrollvert).w
008879BA 4E75                       		rts	
008879BC                            ; End of function DynamicLevelEvents
008879BC                            
008879BC                            ; ===========================================================================
008879BC                            ; ---------------------------------------------------------------------------
008879BC                            ; Offset index for dynamic level events
008879BC                            ; ---------------------------------------------------------------------------
008879BC 0000 0000                  DLE_Index:	dc.w DLE_GHZ-DLE_Index, DLE_LZ-DLE_Index
008879C0 0000 0000                  		dc.w DLE_MZ-DLE_Index, DLE_SLZ-DLE_Index
008879C4 0000 0000                  		dc.w DLE_SYZ-DLE_Index, DLE_SBZ-DLE_Index
008879C8 0000                       		dc.w DLE_Ending-DLE_Index
008879CA                            ; ===========================================================================
008879CA                            ; ---------------------------------------------------------------------------
008879CA                            ; Green	Hill Zone dynamic level events
008879CA                            ; ---------------------------------------------------------------------------
008879CA                            
008879CA                            DLE_GHZ:				; XREF: DLE_Index
008879CA 7000                       		moveq	#0,d0
008879CC 1038 FE11                  		move.b	(v_act).w,d0
008879D0 D040                       		add.w	d0,d0
008879D2 303B 0000                  		move.w	DLE_GHZx(pc,d0.w),d0
008879D6 4EFB 0000                  		jmp	DLE_GHZx(pc,d0.w)
008879DA                            ; ===========================================================================
008879DA 0000                       DLE_GHZx:	dc.w DLE_GHZ1-DLE_GHZx
008879DC 0000                       		dc.w DLE_GHZ2-DLE_GHZx
008879DE 0000                       		dc.w DLE_GHZ3-DLE_GHZx
008879E0                            ; ===========================================================================
008879E0                            
008879E0                            DLE_GHZ1:
008879E0 31FC 0300 F726             		move.w	#$300,(v_limitbtm1).w ; set lower y-boundary
008879E6 31FC 0300 F72E             		move.w	#$300,(v_limitbtm2).w ; set lower y-boundary	;Mercury High Speed Camera Fix
008879EC 0C78 1780 F700             		cmpi.w	#$1780,(v_screenposx).w ; has the camera reached $1780 on x-axis?
008879F2 6500                       		bcs.s	locret_6E08	; if not, branch
008879F4 31FC 0400 F726             		move.w	#$400,(v_limitbtm1).w ; set lower y-boundary
008879FA 31FC 0400 F72E             		move.w	#$400,(v_limitbtm2).w ; set lower y-boundary	;Mercury High Speed Camera Fix
00887A00                            
00887A00                            locret_6E08:
00887A00 4E75                       		rts	
00887A02                            ; ===========================================================================
00887A02                            
00887A02                            DLE_GHZ2:
00887A02 31FC 0300 F726             		move.w	#$300,(v_limitbtm1).w
00887A08 0C78 0ED0 F700             		cmpi.w	#$ED0,(v_screenposx).w
00887A0E 6500                       		bcs.s	locret_6E3A
00887A10 31FC 0200 F726             		move.w	#$200,(v_limitbtm1).w
00887A16 0C78 1600 F700             		cmpi.w	#$1600,(v_screenposx).w
00887A1C 6500                       		bcs.s	locret_6E3A
00887A1E 31FC 0400 F726             		move.w	#$400,(v_limitbtm1).w
00887A24 0C78 1D60 F700             		cmpi.w	#$1D60,(v_screenposx).w
00887A2A 6500                       		bcs.s	locret_6E3A
00887A2C 31FC 0300 F726             		move.w	#$300,(v_limitbtm1).w
00887A32                            
00887A32                            locret_6E3A:
00887A32 4E75                       		rts	
00887A34                            ; ===========================================================================
00887A34                            
00887A34                            DLE_GHZ3:
00887A34 7000                       		moveq	#0,d0
00887A36 1038 F742                  		move.b	(v_dle_routine).w,d0
00887A3A 303B 0000                  		move.w	off_6E4A(pc,d0.w),d0
00887A3E 4EFB 0000                  		jmp	off_6E4A(pc,d0.w)
00887A42                            ; ===========================================================================
00887A42 0000                       off_6E4A:	dc.w DLE_GHZ3main-off_6E4A
00887A44 0000                       		dc.w DLE_GHZ3boss-off_6E4A
00887A46 0000                       		dc.w DLE_GHZ3end-off_6E4A
00887A48                            ; ===========================================================================
00887A48                            
00887A48                            DLE_GHZ3main:
00887A48 31FC 0300 F726             		move.w	#$300,(v_limitbtm1).w
00887A4E 0C78 0380 F700             		cmpi.w	#$380,(v_screenposx).w
00887A54 6500                       		bcs.s	locret_6E96
00887A56 31FC 0310 F726             		move.w	#$310,(v_limitbtm1).w
00887A5C 0C78 0960 F700             		cmpi.w	#$960,(v_screenposx).w
00887A62 6500                       		bcs.s	locret_6E96
00887A64 0C78 0280 F704             		cmpi.w	#$280,(v_screenposy).w
00887A6A 6500                       		bcs.s	loc_6E98
00887A6C 31FC 0400 F726             		move.w	#$400,(v_limitbtm1).w
00887A72 0C78 1380 F700             		cmpi.w	#$1380,(v_screenposx).w
00887A78 6400                       		bcc.s	loc_6E8E
00887A7A 31FC 04C0 F726             		move.w	#$4C0,(v_limitbtm1).w
00887A80 31FC 04C0 F72E             		move.w	#$4C0,(v_limitbtm2).w
00887A86                            
00887A86                            loc_6E8E:
00887A86                            	
00887A86                            	;Mercury High Speed Camera Fix
00887A86 0C78 0380 F704             		cmpi.w	#$380,(v_screenposy).w
00887A8C 6400                       		bcc.s	locret_6E96
00887A8E                            	;end High Speed Camera Fix
00887A8E                            	
00887A8E 0C78 1700 F700             		cmpi.w	#$1700,(v_screenposx).w
00887A94 6400                       		bcc.s	loc_6E98
00887A96                            
00887A96                            locret_6E96:
00887A96 4E75                       		rts	
00887A98                            ; ===========================================================================
00887A98                            
00887A98                            loc_6E98:
00887A98 31FC 0300 F726             		move.w	#$300,(v_limitbtm1).w
00887A9E 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887AA2 4E75                       		rts	
00887AA4                            ; ===========================================================================
00887AA4                            
00887AA4                            DLE_GHZ3boss:
00887AA4 0C78 0960 F700             		cmpi.w	#$960,(v_screenposx).w
00887AAA 6400                       		bcc.s	loc_6EB0
00887AAC 5538 F742                  		subq.b	#2,(v_dle_routine).w
00887AB0                            
00887AB0                            loc_6EB0:
00887AB0 0C78 2960 F700             		cmpi.w	#$2960,(v_screenposx).w
00887AB6 6500                       		bcs.s	locret_6EE8
00887AB8 6100 0000                  		bsr.w	FindFreeObj
00887ABC 6600                       		bne.s	loc_6ED0
00887ABE 137C 0000 0000             		move.b	#id_BossGreenHill,0(a1) ; load GHZ boss	object
00887AC4 337C 2A60 0008             		move.w	#$2A60,obX(a1)
00887ACA 337C 0280 000C             		move.w	#$280,obY(a1)
00887AD0                            
00887AD0                            loc_6ED0:
00887AD0 303C 000C                  		move.w	#bgm_Boss,d0
00887AD4 6100 9D66                  		bsr.w	PlaySound	; play boss music
00887AD8 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887ADE 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887AE2 7000                       		moveq	#plcid_Boss,d0
00887AE4 6000 A0BC                  		bra.w	AddPLC		; load boss patterns
00887AE8                            ; ===========================================================================
00887AE8                            
00887AE8                            locret_6EE8:
00887AE8 4E75                       		rts	
00887AEA                            ; ===========================================================================
00887AEA                            
00887AEA                            DLE_GHZ3end:
00887AEA 31F8 F700 F728             		move.w	(v_screenposx).w,(v_limitleft2).w
00887AF0 4E75                       		rts	
00887AF2                            ; ===========================================================================
00887AF2                            ; ---------------------------------------------------------------------------
00887AF2                            ; Labyrinth Zone dynamic level events
00887AF2                            ; ---------------------------------------------------------------------------
00887AF2                            
00887AF2                            DLE_LZ:				; XREF: DLE_Index
00887AF2 7000                       		moveq	#0,d0
00887AF4 1038 FE11                  		move.b	(v_act).w,d0
00887AF8 D040                       		add.w	d0,d0
00887AFA 303B 0000                  		move.w	DLE_LZx(pc,d0.w),d0
00887AFE 4EFB 0000                  		jmp	DLE_LZx(pc,d0.w)
00887B02                            ; ===========================================================================
00887B02 0000                       DLE_LZx:	dc.w DLE_LZ12-DLE_LZx
00887B04 0000                       		dc.w DLE_LZ12-DLE_LZx
00887B06 0000                       		dc.w DLE_LZ3-DLE_LZx
00887B08 0000                       		dc.w DLE_SBZ3-DLE_LZx
00887B0A                            ; ===========================================================================
00887B0A                            
00887B0A                            DLE_LZ12:
00887B0A 4E75                       		rts	
00887B0C                            ; ===========================================================================
00887B0C                            
00887B0C                            DLE_LZ3:
00887B0C 4A38 F7EF                  		tst.b	(f_switch+$F).w	; has switch $F	been pressed?
00887B10 6700                       		beq.s	loc_6F28	; if not, branch
00887B12 43F8 A506                  		lea	(v_lvllayout+$106).w,a1
00887B16 0C11 0007                  		cmpi.b	#7,(a1)
00887B1A 6700                       		beq.s	loc_6F28
00887B1C 12BC 0007                  		move.b	#7,(a1)		; modify level layout
00887B20 303C 006F                  		move.w	#sfx_Rumbling,d0
00887B24 6100 9D56                  		bsr.w	PlaySound_Special ; play rumbling sound
00887B28                            
00887B28                            loc_6F28:
00887B28 4A38 F742                  		tst.b	(v_dle_routine).w
00887B2C 6600                       		bne.s	locret_6F64
00887B2E 0C78 1CA0 F700             		cmpi.w	#$1CA0,(v_screenposx).w
00887B34 6500                       		bcs.s	locret_6F62
00887B36 0C78 0600 F704             		cmpi.w	#$600,(v_screenposy).w
00887B3C 6400                       		bcc.s	locret_6F62
00887B3E 6100 0000                  		bsr.w	FindFreeObj
00887B42 6600                       		bne.s	loc_6F4A
00887B44 137C 0000 0000             		move.b	#id_BossLabyrinth,0(a1) ; load LZ boss object
00887B4A                            
00887B4A                            loc_6F4A:
00887B4A 303C 000C                  		move.w	#bgm_Boss,d0
00887B4E 6100 9CEC                  		bsr.w	PlaySound	; play boss music
00887B52 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887B58 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887B5C 7000                       		moveq	#plcid_Boss,d0
00887B5E 6000 A042                  		bra.w	AddPLC		; load boss patterns
00887B62                            ; ===========================================================================
00887B62                            
00887B62                            locret_6F62:
00887B62 4E75                       		rts	
00887B64                            ; ===========================================================================
00887B64                            
00887B64                            locret_6F64:
00887B64 4E75                       		rts	
00887B66                            ; ===========================================================================
00887B66                            
00887B66                            DLE_SBZ3:
00887B66 0C78 0D00 F700             		cmpi.w	#$D00,(v_screenposx).w
00887B6C 6500                       		bcs.s	locret_6F8C
00887B6E 0C78 0018 D00C             		cmpi.w	#$18,(v_player+obY).w ; has Sonic reached the top of the level?
00887B74 6400                       		bcc.s	locret_6F8C	; if not, branch
00887B76 4238 FE30                  		clr.b	(v_lastlamp).w
00887B7A 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart level
00887B80 31FC 0502 FE10             		move.w	#(id_SBZ<<8)+2,(v_zone).w ; set level number to 0502 (FZ)
00887B86 11FC 0001 F7C8             		move.b	#1,(f_lockmulti).w ; freeze Sonic
00887B8C                            
00887B8C                            locret_6F8C:
00887B8C 4E75                       		rts	
00887B8E                            ; ===========================================================================
00887B8E                            ; ---------------------------------------------------------------------------
00887B8E                            ; Marble Zone dynamic level events
00887B8E                            ; ---------------------------------------------------------------------------
00887B8E                            
00887B8E                            DLE_MZ:				; XREF: DLE_Index
00887B8E 7000                       		moveq	#0,d0
00887B90 1038 FE11                  		move.b	(v_act).w,d0
00887B94 D040                       		add.w	d0,d0
00887B96 303B 0000                  		move.w	DLE_MZx(pc,d0.w),d0
00887B9A 4EFB 0000                  		jmp	DLE_MZx(pc,d0.w)
00887B9E                            ; ===========================================================================
00887B9E 0000                       DLE_MZx:	dc.w DLE_MZ1-DLE_MZx
00887BA0 0000                       		dc.w DLE_MZ2-DLE_MZx
00887BA2 0000                       		dc.w DLE_MZ3-DLE_MZx
00887BA4                            ; ===========================================================================
00887BA4                            
00887BA4                            DLE_MZ1:
00887BA4 7000                       		moveq	#0,d0
00887BA6 1038 F742                  		move.b	(v_dle_routine).w,d0
00887BAA 303B 0000                  		move.w	off_6FB2(pc,d0.w),d0
00887BAE 4EFB 0000                  		jmp	off_6FB2(pc,d0.w)
00887BB2                            ; ===========================================================================
00887BB2 0000                       off_6FB2:	dc.w loc_6FBA-off_6FB2
00887BB4 0000                       		dc.w loc_6FEA-off_6FB2
00887BB6 0000                       		dc.w loc_702E-off_6FB2
00887BB8 0000                       		dc.w loc_7050-off_6FB2
00887BBA                            ; ===========================================================================
00887BBA                            
00887BBA                            loc_6FBA:
00887BBA 31FC 01D0 F726             		move.w	#$1D0,(v_limitbtm1).w
00887BC0 0C78 0700 F700             		cmpi.w	#$700,(v_screenposx).w
00887BC6 6500                       		bcs.s	locret_6FE8
00887BC8 31FC 0220 F726             		move.w	#$220,(v_limitbtm1).w
00887BCE 0C78 0D00 F700             		cmpi.w	#$D00,(v_screenposx).w
00887BD4 6500                       		bcs.s	locret_6FE8
00887BD6 31FC 0340 F726             		move.w	#$340,(v_limitbtm1).w
00887BDC 0C78 0340 F704             		cmpi.w	#$340,(v_screenposy).w
00887BE2 6500                       		bcs.s	locret_6FE8
00887BE4 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887BE8                            
00887BE8                            locret_6FE8:
00887BE8 4E75                       		rts	
00887BEA                            ; ===========================================================================
00887BEA                            
00887BEA                            loc_6FEA:
00887BEA 0C78 0340 F704             		cmpi.w	#$340,(v_screenposy).w
00887BF0 6400                       		bcc.s	loc_6FF8
00887BF2 5538 F742                  		subq.b	#2,(v_dle_routine).w
00887BF6 4E75                       		rts	
00887BF8                            ; ===========================================================================
00887BF8                            
00887BF8                            loc_6FF8:
00887BF8 31FC 0000 F72C             		move.w	#0,(v_limittop2).w
00887BFE 0C78 0E00 F700             		cmpi.w	#$E00,(v_screenposx).w
00887C04 6400                       		bcc.s	locret_702C
00887C06 31FC 0340 F72C             		move.w	#$340,(v_limittop2).w
00887C0C 31FC 0340 F726             		move.w	#$340,(v_limitbtm1).w
00887C12 0C78 0A90 F700             		cmpi.w	#$A90,(v_screenposx).w
00887C18 6400                       		bcc.s	locret_702C
00887C1A 31FC 0500 F726             		move.w	#$500,(v_limitbtm1).w
00887C20 0C78 0370 F704             		cmpi.w	#$370,(v_screenposy).w
00887C26 6500                       		bcs.s	locret_702C
00887C28 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887C2C                            
00887C2C                            locret_702C:
00887C2C 4E75                       		rts	
00887C2E                            ; ===========================================================================
00887C2E                            
00887C2E                            loc_702E:
00887C2E 0C78 0370 F704             		cmpi.w	#$370,(v_screenposy).w
00887C34 6400                       		bcc.s	loc_703C
00887C36 5538 F742                  		subq.b	#2,(v_dle_routine).w
00887C3A 4E75                       		rts	
00887C3C                            ; ===========================================================================
00887C3C                            
00887C3C                            loc_703C:
00887C3C 0C78 0500 F704             		cmpi.w	#$500,(v_screenposy).w
00887C42 6500                       		bcs.s	locret_704E
00887C44                            
00887C44 0C78 0B80 F700             		cmpi.w	#$B80,(v_screenposx).w
00887C4A 6500                       		bcs.s	locret_704E
00887C4C                            
00887C4C 31FC 0500 F72C             		move.w	#$500,(v_limittop2).w
00887C52 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887C56                            
00887C56                            locret_704E:
00887C56 4E75                       		rts	
00887C58                            ; ===========================================================================
00887C58                            
00887C58                            loc_7050:
00887C58 0C78 0B80 F700             		cmpi.w	#$B80,(v_screenposx).w
00887C5E 6400                       		bcc.s	locj_76B8
00887C60 0C78 0340 F72C             		cmpi.w	#$340,(v_limittop2).w
00887C66 6700                       		beq.s	locret_7072
00887C68 5578 F72C                  		subq.w	#2,(v_limittop2).w
00887C6C 4E75                       		rts
00887C6E                            locj_76B8:
00887C6E 0C78 0500 F72C             		cmpi.w	#$500,(v_limittop2).w
00887C74 6700                       		beq.s	locj_76CE
00887C76 0C78 0500 F704             		cmpi.w	#$500,(v_screenposy).w
00887C7C 6500                       		bcs.s	locret_7072
00887C7E 31FC 0500 F72C             		move.w	#$500,(v_limittop2).w
00887C84                            locj_76CE:
00887C84                            
00887C84                            
00887C84 0C78 0E70 F700             		cmpi.w	#$E70,(v_screenposx).w
00887C8A 6500                       		bcs.s	locret_7072
00887C8C 31FC 0000 F72C             		move.w	#0,(v_limittop2).w
00887C92 31FC 0500 F726             		move.w	#$500,(v_limitbtm1).w
00887C98 0C78 1430 F700             		cmpi.w	#$1430,(v_screenposx).w
00887C9E 6500                       		bcs.s	locret_7072
00887CA0 31FC 0210 F726             		move.w	#$210,(v_limitbtm1).w
00887CA6                            
00887CA6                            locret_7072:
00887CA6 4E75                       		rts	
00887CA8                            ; ===========================================================================
00887CA8                            
00887CA8                            DLE_MZ2:
00887CA8 31FC 0520 F726             		move.w	#$520,(v_limitbtm1).w
00887CAE 0C78 1700 F700             		cmpi.w	#$1700,(v_screenposx).w
00887CB4 6500                       		bcs.s	locret_7088
00887CB6 31FC 0200 F726             		move.w	#$200,(v_limitbtm1).w
00887CBC                            
00887CBC                            locret_7088:
00887CBC 4E75                       		rts	
00887CBE                            ; ===========================================================================
00887CBE                            
00887CBE                            DLE_MZ3:
00887CBE 7000                       		moveq	#0,d0
00887CC0 1038 F742                  		move.b	(v_dle_routine).w,d0
00887CC4 303B 0000                  		move.w	off_7098(pc,d0.w),d0
00887CC8 4EFB 0000                  		jmp	off_7098(pc,d0.w)
00887CCC                            ; ===========================================================================
00887CCC 0000                       off_7098:	dc.w DLE_MZ3boss-off_7098
00887CCE 0000                       		dc.w DLE_MZ3end-off_7098
00887CD0                            ; ===========================================================================
00887CD0                            
00887CD0                            DLE_MZ3boss:
00887CD0 31FC 0720 F726             		move.w	#$720,(v_limitbtm1).w
00887CD6 0C78 1560 F700             		cmpi.w	#$1560,(v_screenposx).w
00887CDC 6500                       		bcs.s	locret_70E8
00887CDE 31FC 0210 F726             		move.w	#$210,(v_limitbtm1).w
00887CE4 0C78 17F0 F700             		cmpi.w	#$17F0,(v_screenposx).w
00887CEA 6500                       		bcs.s	locret_70E8
00887CEC 6100 0000                  		bsr.w	FindFreeObj
00887CF0 6600                       		bne.s	loc_70D0
00887CF2 137C 0000 0000             		move.b	#id_BossMarble,0(a1) ; load MZ boss object
00887CF8 337C 19F0 0008             		move.w	#$19F0,obX(a1)
00887CFE 337C 022C 000C             		move.w	#$22C,obY(a1)
00887D04                            
00887D04                            loc_70D0:
00887D04 303C 000C                  		move.w	#bgm_Boss,d0
00887D08 6100 9B32                  		bsr.w	PlaySound	; play boss music
00887D0C 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887D12 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887D16 7000                       		moveq	#plcid_Boss,d0
00887D18 6000 9E88                  		bra.w	AddPLC		; load boss patterns
00887D1C                            ; ===========================================================================
00887D1C                            
00887D1C                            locret_70E8:
00887D1C 4E75                       		rts	
00887D1E                            ; ===========================================================================
00887D1E                            
00887D1E                            DLE_MZ3end:
00887D1E 31F8 F700 F728             		move.w	(v_screenposx).w,(v_limitleft2).w
00887D24 4E75                       		rts	
00887D26                            ; ===========================================================================
00887D26                            ; ---------------------------------------------------------------------------
00887D26                            ; Star Light Zone dynamic level events
00887D26                            ; ---------------------------------------------------------------------------
00887D26                            
00887D26                            DLE_SLZ:				; XREF: DLE_Index
00887D26 7000                       		moveq	#0,d0
00887D28 1038 FE11                  		move.b	(v_act).w,d0
00887D2C D040                       		add.w	d0,d0
00887D2E 303B 0000                  		move.w	DLE_SLZx(pc,d0.w),d0
00887D32 4EFB 0000                  		jmp	DLE_SLZx(pc,d0.w)
00887D36                            ; ===========================================================================
00887D36 0000                       DLE_SLZx:	dc.w DLE_SLZ12-DLE_SLZx
00887D38 0000                       		dc.w DLE_SLZ12-DLE_SLZx
00887D3A 0000                       		dc.w DLE_SLZ3-DLE_SLZx
00887D3C                            ; ===========================================================================
00887D3C                            
00887D3C                            DLE_SLZ12:
00887D3C 4E75                       		rts	
00887D3E                            ; ===========================================================================
00887D3E                            
00887D3E                            DLE_SLZ3:
00887D3E 7000                       		moveq	#0,d0
00887D40 1038 F742                  		move.b	(v_dle_routine).w,d0
00887D44 303B 0000                  		move.w	off_7118(pc,d0.w),d0
00887D48 4EFB 0000                  		jmp	off_7118(pc,d0.w)
00887D4C                            ; ===========================================================================
00887D4C 0000                       off_7118:	dc.w DLE_SLZ3main-off_7118
00887D4E 0000                       		dc.w DLE_SLZ3boss-off_7118
00887D50 0000                       		dc.w DLE_SLZ3end-off_7118
00887D52                            ; ===========================================================================
00887D52                            
00887D52                            DLE_SLZ3main:
00887D52 0C78 1E70 F700             		cmpi.w	#$1E70,(v_screenposx).w
00887D58 6500                       		bcs.s	locret_7130
00887D5A 31FC 0210 F726             		move.w	#$210,(v_limitbtm1).w
00887D60 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887D64                            
00887D64                            locret_7130:
00887D64 4E75                       		rts	
00887D66                            ; ===========================================================================
00887D66                            
00887D66                            DLE_SLZ3boss:
00887D66 0C78 2000 F700             		cmpi.w	#$2000,(v_screenposx).w
00887D6C 6500                       		bcs.s	locret_715C
00887D6E 6100 0000                  		bsr.w	FindFreeObj
00887D72 6600                       		bne.s	loc_7144
00887D74 12BC 0000                  		move.b	#id_BossStarLight,(a1) ; load SLZ boss object
00887D78                            
00887D78                            loc_7144:
00887D78 303C 000C                  		move.w	#bgm_Boss,d0
00887D7C 6100 9ABE                  		bsr.w	PlaySound	; play boss music
00887D80 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887D86 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887D8A 7000                       		moveq	#plcid_Boss,d0
00887D8C 6000 9E14                  		bra.w	AddPLC		; load boss patterns
00887D90                            ; ===========================================================================
00887D90                            
00887D90                            locret_715C:
00887D90 4E75                       		rts	
00887D92                            ; ===========================================================================
00887D92                            
00887D92                            DLE_SLZ3end:
00887D92 31F8 F700 F728             		move.w	(v_screenposx).w,(v_limitleft2).w
00887D98 4E75                       		rts
00887D9A 4E75                       		rts
00887D9C                            ; ===========================================================================
00887D9C                            ; ---------------------------------------------------------------------------
00887D9C                            ; Spring Yard Zone dynamic level events
00887D9C                            ; ---------------------------------------------------------------------------
00887D9C                            
00887D9C                            DLE_SYZ:				; XREF: DLE_Index
00887D9C 7000                       		moveq	#0,d0
00887D9E 1038 FE11                  		move.b	(v_act).w,d0
00887DA2 D040                       		add.w	d0,d0
00887DA4 303B 0000                  		move.w	DLE_SYZx(pc,d0.w),d0
00887DA8 4EFB 0000                  		jmp	DLE_SYZx(pc,d0.w)
00887DAC                            ; ===========================================================================
00887DAC 0000                       DLE_SYZx:	dc.w DLE_SYZ1-DLE_SYZx
00887DAE 0000                       		dc.w DLE_SYZ2-DLE_SYZx
00887DB0 0000                       		dc.w DLE_SYZ3-DLE_SYZx
00887DB2                            ; ===========================================================================
00887DB2                            
00887DB2                            DLE_SYZ1:
00887DB2 4E75                       		rts	
00887DB4                            ; ===========================================================================
00887DB4                            
00887DB4                            DLE_SYZ2:
00887DB4 31FC 0520 F726             		move.w	#$520,(v_limitbtm1).w
00887DBA 0C78 25A0 F700             		cmpi.w	#$25A0,(v_screenposx).w
00887DC0 6500                       		bcs.s	locret_71A2
00887DC2 31FC 0420 F726             		move.w	#$420,(v_limitbtm1).w
00887DC8 0C78 04D0 D00C             		cmpi.w	#$4D0,($FFFFD00C).w
00887DCE 6500                       		bcs.s	locret_71A2
00887DD0 31FC 0520 F726             		move.w	#$520,(v_limitbtm1).w
00887DD6                            
00887DD6                            locret_71A2:
00887DD6 4E75                       		rts	
00887DD8                            ; ===========================================================================
00887DD8                            
00887DD8                            DLE_SYZ3:
00887DD8 7000                       		moveq	#0,d0
00887DDA 1038 F742                  		move.b	(v_dle_routine).w,d0
00887DDE 303B 0000                  		move.w	off_71B2(pc,d0.w),d0
00887DE2 4EFB 0000                  		jmp	off_71B2(pc,d0.w)
00887DE6                            ; ===========================================================================
00887DE6 0000                       off_71B2:	dc.w DLE_SYZ3main-off_71B2
00887DE8 0000                       		dc.w DLE_SYZ3boss-off_71B2
00887DEA 0000                       		dc.w DLE_SYZ3end-off_71B2
00887DEC                            ; ===========================================================================
00887DEC                            
00887DEC                            DLE_SYZ3main:
00887DEC 0C78 2AC0 F700             		cmpi.w	#$2AC0,(v_screenposx).w
00887DF2 6500                       		bcs.s	locret_71CE
00887DF4 6100 0000                  		bsr.w	FindFreeObj
00887DF8 6600                       		bne.s	locret_71CE
00887DFA 12BC 0000                  		move.b	#id_BossBlock,(a1) ; load blocks that boss picks up
00887DFE 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887E02                            
00887E02                            locret_71CE:
00887E02 4E75                       		rts	
00887E04                            ; ===========================================================================
00887E04                            
00887E04                            DLE_SYZ3boss:
00887E04 0C78 2C00 F700             		cmpi.w	#$2C00,(v_screenposx).w
00887E0A 6500                       		bcs.s	locret_7200
00887E0C 31FC 04CC F726             		move.w	#$4CC,(v_limitbtm1).w
00887E12 6100 0000                  		bsr.w	FindFreeObj
00887E16 6600                       		bne.s	loc_71EC
00887E18 12BC 0000                  		move.b	#id_BossSpringYard,(a1) ; load SYZ boss	object
00887E1C 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887E20                            
00887E20                            loc_71EC:
00887E20 303C 000C                  		move.w	#bgm_Boss,d0
00887E24 6100 9A16                  		bsr.w	PlaySound	; play boss music
00887E28 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887E2E 7000                       		moveq	#plcid_Boss,d0
00887E30 6000 9D70                  		bra.w	AddPLC		; load boss patterns
00887E34                            ; ===========================================================================
00887E34                            
00887E34                            locret_7200:
00887E34 4E75                       		rts	
00887E36                            ; ===========================================================================
00887E36                            
00887E36                            DLE_SYZ3end:
00887E36 31F8 F700 F728             		move.w	(v_screenposx).w,(v_limitleft2).w
00887E3C 4E75                       		rts	
00887E3E                            ; ===========================================================================
00887E3E                            ; ---------------------------------------------------------------------------
00887E3E                            ; Scrap	Brain Zone dynamic level events
00887E3E                            ; ---------------------------------------------------------------------------
00887E3E                            
00887E3E                            DLE_SBZ:				; XREF: DLE_Index
00887E3E 7000                       		moveq	#0,d0
00887E40 1038 FE11                  		move.b	(v_act).w,d0
00887E44 D040                       		add.w	d0,d0
00887E46 303B 0000                  		move.w	DLE_SBZx(pc,d0.w),d0
00887E4A 4EFB 0000                  		jmp	DLE_SBZx(pc,d0.w)
00887E4E                            ; ===========================================================================
00887E4E 0000                       DLE_SBZx:	dc.w DLE_SBZ1-DLE_SBZx
00887E50 0000                       		dc.w DLE_SBZ2-DLE_SBZx
00887E52 0000                       		dc.w DLE_FZ-DLE_SBZx
00887E54                            ; ===========================================================================
00887E54                            
00887E54                            DLE_SBZ1:
00887E54 31FC 0720 F726             		move.w	#$720,(v_limitbtm1).w
00887E5A 0C78 1880 F700             		cmpi.w	#$1880,(v_screenposx).w
00887E60 6500                       		bcs.s	locret_7242
00887E62 31FC 0620 F726             		move.w	#$620,(v_limitbtm1).w
00887E68 0C78 2000 F700             		cmpi.w	#$2000,(v_screenposx).w
00887E6E 6500                       		bcs.s	locret_7242
00887E70 31FC 02A0 F726             		move.w	#$2A0,(v_limitbtm1).w
00887E76                            
00887E76                            locret_7242:
00887E76 4E75                       		rts	
00887E78                            ; ===========================================================================
00887E78                            
00887E78                            DLE_SBZ2:
00887E78 7000                       		moveq	#0,d0
00887E7A 1038 F742                  		move.b	(v_dle_routine).w,d0
00887E7E 303B 0000                  		move.w	off_7252(pc,d0.w),d0
00887E82 4EFB 0000                  		jmp	off_7252(pc,d0.w)
00887E86                            ; ===========================================================================
00887E86 0000                       off_7252:	dc.w DLE_SBZ2main-off_7252
00887E88 0000                       		dc.w DLE_SBZ2boss-off_7252
00887E8A 0000                       		dc.w DLE_SBZ2boss2-off_7252
00887E8C 0000                       		dc.w DLE_SBZ2end-off_7252
00887E8E                            ; ===========================================================================
00887E8E                            
00887E8E                            DLE_SBZ2main:
00887E8E 31FC 0800 F726             		move.w	#$800,(v_limitbtm1).w
00887E94 0C78 1800 F700             		cmpi.w	#$1800,(v_screenposx).w
00887E9A 6500                       		bcs.s	locret_727A
00887E9C 31FC 0510 F726             		move.w	#$510,(v_limitbtm1).w
00887EA2 0C78 1E00 F700             		cmpi.w	#$1E00,(v_screenposx).w
00887EA8 6500                       		bcs.s	locret_727A
00887EAA 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887EAE                            
00887EAE                            locret_727A:
00887EAE 4E75                       		rts	
00887EB0                            ; ===========================================================================
00887EB0                            
00887EB0                            DLE_SBZ2boss:
00887EB0 0C78 1EB0 F700             		cmpi.w	#$1EB0,(v_screenposx).w
00887EB6 6500                       		bcs.s	locret_7298
00887EB8 6100 0000                  		bsr.w	FindFreeObj
00887EBC 6600                       		bne.s	locret_7298
00887EBE 12BC 0000                  		move.b	#id_FalseFloor,(a1) ; load collapsing block object
00887EC2 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887EC6 7000                       		moveq	#plcid_EggmanSBZ2,d0
00887EC8 6000 9CD8                  		bra.w	AddPLC		; load SBZ2 Eggman patterns
00887ECC                            ; ===========================================================================
00887ECC                            
00887ECC                            locret_7298:
00887ECC 4E75                       		rts	
00887ECE                            ; ===========================================================================
00887ECE                            
00887ECE                            DLE_SBZ2boss2:
00887ECE 0C78 1F60 F700             		cmpi.w	#$1F60,(v_screenposx).w
00887ED4 6500                       		bcs.s	loc_72B6
00887ED6 6100 0000                  		bsr.w	FindFreeObj
00887EDA 6600                       		bne.s	loc_72B0
00887EDC 12BC 0000                  		move.b	#id_ScrapEggman,(a1) ; load SBZ2 Eggman object
00887EE0 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887EE4                            
00887EE4                            loc_72B0:
00887EE4 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887EEA                            
00887EEA                            loc_72B6:
00887EEA 6000                       		bra.s	loc_72C2
00887EEC                            ; ===========================================================================
00887EEC                            
00887EEC                            DLE_SBZ2end:
00887EEC 0C78 2050 F700             		cmpi.w	#$2050,(v_screenposx).w
00887EF2 6500                       		bcs.s	loc_72C2
00887EF4 4E75                       		rts	
00887EF6                            ; ===========================================================================
00887EF6                            
00887EF6                            loc_72C2:
00887EF6 31F8 F700 F728             		move.w	(v_screenposx).w,(v_limitleft2).w
00887EFC 4E75                       		rts	
00887EFE                            ; ===========================================================================
00887EFE                            
00887EFE                            DLE_FZ:
00887EFE 7000                       		moveq	#0,d0
00887F00 1038 F742                  		move.b	(v_dle_routine).w,d0
00887F04 303B 0000                  		move.w	off_72D8(pc,d0.w),d0
00887F08 4EFB 0000                  		jmp	off_72D8(pc,d0.w)
00887F0C                            ; ===========================================================================
00887F0C 0000 0000                  off_72D8:	dc.w DLE_FZmain-off_72D8, DLE_FZboss-off_72D8
00887F10 0000 0000                  		dc.w DLE_FZend-off_72D8, locret_7322-off_72D8
00887F14 0000                       		dc.w DLE_FZend2-off_72D8
00887F16                            ; ===========================================================================
00887F16                            
00887F16                            DLE_FZmain:
00887F16 0C78 2148 F700             		cmpi.w	#$2148,(v_screenposx).w
00887F1C 6500                       		bcs.s	loc_72F4
00887F1E 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887F22 7000                       		moveq	#plcid_FZBoss,d0
00887F24 6100 9C7C                  		bsr.w	AddPLC		; load FZ boss patterns
00887F28                            
00887F28                            loc_72F4:
00887F28 60CC                       		bra.s	loc_72C2
00887F2A                            ; ===========================================================================
00887F2A                            
00887F2A                            DLE_FZboss:
00887F2A 0C78 2300 F700             		cmpi.w	#$2300,(v_screenposx).w
00887F30 6500                       		bcs.s	loc_7312
00887F32 6100 0000                  		bsr.w	FindFreeObj
00887F36 6600                       		bne.s	loc_7312
00887F38 12BC 0000                  		move.b	#id_BossFinal,(a1) ; load FZ boss object
00887F3C 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887F40 11FC 0001 F7AA             		move.b	#1,(f_lockscreen).w ; lock screen
00887F46                            
00887F46                            loc_7312:
00887F46 60AE                       		bra.s	loc_72C2
00887F48                            ; ===========================================================================
00887F48                            
00887F48                            DLE_FZend:
00887F48 0C78 2450 F700             		cmpi.w	#$2450,(v_screenposx).w
00887F4E 6500                       		bcs.s	loc_7320
00887F50 5438 F742                  		addq.b	#2,(v_dle_routine).w
00887F54                            
00887F54                            loc_7320:
00887F54 60A0                       		bra.s	loc_72C2
00887F56                            ; ===========================================================================
00887F56                            
00887F56                            locret_7322:
00887F56 4E75                       		rts	
00887F58                            ; ===========================================================================
00887F58                            
00887F58                            DLE_FZend2:
00887F58 609C                       		bra.s	loc_72C2
00887F5A                            ; ===========================================================================
00887F5A                            ; ---------------------------------------------------------------------------
00887F5A                            ; Ending sequence dynamic level events (empty)
00887F5A                            ; ---------------------------------------------------------------------------
00887F5A                            
00887F5A                            DLE_Ending:				; XREF: DLE_Index
00887F5A 4E75                       		rts	
00887F5A 4E75                       		rts	
00887F5C                            
00887F5C                            		include	"_incObj\11 Bridge (part 1).asm"
00887F5C                            ; ---------------------------------------------------------------------------
00887F5C                            ; Object 11 - GHZ bridge
00887F5C                            ; ---------------------------------------------------------------------------
00887F5C                            
00887F5C                            Bridge:					; XREF: Obj_Index
00887F5C 7000                       		moveq	#0,d0
00887F5E 1028 0024                  		move.b	obRoutine(a0),d0
00887F62 323B 0000                  		move.w	Bri_Index(pc,d0.w),d1
00887F66 4EFB 1000                  		jmp	Bri_Index(pc,d1.w)
00887F6A                            ; ===========================================================================
00887F6A 0000 0000                  Bri_Index:	dc.w Bri_Main-Bri_Index, Bri_Action-Bri_Index
00887F6E 0000 0000                  		dc.w Bri_Platform-Bri_Index, Bri_Delete-Bri_Index
00887F72 0000 0000                  		dc.w Bri_Delete-Bri_Index, Bri_Display-Bri_Index
00887F76                            ; ===========================================================================
00887F76                            
00887F76                            Bri_Main:	; Routine 0
00887F76 5428 0024                  		addq.b	#2,obRoutine(a0)
00887F7A 217C 0000 0000 0004        		move.l	#Map_Bri,obMap(a0)
00887F82 317C 438E 0002             		move.w	#$438E,obGfx(a0)
00887F88 117C 0004 0001             		move.b	#4,obRender(a0)
00887F8E 117C 0003 0018             		move.b	#3,obPriority(a0)
00887F94 117C 0080 0019             		move.b	#$80,obActWid(a0)
00887F9A 3428 000C                  		move.w	obY(a0),d2
00887F9E 3628 0008                  		move.w	obX(a0),d3
00887FA2 1828 0000                  		move.b	0(a0),d4	; copy object number ($11) to d4
00887FA6 45E8 0028                  		lea	obSubtype(a0),a2
00887FAA 7200                       		moveq	#0,d1
00887FAC 1212                       		move.b	(a2),d1		; copy bridge length to d1
00887FAE 14FC 0000                  		move.b	#0,(a2)+	; clear bridge length
00887FB2 3001                       		move.w	d1,d0
00887FB4 E248                       		lsr.w	#1,d0
00887FB6 E948                       		lsl.w	#4,d0
00887FB8 9640                       		sub.w	d0,d3		; d3 is position of leftmost log
00887FBA 5501                       		subq.b	#2,d1
00887FBC 6500                       		bcs.s	Bri_Action	; don't make more if bridge has only 1 log
00887FBE                            
00887FBE                            @buildloop:
00887FBE 6100 0000                  		bsr.w	FindFreeObj
00887FC2 6600                       		bne.s	Bri_Action
00887FC4 5228 0028                  		addq.b	#1,obSubtype(a0)
00887FC8 B668 0008                  		cmp.w	obX(a0),d3	; is this log the leftmost one?
00887FCC 6600                       		bne.s	@notleftmost	; if not, branch
00887FCE                            
00887FCE 0643 0010                  		addi.w	#$10,d3
00887FD2 3142 000C                  		move.w	d2,obY(a0)
00887FD6 3142 003C                  		move.w	d2,$3C(a0)
00887FDA 3A08                       		move.w	a0,d5
00887FDC 0445 D000                  		subi.w	#$D000,d5
00887FE0 EC4D                       		lsr.w	#6,d5
00887FE2 0245 007F                  		andi.w	#$7F,d5
00887FE6 14C5                       		move.b	d5,(a2)+
00887FE8 5228 0028                  		addq.b	#1,obSubtype(a0)
00887FEC                            
00887FEC                            	@notleftmost:
00887FEC 3A09                       		move.w	a1,d5
00887FEE 0445 D000                  		subi.w	#$D000,d5
00887FF2 EC4D                       		lsr.w	#6,d5
00887FF4 0245 007F                  		andi.w	#$7F,d5
00887FF8 14C5                       		move.b	d5,(a2)+
00887FFA 137C 000A 0024             		move.b	#$A,obRoutine(a1)
00888000 1344 0000                  		move.b	d4,0(a1)	; load bridge object (d4 = $11)
00888004 3342 000C                  		move.w	d2,obY(a1)
00888008 3342 003C                  		move.w	d2,$3C(a1)
0088800C 3343 0008                  		move.w	d3,obX(a1)
00888010 237C 0000 0000 0004        		move.l	#Map_Bri,obMap(a1)
00888018 337C 438E 0002             		move.w	#$438E,obGfx(a1)
0088801E 137C 0004 0001             		move.b	#4,obRender(a1)
00888024 137C 0003 0018             		move.b	#3,obPriority(a1)
0088802A 137C 0008 0019             		move.b	#8,obActWid(a1)
00888030 0643 0010                  		addi.w	#$10,d3
00888034 51C9 FF88                  		dbf	d1,@buildloop ; repeat d1 times (length of bridge)
00888038                            
00888038                            Bri_Action:	; Routine 2
00888038 6100                       		bsr.s	Bri_Solid
0088803A 4A28 003E                  		tst.b	$3E(a0)
0088803E 6700                       		beq.s	@display
00888040 5928 003E                  		subq.b	#4,$3E(a0)
00888044 6100 0000                  		bsr.w	Bri_Bend
00888048                            
00888048                            	@display:
00888048 6100 0000                  		bsr.w	DisplaySprite
0088804C 6000 0000                  		bra.w	Bri_ChkDel
00888050                            
00888050                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888050                            
00888050                            
00888050                            Bri_Solid:
00888050 7200                       		moveq	#0,d1
00888052 1228 0028                  		move.b	obSubtype(a0),d1
00888056 E749                       		lsl.w	#3,d1
00888058 3401                       		move.w	d1,d2
0088805A 5041                       		addq.w	#8,d1
0088805C D442                       		add.w	d2,d2
0088805E 43F8 D000                  		lea	(v_player).w,a1
00888062 4A69 0012                  		tst.w	obVelY(a1)
00888066 6B00 0000                  		bmi.w	Plat_Exit
0088806A 3029 0008                  		move.w	obX(a1),d0
0088806E 9068 0008                  		sub.w	obX(a0),d0
00888072 D041                       		add.w	d1,d0
00888074 6B00 0000                  		bmi.w	Plat_Exit
00888078 B042                       		cmp.w	d2,d0
0088807A 6400 0000                  		bcc.w	Plat_Exit
0088807E 6000                       		bra.s	Plat_NoXCheck
00888080                            ; End of function Bri_Solid
00888080                            ; End of function Bri_Solid
00888080                            
00888080                            ; ---------------------------------------------------------------------------
00888080                            ; Platform subroutine
00888080                            ; ---------------------------------------------------------------------------
00888080                            
00888080                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888080                            
00888080                            PlatformObject:
00888080 43F8 D000                  		lea	(v_player).w,a1
00888084 4A69 0012                  		tst.w	obVelY(a1)	; is Sonic moving up/jumping?
00888088 6B00 0000                  		bmi.w	Plat_Exit	; if yes, branch
0088808C                            
0088808C                            ;		perform x-axis range check
0088808C 3029 0008                  		move.w	obX(a1),d0
00888090 9068 0008                  		sub.w	obX(a0),d0
00888094 D041                       		add.w	d1,d0
00888096 6B00 0000                  		bmi.w	Plat_Exit
0088809A D241                       		add.w	d1,d1
0088809C B041                       		cmp.w	d1,d0
0088809E 6400 0000                  		bcc.w	Plat_Exit
008880A2                            
008880A2                            	Plat_NoXCheck:
008880A2 3028 000C                  		move.w	obY(a0),d0
008880A6 5140                       		subq.w	#8,d0
008880A8                            
008880A8                            Platform3:
008880A8                            ;		perform y-axis range check
008880A8 3429 000C                  		move.w	obY(a1),d2
008880AC 1229 0016                  		move.b	obHeight(a1),d1
008880B0 4881                       		ext.w	d1
008880B2 D242                       		add.w	d2,d1
008880B4 5841                       		addq.w	#4,d1
008880B6 9041                       		sub.w	d1,d0
008880B8 6200 0000                  		bhi.w	Plat_Exit
008880BC 0C40 FFF0                  		cmpi.w	#-$10,d0
008880C0 6500 0000                  		bcs.w	Plat_Exit
008880C4                            
008880C4 4A38 F7C8                  		tst.b	(f_lockmulti).w
008880C8 6B00 0000                  		bmi.w	Plat_Exit
008880CC 0C29 0006 0024             		cmpi.b	#6,obRoutine(a1)
008880D2 6400 0000                  		bcc.w	Plat_Exit
008880D6 D440                       		add.w	d0,d2
008880D8 5642                       		addq.w	#3,d2
008880DA 3342 000C                  		move.w	d2,obY(a1)
008880DE 5428 0024                  		addq.b	#2,obRoutine(a0)
008880E2                            
008880E2                            loc_74AE:
008880E2 0829 0003 0022             		btst	#3,obStatus(a1)
008880E8 6700                       		beq.s	loc_74DC
008880EA 7000                       		moveq	#0,d0
008880EC 1029 003D                  		move.b	$3D(a1),d0
008880F0 ED48                       		lsl.w	#6,d0
008880F2 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
008880F8 2440                       		movea.l	d0,a2
008880FA 08AA 0003 0022             		bclr	#3,obStatus(a2)
00888100 422A 0025                  		clr.b	ob2ndRout(a2)
00888104 0C2A 0004 0024             		cmpi.b	#4,obRoutine(a2)
0088810A 6600                       		bne.s	loc_74DC
0088810C 552A 0024                  		subq.b	#2,obRoutine(a2)
00888110                            
00888110                            loc_74DC:
00888110 3008                       		move.w	a0,d0
00888112 0440 D000                  		subi.w	#-$3000,d0
00888116 EC48                       		lsr.w	#6,d0
00888118 0240 007F                  		andi.w	#$7F,d0
0088811C 1340 003D                  		move.b	d0,$3D(a1)
00888120 137C 0000 0026             		move.b	#0,obAngle(a1)
00888126 337C 0000 0012             		move.w	#0,obVelY(a1)
0088812C 3369 0010 0014             		move.w	obVelX(a1),obInertia(a1)
00888132 0829 0001 0022             		btst	#1,obStatus(a1)
00888138 6700                       		beq.s	loc_7512
0088813A 2F08                       		move.l	a0,-(sp)
0088813C 2049                       		movea.l	a1,a0
0088813E 4EB9 0000 0000             		jsr	Sonic_ResetOnFloor
00888144 205F                       		movea.l	(sp)+,a0
00888146                            
00888146                            loc_7512:
00888146 08E9 0003 0022             		bset	#3,obStatus(a1)
0088814C 08E8 0003 0022             		bset	#3,obStatus(a0)
00888152                            
00888152                            Plat_Exit:
00888152 4E75                       		rts	
00888154                            ; End of function PlatformObject
00888154                            
00888154                            ; ---------------------------------------------------------------------------
00888154                            ; Sloped platform subroutine (GHZ collapsing ledges and	SLZ seesaws)
00888154                            ; ---------------------------------------------------------------------------
00888154                            
00888154                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888154                            
00888154                            
00888154                            SlopeObject:				; XREF: Obj1A_Slope; Obj5E_Slope
00888154 43F8 D000                  		lea	(v_player).w,a1
00888158 4A69 0012                  		tst.w	obVelY(a1)
0088815C 6B00 FFF4                  		bmi.w	Plat_Exit
00888160 3029 0008                  		move.w	obX(a1),d0
00888164 9068 0008                  		sub.w	obX(a0),d0
00888168 D041                       		add.w	d1,d0
0088816A 6BE6                       		bmi.s	Plat_Exit
0088816C D241                       		add.w	d1,d1
0088816E B041                       		cmp.w	d1,d0
00888170 64E0                       		bcc.s	Plat_Exit
00888172 0828 0000 0001             		btst	#0,obRender(a0)
00888178 6700                       		beq.s	loc_754A
0088817A 4640                       		not.w	d0
0088817C D041                       		add.w	d1,d0
0088817E                            
0088817E                            loc_754A:
0088817E E248                       		lsr.w	#1,d0
00888180 7600                       		moveq	#0,d3
00888182 1632 0000                  		move.b	(a2,d0.w),d3
00888186 3028 000C                  		move.w	obY(a0),d0
0088818A 9043                       		sub.w	d3,d0
0088818C 6000 FF1A                  		bra.w	Platform3
00888190                            ; End of function SlopeObject
00888190                            
00888190                            
00888190                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888190                            
00888190                            
00888190                            Swing_Solid:				; XREF: Obj15_SetSolid
00888190 43F8 D000                  		lea	(v_player).w,a1
00888194 4A69 0012                  		tst.w	obVelY(a1)
00888198 6B00 FFB8                  		bmi.w	Plat_Exit
0088819C 3029 0008                  		move.w	obX(a1),d0
008881A0 9068 0008                  		sub.w	obX(a0),d0
008881A4 D041                       		add.w	d1,d0
008881A6 6B00 FFAA                  		bmi.w	Plat_Exit
008881AA D241                       		add.w	d1,d1
008881AC B041                       		cmp.w	d1,d0
008881AE 6400 FFA2                  		bcc.w	Plat_Exit
008881B2 3028 000C                  		move.w	obY(a0),d0
008881B6 9043                       		sub.w	d3,d0
008881B8 6000 FEEE                  		bra.w	Platform3
008881BC                            ; End of function Obj15_Solid
008881BC                            
008881BC                            ; ===========================================================================
008881BC                            
008881BC                            		include	"_incObj\11 Bridge (part 2).asm"
008881BC                            
008881BC                            Bri_Platform:	; Routine 4
008881BC 6100                       		bsr.s	Bri_WalkOff
008881BE 6100 0000                  		bsr.w	DisplaySprite
008881C2 6000 0000                  		bra.w	Bri_ChkDel
008881C6                            
008881C6                            ; ---------------------------------------------------------------------------
008881C6                            ; Subroutine allowing Sonic to walk off a bridge
008881C6                            ; ---------------------------------------------------------------------------
008881C6                            
008881C6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008881C6                            
008881C6                            
008881C6                            Bri_WalkOff:				; XREF: Bri_Platform
008881C6 7200                       		moveq	#0,d1
008881C8 1228 0028                  		move.b	obSubtype(a0),d1
008881CC E749                       		lsl.w	#3,d1
008881CE 3401                       		move.w	d1,d2
008881D0 5041                       		addq.w	#8,d1
008881D2 6100                       		bsr.s	ExitPlatform2
008881D4 6400                       		bcc.s	locret_75BE
008881D6 E848                       		lsr.w	#4,d0
008881D8 1140 003F                  		move.b	d0,$3F(a0)
008881DC 1028 003E                  		move.b	$3E(a0),d0
008881E0 0C00 0040                  		cmpi.b	#$40,d0
008881E4 6700                       		beq.s	loc_75B6
008881E6 5828 003E                  		addq.b	#4,$3E(a0)
008881EA                            
008881EA                            loc_75B6:
008881EA 6100 0000                  		bsr.w	Bri_Bend
008881EE 6100 0000                  		bsr.w	Bri_MoveSonic
008881F2                            
008881F2                            locret_75BE:
008881F2 4E75                       		rts	
008881F4                            ; End of function Bri_WalkOff
008881F4                            ; End of function Bri_WalkOff
008881F4                            
008881F4                            ; ---------------------------------------------------------------------------
008881F4                            ; Subroutine allowing Sonic to walk or jump off	a platform
008881F4                            ; ---------------------------------------------------------------------------
008881F4                            
008881F4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008881F4                            
008881F4                            
008881F4                            ExitPlatform:
008881F4 3401                       		move.w	d1,d2
008881F6                            
008881F6                            ExitPlatform2:
008881F6 D442                       		add.w	d2,d2
008881F8 43F8 D000                  		lea	(v_player).w,a1
008881FC 0829 0001 0022             		btst	#1,obStatus(a1)
00888202 6600                       		bne.s	loc_75E0
00888204 3029 0008                  		move.w	obX(a1),d0
00888208 9068 0008                  		sub.w	obX(a0),d0
0088820C D041                       		add.w	d1,d0
0088820E 6B00                       		bmi.s	loc_75E0
00888210 B042                       		cmp.w	d2,d0
00888212 6500                       		bcs.s	locret_75F2
00888214                            
00888214                            loc_75E0:
00888214 08A9 0003 0022             		bclr	#3,obStatus(a1)
0088821A 117C 0002 0024             		move.b	#2,obRoutine(a0)
00888220 08A8 0003 0022             		bclr	#3,obStatus(a0)
00888226                            
00888226                            locret_75F2:
00888226 4E75                       		rts	
00888228                            ; End of function ExitPlatform
00888228                            
00888228                            		include	"_incObj\11 Bridge (part 3).asm"
00888228                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888228                            
00888228                            
00888228                            Bri_MoveSonic:				; XREF: Bri_WalkOff
00888228 7000                       		moveq	#0,d0
0088822A 1028 003F                  		move.b	$3F(a0),d0
0088822E 1030 0029                  		move.b	$29(a0,d0.w),d0
00888232 ED48                       		lsl.w	#6,d0
00888234 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
0088823A 2440                       		movea.l	d0,a2
0088823C 43F8 D000                  		lea	(v_player).w,a1
00888240 302A 000C                  		move.w	obY(a2),d0
00888244 5140                       		subq.w	#8,d0
00888246 7200                       		moveq	#0,d1
00888248 1229 0016                  		move.b	obHeight(a1),d1
0088824C 9041                       		sub.w	d1,d0
0088824E 3340 000C                  		move.w	d0,obY(a1)	; change Sonic's position on y-axis
00888252 4E75                       		rts	
00888254                            ; End of function Bri_MoveSonic
00888254                            
00888254                            
00888254                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888254                            
00888254                            
00888254                            Bri_Bend:				; XREF: Bri_Action; Bri_WalkOff
00888254 1028 003E                  		move.b	$3E(a0),d0
00888258 6100 ADC2                  		bsr.w	CalcSine
0088825C 3800                       		move.w	d0,d4
0088825E 49F9 0000 0000             		lea	(Obj11_BendData2).l,a4
00888264 7000                       		moveq	#0,d0
00888266 1028 0028                  		move.b	obSubtype(a0),d0
0088826A E948                       		lsl.w	#4,d0
0088826C 7600                       		moveq	#0,d3
0088826E 1628 003F                  		move.b	$3F(a0),d3
00888272 3403                       		move.w	d3,d2
00888274 D640                       		add.w	d0,d3
00888276 7A00                       		moveq	#0,d5
00888278 4BF9 0000 0000             		lea	(Obj11_BendData).l,a5
0088827E 1A35 3000                  		move.b	(a5,d3.w),d5
00888282 0243 000F                  		andi.w	#$F,d3
00888286 E94B                       		lsl.w	#4,d3
00888288 47F4 3000                  		lea	(a4,d3.w),a3
0088828C 45E8 0029                  		lea	$29(a0),a2
00888290                            
00888290                            loc_765C:
00888290 7000                       		moveq	#0,d0
00888292 101A                       		move.b	(a2)+,d0
00888294 ED48                       		lsl.w	#6,d0
00888296 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
0088829C 2240                       		movea.l	d0,a1
0088829E 7000                       		moveq	#0,d0
008882A0 101B                       		move.b	(a3)+,d0
008882A2 5240                       		addq.w	#1,d0
008882A4 C0C5                       		mulu.w	d5,d0
008882A6 C0C4                       		mulu.w	d4,d0
008882A8 4840                       		swap	d0
008882AA D069 003C                  		add.w	$3C(a1),d0
008882AE 3340 000C                  		move.w	d0,obY(a1)
008882B2 51CA FFDC                  		dbf	d2,loc_765C
008882B6 7000                       		moveq	#0,d0
008882B8 1028 0028                  		move.b	obSubtype(a0),d0
008882BC 7600                       		moveq	#0,d3
008882BE 1628 003F                  		move.b	$3F(a0),d3
008882C2 5203                       		addq.b	#1,d3
008882C4 9600                       		sub.b	d0,d3
008882C6 4403                       		neg.b	d3
008882C8 6B00                       		bmi.s	locret_76CA
008882CA 3403                       		move.w	d3,d2
008882CC E94B                       		lsl.w	#4,d3
008882CE 47F4 3000                  		lea	(a4,d3.w),a3
008882D2 D6C2                       		adda.w	d2,a3
008882D4 5342                       		subq.w	#1,d2
008882D6 6500                       		bcs.s	locret_76CA
008882D8                            
008882D8                            loc_76A4:
008882D8 7000                       		moveq	#0,d0
008882DA 101A                       		move.b	(a2)+,d0
008882DC ED48                       		lsl.w	#6,d0
008882DE 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
008882E4 2240                       		movea.l	d0,a1
008882E6 7000                       		moveq	#0,d0
008882E8 1023                       		move.b	-(a3),d0
008882EA 5240                       		addq.w	#1,d0
008882EC C0C5                       		mulu.w	d5,d0
008882EE C0C4                       		mulu.w	d4,d0
008882F0 4840                       		swap	d0
008882F2 D069 003C                  		add.w	$3C(a1),d0
008882F6 3340 000C                  		move.w	d0,obY(a1)
008882FA 51CA FFDC                  		dbf	d2,loc_76A4
008882FE                            
008882FE                            locret_76CA:
008882FE 4E75                       		rts	
00888300                            ; End of function Bri_Bend
00888300                            
00888300                            ; ===========================================================================
00888300                            ; ---------------------------------------------------------------------------
00888300                            ; GHZ bridge-bending data
00888300                            ; (Defines how the bridge bends	when Sonic walks across	it)
00888300                            ; ---------------------------------------------------------------------------
00888300                            Obj11_BendData:	incbin	"misc\ghzbend1.bin"
00888410                            		even
00888410                            Obj11_BendData2:incbin	"misc\ghzbend2.bin"
00888510                            		even
00888510                            
00888510                            ; ===========================================================================
00888510                            
00888510                            Bri_ChkDel:				; XREF: Bri_Display; Bri_Platform
0088852E 4E75                       		rts	
00888530                            ; ===========================================================================
00888530                            
00888530                            @deletebridge:
00888530 7400                       		moveq	#0,d2
00888532 45E8 0028                  		lea	obSubtype(a0),a2 ; load bridge length
00888536 141A                       		move.b	(a2)+,d2	; move bridge length to	d2
00888538 5302                       		subq.b	#1,d2		; subtract 1
0088853A 6500                       		bcs.s	@delparent
0088853C                            
0088853C                            	@loop:
0088853C 7000                       		moveq	#0,d0
0088853E 101A                       		move.b	(a2)+,d0
00888540 ED48                       		lsl.w	#6,d0
00888542 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
00888548 2240                       		movea.l	d0,a1
0088854A B048                       		cmp.w	a0,d0
0088854C 6700                       		beq.s	@skipdel
0088854E 6100 0000                  		bsr.w	DeleteChild
00888552                            
00888552                            	@skipdel:
00888552 51CA FFE8                  		dbf	d2,@loop ; repeat d2 times (bridge length)
00888556                            
00888556                            @delparent:
00888556 6100 0000                  		bsr.w	DeleteObject
0088855A 4E75                       		rts	
0088855C                            ; ===========================================================================
0088855C                            
0088855C                            Bri_Delete:	; Routine 6, 8
0088855C 6100 0000                  		bsr.w	DeleteObject
00888560 4E75                       		rts	
00888562                            ; ===========================================================================
00888562                            
00888562                            Bri_Display:	; Routine $A
00888562 6100 0000                  		bsr.w	DisplaySprite
00888566 4E75                       		rts	
00888566 4E75                       		rts	
00888568                            		include	"_maps\Bridge.asm"
00888568                            ; ---------------------------------------------------------------------------
00888568                            ; Sprite mappings - GHZ	bridge
00888568                            ; ---------------------------------------------------------------------------
00888568 0000                       Map_Bri:	dc.w M_Bri_Log-Map_Bri
0088856A 0000                       		dc.w M_Bri_Stump-Map_Bri
0088856C 0000                       		dc.w M_Bri_Rope-Map_Bri
0088856E 01                         M_Bri_Log:	dc.b 1
0088856F F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8	; log
00888574 02                         M_Bri_Stump:	dc.b 2
00888575 F804 0004 F0               		dc.b $F8, 4, 0,	4, $F0	; stump & rope
0088857A 000C 0006 F0               		dc.b 0,	$C, 0, 6, $F0
0088857F 01                         M_Bri_Rope:	dc.b 1
00888580 FC04 0008 F8               		dc.b $FC, 4, 0,	8, $F8	; rope only
00888586 00                         		even
00888586 00                         		even
00888586                            
00888586                            		include	"_incObj\15 Swinging Platforms (part 1).asm"
00888586                            ; ---------------------------------------------------------------------------
00888586                            ; Object 15 - swinging platforms (GHZ, MZ, SLZ)
00888586                            ;	    - spiked ball on a chain (SBZ)
00888586                            ; ---------------------------------------------------------------------------
00888586                            
00888586                            SwingingPlatform:			; XREF: Obj_Index
00888586 7000                       		moveq	#0,d0
00888588 1028 0024                  		move.b	obRoutine(a0),d0
0088858C 323B 0000                  		move.w	Swing_Index(pc,d0.w),d1
00888590 4EFB 1000                  		jmp	Swing_Index(pc,d1.w)
00888594                            ; ===========================================================================
00888594 0000 0000                  Swing_Index:	dc.w Swing_Main-Swing_Index, Swing_SetSolid-Swing_Index
00888598 0000 0000                  		dc.w Swing_Action2-Swing_Index,	Swing_Delete-Swing_Index
0088859C 0000 0000                  		dc.w Swing_Delete-Swing_Index, Swing_Display-Swing_Index
008885A0 0000                       		dc.w Swing_Action-Swing_Index
008885A2                            
008885A2 =0000003A                  origX:		= $3A		; original x-axis position
008885A2 =00000038                  origY:		= $38		; original y-axis position
008885A2                            ; ===========================================================================
008885A2                            
008885A2                            Swing_Main:	; Routine 0
008885A2 5428 0024                  		addq.b	#2,obRoutine(a0)
008885A6 217C 0000 0000 0004        		move.l	#Map_Swing_GHZ,obMap(a0) ; GHZ and MZ specific code
008885AE 317C 4380 0002             		move.w	#$4380,obGfx(a0)
008885B4 117C 0004 0001             		move.b	#4,obRender(a0)
008885BA 117C 0003 0018             		move.b	#3,obPriority(a0)
008885C0 117C 0018 0019             		move.b	#$18,obActWid(a0)
008885C6 117C 0008 0016             		move.b	#8,obHeight(a0)
008885CC 3168 000C 0038             		move.w	obY(a0),origY(a0)
008885D2 3168 0008 003A             		move.w	obX(a0),origX(a0)
008885D8 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w ; check if level is SLZ
008885DE 6600                       		bne.s	@notSLZ
008885E0                            
008885E0 217C 0000 0000 0004        		move.l	#Map_Swing_SLZ,obMap(a0) ; SLZ specific code
008885E8 317C 43DC 0002             		move.w	#$43DC,obGfx(a0)
008885EE 117C 0020 0019             		move.b	#$20,obActWid(a0)
008885F4 117C 0010 0016             		move.b	#$10,obHeight(a0)
008885FA 117C 0099 0020             		move.b	#$99,obColType(a0)
00888600                            
00888600                            	@notSLZ:
00888600 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; check if level is SBZ
00888606 6600                       		bne.s	@length
00888608                            
00888608 217C 0000 0000 0004        		move.l	#Map_BBall,obMap(a0) ; SBZ specific code
00888610 317C 0391 0002             		move.w	#$391,obGfx(a0)
00888616 117C 0018 0019             		move.b	#$18,obActWid(a0)
0088861C 117C 0018 0016             		move.b	#$18,obHeight(a0)
00888622 117C 0086 0020             		move.b	#$86,obColType(a0)
00888628 117C 000C 0024             		move.b	#$C,obRoutine(a0) ; goto Swing_Action next
0088862E                            
0088862E                            @length:
0088862E 1828 0000                  		move.b	0(a0),d4
00888632 7200                       		moveq	#0,d1
00888634 45E8 0028                  		lea	obSubtype(a0),a2 ; move chain length to a2
00888638 1212                       		move.b	(a2),d1		; move a2 to d1
0088863A 3F01                       		move.w	d1,-(sp)
0088863C 0241 000F                  		andi.w	#$F,d1
00888640 14FC 0000                  		move.b	#0,(a2)+
00888644 3601                       		move.w	d1,d3
00888646 E94B                       		lsl.w	#4,d3
00888648 5003                       		addq.b	#8,d3
0088864A 1143 003C                  		move.b	d3,$3C(a0)
0088864E 5103                       		subq.b	#8,d3
00888650 4A28 001A                  		tst.b	obFrame(a0)
00888654 6700                       		beq.s	@makechain
00888656 5003                       		addq.b	#8,d3
00888658 5341                       		subq.w	#1,d1
0088865A                            
0088865A                            @makechain:
0088865A 6100 0000                  		bsr.w	FindFreeObj
0088865E 6600                       		bne.s	@fail
00888660 5228 0028                  		addq.b	#1,obSubtype(a0)
00888664 3A09                       		move.w	a1,d5
00888666 0445 D000                  		subi.w	#$D000,d5
0088866A EC4D                       		lsr.w	#6,d5
0088866C 0245 007F                  		andi.w	#$7F,d5
00888670 14C5                       		move.b	d5,(a2)+
00888672 137C 000A 0024             		move.b	#$A,obRoutine(a1) ; goto Swing_Display next
00888678 1344 0000                  		move.b	d4,0(a1)	; load swinging	object
0088867C 2368 0004 0004             		move.l	obMap(a0),obMap(a1)
00888682 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
00888688 08A9 0006 0002             		bclr	#6,obGfx(a1)
0088868E 137C 0004 0001             		move.b	#4,obRender(a1)
00888694 137C 0004 0018             		move.b	#4,obPriority(a1)
0088869A 137C 0008 0019             		move.b	#8,obActWid(a1)
008886A0 137C 0001 001A             		move.b	#1,obFrame(a1)
008886A6 1343 003C                  		move.b	d3,$3C(a1)
008886AA 0403 0010                  		subi.b	#$10,d3
008886AE 6400                       		bcc.s	@notanchor
008886B0 137C 0002 001A             		move.b	#2,obFrame(a1)
008886B6 137C 0003 0018             		move.b	#3,obPriority(a1)
008886BC 08E9 0006 0002             		bset	#6,obGfx(a1)
008886C2                            
008886C2                            	@notanchor:
008886C2 51C9 FF96                  		dbf	d1,@makechain ; repeat d1 times (chain length)
008886C6                            
008886C6                            	@fail:
008886C6 3A08                       		move.w	a0,d5
008886C8 0445 D000                  		subi.w	#$D000,d5
008886CC EC4D                       		lsr.w	#6,d5
008886CE 0245 007F                  		andi.w	#$7F,d5
008886D2 14C5                       		move.b	d5,(a2)+
008886D4 317C 4080 0026             		move.w	#$4080,obAngle(a0)
008886DA 317C FE00 003E             		move.w	#-$200,$3E(a0)
008886E0 321F                       		move.w	(sp)+,d1
008886E2 0801 0004                  		btst	#4,d1		; is object type $8X ?
008886E6 6700                       		beq.s	@not8X	; if not, branch
008886E8 217C 0000 0000 0004        		move.l	#Map_GBall,obMap(a0) ; use GHZ ball mappings
008886F0 317C 43AA 0002             		move.w	#$43AA,obGfx(a0)
008886F6 117C 0001 001A             		move.b	#1,obFrame(a0)
008886FC 117C 0002 0018             		move.b	#2,obPriority(a0)
00888702 117C 0081 0020             		move.b	#$81,obColType(a0) ; make object hurt when touched
00888708                            
00888708                            	@not8X:
00888708 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; is zone SBZ?
0088870E 6700                       		beq.s	Swing_Action	; if yes, branch
00888710                            
00888710                            Swing_SetSolid:	; Routine 2
00888710 7200                       		moveq	#0,d1
00888712 1228 0019                  		move.b	obActWid(a0),d1
00888716 7600                       		moveq	#0,d3
00888718 1628 0016                  		move.b	obHeight(a0),d3
0088871C 6100 FA72                  		bsr.w	Swing_Solid
00888720                            
00888720                            Swing_Action:	; Routine $C
00888720 6100 0000                  		bsr.w	Swing_Move
00888724 6100 0000                  		bsr.w	DisplaySprite
00888728 6000 0000                  		bra.w	Swing_ChkDel
0088872C                            ; ===========================================================================
0088872C                            
0088872C                            Swing_Action2:	; Routine 4
0088872C 7200                       		moveq	#0,d1
0088872E 1228 0019                  		move.b	obActWid(a0),d1
00888732 6100 FAC0                  		bsr.w	ExitPlatform
00888736 3F28 0008                  		move.w	obX(a0),-(sp)
0088873A 6100 0000                  		bsr.w	Swing_Move
0088873E 341F                       		move.w	(sp)+,d2
00888740 7600                       		moveq	#0,d3
00888742 1628 0016                  		move.b	obHeight(a0),d3
00888746 5203                       		addq.b	#1,d3
00888748 6100 0000                  		bsr.w	MvSonicOnPtfm
0088874C 6100 0000                  		bsr.w	DisplaySprite
00888750 6000 0000                  		bra.w	Swing_ChkDel
00888754                            
00888754 4E75                       		rts
00888754 4E75                       		rts
00888756                            
00888756                            ; ---------------------------------------------------------------------------
00888756                            ; Subroutine to	change Sonic's position with a platform
00888756                            ; ---------------------------------------------------------------------------
00888756                            
00888756                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888756                            
00888756                            
00888756                            MvSonicOnPtfm:
00888756 43F8 D000                  		lea	(v_player).w,a1
0088875A 3028 000C                  		move.w	obY(a0),d0
0088875E 9043                       		sub.w	d3,d0
00888760 6000                       		bra.s	MvSonic2
00888762                            ; End of function MvSonicOnPtfm
00888762                            
00888762                            ; ---------------------------------------------------------------------------
00888762                            ; Subroutine to	change Sonic's position with a platform
00888762                            ; ---------------------------------------------------------------------------
00888762                            
00888762                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888762                            
00888762                            
00888762                            MvSonicOnPtfm2:
00888762 43F8 D000                  		lea	(v_player).w,a1
00888766 3028 000C                  		move.w	obY(a0),d0
0088876A 0440 0009                  		subi.w	#9,d0
0088876E                            
0088876E                            MvSonic2:
0088876E 4A38 F7C8                  		tst.b	(f_lockmulti).w
00888772 6B00                       		bmi.s	locret_7B62
00888774 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w
0088877A 6400                       		bcc.s	locret_7B62
0088877C 4A78 FE08                  		tst.w	(v_debuguse).w
00888780 6600                       		bne.s	locret_7B62
00888782 7200                       		moveq	#0,d1
00888784 1229 0016                  		move.b	obHeight(a1),d1
00888788 9041                       		sub.w	d1,d0
0088878A 3340 000C                  		move.w	d0,obY(a1)
0088878E 9468 0008                  		sub.w	obX(a0),d2
00888792 9569 0008                  		sub.w	d2,obX(a1)
00888796                            
00888796                            locret_7B62:
00888796 4E75                       		rts	
00888798                            ; End of function MvSonicOnPtfm2
00888798                            
00888798                            		include	"_incObj\15 Swinging Platforms (part 2).asm"
00888798                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888798                            
00888798                            
00888798                            Swing_Move:				; XREF: Swing_Action; Swing_Action2
00888798 1038 FE78                  		move.b	(v_oscillate+$1A).w,d0
0088879C 323C 0080                  		move.w	#$80,d1
008887A0 0828 0000 0022             		btst	#0,obStatus(a0)
008887A6 6700                       		beq.s	loc_7B78
008887A8 4440                       		neg.w	d0
008887AA D041                       		add.w	d1,d0
008887AC                            
008887AC                            loc_7B78:
008887AC 6000                       		bra.s	Swing_Move2
008887AE                            ; End of function Swing_Move
008887AE                            
008887AE                            
008887AE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008887AE                            
008887AE                            
008887AE                            Obj48_Move:				; XREF: Obj48_Display2
008887AE 4A28 003D                  		tst.b	$3D(a0)
008887B2 6600                       		bne.s	loc_7B9C
008887B4 3028 003E                  		move.w	$3E(a0),d0
008887B8 5040                       		addq.w	#8,d0
008887BA 3140 003E                  		move.w	d0,$3E(a0)
008887BE D168 0026                  		add.w	d0,obAngle(a0)
008887C2 0C40 0200                  		cmpi.w	#$200,d0
008887C6 6600                       		bne.s	loc_7BB6
008887C8 117C 0001 003D             		move.b	#1,$3D(a0)
008887CE 6000                       		bra.s	loc_7BB6
008887D0                            ; ===========================================================================
008887D0                            
008887D0                            loc_7B9C:
008887D0 3028 003E                  		move.w	$3E(a0),d0
008887D4 5140                       		subq.w	#8,d0
008887D6 3140 003E                  		move.w	d0,$3E(a0)
008887DA D168 0026                  		add.w	d0,obAngle(a0)
008887DE 0C40 FE00                  		cmpi.w	#-$200,d0
008887E2 6600                       		bne.s	loc_7BB6
008887E4 117C 0000 003D             		move.b	#0,$3D(a0)
008887EA                            
008887EA                            loc_7BB6:
008887EA 1028 0026                  		move.b	obAngle(a0),d0
008887EE                            ; End of function Obj48_Move
008887EE                            
008887EE                            
008887EE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008887EE                            
008887EE                            
008887EE                            Swing_Move2:				; XREF: Swing_Move; Obj48_Display
008887EE 6100 A82C                  		bsr.w	CalcSine
008887F2 3428 0038                  		move.w	$38(a0),d2
008887F6 3628 003A                  		move.w	$3A(a0),d3
008887FA 45E8 0028                  		lea	obSubtype(a0),a2
008887FE 7C00                       		moveq	#0,d6
00888800 1C1A                       		move.b	(a2)+,d6
00888802                            
00888802                            loc_7BCE:
00888802 7800                       		moveq	#0,d4
00888804 181A                       		move.b	(a2)+,d4
00888806 ED4C                       		lsl.w	#6,d4
00888808 0684 00FF D000             		addi.l	#v_objspace&$FFFFFF,d4
0088880E 2244                       		movea.l	d4,a1
00888810 7800                       		moveq	#0,d4
00888812 1829 003C                  		move.b	$3C(a1),d4
00888816 2A04                       		move.l	d4,d5
00888818 C9C0                       		muls.w	d0,d4
0088881A E084                       		asr.l	#8,d4
0088881C CBC1                       		muls.w	d1,d5
0088881E E085                       		asr.l	#8,d5
00888820 D842                       		add.w	d2,d4
00888822 DA43                       		add.w	d3,d5
00888824 3344 000C                  		move.w	d4,obY(a1)
00888828 3345 0008                  		move.w	d5,obX(a1)
0088882C 51CE FFD4                  		dbf	d6,loc_7BCE
00888830 4E75                       		rts	
00888832                            ; End of function Swing_Move2
00888832                            
00888832                            ; ===========================================================================
00888832                            
00888832                            Swing_ChkDel:				; XREF: Swing_Action; Swing_Action2
00888850 4E75                       		rts	
00888852                            ; ===========================================================================
00888852                            
00888852                            Swing_DelAll:				; XREF: Swing_ChkDel
00888852 7400                       		moveq	#0,d2
00888854 45E8 0028                  		lea	obSubtype(a0),a2
00888858 141A                       		move.b	(a2)+,d2
0088885A                            
0088885A                            Swing_DelLoop:
0088885A 7000                       		moveq	#0,d0
0088885C 101A                       		move.b	(a2)+,d0
0088885E ED48                       		lsl.w	#6,d0
00888860 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
00888866 2240                       		movea.l	d0,a1
00888868 6100 0000                  		bsr.w	DeleteChild
0088886C 51CA FFEC                  		dbf	d2,Swing_DelLoop ; repeat for length of	chain
00888870 4E75                       		rts	
00888872                            ; ===========================================================================
00888872                            
00888872                            Swing_Delete:	; Routine 6, 8
00888872 6100 0000                  		bsr.w	DeleteObject
00888876 4E75                       		rts	
00888878                            ; ===========================================================================
00888878                            
00888878                            Swing_Display:	; Routine $A
00888878 6000 0000                  		bra.w	DisplaySprite
00888878 6000 0000                  		bra.w	DisplaySprite
0088887C                            		include	"_maps\Swinging Platforms (GHZ).asm"
0088887C                            ; ---------------------------------------------------------------------------
0088887C                            ; Sprite mappings - GHZ	and MZ swinging	platforms
0088887C                            ; ---------------------------------------------------------------------------
0088887C 0000                       Map_Swing_GHZ:	dc.w @block-Map_Swing_GHZ
0088887E 0000                       		dc.w @chain-Map_Swing_GHZ
00888880 0000                       		dc.w @anchor-Map_Swing_GHZ
00888882 02                         @block:		dc.b 2
00888883 F809 0004 E8               		dc.b $F8, 9, 0,	4, $E8
00888888 F809 0004 00               		dc.b $F8, 9, 0,	4, 0
0088888D 01                         @chain:		dc.b 1
0088888E F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
00888893 01                         @anchor:	dc.b 1
00888894 F805 000A F8               		dc.b $F8, 5, 0,	$A, $F8
0088889A 00                         		even
0088889A 00                         		even
0088889A                            		include	"_maps\Swinging Platforms (SLZ).asm"
0088889A                            ; ---------------------------------------------------------------------------
0088889A                            ; Sprite mappings - SLZ	swinging platforms
0088889A                            ; ---------------------------------------------------------------------------
0088889A 0000                       Map_Swing_SLZ:	dc.w @block-Map_Swing_SLZ
0088889C 0000                       		dc.w @chain-Map_Swing_SLZ
0088889E 0000                       		dc.w @anchor-Map_Swing_SLZ
008888A0 08                         @block:		dc.b 8
008888A1 F00F 0004 E0               		dc.b $F0, $F, 0, 4, $E0
008888A6 F00F 0804 00               		dc.b $F0, $F, 8, 4, 0
008888AB F005 0014 D0               		dc.b $F0, 5, 0,	$14, $D0
008888B0 F005 0814 20               		dc.b $F0, 5, 8,	$14, $20
008888B5 1004 0018 E0               		dc.b $10, 4, 0,	$18, $E0
008888BA 1004 0818 10               		dc.b $10, 4, 8,	$18, $10
008888BF 1001 001A F8               		dc.b $10, 1, 0,	$1A, $F8
008888C4 1001 081A 00               		dc.b $10, 1, 8,	$1A, 0
008888C9 01                         @chain:		dc.b 1
008888CA F805 4000 F8               		dc.b $F8, 5, $40, 0, $F8
008888CF 01                         @anchor:	dc.b 1
008888D0 F805 001C F8               		dc.b $F8, 5, 0,	$1C, $F8
008888D6 00                         		even
008888D6 00                         		even
008888D6                            		include	"_incObj\17 Spiked Pole Helix.asm"
008888D6                            ; ---------------------------------------------------------------------------
008888D6                            ; Object 17 - helix of spikes on a pole	(GHZ)
008888D6                            ; ---------------------------------------------------------------------------
008888D6                            
008888D6                            Helix:				; XREF: Obj_Index
008888D6 7000                       		moveq	#0,d0
008888D8 1028 0024                  		move.b	obRoutine(a0),d0
008888DC 323B 0000                  		move.w	Hel_Index(pc,d0.w),d1
008888E0 4EFB 1000                  		jmp	Hel_Index(pc,d1.w)
008888E4                            ; ===========================================================================
008888E4 0000                       Hel_Index:	dc.w Hel_Main-Hel_Index
008888E6 0000                       		dc.w Hel_Action-Hel_Index
008888E8 0000                       		dc.w Hel_Action-Hel_Index
008888EA 0000                       		dc.w Hel_Delete-Hel_Index
008888EC 0000                       		dc.w Hel_Display-Hel_Index
008888EE                            
008888EE =0000003E                  hel_frame:	= $3E		; start frame (different for each spike)
008888EE                            
008888EE                            ;		$29-38 are used for child object addresses
008888EE                            ; ===========================================================================
008888EE                            
008888EE                            Hel_Main:	; Routine 0
008888EE 5428 0024                  		addq.b	#2,obRoutine(a0)
008888F2 217C 0000 0000 0004        		move.l	#Map_Hel,obMap(a0)
008888FA 317C 4398 0002             		move.w	#$4398,obGfx(a0)
00888900 117C 0007 0022             		move.b	#7,obStatus(a0)
00888906 117C 0004 0001             		move.b	#4,obRender(a0)
0088890C 117C 0003 0018             		move.b	#3,obPriority(a0)
00888912 117C 0008 0019             		move.b	#8,obActWid(a0)
00888918 3428 000C                  		move.w	obY(a0),d2
0088891C 3628 0008                  		move.w	obX(a0),d3
00888920 1828 0000                  		move.b	0(a0),d4
00888924 45E8 0028                  		lea	obSubtype(a0),a2 ; move helix length to a2
00888928 7200                       		moveq	#0,d1
0088892A 1212                       		move.b	(a2),d1		; move helix length to d1
0088892C 14FC 0000                  		move.b	#0,(a2)+	; clear subtype
00888930 3001                       		move.w	d1,d0
00888932 E248                       		lsr.w	#1,d0
00888934 E948                       		lsl.w	#4,d0
00888936 9640                       		sub.w	d0,d3		; d3 is x-axis position of leftmost spike
00888938 5501                       		subq.b	#2,d1
0088893A 6500                       		bcs.s	Hel_Action	; skip to action if length is only 1
0088893C 7C00                       		moveq	#0,d6
0088893E                            
0088893E                            Hel_Build:
0088893E 6100 0000                  		bsr.w	FindFreeObj
00888942 6600                       		bne.s	Hel_Action
00888944 5228 0028                  		addq.b	#1,obSubtype(a0)
00888948 3A09                       		move.w	a1,d5
0088894A 0445 D000                  		subi.w	#$D000,d5
0088894E EC4D                       		lsr.w	#6,d5
00888950 0245 007F                  		andi.w	#$7F,d5
00888954 14C5                       		move.b	d5,(a2)+	; copy child address to parent RAM
00888956 137C 0008 0024             		move.b	#8,obRoutine(a1)
0088895C 1344 0000                  		move.b	d4,0(a1)
00888960 3342 000C                  		move.w	d2,ObY(a1)
00888964 3343 0008                  		move.w	d3,obX(a1)
00888968 2368 0004 0004             		move.l	obMap(a0),obMap(a1)
0088896E 337C 4398 0002             		move.w	#$4398,obGfx(a1)
00888974 137C 0004 0001             		move.b	#4,obRender(a1)
0088897A 137C 0003 0018             		move.b	#3,obPriority(a1)
00888980 137C 0008 0019             		move.b	#8,obActWid(a1)
00888986 1346 003E                  		move.b	d6,hel_frame(a1)
0088898A 5206                       		addq.b	#1,d6
0088898C 0206 0007                  		andi.b	#7,d6
00888990 0643 0010                  		addi.w	#$10,d3
00888994 B668 0008                  		cmp.w	obX(a0),d3	; is this spike in the centre?
00888998 6600                       		bne.s	Hel_NotCentre	; if not, branch
0088899A                            
0088899A 1146 003E                  		move.b	d6,hel_frame(a0) ; set parent spike frame
0088899E 5206                       		addq.b	#1,d6
008889A0 0206 0007                  		andi.b	#7,d6
008889A4 0643 0010                  		addi.w	#$10,d3		; skip to next spike
008889A8 5228 0028                  		addq.b	#1,obSubtype(a0)
008889AC                            
008889AC                            	Hel_NotCentre:
008889AC 51C9 FF90                  		dbf	d1,Hel_Build ; repeat d1 times (helix length)
008889B0                            
008889B0                            Hel_Action:	; Routine 2, 4
008889B0 6100 0000                  		bsr.w	Hel_RotateSpikes
008889B4 6100 0000                  		bsr.w	DisplaySprite
008889B8 6000 0000                  		bra.w	Hel_ChkDel
008889BC                            
008889BC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008889BC                            
008889BC                            
008889BC                            Hel_RotateSpikes:			; XREF: Hel_Action; Hel_Display
008889BC 1038 FEC1                  		move.b	(v_ani0_frame).w,d0
008889C0 117C 0000 0020             		move.b	#0,obColType(a0) ; make object harmless
008889C6 D028 003E                  		add.b	hel_frame(a0),d0
008889CA 0200 0007                  		andi.b	#7,d0
008889CE 1140 001A                  		move.b	d0,obFrame(a0)	; change current frame
008889D2 6600                       		bne.s	locret_7DA6
008889D4 117C 0084 0020             		move.b	#$84,obColType(a0) ; make object harmful
008889DA                            
008889DA                            locret_7DA6:
008889DA 4E75                       		rts	
008889DC                            ; End of function Hel_RotateSpikes
008889DC                            
008889DC                            ; ===========================================================================
008889DC                            
008889DC                            Hel_ChkDel:				; XREF: Hel_Action
008889FA 4E75                       		rts	
008889FC                            ; ===========================================================================
008889FC                            
008889FC                            Hel_DelAll:				; XREF: Hel_ChkDel
008889FC 7400                       		moveq	#0,d2
008889FE 45E8 0028                  		lea	obSubtype(a0),a2 ; move helix length to a2
00888A02 141A                       		move.b	(a2)+,d2	; move helix length to d2
00888A04 5502                       		subq.b	#2,d2
00888A06 6500                       		bcs.s	Hel_Delete
00888A08                            
00888A08                            	Hel_DelLoop:
00888A08 7000                       		moveq	#0,d0
00888A0A 101A                       		move.b	(a2)+,d0
00888A0C ED48                       		lsl.w	#6,d0
00888A0E 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
00888A14 2240                       		movea.l	d0,a1		; get child address
00888A16 6100 0000                  		bsr.w	DeleteChild	; delete object
00888A1A 51CA FFEC                  		dbf	d2,Hel_DelLoop ; repeat d2 times (helix length)
00888A1E                            
00888A1E                            Hel_Delete:	; Routine 6
00888A1E 6100 0000                  		bsr.w	DeleteObject
00888A22 4E75                       		rts	
00888A24                            ; ===========================================================================
00888A24                            
00888A24                            Hel_Display:	; Routine 8
00888A24 6100 FF96                  		bsr.w	Hel_RotateSpikes
00888A28 6000 0000                  		bra.w	DisplaySprite
00888A28 6000 0000                  		bra.w	DisplaySprite
00888A2C                            		include	"_maps\Spiked Pole Helix.asm"
00888A2C                            ; ---------------------------------------------------------------------------
00888A2C                            ; Sprite mappings - helix of spikes on a pole (GHZ)
00888A2C                            ; ---------------------------------------------------------------------------
00888A2C 0000 0000                  Map_Hel:	dc.w byte_7E08-Map_Hel, byte_7E0E-Map_Hel
00888A30 0000 0000                  		dc.w byte_7E14-Map_Hel, byte_7E1A-Map_Hel
00888A34 0000 0000                  		dc.w byte_7E20-Map_Hel, byte_7E26-Map_Hel
00888A38 0000 0000                  		dc.w byte_7E2D+2-Map_Hel, byte_7E2C-Map_Hel
00888A3C 01                         byte_7E08:	dc.b 1
00888A3D F001 0000 FC               		dc.b $F0, 1, 0,	0, $FC	; points straight up (harmful)
00888A42 01                         byte_7E0E:	dc.b 1
00888A43 F505 0002 F8               		dc.b $F5, 5, 0,	2, $F8	; 45 degree
00888A48 01                         byte_7E14:	dc.b 1
00888A49 F805 0006 F8               		dc.b $F8, 5, 0,	6, $F8	; 90 degree
00888A4E 01                         byte_7E1A:	dc.b 1
00888A4F FB05 000A F8               		dc.b $FB, 5, 0,	$A, $F8	; 45 degree
00888A54 01                         byte_7E20:	dc.b 1
00888A55 0001 000E FC               		dc.b 0,	1, 0, $E, $FC	; straight down
00888A5A 01                         byte_7E26:	dc.b 1
00888A5B 0400 0010 FD               		dc.b 4,	0, 0, $10, $FD	; 45 degree
00888A60                            byte_7E2D:	; reads the 0 below	; not visible
00888A60 01                         byte_7E2C:	dc.b 1
00888A61 F400 0011 FD               		dc.b $F4, 0, 0,	$11, $FD ; 45 degree
00888A66                            		even
00888A66                            		even
00888A66                            		include	"_incObj\18 Platforms.asm"
00888A66                            ; ---------------------------------------------------------------------------
00888A66                            ; Object 18 - platforms	(GHZ, SYZ, SLZ)
00888A66                            ; ---------------------------------------------------------------------------
00888A66                            
00888A66                            BasicPlatform:				; XREF: Obj_Index
00888A66 7000                       		moveq	#0,d0
00888A68 1028 0024                  		move.b	obRoutine(a0),d0
00888A6C 323B 0000                  		move.w	Plat_Index(pc,d0.w),d1
00888A70 4EFB 1000                  		jmp	Plat_Index(pc,d1.w)
00888A74                            ; ===========================================================================
00888A74 0000                       Plat_Index:	dc.w Plat_Main-Plat_Index
00888A76 0000                       		dc.w Plat_Solid-Plat_Index
00888A78 0000                       		dc.w Plat_Action2-Plat_Index
00888A7A 0000                       		dc.w Plat_Delete-Plat_Index
00888A7C 0000                       		dc.w Plat_Action-Plat_Index
00888A7E                            ; ===========================================================================
00888A7E                            
00888A7E                            Plat_Main:	; Routine 0
00888A7E 5428 0024                  		addq.b	#2,obRoutine(a0)
00888A82 317C 4000 0002             		move.w	#$4000,obGfx(a0)
00888A88 217C 0000 0000 0004        		move.l	#Map_Plat_GHZ,obMap(a0)
00888A90 117C 0020 0019             		move.b	#$20,obActWid(a0)
00888A96 0C38 0004 FE10             		cmpi.b	#id_SYZ,(v_zone).w ; check if level is SYZ
00888A9C 6600                       		bne.s	@notSYZ
00888A9E                            
00888A9E 217C 0000 0000 0004        		move.l	#Map_Plat_SYZ,obMap(a0) ; SYZ specific code
00888AA6 117C 0020 0019             		move.b	#$20,obActWid(a0)
00888AAC                            
00888AAC                            	@notSYZ:
00888AAC 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w ; check if level is SLZ
00888AB2 6600                       		bne.s	@notSLZ
00888AB4 217C 0000 0000 0004        		move.l	#Map_Plat_SLZ,obMap(a0) ; SLZ specific code
00888ABC 117C 0020 0019             		move.b	#$20,obActWid(a0)
00888AC2 317C 4000 0002             		move.w	#$4000,obGfx(a0)
00888AC8 117C 0003 0028             		move.b	#3,obSubtype(a0)
00888ACE                            
00888ACE                            	@notSLZ:
00888ACE 117C 0004 0001             		move.b	#4,obRender(a0)
00888AD4 117C 0004 0018             		move.b	#4,obPriority(a0)
00888ADA 3168 000C 002C             		move.w	obY(a0),$2C(a0)
00888AE0 3168 000C 0034             		move.w	obY(a0),$34(a0)
00888AE6 3168 0008 0032             		move.w	obX(a0),$32(a0)
00888AEC 317C 0080 0026             		move.w	#$80,obAngle(a0)
00888AF2 7200                       		moveq	#0,d1
00888AF4 1028 0028                  		move.b	obSubtype(a0),d0
00888AF8 0C00 000A                  		cmpi.b	#$A,d0		; is object type $A (large platform)?
00888AFC 6600                       		bne.s	@setframe	; if not, branch
00888AFE 5201                       		addq.b	#1,d1		; use frame #1
00888B00 117C 0020 0019             		move.b	#$20,obActWid(a0) ; set width
00888B06                            
00888B06                            	@setframe:
00888B06 1141 001A                  		move.b	d1,obFrame(a0)	; set frame to d1
00888B0A                            
00888B0A                            Plat_Solid:	; Routine 2
00888B0A 4A28 0038                  		tst.b	$38(a0)
00888B0E 6700                       		beq.s	loc_7EE0
00888B10 5928 0038                  		subq.b	#4,$38(a0)
00888B14                            
00888B14                            	loc_7EE0:
00888B14 7200                       		moveq	#0,d1
00888B16 1228 0019                  		move.b	obActWid(a0),d1
00888B1A 6100 F564                  		bsr.w	PlatformObject
00888B1E                            
00888B1E                            Plat_Action:	; Routine 8
00888B1E 6100 0000                  		bsr.w	Plat_Move
00888B22 6100 0000                  		bsr.w	Plat_Nudge
00888B26 6100 0000                  		bsr.w	DisplaySprite
00888B2A 6000 0000                  		bra.w	Plat_ChkDel
00888B2E                            ; ===========================================================================
00888B2E                            
00888B2E                            Plat_Action2:	; Routine 4
00888B2E 0C28 0040 0038             		cmpi.b	#$40,$38(a0)
00888B34 6700                       		beq.s	loc_7F06
00888B36 5828 0038                  		addq.b	#4,$38(a0)
00888B3A                            
00888B3A                            	loc_7F06:
00888B3A 7200                       		moveq	#0,d1
00888B3C 1228 0019                  		move.b	obActWid(a0),d1
00888B40 6100 F6B2                  		bsr.w	ExitPlatform
00888B44 3F28 0008                  		move.w	obX(a0),-(sp)
00888B48 6100 0000                  		bsr.w	Plat_Move
00888B4C 6100 0000                  		bsr.w	Plat_Nudge
00888B50 341F                       		move.w	(sp)+,d2
00888B52 6100 FC0E                  		bsr.w	MvSonicOnPtfm2
00888B56 6100 0000                  		bsr.w	DisplaySprite
00888B5A 6000 0000                  		bra.w	Plat_ChkDel
00888B5E                            
00888B5E 4E75                       		rts
00888B60                            
00888B60                            ; ---------------------------------------------------------------------------
00888B60                            ; Subroutine to	move platform slightly when you	stand on it
00888B60                            ; ---------------------------------------------------------------------------
00888B60                            
00888B60                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888B60                            
00888B60                            
00888B60                            Plat_Nudge:				; XREF: Plat_Action; Plat_Action2
00888B60 1028 0038                  		move.b	$38(a0),d0
00888B64 6100 A4B6                  		bsr.w	CalcSine
00888B68 323C 0400                  		move.w	#$400,d1
00888B6C C1C1                       		muls.w	d1,d0
00888B6E 4840                       		swap	d0
00888B70 D068 002C                  		add.w	$2C(a0),d0
00888B74 3140 000C                  		move.w	d0,obY(a0)
00888B78 4E75                       		rts	
00888B7A                            ; End of function Plat_Nudge
00888B7A                            
00888B7A                            ; ---------------------------------------------------------------------------
00888B7A                            ; Subroutine to	move platforms
00888B7A                            ; ---------------------------------------------------------------------------
00888B7A                            
00888B7A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888B7A                            
00888B7A                            
00888B7A                            Plat_Move:				; XREF: Plat_Action; Plat_Action2
00888B7A 7000                       		moveq	#0,d0
00888B7C 1028 0028                  		move.b	obSubtype(a0),d0
00888B80 0240 000F                  		andi.w	#$F,d0
00888B84 D040                       		add.w	d0,d0
00888B86 323B 0000                  		move.w	@index(pc,d0.w),d1
00888B8A 4EFB 1000                  		jmp	@index(pc,d1.w)
00888B8E                            ; End of function Plat_Move
00888B8E                            
00888B8E                            ; ===========================================================================
00888B8E 0000 0000                  @index:		dc.w @type00-@index, @type01-@index
00888B92 0000 0000                  		dc.w @type02-@index, @type03-@index
00888B96 0000 0000                  		dc.w @type04-@index, @type05-@index
00888B9A 0000 0000                  		dc.w @type06-@index, @type07-@index
00888B9E 0000 0000                  		dc.w @type08-@index, @type00-@index
00888BA2 0000 0000                  		dc.w @type0A-@index, @type0B-@index
00888BA6 0000                       		dc.w @type0C-@index
00888BA8                            ; ===========================================================================
00888BA8                            
00888BA8                            @type00:
00888BA8 4E75                       		rts			; platform 00 doesn't move
00888BAA                            ; ===========================================================================
00888BAA                            
00888BAA                            @type05:
00888BAA 3028 0032                  		move.w	$32(a0),d0
00888BAE 1228 0026                  		move.b	obAngle(a0),d1	; load platform-motion variable
00888BB2 4401                       		neg.b	d1		; reverse platform-motion
00888BB4 0601 0040                  		addi.b	#$40,d1
00888BB8 6000                       		bra.s	@type01_move
00888BBA                            ; ===========================================================================
00888BBA                            
00888BBA                            @type01:
00888BBA 3028 0032                  		move.w	$32(a0),d0
00888BBE 1228 0026                  		move.b	obAngle(a0),d1	; load platform-motion variable
00888BC2 0401 0040                  		subi.b	#$40,d1
00888BC6                            
00888BC6                            	@type01_move:
00888BC6 4881                       		ext.w	d1
00888BC8 D041                       		add.w	d1,d0
00888BCA 3140 0008                  		move.w	d0,obX(a0)	; change position on x-axis
00888BCE 6000 0000                  		bra.w	@chgmotion
00888BD2                            ; ===========================================================================
00888BD2                            
00888BD2                            @type0C:
00888BD2 3028 0034                  		move.w	$34(a0),d0
00888BD6 1238 FE6C                  		move.b	(v_oscillate+$E).w,d1 ; load platform-motion variable
00888BDA 4401                       		neg.b	d1		; reverse platform-motion
00888BDC 0601 0030                  		addi.b	#$30,d1
00888BE0 6000                       		bra.s	@type02_move
00888BE2                            ; ===========================================================================
00888BE2                            
00888BE2                            @type0B:
00888BE2 3028 0034                  		move.w	$34(a0),d0
00888BE6 1238 FE6C                  		move.b	(v_oscillate+$E).w,d1 ; load platform-motion variable
00888BEA 0401 0030                  		subi.b	#$30,d1
00888BEE 6000                       		bra.s	@type02_move
00888BF0                            ; ===========================================================================
00888BF0                            
00888BF0                            @type06:
00888BF0 3028 0034                  		move.w	$34(a0),d0
00888BF4 1228 0026                  		move.b	obAngle(a0),d1	; load platform-motion variable
00888BF8 4401                       		neg.b	d1		; reverse platform-motion
00888BFA 0601 0040                  		addi.b	#$40,d1
00888BFE 6000                       		bra.s	@type02_move
00888C00                            ; ===========================================================================
00888C00                            
00888C00                            @type02:
00888C00 3028 0034                  		move.w	$34(a0),d0
00888C04 1228 0026                  		move.b	obAngle(a0),d1	; load platform-motion variable
00888C08 0401 0040                  		subi.b	#$40,d1
00888C0C                            
00888C0C                            	@type02_move:
00888C0C 4881                       		ext.w	d1
00888C0E D041                       		add.w	d1,d0
00888C10 3140 002C                  		move.w	d0,$2C(a0)	; change position on y-axis
00888C14 6000 0000                  		bra.w	@chgmotion
00888C18                            ; ===========================================================================
00888C18                            
00888C18                            @type03:
00888C18 4A68 003A                  		tst.w	$3A(a0)		; is time delay	set?
00888C1C 6600                       		bne.s	@type03_wait	; if yes, branch
00888C1E 0828 0003 0022             		btst	#3,obStatus(a0)	; is Sonic standing on the platform?
00888C24 6700                       		beq.s	@type03_nomove	; if not, branch
00888C26 317C 001E 003A             		move.w	#30,$3A(a0)	; set time delay to 0.5	seconds
00888C2C                            
00888C2C                            	@type03_nomove:
00888C2C 4E75                       		rts	
00888C2E                            
00888C2E                            	@type03_wait:
00888C2E 5368 003A                  		subq.w	#1,$3A(a0)	; subtract 1 from time
00888C32 66F8                       		bne.s	@type03_nomove	; if time is > 0, branch
00888C34 317C 0020 003A             		move.w	#32,$3A(a0)
00888C3A 5228 0028                  		addq.b	#1,obSubtype(a0) ; change to type 04 (falling)
00888C3E 4E75                       		rts	
00888C40                            ; ===========================================================================
00888C40                            
00888C40                            @type04:
00888C40 4A68 003A                  		tst.w	$3A(a0)
00888C44 6700                       		beq.s	@loc_8048
00888C46 5368 003A                  		subq.w	#1,$3A(a0)
00888C4A 6600                       		bne.s	@loc_8048
00888C4C 0828 0003 0022             		btst	#3,obStatus(a0)
00888C52 6700                       		beq.s	@loc_8042
00888C54 08E9 0001 0022             		bset	#1,obStatus(a1)
00888C5A 08A9 0003 0022             		bclr	#3,obStatus(a1)
00888C60 137C 0002 0024             		move.b	#2,obRoutine(a1)
00888C66 08A8 0003 0022             		bclr	#3,obStatus(a0)
00888C6C 4228 0025                  		clr.b	$25(a0)
00888C70 3368 0012 0012             		move.w	obVelY(a0),obVelY(a1)
00888C76                            
00888C76                            	@loc_8042:
00888C76 117C 0008 0024             		move.b	#8,obRoutine(a0)
00888C7C                            
00888C7C                            	@loc_8048:
00888C7C 2628 002C                  		move.l	$2C(a0),d3
00888C80 3028 0012                  		move.w	obVelY(a0),d0
00888C84 48C0                       		ext.l	d0
00888C86 E180                       		asl.l	#8,d0
00888C88 D680                       		add.l	d0,d3
00888C8A 2143 002C                  		move.l	d3,$2C(a0)
00888C8E 0668 0038 0012             		addi.w	#$38,obVelY(a0)
00888C94 3038 F72E                  		move.w	(v_limitbtm2).w,d0
00888C98 0640 00E0                  		addi.w	#$E0,d0
00888C9C B068 002C                  		cmp.w	$2C(a0),d0
00888CA0 6400                       		bcc.s	@locret_8074
00888CA2 117C 0006 0024             		move.b	#6,obRoutine(a0)
00888CA8                            
00888CA8                            	@locret_8074:
00888CA8 4E75                       		rts	
00888CAA                            ; ===========================================================================
00888CAA                            
00888CAA                            @type07:
00888CAA 4A68 003A                  		tst.w	$3A(a0)		; is time delay	set?
00888CAE 6600                       		bne.s	@type07_wait	; if yes, branch
00888CB0 45F8 F7E0                  		lea	(f_switch).w,a2	; load switch statuses
00888CB4 7000                       		moveq	#0,d0
00888CB6 1028 0028                  		move.b	obSubtype(a0),d0 ; move object type ($x7) to d0
00888CBA E848                       		lsr.w	#4,d0		; divide d0 by 8, round	down
00888CBC 4A32 0000                  		tst.b	(a2,d0.w)	; has switch no. d0 been pressed?
00888CC0 6700                       		beq.s	@type07_nomove	; if not, branch
00888CC2 317C 003C 003A             		move.w	#60,$3A(a0)	; set time delay to 1 second
00888CC8                            
00888CC8                            	@type07_nomove:
00888CC8 4E75                       		rts	
00888CCA                            
00888CCA                            	@type07_wait:
00888CCA 5368 003A                  		subq.w	#1,$3A(a0)	; subtract 1 from time delay
00888CCE 66F8                       		bne.s	@type07_nomove	; if time is > 0, branch
00888CD0 5228 0028                  		addq.b	#1,obSubtype(a0) ; change to type 08
00888CD4 4E75                       		rts	
00888CD6                            ; ===========================================================================
00888CD6                            
00888CD6                            @type08:
00888CD6 5568 002C                  		subq.w	#2,$2C(a0)	; move platform	up
00888CDA 3028 0034                  		move.w	$34(a0),d0
00888CDE 0440 0200                  		subi.w	#$200,d0
00888CE2 B068 002C                  		cmp.w	$2C(a0),d0	; has platform moved $200 pixels?
00888CE6 6600                       		bne.s	@type08_nostop	; if not, branch
00888CE8 4228 0028                  		clr.b	obSubtype(a0)	; change to type 00 (stop moving)
00888CEC                            
00888CEC                            	@type08_nostop:
00888CEC 4E75                       		rts	
00888CEE                            ; ===========================================================================
00888CEE                            
00888CEE                            @type0A:
00888CEE 3028 0034                  		move.w	$34(a0),d0
00888CF2 1228 0026                  		move.b	obAngle(a0),d1	; load platform-motion variable
00888CF6 0401 0040                  		subi.b	#$40,d1
00888CFA 4881                       		ext.w	d1
00888CFC E241                       		asr.w	#1,d1
00888CFE D041                       		add.w	d1,d0
00888D00 3140 002C                  		move.w	d0,$2C(a0)	; change position on y-axis
00888D04                            
00888D04                            @chgmotion:
00888D04 1178 FE78 0026             		move.b	(v_oscillate+$1A).w,$26(a0) ; update platform-movement variable
00888D0A 4E75                       		rts	
00888D0C                            ; ===========================================================================
00888D0C                            
00888D0C                            Plat_ChkDel:				; XREF: Plat_Action; Plat_Action2
00888D28 4E75                       		rts	
00888D2A                            ; ===========================================================================
00888D2A                            
00888D2A                            Plat_Delete:	; Routine 6
00888D2A 6000 0000                  		bra.w	DeleteObject
00888D2A 6000 0000                  		bra.w	DeleteObject
00888D2E                            		include	"_maps\Platforms (unused).asm"
00888D2E                            ; ---------------------------------------------------------------------------
00888D2E                            ; Sprite mappings - unused
00888D2E                            ; ---------------------------------------------------------------------------
00888D2E 0000                       Map_Plat_Unused:dc.w @small-Map_Plat_Unused
00888D30 0000                       		dc.w @large-Map_Plat_Unused
00888D32 02                         @small:		dc.b 2
00888D33 F40B 003C E8               		dc.b $F4, $B, 0, $3C, $E8
00888D38 F40B 0048 00               		dc.b $F4, $B, 0, $48, 0
00888D3D 0A                         @large:		dc.b $A
00888D3E F40F 00CA E0               		dc.b $F4, $F, 0, $CA, $E0
00888D43 040F 00DA E0               		dc.b 4,	$F, 0, $DA, $E0
00888D48 240F 00DA E0               		dc.b $24, $F, 0, $DA, $E0
00888D4D 440F 00DA E0               		dc.b $44, $F, 0, $DA, $E0
00888D52 640F 00DA E0               		dc.b $64, $F, 0, $DA, $E0
00888D57 F40F 08CA 00               		dc.b $F4, $F, 8, $CA, 0
00888D5C 040F 08DA 00               		dc.b 4,	$F, 8, $DA, 0
00888D61 240F 08DA 00               		dc.b $24, $F, 8, $DA, 0
00888D66 440F 08DA 00               		dc.b $44, $F, 8, $DA, 0
00888D6B 640F 08DA 00               		dc.b $64, $F, 8, $DA, 0
00888D70                            		even
00888D70                            		even
00888D70                            		include	"_maps\Platforms (GHZ).asm"
00888D70                            ; ---------------------------------------------------------------------------
00888D70                            ; Sprite mappings - GHZ	platforms
00888D70                            ; ---------------------------------------------------------------------------
00888D70 0000                       Map_Plat_GHZ:	dc.w @small-Map_Plat_GHZ
00888D72 0000                       		dc.w @large-Map_Plat_GHZ
00888D74 04                         @small:		dc.b 4
00888D75 F40B 003B E0               		dc.b $F4, $B, 0, $3B, $E0 ; small platform
00888D7A F407 003F F8               		dc.b $F4, 7, 0,	$3F, $F8
00888D7F F407 003F 08               		dc.b $F4, 7, 0,	$3F, 8
00888D84 F403 0047 18               		dc.b $F4, 3, 0,	$47, $18
00888D89 0A                         @large:		dc.b $A
00888D8A F40F 00C5 E0               		dc.b $F4, $F, 0, $C5, $E0 ; large column platform
00888D8F 040F 00D5 E0               		dc.b 4,	$F, 0, $D5, $E0
00888D94 240F 00D5 E0               		dc.b $24, $F, 0, $D5, $E0
00888D99 440F 00D5 E0               		dc.b $44, $F, 0, $D5, $E0
00888D9E 640F 00D5 E0               		dc.b $64, $F, 0, $D5, $E0
00888DA3 F40F 08C5 00               		dc.b $F4, $F, 8, $C5, 0
00888DA8 040F 08D5 00               		dc.b 4,	$F, 8, $D5, 0
00888DAD 240F 08D5 00               		dc.b $24, $F, 8, $D5, 0
00888DB2 440F 08D5 00               		dc.b $44, $F, 8, $D5, 0
00888DB7 640F 08D5 00               		dc.b $64, $F, 8, $D5, 0
00888DBC                            		even
00888DBC                            		even
00888DBC                            		include	"_maps\Platforms (SYZ).asm"
00888DBC                            ; ---------------------------------------------------------------------------
00888DBC                            ; Sprite mappings - SYZ	platforms
00888DBC                            ; ---------------------------------------------------------------------------
00888DBC 0000                       Map_Plat_SYZ:	dc.w @platform-Map_Plat_SYZ
00888DBE 03                         @platform:	dc.b 3
00888DBF F60B 0049 E0               		dc.b $F6, $B, 0, $49, $E0
00888DC4 F607 0051 F8               		dc.b $F6, 7, 0,	$51, $F8
00888DC9 F60B 0055 08               		dc.b $F6, $B, 0, $55, 8
00888DCE                            		even
00888DCE                            		even
00888DCE                            		include	"_maps\Platforms (SLZ).asm"
00888DCE                            ; ---------------------------------------------------------------------------
00888DCE                            ; Sprite mappings - SLZ	platforms
00888DCE                            ; ---------------------------------------------------------------------------
00888DCE 0000                       Map_Plat_SLZ:	dc.w @platform-Map_Plat_SLZ
00888DD0 02                         @platform:	dc.b 2
00888DD1 F80F 0021 E0               		dc.b $F8, $F, 0, $21, $E0
00888DD6 F80F 0021 00               		dc.b $F8, $F, 0, $21, 0
00888DDC 00                         		even
00888DDC 00                         		even
00888DDC                            		include	"_incObj\19.asm"
00888DDC                            ; ---------------------------------------------------------------------------
00888DDC                            ; Object 19 - blank
00888DDC                            ; ---------------------------------------------------------------------------
00888DDC                            
00888DDC                            Obj19:					; XREF: Obj_Index
00888DDC 4E75                       		rts	
00888DDC 4E75                       		rts	
00888DDE                            		include	"_maps\GHZ Ball.asm"
00888DDE                            ; ---------------------------------------------------------------------------
00888DDE                            ; Sprite mappings - swinging ball on a chain from GHZ boss
00888DDE                            ; ---------------------------------------------------------------------------
00888DDE 0000 0000                  Map_GBall:	dc.w @shiny-Map_GBall, @check1-Map_GBall
00888DE2 0000 0000                  		dc.w @check2-Map_GBall, @check3-Map_GBall
00888DE6 06                         @shiny:		dc.b 6
00888DE7 F004 0024 F0               		dc.b $F0, 4, 0,	$24, $F0
00888DEC F804 1024 F0               		dc.b $F8, 4, $10, $24, $F0
00888DF1 E80A 0000 E8               		dc.b $E8, $A, 0, 0, $E8
00888DF6 E80A 0800 00               		dc.b $E8, $A, 8, 0, 0
00888DFB 000A 1000 E8               		dc.b 0,	$A, $10, 0, $E8
00888E00 000A 1800 00               		dc.b 0,	$A, $18, 0, 0
00888E05 04                         @check1:	dc.b 4
00888E06 E80A 0009 E8               		dc.b $E8, $A, 0, 9, $E8
00888E0B E80A 0809 00               		dc.b $E8, $A, 8, 9, 0
00888E10 000A 1009 E8               		dc.b 0,	$A, $10, 9, $E8
00888E15 000A 1809 00               		dc.b 0,	$A, $18, 9, 0
00888E1A 04                         @check2:	dc.b 4
00888E1B E80A 0012 E8               		dc.b $E8, $A, 0, $12, $E8
00888E20 E80A 001B 00               		dc.b $E8, $A, 0, $1B, 0
00888E25 000A 181B E8               		dc.b 0,	$A, $18, $1B, $E8
00888E2A 000A 1812 00               		dc.b 0,	$A, $18, $12, 0
00888E2F 04                         @check3:	dc.b 4
00888E30 E80A 081B E8               		dc.b $E8, $A, 8, $1B, $E8
00888E35 E80A 0812 00               		dc.b $E8, $A, 8, $12, 0
00888E3A 000A 1012 E8               		dc.b 0,	$A, $10, $12, $E8
00888E3F 000A 101B 00               		dc.b 0,	$A, $10, $1B, 0
00888E44                            		even
00888E44                            		even
00888E44                            		include	"_incObj\1A Collapsing Ledge (part 1).asm"
00888E44                            ; ---------------------------------------------------------------------------
00888E44                            ; Object 1A - GHZ collapsing ledge
00888E44                            ; ---------------------------------------------------------------------------
00888E44                            
00888E44                            CollapseLedge:				; XREF: Obj_Index
00888E44 7000                       		moveq	#0,d0
00888E46 1028 0024                  		move.b	obRoutine(a0),d0
00888E4A 323B 0000                  		move.w	Ledge_Index(pc,d0.w),d1
00888E4E 4EFB 1000                  		jmp	Ledge_Index(pc,d1.w)
00888E52                            ; ===========================================================================
00888E52 0000 0000                  Ledge_Index:	dc.w Ledge_Main-Ledge_Index, Ledge_Touch-Ledge_Index
00888E56 0000 0000                  		dc.w Ledge_Collapse-Ledge_Index, Ledge_Display-Ledge_Index
00888E5A 0000 0000                  		dc.w Ledge_Delete-Ledge_Index, Ledge_WalkOff-Ledge_Index
00888E5E                            
00888E5E =00000038                  timedelay:	= $38		; time between touching the ledge and it collapsing
00888E5E =0000003A                  collapse:	= $3A		; collapse flag
00888E5E                            ; ===========================================================================
00888E5E                            
00888E5E                            Ledge_Main:	; Routine 0
00888E5E 5428 0024                  		addq.b	#2,obRoutine(a0)
00888E62 217C 0000 0000 0004        		move.l	#Map_Ledge,obMap(a0)
00888E6A 317C 4000 0002             		move.w	#$4000,obGfx(a0)
00888E70 0028 0004 0001             		ori.b	#4,obRender(a0)
00888E76 117C 0004 0018             		move.b	#4,obPriority(a0)
00888E7C 117C 0007 0038             		move.b	#7,timedelay(a0) ; set time delay for collapse
00888E82 117C 0064 0019             		move.b	#$64,obActWid(a0)
00888E88 1168 0028 001A             		move.b	obSubtype(a0),obFrame(a0)
00888E8E 117C 0038 0016             		move.b	#$38,obHeight(a0)
00888E94 08E8 0004 0001             		bset	#4,obRender(a0)
00888E9A                            
00888E9A                            Ledge_Touch:	; Routine 2
00888E9A 4A28 003A                  		tst.b	collapse(a0)	; is ledge collapsing?
00888E9E 6700                       		beq.s	@slope		; if not, branch
00888EA0 4A28 0038                  		tst.b	timedelay(a0)	; has time reached zero?
00888EA4 6700 0000                  		beq.w	Ledge_Fragment	; if yes, branch
00888EA8 5328 0038                  		subq.b	#1,timedelay(a0) ; subtract 1 from time
00888EAC                            
00888EAC                            	@slope:
00888EAC 323C 0030                  		move.w	#$30,d1
00888EB0 45F9 0000 0000             		lea	(Ledge_SlopeData).l,a2
00888EB6 6100 F29C                  		bsr.w	SlopeObject
00888EBA 6000 0000                  		bra.w	RememberState
00888EBE                            ; ===========================================================================
00888EBE                            
00888EBE                            Ledge_Collapse:	; Routine 4
00888EBE 4A28 0038                  		tst.b	timedelay(a0)
00888EC2 6700 0000                  		beq.w	loc_847A
00888EC6 117C 0001 003A             		move.b	#1,collapse(a0)	; set collapse flag
00888ECC 5328 0038                  		subq.b	#1,timedelay(a0)
00888ED0                            
00888ED0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00888ED0                            
00888ED0                            
00888ED0                            Ledge_WalkOff:	; Routine $A
00888ED0 323C 0030                  		move.w	#$30,d1
00888ED4 6100 F31E                  		bsr.w	ExitPlatform
00888ED8 323C 0030                  		move.w	#$30,d1
00888EDC 45F9 0000 0000             		lea	(Ledge_SlopeData).l,a2
00888EE2 3428 0008                  		move.w	obX(a0),d2
00888EE6 6100 0000                  		bsr.w	SlopeObject2
00888EEA 6000 0000                  		bra.w	RememberState
00888EEE                            ; End of function Ledge_WalkOff
00888EEE                            
00888EEE                            ; ===========================================================================
00888EEE                            
00888EEE                            Ledge_Display:	; Routine 6
00888EEE 4A28 0038                  		tst.b	timedelay(a0)	; has time delay reached zero?
00888EF2 6700                       		beq.s	Ledge_TimeZero	; if yes, branch
00888EF4 4A28 003A                  		tst.b	collapse(a0)	; is ledge collapsing?
00888EF8 6600 0000                  		bne.w	loc_82D0	; if yes, branch
00888EFC 5328 0038                  		subq.b	#1,timedelay(a0) ; subtract 1 from time
00888F00 6000 0000                  		bra.w	DisplaySprite
00888F04                            ; ===========================================================================
00888F04                            
00888F04                            loc_82D0:
00888F04 5328 0038                  		subq.b	#1,timedelay(a0)
00888F08 6100 FFC6                  		bsr.w	Ledge_WalkOff
00888F0C 43F8 D000                  		lea	(v_player).w,a1
00888F10 0829 0003 0022             		btst	#3,obStatus(a1)
00888F16 6700                       		beq.s	loc_82FC
00888F18 4A28 0038                  		tst.b	timedelay(a0)
00888F1C 6600                       		bne.s	locret_8308
00888F1E 08A9 0003 0022             		bclr	#3,obStatus(a1)
00888F24 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
00888F2A 137C 0001 001D             		move.b	#1,obNextAni(a1)
00888F30                            
00888F30                            loc_82FC:
00888F30 117C 0000 003A             		move.b	#0,collapse(a0)
00888F36 117C 0006 0024             		move.b	#6,obRoutine(a0) ; run "Ledge_Display" routine
00888F3C                            
00888F3C                            locret_8308:
00888F3C 4E75                       		rts	
00888F3E                            ; ===========================================================================
00888F3E                            
00888F3E                            Ledge_TimeZero:
00888F3E 6100 0000                  		bsr.w	ObjectMoveAndFall
00888F42 6100 0000                  		bsr.w	DisplaySprite
00888F46 4A28 0001                  		tst.b	obRender(a0)
00888F4A 6A00                       		bpl.s	Ledge_Delete
00888F4C 4E75                       		rts	
00888F4E                            ; ===========================================================================
00888F4E                            
00888F4E                            Ledge_Delete:	; Routine 8
00888F4E 6100 0000                  		bsr.w	DeleteObject
00888F52 4E75                       		rts	
00888F52 4E75                       		rts	
00888F54                            		include	"_incObj\53 Collapsing Floors.asm"
00888F54                            ; ---------------------------------------------------------------------------
00888F54                            ; Object 53 - collapsing floors	(MZ, SLZ, SBZ)
00888F54                            ; ---------------------------------------------------------------------------
00888F54                            
00888F54                            CollapseFloor:				; XREF: Obj_Index
00888F54 7000                       		moveq	#0,d0
00888F56 1028 0024                  		move.b	obRoutine(a0),d0
00888F5A 323B 0000                  		move.w	CFlo_Index(pc,d0.w),d1
00888F5E 4EFB 1000                  		jmp	CFlo_Index(pc,d1.w)
00888F62                            ; ===========================================================================
00888F62 0000 0000                  CFlo_Index:	dc.w CFlo_Main-CFlo_Index, CFlo_Touch-CFlo_Index
00888F66 0000 0000                  		dc.w CFlo_Collapse-CFlo_Index, CFlo_Display-CFlo_Index
00888F6A 0000 0000                  		dc.w CFlo_Delete-CFlo_Index, CFlo_WalkOff-CFlo_Index
00888F6E                            
00888F6E =00000038                  timedelay:	= $38
00888F6E =0000003A                  collapse:	= $3A
00888F6E                            ; ===========================================================================
00888F6E                            
00888F6E                            CFlo_Main:	; Routine 0
00888F6E 5428 0024                  		addq.b	#2,obRoutine(a0)
00888F72 217C 0000 0000 0004        		move.l	#Map_CFlo,obMap(a0)
00888F7A 317C 42B8 0002             		move.w	#$42B8,obGfx(a0)
00888F80 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w ; check if level is SLZ
00888F86 6600                       		bne.s	@notSLZ
00888F88                            
00888F88 317C 44E0 0002             		move.w	#$44E0,obGfx(a0) ; SLZ specific code
00888F8E 5428 001A                  		addq.b	#2,obFrame(a0)
00888F92                            
00888F92                            	@notSLZ:
00888F92 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; check if level is SBZ
00888F98 6600                       		bne.s	@notSBZ
00888F9A 317C 43F5 0002             		move.w	#$43F5,obGfx(a0) ; SBZ specific code
00888FA0                            
00888FA0                            	@notSBZ:
00888FA0 0028 0004 0001             		ori.b	#4,obRender(a0)
00888FA6 117C 0004 0018             		move.b	#4,obPriority(a0)
00888FAC 117C 0007 0038             		move.b	#7,timedelay(a0)
00888FB2 117C 0044 0019             		move.b	#$44,obActWid(a0)
00888FB8                            
00888FB8                            CFlo_Touch:	; Routine 2
00888FB8 4A28 003A                  		tst.b	collapse(a0)	; has Sonic touched the	object?
00888FBC 6700                       		beq.s	@solid		; if not, branch
00888FBE 4A28 0038                  		tst.b	timedelay(a0)	; has time delay reached zero?
00888FC2 6700 0000                  		beq.w	CFlo_Fragment	; if yes, branch
00888FC6 5328 0038                  		subq.b	#1,timedelay(a0) ; subtract 1 from time
00888FCA                            
00888FCA                            	@solid:
00888FCA 323C 0020                  		move.w	#$20,d1
00888FCE 6100 F0B0                  		bsr.w	PlatformObject
00888FD2 4A28 0028                  		tst.b	obSubtype(a0)
00888FD6 6A00                       		bpl.s	@remstate
00888FD8 0829 0003 0022             		btst	#3,obStatus(a1)
00888FDE 6700                       		beq.s	@remstate
00888FE0 08A8 0000 0001             		bclr	#0,obRender(a0)
00888FE6 3029 0008                  		move.w	obX(a1),d0
00888FEA 9068 0008                  		sub.w	obX(a0),d0
00888FEE 6400                       		bcc.s	@remstate
00888FF0 08E8 0000 0001             		bset	#0,obRender(a0)
00888FF6                            
00888FF6                            	@remstate:
00888FF6 6000 0000                  		bra.w	RememberState
00888FFA                            ; ===========================================================================
00888FFA                            
00888FFA                            CFlo_Collapse:	; Routine 4
00888FFA 4A28 0038                  		tst.b	timedelay(a0)
00888FFE 6700 0000                  		beq.w	loc_8458
00889002 117C 0001 003A             		move.b	#1,collapse(a0)	; set object as	"touched"
00889008 5328 0038                  		subq.b	#1,timedelay(a0)
0088900C                            
0088900C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088900C                            
0088900C                            
0088900C                            CFlo_WalkOff:	; Routine $A
0088900C 323C 0020                  		move.w	#$20,d1
00889010 6100 F1E2                  		bsr.w	ExitPlatform
00889014 3428 0008                  		move.w	obX(a0),d2
00889018 6100 F748                  		bsr.w	MvSonicOnPtfm2
0088901C 6000 0000                  		bra.w	RememberState
00889020                            ; End of function CFlo_WalkOff
00889020                            
00889020                            ; ===========================================================================
00889020                            
00889020                            CFlo_Display:	; Routine 6
00889020 4A28 0038                  		tst.b	timedelay(a0)	; has time delay reached zero?
00889024 6700                       		beq.s	CFlo_TimeZero	; if yes, branch
00889026 4A28 003A                  		tst.b	collapse(a0)	; has Sonic touched the	object?
0088902A 6600 0000                  		bne.w	loc_8402	; if yes, branch
0088902E 5328 0038                  		subq.b	#1,timedelay(a0); subtract 1 from time
00889032 6000 0000                  		bra.w	DisplaySprite
00889036                            ; ===========================================================================
00889036                            
00889036                            loc_8402:
00889036 5328 0038                  		subq.b	#1,timedelay(a0)
0088903A 6100 FFD0                  		bsr.w	CFlo_WalkOff
0088903E 43F8 D000                  		lea	(v_objspace).w,a1
00889042 0829 0003 0022             		btst	#3,obStatus(a1)
00889048 6700                       		beq.s	loc_842E
0088904A 4A28 0038                  		tst.b	timedelay(a0)
0088904E 6600                       		bne.s	locret_843A
00889050 08A9 0003 0022             		bclr	#3,obStatus(a1)
00889056 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
0088905C 137C 0001 001D             		move.b	#1,obNextAni(a1)
00889062                            
00889062                            loc_842E:
00889062 117C 0000 003A             		move.b	#0,collapse(a0)
00889068 117C 0006 0024             		move.b	#6,obRoutine(a0) ; run "CFlo_Display" routine
0088906E                            
0088906E                            locret_843A:
0088906E 4E75                       		rts	
00889070                            ; ===========================================================================
00889070                            
00889070                            CFlo_TimeZero:
00889070 6100 0000                  		bsr.w	ObjectMoveAndFall
00889074 6100 0000                  		bsr.w	DisplaySprite
00889078 4A28 0001                  		tst.b	obRender(a0)
0088907C 6A00                       		bpl.s	CFlo_Delete
0088907E 4E75                       		rts	
00889080                            ; ===========================================================================
00889080                            
00889080                            CFlo_Delete:	; Routine 8
00889080 6100 0000                  		bsr.w	DeleteObject
00889084 4E75                       		rts	
00889086                            ; ===========================================================================
00889086                            
00889086                            CFlo_Fragment:				; XREF: CFlo_Touch
00889086 117C 0000 003A             		move.b	#0,collapse(a0)
0088908C                            
0088908C                            loc_8458:				; XREF: CFlo_Collapse
0088908C 49F9 0000 0000             		lea	(CFlo_Data2).l,a4
00889092 0828 0000 0028             		btst	#0,obSubtype(a0)
00889098 6700                       		beq.s	loc_846C
0088909A 49F9 0000 0000             		lea	(CFlo_Data3).l,a4
008890A0                            
008890A0                            loc_846C:
008890A0 7207                       		moveq	#7,d1
008890A2 5228 001A                  		addq.b	#1,obFrame(a0)
008890A6 6000                       		bra.s	loc_8486
008890A6 6000                       		bra.s	loc_8486
008890A8                            
008890A8                            ; ===========================================================================
008890A8                            
008890A8                            Ledge_Fragment:				; XREF: Obj1A_ChkTouch
008890A8 117C 0000 003A             		move.b	#0,collapse(a0)
008890AE                            
008890AE                            loc_847A:				; XREF: Obj1A_Touch
008890AE 49F9 0000 0000             		lea	(CFlo_Data1).l,a4
008890B4 7218                       		moveq	#$18,d1
008890B6 5428 001A                  		addq.b	#2,obFrame(a0)
008890BA                            
008890BA                            loc_8486:				; XREF: CFlo_Fragment
008890BA 7000                       		moveq	#0,d0
008890BC 1028 001A                  		move.b	obFrame(a0),d0
008890C0 D040                       		add.w	d0,d0
008890C2 2668 0004                  		movea.l	obMap(a0),a3
008890C6 D6F3 0000                  		adda.w	(a3,d0.w),a3
008890CA 524B                       		addq.w	#1,a3
008890CC 08E8 0005 0001             		bset	#5,obRender(a0)
008890D2 1828 0000                  		move.b	0(a0),d4
008890D6 1A28 0001                  		move.b	obRender(a0),d5
008890DA 2248                       		movea.l	a0,a1
008890DC 6000                       		bra.s	loc_84B2
008890DE                            ; ===========================================================================
008890DE                            
008890DE                            loc_84AA:
008890DE 6100 0000                  		bsr.w	FindFreeObj
008890E2 6600                       		bne.s	loc_84F2
008890E4 5A4B                       		addq.w	#5,a3
008890E6                            
008890E6                            loc_84B2:
008890E6 137C 0006 0024             		move.b	#6,obRoutine(a1)
008890EC 1344 0000                  		move.b	d4,0(a1)
008890F0 234B 0004                  		move.l	a3,obMap(a1)
008890F4 1345 0001                  		move.b	d5,obRender(a1)
008890F8 3368 0008 0008             		move.w	obX(a0),obX(a1)
008890FE 3368 000C 000C             		move.w	obY(a0),obY(a1)
00889104 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
0088910A 1368 0018 0018             		move.b	obPriority(a0),obPriority(a1)
00889110 1368 0019 0019             		move.b	obActWid(a0),obActWid(a1)
00889116 135C 0038                  		move.b	(a4)+,timedelay(a1)
0088911A B3C8                       		cmpa.l	a0,a1
0088911C 6400                       		bcc.s	loc_84EE
0088911E 6100 0000                  		bsr.w	DisplaySprite1
00889122                            
00889122                            loc_84EE:
00889122 51C9 FFBA                  		dbf	d1,loc_84AA
00889126                            
00889126                            loc_84F2:
00889126 6100 0000                  		bsr.w	DisplaySprite
00889134                            ; ===========================================================================
00889134                            ; ---------------------------------------------------------------------------
00889134                            ; Disintegration data for collapsing ledges (MZ, SLZ, SBZ)
00889134                            ; ---------------------------------------------------------------------------
00889134 1C18 1410 1A16 120E 0A06+  CFlo_Data1:	dc.b $1C, $18, $14, $10, $1A, $16, $12,	$E, $A,	6, $18,	$14, $10, $C, 8, 4
00889144 1612 0E0A 0602 1410 0C00   		dc.b $16, $12, $E, $A, 6, 2, $14, $10, $C, 0
0088914E 1E16 0E06 1A12 0A02        CFlo_Data2:	dc.b $1E, $16, $E, 6, $1A, $12,	$A, 2
00889156 161E 1A12 060E 0A02        CFlo_Data3:	dc.b $16, $1E, $1A, $12, 6, $E,	$A, 2
0088915E                            
0088915E                            ; ---------------------------------------------------------------------------
0088915E                            ; Sloped platform subroutine (GHZ collapsing ledges and	MZ platforms)
0088915E                            ; ---------------------------------------------------------------------------
0088915E                            
0088915E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088915E                            
0088915E                            
0088915E                            SlopeObject2:				; XREF: Obj1A_WalkOff; et al
0088915E 43F8 D000                  		lea	(v_player).w,a1
00889162 0829 0003 0022             		btst	#3,obStatus(a1)
00889168 6700                       		beq.s	locret_856E
0088916A 3029 0008                  		move.w	obX(a1),d0
0088916E 9068 0008                  		sub.w	obX(a0),d0
00889172 D041                       		add.w	d1,d0
00889174 E248                       		lsr.w	#1,d0
00889176 0828 0000 0001             		btst	#0,obRender(a0)
0088917C 6700                       		beq.s	loc_854E
0088917E 4640                       		not.w	d0
00889180 D041                       		add.w	d1,d0
00889182                            
00889182                            loc_854E:
00889182 7200                       		moveq	#0,d1
00889184 1232 0000                  		move.b	(a2,d0.w),d1
00889188 3028 000C                  		move.w	obY(a0),d0
0088918C 9041                       		sub.w	d1,d0
0088918E 7200                       		moveq	#0,d1
00889190 1229 0016                  		move.b	obHeight(a1),d1
00889194 9041                       		sub.w	d1,d0
00889196 3340 000C                  		move.w	d0,obY(a1)
0088919A 9468 0008                  		sub.w	obX(a0),d2
0088919E 9569 0008                  		sub.w	d2,obX(a1)
008891A2                            
008891A2                            locret_856E:
008891A2 4E75                       		rts	
008891A4                            ; End of function SlopeObject2
008891A4                            
008891A4                            ; ===========================================================================
008891A4                            ; ---------------------------------------------------------------------------
008891A4                            ; Collision data for GHZ collapsing ledge
008891A4                            ; ---------------------------------------------------------------------------
008891A4                            Ledge_SlopeData:
008891A4                            		incbin	"misc\GHZ Collapsing Ledge Heightmap.bin"
008891D4                            		even
008891D4                            
008891D4                            		include	"_maps\Collapsing Ledge.asm"
008891D4                            ; ---------------------------------------------------------------------------
008891D4                            ; Sprite mappings - GHZ	collapsing ledge
008891D4                            ; ---------------------------------------------------------------------------
008891D4 0000 0000                  Map_Ledge:	dc.w @left-Map_Ledge, @right-Map_Ledge
008891D8 0000 0000                  		dc.w @leftsmash-Map_Ledge, @rightsmash-Map_Ledge
008891DC 10                         @left:		dc.b $10
008891DD C80E 0057 10               		dc.b $C8, $E, 0, $57, $10 ; ledge facing left
008891E2 D00D 0063 F0               		dc.b $D0, $D, 0, $63, $F0
008891E7 E00D 006B 10               		dc.b $E0, $D, 0, $6B, $10
008891EC E00D 0073 F0               		dc.b $E0, $D, 0, $73, $F0
008891F1 D806 007B E0               		dc.b $D8, 6, 0,	$7B, $E0
008891F6 D806 0081 D0               		dc.b $D8, 6, 0,	$81, $D0
008891FB F00D 0087 10               		dc.b $F0, $D, 0, $87, $10
00889200 F00D 008F F0               		dc.b $F0, $D, 0, $8F, $F0
00889205 F005 0097 E0               		dc.b $F0, 5, 0,	$97, $E0
0088920A F005 009B D0               		dc.b $F0, 5, 0,	$9B, $D0
0088920F 000D 009F 10               		dc.b 0,	$D, 0, $9F, $10
00889214 0005 00A7 00               		dc.b 0,	5, 0, $A7, 0
00889219 000D 00AB E0               		dc.b 0,	$D, 0, $AB, $E0
0088921E 0005 00B3 D0               		dc.b 0,	5, 0, $B3, $D0
00889223 100D 00AB 10               		dc.b $10, $D, 0, $AB, $10
00889228 1005 00B7 00               		dc.b $10, 5, 0,	$B7, 0
0088922D 10                         @right:		dc.b $10
0088922E C80E 0057 10               		dc.b $C8, $E, 0, $57, $10 ; ledge facing right
00889233 D00D 0063 F0               		dc.b $D0, $D, 0, $63, $F0
00889238 E00D 006B 10               		dc.b $E0, $D, 0, $6B, $10
0088923D E00D 0073 F0               		dc.b $E0, $D, 0, $73, $F0
00889242 D806 007B E0               		dc.b $D8, 6, 0,	$7B, $E0
00889247 D806 00BB D0               		dc.b $D8, 6, 0,	$BB, $D0
0088924C F00D 0087 10               		dc.b $F0, $D, 0, $87, $10
00889251 F00D 008F F0               		dc.b $F0, $D, 0, $8F, $F0
00889256 F005 0097 E0               		dc.b $F0, 5, 0,	$97, $E0
0088925B F005 00C1 D0               		dc.b $F0, 5, 0,	$C1, $D0
00889260 000D 009F 10               		dc.b 0,	$D, 0, $9F, $10
00889265 0005 00A7 00               		dc.b 0,	5, 0, $A7, 0
0088926A 000D 00AB E0               		dc.b 0,	$D, 0, $AB, $E0
0088926F 0005 00B7 D0               		dc.b 0,	5, 0, $B7, $D0
00889274 100D 00AB 10               		dc.b $10, $D, 0, $AB, $10
00889279 1005 00B7 00               		dc.b $10, 5, 0,	$B7, 0
0088927E 19                         @leftsmash:	dc.b $19
0088927F C806 005D 20               		dc.b $C8, 6, 0,	$5D, $20 ; ledge facing	left in	pieces
00889284 C806 0057 10               		dc.b $C8, 6, 0,	$57, $10
00889289 D005 0067 00               		dc.b $D0, 5, 0,	$67, 0
0088928E D005 0063 F0               		dc.b $D0, 5, 0,	$63, $F0
00889293 E005 006F 20               		dc.b $E0, 5, 0,	$6F, $20
00889298 E005 006B 10               		dc.b $E0, 5, 0,	$6B, $10
0088929D E005 0077 00               		dc.b $E0, 5, 0,	$77, 0
008892A2 E005 0073 F0               		dc.b $E0, 5, 0,	$73, $F0
008892A7 D806 007B E0               		dc.b $D8, 6, 0,	$7B, $E0
008892AC D806 0081 D0               		dc.b $D8, 6, 0,	$81, $D0
008892B1 F005 008B 20               		dc.b $F0, 5, 0,	$8B, $20
008892B6 F005 0087 10               		dc.b $F0, 5, 0,	$87, $10
008892BB F005 0093 00               		dc.b $F0, 5, 0,	$93, 0
008892C0 F005 008F F0               		dc.b $F0, 5, 0,	$8F, $F0
008892C5 F005 0097 E0               		dc.b $F0, 5, 0,	$97, $E0
008892CA F005 009B D0               		dc.b $F0, 5, 0,	$9B, $D0
008892CF 0005 008B 20               		dc.b 0,	5, 0, $8B, $20
008892D4 0005 008B 10               		dc.b 0,	5, 0, $8B, $10
008892D9 0005 00A7 00               		dc.b 0,	5, 0, $A7, 0
008892DE 0005 00AB F0               		dc.b 0,	5, 0, $AB, $F0
008892E3 0005 00AB E0               		dc.b 0,	5, 0, $AB, $E0
008892E8 0005 00B3 D0               		dc.b 0,	5, 0, $B3, $D0
008892ED 1005 00AB 20               		dc.b $10, 5, 0,	$AB, $20
008892F2 1005 00AB 10               		dc.b $10, 5, 0,	$AB, $10
008892F7 1005 00B7 00               		dc.b $10, 5, 0,	$B7, 0
008892FC 19                         @rightsmash:	dc.b $19
008892FD C806 005D 20               		dc.b $C8, 6, 0,	$5D, $20 ; ledge facing	right in pieces
00889302 C806 0057 10               		dc.b $C8, 6, 0,	$57, $10
00889307 D005 0067 00               		dc.b $D0, 5, 0,	$67, 0
0088930C D005 0063 F0               		dc.b $D0, 5, 0,	$63, $F0
00889311 E005 006F 20               		dc.b $E0, 5, 0,	$6F, $20
00889316 E005 006B 10               		dc.b $E0, 5, 0,	$6B, $10
0088931B E005 0077 00               		dc.b $E0, 5, 0,	$77, 0
00889320 E005 0073 F0               		dc.b $E0, 5, 0,	$73, $F0
00889325 D806 007B E0               		dc.b $D8, 6, 0,	$7B, $E0
0088932A D806 00BB D0               		dc.b $D8, 6, 0,	$BB, $D0
0088932F F005 008B 20               		dc.b $F0, 5, 0,	$8B, $20
00889334 F005 0087 10               		dc.b $F0, 5, 0,	$87, $10
00889339 F005 0093 00               		dc.b $F0, 5, 0,	$93, 0
0088933E F005 008F F0               		dc.b $F0, 5, 0,	$8F, $F0
00889343 F005 0097 E0               		dc.b $F0, 5, 0,	$97, $E0
00889348 F005 00C1 D0               		dc.b $F0, 5, 0,	$C1, $D0
0088934D 0005 008B 20               		dc.b 0,	5, 0, $8B, $20
00889352 0005 008B 10               		dc.b 0,	5, 0, $8B, $10
00889357 0005 00A7 00               		dc.b 0,	5, 0, $A7, 0
0088935C 0005 00AB F0               		dc.b 0,	5, 0, $AB, $F0
00889361 0005 00AB E0               		dc.b 0,	5, 0, $AB, $E0
00889366 0005 00B7 D0               		dc.b 0,	5, 0, $B7, $D0
0088936B 1005 00AB 20               		dc.b $10, 5, 0,	$AB, $20
00889370 1005 00AB 10               		dc.b $10, 5, 0,	$AB, $10
00889375 1005 00B7 00               		dc.b $10, 5, 0,	$B7, 0
0088937A                            		even
0088937A                            		even
0088937A                            		include	"_maps\Collapsing Floors.asm"
0088937A                            ; ---------------------------------------------------------------------------
0088937A                            ; Sprite mappings - collapsing floors (MZ, SLZ,	SBZ)
0088937A                            ; ---------------------------------------------------------------------------
0088937A 0000 0000                  Map_CFlo:	dc.w byte_874E-Map_CFlo, byte_8763-Map_CFlo
0088937E 0000 0000                  		dc.w byte_878C-Map_CFlo, byte_87A1-Map_CFlo
00889382 04                         byte_874E:	dc.b 4
00889383 F80D 0000 E0               		dc.b $F8, $D, 0, 0, $E0	; MZ and SBZ blocks
00889388 080D 0000 E0               		dc.b 8,	$D, 0, 0, $E0
0088938D F80D 0000 00               		dc.b $F8, $D, 0, 0, 0
00889392 080D 0000 00               		dc.b 8,	$D, 0, 0, 0
00889397 08                         byte_8763:	dc.b 8
00889398 F805 0000 E0               		dc.b $F8, 5, 0,	0, $E0
0088939D F805 0000 F0               		dc.b $F8, 5, 0,	0, $F0
008893A2 F805 0000 00               		dc.b $F8, 5, 0,	0, 0
008893A7 F805 0000 10               		dc.b $F8, 5, 0,	0, $10
008893AC 0805 0000 E0               		dc.b 8,	5, 0, 0, $E0
008893B1 0805 0000 F0               		dc.b 8,	5, 0, 0, $F0
008893B6 0805 0000 00               		dc.b 8,	5, 0, 0, 0
008893BB 0805 0000 10               		dc.b 8,	5, 0, 0, $10
008893C0 04                         byte_878C:	dc.b 4
008893C1 F80D 0000 E0               		dc.b $F8, $D, 0, 0, $E0	; SLZ blocks
008893C6 080D 0008 E0               		dc.b 8,	$D, 0, 8, $E0
008893CB F80D 0000 00               		dc.b $F8, $D, 0, 0, 0
008893D0 080D 0008 00               		dc.b 8,	$D, 0, 8, 0
008893D5 08                         byte_87A1:	dc.b 8
008893D6 F805 0000 E0               		dc.b $F8, 5, 0,	0, $E0
008893DB F805 0004 F0               		dc.b $F8, 5, 0,	4, $F0
008893E0 F805 0000 00               		dc.b $F8, 5, 0,	0, 0
008893E5 F805 0004 10               		dc.b $F8, 5, 0,	4, $10
008893EA 0805 0008 E0               		dc.b 8,	5, 0, 8, $E0
008893EF 0805 000C F0               		dc.b 8,	5, 0, $C, $F0
008893F4 0805 0008 00               		dc.b 8,	5, 0, 8, 0
008893F9 0805 000C 10               		dc.b 8,	5, 0, $C, $10
008893FE                            		even
008893FE                            		even
008893FE                            
008893FE                            		include	"_incObj\1C Scenery.asm"
008893FE                            ; ---------------------------------------------------------------------------
008893FE                            ; Object 1C - scenery (GHZ bridge stump, SLZ lava thrower)
008893FE                            ; ---------------------------------------------------------------------------
008893FE                            
008893FE                            Scenery:				; XREF: Obj_Index
008893FE 7000                       		moveq	#0,d0
00889400 1028 0024                  		move.b	obRoutine(a0),d0
00889404 323B 0000                  		move.w	Scen_Index(pc,d0.w),d1
00889408 4EFB 1000                  		jmp	Scen_Index(pc,d1.w)
0088940C                            ; ===========================================================================
0088940C 0000                       Scen_Index:	dc.w Scen_Main-Scen_Index
0088940E 0000                       		dc.w Scen_ChkDel-Scen_Index
00889410                            ; ===========================================================================
00889410                            
00889410                            Scen_Main:	; Routine 0
00889410 5428 0024                  		addq.b	#2,obRoutine(a0)
00889414 7000                       		moveq	#0,d0
00889416 1028 0028                  		move.b	obSubtype(a0),d0 ; copy object subtype to d0
0088941A C0FC 000A                  		mulu.w	#$A,d0		; multiply by $A
0088941E 43FB 0000                  		lea	Scen_Values(pc,d0.w),a1
00889422 2159 0004                  		move.l	(a1)+,obMap(a0)
00889426 3159 0002                  		move.w	(a1)+,obGfx(a0)
0088942A 0028 0004 0001             		ori.b	#4,obRender(a0)
00889430 1159 001A                  		move.b	(a1)+,obFrame(a0)
00889434 1159 0019                  		move.b	(a1)+,obActWid(a0)
00889438 1159 0018                  		move.b	(a1)+,obPriority(a0)
0088943C 1159 0020                  		move.b	(a1)+,obColType(a0)
00889440                            
00889440                            Scen_ChkDel:	; Routine 2
0088945E 6000 0000                  		bra.w	DisplaySprite
00889462                            ; ===========================================================================
00889462                            ; ---------------------------------------------------------------------------
00889462                            ; Variables for	object $1C are stored in an array
00889462                            ; ---------------------------------------------------------------------------
00889462 0000 0000                  Scen_Values:	dc.l Map_Scen		; mappings address
00889466 44D8                       		dc.w $44D8		; VRAM setting
00889468 0008 0200                  		dc.b 0,	8, 2, 0		; frame, width,	priority, collision response
0088946C 0000 0000                  		dc.l Map_Scen
00889470 44D8                       		dc.w $44D8
00889472 0008 0200                  		dc.b 0,	8, 2, 0
00889476 0000 0000                  		dc.l Map_Scen
0088947A 44D8                       		dc.w $44D8
0088947C 0008 0200                  		dc.b 0,	8, 2, 0
00889480 0088 8568                  		dc.l Map_Bri
00889484 438E                       		dc.w $438E
00889486 0110 0100                  		dc.b 1,	$10, 1,	0
0088948A                            		even
0088948A                            		even
0088948A                            		include	"_maps\Scenery.asm"
0088948A                            ; ---------------------------------------------------------------------------
0088948A                            ; Sprite mappings - SLZ	lava thrower
0088948A                            ; ---------------------------------------------------------------------------
0088948A 0000                       Map_Scen:	dc.w byte_8858-Map_Scen
0088948C 01                         byte_8858:	dc.b 1
0088948D F007 0000 F8               		dc.b $F0, 7, 0,	0, $F8
00889492                            		even
00889492                            		even
00889492                            
00889492                            		include	"_incObj\1D Unused Switch.asm"
00889492                            ; ---------------------------------------------------------------------------
00889492                            ; Object 1D - switch that activates when Sonic touches it
00889492                            ; (this	is not used anywhere in	the game)
00889492                            ; ---------------------------------------------------------------------------
00889492                            
00889492                            MagicSwitch:					; XREF: Obj_Index
00889492 7000                       		moveq	#0,d0
00889494 1028 0024                  		move.b	obRoutine(a0),d0
00889498 323B 0000                  		move.w	Swi_Index(pc,d0.w),d1
0088949C 4EFB 1000                  		jmp	Swi_Index(pc,d1.w)
008894A0                            ; ===========================================================================
008894A0 0000                       Swi_Index:	dc.w Swi_Main-Swi_Index
008894A2 0000                       		dc.w Swi_Action-Swi_Index
008894A4 0000                       		dc.w Swi_Delete-Swi_Index
008894A6                            
008894A6 =00000030                  origY:		= $30		; original y-axis position
008894A6                            ; ===========================================================================
008894A6                            
008894A6                            Swi_Main:	; Routine 0
008894A6 5428 0024                  		addq.b	#2,obRoutine(a0)
008894AA 217C 0000 0000 0004        		move.l	#Map_Swi,obMap(a0)
008894B2 317C 4000 0002             		move.w	#$4000,obGfx(a0)
008894B8 117C 0004 0001             		move.b	#4,obRender(a0)
008894BE 3168 000C 0030             		move.w	obY(a0),origY(a0) ; save position on y-axis
008894C4 117C 0010 0019             		move.b	#$10,obActWid(a0)
008894CA 117C 0005 0018             		move.b	#5,obPriority(a0)
008894D0                            
008894D0                            Swi_Action:	; Routine 2
008894D0 3168 0030 000C             		move.w	origY(a0),obY(a0) ; restore position on y-axis
008894D6 323C 0010                  		move.w	#$10,d1
008894DA 6100 0000                  		bsr.w	Swi_ChkTouch	; check if Sonic touches the switch
008894DE 6700                       		beq.s	Swi_ChkDel	; if not, branch
008894E0                            
008894E0 5468 000C                  		addq.w	#2,obY(a0)	; move object 2	pixels
008894E4 7001                       		moveq	#1,d0
008894E6 31C0 F7E0                  		move.w	d0,(f_switch).w	; set switch 0 as "pressed"
008894EA                            
008894EA                            Swi_ChkDel:
008894EA 6100 0000                  		bsr.w	DisplaySprite
0088950C 4E75                       		rts	
0088950E                            ; ===========================================================================
0088950E                            
0088950E                            Swi_Delete:	; Routine 4
0088950E 6100 0000                  		bsr.w	DeleteObject
00889512 4E75                       		rts	
00889514                            
00889514                            ; ---------------------------------------------------------------------------
00889514                            ; Subroutine to	check if Sonic touches the object
00889514                            ; ---------------------------------------------------------------------------
00889514                            
00889514                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00889514                            
00889514                            
00889514                            Swi_ChkTouch:				; XREF: Swi_Action
00889514 43F8 D000                  		lea	(v_player).w,a1
00889518 3029 0008                  		move.w	obX(a1),d0
0088951C 9068 0008                  		sub.w	obX(a0),d0
00889520 D041                       		add.w	d1,d0
00889522 6B00                       		bmi.s	Swi_NoTouch
00889524 D241                       		add.w	d1,d1
00889526 B041                       		cmp.w	d1,d0
00889528 6400                       		bcc.s	Swi_NoTouch
0088952A 3429 000C                  		move.w	obY(a1),d2
0088952E 1229 0016                  		move.b	obHeight(a1),d1
00889532 4881                       		ext.w	d1
00889534 D242                       		add.w	d2,d1
00889536 3028 000C                  		move.w	obY(a0),d0
0088953A 0440 0010                  		subi.w	#$10,d0
0088953E 9041                       		sub.w	d1,d0
00889540 6200                       		bhi.s	Swi_NoTouch
00889542 0C40 FFF0                  		cmpi.w	#-$10,d0
00889546 6500                       		bcs.s	Swi_NoTouch
00889548 70FF                       		moveq	#-1,d0		; Sonic has touched it
0088954A 4E75                       		rts	
0088954C                            ; ===========================================================================
0088954C                            
0088954C                            Swi_NoTouch:
0088954C 7000                       		moveq	#0,d0		; Sonic hasn't touched it
0088954E 4E75                       		rts	
00889550                            ; End of function Swi_ChkTouch
00889550                            ; End of function Swi_ChkTouch
00889550                            		include	"_maps\Unused Switch.asm"
00889550                            ; ---------------------------------------------------------------------------
00889550                            ; Sprite mappings - Unused switch thingy
00889550                            ; ---------------------------------------------------------------------------
00889550 0000                       Map_Swi:	dc.w byte_891E-Map_Swi
00889552 04                         byte_891E:	dc.b 4
00889553 E807 0054 F0               		dc.b $E8, 7, 0,	$54, $F0
00889558 0805 005C F0               		dc.b 8,	5, 0, $5C, $F0
0088955D E807 0054 00               		dc.b $E8, 7, 0,	$54, 0
00889562 0805 005C 00               		dc.b 8,	5, 0, $5C, 0
00889568 00                         		even
00889568 00                         		even
00889568                            
00889568                            		include	"_incObj\2A SBZ Small Door.asm"
00889568                            ; ---------------------------------------------------------------------------
00889568                            ; Object 2A - small vertical door (SBZ)
00889568                            ; ---------------------------------------------------------------------------
00889568                            
00889568                            AutoDoor:				; XREF: Obj_Index
00889568 7000                       		moveq	#0,d0
0088956A 1028 0024                  		move.b	obRoutine(a0),d0
0088956E 323B 0000                  		move.w	ADoor_Index(pc,d0.w),d1
00889572 4EFB 1000                  		jmp	ADoor_Index(pc,d1.w)
00889576                            ; ===========================================================================
00889576 0000                       ADoor_Index:	dc.w ADoor_Main-ADoor_Index
00889578 0000                       		dc.w ADoor_OpenShut-ADoor_Index
0088957A                            ; ===========================================================================
0088957A                            
0088957A                            ADoor_Main:	; Routine 0
0088957A 5428 0024                  		addq.b	#2,obRoutine(a0)
0088957E 217C 0000 0000 0004        		move.l	#Map_ADoor,obMap(a0)
00889586 317C 42E8 0002             		move.w	#$42E8,obGfx(a0)
0088958C 0028 0004 0001             		ori.b	#4,obRender(a0)
00889592 117C 0008 0019             		move.b	#8,obActWid(a0)
00889598 117C 0004 0018             		move.b	#4,obPriority(a0)
0088959E                            
0088959E                            ADoor_OpenShut:	; Routine 2
0088959E 323C 0040                  		move.w	#$40,d1		; set range for door detection
008895A2 4228 001C                  		clr.b	obAnim(a0)	; use "closing"	animation
008895A6 3038 D008                  		move.w	(v_player+obX).w,d0
008895AA D041                       		add.w	d1,d0
008895AC B068 0008                  		cmp.w	obX(a0),d0
008895B0 6500                       		bcs.s	ADoor_Animate
008895B2 9041                       		sub.w	d1,d0
008895B4 9041                       		sub.w	d1,d0
008895B6 B068 0008                  		cmp.w	obX(a0),d0	; is Sonic > $40 pixels from door?
008895BA 6400                       		bcc.s	ADoor_Animate	; close door
008895BC D041                       		add.w	d1,d0
008895BE B068 0008                  		cmp.w	obX(a0),d0	; is Sonic left of the door?
008895C2 6400                       		bcc.s	loc_899A	; if yes, branch
008895C4 0828 0000 0022             		btst	#0,obStatus(a0)
008895CA 6600                       		bne.s	ADoor_Animate
008895CC 6000                       		bra.s	ADoor_Open
008895CE                            ; ===========================================================================
008895CE                            
008895CE                            loc_899A:
008895CE 0828 0000 0022             		btst	#0,obStatus(a0)
008895D4 6700                       		beq.s	ADoor_Animate
008895D6                            
008895D6                            ADoor_Open:
008895D6 117C 0001 001C             		move.b	#1,obAnim(a0)	; use "opening"	animation
008895DC                            
008895DC                            ADoor_Animate:
008895DC 43F9 0000 0000             		lea	(Ani_ADoor).l,a1
008895E2 6100 0000                  		bsr.w	AnimateSprite
008895E6 4A28 001A                  		tst.b	obFrame(a0)	; is the door open?
008895EA 6600                       		bne.s	@remember	; if yes, branch
008895EC 323C 0011                  		move.w	#$11,d1
008895F0 343C 0020                  		move.w	#$20,d2
008895F4 3602                       		move.w	d2,d3
008895F6 5243                       		addq.w	#1,d3
008895F8 3828 0008                  		move.w	obX(a0),d4
008895FC 6100 0000                  		bsr.w	SolidObject
00889600                            
00889600                            	@remember:
00889600 6000 0000                  		bra.w	RememberState
00889600 6000 0000                  		bra.w	RememberState
00889604                            		include	"_anim\SBZ Small Door.asm"
00889604                            ; ---------------------------------------------------------------------------
00889604                            ; Animation script - doors (SBZ)
00889604                            ; ---------------------------------------------------------------------------
00889604 0000                       Ani_ADoor:	dc.w @close-Ani_ADoor
00889606 0000                       		dc.w @open-Ani_ADoor
00889608 0008 0706 0504 0302 0100+  @close:		dc.b 0,	8, 7, 6, 5, 4, 3, 2, 1,	0, afBack, 1
00889614 0000 0102 0304 0506 0708+  @open:		dc.b 0,	0, 1, 2, 3, 4, 5, 6, 7,	8, afBack, 1
00889620                            		even
00889620                            		even
00889620                            		include	"_maps\SBZ Small Door.asm"
00889620                            ; ---------------------------------------------------------------------------
00889620                            ; Sprite mappings - doors (SBZ)
00889620                            ; ---------------------------------------------------------------------------
00889620 0000 0000                  Map_ADoor:	dc.w @closed-Map_ADoor, @01-Map_ADoor
00889624 0000 0000                  		dc.w @02-Map_ADoor, @03-Map_ADoor
00889628 0000 0000                  		dc.w @04-Map_ADoor, @05-Map_ADoor
0088962C 0000 0000                  		dc.w @06-Map_ADoor, @07-Map_ADoor
00889630 0000                       		dc.w @open-Map_ADoor
00889632 02                         @closed:	dc.b 2
00889633 E007 0800 F8               		dc.b $E0, 7, 8,	0, $F8	; door closed
00889638 0007 0800 F8               		dc.b 0,	7, 8, 0, $F8
0088963D 02                         @01:		dc.b 2
0088963E DC07 0800 F8               		dc.b $DC, 7, 8,	0, $F8
00889643 0407 0800 F8               		dc.b 4,	7, 8, 0, $F8
00889648 02                         @02:		dc.b 2
00889649 D807 0800 F8               		dc.b $D8, 7, 8,	0, $F8
0088964E 0807 0800 F8               		dc.b 8,	7, 8, 0, $F8
00889653 02                         @03:		dc.b 2
00889654 D407 0800 F8               		dc.b $D4, 7, 8,	0, $F8
00889659 0C07 0800 F8               		dc.b $C, 7, 8, 0, $F8
0088965E 02                         @04:		dc.b 2
0088965F D007 0800 F8               		dc.b $D0, 7, 8,	0, $F8
00889664 1007 0800 F8               		dc.b $10, 7, 8,	0, $F8
00889669 02                         @05:		dc.b 2
0088966A CC07 0800 F8               		dc.b $CC, 7, 8,	0, $F8
0088966F 1407 0800 F8               		dc.b $14, 7, 8,	0, $F8
00889674 02                         @06:		dc.b 2
00889675 C807 0800 F8               		dc.b $C8, 7, 8,	0, $F8
0088967A 1807 0800 F8               		dc.b $18, 7, 8,	0, $F8
0088967F 02                         @07:		dc.b 2
00889680 C407 0800 F8               		dc.b $C4, 7, 8,	0, $F8
00889685 1C07 0800 F8               		dc.b $1C, 7, 8,	0, $F8
0088968A 02                         @open:		dc.b 2
0088968B C007 0800 F8               		dc.b $C0, 7, 8,	0, $F8	; door fully open
00889690 2007 0800 F8               		dc.b $20, 7, 8,	0, $F8
00889696 00                         		even
00889696 00                         		even
00889696                            
00889696                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00889696                            
00889696                            
00889696                            Obj44_SolidWall:			; XREF: Obj44_Solid
00889696 6100 0000                  		bsr.w	Obj44_SolidWall2
0088969A 6700                       		beq.s	loc_8AA8
0088969C 6B00 0000                  		bmi.w	loc_8AC4
008896A0                            	
008896A0 7200                       		moveq	#0,d1
008896A2                            	
008896A2 4A40                       		tst.w	d0
008896A4 6700 0000                  		beq.w	loc_8A92
008896A8 6B00                       		bmi.s	loc_8A7C
008896AA 4A69 0010                  		tst.w	obVelX(a1)
008896AE 6B00                       		bmi.s	loc_8A92
008896B0                            		
008896B0 123C 0008                  		move.b	#btnR,d1
008896B4                            		
008896B4 6000                       		bra.s	loc_8A82
008896B6                            ; ===========================================================================
008896B6                            
008896B6                            loc_8A7C:
008896B6 4A69 0010                  		tst.w	obVelX(a1)
008896BA 6A00                       		bpl.s	loc_8A92
008896BC                            		
008896BC 123C 0004                  		move.b	#btnL,d1
008896C0                            
008896C0                            loc_8A82:
008896C0 9169 0008                  		sub.w	d0,obX(a1)
008896C4 337C 0000 0014             		move.w	#0,obInertia(a1)
008896CA 337C 0000 0010             		move.w	#0,obVelX(a1)
008896D0                            
008896D0                            loc_8A92:
008896D0 0829 0001 0022             		btst	#1,obStatus(a1)
008896D6 6600                       		bne.s	loc_8AB6
008896D8 08E9 0005 0022             		bset	#staPush,obStatus(a1)	;Mercury Constants
008896DE 08E8 0005 0022             		bset	#staPush,obStatus(a0)	;Mercury Constants
008896E4 4E75                       		rts	
008896E6                            ; ===========================================================================
008896E6                            
008896E6                            loc_8AA8:
008896E6 0828 0005 0022             		btst	#staPush,obStatus(a0)	;Mercury Constants
008896EC 6700                       		beq.s	locret_8AC2
008896EE                            		
008896EE                            		;move.w	#id_Run,obAnim(a1)	;Mercury Walking In Air Fix
008896EE                            	
008896EE 6000                       		bra.s	loc_8AB6pushclear
008896F0                            
008896F0                            loc_8AB6:
008896F0 2F08                       		move.l	a0,-(sp)
008896F2 2049                       		movea.l	a1,a0
008896F4 4EB9 0000 0000             		jsr	WallJump
008896FA 205F                       		movea.l	(sp)+,a0
008896FC                            
008896FC                            loc_8AB6pushclear:
008896FC                            	
008896FC 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00889702 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
00889708                            
00889708                            locret_8AC2:
00889708 4E75                       		rts	
0088970A                            ; ===========================================================================
0088970A                            
0088970A                            loc_8AC4:
0088970A 4A69 0012                  		tst.w	obVelY(a1)
0088970E 6A00                       		bpl.s	locret_8AD8
00889710 4A43                       		tst.w	d3
00889712 6A00                       		bpl.s	locret_8AD8
00889714 9769 000C                  		sub.w	d3,obY(a1)
00889718 337C 0000 0012             		move.w	#0,obVelY(a1)
0088971E                            
0088971E                            locret_8AD8:
0088971E 4E75                       		rts	
00889720                            ; End of function Obj44_SolidWall
00889720                            
00889720                            
00889720                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00889720                            
00889720                            
00889720                            Obj44_SolidWall2:			; XREF: Obj44_SolidWall
00889720 43F8 D000                  		lea	(v_player).w,a1
00889724 3029 0008                  		move.w	obX(a1),d0
00889728 9068 0008                  		sub.w	obX(a0),d0
0088972C D041                       		add.w	d1,d0
0088972E 6B00                       		bmi.s	loc_8B48
00889730 3601                       		move.w	d1,d3
00889732 D643                       		add.w	d3,d3
00889734 B043                       		cmp.w	d3,d0
00889736 6200                       		bhi.s	loc_8B48
00889738 1629 0016                  		move.b	obHeight(a1),d3
0088973C 4883                       		ext.w	d3
0088973E D443                       		add.w	d3,d2
00889740 3629 000C                  		move.w	obY(a1),d3
00889744                            		
00889744                            	;Mercury Ducking Size Fix
00889744                            	
00889744 0C29 0000 001C             		cmpi.b	#id_SpinDash,obAnim(a1)
0088974A 6700                       		beq.s	@short
0088974C                            	
0088974C 0C29 0000 001C             		cmpi.b	#id_Duck,obAnim(a1)
00889752 6600                       		bne.s	@skip
00889754                            		
00889754                            	@short:
00889754 0442 0005                  		subi.w	#5,d2
00889758 0643 0005                  		addi.w	#5,d3
0088975C                            		
0088975C                            	@skip:
0088975C                            	;end Ducking Size Fix
0088975C                            		
0088975C 9668 000C                  		sub.w	obY(a0),d3
00889760 D642                       		add.w	d2,d3
00889762 6B00                       		bmi.s	loc_8B48
00889764 3802                       		move.w	d2,d4
00889766 D844                       		add.w	d4,d4
00889768 B644                       		cmp.w	d4,d3
0088976A 6400                       		bcc.s	loc_8B48
0088976C 4A38 F7C8                  		tst.b	(f_lockmulti).w
00889770 6B00                       		bmi.s	loc_8B48
00889772 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w
00889778 6400                       		bcc.s	loc_8B48
0088977A 4A78 FE08                  		tst.w	(v_debuguse).w
0088977E 6600                       		bne.s	loc_8B48
00889780 3A00                       		move.w	d0,d5
00889782 B240                       		cmp.w	d0,d1
00889784 6400                       		bcc.s	loc_8B30
00889786 D241                       		add.w	d1,d1
00889788 9041                       		sub.w	d1,d0
0088978A 3A00                       		move.w	d0,d5
0088978C 4445                       		neg.w	d5
0088978E                            
0088978E                            loc_8B30:
0088978E 3203                       		move.w	d3,d1
00889790 B443                       		cmp.w	d3,d2
00889792 6400                       		bcc.s	loc_8B3C
00889794 9644                       		sub.w	d4,d3
00889796 3203                       		move.w	d3,d1
00889798 4441                       		neg.w	d1
0088979A                            
0088979A                            loc_8B3C:
0088979A BA41                       		cmp.w	d1,d5
0088979C 6200                       		bhi.s	loc_8B44
0088979E 7801                       		moveq	#1,d4
008897A0 4E75                       		rts	
008897A2                            ; ===========================================================================
008897A2                            
008897A2                            loc_8B44:
008897A2 78FF                       		moveq	#-1,d4
008897A4 4E75                       		rts	
008897A6                            ; ===========================================================================
008897A6                            
008897A6                            loc_8B48:
008897A6 7800                       		moveq	#0,d4
008897A8 4E75                       		rts	
008897AA                            ; End of function Obj44_SolidWall2
008897AA                            
008897AA                            ; ===========================================================================
008897AA                            
008897AA                            		include	"_incObj\1E Ball Hog.asm"
008897AA                            ; ---------------------------------------------------------------------------
008897AA                            ; Object 1E - Ball Hog enemy (SBZ)
008897AA                            ; ---------------------------------------------------------------------------
008897AA                            
008897AA                            BallHog:				; XREF: Obj_Index
008897AA 7000                       		moveq	#0,d0
008897AC 1028 0024                  		move.b	obRoutine(a0),d0
008897B0 323B 0000                  		move.w	Hog_Index(pc,d0.w),d1
008897B4 4EFB 1000                  		jmp	Hog_Index(pc,d1.w)
008897B8                            ; ===========================================================================
008897B8 0000                       Hog_Index:	dc.w Hog_Main-Hog_Index
008897BA 0000                       		dc.w Hog_Action-Hog_Index
008897BC                            
008897BC =00000032                  launchflag:	= $32		; 0 to launch a cannonball
008897BC                            ; ===========================================================================
008897BC                            
008897BC                            Hog_Main:	; Routine 0
008897BC 117C 0013 0016             		move.b	#$13,obHeight(a0)
008897C2 117C 0008 0017             		move.b	#8,obWidth(a0)
008897C8 217C 0000 0000 0004        		move.l	#Map_Hog,obMap(a0)
008897D0 317C 2302 0002             		move.w	#$2302,obGfx(a0)
008897D6 117C 0004 0001             		move.b	#4,obRender(a0)
008897DC 117C 0004 0018             		move.b	#4,obPriority(a0)
008897E2 117C 0005 0020             		move.b	#5,obColType(a0)
008897E8 117C 000C 0019             		move.b	#$C,obActWid(a0)
008897EE 6100 0000                  		bsr.w	ObjectMoveAndFall
008897F2 4EB9 0000 0000             		jsr	ObjFloorDist	; find floor
008897F8 4A41                       		tst.w	d1
008897FA 6A00                       		bpl.s	@floornotfound
008897FC D368 000C                  		add.w	d1,obY(a0)
00889800 317C 0000 0012             		move.w	#0,obVelY(a0)
00889806 5428 0024                  		addq.b	#2,obRoutine(a0)
0088980A                            
0088980A                            	@floornotfound:
0088980A 4E75                       		rts	
0088980C                            ; ===========================================================================
0088980C                            
0088980C                            Hog_Action:	; Routine 2
0088980C 43F9 0000 0000             		lea	(Ani_Hog).l,a1
00889812 6100 0000                  		bsr.w	AnimateSprite
00889816 0C28 0001 001A             		cmpi.b	#1,obFrame(a0)	; is final frame (01) displayed?
0088981C 6600                       		bne.s	@setlaunchflag	; if not, branch
0088981E 4A28 0032                  		tst.b	launchflag(a0)	; is it	set to launch cannonball?
00889822 6700                       		beq.s	@makeball	; if yes, branch
00889824 6000                       		bra.s	@remember
00889826                            ; ===========================================================================
00889826                            
00889826                            @setlaunchflag:
00889826 4228 0032                  		clr.b	launchflag(a0)	; set to launch	cannonball
0088982A                            
0088982A                            @remember:
0088982A 6000 0000                  		bra.w	RememberState
0088982E                            ; ===========================================================================
0088982E                            
0088982E                            @makeball:
0088982E 117C 0001 0032             		move.b	#1,launchflag(a0)
00889834 6100 0000                  		bsr.w	FindFreeObj
00889838 6600                       		bne.s	@fail
0088983A 137C 0000 0000             		move.b	#id_Cannonball,0(a1) ; load cannonball object ($20)
00889840 3368 0008 0008             		move.w	obX(a0),obX(a1)
00889846 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088984C 337C FF00 0010             		move.w	#-$100,obVelX(a1) ; cannonball bounces to the left
00889852 337C 0000 0012             		move.w	#0,obVelY(a1)
00889858 70FC                       		moveq	#-4,d0
0088985A 0828 0000 0022             		btst	#0,obStatus(a0)	; is Ball Hog facing right?
00889860 6700                       		beq.s	@noflip		; if not, branch
00889862 4440                       		neg.w	d0
00889864 4469 0010                  		neg.w	obVelX(a1)	; cannonball bounces to	the right
00889868                            
00889868                            	@noflip:
00889868 D169 0008                  		add.w	d0,obX(a1)
0088986C 0669 000C 000C             		addi.w	#$C,obY(a1)
00889872 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1) ; copy object type from Ball Hog
00889878                            
00889878                            	@fail:
00889878 60B0                       		bra.s	@remember
00889878 60B0                       		bra.s	@remember
0088987A                            		include	"_incObj\20 Cannonball.asm"
0088987A                            ; ---------------------------------------------------------------------------
0088987A                            ; Object 20 - cannonball that Ball Hog throws (SBZ)
0088987A                            ; ---------------------------------------------------------------------------
0088987A                            
0088987A                            Cannonball:				; XREF: Obj_Index
0088987A 7000                       		moveq	#0,d0
0088987C 1028 0024                  		move.b	obRoutine(a0),d0
00889880 323B 0000                  		move.w	Cbal_Index(pc,d0.w),d1
00889884 4EFB 1000                  		jmp	Cbal_Index(pc,d1.w)
00889888                            ; ===========================================================================
00889888 0000                       Cbal_Index:	dc.w Cbal_Main-Cbal_Index
0088988A 0000                       		dc.w Cbal_Bounce-Cbal_Index
0088988C                            
0088988C =00000030                  cbal_time:	= $30		; time until the cannonball explodes (2 bytes)
0088988C                            ; ===========================================================================
0088988C                            
0088988C                            Cbal_Main:	; Routine 0
0088988C 5428 0024                  		addq.b	#2,obRoutine(a0)
00889890 117C 0007 0016             		move.b	#7,obHeight(a0)
00889896 217C 0000 0000 0004        		move.l	#Map_Hog,obMap(a0)
0088989E 317C 2302 0002             		move.w	#$2302,obGfx(a0)
008898A4 117C 0004 0001             		move.b	#4,obRender(a0)
008898AA 117C 0003 0018             		move.b	#3,obPriority(a0)
008898B0 117C 0087 0020             		move.b	#$87,obColType(a0)
008898B6 117C 0008 0019             		move.b	#8,obActWid(a0)
008898BC 7000                       		moveq	#0,d0
008898BE 1028 0028                  		move.b	obSubtype(a0),d0 ; move subtype to d0
008898C2 C0FC 003C                  		mulu.w	#60,d0		; multiply by 60 frames	(1 second)
008898C6 3140 0030                  		move.w	d0,cbal_time(a0) ; set explosion time
008898CA 117C 0004 001A             		move.b	#4,obFrame(a0)
008898D0                            
008898D0                            Cbal_Bounce:	; Routine 2
008898D0 4EB9 0000 0000             		jsr	ObjectMoveAndFall
008898D6 4A68 0012                  		tst.w	obVelY(a0)
008898DA 6B00                       		bmi.s	Cbal_ChkExplode
008898DC 4EB9 0000 0000             		jsr	ObjFloorDist
008898E2 4A41                       		tst.w	d1		; has ball hit the floor?
008898E4 6A00                       		bpl.s	Cbal_ChkExplode	; if not, branch
008898E6                            
008898E6 D368 000C                  		add.w	d1,obY(a0)
008898EA 317C FD00 0012             		move.w	#-$300,obVelY(a0) ; bounce
008898F0 4A03                       		tst.b	d3
008898F2 6700                       		beq.s	Cbal_ChkExplode
008898F4 6B00                       		bmi.s	loc_8CA4
008898F6 4A68 0010                  		tst.w	obVelX(a0)
008898FA 6A00                       		bpl.s	Cbal_ChkExplode
008898FC 4468 0010                  		neg.w	obVelX(a0)
00889900 6000                       		bra.s	Cbal_ChkExplode
00889902                            ; ===========================================================================
00889902                            
00889902                            loc_8CA4:
00889902 4A68 0010                  		tst.w	obVelX(a0)
00889906 6B00                       		bmi.s	Cbal_ChkExplode
00889908 4468 0010                  		neg.w	obVelX(a0)
0088990C                            
0088990C                            Cbal_ChkExplode:			; XREF: Cbal_Bounce
0088990C 5368 0030                  		subq.w	#1,cbal_time(a0) ; subtract 1 from explosion time
00889910 6A00                       		bpl.s	Cbal_Animate	; if time is > 0, branch
00889912                            
00889912                            	Cbal_Explode:
00889912 117C 0000 0000             		move.b	#id_MissileDissolve,0(a0)
00889918 117C 0000 0000             		move.b	#id_ExplosionBomb,0(a0)	; change object	to an explosion	($3F)
0088991E 117C 0000 0024             		move.b	#0,obRoutine(a0) ; reset routine counter
00889924 6000 0000                  		bra.w	ExplosionBomb	; jump to explosion code
00889928                            ; ===========================================================================
00889928                            
00889928                            Cbal_Animate:
00889928 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
0088992C 6A00                       		bpl.s	Cbal_Display
0088992E 117C 0005 001E             		move.b	#5,obTimeFrame(a0) ; set frame duration to 5 frames
00889934 0868 0000 001A             		bchg	#0,obFrame(a0)	; change frame
0088993A                            
0088993A                            Cbal_Display:
0088993A 6100 0000                  		bsr.w	DisplaySprite
0088993E 3038 F72E                  		move.w	(v_limitbtm2).w,d0
00889942 0640 00E0                  		addi.w	#$E0,d0
00889946 B068 000C                  		cmp.w	obY(a0),d0	; has object fallen off	the level?
0088994A 6500 0000                  		bcs.w	DeleteObject	; if yes, branch
0088994E 4E75                       		rts	
0088994E 4E75                       		rts	
00889950                            		include	"_incObj\24, 27 & 3F Explosions.asm"
00889950                            ; ---------------------------------------------------------------------------
00889950                            ; Object 24 - buzz bomber missile vanishing (unused?)
00889950                            ; ---------------------------------------------------------------------------
00889950                            
00889950                            MissileDissolve:				; XREF: Obj_Index
00889950 7000                       		moveq	#0,d0
00889952 1028 0024                  		move.b	obRoutine(a0),d0
00889956 323B 0000                  		move.w	MDis_Index(pc,d0.w),d1
0088995A 4EFB 1000                  		jmp	MDis_Index(pc,d1.w)
0088995E                            ; ===========================================================================
0088995E 0000                       MDis_Index:	dc.w MDis_Main-MDis_Index
00889960 0000                       		dc.w MDis_Animate-MDis_Index
00889962                            ; ===========================================================================
00889962                            
00889962                            MDis_Main:	; Routine 0
00889962 5428 0024                  		addq.b	#2,obRoutine(a0)
00889966 217C 0000 0000 0004        		move.l	#Map_MisDissolve,obMap(a0)
0088996E 317C 041C 0002             		move.w	#$41C,obGfx(a0)
00889974 117C 0004 0001             		move.b	#4,obRender(a0)
0088997A 117C 0001 0018             		move.b	#1,obPriority(a0)
00889980 117C 0000 0020             		move.b	#0,obColType(a0)
00889986 117C 000C 0019             		move.b	#$C,obActWid(a0)
0088998C 117C 0009 001E             		move.b	#9,obTimeFrame(a0)
00889992 117C 0000 001A             		move.b	#0,obFrame(a0)
008899A2                            
008899A2                            MDis_Animate:	; Routine 2
008899A2 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
008899A6 6A00                       		bpl.s	@display
008899A8 117C 0009 001E             		move.b	#9,obTimeFrame(a0) ; set frame duration to 9 frames
008899AE 5228 001A                  		addq.b	#1,obFrame(a0)	; next frame
008899B2 0C28 0004 001A             		cmpi.b	#4,obFrame(a0)	; has animation completed?
008899B8 6700 0000                  		beq.w	DeleteObject	; if yes, branch
008899BC                            
008899BC                            	@display:
008899BC 6000 0000                  		bra.w	DisplaySprite
008899C0                            ; ===========================================================================
008899C0                            
008899C0                            ; ---------------------------------------------------------------------------
008899C0                            ; Object 27 - explosion	from a destroyed enemy or monitor
008899C0                            ; ---------------------------------------------------------------------------
008899C0                            
008899C0                            ExplosionItem:				; XREF: Obj_Index
008899C0 7000                       		moveq	#0,d0
008899C2 1028 0024                  		move.b	obRoutine(a0),d0
008899C6 323B 0000                  		move.w	ExItem_Index(pc,d0.w),d1
008899CA 4EFB 1000                  		jmp	ExItem_Index(pc,d1.w)
008899CE                            ; ===========================================================================
008899CE 0000                       ExItem_Index:	dc.w ExItem_Animal-ExItem_Index
008899D0 0000                       		dc.w ExItem_Main-ExItem_Index
008899D2 0000                       		dc.w ExItem_Animate-ExItem_Index
008899D4                            ; ===========================================================================
008899D4                            
008899D4                            ExItem_Animal:	; Routine 0
008899D4 5428 0024                  		addq.b	#2,obRoutine(a0)
008899D8 6100 0000                  		bsr.w	FindFreeObj
008899DC 6600                       		bne.s	ExItem_Main
008899DE 137C 0000 0000             		move.b	#id_Animals,0(a1) ; load animal object
008899E4 3368 0008 0008             		move.w	obX(a0),obX(a1)
008899EA 3368 000C 000C             		move.w	obY(a0),obY(a1)
008899F0 3368 003E 003E             		move.w	$3E(a0),$3E(a1)
008899F6                            
008899F6                            ExItem_Main:	; Routine 2
008899F6 5428 0024                  		addq.b	#2,obRoutine(a0)
008899FA 217C 0000 0000 0004        		move.l	#Map_ExplodeItem,obMap(a0)
00889A02 317C 05A0 0002             		move.w	#$5A0,obGfx(a0)
00889A08 117C 0004 0001             		move.b	#4,obRender(a0)
00889A0E 117C 0001 0018             		move.b	#1,obPriority(a0)
00889A14 117C 0000 0020             		move.b	#0,obColType(a0)
00889A1A 117C 000C 0019             		move.b	#$C,obActWid(a0)
00889A20 117C 0007 001E             		move.b	#7,obTimeFrame(a0) ; set frame duration to 7 frames
00889A26 117C 0000 001A             		move.b	#0,obFrame(a0)
00889A36                            
00889A36                            ExItem_Animate:	; Routine 4 (2 for ExplosionBomb)
00889A36 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
00889A3A 6A00                       		bpl.s	@display
00889A3C 117C 0007 001E             		move.b	#7,obTimeFrame(a0) ; set frame duration to 7 frames
00889A42 5228 001A                  		addq.b	#1,obFrame(a0)	; next frame
00889A46 0C28 0005 001A             		cmpi.b	#5,obFrame(a0)	; is the final frame (05) displayed?
00889A4C 6700 0000                  		beq.w	DeleteObject	; if yes, branch
00889A50                            
00889A50                            	@display:
00889A50 6000 0000                  		bra.w	DisplaySprite
00889A54                            ; ===========================================================================
00889A54                            ; ---------------------------------------------------------------------------
00889A54                            ; Object 3F - explosion	from a destroyed boss, bomb or cannonball
00889A54                            ; ---------------------------------------------------------------------------
00889A54                            
00889A54                            ExplosionBomb:				; XREF: Obj_Index
00889A54 7000                       		moveq	#0,d0
00889A56 1028 0024                  		move.b	obRoutine(a0),d0
00889A5A 323B 0000                  		move.w	ExBom_Index(pc,d0.w),d1
00889A5E 4EFB 1000                  		jmp	ExBom_Index(pc,d1.w)
00889A62                            ; ===========================================================================
00889A62 0000                       ExBom_Index:	dc.w ExBom_Main-ExBom_Index
00889A64 FFD4                       		dc.w ExItem_Animate-ExBom_Index
00889A66                            ; ===========================================================================
00889A66                            
00889A66                            ExBom_Main:	; Routine 0
00889A66 5428 0024                  		addq.b	#2,obRoutine(a0)
00889A6A 217C 0000 0000 0004        		move.l	#Map_ExplodeBomb,obMap(a0)
00889A72 317C 05A0 0002             		move.w	#$5A0,obGfx(a0)
00889A78 117C 0004 0001             		move.b	#4,obRender(a0)
00889A7E 117C 0001 0018             		move.b	#1,obPriority(a0)
00889A84 117C 0000 0020             		move.b	#0,obColType(a0)
00889A8A 117C 000C 0019             		move.b	#$C,obActWid(a0)
00889A90 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
00889A96 117C 0000 001A             		move.b	#0,obFrame(a0)
00889AA6                            		include	"_anim\Ball Hog.asm"
00889AA6                            ; ---------------------------------------------------------------------------
00889AA6                            ; Animation script - doors (SBZ)
00889AA6                            ; ---------------------------------------------------------------------------
00889AA6 0000                       Ani_Hog:	dc.w @hog-Ani_Hog
00889AA8 0900 0002 0203 0200 0002+  @hog:		dc.b 9,	0, 0, 2, 2, 3, 2, 0, 0,	2, 2, 3, 2, 0, 0, 2, 2, 3, 2, 0, 0, 1, afEnd
00889AC0 00                         		even
00889AC0 00                         		even
00889AC0                            		include	"_maps\Ball Hog.asm"
00889AC0                            ; ---------------------------------------------------------------------------
00889AC0                            ; Sprite mappings - Ball Hog enemy (SBZ)
00889AC0                            ; ---------------------------------------------------------------------------
00889AC0 0000                       Map_Hog:	dc.w M_Hog_Stand-Map_Hog
00889AC2 0000                       		dc.w M_Hog_Open-Map_Hog
00889AC4 0000                       		dc.w M_Hog_Squat-Map_Hog
00889AC6 0000                       		dc.w M_Hog_Leap-Map_Hog
00889AC8 0000                       		dc.w M_Hog_Ball1-Map_Hog
00889ACA 0000                       		dc.w M_Hog_Ball2-Map_Hog
00889ACC 02                         M_Hog_Stand:	dc.b 2
00889ACD EF09 0000 F4               		dc.b $EF, 9, 0,	0, $F4
00889AD2 FF0A 0006 F4               		dc.b $FF, $A, 0, 6, $F4	; Ball hog standing
00889AD7 02                         M_Hog_Open:	dc.b 2
00889AD8 EF09 0000 F4               		dc.b $EF, 9, 0,	0, $F4
00889ADD FF0A 000F F4               		dc.b $FF, $A, 0, $F, $F4 ; Ball hog with hatch open
00889AE2 02                         M_Hog_Squat:	dc.b 2
00889AE3 F409 0000 F4               		dc.b $F4, 9, 0,	0, $F4
00889AE8 0409 0018 F4               		dc.b 4,	9, 0, $18, $F4	; Ball hog squatting
00889AED 02                         M_Hog_Leap:	dc.b 2
00889AEE E409 0000 F4               		dc.b $E4, 9, 0,	0, $F4
00889AF3 F40A 001E F4               		dc.b $F4, $A, 0, $1E, $F4 ; Ball hog leaping
00889AF8 01                         M_Hog_Ball1:	dc.b 1
00889AF9 F805 0027 F8               		dc.b $F8, 5, 0,	$27, $F8 ; Ball (black)
00889AFE 01                         M_Hog_Ball2:	dc.b 1
00889AFF F805 002B F8               		dc.b $F8, 5, 0,	$2B, $F8 ; Ball (red)
00889B04                            		even
00889B04                            		even
00889B04                            		include	"_maps\Buzz Bomber Missile Dissolve.asm"
00889B04                            ; ---------------------------------------------------------------------------
00889B04                            ; Sprite mappings - buzz bomber missile vanishing
00889B04                            ; ---------------------------------------------------------------------------
00889B04 0000 0000                  Map_MisDissolve:dc.w byte_8EAE-Map_MisDissolve, byte_8EB4-Map_MisDissolve
00889B08 0000 0000                  		dc.w byte_8EBA-Map_MisDissolve, byte_8EC0-Map_MisDissolve
00889B0C 01                         byte_8EAE:	dc.b 1
00889B0D F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
00889B12 01                         byte_8EB4:	dc.b 1
00889B13 F40A 0009 F4               		dc.b $F4, $A, 0, 9, $F4
00889B18 01                         byte_8EBA:	dc.b 1
00889B19 F40A 0012 F4               		dc.b $F4, $A, 0, $12, $F4
00889B1E 01                         byte_8EC0:	dc.b 1
00889B1F F40A 001B F4               		dc.b $F4, $A, 0, $1B, $F4
00889B24                            		even
00889B24                            		even
00889B24                            		include	"_maps\Explosions.asm"
00889B24                            ; ---------------------------------------------------------------------------
00889B24                            ; Sprite mappings - explosion from a badnik or monitor
00889B24                            ; ---------------------------------------------------------------------------
00889B24 0000 0000                  Map_ExplodeItem:dc.w byte_8ED0-Map_ExplodeItem, byte_8ED6-Map_ExplodeItem
00889B28 0000 0000                  		dc.w byte_8EDC-Map_ExplodeItem, byte_8EE2-Map_ExplodeItem
00889B2C 0000                       		dc.w byte_8EF7-Map_ExplodeItem
00889B2E 01                         byte_8ED0:	dc.b 1
00889B2F F809 0000 F4               		dc.b $F8, 9, 0,	0, $F4
00889B34 01                         byte_8ED6:	dc.b 1
00889B35 F00F 0006 F0               		dc.b $F0, $F, 0, 6, $F0
00889B3A 01                         byte_8EDC:	dc.b 1
00889B3B F00F 0016 F0               		dc.b $F0, $F, 0, $16, $F0
00889B40 04                         byte_8EE2:	dc.b 4
00889B41 EC0A 0026 EC               		dc.b $EC, $A, 0, $26, $EC
00889B46 EC05 002F 04               		dc.b $EC, 5, 0,	$2F, 4
00889B4B 0405 182F EC               		dc.b 4,	5, $18,	$2F, $EC
00889B50 FC0A 1826 FC               		dc.b $FC, $A, $18, $26,	$FC
00889B55 04                         byte_8EF7:	dc.b 4
00889B56 EC0A 0033 EC               		dc.b $EC, $A, 0, $33, $EC
00889B5B EC05 003C 04               		dc.b $EC, 5, 0,	$3C, 4
00889B60 0405 183C EC               		dc.b 4,	5, $18,	$3C, $EC
00889B65 FC0A 1833 FC               		dc.b $FC, $A, $18, $33,	$FC
00889B6A                            		even
00889B6A                            ; ---------------------------------------------------------------------------
00889B6A                            ; Sprite mappings - explosion from when	a boss is destroyed
00889B6A                            ; ---------------------------------------------------------------------------
00889B6A FFC4                       Map_ExplodeBomb:dc.w byte_8ED0-Map_ExplodeBomb
00889B6C 0000                       		dc.w byte_8F16-Map_ExplodeBomb
00889B6E 0000                       		dc.w byte_8F1C-Map_ExplodeBomb
00889B70 FFD6                       		dc.w byte_8EE2-Map_ExplodeBomb
00889B72 FFEB                       		dc.w byte_8EF7-Map_ExplodeBomb
00889B74 01                         byte_8F16:	dc.b 1
00889B75 F00F 0040 F0               		dc.b $F0, $F, 0, $40, $F0
00889B7A 01                         byte_8F1C:	dc.b 1
00889B7B F00F 0050 F0               		dc.b $F0, $F, 0, $50, $F0
00889B80                            		even
00889B80                            		
00889B80                            		
00889B80                            
00889B80                            		include	"_incObj\28 Animals.asm"
00889B80                            ; ---------------------------------------------------------------------------
00889B80                            ; Object 28 - animals
00889B80                            ; ---------------------------------------------------------------------------
00889B80                            
00889B80                            Animals:				; XREF: Obj_Index
00889B80 7000                       		moveq	#0,d0
00889B82 1028 0024                  		move.b	obRoutine(a0),d0
00889B86 323B 0000                  		move.w	Anml_Index(pc,d0.w),d1
00889B8A 4EFB 1000                  		jmp	Anml_Index(pc,d1.w)
00889B8E                            ; ===========================================================================
00889B8E 0000 0000                  Anml_Index:	dc.w Anml_Ending-Anml_Index, loc_912A-Anml_Index
00889B92 0000 0000                  		dc.w loc_9184-Anml_Index, loc_91C0-Anml_Index
00889B96 0000 0000                  		dc.w loc_9184-Anml_Index, loc_9184-Anml_Index
00889B9A 0000 0000                  		dc.w loc_9184-Anml_Index, loc_91C0-Anml_Index
00889B9E 0000 0000                  		dc.w loc_9184-Anml_Index, loc_9240-Anml_Index
00889BA2 0000 0000                  		dc.w loc_9260-Anml_Index, loc_9260-Anml_Index
00889BA6 0000 0000                  		dc.w loc_9280-Anml_Index, loc_92BA-Anml_Index
00889BAA 0000 0000                  		dc.w loc_9314-Anml_Index, loc_9332-Anml_Index
00889BAE 0000 0000                  		dc.w loc_9314-Anml_Index, loc_9332-Anml_Index
00889BB2 0000 0000                  		dc.w loc_9314-Anml_Index, loc_9370-Anml_Index
00889BB6 0000                       		dc.w loc_92D6-Anml_Index
00889BB8                            
00889BB8 0005 0203 0603 0405 0401+  Anml_VarIndex:	dc.b 0,	5, 2, 3, 6, 3, 4, 5, 4,	1, 0, 1
00889BC4                            
00889BC4 FE00 FC00                  Anml_Variables:	dc.w $FE00, $FC00
00889BC8 0000 0000                  		dc.l Map_Animal1
00889BCC FE00 FD00                  		dc.w $FE00, $FD00	; horizontal speed, vertical speed
00889BD0 0000 0000                  		dc.l Map_Animal2	; mappings address
00889BD4 FE80 FD00                  		dc.w $FE80, $FD00
00889BD8 0000 0000                  		dc.l Map_Animal1
00889BDC FEC0 FE80                  		dc.w $FEC0, $FE80
00889BE0 0000 0000                  		dc.l Map_Animal2
00889BE4 FE40 FD00                  		dc.w $FE40, $FD00
00889BE8 0000 0000                  		dc.l Map_Animal3
00889BEC FD00 FC00                  		dc.w $FD00, $FC00
00889BF0 0000 0000                  		dc.l Map_Animal2
00889BF4 FD80 FC80                  		dc.w $FD80, $FC80
00889BF8 0000 0000                  		dc.l Map_Animal3
00889BFC                            
00889BFC FBC0 FC00 FBC0 FC00 FBC0+  Anml_EndSpeed:	dc.w $FBC0, $FC00, $FBC0, $FC00, $FBC0,	$FC00, $FD00, $FC00
00889C0C FD00 FC00 FE80 FD00 FE80+  		dc.w $FD00, $FC00, $FE80, $FD00, $FE80,	$FD00, $FEC0, $FE80
00889C1C FE40 FD00 FE00 FD00 FD80+  		dc.w $FE40, $FD00, $FE00, $FD00, $FD80,	$FC80
00889C28                            
00889C28 0000 0000 0000 0000 0000+  Anml_EndMap:	dc.l Map_Animal2, Map_Animal2, Map_Animal2, Map_Animal1, Map_Animal1
00889C3C 0000 0000 0000 0000 0000+  		dc.l Map_Animal1, Map_Animal1, Map_Animal2, Map_Animal3, Map_Animal2
00889C50 0000 0000                  		dc.l Map_Animal3
00889C54                            
00889C54 05A5 05A5 05A5 0553 0553+  Anml_EndVram:	dc.w $5A5, $5A5, $5A5, $553, $553, $573, $573, $585, $593
00889C66 0565 05B3                  		dc.w $565, $5B3
00889C6A                            ; ===========================================================================
00889C6A                            
00889C6A                            Anml_Ending:	; Routine 0
00889C6A 4A28 0028                  		tst.b	obSubtype(a0)	; did animal come from a destroyed enemy?
00889C6E 6700 0000                  		beq.w	Anml_FromEnemy	; if yes, branch
00889C72 7000                       		moveq	#0,d0
00889C74 1028 0028                  		move.b	obSubtype(a0),d0 ; move object type to d0
00889C78 D040                       		add.w	d0,d0		; multiply d0 by 2
00889C7A 1140 0024                  		move.b	d0,obRoutine(a0) ; move d0 to routine counter
00889C7E 0440 0014                  		subi.w	#$14,d0
00889C82 317B 00D0 0002             		move.w	Anml_EndVram(pc,d0.w),obGfx(a0)
00889C88 D040                       		add.w	d0,d0
00889C8A 217B 009C 0004             		move.l	Anml_EndMap(pc,d0.w),obMap(a0)
00889C90 43FA FF6A                  		lea	Anml_EndSpeed(pc),a1
00889C94 3171 0000 0032             		move.w	(a1,d0.w),$32(a0) ; load horizontal speed
00889C9A 3171 0000 0010             		move.w	(a1,d0.w),obVelX(a0)
00889CA0 3171 0002 0034             		move.w	2(a1,d0.w),$34(a0) ; load vertical speed
00889CA6 3171 0002 0012             		move.w	2(a1,d0.w),obVelY(a0)
00889CAC 117C 000C 0016             		move.b	#$C,obHeight(a0)
00889CB2 117C 0004 0001             		move.b	#4,obRender(a0)
00889CB8 08E8 0000 0001             		bset	#0,obRender(a0)
00889CBE 117C 0006 0018             		move.b	#6,obPriority(a0)
00889CC4 117C 0008 0019             		move.b	#8,obActWid(a0)
00889CCA 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
00889CD0 6000 0000                  		bra.w	DisplaySprite
00889CD4                            ; ===========================================================================
00889CD4                            
00889CD4                            Anml_FromEnemy:			; XREF: Anml_Ending
00889CD4 5428 0024                  		addq.b	#2,obRoutine(a0)
00889CD8 6100 931C                  		bsr.w	RandomNumber
00889CDC 0240 0001                  		andi.w	#1,d0
00889CE0 7200                       		moveq	#0,d1
00889CE2 1238 FE10                  		move.b	(v_zone).w,d1
00889CE6 D241                       		add.w	d1,d1
00889CE8 D240                       		add.w	d0,d1
00889CEA 43FA FECC                  		lea	Anml_VarIndex(pc),a1
00889CEE 1031 1000                  		move.b	(a1,d1.w),d0
00889CF2 1140 0030                  		move.b	d0,$30(a0)
00889CF6 E748                       		lsl.w	#3,d0
00889CF8 43FA FECA                  		lea	Anml_Variables(pc),a1
00889CFC D2C0                       		adda.w	d0,a1
00889CFE 3159 0032                  		move.w	(a1)+,$32(a0)	; load horizontal speed
00889D02 3159 0034                  		move.w	(a1)+,$34(a0)	; load vertical	speed
00889D06 2159 0004                  		move.l	(a1)+,obMap(a0)	; load mappings
00889D0A 317C 0580 0002             		move.w	#$580,obGfx(a0)	; VRAM setting for 1st animal
00889D10 0828 0000 0030             		btst	#0,$30(a0)	; is 1st animal	used?
00889D16 6700                       		beq.s	loc_90C0	; if yes, branch
00889D18 317C 0592 0002             		move.w	#$592,obGfx(a0)	; VRAM setting for 2nd animal
00889D1E                            
00889D1E                            loc_90C0:
00889D1E 117C 000C 0016             		move.b	#$C,obHeight(a0)
00889D24 117C 0004 0001             		move.b	#4,obRender(a0)
00889D2A 08E8 0000 0001             		bset	#0,obRender(a0)
00889D30 117C 0006 0018             		move.b	#6,obPriority(a0)
00889D36 117C 0008 0019             		move.b	#8,obActWid(a0)
00889D3C 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
00889D42 117C 0002 001A             		move.b	#2,obFrame(a0)
00889D48 317C FC00 0012             		move.w	#-$400,obVelY(a0)
00889D4E 4A38 F7A7                  		tst.b	(v_bossstatus).w
00889D52 6600                       		bne.s	loc_911C
00889D54 6100 0000                  		bsr.w	FindFreeObj
00889D58 6600                       		bne.s	Anml_Display
00889D5A 137C 0000 0000             		move.b	#id_Points,0(a1) ; load points object
00889D60 3368 0008 0008             		move.w	obX(a0),obX(a1)
00889D66 3368 000C 000C             		move.w	obY(a0),obY(a1)
00889D6C 3028 003E                  		move.w	$3E(a0),d0
00889D70 E248                       		lsr.w	#1,d0
00889D72 1340 001A                  		move.b	d0,obFrame(a1)
00889D76                            
00889D76                            Anml_Display:
00889D76 6000 0000                  		bra.w	DisplaySprite
00889D7A                            ; ===========================================================================
00889D7A                            
00889D7A                            loc_911C:
00889D7A 117C 0012 0024             		move.b	#$12,obRoutine(a0)
00889D80 4268 0010                  		clr.w	obVelX(a0)
00889D84 6000 0000                  		bra.w	DisplaySprite
00889D88                            ; ===========================================================================
00889D88                            
00889D88                            loc_912A:				; XREF: Anml_Index
00889D88 4A28 0001                  		tst.b	obRender(a0)
00889D8C 6A00 0000                  		bpl.w	DeleteObject
00889D90 6100 0000                  		bsr.w	ObjectMoveAndFall
00889D94 4A68 0012                  		tst.w	obVelY(a0)
00889D98 6B00                       		bmi.s	loc_9180
00889D9A 4EB9 0000 0000             		jsr	ObjFloorDist
00889DA0 4A41                       		tst.w	d1
00889DA2 6A00                       		bpl.s	loc_9180
00889DA4 D368 000C                  		add.w	d1,obY(a0)
00889DA8 3168 0032 0010             		move.w	$32(a0),obVelX(a0)
00889DAE 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889DB4 117C 0001 001A             		move.b	#1,obFrame(a0)
00889DBA 1028 0030                  		move.b	$30(a0),d0
00889DBE D000                       		add.b	d0,d0
00889DC0 5800                       		addq.b	#4,d0
00889DC2 1140 0024                  		move.b	d0,obRoutine(a0)
00889DC6 4A38 F7A7                  		tst.b	(v_bossstatus).w
00889DCA 6700                       		beq.s	loc_9180
00889DCC 0838 0004 FE0F             		btst	#4,(v_vbla_byte).w
00889DD2 6700                       		beq.s	loc_9180
00889DD4 4468 0010                  		neg.w	obVelX(a0)
00889DD8 0868 0000 0001             		bchg	#0,obRender(a0)
00889DDE                            
00889DDE                            loc_9180:
00889DDE 6000 0000                  		bra.w	DisplaySprite
00889DE2                            ; ===========================================================================
00889DE2                            
00889DE2                            loc_9184:				; XREF: Anml_Index
00889DE2 6100 0000                  		bsr.w	ObjectMoveAndFall
00889DE6 117C 0001 001A             		move.b	#1,obFrame(a0)
00889DEC 4A68 0012                  		tst.w	obVelY(a0)
00889DF0 6B00                       		bmi.s	loc_91AE
00889DF2 117C 0000 001A             		move.b	#0,obFrame(a0)
00889DF8 4EB9 0000 0000             		jsr	ObjFloorDist
00889DFE 4A41                       		tst.w	d1
00889E00 6A00                       		bpl.s	loc_91AE
00889E02 D368 000C                  		add.w	d1,obY(a0)
00889E06 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889E0C                            
00889E0C                            loc_91AE:
00889E0C 4A28 0028                  		tst.b	obSubtype(a0)
00889E10 6600                       		bne.s	loc_9224
00889E12 4A28 0001                  		tst.b	obRender(a0)
00889E16 6A00 0000                  		bpl.w	DeleteObject
00889E1A 6000 0000                  		bra.w	DisplaySprite
00889E1E                            ; ===========================================================================
00889E1E                            
00889E1E                            loc_91C0:				; XREF: Anml_Index
00889E1E 6100 0000                  		bsr.w	ObjectMove
00889E22 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00889E28 4A68 0012                  		tst.w	obVelY(a0)
00889E2C 6B00                       		bmi.s	loc_91FC
00889E2E 4EB9 0000 0000             		jsr	ObjFloorDist
00889E34 4A41                       		tst.w	d1
00889E36 6A00                       		bpl.s	loc_91FC
00889E38 D368 000C                  		add.w	d1,obY(a0)
00889E3C 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889E42 4A28 0028                  		tst.b	obSubtype(a0)
00889E46 6700                       		beq.s	loc_91FC
00889E48 0C28 000A 0028             		cmpi.b	#$A,obSubtype(a0)
00889E4E 6700                       		beq.s	loc_91FC
00889E50 4468 0010                  		neg.w	obVelX(a0)
00889E54 0868 0000 0001             		bchg	#0,obRender(a0)
00889E5A                            
00889E5A                            loc_91FC:
00889E5A 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00889E5E 6A00                       		bpl.s	loc_9212
00889E60 117C 0001 001E             		move.b	#1,obTimeFrame(a0)
00889E66 5228 001A                  		addq.b	#1,obFrame(a0)
00889E6A 0228 0001 001A             		andi.b	#1,obFrame(a0)
00889E70                            
00889E70                            loc_9212:
00889E70 4A28 0028                  		tst.b	obSubtype(a0)
00889E74 6600                       		bne.s	loc_9224
00889E76 4A28 0001                  		tst.b	obRender(a0)
00889E7A 6A00 0000                  		bpl.w	DeleteObject
00889E7E 6000 0000                  		bra.w	DisplaySprite
00889E82                            ; ===========================================================================
00889E82                            
00889E82                            loc_9224:				; XREF: Anml_Index
00889E82 3028 0008                  		move.w	obX(a0),d0
00889E86 9078 D008                  		sub.w	(v_player+obX).w,d0
00889E8A 6500                       		bcs.s	loc_923C
00889E8C 0440 0180                  		subi.w	#$180,d0
00889E90 6A00                       		bpl.s	loc_923C
00889E92 4A28 0001                  		tst.b	obRender(a0)
00889E96 6A00 0000                  		bpl.w	DeleteObject
00889E9A                            
00889E9A                            loc_923C:
00889E9A 6000 0000                  		bra.w	DisplaySprite
00889E9E                            ; ===========================================================================
00889E9E                            
00889E9E                            loc_9240:				; XREF: Anml_Index
00889E9E 4A28 0001                  		tst.b	obRender(a0)
00889EA2 6A00 0000                  		bpl.w	DeleteObject
00889EA6 5368 0036                  		subq.w	#1,$36(a0)
00889EAA 6600 0000                  		bne.w	loc_925C
00889EAE 117C 0002 0024             		move.b	#2,obRoutine(a0)
00889EB4 117C 0003 0018             		move.b	#3,obPriority(a0)
00889EBA                            
00889EBA                            loc_925C:
00889EBA 6000 0000                  		bra.w	DisplaySprite
00889EBE                            ; ===========================================================================
00889EBE                            
00889EBE                            loc_9260:				; XREF: Anml_Index
00889EBE 6100 0000                  		bsr.w	sub_9404
00889EC2 6400                       		bcc.s	loc_927C
00889EC4 3168 0032 0010             		move.w	$32(a0),obVelX(a0)
00889ECA 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889ED0 117C 000E 0024             		move.b	#$E,obRoutine(a0)
00889ED6 6000 FF46                  		bra.w	loc_91C0
00889EDA                            ; ===========================================================================
00889EDA                            
00889EDA                            loc_927C:
00889EDA 6000 FFA6                  		bra.w	loc_9224
00889EDE                            ; ===========================================================================
00889EDE                            
00889EDE                            loc_9280:				; XREF: Anml_Index
00889EDE 6100 0000                  		bsr.w	sub_9404
00889EE2 6A00                       		bpl.s	loc_92B6
00889EE4 4268 0010                  		clr.w	obVelX(a0)
00889EE8 4268 0032                  		clr.w	$32(a0)
00889EEC 6100 0000                  		bsr.w	ObjectMove
00889EF0 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00889EF6 6100 0000                  		bsr.w	loc_93C4
00889EFA 6100 0000                  		bsr.w	loc_93EC
00889EFE 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00889F02 6A00                       		bpl.s	loc_92B6
00889F04 117C 0001 001E             		move.b	#1,obTimeFrame(a0)
00889F0A 5228 001A                  		addq.b	#1,obFrame(a0)
00889F0E 0228 0001 001A             		andi.b	#1,obFrame(a0)
00889F14                            
00889F14                            loc_92B6:
00889F14 6000 FF6C                  		bra.w	loc_9224
00889F18                            ; ===========================================================================
00889F18                            
00889F18                            loc_92BA:				; XREF: Anml_Index
00889F18 6100 0000                  		bsr.w	sub_9404
00889F1C 6A00                       		bpl.s	loc_9310
00889F1E 3168 0032 0010             		move.w	$32(a0),obVelX(a0)
00889F24 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889F2A 117C 0004 0024             		move.b	#4,obRoutine(a0)
00889F30 6000 FEB0                  		bra.w	loc_9184
00889F34                            ; ===========================================================================
00889F34                            
00889F34                            loc_92D6:				; XREF: Anml_Index
00889F34 6100 0000                  		bsr.w	ObjectMoveAndFall
00889F38 117C 0001 001A             		move.b	#1,obFrame(a0)
00889F3E 4A68 0012                  		tst.w	obVelY(a0)
00889F42 6B00                       		bmi.s	loc_9310
00889F44 117C 0000 001A             		move.b	#0,obFrame(a0)
00889F4A 4EB9 0000 0000             		jsr	ObjFloorDist
00889F50 4A41                       		tst.w	d1
00889F52 6A00                       		bpl.s	loc_9310
00889F54 4628 0029                  		not.b	$29(a0)
00889F58 6600                       		bne.s	loc_9306
00889F5A 4468 0010                  		neg.w	obVelX(a0)
00889F5E 0868 0000 0001             		bchg	#0,obRender(a0)
00889F64                            
00889F64                            loc_9306:
00889F64 D368 000C                  		add.w	d1,obY(a0)
00889F68 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889F6E                            
00889F6E                            loc_9310:
00889F6E 6000 FF12                  		bra.w	loc_9224
00889F72                            ; ===========================================================================
00889F72                            
00889F72                            loc_9314:				; XREF: Anml_Index
00889F72 6100 0000                  		bsr.w	sub_9404
00889F76 6A00                       		bpl.s	loc_932E
00889F78 4268 0010                  		clr.w	obVelX(a0)
00889F7C 4268 0032                  		clr.w	$32(a0)
00889F80 6100 0000                  		bsr.w	ObjectMoveAndFall
00889F84 6100 0000                  		bsr.w	loc_93C4
00889F88 6100 0000                  		bsr.w	loc_93EC
00889F8C                            
00889F8C                            loc_932E:
00889F8C 6000 FEF4                  		bra.w	loc_9224
00889F90                            ; ===========================================================================
00889F90                            
00889F90                            loc_9332:				; XREF: Anml_Index
00889F90 6100 0000                  		bsr.w	sub_9404
00889F94 6A00                       		bpl.s	loc_936C
00889F96 6100 0000                  		bsr.w	ObjectMoveAndFall
00889F9A 117C 0001 001A             		move.b	#1,obFrame(a0)
00889FA0 4A68 0012                  		tst.w	obVelY(a0)
00889FA4 6B00                       		bmi.s	loc_936C
00889FA6 117C 0000 001A             		move.b	#0,obFrame(a0)
00889FAC 4EB9 0000 0000             		jsr	ObjFloorDist
00889FB2 4A41                       		tst.w	d1
00889FB4 6A00                       		bpl.s	loc_936C
00889FB6 4468 0010                  		neg.w	obVelX(a0)
00889FBA 0868 0000 0001             		bchg	#0,obRender(a0)
00889FC0 D368 000C                  		add.w	d1,obY(a0)
00889FC4 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
00889FCA                            
00889FCA                            loc_936C:
00889FCA 6000 FEB6                  		bra.w	loc_9224
00889FCE                            ; ===========================================================================
00889FCE                            
00889FCE                            loc_9370:				; XREF: Anml_Index
00889FCE 6100 0000                  		bsr.w	sub_9404
00889FD2 6A00                       		bpl.s	loc_93C0
00889FD4 6100 0000                  		bsr.w	ObjectMove
00889FD8 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00889FDE 4A68 0012                  		tst.w	obVelY(a0)
00889FE2 6B00                       		bmi.s	loc_93AA
00889FE4 4EB9 0000 0000             		jsr	ObjFloorDist
00889FEA 4A41                       		tst.w	d1
00889FEC 6A00                       		bpl.s	loc_93AA
00889FEE 4628 0029                  		not.b	$29(a0)
00889FF2 6600                       		bne.s	loc_93A0
00889FF4 4468 0010                  		neg.w	obVelX(a0)
00889FF8 0868 0000 0001             		bchg	#0,obRender(a0)
00889FFE                            
00889FFE                            loc_93A0:
00889FFE D368 000C                  		add.w	d1,obY(a0)
0088A002 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
0088A008                            
0088A008                            loc_93AA:
0088A008 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0088A00C 6A00                       		bpl.s	loc_93C0
0088A00E 117C 0001 001E             		move.b	#1,obTimeFrame(a0)
0088A014 5228 001A                  		addq.b	#1,obFrame(a0)
0088A018 0228 0001 001A             		andi.b	#1,obFrame(a0)
0088A01E                            
0088A01E                            loc_93C0:
0088A01E 6000 FE62                  		bra.w	loc_9224
0088A022                            ; ===========================================================================
0088A022                            
0088A022                            loc_93C4:
0088A022 117C 0001 001A             		move.b	#1,obFrame(a0)
0088A028 4A68 0012                  		tst.w	obVelY(a0)
0088A02C 6B00                       		bmi.s	locret_93EA
0088A02E 117C 0000 001A             		move.b	#0,obFrame(a0)
0088A034 4EB9 0000 0000             		jsr	ObjFloorDist
0088A03A 4A41                       		tst.w	d1
0088A03C 6A00                       		bpl.s	locret_93EA
0088A03E D368 000C                  		add.w	d1,obY(a0)
0088A042 3168 0034 0012             		move.w	$34(a0),obVelY(a0)
0088A048                            
0088A048                            locret_93EA:
0088A048 4E75                       		rts	
0088A04A                            ; ===========================================================================
0088A04A                            
0088A04A                            loc_93EC:
0088A04A 08E8 0000 0001             		bset	#0,obRender(a0)
0088A050 3028 0008                  		move.w	obX(a0),d0
0088A054 9078 D008                  		sub.w	(v_player+obX).w,d0
0088A058 6400                       		bcc.s	locret_9402
0088A05A 08A8 0000 0001             		bclr	#0,obRender(a0)
0088A060                            
0088A060                            locret_9402:
0088A060 4E75                       		rts	
0088A062                            
0088A062                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088A062                            
0088A062                            
0088A062                            sub_9404:
0088A062 3038 D008                  		move.w	(v_player+obX).w,d0
0088A066 9068 0008                  		sub.w	obX(a0),d0
0088A06A 0440 00B8                  		subi.w	#$B8,d0
0088A06E 4E75                       		rts	
0088A070                            ; End of function sub_9404
0088A070                            ; End of function sub_9404
0088A070                            		include	"_incObj\29 Points.asm"
0088A070                            ; ---------------------------------------------------------------------------
0088A070                            ; Object 29 - points that appear when you destroy something
0088A070                            ; ---------------------------------------------------------------------------
0088A070                            
0088A070                            Points:					; XREF: Obj_Index
0088A070 7000                       		moveq	#0,d0
0088A072 1028 0024                  		move.b	obRoutine(a0),d0
0088A076 323B 0000                  		move.w	Poi_Index(pc,d0.w),d1
0088A07A 4EBB 1000                  		jsr	Poi_Index(pc,d1.w)
0088A07E 6000 0000                  		bra.w	DisplaySprite
0088A082                            ; ===========================================================================
0088A082 0000                       Poi_Index:	dc.w Poi_Main-Poi_Index
0088A084 0000                       		dc.w Poi_Slower-Poi_Index
0088A086                            ; ===========================================================================
0088A086                            
0088A086                            Poi_Main:	; Routine 0
0088A086 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A08A 217C 0000 0000 0004        		move.l	#Map_Poi,obMap(a0)
0088A092 317C 2797 0002             		move.w	#$2797,obGfx(a0)
0088A098 117C 0004 0001             		move.b	#4,obRender(a0)
0088A09E 117C 0001 0018             		move.b	#1,obPriority(a0)
0088A0A4 117C 0008 0019             		move.b	#8,obActWid(a0)
0088A0AA 317C FD00 0012             		move.w	#-$300,obVelY(a0) ; move object upwards
0088A0B0                            
0088A0B0                            Poi_Slower:	; Routine 2
0088A0B0 4A68 0012                  		tst.w	obVelY(a0)	; is object moving?
0088A0B4 6A00 0000                  		bpl.w	DeleteObject	; if not, delete
0088A0B8 6100 0000                  		bsr.w	ObjectMove
0088A0BC 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; reduce object	speed
0088A0C2 4E75                       		rts	
0088A0C2 4E75                       		rts	
0088A0C4                            		include	"_maps\Animals 1.asm"
0088A0C4                            ; ---------------------------------------------------------------------------
0088A0C4                            ; Sprite mappings - animals
0088A0C4                            ; ---------------------------------------------------------------------------
0088A0C4 0000                       Map_Animal1:	dc.w byte_9472-Map_Animal1
0088A0C6 0000                       		dc.w byte_9478-Map_Animal1
0088A0C8 0000                       		dc.w byte_946C-Map_Animal1
0088A0CA 01                         byte_946C:	dc.b 1
0088A0CB F406 0000 F8               		dc.b $F4, 6, 0,	0, $F8
0088A0D0 01                         byte_9472:	dc.b 1
0088A0D1 F406 0006 F8               		dc.b $F4, 6, 0,	6, $F8
0088A0D6 01                         byte_9478:	dc.b 1
0088A0D7 F406 000C F8               		dc.b $F4, 6, 0,	$C, $F8
0088A0DC                            		even
0088A0DC                            		even
0088A0DC                            		include	"_maps\Animals 2.asm"
0088A0DC                            ; ---------------------------------------------------------------------------
0088A0DC                            ; Sprite mappings - animals
0088A0DC                            ; ---------------------------------------------------------------------------
0088A0DC 0000                       Map_Animal2:	dc.w byte_948A-Map_Animal2
0088A0DE 0000                       		dc.w byte_9490-Map_Animal2
0088A0E0 0000                       		dc.w byte_9484-Map_Animal2
0088A0E2 01                         byte_9484:	dc.b 1
0088A0E3 F406 0000 F8               		dc.b $F4, 6, 0,	0, $F8
0088A0E8 01                         byte_948A:	dc.b 1
0088A0E9 FC05 0006 F8               		dc.b $FC, 5, 0,	6, $F8
0088A0EE 01                         byte_9490:	dc.b 1
0088A0EF FC05 000A F8               		dc.b $FC, 5, 0,	$A, $F8
0088A0F4                            		even
0088A0F4                            		even
0088A0F4                            		include	"_maps\Animals 3.asm"
0088A0F4                            ; ---------------------------------------------------------------------------
0088A0F4                            ; Sprite mappings - animals
0088A0F4                            ; ---------------------------------------------------------------------------
0088A0F4 0000                       Map_Animal3:	dc.w byte_94A2-Map_Animal3
0088A0F6 0000                       		dc.w byte_94A8-Map_Animal3
0088A0F8 0000                       		dc.w byte_949C-Map_Animal3
0088A0FA 01                         byte_949C:	dc.b 1
0088A0FB F406 0000 F8               		dc.b $F4, 6, 0,	0, $F8
0088A100 01                         byte_94A2:	dc.b 1
0088A101 FC09 0006 F4               		dc.b $FC, 9, 0,	6, $F4
0088A106 01                         byte_94A8:	dc.b 1
0088A107 FC09 000C F4               		dc.b $FC, 9, 0,	$C, $F4
0088A10C                            		even
0088A10C                            		even
0088A10C                            		include	"_maps\Points.asm"
0088A10C                            ; ---------------------------------------------------------------------------
0088A10C                            ; Sprite mappings - points that	appear when you	destroy	something
0088A10C                            ; ---------------------------------------------------------------------------
0088A10C 0000 0000                  Map_Poi:	dc.w byte_94BC-Map_Poi, byte_94C2-Map_Poi
0088A110 0000 0000                  		dc.w byte_94C8-Map_Poi, byte_94CE-Map_Poi
0088A114 0000 0000                  		dc.w byte_94D4-Map_Poi, byte_94DA-Map_Poi
0088A118 0000                       		dc.w byte_94E5-Map_Poi
0088A11A 01                         byte_94BC:	dc.b 1
0088A11B FC04 0000 F8               		dc.b $FC, 4, 0,	0, $F8	; 100 points
0088A120 01                         byte_94C2:	dc.b 1
0088A121 FC04 0002 F8               		dc.b $FC, 4, 0,	2, $F8	; 200 points
0088A126 01                         byte_94C8:	dc.b 1
0088A127 FC04 0004 F8               		dc.b $FC, 4, 0,	4, $F8	; 500 points
0088A12C 01                         byte_94CE:	dc.b 1
0088A12D FC08 0006 F8               		dc.b $FC, 8, 0,	6, $F8	; 1000 points
0088A132 01                         byte_94D4:	dc.b 1
0088A133 FC00 0006 FC               		dc.b $FC, 0, 0,	6, $FC	; 10 points
0088A138 02                         byte_94DA:	dc.b 2
0088A139 FC08 0006 F4               		dc.b $FC, 8, 0,	6, $F4	; 10,000 points
0088A13E FC04 0007 01               		dc.b $FC, 4, 0,	7, 1
0088A143 02                         byte_94E5:	dc.b 2
0088A144 FC08 0006 F4               		dc.b $FC, 8, 0,	6, $F4	; 100,000 points
0088A149 FC04 0007 06               		dc.b $FC, 4, 0,	7, 6
0088A14E                            		even
0088A14E                            		even
0088A14E                            
0088A14E                            		include	"_incObj\1F Crabmeat.asm"
0088A14E                            ; ---------------------------------------------------------------------------
0088A14E                            ; Object 1F - Crabmeat enemy (GHZ, SYZ)
0088A14E                            ; ---------------------------------------------------------------------------
0088A14E                            
0088A14E                            Crabmeat:				; XREF: Obj_Index
0088A14E 7000                       		moveq	#0,d0
0088A150 1028 0024                  		move.b	obRoutine(a0),d0
0088A154 323B 0000                  		move.w	Crab_Index(pc,d0.w),d1
0088A158 4EFB 1000                  		jmp	Crab_Index(pc,d1.w)
0088A15C                            ; ===========================================================================
0088A15C                            Crab_Index:
0088A15C 0000                       ptr_Crab_Main:		dc.w Crab_Main-Crab_Index
0088A15E 0000                       ptr_Crab_Action:	dc.w Crab_Action-Crab_Index
0088A160 0000                       ptr_Crab_Delete:	dc.w Crab_Delete-Crab_Index
0088A162 0000                       ptr_Crab_BallMain:	dc.w Crab_BallMain-Crab_Index
0088A164 0000                       ptr_Crab_BallMove:	dc.w Crab_BallMove-Crab_Index
0088A166                            
0088A166 =00000000                  id_Crab_Main:		= ptr_Crab_Main-Crab_Index	; 0
0088A166 =00000002                  id_Crab_Action:		= ptr_Crab_Action-Crab_Index	; 2
0088A166 =00000004                  id_Crab_Delete:		= ptr_Crab_Delete-Crab_Index	; 4
0088A166 =00000006                  id_Crab_BallMain:	= ptr_Crab_BallMain-Crab_Index	; 6
0088A166 =00000008                  id_Crab_BallMove:	= ptr_Crab_BallMove-Crab_Index	; 8
0088A166                            
0088A166 =00000030                  timedelay:	= $30
0088A166 =00000032                  crabmode:	= $32
0088A166                            ; ===========================================================================
0088A166                            
0088A166                            Crab_Main:	; Routine 0
0088A166 117C 0010 0016             		move.b	#$10,obHeight(a0)
0088A16C 117C 0008 0017             		move.b	#8,obWidth(a0)
0088A172 217C 0000 0000 0004        		move.l	#Map_Crab,obMap(a0)
0088A17A 317C 0400 0002             		move.w	#$400,obGfx(a0)
0088A180 117C 0004 0001             		move.b	#4,obRender(a0)
0088A186 117C 0003 0018             		move.b	#3,obPriority(a0)
0088A18C 117C 0006 0020             		move.b	#6,obColType(a0)
0088A192 117C 0015 0019             		move.b	#$15,obActWid(a0)
0088A198 6100 0000                  		bsr.w	ObjectMoveAndFall
0088A19C 4EB9 0000 0000             		jsr	ObjFloorDist	; find floor
0088A1A2 4A41                       		tst.w	d1
0088A1A4 6A00                       		bpl.s	@floornotfound
0088A1A6 D368 000C                  		add.w	d1,obY(a0)
0088A1AA 1143 0026                  		move.b	d3,obAngle(a0)
0088A1AE 317C 0000 0012             		move.w	#0,obVelY(a0)
0088A1B4 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A1B8                            
0088A1B8                            	@floornotfound:
0088A1B8 4E75                       		rts	
0088A1BA                            ; ===========================================================================
0088A1BA                            
0088A1BA                            Crab_Action:	; Routine 2
0088A1BA 7000                       		moveq	#0,d0
0088A1BC 1028 0025                  		move.b	ob2ndRout(a0),d0
0088A1C0 323B 0000                  		move.w	@index(pc,d0.w),d1
0088A1C4 4EBB 1000                  		jsr	@index(pc,d1.w)
0088A1C8 43F9 0000 0000             		lea	(Ani_Crab).l,a1
0088A1CE 6100 0000                  		bsr.w	AnimateSprite
0088A1D2 6000 0000                  		bra.w	RememberState
0088A1D6                            ; ===========================================================================
0088A1D6 0000                       @index:		dc.w @waittofire-@index
0088A1D8 0000                       		dc.w @walkonfloor-@index
0088A1DA                            ; ===========================================================================
0088A1DA                            
0088A1DA                            @waittofire:				; XREF: @index
0088A1DA 5368 0030                  		subq.w	#1,timedelay(a0) ; subtract 1 from time delay
0088A1DE 6A00                       		bpl.s	@dontmove
0088A1E0 4A28 0001                  		tst.b	obRender(a0)
0088A1E4 6A00                       		bpl.s	@movecrab
0088A1E6 0868 0001 0032             		bchg	#1,crabmode(a0)
0088A1EC 6600                       		bne.s	@fire
0088A1EE                            
0088A1EE                            	@movecrab:
0088A1EE 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088A1F2 317C 007F 0030             		move.w	#127,timedelay(a0) ; set time delay to approx 2 seconds
0088A1F8 317C 0080 0010             		move.w	#$80,obVelX(a0)	; move Crabmeat	to the right
0088A1FE 6100 0000                  		bsr.w	Crab_SetAni
0088A202 5600                       		addq.b	#3,d0
0088A204 1140 001C                  		move.b	d0,obAnim(a0)
0088A208 0868 0000 0022             		bchg	#0,obStatus(a0)
0088A20E 6600                       		bne.s	@noflip
0088A210 4468 0010                  		neg.w	obVelX(a0)	; change direction
0088A214                            
0088A214                            	@dontmove:
0088A214                            	@noflip:
0088A214 4E75                       		rts	
0088A216                            ; ===========================================================================
0088A216                            
0088A216                            @fire:
0088A216 317C 003B 0030             		move.w	#59,timedelay(a0)
0088A21C 117C 0006 001C             		move.b	#6,obAnim(a0)	; use firing animation
0088A222 6100 0000                  		bsr.w	FindFreeObj
0088A226 6600                       		bne.s	@failleft
0088A228 137C 0000 0000             		move.b	#id_Crabmeat,0(a1) ; load left fireball
0088A22E 137C 0006 0024             		move.b	#id_Crab_BallMain,obRoutine(a1)
0088A234 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088A23A 0469 0010 0008             		subi.w	#$10,obX(a1)
0088A240 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088A246 337C FF00 0010             		move.w	#-$100,obVelX(a1)
0088A24C                            
0088A24C                            	@failleft:
0088A24C 6100 0000                  		bsr.w	FindFreeObj
0088A250 6600                       		bne.s	@failright
0088A252 137C 0000 0000             		move.b	#id_Crabmeat,0(a1) ; load right fireball
0088A258 137C 0006 0024             		move.b	#id_Crab_BallMain,obRoutine(a1)
0088A25E 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088A264 0669 0010 0008             		addi.w	#$10,obX(a1)
0088A26A 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088A270 337C 0100 0010             		move.w	#$100,obVelX(a1)
0088A276                            
0088A276                            	@failright:
0088A276 4E75                       		rts	
0088A278                            ; ===========================================================================
0088A278                            
0088A278                            @walkonfloor:				; XREF: @index
0088A278 5368 0030                  		subq.w	#1,timedelay(a0)
0088A27C 6B00                       		bmi.s	loc_966E
0088A27E 6100 0000                  		bsr.w	ObjectMove
0088A282 0868 0000 0032             		bchg	#0,crabmode(a0)
0088A288 6600                       		bne.s	loc_9654
0088A28A 3628 0008                  		move.w	obX(a0),d3
0088A28E 0643 0010                  		addi.w	#$10,d3
0088A292 0828 0000 0022             		btst	#0,obStatus(a0)
0088A298 6700                       		beq.s	loc_9640
0088A29A 0443 0020                  		subi.w	#$20,d3
0088A29E                            
0088A29E                            loc_9640:
0088A29E 4EB9 0000 0000             		jsr	ObjFloorDist2
0088A2A4 0C41 FFF8                  		cmpi.w	#-8,d1
0088A2A8 6D00                       		blt.s	loc_966E
0088A2AA 0C41 000C                  		cmpi.w	#$C,d1
0088A2AE 6C00                       		bge.s	loc_966E
0088A2B0 4E75                       		rts	
0088A2B2                            ; ===========================================================================
0088A2B2                            
0088A2B2                            loc_9654:
0088A2B2 4EB9 0000 0000             		jsr	ObjFloorDist
0088A2B8 D368 000C                  		add.w	d1,obY(a0)
0088A2BC 1143 0026                  		move.b	d3,obAngle(a0)
0088A2C0 6100 0000                  		bsr.w	Crab_SetAni
0088A2C4 5600                       		addq.b	#3,d0
0088A2C6 1140 001C                  		move.b	d0,obAnim(a0)
0088A2CA 4E75                       		rts	
0088A2CC                            ; ===========================================================================
0088A2CC                            
0088A2CC                            loc_966E:
0088A2CC 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088A2D0 317C 003B 0030             		move.w	#59,timedelay(a0)
0088A2D6 317C 0000 0010             		move.w	#0,obVelX(a0)
0088A2DC 6100 0000                  		bsr.w	Crab_SetAni
0088A2E0 1140 001C                  		move.b	d0,obAnim(a0)
0088A2E4 4E75                       		rts	
0088A2E6                            ; ---------------------------------------------------------------------------
0088A2E6                            ; Subroutine to	set the	correct	animation for a	Crabmeat
0088A2E6                            ; ---------------------------------------------------------------------------
0088A2E6                            
0088A2E6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088A2E6                            
0088A2E6                            
0088A2E6                            Crab_SetAni:				; XREF: loc_966E
0088A2E6 7000                       		moveq	#0,d0
0088A2E8 1628 0026                  		move.b	obAngle(a0),d3
0088A2EC 6B00                       		bmi.s	loc_96A4
0088A2EE 0C03 0006                  		cmpi.b	#6,d3
0088A2F2 6500                       		bcs.s	locret_96A2
0088A2F4 7001                       		moveq	#1,d0
0088A2F6 0828 0000 0022             		btst	#0,obStatus(a0)
0088A2FC 6600                       		bne.s	locret_96A2
0088A2FE 7002                       		moveq	#2,d0
0088A300                            
0088A300                            locret_96A2:
0088A300 4E75                       		rts	
0088A302                            ; ===========================================================================
0088A302                            
0088A302                            loc_96A4:
0088A302 0C03 00FA                  		cmpi.b	#-6,d3
0088A306 6200                       		bhi.s	locret_96B6
0088A308 7002                       		moveq	#2,d0
0088A30A 0828 0000 0022             		btst	#0,obStatus(a0)
0088A310 6600                       		bne.s	locret_96B6
0088A312 7001                       		moveq	#1,d0
0088A314                            
0088A314                            locret_96B6:
0088A314 4E75                       		rts	
0088A316                            ; End of function Crab_SetAni
0088A316                            
0088A316                            ; ===========================================================================
0088A316                            
0088A316                            Crab_Delete:	; Routine 4
0088A316 6100 0000                  		bsr.w	DeleteObject
0088A31A 4E75                       		rts	
0088A31C                            ; ===========================================================================
0088A31C                            ; ---------------------------------------------------------------------------
0088A31C                            ; Sub-object - missile that the	Crabmeat throws
0088A31C                            ; ---------------------------------------------------------------------------
0088A31C                            
0088A31C                            Crab_BallMain:	; Routine 6
0088A31C 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A320 217C 0000 0000 0004        		move.l	#Map_Crab,obMap(a0)
0088A328 317C 0400 0002             		move.w	#$400,obGfx(a0)
0088A32E 117C 0004 0001             		move.b	#4,obRender(a0)
0088A334 117C 0003 0018             		move.b	#3,obPriority(a0)
0088A33A 117C 0087 0020             		move.b	#$87,obColType(a0)
0088A340 117C 0008 0019             		move.b	#8,obActWid(a0)
0088A346 317C FC00 0012             		move.w	#-$400,obVelY(a0)
0088A34C 117C 0007 001C             		move.b	#7,obAnim(a0)
0088A352                            
0088A352                            Crab_BallMove:	; Routine 8
0088A352 43F9 0000 0000             		lea	(Ani_Crab).l,a1
0088A358 6100 0000                  		bsr.w	AnimateSprite
0088A35C 6100 0000                  		bsr.w	ObjectMoveAndFall
0088A360 6100 0000                  		bsr.w	DisplaySprite
0088A364 3038 F72E                  		move.w	(v_limitbtm2).w,d0
0088A368 0640 00E0                  		addi.w	#$E0,d0
0088A36C B068 000C                  		cmp.w	obY(a0),d0	; has object moved below the level boundary?
0088A370 6500                       		bcs.s	@delete		; if yes, branch
0088A372 4E75                       		rts	
0088A374                            
0088A374                            	@delete:
0088A374 6000 0000                  		bra.w	DeleteObject
0088A374 6000 0000                  		bra.w	DeleteObject
0088A378                            		include	"_anim\Crabmeat.asm"
0088A378                            ; ---------------------------------------------------------------------------
0088A378                            ; Animation script - Crabmeat enemy
0088A378                            ; ---------------------------------------------------------------------------
0088A378 0000 0000 0000             Ani_Crab:	dc.w @stand-Ani_Crab, @standslope-Ani_Crab, @standsloperev-Ani_Crab
0088A37E 0000 0000 0000             		dc.w @walk-Ani_Crab, @walkslope-Ani_Crab, @walksloperev-Ani_Crab
0088A384 0000 0000                  		dc.w @firing-Ani_Crab, @ball-Ani_Crab
0088A388 0F00 FF                    @stand:		dc.b $F, 0, afEnd
0088A38C 00                         		even
0088A38C 0F02 FF                    @standslope:	dc.b $F, 2, afEnd
0088A390 00                         		even
0088A390 0F22 FF                    @standsloperev:	dc.b $F, $22, afEnd
0088A394 00                         		even
0088A394 0F01 2100 FF               @walk:		dc.b $F, 1, $21, 0, afEnd
0088A39A 00                         		even
0088A39A 0F21 0302 FF               @walkslope:	dc.b $F, $21, 3, 2, afEnd
0088A3A0 00                         		even
0088A3A0 0F01 2322 FF               @walksloperev:	dc.b $F, 1, $23, $22, afEnd
0088A3A6 00                         		even
0088A3A6 0F04 FF                    @firing:	dc.b $F, 4, afEnd
0088A3AA 00                         		even
0088A3AA 0105 06FF                  @ball:		dc.b 1,	5, 6, afEnd
0088A3AE                            		even
0088A3AE                            		even
0088A3AE                            		include	"_maps\Crabmeat.asm"
0088A3AE                            ; ---------------------------------------------------------------------------
0088A3AE                            ; Sprite mappings - Crabmeat enemy (GHZ, SYZ)
0088A3AE                            ; ---------------------------------------------------------------------------
0088A3AE 0000 0000                  Map_Crab:	dc.w @stand-Map_Crab, @walk-Map_Crab
0088A3B2 0000 0000                  		dc.w @slope1-Map_Crab, @slope2-Map_Crab
0088A3B6 0000 0000                  		dc.w @firing-Map_Crab, @ball1-Map_Crab
0088A3BA 0000                       		dc.w @ball2-Map_Crab
0088A3BC 04                         @stand:		dc.b 4
0088A3BD F009 0000 E8               		dc.b $F0, 9, 0,	0, $E8	; standing/middle walking frame
0088A3C2 F009 0800 00               		dc.b $F0, 9, 8,	0, 0
0088A3C7 0005 0006 F0               		dc.b 0,	5, 0, 6, $F0
0088A3CC 0005 0806 00               		dc.b 0,	5, 8, 6, 0
0088A3D1 04                         @walk:		dc.b 4
0088A3D2 F009 000A E8               		dc.b $F0, 9, 0,	$A, $E8	; walking
0088A3D7 F009 0010 00               		dc.b $F0, 9, 0,	$10, 0
0088A3DC 0005 0016 F0               		dc.b 0,	5, 0, $16, $F0
0088A3E1 0009 001A 00               		dc.b 0,	9, 0, $1A, 0
0088A3E6 04                         @slope1:	dc.b 4
0088A3E7 EC09 0000 E8               		dc.b $EC, 9, 0,	0, $E8	; walking on slope
0088A3EC EC09 0800 00               		dc.b $EC, 9, 8,	0, 0
0088A3F1 FC05 0806 00               		dc.b $FC, 5, 8,	6, 0
0088A3F6 FC06 0020 F0               		dc.b $FC, 6, 0,	$20, $F0
0088A3FB 04                         @slope2:	dc.b 4
0088A3FC EC09 000A E8               		dc.b $EC, 9, 0,	$A, $E8	; walking on slope
0088A401 EC09 0010 00               		dc.b $EC, 9, 0,	$10, 0
0088A406 FC09 0026 00               		dc.b $FC, 9, 0,	$26, 0
0088A40B FC06 002C F0               		dc.b $FC, 6, 0,	$2C, $F0
0088A410 06                         @firing:	dc.b 6
0088A411 F004 0032 F0               		dc.b $F0, 4, 0,	$32, $F0 ; firing projectiles
0088A416 F004 0832 00               		dc.b $F0, 4, 8,	$32, 0
0088A41B F809 0034 E8               		dc.b $F8, 9, 0,	$34, $E8
0088A420 F809 0834 00               		dc.b $F8, 9, 8,	$34, 0
0088A425 0804 003A F0               		dc.b 8,	4, 0, $3A, $F0
0088A42A 0804 083A 00               		dc.b 8,	4, 8, $3A, 0
0088A42F 01                         @ball1:		dc.b 1
0088A430 F805 003C F8               		dc.b $F8, 5, 0,	$3C, $F8 ; projectile
0088A435 01                         @ball2:		dc.b 1
0088A436 F805 0040 F8               		dc.b $F8, 5, 0,	$40, $F8 ; projectile
0088A43C 00                         		even
0088A43C 00                         		even
0088A43C                            		include	"_incObj\22 Buzz Bomber.asm"
0088A43C                            ; ===========================================================================
0088A43C                            ; ---------------------------------------------------------------------------
0088A43C                            ; Object 22 - Buzz Bomber enemy	(GHZ, MZ, SYZ)
0088A43C                            ; ---------------------------------------------------------------------------
0088A43C                            
0088A43C                            BuzzBomber:				; XREF: Obj_Index
0088A43C 7000                       		moveq	#0,d0
0088A43E 1028 0024                  		move.b	obRoutine(a0),d0
0088A442 323B 0000                  		move.w	Buzz_Index(pc,d0.w),d1
0088A446 4EFB 1000                  		jmp	Buzz_Index(pc,d1.w)
0088A44A                            ; ===========================================================================
0088A44A 0000                       Buzz_Index:	dc.w Buzz_Main-Buzz_Index
0088A44C 0000                       		dc.w Buzz_Action-Buzz_Index
0088A44E 0000                       		dc.w Buzz_Delete-Buzz_Index
0088A450                            
0088A450 =00000032                  timedelay:	= $32
0088A450 =00000034                  buzzstatus:	= $34
0088A450 =0000003C                  parent:		= $3C
0088A450                            ; ===========================================================================
0088A450                            
0088A450                            Buzz_Main:	; Routine 0
0088A450 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A454 217C 0000 0000 0004        		move.l	#Map_Buzz,obMap(a0)
0088A45C 317C 0444 0002             		move.w	#$444,obGfx(a0)
0088A462 117C 0004 0001             		move.b	#4,obRender(a0)
0088A468 117C 0003 0018             		move.b	#3,obPriority(a0)
0088A46E 117C 0008 0020             		move.b	#8,obColType(a0)
0088A474 117C 0018 0019             		move.b	#$18,obActWid(a0)
0088A47A                            
0088A47A                            Buzz_Action:	; Routine 2
0088A47A 7000                       		moveq	#0,d0
0088A47C 1028 0025                  		move.b	ob2ndRout(a0),d0
0088A480 323B 0000                  		move.w	@index(pc,d0.w),d1
0088A484 4EBB 1000                  		jsr	@index(pc,d1.w)
0088A488 43F9 0000 0000             		lea	(Ani_Buzz).l,a1
0088A48E 6100 0000                  		bsr.w	AnimateSprite
0088A492 6000 0000                  		bra.w	RememberState
0088A496                            ; ===========================================================================
0088A496 0000                       @index:		dc.w @move-@index
0088A498 0000                       		dc.w @chknearsonic-@index
0088A49A                            ; ===========================================================================
0088A49A                            
0088A49A                            @move:					; XREF: @index
0088A49A 5368 0032                  		subq.w	#1,timedelay(a0) ; subtract 1 from time delay
0088A49E 6A00                       		bpl.s	@noflip		; if time remains, branch
0088A4A0 0828 0001 0034             		btst	#1,buzzstatus(a0) ; is Buzz Bomber near Sonic?
0088A4A6 6600                       		bne.s	@fire		; if yes, branch
0088A4A8 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088A4AC 317C 007F 0032             		move.w	#127,timedelay(a0) ; set time delay to just over 2 seconds
0088A4B2 317C 0400 0010             		move.w	#$400,obVelX(a0) ; move Buzz Bomber to the right
0088A4B8 117C 0001 001C             		move.b	#1,obAnim(a0)	; use "flying" animation
0088A4BE 0828 0000 0022             		btst	#0,obStatus(a0)	; is Buzz Bomber facing	left?
0088A4C4 6600                       		bne.s	@noflip		; if not, branch
0088A4C6 4468 0010                  		neg.w	obVelX(a0)	; move Buzz Bomber to the left
0088A4CA                            
0088A4CA                            	@noflip:
0088A4CA 4E75                       		rts	
0088A4CC                            ; ===========================================================================
0088A4CC                            
0088A4CC                            	@fire:
0088A4CC 6100 0000                  		bsr.w	FindFreeObj
0088A4D0 6600                       		bne.s	@fail
0088A4D2 137C 0000 0000             		move.b	#id_Missile,0(a1) ; load missile object
0088A4D8 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088A4DE 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088A4E4 0669 001C 000C             		addi.w	#$1C,obY(a1)
0088A4EA 337C 0200 0012             		move.w	#$200,obVelY(a1) ; move missile downwards
0088A4F0 337C 0200 0010             		move.w	#$200,obVelX(a1) ; move missile to the right
0088A4F6 303C 0018                  		move.w	#$18,d0
0088A4FA 0828 0000 0022             		btst	#0,obStatus(a0)	; is Buzz Bomber facing	left?
0088A500 6600                       		bne.s	@noflip2	; if not, branch
0088A502 4440                       		neg.w	d0
0088A504 4469 0010                  		neg.w	obVelX(a1)	; move missile to the left
0088A508                            
0088A508                            	@noflip2:
0088A508 D169 0008                  		add.w	d0,obX(a1)
0088A50C 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
0088A512 337C 000E 0032             		move.w	#$E,timedelay(a1)
0088A518 2348 003C                  		move.l	a0,parent(a1)
0088A51C 117C 0001 0034             		move.b	#1,buzzstatus(a0) ; set to "already fired" to prevent refiring
0088A522 317C 003B 0032             		move.w	#$3B,timedelay(a0)
0088A528 117C 0002 001C             		move.b	#2,obAnim(a0)	; use "firing" animation
0088A52E                            
0088A52E                            	@fail:
0088A52E 4E75                       		rts	
0088A530                            ; ===========================================================================
0088A530                            
0088A530                            @chknearsonic:				; XREF: @index
0088A530 5368 0032                  		subq.w	#1,timedelay(a0) ; subtract 1 from time delay
0088A534 6B00                       		bmi.s	@chgdirection
0088A536 6100 0000                  		bsr.w	ObjectMove
0088A53A 4A28 0034                  		tst.b	buzzstatus(a0)
0088A53E 6600                       		bne.s	@keepgoing
0088A540 3038 D008                  		move.w	(v_player+obX).w,d0
0088A544 9068 0008                  		sub.w	obX(a0),d0
0088A548 6A00                       		bpl.s	@isleft
0088A54A 4440                       		neg.w	d0
0088A54C                            
0088A54C                            	@isleft:
0088A54C 0C40 0060                  		cmpi.w	#$60,d0		; is Buzz Bomber within	$60 pixels of Sonic?
0088A550 6400                       		bcc.s	@keepgoing	; if not, branch
0088A552 4A28 0001                  		tst.b	obRender(a0)
0088A556 6A00                       		bpl.s	@keepgoing
0088A558 117C 0002 0034             		move.b	#2,buzzstatus(a0) ; set Buzz Bomber to "near Sonic"
0088A55E 317C 001D 0032             		move.w	#29,timedelay(a0) ; set time delay to half a second
0088A564 6000                       		bra.s	@stop
0088A566                            ; ===========================================================================
0088A566                            
0088A566                            	@chgdirection:
0088A566 117C 0000 0034             		move.b	#0,buzzstatus(a0) ; set Buzz Bomber to "normal"
0088A56C 0868 0000 0022             		bchg	#0,obStatus(a0)	; change direction
0088A572 317C 003B 0032             		move.w	#59,timedelay(a0)
0088A578                            
0088A578                            	@stop:
0088A578 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088A57C 317C 0000 0010             		move.w	#0,obVelX(a0)	; stop Buzz Bomber moving
0088A582 117C 0000 001C             		move.b	#0,obAnim(a0)	; use "hovering" animation
0088A588                            
0088A588                            @keepgoing:
0088A588 4E75                       		rts	
0088A58A                            ; ===========================================================================
0088A58A                            
0088A58A                            Buzz_Delete:	; Routine 4
0088A58A 6100 0000                  		bsr.w	DeleteObject
0088A58E 4E75                       		rts	
0088A58E 4E75                       		rts	
0088A590                            		include	"_incObj\23 Buzz Bomber Missile.asm"
0088A590                            ; ---------------------------------------------------------------------------
0088A590                            ; Object 23 - missile that Buzz	Bomber throws
0088A590                            ; ---------------------------------------------------------------------------
0088A590                            
0088A590                            Missile:				; XREF: Obj_Index
0088A590 7000                       		moveq	#0,d0
0088A592 1028 0024                  		move.b	obRoutine(a0),d0
0088A596 323B 0000                  		move.w	Msl_Index(pc,d0.w),d1
0088A59A 4EFB 1000                  		jmp	Msl_Index(pc,d1.w)
0088A59E                            ; ===========================================================================
0088A59E 0000                       Msl_Index:	dc.w Msl_Main-Msl_Index
0088A5A0 0000                       		dc.w Msl_Animate-Msl_Index
0088A5A2 0000                       		dc.w Msl_FromBuzz-Msl_Index
0088A5A4 0000                       		dc.w Msl_Delete-Msl_Index
0088A5A6 0000                       		dc.w Msl_FromNewt-Msl_Index
0088A5A8                            
0088A5A8 =0000003C                  parent:		= $3C
0088A5A8                            ; ===========================================================================
0088A5A8                            
0088A5A8                            Msl_Main:	; Routine 0
0088A5A8 5368 0032                  		subq.w	#1,$32(a0)
0088A5AC 6A00                       		bpl.s	Msl_ChkCancel
0088A5AE 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A5B2 217C 0000 0000 0004        		move.l	#Map_Missile,obMap(a0)
0088A5BA 317C 2444 0002             		move.w	#$2444,obGfx(a0)
0088A5C0 117C 0004 0001             		move.b	#4,obRender(a0)
0088A5C6 117C 0003 0018             		move.b	#3,obPriority(a0)
0088A5CC 117C 0008 0019             		move.b	#8,obActWid(a0)
0088A5D2 0228 0003 0022             		andi.b	#3,obStatus(a0)
0088A5D8 4A28 0028                  		tst.b	obSubtype(a0)	; was object created by	a Newtron?
0088A5DC 6700                       		beq.s	Msl_Animate	; if not, branch
0088A5DE                            
0088A5DE 117C 0008 0024             		move.b	#8,obRoutine(a0) ; run "Msl_FromNewt" routine
0088A5E4 117C 0087 0020             		move.b	#$87,obColType(a0)
0088A5EA 117C 0001 001C             		move.b	#1,obAnim(a0)
0088A5F0 6000                       		bra.s	Msl_Animate2
0088A5F2                            ; ===========================================================================
0088A5F2                            
0088A5F2                            Msl_Animate:	; Routine 2
0088A5F2 6100                       		bsr.s	Msl_ChkCancel
0088A5F4 43F9 0000 0000             		lea	(Ani_Missile).l,a1
0088A5FA 6100 0000                  		bsr.w	AnimateSprite
0088A5FE 6000 0000                  		bra.w	DisplaySprite
0088A602                            
0088A602                            ; ---------------------------------------------------------------------------
0088A602                            ; Subroutine to	check if the Buzz Bomber which fired the missile has been
0088A602                            ; destroyed, and if it has, then cancel	the missile
0088A602                            ; ---------------------------------------------------------------------------
0088A602                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088A602                            
0088A602                            
0088A602                            Msl_ChkCancel:				; XREF: Msl_Main
0088A602 2268 003C                  		movea.l	parent(a0),a1
0088A606 0C29 0000 0000             		cmpi.b	#id_ExplosionItem,0(a1) ; has Buzz Bomber been destroyed?
0088A60C 6700                       		beq.s	Msl_Delete	; if yes, branch
0088A60E 4E75                       		rts	
0088A610                            ; End of function Msl_ChkCancel
0088A610                            
0088A610                            ; ===========================================================================
0088A610                            
0088A610                            Msl_FromBuzz:	; Routine 4
0088A610 0828 0007 0022             		btst	#7,obStatus(a0)
0088A616 6600                       		bne.s	@explode
0088A618 117C 0087 0020             		move.b	#$87,obColType(a0)
0088A61E 117C 0001 001C             		move.b	#1,obAnim(a0)
0088A624 6100 0000                  		bsr.w	ObjectMove
0088A628 43F9 0000 0000             		lea	(Ani_Missile).l,a1
0088A62E 6100 0000                  		bsr.w	AnimateSprite
0088A632 6100 0000                  		bsr.w	DisplaySprite
0088A636 3038 F72E                  		move.w	(v_limitbtm2).w,d0
0088A63A 0640 00E0                  		addi.w	#$E0,d0
0088A63E B068 000C                  		cmp.w	obY(a0),d0	; has object moved below the level boundary?
0088A642 6500                       		bcs.s	Msl_Delete	; if yes, branch
0088A644 4E75                       		rts	
0088A646                            ; ===========================================================================
0088A646                            
0088A646                            	@explode:
0088A646 117C 0000 0000             		move.b	#id_MissileDissolve,0(a0) ; change object to an explosion (Obj24)
0088A64C 117C 0000 0024             		move.b	#0,obRoutine(a0)
0088A652 6000 F2FC                  		bra.w	MissileDissolve
0088A656                            ; ===========================================================================
0088A656                            
0088A656                            Msl_Delete:	; Routine 6
0088A656 6100 0000                  		bsr.w	DeleteObject
0088A65A 4E75                       		rts	
0088A65C                            ; ===========================================================================
0088A65C                            
0088A65C                            Msl_FromNewt:	; Routine 8
0088A65C 4A28 0001                  		tst.b	obRender(a0)
0088A660 6AF4                       		bpl.s	Msl_Delete
0088A662 6100 0000                  		bsr.w	ObjectMove
0088A666                            
0088A666                            Msl_Animate2:				; XREF: Msl_Main
0088A666 43F9 0000 0000             		lea	(Ani_Missile).l,a1
0088A66C 6100 0000                  		bsr.w	AnimateSprite
0088A670 6100 0000                  		bsr.w	DisplaySprite
0088A674 4E75                       		rts	
0088A674 4E75                       		rts	
0088A676                            		include	"_anim\Buzz Bomber.asm"
0088A676                            ; ---------------------------------------------------------------------------
0088A676                            ; Animation script - Buzz Bomber enemy
0088A676                            ; ---------------------------------------------------------------------------
0088A676 0000                       Ani_Buzz:	dc.w @fly1-Ani_Buzz
0088A678 0000                       		dc.w @fly2-Ani_Buzz
0088A67A 0000                       		dc.w @fires-Ani_Buzz
0088A67C 0100 01FF                  @fly1:		dc.b 1,	0, 1, afEnd
0088A680 0102 03FF                  @fly2:		dc.b 1,	2, 3, afEnd
0088A684 0104 05FF                  @fires:		dc.b 1,	4, 5, afEnd
0088A688                            		even
0088A688                            		even
0088A688                            		include	"_anim\Buzz Bomber Missile.asm"
0088A688                            ; ---------------------------------------------------------------------------
0088A688                            ; Animation script - missile that Buzz Bomber throws
0088A688                            ; ---------------------------------------------------------------------------
0088A688 0000                       Ani_Missile:	dc.w @flare-Ani_Missile
0088A68A 0000                       		dc.w @missile-Ani_Missile
0088A68C 0700 01FC                  @flare:		dc.b 7,	0, 1, afRoutine
0088A690 0102 03FF                  @missile:	dc.b 1,	2, 3, afEnd
0088A694                            		even
0088A694                            		even
0088A694                            		include	"_maps\Buzz Bomber.asm"
0088A694                            ; ---------------------------------------------------------------------------
0088A694                            ; Sprite mappings - Buzz Bomber	enemy
0088A694                            ; ---------------------------------------------------------------------------
0088A694 0000 0000                  Map_Buzz:	dc.w @Fly1-Map_Buzz, @Fly2-Map_Buzz
0088A698 0000 0000                  		dc.w @Fly3-Map_Buzz, @Fly4-Map_Buzz
0088A69C 0000 0000                  		dc.w @Fire1-Map_Buzz, @Fire2-Map_Buzz
0088A6A0 06                         @Fly1:		dc.b 6
0088A6A1 F409 0000 E8               		dc.b $F4, 9, 0,	0, $E8	; flying
0088A6A6 F409 000F 00               		dc.b $F4, 9, 0,	$F, 0
0088A6AB 0408 0015 E8               		dc.b 4,	8, 0, $15, $E8
0088A6B0 0404 0018 00               		dc.b 4,	4, 0, $18, 0
0088A6B5 F108 001A EC               		dc.b $F1, 8, 0,	$1A, $EC
0088A6BA F104 001D 04               		dc.b $F1, 4, 0,	$1D, 4
0088A6BF 06                         @Fly2:		dc.b 6
0088A6C0 F409 0000 E8               		dc.b $F4, 9, 0,	0, $E8
0088A6C5 F409 000F 00               		dc.b $F4, 9, 0,	$F, 0
0088A6CA 0408 0015 E8               		dc.b 4,	8, 0, $15, $E8
0088A6CF 0404 0018 00               		dc.b 4,	4, 0, $18, 0
0088A6D4 F408 001F EC               		dc.b $F4, 8, 0,	$1F, $EC
0088A6D9 F404 0022 04               		dc.b $F4, 4, 0,	$22, 4
0088A6DE 07                         @Fly3:		dc.b 7
0088A6DF 0400 0030 0C               		dc.b 4,	0, 0, $30, $C
0088A6E4 F409 0000 E8               		dc.b $F4, 9, 0,	0, $E8
0088A6E9 F409 000F 00               		dc.b $F4, 9, 0,	$F, 0
0088A6EE 0408 0015 E8               		dc.b 4,	8, 0, $15, $E8
0088A6F3 0404 0018 00               		dc.b 4,	4, 0, $18, 0
0088A6F8 F108 001A EC               		dc.b $F1, 8, 0,	$1A, $EC
0088A6FD F104 001D 04               		dc.b $F1, 4, 0,	$1D, 4
0088A702 07                         @Fly4:		dc.b 7
0088A703 0404 0031 0C               		dc.b 4,	4, 0, $31, $C
0088A708 F409 0000 E8               		dc.b $F4, 9, 0,	0, $E8
0088A70D F409 000F 00               		dc.b $F4, 9, 0,	$F, 0
0088A712 0408 0015 E8               		dc.b 4,	8, 0, $15, $E8
0088A717 0404 0018 00               		dc.b 4,	4, 0, $18, 0
0088A71C F408 001F EC               		dc.b $F4, 8, 0,	$1F, $EC
0088A721 F404 0022 04               		dc.b $F4, 4, 0,	$22, 4
0088A726 06                         @Fire1:		dc.b 6
0088A727 F40D 0000 EC               		dc.b $F4, $D, 0, 0, $EC	; stopping and firing
0088A72C 040C 0008 EC               		dc.b 4,	$C, 0, 8, $EC
0088A731 0400 000C 0C               		dc.b 4,	0, 0, $C, $C
0088A736 0C04 000D F4               		dc.b $C, 4, 0, $D, $F4
0088A73B F108 001A EC               		dc.b $F1, 8, 0,	$1A, $EC
0088A740 F104 001D 04               		dc.b $F1, 4, 0,	$1D, 4
0088A745 04                         @Fire2:		dc.b 4
0088A746 F40D 0000 EC               		dc.b $F4, $D, 0, 0, $EC
0088A74B 040C 0008 EC               		dc.b 4,	$C, 0, 8, $EC
0088A750 0400 000C 0C               		dc.b 4,	0, 0, $C, $C
0088A755 0C04 000D F4               		dc.b $C, 4, 0, $D, $F4
0088A75A F408 001F EC               		dc.b $F4, 8, 0,	$1F, $EC
0088A75F F404 0022 04               		dc.b $F4, 4, 0,	$22, 4
0088A764                            		even
0088A764                            		even
0088A764                            		include	"_maps\Buzz Bomber Missile.asm"
0088A764                            ; ---------------------------------------------------------------------------
0088A764                            ; Sprite mappings - missile that Buzz Bomber throws
0088A764                            ; ---------------------------------------------------------------------------
0088A764 0000 0000                  Map_Missile:	dc.w @Flare1-Map_Missile, @Flare2-Map_Missile
0088A768 0000 0000                  		dc.w @Ball1-Map_Missile, @Ball2-Map_Missile
0088A76C 01                         @Flare1:	dc.b 1
0088A76D F805 0024 F8               		dc.b $F8, 5, 0,	$24, $F8 ; buzz bomber firing flare
0088A772 01                         @Flare2:	dc.b 1
0088A773 F805 0028 F8               		dc.b $F8, 5, 0,	$28, $F8
0088A778 01                         @Ball1:		dc.b 1
0088A779 F805 002C F8               		dc.b $F8, 5, 0,	$2C, $F8 ; missile itself
0088A77E 01                         @Ball2:		dc.b 1
0088A77F F805 0033 F8               		dc.b $F8, 5, 0,	$33, $F8
0088A784                            		even
0088A784                            		even
0088A784                            
0088A784                            		include	"_incObj\25 & 37 Rings.asm"
0088A784                            ; ---------------------------------------------------------------------------
0088A784                            ; Object 25 - rings
0088A784                            ; ---------------------------------------------------------------------------
0088A784                            
0088A784                            Rings:					; XREF: Obj_Index
0088A784 7000                       		moveq	#0,d0
0088A786 1028 0024                  		move.b	obRoutine(a0),d0
0088A78A 323B 0000                  		move.w	Ring_Index(pc,d0.w),d1
0088A78E 4EFB 1000                  		jmp	Ring_Index(pc,d1.w)
0088A792                            ; ===========================================================================
0088A792                            Ring_Index:
0088A792 0000                       ptr_Ring_Main:		dc.w Ring_Main-Ring_Index
0088A794 0000                       ptr_Ring_Animate:	dc.w Ring_Animate-Ring_Index
0088A796 0000                       ptr_Ring_Collect:	dc.w Ring_Collect-Ring_Index
0088A798 0000                       ptr_Ring_Sparkle:	dc.w Ring_Sparkle-Ring_Index
0088A79A 0000                       ptr_Ring_Delete:	dc.w Ring_Delete-Ring_Index
0088A79C                            
0088A79C =00000000                  id_Ring_Main:		= ptr_Ring_Main-Ring_Index	; 0
0088A79C =00000002                  id_Ring_Animate:	= ptr_Ring_Animate-Ring_Index	; 2
0088A79C =00000004                  id_Ring_Collect:	= ptr_Ring_Collect-Ring_Index	; 4
0088A79C =00000006                  id_Ring_Sparkle:	= ptr_Ring_Sparkle-Ring_Index	; 6
0088A79C =00000008                  id_Ring_Delete:		= ptr_Ring_Delete-Ring_Index	; 8
0088A79C                            ; ---------------------------------------------------------------------------
0088A79C                            ; Distances between rings (format: horizontal, vertical)
0088A79C                            ; ---------------------------------------------------------------------------
0088A79C 1000                       Ring_PosData:	dc.b $10, 0		; horizontal tight
0088A79E 1800                       		dc.b $18, 0		; horizontal normal
0088A7A0 2000                       		dc.b $20, 0		; horizontal wide
0088A7A2 0010                       		dc.b 0,	$10		; vertical tight
0088A7A4 0018                       		dc.b 0,	$18		; vertical normal
0088A7A6 0020                       		dc.b 0,	$20		; vertical wide
0088A7A8 1010                       		dc.b $10, $10		; diagonal
0088A7AA 1818                       		dc.b $18, $18
0088A7AC 2020                       		dc.b $20, $20
0088A7AE F010                       		dc.b $F0, $10
0088A7B0 E818                       		dc.b $E8, $18
0088A7B2 E020                       		dc.b $E0, $20
0088A7B4 1008                       		dc.b $10, 8
0088A7B6 1810                       		dc.b $18, $10
0088A7B8 F008                       		dc.b $F0, 8
0088A7BA E810                       		dc.b $E8, $10
0088A7BC                            ; ===========================================================================
0088A7BC                            
0088A7BC                            Ring_Main:	; Routine 0
0088A7BC 45F8 FC00                  		lea	(v_objstate).w,a2
0088A7C0 7000                       		moveq	#0,d0
0088A7C2 1028 0023                  		move.b	obRespawnNo(a0),d0
0088A7C6 45F2 0002                  		lea	2(a2,d0.w),a2
0088A7CA 1812                       		move.b	(a2),d4
0088A7CC 1228 0028                  		move.b	obSubtype(a0),d1
0088A7D0 1001                       		move.b	d1,d0
0088A7D2 0241 0007                  		andi.w	#7,d1
0088A7D6 0C41 0007                  		cmpi.w	#7,d1
0088A7DA 6600                       		bne.s	loc_9B80
0088A7DC 7206                       		moveq	#6,d1
0088A7DE                            
0088A7DE                            	loc_9B80:
0088A7DE 4841                       		swap	d1
0088A7E0 323C 0000                  		move.w	#0,d1
0088A7E4 E808                       		lsr.b	#4,d0
0088A7E6 D040                       		add.w	d0,d0
0088A7E8 1A3B 00B2                  		move.b	Ring_PosData(pc,d0.w),d5 ; load ring spacing data
0088A7EC 4885                       		ext.w	d5
0088A7EE 1C3B 00AD                  		move.b	Ring_PosData+1(pc,d0.w),d6
0088A7F2 4886                       		ext.w	d6
0088A7F4 2248                       		movea.l	a0,a1
0088A7F6 3428 0008                  		move.w	obX(a0),d2
0088A7FA 3628 000C                  		move.w	obY(a0),d3
0088A7FE E20C                       		lsr.b	#1,d4
0088A800 6500                       		bcs.s	loc_9C02
0088A802 0892 0007                  		bclr	#7,(a2)
0088A806 6000                       		bra.s	loc_9BBA
0088A808                            ; ===========================================================================
0088A808                            
0088A808                            Ring_MakeRings:
0088A808 4841                       		swap	d1
0088A80A E20C                       		lsr.b	#1,d4
0088A80C 6500                       		bcs.s	loc_9C02
0088A80E 0892 0007                  		bclr	#7,(a2)
0088A812 6100 0000                  		bsr.w	FindFreeObj
0088A816 6600                       		bne.s	loc_9C0E
0088A818                            
0088A818                            loc_9BBA:				; XREF: Ring_Main
0088A818 137C 0000 0000             		move.b	#id_Rings,0(a1)	; load ring object
0088A81E 5429 0024                  		addq.b	#2,obRoutine(a1)
0088A822 3342 0008                  		move.w	d2,obX(a1)	; set x-axis position based on d2
0088A826 3368 0008 0032             		move.w	obX(a0),$32(a1)
0088A82C 3343 000C                  		move.w	d3,obY(a1)	; set y-axis position based on d3
0088A830 237C 0000 0000 0004        		move.l	#Map_Ring,obMap(a1)
0088A838 337C 27B2 0002             		move.w	#$27B2,obGfx(a1)
0088A83E 137C 0004 0001             		move.b	#4,obRender(a1)
0088A844 137C 0002 0018             		move.b	#2,obPriority(a1)
0088A84A 137C 0047 0020             		move.b	#$47,obColType(a1)
0088A850 137C 0008 0019             		move.b	#8,obActWid(a1)
0088A856 1368 0023 0023             		move.b	obRespawnNo(a0),obRespawnNo(a1)
0088A85C 1341 0034                  		move.b	d1,$34(a1)
0088A860                            
0088A860                            loc_9C02:
0088A860 5241                       		addq.w	#1,d1
0088A862 D445                       		add.w	d5,d2		; add ring spacing value to d2
0088A864 D646                       		add.w	d6,d3		; add ring spacing value to d3
0088A866 4841                       		swap	d1
0088A868 51C9 FF9E                  		dbf	d1,Ring_MakeRings ; repeat for	number of rings
0088A86C                            
0088A86C                            loc_9C0E:
0088A86C 0812 0000                  		btst	#0,(a2)
0088A870 6600 0000                  		bne.w	DeleteObject
0088A874                            
0088A874                            Ring_Animate:	; Routine 2
0088A874                            
0088A874 4A38 FE2C                  		tst.b	(v_shield).w
0088A878 6700                       		beq.s	@skip
0088A87A 4A28 0001                  		tst.b	obRender(a0)
0088A87E 6A00                       		bpl.s	@skip
0088A880                            		
0088A880 43F8 D000                  		lea (v_player).w,a1
0088A884                            		
0088A884 3029 0008                  		move.w	obX(a1),d0	; load Sonic's x-axis position
0088A888 9068 0008                  		sub.w	obX(a0),d0
0088A88C 6A00                       		bpl.s	@a1
0088A88E 4440                       		neg.w	d0
0088A890                            		
0088A890                            	@a1:
0088A890 0C40 0040                  		cmpi.w	#$40,d0
0088A894 6200                       		bhi.s	@skip
0088A896                            		
0088A896 3029 000C                  		move.w	obY(a1),d0	; load Sonic's y-axis position
0088A89A 9068 000C                  		sub.w	obY(a0),d0
0088A89E 6A00                       		bpl.s	@a2
0088A8A0 4440                       		neg.w	d0
0088A8A2                            		
0088A8A2                            	@a2:
0088A8A2 0C40 0040                  		cmpi.w	#$40,d0
0088A8A6 6200                       		bhi.s	@skip
0088A8A8                            		
0088A8A8 117C 000A 0024             		move.b	#$A,obRoutine(a0)
0088A8AE 45F8 FC00                  		lea	(v_objstate).w,a2
0088A8B2 7000                       		moveq	#0,d0
0088A8B4 1028 0023                  		move.b	obRespawnNo(a0),d0
0088A8B8 1228 0034                  		move.b	$34(a0),d1
0088A8BC 03F2 0002                  		bset	d1,2(a2,d0.w)
0088A8C0                            		
0088A8C0                            	@skip:
0088A8C0                            
0088A8C0 1178 FEC3 001A             		move.b	(v_ani1_frame).w,obFrame(a0) ; set frame
0088A8C6 6100 0000                  		bsr.w	DisplaySprite
0088A8E6 4E75                       		rts	
0088A8E8                            ; ===========================================================================
0088A8E8                            
0088A8E8                            Ring_Collect:	; Routine 4
0088A8E8 5428 0024                  		addq.b	#2,obRoutine(a0)
0088A8EC 117C 0000 0020             		move.b	#0,obColType(a0)
0088A8F2 117C 0001 0018             		move.b	#1,obPriority(a0)
0088A8F8 6100 0000                  		bsr.w	CollectRing
0088A8FC 45F8 FC00                  		lea	(v_objstate).w,a2
0088A900 7000                       		moveq	#0,d0
0088A902 1028 0023                  		move.b	obRespawnNo(a0),d0
0088A906 1228 0034                  		move.b	$34(a0),d1
0088A90A 03F2 0002                  		bset	d1,2(a2,d0.w)
0088A90E                            
0088A90E                            Ring_Sparkle:	; Routine 6
0088A90E 43F9 0000 0000             		lea	(Ani_Ring).l,a1
0088A914 6100 0000                  		bsr.w	AnimateSprite
0088A918 6000 0000                  		bra.w	DisplaySprite
0088A91C                            ; ===========================================================================
0088A91C                            
0088A91C                            Ring_Delete:	; Routine 8
0088A91C 6000 0000                  		bra.w	DeleteObject
0088A920                            		
0088A920                            Ring_Attract:	; Routine $A
0088A920 4A38 FE2C                  		tst.b	(v_shield).w
0088A924 6600                       		bne.s	@skip
0088A926 117C 0000 0000             		move.b	#id_RingLoss,0(a0)
0088A92C 117C 0002 0024             		move.b	#2,obRoutine(a0)
0088A932 11FC 00FF FEC6             		move.b	#-1,(v_ani3_time).w
0088A938 6000                       		bra.s	@display
0088A93A                            		
0088A93A                            	@skip:
0088A93A 323C 0030                  		move.w	#$30,d1	; horizontal
0088A93E 3038 D008                  		move.w	(v_player+obX).w,d0
0088A942 B068 0008                  		cmp.w	obX(a0),d0
0088A946 6400                       		bcc.s	@a1
0088A948 4441                       		neg.w	d1
0088A94A 4A68 0010                  		tst.w	obVelX(a0)
0088A94E 6B00                       		bmi.s	@a2
0088A950 D241                       		add.w	d1,d1
0088A952 D241                       		add.w	d1,d1
0088A954 6000                       		bra.s	@a2
0088A956                            
0088A956                            	@a1:
0088A956 4A68 0010                  		tst.w	obVelX(a0)
0088A95A 6A00                       		bpl.s	@a2
0088A95C D241                       		add.w	d1,d1
0088A95E D241                       		add.w	d1,d1
0088A960                            
0088A960                            	@a2:
0088A960 D368 0010                  		add.w	d1,obVelX(a0)
0088A964 323C 0030                  		move.w	#$30,d1	; vertical
0088A968 3038 D00C                  		move.w	(v_player+obY).w,d0
0088A96C B068 000C                  		cmp.w	obY(a0),d0
0088A970 6400                       		bcc.s	@a3
0088A972 4441                       		neg.w	d1
0088A974 4A68 0012                  		tst.w	obVelY(a0)
0088A978 6B00                       		bmi.s	@a4
0088A97A D241                       		add.w	d1,d1
0088A97C D241                       		add.w	d1,d1
0088A97E 6000                       		bra.s	@a4
0088A980                            
0088A980                            	@a3:
0088A980 4A68 0012                  		tst.w	obVelY(a0)
0088A984 6A00                       		bpl.s	@a4
0088A986 D241                       		add.w	d1,d1
0088A988 D241                       		add.w	d1,d1
0088A98A                            
0088A98A                            	@a4:
0088A98A D368 0012                  		add.w	d1,obVelY(a0)
0088A98E 6100 0000                  		bsr.w	ObjectMove
0088A992                            		
0088A992                            	@display:
0088A992 1178 FEC3 001A             		move.b	(v_ani1_frame).w,obFrame(a0) ; set frame
0088A998 6000 0000                  		bra.w	DisplaySprite
0088A99C                            
0088A99C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088A99C                            
0088A99C                            
0088A99C                            CollectRing:				; XREF: Ring_Collect
0088A99C 5278 FE20                  		addq.w	#1,(v_rings).w	; add 1 to rings
0088A9A0 0038 0001 FE1D             		ori.b	#1,(f_ringcount).w ; update the rings counter
0088A9A6 303C 0033                  		move.w	#sfx_Ring,d0	; play ring sound
0088A9AA 0C78 0064 FE20             		cmpi.w	#100,(v_rings).w ; do you have < 100 rings?
0088A9B0 6500                       		bcs.s	@playsnd	; if yes, branch
0088A9B2 08F8 0001 FE1B             		bset	#1,(v_lifecount).w ; update lives counter
0088A9B8 6700                       		beq.s	@got100
0088A9BA 0C78 00C8 FE20             		cmpi.w	#200,(v_rings).w ; do you have < 200 rings?
0088A9C0 6500                       		bcs.s	@playsnd	; if yes, branch
0088A9C2 08F8 0002 FE1B             		bset	#2,(v_lifecount).w ; update lives counter
0088A9C8 6600                       		bne.s	@playsnd
0088A9CA                            
0088A9CA                            	@got100:
0088A9CA                            	
0088A9CA                            	;Mercury Lives Over/Underflow Fix
0088A9CA 0C38 0063 FE12             		cmpi.b	#$63,(v_lives).w	; are lives at max?
0088A9D0 6700                       		beq.s	@playbgm
0088A9D2 5238 FE12                  		addq.b	#1,(v_lives).w	; add 1 to number of lives
0088A9D6 5238 FE1C                  		addq.b	#1,(f_lifecount).w ; update the lives counter
0088A9DA                            	@playbgm:
0088A9DA                            	;end Lives Over/Underflow Fix
0088A9DA                            	
0088A9DA 303C 0008                  		move.w	#bgm_ExtraLife,d0 ; play extra life music
0088A9DE                            
0088A9DE                            	@playsnd:
0088A9DE 4EF9 0088 187C             		jmp	(PlaySound_Special).l
0088A9E4                            ; End of function CollectRing
0088A9E4                            
0088A9E4                            ; ===========================================================================
0088A9E4                            ; ---------------------------------------------------------------------------
0088A9E4                            ; Object 37 - rings flying out of Sonic	when he's hit
0088A9E4                            ; ---------------------------------------------------------------------------
0088A9E4                            
0088A9E4                            RingLoss:				; XREF: Obj_Index
0088A9E4 7000                       		moveq	#0,d0
0088A9E6 1028 0024                  		move.b	obRoutine(a0),d0
0088A9EA 323B 0000                  		move.w	RLoss_Index(pc,d0.w),d1
0088A9EE 4EFB 1000                  		jmp	RLoss_Index(pc,d1.w)
0088A9F2                            ; ===========================================================================
0088A9F2 0000                       RLoss_Index:	dc.w RLoss_Count-RLoss_Index
0088A9F4 0000                       		dc.w RLoss_Bounce-RLoss_Index
0088A9F6 0000                       		dc.w RLoss_Collect-RLoss_Index
0088A9F8 0000                       		dc.w RLoss_Sparkle-RLoss_Index
0088A9FA 0000                       		dc.w RLoss_Delete-RLoss_Index
0088A9FC                            ; ===========================================================================
0088A9FC                            
0088A9FC                            RLoss_Count:	; Routine 0
0088A9FC 2248                       		movea.l	a0,a1
0088A9FE 7A00                       		moveq	#0,d5
0088AA00 3A38 FE20                  		move.w	(v_rings).w,d5	; check number of rings you have
0088AA04 7020                       		moveq	#32,d0
0088AA06 BA40                       		cmp.w	d0,d5		; do you have 32 or more?
0088AA08 6500                       		bcs.s	@belowmax	; if not, branch
0088AA0A 3A00                       		move.w	d0,d5		; if yes, set d5 to 32
0088AA0C                            
0088AA0C                            	@belowmax:
0088AA0C 5345                       		subq.w	#1,d5
0088AA0E 383C 0288                  		move.w	#$288,d4
0088AA12 6000                       		bra.s	@makerings
0088AA14                            ; ===========================================================================
0088AA14                            
0088AA14                            	@loop:
0088AA14 6100 0000                  		bsr.w	FindFreeObj
0088AA18 6600 0000                  		bne.w	@resetcounter
0088AA1C                            
0088AA1C                            @makerings:
0088AA1C 137C 0000 0000             		move.b	#id_RingLoss,0(a1) ; load bouncing ring object
0088AA22 5429 0024                  		addq.b	#2,obRoutine(a1)
0088AA26 137C 0008 0016             		move.b	#8,obHeight(a1)
0088AA2C 137C 0008 0017             		move.b	#8,obWidth(a1)
0088AA32 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088AA38 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088AA3E 237C 0000 0000 0004        		move.l	#Map_Ring,obMap(a1)
0088AA46 337C 27B2 0002             		move.w	#$27B2,obGfx(a1)
0088AA4C 137C 0004 0001             		move.b	#4,obRender(a1)
0088AA52 137C 0003 0018             		move.b	#3,obPriority(a1)
0088AA58 137C 0047 0020             		move.b	#$47,obColType(a1)
0088AA5E 137C 0008 0019             		move.b	#8,obActWid(a1)
0088AA64 11FC 00FF FEC6             		move.b	#-1,(v_ani3_time).w
0088AA6A 4A44                       		tst.w	d4
0088AA6C 6B00                       		bmi.s	@loc_9D62
0088AA6E 3004                       		move.w	d4,d0
0088AA70 6100 85AA                  		bsr.w	CalcSine
0088AA74 3404                       		move.w	d4,d2
0088AA76 E04A                       		lsr.w	#8,d2
0088AA78 E560                       		asl.w	d2,d0
0088AA7A E561                       		asl.w	d2,d1
0088AA7C 3400                       		move.w	d0,d2
0088AA7E 3601                       		move.w	d1,d3
0088AA80 0604 0010                  		addi.b	#$10,d4
0088AA84 6400                       		bcc.s	@loc_9D62
0088AA86 0444 0080                  		subi.w	#$80,d4
0088AA8A 6400                       		bcc.s	@loc_9D62
0088AA8C 383C 0288                  		move.w	#$288,d4
0088AA90                            
0088AA90                            	@loc_9D62:
0088AA90 3342 0010                  		move.w	d2,obVelX(a1)
0088AA94 3343 0012                  		move.w	d3,obVelY(a1)
0088AA98 4442                       		neg.w	d2
0088AA9A 4444                       		neg.w	d4
0088AA9C 51CD FF76                  		dbf	d5,@loop	; repeat for number of rings (max 31)
0088AAA0                            
0088AAA0                            @resetcounter:
0088AAA0 31FC 0000 FE20             		move.w	#0,(v_rings).w	; reset number of rings to zero
0088AAA6 11FC 0080 FE1D             		move.b	#$80,(f_ringcount).w ; update ring counter
0088AAAC 11FC 0000 FE1B             		move.b	#0,(v_lifecount).w
0088AABC                            
0088AABC                            RLoss_Bounce:	; Routine 2
0088AABC 1178 FEC7 001A             		move.b	(v_ani3_frame).w,obFrame(a0)
0088AAC2 6100 0000                  		bsr.w	ObjectMove
0088AAC6 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0088AACC 6B00                       		bmi.s	@chkdel
0088AACE 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088AAD2 D007                       		add.b	d7,d0
0088AAD4 0200 0003                  		andi.b	#3,d0
0088AAD8 6600                       		bne.s	@chkdel
0088AADA                            		
0088AADA 3038 F72E                  		move.w	(v_limitbtm2).w,d0
0088AADE 0640 00E0                  		addi.w	#$E0,d0
0088AAE2 B068 000C                  		cmp.w	obY(a0),d0	; has object moved below level boundary?
0088AAE6 6D00                       		blt.s	@bounce		; if yes, branch
0088AAE8                            		
0088AAE8 4EB9 0000 0000             		jsr	ObjFloorDist
0088AAEE 4A41                       		tst.w	d1
0088AAF0 6A00                       		bpl.s	@chkdel
0088AAF2 D368 000C                  		add.w	d1,obY(a0)
0088AAF6                            		
0088AAF6                            	@bounce:
0088AAF6                            	
0088AAF6 3028 0012                  		move.w	obVelY(a0),d0
0088AAFA E440                       		asr.w	#2,d0
0088AAFC 9168 0012                  		sub.w	d0,obVelY(a0)
0088AB00 4468 0012                  		neg.w	obVelY(a0)
0088AB04                            
0088AB04                            	@chkdel:
0088AB04 4A38 FEC6                  		tst.b	(v_ani3_time).w
0088AB08 6700                       		beq.s	RLoss_Delete
0088AB0A                            		
0088AB0A                            	
0088AB0A 4A38 FE2C                  		tst.b	(v_shield).w
0088AB0E 6700                       		beq.s	@skip
0088AB10 4A28 0001                  		tst.b	obRender(a0)
0088AB14 6A00                       		bpl.s	@skip
0088AB16                            		
0088AB16 43F8 D000                  		lea (v_player).w,a1
0088AB1A                            		
0088AB1A 3029 0008                  		move.w	obX(a1),d0	; load Sonic's x-axis position
0088AB1E 9068 0008                  		sub.w	obX(a0),d0
0088AB22 6A00                       		bpl.s	@a1
0088AB24 4440                       		neg.w	d0
0088AB26                            		
0088AB26                            	@a1:
0088AB26 0C40 00A0                  		cmpi.w	#$A0,d0
0088AB2A 6200                       		bhi.s	@skip
0088AB2C                            		
0088AB2C 3029 000C                  		move.w	obY(a1),d0	; load Sonic's y-axis position
0088AB30 9068 000C                  		sub.w	obY(a0),d0
0088AB34 6A00                       		bpl.s	@a2
0088AB36 4440                       		neg.w	d0
0088AB38                            		
0088AB38                            	@a2:
0088AB38 0C40 00A0                  		cmpi.w	#$A0,d0
0088AB3C 6200                       		bhi.s	@skip
0088AB3E                            		
0088AB3E 117C 000A 0024             		move.b	#$A,obRoutine(a0)
0088AB44 117C 0000 0000             		move.b	#id_Rings,0(a0)
0088AB4A                            		
0088AB4A                            	@skip:
0088AB4A                            
0088AB4A 1038 FEC6                  		move.b	(v_ani3_time).w,d0
0088AB4E 0800 0000                  		btst	#0,d0
0088AB52 6700 0000                  		beq.w	DisplaySprite
0088AB56 0C00 0050                  		cmpi.b	#LostRingsFlashTime,d0
0088AB5A 6200 0000                  		bhi.w	DisplaySprite
0088AB5E 4E75                       		rts
0088AB60                            	
0088AB60                            ; ===========================================================================
0088AB60                            
0088AB60                            RLoss_Collect:	; Routine 4
0088AB60 5428 0024                  		addq.b	#2,obRoutine(a0)
0088AB64 117C 0000 0020             		move.b	#0,obColType(a0)
0088AB6A 117C 0001 0018             		move.b	#1,obPriority(a0)
0088AB70 6100 FE2A                  		bsr.w	CollectRing
0088AB74                            
0088AB74                            RLoss_Sparkle:	; Routine 6
0088AB74 43F9 0000 0000             		lea	(Ani_Ring).l,a1
0088AB7A 6100 0000                  		bsr.w	AnimateSprite
0088AB7E 6000 0000                  		bra.w	DisplaySprite
0088AB82                            ; ===========================================================================
0088AB82                            
0088AB82                            RLoss_Delete:	; Routine 8
0088AB82 6000 0000                  		bra.w	DeleteObject
0088AB82 6000 0000                  		bra.w	DeleteObject
0088AB86                            		include	"_incObj\4B Giant Ring.asm"
0088AB86                            ; ---------------------------------------------------------------------------
0088AB86                            ; Object 4B - giant ring for entry to special stage
0088AB86                            ; ---------------------------------------------------------------------------
0088AB86                            
0088AB86                            GiantRing:				; XREF: Obj_Index
0088AB86 7000                       		moveq	#0,d0
0088AB88 1028 0024                  		move.b	obRoutine(a0),d0
0088AB8C 323B 0000                  		move.w	GRing_Index(pc,d0.w),d1
0088AB90 4EFB 1000                  		jmp	GRing_Index(pc,d1.w)
0088AB94                            ; ===========================================================================
0088AB94 0000                       GRing_Index:	dc.w GRing_Main-GRing_Index
0088AB96 0000                       		dc.w GRing_Animate-GRing_Index
0088AB98 0000                       		dc.w GRing_Collect-GRing_Index
0088AB9A 0000                       		dc.w GRing_Delete-GRing_Index
0088AB9C                            ; ===========================================================================
0088AB9C                            
0088AB9C                            GRing_Main:	; Routine 0
0088AB9C 217C 0000 0000 0004        		move.l	#Map_GRing,obMap(a0)
0088ABA4 317C 2400 0002             		move.w	#$2400,obGfx(a0)
0088ABAA 0028 0004 0001             		ori.b	#4,obRender(a0)
0088ABB0 117C 0040 0019             		move.b	#$40,obActWid(a0)
0088ABB6 4A28 0001                  		tst.b	obRender(a0)
0088ABBA 6A00                       		bpl.s	GRing_Animate
0088ABBC                            		
0088ABBC                            		
0088ABBC 0C78 0032 FE20             		cmpi.w	#50,(v_rings).w	; do you have at least 50 rings?
0088ABC2 6400                       		bcc.s	GRing_Okay	; if yes, branch
0088ABC4 4E75                       		rts	
0088ABC6                            ; ===========================================================================
0088ABC6                            
0088ABC6                            GRing_Okay:
0088ABC6 5428 0024                  		addq.b	#2,obRoutine(a0)
0088ABCA 117C 0002 0018             		move.b	#2,obPriority(a0)
0088ABD0 117C 0052 0020             		move.b	#$52,obColType(a0)
0088ABD6                            
0088ABD6                            
0088ABD6                            GRing_Animate:	; Routine 2
0088ABD6 1178 FEC3 001A             		move.b	(v_ani1_frame).w,obFrame(a0)
0088ABFA 6000 0000                  		bra.w	DisplaySprite
0088ABFE                            ; ===========================================================================
0088ABFE                            
0088ABFE                            GRing_Collect:	; Routine 4
0088ABFE 5528 0024                  		subq.b	#2,obRoutine(a0)
0088AC02 117C 0000 0020             		move.b	#0,obColType(a0)
0088AC08 6100 0000                  		bsr.w	FindFreeObj
0088AC0C 6600 0000                  		bne.w	GRing_PlaySnd
0088AC10 137C 0000 0000             		move.b	#id_RingFlash,0(a1) ; load giant ring flash object
0088AC16 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088AC1C 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088AC22 2348 003C                  		move.l	a0,$3C(a1)
0088AC26 3038 D008                  		move.w	(v_player+obX).w,d0
0088AC2A B068 0008                  		cmp.w	obX(a0),d0	; has Sonic come from the left?
0088AC2E 6500                       		bcs.s	GRing_PlaySnd	; if yes, branch
0088AC30 08E9 0000 0001             		bset	#0,obRender(a1)	; reverse flash	object
0088AC36                            
0088AC36                            GRing_PlaySnd:
0088AC40 6094                       		bra.s	GRing_Animate
0088AC42                            ; ===========================================================================
0088AC42                            
0088AC42                            GRing_Delete:	; Routine 6
0088AC42 6000 0000                  		bra.w	DeleteObject
0088AC42 6000 0000                  		bra.w	DeleteObject
0088AC46                            		include	"_incObj\7C Ring Flash.asm"
0088AC46                            ; ---------------------------------------------------------------------------
0088AC46                            ; Object 7C - flash effect when	you collect the	giant ring
0088AC46                            ; ---------------------------------------------------------------------------
0088AC46                            
0088AC46                            RingFlash:				; XREF: Obj_Index
0088AC46 7000                       		moveq	#0,d0
0088AC48 1028 0024                  		move.b	obRoutine(a0),d0
0088AC4C 323B 0000                  		move.w	Flash_Index(pc,d0.w),d1
0088AC50 4EFB 1000                  		jmp	Flash_Index(pc,d1.w)
0088AC54                            ; ===========================================================================
0088AC54 0000                       Flash_Index:	dc.w Flash_Main-Flash_Index
0088AC56 0000                       		dc.w Flash_ChkDel-Flash_Index
0088AC58 0000                       		dc.w Flash_Delete-Flash_Index
0088AC5A                            ; ===========================================================================
0088AC5A                            
0088AC5A                            Flash_Main:	; Routine 0
0088AC5A 5428 0024                  		addq.b	#2,obRoutine(a0)
0088AC5E 217C 0000 0000 0004        		move.l	#Map_Flash,obMap(a0)
0088AC66 317C 2462 0002             		move.w	#$2462,obGfx(a0)
0088AC6C 0028 0004 0001             		ori.b	#4,obRender(a0)
0088AC72 117C 0000 0018             		move.b	#0,obPriority(a0)
0088AC78 117C 0020 0019             		move.b	#$20,obActWid(a0)
0088AC7E 117C 00FF 001A             		move.b	#$FF,obFrame(a0)
0088AC84                            
0088AC84                            Flash_ChkDel:	; Routine 2
0088AC84 6100                       		bsr.s	Flash_Collect
0088ACA4 6000 0000                  		bra.w	DisplaySprite
0088ACA8                            
0088ACA8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088ACA8                            
0088ACA8                            
0088ACA8                            Flash_Collect:
0088ACA8 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0088ACAC 6A00                       		bpl.s	locret_9F76
0088ACAE 117C 0001 001E             		move.b	#1,obTimeFrame(a0)
0088ACB4 5228 001A                  		addq.b	#1,obFrame(a0)
0088ACB8 0C28 0008 001A             		cmpi.b	#8,obFrame(a0)	; has animation	finished?
0088ACBE 6400                       		bcc.s	Flash_End	; if yes, branch
0088ACC0 0C28 0003 001A             		cmpi.b	#3,obFrame(a0)	; is 3rd frame displayed?
0088ACC6 6600                       		bne.s	locret_9F76	; if not, branch
0088ACC8 2268 003C                  		movea.l	$3C(a0),a1	; get parent object address
0088ACCC 137C 0006 0024             		move.b	#6,obRoutine(a1) ; delete parent object
0088ACD2 11FC 001C D01C             		move.b	#$1C,(v_player+obAnim).w ; make Sonic invisible
0088ACD8 11FC 0001 F7CD             		move.b	#1,(f_bigring).w ; stop	Sonic getting bonuses
0088ACDE 4238 FE2D                  		clr.b	(v_invinc).w	; remove invincibility
0088ACE2 4238 FE2C                  		clr.b	(v_shield).w	; remove shield
0088ACE6                            
0088ACE6                            locret_9F76:
0088ACE6 4E75                       		rts	
0088ACE8                            ; ===========================================================================
0088ACE8                            
0088ACE8                            Flash_End:
0088ACE8 5428 0024                  		addq.b	#2,obRoutine(a0)
0088ACEC 31FC 0000 D000             		move.w	#0,(v_player).w ; remove Sonic object
0088ACF2 588F                       		addq.l	#4,sp
0088ACF4 4E75                       		rts	
0088ACF6                            ; End of function Flash_Collect
0088ACF6                            
0088ACF6                            ; ===========================================================================
0088ACF6                            
0088ACF6                            Flash_Delete:	; Routine 4
0088ACF6 6000 0000                  		bra.w	DeleteObject
0088ACF6 6000 0000                  		bra.w	DeleteObject
0088ACFA                            
0088ACFA                            		include	"_anim\Rings.asm"
0088ACFA                            ; ---------------------------------------------------------------------------
0088ACFA                            ; Animation script - ring
0088ACFA                            ; ---------------------------------------------------------------------------
0088ACFA 0000                       Ani_Ring:	dc.w @ring-Ani_Ring
0088ACFC 0504 0506 07FC             @ring:		dc.b 5,	4, 5, 6, 7, afRoutine
0088AD02                            		even
0088AD02                            		even
0088AD02                            
0088AD02                            		include	"_maps\Rings (JP1).asm"
0088AD02                            ; ---------------------------------------------------------------------------
0088AD02                            ; Sprite mappings - rings
0088AD02                            ; ---------------------------------------------------------------------------
0088AD02 0000 0000                  Map_Ring:	dc.w @front-Map_Ring, @angle1-Map_Ring
0088AD06 0000 0000                  		dc.w @edge-Map_Ring, @angle2-Map_Ring
0088AD0A 0000 0000                  		dc.w @sparkle1-Map_Ring, @sparkle2-Map_Ring
0088AD0E 0000 0000                  		dc.w @sparkle3-Map_Ring, @sparkle4-Map_Ring
0088AD12 0000                       		dc.w @blank-Map_Ring
0088AD14 01                         @front:		dc.b 1
0088AD15 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8	; ring front
0088AD1A 01                         @angle1:	dc.b 1
0088AD1B F805 0004 F8               		dc.b $F8, 5, 0,	4, $F8	; ring angle
0088AD20 01                         @edge:		dc.b 1
0088AD21 F801 0008 FC               		dc.b $F8, 1, 0,	8, $FC	; ring perpendicular
0088AD26 01                         @angle2:	dc.b 1
0088AD27 F805 0804 F8               		dc.b $F8, 5, 8,	4, $F8	; ring angle
0088AD2C 01                         @sparkle1:	dc.b 1
0088AD2D F805 000A F8               		dc.b $F8, 5, 0,	$A, $F8	; sparkle
0088AD32 01                         @sparkle2:	dc.b 1
0088AD33 F805 180A F8               		dc.b $F8, 5, $18, $A, $F8 ; sparkle
0088AD38 01                         @sparkle3:	dc.b 1
0088AD39 F805 080A F8               		dc.b $F8, 5, 8,	$A, $F8	;sparkle
0088AD3E 01                         @sparkle4:	dc.b 1
0088AD3F F805 100A F8               		dc.b $F8, 5, $10, $A, $F8 ; sparkle
0088AD44 00                         @blank:		dc.b 0
0088AD46 00                         		even
0088AD46 00                         		even
0088AD46                            
0088AD46                            		include	"_maps\Giant Ring.asm"
0088AD46                            ; ---------------------------------------------------------------------------
0088AD46                            ; Sprite mappings - giant ring
0088AD46                            ; ---------------------------------------------------------------------------
0088AD46 0000 0000                  Map_GRing:	dc.w byte_9FDA-Map_GRing, byte_A00D-Map_GRing
0088AD4A 0000 0000                  		dc.w byte_A036-Map_GRing, byte_A04B-Map_GRing
0088AD4E 0A                         byte_9FDA:	dc.b $A
0088AD4F E008 0000 E8               		dc.b $E0, 8, 0,	0, $E8	; ring front
0088AD54 E008 0003 00               		dc.b $E0, 8, 0,	3, 0
0088AD59 E80C 0006 E0               		dc.b $E8, $C, 0, 6, $E0
0088AD5E E80C 000A 00               		dc.b $E8, $C, 0, $A, 0
0088AD63 F007 000E E0               		dc.b $F0, 7, 0,	$E, $E0
0088AD68 F007 0016 10               		dc.b $F0, 7, 0,	$16, $10
0088AD6D 100C 001E E0               		dc.b $10, $C, 0, $1E, $E0
0088AD72 100C 0022 00               		dc.b $10, $C, 0, $22, 0
0088AD77 1808 0026 E8               		dc.b $18, 8, 0,	$26, $E8
0088AD7C 1808 0029 00               		dc.b $18, 8, 0,	$29, 0
0088AD81 08                         byte_A00D:	dc.b 8
0088AD82 E00C 002C F0               		dc.b $E0, $C, 0, $2C, $F0 ; ring angle
0088AD87 E808 0030 E8               		dc.b $E8, 8, 0,	$30, $E8
0088AD8C E809 0033 00               		dc.b $E8, 9, 0,	$33, 0
0088AD91 F007 0039 E8               		dc.b $F0, 7, 0,	$39, $E8
0088AD96 F805 0041 08               		dc.b $F8, 5, 0,	$41, 8
0088AD9B 0809 0045 00               		dc.b 8,	9, 0, $45, 0
0088ADA0 1008 004B E8               		dc.b $10, 8, 0,	$4B, $E8
0088ADA5 180C 004E F0               		dc.b $18, $C, 0, $4E, $F0
0088ADAA 04                         byte_A036:	dc.b 4
0088ADAB E007 0052 F4               		dc.b $E0, 7, 0,	$52, $F4 ; ring perpendicular
0088ADB0 E003 0852 04               		dc.b $E0, 3, 8,	$52, 4
0088ADB5 0007 005A F4               		dc.b 0,	7, 0, $5A, $F4
0088ADBA 0003 085A 04               		dc.b 0,	3, 8, $5A, 4
0088ADBF 08                         byte_A04B:	dc.b 8
0088ADC0 E00C 082C F0               		dc.b $E0, $C, 8, $2C, $F0 ; ring angle
0088ADC5 E808 0830 00               		dc.b $E8, 8, 8,	$30, 0
0088ADCA E809 0833 E8               		dc.b $E8, 9, 8,	$33, $E8
0088ADCF F007 0839 08               		dc.b $F0, 7, 8,	$39, 8
0088ADD4 F805 0841 E8               		dc.b $F8, 5, 8,	$41, $E8
0088ADD9 0809 0845 E8               		dc.b 8,	9, 8, $45, $E8
0088ADDE 1008 084B 00               		dc.b $10, 8, 8,	$4B, 0
0088ADE3 180C 084E F0               		dc.b $18, $C, 8, $4E, $F0
0088ADE8                            		even
0088ADE8                            		even
0088ADE8                            		include	"_maps\Ring Flash.asm"
0088ADE8                            ; ---------------------------------------------------------------------------
0088ADE8                            ; Sprite mappings - flash effect when you collect the giant ring
0088ADE8                            ; ---------------------------------------------------------------------------
0088ADE8 0000 0000                  Map_Flash:	dc.w byte_A084-Map_Flash, byte_A08F-Map_Flash
0088ADEC 0000 0000                  		dc.w byte_A0A4-Map_Flash, byte_A0B9-Map_Flash
0088ADF0 0000 0000                  		dc.w byte_A0CE-Map_Flash, byte_A0E3-Map_Flash
0088ADF4 0000 0000                  		dc.w byte_A0F8-Map_Flash, byte_A103-Map_Flash
0088ADF8 02                         byte_A084:	dc.b 2
0088ADF9 E00F 0000 00               		dc.b $E0, $F, 0, 0, 0
0088ADFE 000F 1000 00               		dc.b 0,	$F, $10, 0, 0
0088AE03 04                         byte_A08F:	dc.b 4
0088AE04 E00F 0010 F0               		dc.b $E0, $F, 0, $10, $F0
0088AE09 E007 0020 10               		dc.b $E0, 7, 0,	$20, $10
0088AE0E 000F 1010 F0               		dc.b 0,	$F, $10, $10, $F0
0088AE13 0007 1020 10               		dc.b 0,	7, $10,	$20, $10
0088AE18 04                         byte_A0A4:	dc.b 4
0088AE19 E00F 0028 E8               		dc.b $E0, $F, 0, $28, $E8
0088AE1E E00B 0038 08               		dc.b $E0, $B, 0, $38, 8
0088AE23 000F 1028 E8               		dc.b 0,	$F, $10, $28, $E8
0088AE28 000B 1038 08               		dc.b 0,	$B, $10, $38, 8
0088AE2D 04                         byte_A0B9:	dc.b 4
0088AE2E E00F 0834 E0               		dc.b $E0, $F, 8, $34, $E0
0088AE33 E00F 0034 00               		dc.b $E0, $F, 0, $34, 0
0088AE38 000F 1834 E0               		dc.b 0,	$F, $18, $34, $E0
0088AE3D 000F 1034 00               		dc.b 0,	$F, $10, $34, 0
0088AE42 04                         byte_A0CE:	dc.b 4
0088AE43 E00B 0838 E0               		dc.b $E0, $B, 8, $38, $E0
0088AE48 E00F 0828 F8               		dc.b $E0, $F, 8, $28, $F8
0088AE4D 000B 1838 E0               		dc.b 0,	$B, $18, $38, $E0
0088AE52 000F 1828 F8               		dc.b 0,	$F, $18, $28, $F8
0088AE57 04                         byte_A0E3:	dc.b 4
0088AE58 E007 0820 E0               		dc.b $E0, 7, 8,	$20, $E0
0088AE5D E00F 0810 F0               		dc.b $E0, $F, 8, $10, $F0
0088AE62 0007 1820 E0               		dc.b 0,	7, $18,	$20, $E0
0088AE67 000F 1810 F0               		dc.b 0,	$F, $18, $10, $F0
0088AE6C 02                         byte_A0F8:	dc.b 2
0088AE6D E00F 0800 E0               		dc.b $E0, $F, 8, 0, $E0
0088AE72 000F 1800 E0               		dc.b 0,	$F, $18, 0, $E0
0088AE77 04                         byte_A103:	dc.b 4
0088AE78 E00F 0044 E0               		dc.b $E0, $F, 0, $44, $E0
0088AE7D E00F 0844 00               		dc.b $E0, $F, 8, $44, 0
0088AE82 000F 1044 E0               		dc.b 0,	$F, $10, $44, $E0
0088AE87 000F 1844 00               		dc.b 0,	$F, $18, $44, 0
0088AE8C                            		even
0088AE8C                            		even
0088AE8C                            		include	"_incObj\26 Monitor.asm"
0088AE8C                            ; ---------------------------------------------------------------------------
0088AE8C                            ; Object 26 - monitors
0088AE8C                            ; ---------------------------------------------------------------------------
0088AE8C                            
0088AE8C                            Monitor:				; XREF: Obj_Index
0088AE8C 7000                       		moveq	#0,d0
0088AE8E 1028 0024                  		move.b	obRoutine(a0),d0
0088AE92 323B 0000                  		move.w	Mon_Index(pc,d0.w),d1
0088AE96 4EFB 1000                  		jmp	Mon_Index(pc,d1.w)
0088AE9A                            ; ===========================================================================
0088AE9A 0000                       Mon_Index:	dc.w Mon_Main-Mon_Index
0088AE9C 0000                       		dc.w Mon_Solid-Mon_Index
0088AE9E 0000                       		dc.w Mon_BreakOpen-Mon_Index
0088AEA0 0000                       		dc.w Mon_Animate-Mon_Index
0088AEA2 0000                       		dc.w Mon_Display-Mon_Index
0088AEA4                            ; ===========================================================================
0088AEA4                            
0088AEA4                            Mon_Main:	; Routine 0
0088AEA4 5428 0024                  		addq.b	#2,obRoutine(a0)
0088AEA8 117C 000E 0016             		move.b	#$E,obHeight(a0)
0088AEAE 117C 000E 0017             		move.b	#$E,obWidth(a0)
0088AEB4 217C 0000 0000 0004        		move.l	#Map_Monitor,obMap(a0)
0088AEBC 317C 0680 0002             		move.w	#$680,obGfx(a0)
0088AEC2 117C 0004 0001             		move.b	#4,obRender(a0)
0088AEC8 117C 0003 0018             		move.b	#3,obPriority(a0)
0088AECE 117C 000F 0019             		move.b	#$F,obActWid(a0)
0088AED4 45F8 FC00                  		lea	(v_objstate).w,a2
0088AED8 7000                       		moveq	#0,d0
0088AEDA 1028 0023                  		move.b	obRespawnNo(a0),d0
0088AEDE 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
0088AEE4 0832 0000 0002             		btst	#0,2(a2,d0.w)	; has monitor been broken?
0088AEEA 6700                       		beq.s	@notbroken	; if not, branch
0088AEEC 117C 0008 0024             		move.b	#8,obRoutine(a0) ; run "Mon_Display" routine
0088AEF2 117C 000B 001A             		move.b	#$B,obFrame(a0)	; use broken monitor frame
0088AEF8 4E75                       		rts	
0088AEFA                            ; ===========================================================================
0088AEFA                            
0088AEFA                            	@notbroken:
0088AEFA 117C 0046 0020             		move.b	#$46,obColType(a0)
0088AF00 1168 0028 001C             		move.b	obSubtype(a0),obAnim(a0)
0088AF06                            
0088AF06                            Mon_Solid:	; Routine 2
0088AF06 1028 0025                  		move.b	ob2ndRout(a0),d0 ; is monitor set to fall?
0088AF0A 6700                       		beq.s	@normal		; if not, branch
0088AF0C 5500                       		subq.b	#2,d0
0088AF0E 6600                       		bne.s	@fall
0088AF10                            
0088AF10                            		; 2nd Routine 2
0088AF10 7200                       		moveq	#0,d1
0088AF12 1228 0019                  		move.b	obActWid(a0),d1
0088AF16 0641 000B                  		addi.w	#$B,d1
0088AF1A 6100 D2D8                  		bsr.w	ExitPlatform
0088AF1E 0829 0003 0022             		btst	#3,obStatus(a1) ; is Sonic on top of the monitor?
0088AF24 6600 0000                  		bne.w	@ontop		; if yes, branch
0088AF28 4228 0025                  		clr.b	ob2ndRout(a0)
0088AF2C 6000 0000                  		bra.w	Mon_Animate
0088AF30                            ; ===========================================================================
0088AF30                            
0088AF30                            	@ontop:
0088AF30 363C 0010                  		move.w	#$10,d3
0088AF34 3428 0008                  		move.w	obX(a0),d2
0088AF38 6100 D81C                  		bsr.w	MvSonicOnPtfm
0088AF3C 6000 0000                  		bra.w	Mon_Animate
0088AF40                            ; ===========================================================================
0088AF40                            
0088AF40                            @fall:		; 2nd Routine 4
0088AF40 6100 0000                  		bsr.w	ObjectMoveAndFall
0088AF44 4EB9 0000 0000             		jsr	ObjFloorDist
0088AF4A 4A41                       		tst.w	d1
0088AF4C 6A00 0000                  		bpl.w	Mon_Animate
0088AF50 D368 000C                  		add.w	d1,obY(a0)
0088AF54 4268 0012                  		clr.w	obVelY(a0)
0088AF58 4228 0025                  		clr.b	ob2ndRout(a0)
0088AF5C 6000 0000                  		bra.w	Mon_Animate
0088AF60                            ; ===========================================================================
0088AF60                            
0088AF60                            @normal:	; 2nd Routine 0
0088AF60 323C 001A                  		move.w	#$1A,d1
0088AF64 343C 000F                  		move.w	#$F,d2
0088AF68 6100 0000                  		bsr.w	Mon_SolidSides
0088AF6C 6700 0000                  		beq.w	loc_A25C
0088AF70 4A69 0012                  		tst.w	obVelY(a1)
0088AF74 6B00                       		bmi.s	loc_A20A
0088AF76 0C29 0000 001C             		cmpi.b	#id_Roll,obAnim(a1) ; is Sonic rolling?
0088AF7C 6700                       		beq.s	loc_A25C	; if yes, branch
0088AF7E                            
0088AF7E                            loc_A20A:
0088AF7E 4A41                       		tst.w	d1
0088AF80 6A00                       		bpl.s	loc_A220
0088AF82 9769 000C                  		sub.w	d3,obY(a1)
0088AF86 6100 D15A                  		bsr.w	loc_74AE
0088AF8A 117C 0002 0025             		move.b	#2,ob2ndRout(a0)
0088AF90 6000 0000                  		bra.w	Mon_Animate
0088AF94                            ; ===========================================================================
0088AF94                            
0088AF94                            loc_A220:
0088AF94 4A40                       		tst.w	d0
0088AF96 6700 0000                  		beq.w	loc_A246
0088AF9A 6B00                       		bmi.s	loc_A230
0088AF9C 4A69 0010                  		tst.w	obVelX(a1)
0088AFA0 6B00                       		bmi.s	loc_A246
0088AFA2 6000                       		bra.s	loc_A236
0088AFA4                            ; ===========================================================================
0088AFA4                            
0088AFA4                            loc_A230:
0088AFA4 4A69 0010                  		tst.w	obVelX(a1)
0088AFA8 6A00                       		bpl.s	loc_A246
0088AFAA                            
0088AFAA                            loc_A236:
0088AFAA 9169 0008                  		sub.w	d0,obX(a1)
0088AFAE 337C 0000 0014             		move.w	#0,obInertia(a1)
0088AFB4 337C 0000 0010             		move.w	#0,obVelX(a1)
0088AFBA                            
0088AFBA                            loc_A246:
0088AFBA 0829 0001 0022             		btst	#1,obStatus(a1)
0088AFC0 6600                       		bne.s	loc_A26A
0088AFC2 08E9 0005 0022             		bset	#staPush,obStatus(a1)	;Mercury Constants
0088AFC8 08E8 0005 0022             		bset	#staPush,obStatus(a0)	;Mercury Constants
0088AFCE 6000                       		bra.s	Mon_Animate
0088AFD0                            ; ===========================================================================
0088AFD0                            
0088AFD0                            loc_A25C:
0088AFD0 0828 0005 0022             		btst	#staPush,obStatus(a0)	;Mercury Constants
0088AFD6 6700                       		beq.s	Mon_Animate
0088AFD8                            		
0088AFD8                            		;move.w	#id_Run,obAnim(a1)	;Mercury Walking In Air Fix
0088AFD8                            
0088AFD8                            loc_A26A:
0088AFD8 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
0088AFDE 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
0088AFE4                            
0088AFE4                            Mon_Animate:	; Routine 6
0088AFE4 43F9 0000 0000             		lea	(Ani_Monitor).l,a1
0088AFEA 6100 0000                  		bsr.w	AnimateSprite
0088AFEE                            
0088AFEE                            Mon_Display:	; Routine 8
0088AFEE 6100 0000                  		bsr.w	DisplaySprite
0088B010 4E75                       		rts	
0088B012                            ; ===========================================================================
0088B012                            
0088B012                            Mon_BreakOpen:	; Routine 4
0088B012 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B016 117C 0000 0020             		move.b	#0,obColType(a0)
0088B01C 6100 0000                  		bsr.w	FindFreeObj
0088B020 6600                       		bne.s	Mon_Explode
0088B022 137C 0000 0000             		move.b	#id_PowerUp,0(a1) ; load monitor contents object
0088B028 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088B02E 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088B034 1368 001C 001C             		move.b	obAnim(a0),obAnim(a1)
0088B03A                            
0088B03A                            Mon_Explode:
0088B03A 6100 0000                  		bsr.w	FindFreeObj
0088B03E 6600                       		bne.s	@fail
0088B040 137C 0000 0000             		move.b	#id_ExplosionItem,0(a1) ; load explosion object
0088B046 5429 0024                  		addq.b	#2,obRoutine(a1) ; don't create an animal
0088B04A 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088B050 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088B056                            
0088B056                            	@fail:
0088B056 45F8 FC00                  		lea	(v_objstate).w,a2
0088B05A 7000                       		moveq	#0,d0
0088B05C 1028 0023                  		move.b	obRespawnNo(a0),d0
0088B060 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0088B066 117C 0009 001C             		move.b	#9,obAnim(a0)	; set monitor type to broken
0088B06C 6000 0000                  		bra.w	DisplaySprite
0088B06C 6000 0000                  		bra.w	DisplaySprite
0088B070                            		include	"_incObj\2E Monitor Content Power-Up.asm"
0088B070                            ; ---------------------------------------------------------------------------
0088B070                            ; Object 2E - contents of monitors
0088B070                            ; ---------------------------------------------------------------------------
0088B070                            
0088B070                            PowerUp:				; XREF: Obj_Index
0088B070 7000                       		moveq	#0,d0
0088B072 1028 0024                  		move.b	obRoutine(a0),d0
0088B076 323B 0000                  		move.w	Pow_Index(pc,d0.w),d1
0088B07A 4EBB 1000                  		jsr	Pow_Index(pc,d1.w)
0088B07E 6000 0000                  		bra.w	DisplaySprite
0088B082                            ; ===========================================================================
0088B082 0000                       Pow_Index:	dc.w Pow_Main-Pow_Index
0088B084 0000                       		dc.w Pow_Move-Pow_Index
0088B086 0000                       		dc.w Pow_Delete-Pow_Index
0088B088                            ; ===========================================================================
0088B088                            
0088B088                            Pow_Main:	; Routine 0
0088B088 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B08C 317C 0680 0002             		move.w	#$680,obGfx(a0)
0088B092 117C 0024 0001             		move.b	#$24,obRender(a0)
0088B098 117C 0003 0018             		move.b	#3,obPriority(a0)
0088B09E 117C 0008 0019             		move.b	#8,obActWid(a0)
0088B0A4 317C FD00 0012             		move.w	#-$300,obVelY(a0)
0088B0AA 7000                       		moveq	#0,d0
0088B0AC 1028 001C                  		move.b	obAnim(a0),d0	; get subtype
0088B0B0 5400                       		addq.b	#2,d0
0088B0B2 1140 001A                  		move.b	d0,obFrame(a0)	; use correct frame
0088B0B6 227C 0000 0000             		movea.l	#Map_Monitor,a1
0088B0BC D000                       		add.b	d0,d0
0088B0BE D2F1 0000                  		adda.w	(a1,d0.w),a1
0088B0C2 5249                       		addq.w	#1,a1
0088B0C4 2149 0004                  		move.l	a1,obMap(a0)
0088B0C8                            
0088B0C8                            Pow_Move:	; Routine 2
0088B0C8 4A68 0012                  		tst.w	obVelY(a0)	; is object moving?
0088B0CC 6A00 0000                  		bpl.w	Pow_Checks	; if not, branch
0088B0D0 6100 0000                  		bsr.w	ObjectMove
0088B0D4 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; reduce object	speed
0088B0DA 4E75                       		rts	
0088B0DC                            ; ===========================================================================
0088B0DC                            
0088B0DC                            Pow_Checks:
0088B0DC 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B0E0 317C 001D 001E             		move.w	#29,obTimeFrame(a0) ; display icon for half a second
0088B0E6                            
0088B0E6                            Pow_ChkEggman:
0088B0E6 1028 001C                  		move.b	obAnim(a0),d0
0088B0EA 0C00 0001                  		cmpi.b	#1,d0		; does monitor contain Eggman?
0088B0EE 6600                       		bne.s	Pow_ChkSonic
0088B0F0 4E75                       		rts			; Eggman monitor does nothing
0088B0F2                            ; ===========================================================================
0088B0F2                            
0088B0F2                            Pow_ChkSonic:
0088B0F2 0C00 0002                  		cmpi.b	#2,d0		; does monitor contain Sonic?
0088B0F6 6600                       		bne.s	Pow_ChkShoes
0088B0F8                            
0088B0F8                            	ExtraLife:
0088B0F8                            	
0088B0F8                            	;Mercury Lives Over/Underflow Fix
0088B0F8 0C38 0063 FE12             		cmpi.b	#$63,(v_lives).w	; are lives at max?
0088B0FE 6700                       		beq.s	@playbgm
0088B100 5238 FE12                  		addq.b	#1,(v_lives).w	; add 1 to number of lives
0088B104 5238 FE1C                  		addq.b	#1,(f_lifecount).w ; update the lives counter
0088B108                            	@playbgm:
0088B108                            	;end Lives Over/Underflow Fix
0088B108                            	
0088B112                            ; ===========================================================================
0088B112                            
0088B112                            Pow_ChkShoes:
0088B112 0C00 0003                  		cmpi.b	#3,d0		; does monitor contain speed shoes?
0088B116 6600                       		bne.s	Pow_ChkShield
0088B118                            
0088B118 11FC 0001 FE2E             		move.b	#1,(v_shoes).w	; speed up the BG music
0088B11E 31FC 04B0 D034             		move.w	#$4B0,(v_player+obShoes).w	; time limit for the power-up	;Mercury Constants
0088B124 31FC 0C00 F760             		move.w	#$C00,(v_sonspeedmax).w ; change Sonic's top speed
0088B12A 31FC 0018 F762             		move.w	#$18,(v_sonspeedacc).w	; change Sonic's acceleration
0088B130 31FC 0080 F764             		move.w	#$80,(v_sonspeeddec).w	; change Sonic's deceleration
0088B136                            		
0088B136                            	;Mercury Speed Shoes Work Underwater
0088B136 0838 0006 D022             		btst	#staWater,(v_player+obStatus).w	; is Sonic underwater?	;Mercury Constants
0088B13C 6700                       		beq.s	@isdry		; if not, branch
0088B13E 31FC 0600 F760             		move.w	#$600,(v_sonspeedmax).w ; change Sonic's top speed
0088B144 31FC 000C F762             		move.w	#$C,(v_sonspeedacc).w	; change Sonic's acceleration
0088B14A 31FC 0040 F764             		move.w	#$40,(v_sonspeeddec).w	; change Sonic's deceleration
0088B150                            	@isdry:
0088B150                            	;end Speed Shoes Work Underwater
0088B150                            		
0088B150 303C 0008                  		move.w	#8,d0
0088B154 4EF9 0088 18B4             		jmp	(SetTempo).l	; Speed	up the music
0088B15A                            ; ===========================================================================
0088B15A                            
0088B15A                            Pow_ChkShield:
0088B15A 0C00 0004                  		cmpi.b	#4,d0		; does monitor contain a shield?
0088B15E 6600                       		bne.s	Pow_ChkInvinc
0088B160                            
0088B160 11FC 0001 FE2C             		move.b	#1,(v_shield).w	; give Sonic a shield
0088B166 11FC 0000 D180             		move.b	#id_ShieldItem,(v_objspace+$180).w ; load shield object ($38)
0088B176                            ; ===========================================================================
0088B176                            
0088B176                            Pow_ChkInvinc:
0088B176 0C00 0005                  		cmpi.b	#5,d0		; does monitor contain invincibility?
0088B17A 6600                       		bne.s	Pow_ChkRings
0088B17C                            
0088B17C 11FC 0001 FE2D             		move.b	#1,(v_invinc).w	; make Sonic invincible
0088B182 31FC 04B0 D032             		move.w	#$4B0,(v_player+$32).w ; time limit for the power-up
0088B188 11FC 0000 D200             		move.b	#id_ShieldItem,(v_objspace+$200).w ; load stars object ($3801)
0088B18E 11FC 0001 D21C             		move.b	#1,(v_objspace+$200+obAnim).w
0088B194 11FC 0000 D240             		move.b	#id_ShieldItem,(v_objspace+$240).w ; load stars object ($3802)
0088B19A 11FC 0002 D25C             		move.b	#2,(v_objspace+$240+obAnim).w
0088B1A0 11FC 0000 D280             		move.b	#id_ShieldItem,(v_objspace+$280).w ; load stars object ($3803)
0088B1A6 11FC 0003 D29C             		move.b	#3,(v_objspace+$280+obAnim).w
0088B1AC 11FC 0000 D2C0             		move.b	#id_ShieldItem,(v_objspace+$2C0).w ; load stars object ($3804)
0088B1B2 11FC 0004 D2DC             		move.b	#4,(v_objspace+$2C0+obAnim).w
0088B1B8 4A38 F7AA                  		tst.b	(f_lockscreen).w ; is boss mode on?
0088B1BC 6600                       		bne.s	Pow_NoMusic	; if yes, branch
0088B1BE                            
0088B1BE 0C78 000C FE14             		cmpi.w	#$C,(v_air).w
0088B1C4 6300                       		bls.s	Pow_NoMusic
0088B1C6                            
0088B1D0                            ; ===========================================================================
0088B1D0                            
0088B1D0                            Pow_NoMusic:
0088B1D0 4E75                       		rts	
0088B1D2                            ; ===========================================================================
0088B1D2                            
0088B1D2                            Pow_ChkRings:
0088B1D2 0C00 0006                  		cmpi.b	#6,d0		; does monitor contain 10 rings?
0088B1D6 6600                       		bne.s	Pow_ChkS
0088B1D8                            
0088B1D8 0678 000A FE20             		addi.w	#10,(v_rings).w	; add 10 rings to the number of rings you have
0088B1DE 0038 0001 FE1D             		ori.b	#1,(f_ringcount).w ; update the ring counter
0088B1E4 0C78 0064 FE20             		cmpi.w	#100,(v_rings).w ; check if you have 100 rings
0088B1EA 6500                       		bcs.s	Pow_RingSound
0088B1EC 08F8 0001 FE1B             		bset	#1,(v_lifecount).w
0088B1F2 6700 FF04                  		beq.w	ExtraLife
0088B1F6 0C78 00C8 FE20             		cmpi.w	#200,(v_rings).w ; check if you have 200 rings
0088B1FC 6500                       		bcs.s	Pow_RingSound
0088B1FE 08F8 0002 FE1B             		bset	#2,(v_lifecount).w
0088B204 6700 FEF2                  		beq.w	ExtraLife
0088B208                            
0088B208                            	Pow_RingSound:
0088B212                            ; ===========================================================================
0088B212                            
0088B212                            Pow_ChkS:
0088B212 0C00 0007                  		cmpi.b	#7,d0		; does monitor contain 'S'?
0088B216 6600                       		bne.s	Pow_ChkEnd
0088B218 4E71                       		nop	
0088B21A                            
0088B21A                            Pow_ChkEnd:
0088B21A 4E75                       		rts			; 'S' and goggles monitors do nothing
0088B21C                            ; ===========================================================================
0088B21C                            
0088B21C                            Pow_Delete:	; Routine 4
0088B21C 5368 001E                  		subq.w	#1,obTimeFrame(a0)
0088B220 6B00 0000                  		bmi.w	DeleteObject	; delete after half a second
0088B224 4E75                       		rts	
0088B224 4E75                       		rts	
0088B226                            		include	"_incObj\26 Monitor (SolidSides subroutine).asm"
0088B226                            ; ---------------------------------------------------------------------------
0088B226                            ; Subroutine to	make the sides of a monitor solid
0088B226                            ; ---------------------------------------------------------------------------
0088B226                            
0088B226                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088B226                            
0088B226                            
0088B226                            Mon_SolidSides:
0088B226 43F8 D000                  		lea	(v_player).w,a1
0088B22A 3029 0008                  		move.w	obX(a1),d0
0088B22E 9068 0008                  		sub.w	obX(a0),d0
0088B232 D041                       		add.w	d1,d0
0088B234 6B00                       		bmi.s	loc_A4E6
0088B236 3601                       		move.w	d1,d3
0088B238 D643                       		add.w	d3,d3
0088B23A B043                       		cmp.w	d3,d0
0088B23C 6200                       		bhi.s	loc_A4E6
0088B23E 1629 0016                  		move.b	obHeight(a1),d3
0088B242 4883                       		ext.w	d3
0088B244 D443                       		add.w	d3,d2
0088B246 3629 000C                  		move.w	obY(a1),d3
0088B24A 9668 000C                  		sub.w	obY(a0),d3
0088B24E D642                       		add.w	d2,d3
0088B250 6B00                       		bmi.s	loc_A4E6
0088B252 D442                       		add.w	d2,d2
0088B254 B642                       		cmp.w	d2,d3
0088B256 6400                       		bcc.s	loc_A4E6
0088B258 4A38 F7C8                  		tst.b	(f_lockmulti).w
0088B25C 6B00                       		bmi.s	loc_A4E6
0088B25E 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w
0088B264 6400                       		bcc.s	loc_A4E6
0088B266 4A78 FE08                  		tst.w	(v_debuguse).w
0088B26A 6600                       		bne.s	loc_A4E6
0088B26C B240                       		cmp.w	d0,d1
0088B26E 6400                       		bcc.s	loc_A4DC
0088B270 D241                       		add.w	d1,d1
0088B272 9041                       		sub.w	d1,d0
0088B274                            
0088B274                            loc_A4DC:
0088B274 0C43 0010                  		cmpi.w	#$10,d3
0088B278 6500                       		bcs.s	loc_A4EA
0088B27A                            
0088B27A                            loc_A4E2:
0088B27A 7201                       		moveq	#1,d1
0088B27C 4E75                       		rts	
0088B27E                            ; ===========================================================================
0088B27E                            
0088B27E                            loc_A4E6:
0088B27E 7200                       		moveq	#0,d1
0088B280 4E75                       		rts	
0088B282                            ; ===========================================================================
0088B282                            
0088B282                            loc_A4EA:
0088B282 7200                       		moveq	#0,d1
0088B284 1228 0019                  		move.b	obActWid(a0),d1
0088B288 5841                       		addq.w	#4,d1
0088B28A 3401                       		move.w	d1,d2
0088B28C D442                       		add.w	d2,d2
0088B28E D269 0008                  		add.w	obX(a1),d1
0088B292 9268 0008                  		sub.w	obX(a0),d1
0088B296 6BE2                       		bmi.s	loc_A4E2
0088B298 B242                       		cmp.w	d2,d1
0088B29A 64DE                       		bcc.s	loc_A4E2
0088B29C 72FF                       		moveq	#-1,d1
0088B29E 4E75                       		rts	
0088B2A0                            ; End of function Obj26_SolidSides
0088B2A0                            ; End of function Obj26_SolidSides
0088B2A0                            		include	"_anim\Monitor.asm"
0088B2A0                            ; ---------------------------------------------------------------------------
0088B2A0                            ; Animation script - monitors
0088B2A0                            ; ---------------------------------------------------------------------------
0088B2A0 0000 0000 0000             Ani_Monitor:	dc.w @static-Ani_Monitor, @eggman-Ani_Monitor, @sonic-Ani_Monitor
0088B2A6 0000 0000 0000             		dc.w @shoes-Ani_Monitor, @shield-Ani_Monitor, @invincible-Ani_Monitor
0088B2AC 0000 0000 0000             		dc.w @rings-Ani_Monitor, @s-Ani_Monitor, @goggles-Ani_Monitor
0088B2B2 0000                       		dc.w @breaking-Ani_Monitor
0088B2B4 0100 0102 FF               @static:	dc.b 1,	0, 1, 2, afEnd
0088B2BA 00                         		even
0088B2BA 0100 0303 0103 0302 0303+  @eggman:	dc.b 1,	0, 3, 3, 1, 3, 3, 2, 3,	3, afEnd
0088B2C6 00                         		even
0088B2C6 0100 0404 0104 0402 0404+  @sonic:		dc.b 1,	0, 4, 4, 1, 4, 4, 2, 4,	4, afEnd
0088B2D2 00                         		even
0088B2D2 0100 0505 0105 0502 0505+  @shoes:		dc.b 1,	0, 5, 5, 1, 5, 5, 2, 5,	5, afEnd
0088B2DE 00                         		even
0088B2DE 0100 0606 0106 0602 0606+  @shield:	dc.b 1,	0, 6, 6, 1, 6, 6, 2, 6,	6, afEnd
0088B2EA 00                         		even
0088B2EA 0100 0707 0107 0702 0707+  @invincible:	dc.b 1,	0, 7, 7, 1, 7, 7, 2, 7,	7, afEnd
0088B2F6 00                         		even
0088B2F6 0100 0808 0108 0802 0808+  @rings:		dc.b 1,	0, 8, 8, 1, 8, 8, 2, 8,	8, afEnd
0088B302 00                         		even
0088B302 0100 0909 0109 0902 0909+  @s:		dc.b 1,	0, 9, 9, 1, 9, 9, 2, 9,	9, afEnd
0088B30E 00                         		even
0088B30E 0100 0A0A 010A 0A02 0A0A+  @goggles:	dc.b 1,	0, $A, $A, 1, $A, $A, 2, $A, $A, afEnd
0088B31A 00                         		even
0088B31A 0200 0102 0BFE 01          @breaking:	dc.b 2,	0, 1, 2, $B, afBack, 1
0088B322 00                         		even
0088B322 00                         		even
0088B322                            		include	"_maps\Monitor.asm"
0088B322                            ; ---------------------------------------------------------------------------
0088B322                            ; Sprite mappings - monitors
0088B322                            ; ---------------------------------------------------------------------------
0088B322 0000 0000                  Map_Monitor:	dc.w @static0-Map_Monitor, @static1-Map_Monitor
0088B326 0000 0000                  		dc.w @static2-Map_Monitor, @eggman-Map_Monitor
0088B32A 0000 0000                  		dc.w @sonic-Map_Monitor, @shoes-Map_Monitor
0088B32E 0000 0000                  		dc.w @shield-Map_Monitor, @invincible-Map_Monitor
0088B332 0000 0000                  		dc.w @rings-Map_Monitor, @s-Map_Monitor
0088B336 0000 0000                  		dc.w @goggles-Map_Monitor, @broken-Map_Monitor
0088B33A 01                         @static0:	dc.b 1			; static monitor
0088B33B EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B340 02                         @static1:	dc.b 2			; static monitor
0088B341 F505 0010 F8               		dc.b $F5, 5, 0,	$10, $F8
0088B346 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B34B 02                         @static2:	dc.b 2			; static monitor
0088B34C F505 0014 F8               		dc.b $F5, 5, 0,	$14, $F8
0088B351 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B356 02                         @eggman:	dc.b 2			; Eggman monitor
0088B357 F505 0018 F8               		dc.b $F5, 5, 0,	$18, $F8
0088B35C EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B361 02                         @sonic:		dc.b 2			; Sonic	monitor
0088B362 F505 001C F8               		dc.b $F5, 5, 0,	$1C, $F8
0088B367 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B36C 02                         @shoes:		dc.b 2			; speed	shoes monitor
0088B36D F505 0024 F8               		dc.b $F5, 5, 0,	$24, $F8
0088B372 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B377 02                         @shield:	dc.b 2			; shield monitor
0088B378 F505 0028 F8               		dc.b $F5, 5, 0,	$28, $F8
0088B37D EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B382 02                         @invincible:	dc.b 2			; invincibility	monitor
0088B383 F505 002C F8               		dc.b $F5, 5, 0,	$2C, $F8
0088B388 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B38D                            		
0088B38D 02                         @rings:		dc.b 2			; 10 rings monitor
0088B38E F505 0020 F8               		dc.b $F5, 5, 0,	$20, $F8
0088B393 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B398 02                         @s:		dc.b 2			; 'S' monitor
0088B399 F505 003C F8               		dc.b $F5, 5, 0,	$3C, $F8
0088B39E EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B3A3 02                         @goggles:	dc.b 2			; goggles monitor
0088B3A4 F505 0038 F8               		dc.b $F5, 5, 0,	$38, $F8
0088B3A9 EF0F 0000 F0               		dc.b $EF, $F, 0, 0, $F0
0088B3AE 01                         @broken:	dc.b 1			; broken monitor
0088B3AF FF0D 0030 F0               		dc.b $FF, $D, 0, $30, $F0
0088B3B4                            
0088B3B4                            		even
0088B3B4                            		
0088B3B4                            		
0088B3B4                            
0088B3B4                            		include	"_incObj\0E Title Screen Sonic.asm"
0088B3B4                            ; ---------------------------------------------------------------------------
0088B3B4                            ; Object 0E - Sonic on the title screen
0088B3B4                            ; ---------------------------------------------------------------------------
0088B3B4                            
0088B3B4                            TitleSonic:				; XREF: Obj_Index
0088B3B4 7000                       		moveq	#0,d0
0088B3B6 1028 0024                  		move.b	obRoutine(a0),d0
0088B3BA 323B 0000                  		move.w	TSon_Index(pc,d0.w),d1
0088B3BE 4EFB 1000                  		jmp	TSon_Index(pc,d1.w)
0088B3C2                            ; ===========================================================================
0088B3C2 0000                       TSon_Index:	dc.w TSon_Main-TSon_Index
0088B3C4 0000                       		dc.w TSon_Delay-TSon_Index
0088B3C6 0000                       		dc.w TSon_Move-TSon_Index
0088B3C8 0000                       		dc.w TSon_Animate-TSon_Index
0088B3CA                            ; ===========================================================================
0088B3CA                            
0088B3CA                            TSon_Main:	; Routine 0
0088B3CA 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B3CE 317C 00F0 0008             		move.w	#$F0,obX(a0)
0088B3D4 317C 00DE 000A             		move.w	#$DE,obScreenY(a0) ; position is fixed to screen
0088B3DA 217C 0000 0000 0004        		move.l	#Map_TSon,obMap(a0)
0088B3E2 317C 2300 0002             		move.w	#$2300,obGfx(a0)
0088B3E8 117C 0001 0018             		move.b	#1,obPriority(a0)
0088B3EE 117C 001D 001F             		move.b	#29,obDelayAni(a0) ; set time delay to 0.5 seconds
0088B3F4 43F9 0000 0000             		lea	(An_TSon).l,a1
0088B3FA 6100 0000                  		bsr.w	AnimateSprite
0088B3FE                            
0088B3FE                            TSon_Delay:	;Routine 2
0088B3FE 5328 001F                  		subq.b	#1,obDelayAni(a0) ; subtract 1 from time delay
0088B402 6A00                       		bpl.s	@wait		; if time remains, branch
0088B404 5428 0024                  		addq.b	#2,obRoutine(a0) ; go to next routine
0088B408 6000 0000                  		bra.w	DisplaySprite
0088B40C                            
0088B40C                            	@wait:
0088B40C 4E75                       		rts	
0088B40E                            ; ===========================================================================
0088B40E                            
0088B40E                            TSon_Move:	; Routine 4
0088B40E 5168 000A                  		subq.w	#8,obScreenY(a0) ; move Sonic up
0088B412 0C68 0096 000A             		cmpi.w	#$96,obScreenY(a0) ; has Sonic reached final position?
0088B418 6600                       		bne.s	@display	; if not, branch
0088B41A 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B41E                            
0088B41E                            	@display:
0088B41E 6000 0000                  		bra.w	DisplaySprite
0088B422                            
0088B422 4E75                       		rts	
0088B424                            ; ===========================================================================
0088B424                            
0088B424                            TSon_Animate:	; Routine 6
0088B424 43F9 0000 0000             		lea	(An_TSon).l,a1
0088B42A 6100 0000                  		bsr.w	AnimateSprite
0088B42E                            		
0088B42E                            	@display:	;Mercury Custom Demo Delay
0088B42E 6000 0000                  		bra.w	DisplaySprite
0088B432                            ; ===========================================================================
0088B432 4E75                       		rts	
0088B432 4E75                       		rts	
0088B434                            		include	"_incObj\0F Press Start and TM.asm"
0088B434                            ; ---------------------------------------------------------------------------
0088B434                            ; Object 0F - "PRESS START BUTTON" and "TM" from title screen
0088B434                            ; ---------------------------------------------------------------------------
0088B434                            
0088B434                            PSBTM:					; XREF: Obj_Index
0088B434 7000                       		moveq	#0,d0
0088B436 1028 0024                  		move.b	obRoutine(a0),d0
0088B43A 323B 0000                  		move.w	PSB_Index(pc,d0.w),d1
0088B43E 4EBB 1000                  		jsr	PSB_Index(pc,d1.w)
0088B442 6000 0000                  		bra.w	DisplaySprite
0088B446                            ; ===========================================================================
0088B446 0000                       PSB_Index:	dc.w PSB_Main-PSB_Index
0088B448 0000                       		dc.w PSB_PrsStart-PSB_Index
0088B44A 0000                       		dc.w PSB_Exit-PSB_Index
0088B44C                            ; ===========================================================================
0088B44C                            
0088B44C                            PSB_Main:	; Routine 0
0088B44C 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B450 317C 00D0 0008             		move.w	#$D0,obX(a0)
0088B456 317C 0130 000A             		move.w	#$130,obScreenY(a0)
0088B45C 217C 0000 0000 0004        		move.l	#Map_PSB,obMap(a0)
0088B464 317C 0200 0002             		move.w	#$200,obGfx(a0)
0088B46A 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)	; is object "PRESS START"?
0088B470 6500                       		bcs.s	PSB_PrsStart	; if yes, branch
0088B472                            
0088B472 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B476 0C28 0003 001A             		cmpi.b	#3,obFrame(a0)	; is the object	"TM"?
0088B47C 6600                       		bne.s	PSB_Exit	; if not, branch
0088B47E                            
0088B47E 317C 2510 0002             		move.w	#$2510,obGfx(a0) ; "TM" specific code
0088B484 317C 0170 0008             		move.w	#$170,obX(a0)
0088B48A 317C 00F8 000A             		move.w	#$F8,obScreenY(a0)
0088B490                            
0088B490                            PSB_Exit:	; Routine 4
0088B490 4E75                       		rts	
0088B492                            ; ===========================================================================
0088B492                            
0088B492                            PSB_PrsStart:	; Routine 2
0088B492 43F9 0000 0000             		lea	(Ani_PSBTM).l,a1
0088B498 6000 0000                  		bra.w	AnimateSprite	; "PRESS START" is animated
0088B498 6000 0000                  		bra.w	AnimateSprite	; "PRESS START" is animated
0088B49C                            
0088B49C                            		include	"_anim\Title Screen Sonic.asm"
0088B49C                            ; ---------------------------------------------------------------------------
0088B49C                            ; Animation script - Sonic on the title screen
0088B49C                            ; ---------------------------------------------------------------------------
0088B49C 0000                       An_TSon:	dc.w byte_A706-An_TSon
0088B49E 0700 0102 0304 0506 07FE+  byte_A706:	dc.b 7,	0, 1, 2, 3, 4, 5, 6, 7,	afBack, 2
0088B4AA 00                         		even
0088B4AA 00                         		even
0088B4AA                            		include	"_anim\Press Start and TM.asm"
0088B4AA                            ; ---------------------------------------------------------------------------
0088B4AA                            ; Animation script - "TM" and "PRESS START BUTTON" on the title screen
0088B4AA                            ; ---------------------------------------------------------------------------
0088B4AA 0000                       Ani_PSBTM:	dc.w @flash-Ani_PSBTM
0088B4AC 1F00 01FF                  @flash:		dc.b $1F, 0, 1,	afEnd
0088B4B0                            		even
0088B4B0                            		even
0088B4B0                            
0088B4B0                            		include	"_incObj\sub AnimateSprite.asm"
0088B4B0                            ; ---------------------------------------------------------------------------
0088B4B0                            ; Subroutine to	animate	a sprite using an animation script
0088B4B0                            ; ---------------------------------------------------------------------------
0088B4B0                            
0088B4B0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088B4B0                            
0088B4B0                            
0088B4B0                            AnimateSprite:
0088B4B0 7000                       		moveq	#0,d0
0088B4B2 1028 001C                  		move.b	obAnim(a0),d0	; move animation number	to d0
0088B4B6 B028 001D                  		cmp.b	obNextAni(a0),d0 ; is animation set to restart?
0088B4BA 6700                       		beq.s	Anim_Run	; if not, branch
0088B4BC                            
0088B4BC 1140 001D                  		move.b	d0,obNextAni(a0) ; set to "no restart"
0088B4C0 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; reset animation
0088B4C6 117C 0000 001E             		move.b	#0,obTimeFrame(a0) ; reset frame duration
0088B4CC                            
0088B4CC                            Anim_Run:
0088B4CC 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
0088B4D0 6A00                       		bpl.s	Anim_Wait	; if time remains, branch
0088B4D2 D040                       		add.w	d0,d0
0088B4D4 D2F1 0000                  		adda.w	(a1,d0.w),a1	; jump to appropriate animation	script
0088B4D8 1151 001E                  		move.b	(a1),obTimeFrame(a0) ; load frame duration
0088B4DC 7200                       		moveq	#0,d1
0088B4DE 1228 001B                  		move.b	obAniFrame(a0),d1 ; load current frame number
0088B4E2 1031 1001                  		move.b	1(a1,d1.w),d0	; read sprite number from script
0088B4E6 6B00                       		bmi.s	Anim_End_FF	; if animation is complete, branch
0088B4E8                            
0088B4E8                            Anim_Next:
0088B4E8 1200                       		move.b	d0,d1
0088B4EA 0200 001F                  		andi.b	#$1F,d0
0088B4EE 1140 001A                  		move.b	d0,obFrame(a0)	; load sprite number
0088B4F2 1028 0022                  		move.b	obStatus(a0),d0
0088B4F6 E719                       		rol.b	#3,d1
0088B4F8 B101                       		eor.b	d0,d1
0088B4FA 0201 0003                  		andi.b	#3,d1
0088B4FE 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0088B504 8328 0001                  		or.b	d1,obRender(a0)
0088B508 5228 001B                  		addq.b	#1,obAniFrame(a0) ; next frame number
0088B50C                            
0088B50C                            Anim_Wait:
0088B50C 4E75                       		rts	
0088B50E                            ; ===========================================================================
0088B50E                            
0088B50E                            Anim_End_FF:
0088B50E 5200                       		addq.b	#1,d0		; is the end flag = $FF	?
0088B510 6600                       		bne.s	Anim_End_FE	; if not, branch
0088B512 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; restart the animation
0088B518 1029 0001                  		move.b	1(a1),d0	; read sprite number
0088B51C 60CA                       		bra.s	Anim_Next
0088B51E                            ; ===========================================================================
0088B51E                            
0088B51E                            Anim_End_FE:
0088B51E 5200                       		addq.b	#1,d0		; is the end flag = $FE	?
0088B520 6600                       		bne.s	Anim_End_FD	; if not, branch
0088B522 1031 1002                  		move.b	2(a1,d1.w),d0	; read the next	byte in	the script
0088B526 9128 001B                  		sub.b	d0,obAniFrame(a0) ; jump back d0 bytes in the script
0088B52A 9200                       		sub.b	d0,d1
0088B52C 1031 1001                  		move.b	1(a1,d1.w),d0	; read sprite number
0088B530 60B6                       		bra.s	Anim_Next
0088B532                            ; ===========================================================================
0088B532                            
0088B532                            Anim_End_FD:
0088B532 5200                       		addq.b	#1,d0		; is the end flag = $FD	?
0088B534 6600                       		bne.s	Anim_End_FC	; if not, branch
0088B536 1171 1002 001C             		move.b	2(a1,d1.w),obAnim(a0) ; read next byte, run that animation
0088B53C                            
0088B53C                            Anim_End_FC:
0088B53C 5200                       		addq.b	#1,d0		; is the end flag = $FC	?
0088B53E 6600                       		bne.s	Anim_End_FB	; if not, branch
0088B540 5428 0024                  		addq.b	#2,obRoutine(a0) ; jump to next routine
0088B544                            
0088B544                            Anim_End_FB:
0088B544 5200                       		addq.b	#1,d0		; is the end flag = $FB	?
0088B546 6600                       		bne.s	Anim_End_FA	; if not, branch
0088B548 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; reset animation
0088B54E 4228 0025                  		clr.b	ob2ndRout(a0)	; reset	2nd routine counter
0088B552                            
0088B552                            Anim_End_FA:
0088B552 5200                       		addq.b	#1,d0		; is the end flag = $FA	?
0088B554 6600                       		bne.s	Anim_End	; if not, branch
0088B556 5428 0025                  		addq.b	#2,ob2ndRout(a0) ; jump to next routine
0088B55A                            
0088B55A                            Anim_End:
0088B55A 4E75                       		rts	
0088B55C                            ; End of function AnimateSprite
0088B55C                            ; End of function AnimateSprite
0088B55C                            
0088B55C                            		include	"_maps\Press Start and TM.asm"
0088B55C                            ; ---------------------------------------------------------------------------
0088B55C                            ; Sprite mappings - "PRESS START BUTTON" and "TM" from title screen
0088B55C                            ; ---------------------------------------------------------------------------
0088B55C 0000                       Map_PSB:	dc.w byte_A7CD-Map_PSB
0088B55E 0000                       		dc.w M_PSB_PSB-Map_PSB
0088B560 0000                       		dc.w M_PSB_Limiter-Map_PSB
0088B562 0000                       		dc.w M_PSB_TM-Map_PSB
0088B564 06                         M_PSB_PSB:	dc.b 6			; "PRESS START BUTTON"
0088B565 000C 00F0 00               byte_A7CD:	dc.b 0,	$C, 0, $F0, 0
0088B56A 0000 00F3 20               		dc.b 0,	0, 0, $F3, $20
0088B56F 0000 00F3 30               		dc.b 0,	0, 0, $F3, $30
0088B574 000C 00F4 38               		dc.b 0,	$C, 0, $F4, $38
0088B579 0008 00F8 60               		dc.b 0,	8, 0, $F8, $60
0088B57E 0008 00FB 78               		dc.b 0,	8, 0, $FB, $78
0088B583 1E                         M_PSB_Limiter:	dc.b $1E		; sprite line limiter
0088B584 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B589 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B58E B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B593 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B598 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B59D B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B5A2 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B5A7 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B5AC B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B5B1 B80F 0000 80               		dc.b $B8, $F, 0, 0, $80
0088B5B6 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5BB D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5C0 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5C5 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5CA D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5CF D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5D4 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5D9 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5DE D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5E3 D80F 0000 80               		dc.b $D8, $F, 0, 0, $80
0088B5E8 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B5ED F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B5F2 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B5F7 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B5FC F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B601 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B606 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B60B F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B610 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B615 F80F 0000 80               		dc.b $F8, $F, 0, 0, $80
0088B61A 01                         M_PSB_TM:	dc.b 1			; "TM"
0088B61B FC04 0000 F8               		dc.b $FC, 4, 0,	0, $F8
0088B620                            		even
0088B620                            		even
0088B620                            		include	"_maps\Title Screen Sonic.asm"
0088B620                            ; ---------------------------------------------------------------------------
0088B620                            ; Sprite mappings - Sonic on the title screen
0088B620                            ; ---------------------------------------------------------------------------
0088B620 0000                       Map_TSon:	dc.w byte_A898-Map_TSon
0088B622 0000                       		dc.w byte_A8CB-Map_TSon
0088B624 0000                       		dc.w byte_A917-Map_TSon
0088B626 0000                       		dc.w byte_A96D-Map_TSon
0088B628 0000                       		dc.w byte_A9AF-Map_TSon
0088B62A 0000                       		dc.w byte_A9E7-Map_TSon
0088B62C 0000                       		dc.w byte_AA47-Map_TSon
0088B62E 0000                       		dc.w byte_AAB1-Map_TSon
0088B630 0A                         byte_A898:	dc.b $A
0088B631 0808 0000 08               		dc.b 8,	8, 0, 0, 8
0088B636 100F 0003 08               		dc.b $10, $F, 0, 3, 8
0088B63B 100F 0013 28               		dc.b $10, $F, 0, $13, $28
0088B640 300E 0023 08               		dc.b $30, $E, 0, $23, 8
0088B645 300E 002F 28               		dc.b $30, $E, 0, $2F, $28
0088B64A 480D 003B 00               		dc.b $48, $D, 0, $3B, 0
0088B64F 4809 0043 20               		dc.b $48, 9, 0,	$43, $20
0088B654 4800 0049 38               		dc.b $48, 0, 0,	$49, $38
0088B659 580C 004A 08               		dc.b $58, $C, 0, $4A, 8
0088B65E 5800 004E 28               		dc.b $58, 0, 0,	$4E, $28
0088B663 0F                         byte_A8CB:	dc.b $F
0088B664 480E 01BD 20               		dc.b $48, $E, 1, $BD, $20
0088B669 3805 01C9 38               		dc.b $38, 5, 1,	$C9, $38
0088B66E 4000 01CD 30               		dc.b $40, 0, 1,	$CD, $30
0088B673 4800 01CE 40               		dc.b $48, 0, 1,	$CE, $40
0088B678 6000 01CF 20               		dc.b $60, 0, 1,	$CF, $20
0088B67D 100E 004F 08               		dc.b $10, $E, 0, $4F, 8
0088B682 100E 005B 28               		dc.b $10, $E, 0, $5B, $28
0088B687 1801 0067 48               		dc.b $18, 1, 0,	$67, $48
0088B68C 2802 0069 00               		dc.b $28, 2, 0,	$69, 0
0088B691 280F 006C 08               		dc.b $28, $F, 0, $6C, 8
0088B696 280F 007C 28               		dc.b $28, $F, 0, $7C, $28
0088B69B 3002 008C 48               		dc.b $30, 2, 0,	$8C, $48
0088B6A0 480E 008F 10               		dc.b $48, $E, 0, $8F, $10
0088B6A5 4809 009B 30               		dc.b $48, 9, 0,	$9B, $30
0088B6AA 5804 00A1 30               		dc.b $58, 4, 0,	$A1, $30
0088B6AF 11                         byte_A917:	dc.b $11
0088B6B0 380E 01BD 28               		dc.b $38, $E, 1, $BD, $28
0088B6B5 2805 01C9 40               		dc.b $28, 5, 1,	$C9, $40
0088B6BA 3000 01CD 38               		dc.b $30, 0, 1,	$CD, $38
0088B6BF 3800 01CE 48               		dc.b $38, 0, 1,	$CE, $48
0088B6C4 5000 01CF 28               		dc.b $50, 0, 1,	$CF, $28
0088B6C9 200F 01A9 08               		dc.b $20, $F, 1, $A9, 8
0088B6CE 2003 01B9 28               		dc.b $20, 3, 1,	$B9, $28
0088B6D3 100E 004F 08               		dc.b $10, $E, 0, $4F, 8
0088B6D8 100E 005B 28               		dc.b $10, $E, 0, $5B, $28
0088B6DD 1801 0067 48               		dc.b $18, 1, 0,	$67, $48
0088B6E2 2802 0069 00               		dc.b $28, 2, 0,	$69, 0
0088B6E7 280F 006C 08               		dc.b $28, $F, 0, $6C, 8
0088B6EC 280F 007C 28               		dc.b $28, $F, 0, $7C, $28
0088B6F1 3002 008C 48               		dc.b $30, 2, 0,	$8C, $48
0088B6F6 480E 008F 10               		dc.b $48, $E, 0, $8F, $10
0088B6FB 4809 009B 30               		dc.b $48, 9, 0,	$9B, $30
0088B700 5804 00A1 30               		dc.b $58, 4, 0,	$A1, $30
0088B705 0D                         byte_A96D:	dc.b $D
0088B706 100F 00A3 08               		dc.b $10, $F, 0, $A3, 8
0088B70B 0808 00B3 28               		dc.b 8,	8, 0, $B3, $28
0088B710 100F 00B6 28               		dc.b $10, $F, 0, $B6, $28
0088B715 1800 00C6 48               		dc.b $18, 0, 0,	$C6, $48
0088B71A 2006 00C7 48               		dc.b $20, 6, 0,	$C7, $48
0088B71F 3800 00CD 48               		dc.b $38, 0, 0,	$CD, $48
0088B724 300D 00CE 08               		dc.b $30, $D, 0, $CE, 8
0088B729 300E 00D6 28               		dc.b $30, $E, 0, $D6, $28
0088B72E 400B 00E2 10               		dc.b $40, $B, 0, $E2, $10
0088B733 4808 00EE 28               		dc.b $48, 8, 0,	$EE, $28
0088B738 5001 00F1 08               		dc.b $50, 1, 0,	$F1, 8
0088B73D 5004 00F3 28               		dc.b $50, 4, 0,	$F3, $28
0088B742 5800 00F5 28               		dc.b $58, 0, 0,	$F5, $28
0088B747 0B                         byte_A9AF:	dc.b $B
0088B748 080F 00F6 10               		dc.b 8,	$F, 0, $F6, $10
0088B74D 080B 0106 30               		dc.b 8,	$B, 1, 6, $30
0088B752 1006 0112 48               		dc.b $10, 6, 1,	$12, $48
0088B757 280E 0118 18               		dc.b $28, $E, 1, $18, $18
0088B75C 280E 0124 38               		dc.b $28, $E, 1, $24, $38
0088B761 2801 0130 10               		dc.b $28, 1, 1,	$30, $10
0088B766 400E 0132 10               		dc.b $40, $E, 1, $32, $10
0088B76B 4006 013E 30               		dc.b $40, 6, 1,	$3E, $30
0088B770 4004 0144 40               		dc.b $40, 4, 1,	$44, $40
0088B775 4800 0146 40               		dc.b $48, 0, 1,	$46, $40
0088B77A 5808 0147 18               		dc.b $58, 8, 1,	$47, $18
0088B77F 13                         byte_A9E7:	dc.b $13
0088B780 280E 01E4 38               		dc.b $28, $E, 1, $E4, $38
0088B785 1805 01F0 48               		dc.b $18, 5, 1,	$F0, $48
0088B78A 4008 01F4 38               		dc.b $40, 8, 1,	$F4, $38
0088B78F 4804 01F7 38               		dc.b $48, 4, 1,	$F7, $38
0088B794 100F 014A 10               		dc.b $10, $F, 1, $4A, $10
0088B799 0804 015A 20               		dc.b 8,	4, 1, $5A, $20
0088B79E 000B 015C 30               		dc.b 0,	$B, 1, $5C, $30
0088B7A3 0800 0168 48               		dc.b 8,	0, 1, $68, $48
0088B7A8 1800 0169 48               		dc.b $18, 0, 1,	$69, $48
0088B7AD 1805 016A 00               		dc.b $18, 5, 1,	$6A, 0
0088B7B2 2802 016E 08               		dc.b $28, 2, 1,	$6E, 8
0088B7B7 300F 0171 10               		dc.b $30, $F, 1, $71, $10
0088B7BC 200D 0181 30               		dc.b $20, $D, 1, $81, $30
0088B7C1 2001 0189 50               		dc.b $20, 1, 1,	$89, $50
0088B7C6 3008 018B 30               		dc.b $30, 8, 1,	$8B, $30
0088B7CB 380E 018E 30               		dc.b $38, $E, 1, $8E, $30
0088B7D0 500D 019A 08               		dc.b $50, $D, 1, $9A, 8
0088B7D5 500C 01A2 28               		dc.b $50, $C, 1, $A2, $28
0088B7DA 5808 01A6 28               		dc.b $58, 8, 1,	$A6, $28
0088B7DF 15                         byte_AA47:	dc.b $15
0088B7E0 280E 01E4 38               		dc.b $28, $E, 1, $E4, $38
0088B7E5 1805 01F0 48               		dc.b $18, 5, 1,	$F0, $48
0088B7EA 4008 01F4 38               		dc.b $40, 8, 1,	$F4, $38
0088B7EF 4804 01F7 38               		dc.b $48, 4, 1,	$F7, $38
0088B7F4 180F 01D0 08               		dc.b $18, $F, 1, $D0, 8
0088B7F9 1803 01E0 28               		dc.b $18, 3, 1,	$E0, $28
0088B7FE 100F 014A 10               		dc.b $10, $F, 1, $4A, $10
0088B803 0804 015A 20               		dc.b 8,	4, 1, $5A, $20
0088B808 000B 015C 30               		dc.b 0,	$B, 1, $5C, $30
0088B80D 0800 0168 48               		dc.b 8,	0, 1, $68, $48
0088B812 1800 0169 48               		dc.b $18, 0, 1,	$69, $48
0088B817 1805 016A 00               		dc.b $18, 5, 1,	$6A, 0
0088B81C 2802 016E 08               		dc.b $28, 2, 1,	$6E, 8
0088B821 300F 0171 10               		dc.b $30, $F, 1, $71, $10
0088B826 200D 0181 30               		dc.b $20, $D, 1, $81, $30
0088B82B 2001 0189 50               		dc.b $20, 1, 1,	$89, $50
0088B830 3008 018B 30               		dc.b $30, 8, 1,	$8B, $30
0088B835 380E 018E 30               		dc.b $38, $E, 1, $8E, $30
0088B83A 500D 019A 08               		dc.b $50, $D, 1, $9A, 8
0088B83F 500C 01A2 28               		dc.b $50, $C, 1, $A2, $28
0088B844 5808 01A6 28               		dc.b $58, 8, 1,	$A6, $28
0088B849 16                         byte_AAB1:	dc.b $16
0088B84A 1804 01F9 38               		dc.b $18, 4, 1,	$F9, $38
0088B84F 2000 01FB 38               		dc.b $20, 0, 1,	$FB, $38
0088B854 2808 01FC 30               		dc.b $28, 8, 1,	$FC, $30
0088B859 3001 01FF 30               		dc.b $30, 1, 1,	$FF, $30
0088B85E 300B 0201 38               		dc.b $30, $B, 2, 1, $38
0088B863 180F 01D0 08               		dc.b $18, $F, 1, $D0, 8
0088B868 1803 01E0 28               		dc.b $18, 3, 1,	$E0, $28
0088B86D 100F 014A 10               		dc.b $10, $F, 1, $4A, $10
0088B872 0804 015A 20               		dc.b 8,	4, 1, $5A, $20
0088B877 000B 015C 30               		dc.b 0,	$B, 1, $5C, $30
0088B87C 0800 0168 48               		dc.b 8,	0, 1, $68, $48
0088B881 1800 0169 48               		dc.b $18, 0, 1,	$69, $48
0088B886 1805 016A 00               		dc.b $18, 5, 1,	$6A, 0
0088B88B 2802 016E 08               		dc.b $28, 2, 1,	$6E, 8
0088B890 300F 0171 10               		dc.b $30, $F, 1, $71, $10
0088B895 200D 0181 30               		dc.b $20, $D, 1, $81, $30
0088B89A 2001 0189 50               		dc.b $20, 1, 1,	$89, $50
0088B89F 3008 018B 30               		dc.b $30, 8, 1,	$8B, $30
0088B8A4 380E 018E 30               		dc.b $38, $E, 1, $8E, $30
0088B8A9 500D 019A 08               		dc.b $50, $D, 1, $9A, 8
0088B8AE 500C 01A2 28               		dc.b $50, $C, 1, $A2, $28
0088B8B3 5808 01A6 28               		dc.b $58, 8, 1,	$A6, $28
0088B8B8                            		even
0088B8B8                            		even
0088B8B8                            
0088B8B8                            		include	"_incObj\2B Chopper.asm"
0088B8B8                            ; ---------------------------------------------------------------------------
0088B8B8                            ; Object 2B - Chopper enemy (GHZ)
0088B8B8                            ; ---------------------------------------------------------------------------
0088B8B8                            
0088B8B8                            Chopper:				; XREF: Obj_Index
0088B8B8 7000                       		moveq	#0,d0
0088B8BA 1028 0024                  		move.b	obRoutine(a0),d0
0088B8BE 323B 0000                  		move.w	Chop_Index(pc,d0.w),d1
0088B8C2 4EBB 1000                  		jsr	Chop_Index(pc,d1.w)
0088B8C6 6000 0000                  		bra.w	RememberState
0088B8CA                            ; ===========================================================================
0088B8CA 0000                       Chop_Index:	dc.w Chop_Main-Chop_Index
0088B8CC 0000                       		dc.w Chop_ChgSpeed-Chop_Index
0088B8CE                            
0088B8CE =00000030                  origY:		= $30
0088B8CE                            ; ===========================================================================
0088B8CE                            
0088B8CE                            Chop_Main:	; Routine 0
0088B8CE 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B8D2 217C 0000 0000 0004        		move.l	#Map_Chop,obMap(a0)
0088B8DA 317C 047B 0002             		move.w	#$47B,obGfx(a0)
0088B8E0 117C 0004 0001             		move.b	#4,obRender(a0)
0088B8E6 117C 0004 0018             		move.b	#4,obPriority(a0)
0088B8EC 117C 0009 0020             		move.b	#9,obColType(a0)
0088B8F2 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088B8F8 317C F900 0012             		move.w	#-$700,obVelY(a0) ; set vertical speed
0088B8FE 3168 000C 0030             		move.w	obY(a0),origY(a0) ; save original position
0088B904                            
0088B904                            Chop_ChgSpeed:	; Routine 2
0088B904 43F9 0000 0000             		lea	(Ani_Chop).l,a1
0088B90A 6100 FBA4                  		bsr.w	AnimateSprite
0088B90E 6100 0000                  		bsr.w	ObjectMove
0088B912 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; reduce speed
0088B918 3028 0030                  		move.w	origY(a0),d0
0088B91C B068 000C                  		cmp.w	obY(a0),d0	; has Chopper returned to its original position?
0088B920 6400                       		bcc.s	@chganimation	; if not, branch
0088B922 3140 000C                  		move.w	d0,obY(a0)
0088B926 317C F900 0012             		move.w	#-$700,obVelY(a0) ; set vertical speed
0088B92C                            
0088B92C                            	@chganimation:
0088B92C 117C 0001 001C             		move.b	#1,obAnim(a0)	; use fast animation
0088B932 0440 00C0                  		subi.w	#$C0,d0
0088B936 B068 000C                  		cmp.w	obY(a0),d0
0088B93A 6400                       		bcc.s	@nochg
0088B93C 117C 0000 001C             		move.b	#0,obAnim(a0)	; use slow animation
0088B942 4A68 0012                  		tst.w	obVelY(a0)	; is Chopper at	its highest point?
0088B946 6B00                       		bmi.s	@nochg		; if not, branch
0088B948 117C 0002 001C             		move.b	#2,obAnim(a0)	; use stationary animation
0088B94E                            
0088B94E                            	@nochg:
0088B94E 4E75                       		rts	
0088B94E 4E75                       		rts	
0088B950                            		include	"_anim\Chopper.asm"
0088B950                            ; ---------------------------------------------------------------------------
0088B950                            ; Animation script - Chopper enemy
0088B950                            ; ---------------------------------------------------------------------------
0088B950 0000                       Ani_Chop:	dc.w @slow-Ani_Chop
0088B952 0000                       		dc.w @fast-Ani_Chop
0088B954 0000                       		dc.w @still-Ani_Chop
0088B956 0700 01FF                  @slow:		dc.b 7,	0, 1, afEnd
0088B95A 0300 01FF                  @fast:		dc.b 3,	0, 1, afEnd
0088B95E 0700 FF                    @still:		dc.b 7,	0, afEnd
0088B962 00                         		even
0088B962 00                         		even
0088B962                            		include	"_maps\Chopper.asm"
0088B962                            ; ---------------------------------------------------------------------------
0088B962                            ; Sprite mappings - Chopper enemy (GHZ)
0088B962                            ; ---------------------------------------------------------------------------
0088B962 0000                       Map_Chop:	dc.w @mouthshut-Map_Chop
0088B964 0000                       		dc.w @mouthopen-Map_Chop
0088B966 01                         @mouthshut:	dc.b 1
0088B967 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
0088B96C 01                         @mouthopen:	dc.b 1
0088B96D F00F 0010 F0               		dc.b $F0, $F, 0, $10, $F0
0088B972                            		even
0088B972                            		even
0088B972                            		include	"_incObj\2C Jaws.asm"
0088B972                            ; ---------------------------------------------------------------------------
0088B972                            ; Object 2C - Jaws enemy (LZ)
0088B972                            ; ---------------------------------------------------------------------------
0088B972                            
0088B972                            Jaws:					; XREF: Obj_Index
0088B972 7000                       		moveq	#0,d0
0088B974 1028 0024                  		move.b	obRoutine(a0),d0
0088B978 323B 0000                  		move.w	Jaws_Index(pc,d0.w),d1
0088B97C 4EFB 1000                  		jmp	Jaws_Index(pc,d1.w)
0088B980                            ; ===========================================================================
0088B980 0000                       Jaws_Index:	dc.w Jaws_Main-Jaws_Index
0088B982 0000                       		dc.w Jaws_Turn-Jaws_Index
0088B984                            
0088B984 =00000030                  timecount:	= $30
0088B984 =00000032                  timedelay:	= $32
0088B984                            ; ===========================================================================
0088B984                            
0088B984                            Jaws_Main:	; Routine 0
0088B984 5428 0024                  		addq.b	#2,obRoutine(a0)
0088B988 217C 0000 0000 0004        		move.l	#Map_Jaws,obMap(a0)
0088B990 317C 2486 0002             		move.w	#$2486,obGfx(a0)
0088B996 0028 0004 0001             		ori.b	#4,obRender(a0)
0088B99C 117C 000A 0020             		move.b	#$A,obColType(a0)
0088B9A2 117C 0004 0018             		move.b	#4,obPriority(a0)
0088B9A8 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088B9AE 7000                       		moveq	#0,d0
0088B9B0 1028 0028                  		move.b	obSubtype(a0),d0 ; load object subtype number
0088B9B4 ED48                       		lsl.w	#6,d0		; multiply d0 by 64
0088B9B6 5340                       		subq.w	#1,d0
0088B9B8 3140 0030                  		move.w	d0,timecount(a0) ; set turn delay time
0088B9BC 3140 0032                  		move.w	d0,timedelay(a0)
0088B9C0 317C FFC0 0010             		move.w	#-$40,obVelX(a0) ; move Jaws to the left
0088B9C6 0828 0000 0022             		btst	#0,obStatus(a0)	; is Jaws facing left?
0088B9CC 6700                       		beq.s	Jaws_Turn	; if yes, branch
0088B9CE 4468 0010                  		neg.w	obVelX(a0)	; move Jaws to the right
0088B9D2                            
0088B9D2                            Jaws_Turn:	; Routine 2
0088B9D2 5368 0030                  		subq.w	#1,timecount(a0) ; subtract 1 from turn delay time
0088B9D6 6A00                       		bpl.s	@animate	; if time remains, branch
0088B9D8 3168 0032 0030             		move.w	timedelay(a0),timecount(a0) ; reset turn delay time
0088B9DE 4468 0010                  		neg.w	obVelX(a0)	; change speed direction
0088B9E2 0868 0000 0022             		bchg	#0,obStatus(a0)	; change Jaws facing direction
0088B9E8 117C 0001 001D             		move.b	#1,obNextAni(a0) ; reset animation
0088B9EE                            
0088B9EE                            	@animate:
0088B9EE 43F9 0000 0000             		lea	(Ani_Jaws).l,a1
0088B9F4 6100 FABA                  		bsr.w	AnimateSprite
0088B9F8 6100 0000                  		bsr.w	ObjectMove
0088B9FC 6000 0000                  		bra.w	RememberState
0088B9FC 6000 0000                  		bra.w	RememberState
0088BA00                            		include	"_anim\Jaws.asm"
0088BA00                            ; ---------------------------------------------------------------------------
0088BA00                            ; Animation script - Jaws enemy
0088BA00                            ; ---------------------------------------------------------------------------
0088BA00 0000                       Ani_Jaws:	dc.w @swim-Ani_Jaws
0088BA02 0700 0102 03FF             @swim:		dc.b 7,	0, 1, 2, 3, afEnd
0088BA08                            		even
0088BA08                            		even
0088BA08                            		include	"_maps\Jaws.asm"
0088BA08                            ; ---------------------------------------------------------------------------
0088BA08                            ; Sprite mappings - Jaws enemy (LZ)
0088BA08                            ; ---------------------------------------------------------------------------
0088BA08 0000                       Map_Jaws:	dc.w @open1-Map_Jaws
0088BA0A 0000                       		dc.w @shut1-Map_Jaws
0088BA0C 0000                       		dc.w @open2-Map_Jaws
0088BA0E 0000                       		dc.w @shut2-Map_Jaws
0088BA10 02                         @open1:		dc.b 2
0088BA11 F40E 0000 F0               		dc.b $F4, $E, 0, 0, $F0	; mouth open
0088BA16 F505 0018 10               		dc.b $F5, 5, 0,	$18, $10
0088BA1B 02                         @shut1:		dc.b 2
0088BA1C F40E 000C F0               		dc.b $F4, $E, 0, $C, $F0 ; mouth shut
0088BA21 F505 001C 10               		dc.b $F5, 5, 0,	$1C, $10
0088BA26 02                         @open2:		dc.b 2
0088BA27 F40E 0000 F0               		dc.b $F4, $E, 0, 0, $F0
0088BA2C F505 1018 10               		dc.b $F5, 5, $10, $18, $10
0088BA31 02                         @shut2:		dc.b 2
0088BA32 F40E 000C F0               		dc.b $F4, $E, 0, $C, $F0
0088BA37 F505 101C 10               		dc.b $F5, 5, $10, $1C, $10
0088BA3C                            		even
0088BA3C                            		even
0088BA3C                            		include	"_incObj\2D Burrobot.asm"
0088BA3C                            ; ---------------------------------------------------------------------------
0088BA3C                            ; Object 2D - Burrobot enemy (LZ)
0088BA3C                            ; ---------------------------------------------------------------------------
0088BA3C                            
0088BA3C                            Burrobot:				; XREF: Obj_Index
0088BA3C 7000                       		moveq	#0,d0
0088BA3E 1028 0024                  		move.b	obRoutine(a0),d0
0088BA42 323B 0000                  		move.w	Burro_Index(pc,d0.w),d1
0088BA46 4EFB 1000                  		jmp	Burro_Index(pc,d1.w)
0088BA4A                            ; ===========================================================================
0088BA4A 0000                       Burro_Index:	dc.w Burro_Main-Burro_Index
0088BA4C 0000                       		dc.w Burro_Action-Burro_Index
0088BA4E                            
0088BA4E =00000030                  timedelay:	= $30		; time between direction changes
0088BA4E                            ; ===========================================================================
0088BA4E                            
0088BA4E                            Burro_Main:	; Routine 0
0088BA4E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088BA52 117C 0013 0016             		move.b	#$13,obHeight(a0)
0088BA58 117C 0008 0017             		move.b	#8,obWidth(a0)
0088BA5E 217C 0000 0000 0004        		move.l	#Map_Burro,obMap(a0)
0088BA66 317C 04A6 0002             		move.w	#$4A6,obGfx(a0)
0088BA6C 0028 0004 0001             		ori.b	#4,obRender(a0)
0088BA72 117C 0004 0018             		move.b	#4,obPriority(a0)
0088BA78 117C 0005 0020             		move.b	#5,obColType(a0)
0088BA7E 117C 000C 0019             		move.b	#$C,obActWid(a0)
0088BA84 5C28 0025                  		addq.b	#6,ob2ndRout(a0) ; run "Burro_ChkSonic" routine
0088BA88 117C 0002 001C             		move.b	#2,obAnim(a0)
0088BA8E                            
0088BA8E                            Burro_Action:	; Routine 2
0088BA8E 7000                       		moveq	#0,d0
0088BA90 1028 0025                  		move.b	ob2ndRout(a0),d0
0088BA94 323B 0000                  		move.w	@index(pc,d0.w),d1
0088BA98 4EBB 1000                  		jsr	@index(pc,d1.w)
0088BA9C 43F9 0000 0000             		lea	(Ani_Burro).l,a1
0088BAA2 6100 FA0C                  		bsr.w	AnimateSprite
0088BAA6 6000 0000                  		bra.w	RememberState
0088BAAA                            ; ===========================================================================
0088BAAA 0000                       @index:		dc.w @changedir-@index
0088BAAC 0000                       		dc.w Burro_Move-@index
0088BAAE 0000                       		dc.w Burro_Jump-@index
0088BAB0 0000                       		dc.w Burro_ChkSonic-@index
0088BAB2                            ; ===========================================================================
0088BAB2                            
0088BAB2                            @changedir:				; XREF: @index
0088BAB2 5368 0030                  		subq.w	#1,timedelay(a0)
0088BAB6 6A00                       		bpl.s	@nochg
0088BAB8 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088BABC 317C 00FF 0030             		move.w	#255,timedelay(a0)
0088BAC2 317C 0080 0010             		move.w	#$80,obVelX(a0)
0088BAC8 117C 0001 001C             		move.b	#1,obAnim(a0)
0088BACE 0868 0000 0022             		bchg	#0,obStatus(a0)	; change direction the Burrobot	is facing
0088BAD4 6700                       		beq.s	@nochg
0088BAD6 4468 0010                  		neg.w	obVelX(a0)	; change direction the Burrobot	is moving
0088BADA                            
0088BADA                            	@nochg:
0088BADA 4E75                       		rts	
0088BADC                            ; ===========================================================================
0088BADC                            
0088BADC                            Burro_Move:				; XREF: @index
0088BADC 5368 0030                  		subq.w	#1,timedelay(a0)
0088BAE0 6B00                       		bmi.s	loc_AD84
0088BAE2 6100 0000                  		bsr.w	ObjectMove
0088BAE6 0868 0000 0032             		bchg	#0,$32(a0)
0088BAEC 6600                       		bne.s	loc_AD78
0088BAEE 3628 0008                  		move.w	obX(a0),d3
0088BAF2 0643 000C                  		addi.w	#$C,d3
0088BAF6 0828 0000 0022             		btst	#0,obStatus(a0)
0088BAFC 6600                       		bne.s	loc_AD6A
0088BAFE 0443 0018                  		subi.w	#$18,d3
0088BB02                            
0088BB02                            loc_AD6A:
0088BB02 4EB9 0000 0000             		jsr	ObjFloorDist2
0088BB08 0C41 000C                  		cmpi.w	#$C,d1
0088BB0C 6C00                       		bge.s	loc_AD84
0088BB0E 4E75                       		rts	
0088BB10                            ; ===========================================================================
0088BB10                            
0088BB10                            loc_AD78:				; XREF: Burro_Move
0088BB10 4EB9 0000 0000             		jsr	ObjFloorDist
0088BB16 D368 000C                  		add.w	d1,obY(a0)
0088BB1A 4E75                       		rts	
0088BB1C                            ; ===========================================================================
0088BB1C                            
0088BB1C                            loc_AD84:				; XREF: Burro_Move
0088BB1C 0838 0002 FE0F             		btst	#2,(v_vbla_byte).w
0088BB22 6700                       		beq.s	loc_ADA4
0088BB24 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088BB28 317C 003B 0030             		move.w	#59,timedelay(a0)
0088BB2E 317C 0000 0010             		move.w	#0,obVelX(a0)
0088BB34 117C 0000 001C             		move.b	#0,obAnim(a0)
0088BB3A 4E75                       		rts	
0088BB3C                            ; ===========================================================================
0088BB3C                            
0088BB3C                            loc_ADA4:
0088BB3C 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088BB40 317C FC00 0012             		move.w	#-$400,obVelY(a0)
0088BB46 117C 0002 001C             		move.b	#2,obAnim(a0)
0088BB4C 4E75                       		rts	
0088BB4E                            ; ===========================================================================
0088BB4E                            
0088BB4E                            Burro_Jump:				; XREF: @index
0088BB4E 6100 0000                  		bsr.w	ObjectMove
0088BB52 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0088BB58 6B00                       		bmi.s	locret_ADF0
0088BB5A 117C 0003 001C             		move.b	#3,obAnim(a0)
0088BB60 4EB9 0000 0000             		jsr	ObjFloorDist
0088BB66 4A41                       		tst.w	d1
0088BB68 6A00                       		bpl.s	locret_ADF0
0088BB6A D368 000C                  		add.w	d1,obY(a0)
0088BB6E 317C 0000 0012             		move.w	#0,obVelY(a0)
0088BB74 117C 0001 001C             		move.b	#1,obAnim(a0)
0088BB7A 317C 00FF 0030             		move.w	#255,timedelay(a0)
0088BB80 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088BB84 6100 0000                  		bsr.w	Burro_ChkSonic2
0088BB88                            
0088BB88                            locret_ADF0:
0088BB88 4E75                       		rts	
0088BB8A                            ; ===========================================================================
0088BB8A                            
0088BB8A                            Burro_ChkSonic:				; XREF: @index
0088BB8A 343C 0060                  		move.w	#$60,d2
0088BB8E 6100 0000                  		bsr.w	Burro_ChkSonic2
0088BB92 6400                       		bcc.s	locret_AE20
0088BB94 3038 D00C                  		move.w	(v_player+obY).w,d0
0088BB98 9068 000C                  		sub.w	obY(a0),d0
0088BB9C 6400                       		bcc.s	locret_AE20
0088BB9E 0C40 FF80                  		cmpi.w	#-$80,d0
0088BBA2 6500                       		bcs.s	locret_AE20
0088BBA4 4A78 FE08                  		tst.w	(v_debuguse).w
0088BBA8 6600                       		bne.s	locret_AE20
0088BBAA 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088BBAE 3141 0010                  		move.w	d1,obVelX(a0)
0088BBB2 317C FC00 0012             		move.w	#-$400,obVelY(a0)
0088BBB8                            
0088BBB8                            locret_AE20:
0088BBB8 4E75                       		rts	
0088BBBA                            
0088BBBA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088BBBA                            
0088BBBA                            
0088BBBA                            Burro_ChkSonic2:			; XREF: Burro_ChkSonic
0088BBBA 323C 0080                  		move.w	#$80,d1
0088BBBE 08E8 0000 0022             		bset	#0,obStatus(a0)
0088BBC4 3038 D008                  		move.w	(v_player+obX).w,d0
0088BBC8 9068 0008                  		sub.w	obX(a0),d0
0088BBCC 6400                       		bcc.s	loc_AE40
0088BBCE 4440                       		neg.w	d0
0088BBD0 4441                       		neg.w	d1
0088BBD2 08A8 0000 0022             		bclr	#0,obStatus(a0)
0088BBD8                            
0088BBD8                            loc_AE40:
0088BBD8 B042                       		cmp.w	d2,d0
0088BBDA 4E75                       		rts	
0088BBDC                            ; End of function Burro_ChkSonic2
0088BBDC                            ; End of function Burro_ChkSonic2
0088BBDC                            		include	"_anim\Burrobot.asm"
0088BBDC                            ; ---------------------------------------------------------------------------
0088BBDC                            ; Animation script - Burrobot enemy
0088BBDC                            ; ---------------------------------------------------------------------------
0088BBDC 0000                       Ani_Burro:	dc.w @walk1-Ani_Burro
0088BBDE 0000                       		dc.w @walk2-Ani_Burro
0088BBE0 0000                       		dc.w @digging-Ani_Burro
0088BBE2 0000                       		dc.w @fall-Ani_Burro
0088BBE4 0300 06FF                  @walk1:		dc.b 3,	0, 6, afEnd
0088BBE8 0300 01FF                  @walk2:		dc.b 3,	0, 1, afEnd
0088BBEC 0302 03FF                  @digging:	dc.b 3,	2, 3, afEnd
0088BBF0 0304 FF                    @fall:		dc.b 3,	4, afEnd
0088BBF4 00                         		even
0088BBF4 00                         		even
0088BBF4                            		include	"_maps\Burrobot.asm"
0088BBF4                            ; ---------------------------------------------------------------------------
0088BBF4                            ; Sprite mappings - Burrobot enemy (LZ)
0088BBF4                            ; ---------------------------------------------------------------------------
0088BBF4 0000                       Map_Burro:	dc.w @walk1-Map_Burro
0088BBF6 0000                       		dc.w @walk2-Map_Burro
0088BBF8 0000                       		dc.w @digging1-Map_Burro
0088BBFA 0000                       		dc.w @digging2-Map_Burro
0088BBFC 0000                       		dc.w @fall-Map_Burro
0088BBFE 0000                       		dc.w @facedown-Map_Burro
0088BC00 0000                       		dc.w @walk3-Map_Burro
0088BC02 02                         @walk1:		dc.b 2
0088BC03 EC0A 0000 F0               		dc.b $EC, $A, 0, 0, $F0	; walking
0088BC08 0409 0009 F4               		dc.b 4,	9, 0, 9, $F4
0088BC0D 02                         @walk2:		dc.b 2
0088BC0E EC0A 000F F0               		dc.b $EC, $A, 0, $F, $F0
0088BC13 0409 0018 F4               		dc.b 4,	9, 0, $18, $F4
0088BC18 02                         @digging1:	dc.b 2
0088BC19 E80A 001E F4               		dc.b $E8, $A, 0, $1E, $F4 ; digging
0088BC1E 000A 0027 F4               		dc.b 0,	$A, 0, $27, $F4
0088BC23 02                         @digging2:	dc.b 2
0088BC24 E80A 0030 F4               		dc.b $E8, $A, 0, $30, $F4
0088BC29 000A 0039 F4               		dc.b 0,	$A, 0, $39, $F4
0088BC2E 02                         @fall:		dc.b 2
0088BC2F E80A 000F F0               		dc.b $E8, $A, 0, $F, $F0 ; falling after jumping up
0088BC34 000A 0042 F4               		dc.b 0,	$A, 0, $42, $F4
0088BC39 02                         @facedown:	dc.b 2
0088BC3A F406 004B E8               		dc.b $F4, 6, 0,	$4B, $E8 ; facing down (unused)
0088BC3F F40A 0051 F8               		dc.b $F4, $A, 0, $51, $F8
0088BC44 02                         @walk3:		dc.b 2
0088BC45 EC0A 000F F0               		dc.b $EC, $A, 0, $F, $F0
0088BC4A 0409 0009 F4               		dc.b 4,	9, 0, 9, $F4
0088BC50 00                         		even
0088BC50 00                         		even
0088BC50                            
0088BC50                            		include	"_incObj\2F MZ Large Grassy Platforms.asm"
0088BC50                            ; ---------------------------------------------------------------------------
0088BC50                            ; Object 2F - large grass-covered platforms (MZ)
0088BC50                            ; ---------------------------------------------------------------------------
0088BC50                            
0088BC50                            LargeGrass:				; XREF: Obj_Index
0088BC50 7000                       		moveq	#0,d0
0088BC52 1028 0024                  		move.b	obRoutine(a0),d0
0088BC56 323B 0000                  		move.w	LGrass_Index(pc,d0.w),d1
0088BC5A 4EFB 1000                  		jmp	LGrass_Index(pc,d1.w)
0088BC5E                            ; ===========================================================================
0088BC5E 0000                       LGrass_Index:	dc.w LGrass_Main-LGrass_Index
0088BC60 0000                       		dc.w LGrass_Action-LGrass_Index
0088BC62                            
0088BC62 =0000002A                  origX:		= $2A
0088BC62 =0000002C                  origY:		= $2C
0088BC62                            
0088BC62 0000                       LGrass_Data:	dc.w LGrass_Data1-LGrass_Data 	; collision angle data
0088BC64 0040                       		dc.b 0,	$40			; frame	number,	platform width
0088BC66 0000                       		dc.w LGrass_Data3-LGrass_Data
0088BC68 0140                       		dc.b 1,	$40
0088BC6A 0000                       		dc.w LGrass_Data2-LGrass_Data
0088BC6C 0220                       		dc.b 2,	$20
0088BC6E                            ; ===========================================================================
0088BC6E                            
0088BC6E                            LGrass_Main:	; Routine 0
0088BC6E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088BC72 217C 0000 0000 0004        		move.l	#Map_LGrass,obMap(a0)
0088BC7A 317C C000 0002             		move.w	#$C000,obGfx(a0)
0088BC80 117C 0004 0001             		move.b	#4,obRender(a0)
0088BC86 117C 0005 0018             		move.b	#5,obPriority(a0)
0088BC8C 3168 000C 002C             		move.w	obY(a0),origY(a0)
0088BC92 3168 0008 002A             		move.w	obX(a0),origX(a0)
0088BC98 7000                       		moveq	#0,d0
0088BC9A 1028 0028                  		move.b	obSubtype(a0),d0
0088BC9E E448                       		lsr.w	#2,d0
0088BCA0 0240 001C                  		andi.w	#$1C,d0
0088BCA4 43FB 00BC                  		lea	LGrass_Data(pc,d0.w),a1
0088BCA8 3019                       		move.w	(a1)+,d0
0088BCAA 45FB 00B6                  		lea	LGrass_Data(pc,d0.w),a2
0088BCAE 214A 0030                  		move.l	a2,$30(a0)
0088BCB2 1159 001A                  		move.b	(a1)+,obFrame(a0)
0088BCB6 1151 0019                  		move.b	(a1),obActWid(a0)
0088BCBA 0228 000F 0028             		andi.b	#$F,obSubtype(a0)
0088BCC0 117C 0040 0016             		move.b	#$40,obHeight(a0)
0088BCC6 08E8 0004 0001             		bset	#4,1(a0)
0088BCCC                            
0088BCCC                            LGrass_Action:	; Routine 2
0088BCCC 6100 0000                  		bsr.w	LGrass_Types
0088BCD0 4A28 0025                  		tst.b	ob2ndRout(a0)
0088BCD4 6700                       		beq.s	LGrass_Solid
0088BCD6 7200                       		moveq	#0,d1
0088BCD8 1228 0019                  		move.b	obActWid(a0),d1
0088BCDC 0641 000B                  		addi.w	#$B,d1
0088BCE0 6100 C512                  		bsr.w	ExitPlatform
0088BCE4 0829 0003 0022             		btst	#3,obStatus(a1)
0088BCEA 6600 0000                  		bne.w	LGrass_Slope
0088BCEE 4228 0025                  		clr.b	ob2ndRout(a0)
0088BCF2 6000                       		bra.s	LGrass_Display
0088BCF4                            ; ===========================================================================
0088BCF4                            
0088BCF4                            LGrass_Slope:				; XREF: LGrass_Action
0088BCF4 7200                       		moveq	#0,d1
0088BCF6 1228 0019                  		move.b	obActWid(a0),d1
0088BCFA 0641 000B                  		addi.w	#$B,d1
0088BCFE 2468 0030                  		movea.l	$30(a0),a2
0088BD02 3428 0008                  		move.w	obX(a0),d2
0088BD06 6100 D456                  		bsr.w	SlopeObject2
0088BD0A 6000                       		bra.s	LGrass_Display
0088BD0C                            ; ===========================================================================
0088BD0C                            
0088BD0C                            LGrass_Solid:				; XREF: LGrass_Action
0088BD0C 7200                       		moveq	#0,d1
0088BD0E 1228 0019                  		move.b	obActWid(a0),d1
0088BD12 0641 000B                  		addi.w	#$B,d1
0088BD16 343C 0020                  		move.w	#$20,d2
0088BD1A 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
0088BD20 6600                       		bne.s	loc_AF8E
0088BD22 343C 0030                  		move.w	#$30,d2
0088BD26                            
0088BD26                            loc_AF8E:
0088BD26 2468 0030                  		movea.l	$30(a0),a2
0088BD2A 6100 0000                  		bsr.w	SolidObject2F
0088BD2E                            
0088BD2E                            LGrass_Display:				; XREF: LGrass_Action
0088BD2E 6100 0000                  		bsr.w	DisplaySprite
0088BD32 6000 0000                  		bra.w	LGrass_ChkDel
0088BD36                            
0088BD36                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088BD36                            
0088BD36                            
0088BD36                            LGrass_Types:				; XREF: LGrass_Action
0088BD36 7000                       		moveq	#0,d0
0088BD38 1028 0028                  		move.b	obSubtype(a0),d0
0088BD3C 0240 0007                  		andi.w	#7,d0
0088BD40 D040                       		add.w	d0,d0
0088BD42 323B 0000                  		move.w	LGrass_TypeIndex(pc,d0.w),d1
0088BD46 4EFB 1000                  		jmp	LGrass_TypeIndex(pc,d1.w)
0088BD4A                            ; End of function LGrass_Types
0088BD4A                            
0088BD4A                            ; ===========================================================================
0088BD4A 0000                       LGrass_TypeIndex:dc.w LGrass_Type00-LGrass_TypeIndex
0088BD4C 0000                       		dc.w LGrass_Type01-LGrass_TypeIndex
0088BD4E 0000                       		dc.w LGrass_Type02-LGrass_TypeIndex
0088BD50 0000                       		dc.w LGrass_Type03-LGrass_TypeIndex
0088BD52 0000                       		dc.w LGrass_Type04-LGrass_TypeIndex
0088BD54 0000                       		dc.w LGrass_Type05-LGrass_TypeIndex
0088BD56                            ; ===========================================================================
0088BD56                            
0088BD56                            LGrass_Type00:				; XREF: LGrass_TypeIndex
0088BD56 4E75                       		rts			; type 00 platform doesn't move
0088BD58                            ; ===========================================================================
0088BD58                            
0088BD58                            LGrass_Type01:				; XREF: LGrass_TypeIndex
0088BD58 1038 FE60                  		move.b	(v_oscillate+2).w,d0
0088BD5C 323C 0020                  		move.w	#$20,d1
0088BD60 6000                       		bra.s	LGrass_Move
0088BD62                            ; ===========================================================================
0088BD62                            
0088BD62                            LGrass_Type02:				; XREF: LGrass_TypeIndex
0088BD62 1038 FE64                  		move.b	(v_oscillate+6).w,d0
0088BD66 323C 0030                  		move.w	#$30,d1
0088BD6A 6000                       		bra.s	LGrass_Move
0088BD6C                            ; ===========================================================================
0088BD6C                            
0088BD6C                            LGrass_Type03:				; XREF: LGrass_TypeIndex
0088BD6C 1038 FE68                  		move.b	(v_oscillate+$A).w,d0
0088BD70 323C 0040                  		move.w	#$40,d1
0088BD74 6000                       		bra.s	LGrass_Move
0088BD76                            ; ===========================================================================
0088BD76                            
0088BD76                            LGrass_Type04:				; XREF: LGrass_TypeIndex
0088BD76 1038 FE6C                  		move.b	(v_oscillate+$E).w,d0
0088BD7A 323C 0060                  		move.w	#$60,d1
0088BD7E                            
0088BD7E                            LGrass_Move:
0088BD7E 0828 0003 0028             		btst	#3,obSubtype(a0)
0088BD84 6700                       		beq.s	loc_AFF2
0088BD86 4440                       		neg.w	d0
0088BD88 D041                       		add.w	d1,d0
0088BD8A                            
0088BD8A                            loc_AFF2:
0088BD8A 3228 002C                  		move.w	origY(a0),d1
0088BD8E 9240                       		sub.w	d0,d1
0088BD90 3141 000C                  		move.w	d1,obY(a0)	; update position on y-axis
0088BD94 4E75                       		rts	
0088BD96                            ; ===========================================================================
0088BD96                            
0088BD96                            LGrass_Type05:				; XREF: LGrass_TypeIndex
0088BD96 1028 0034                  		move.b	$34(a0),d0
0088BD9A 4A28 0025                  		tst.b	ob2ndRout(a0)
0088BD9E 6600                       		bne.s	loc_B010
0088BDA0 5500                       		subq.b	#2,d0
0088BDA2 6400                       		bcc.s	loc_B01C
0088BDA4 7000                       		moveq	#0,d0
0088BDA6 6000                       		bra.s	loc_B01C
0088BDA8                            ; ===========================================================================
0088BDA8                            
0088BDA8                            loc_B010:
0088BDA8 5800                       		addq.b	#4,d0
0088BDAA 0C00 0040                  		cmpi.b	#$40,d0
0088BDAE 6500                       		bcs.s	loc_B01C
0088BDB0 103C 0040                  		move.b	#$40,d0
0088BDB4                            
0088BDB4                            loc_B01C:
0088BDB4 1140 0034                  		move.b	d0,$34(a0)
0088BDB8 4EB9 0088 301C             		jsr	(CalcSine).l
0088BDBE E848                       		lsr.w	#4,d0
0088BDC0 3200                       		move.w	d0,d1
0088BDC2 D068 002C                  		add.w	origY(a0),d0
0088BDC6 3140 000C                  		move.w	d0,obY(a0)
0088BDCA 0C28 0020 0034             		cmpi.b	#$20,$34(a0)
0088BDD0 6600                       		bne.s	loc_B07A
0088BDD2 4A28 0035                  		tst.b	$35(a0)
0088BDD6 6600                       		bne.s	loc_B07A
0088BDD8 117C 0001 0035             		move.b	#1,$35(a0)
0088BDDE 6100 0000                  		bsr.w	FindNextFreeObj
0088BDE2 6600                       		bne.s	loc_B07A
0088BDE4 137C 0000 0000             		move.b	#id_GrassFire,0(a1) ; load sitting flame object
0088BDEA 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088BDF0 3368 002C 002C             		move.w	origY(a0),origY(a1)
0088BDF6 5069 002C                  		addq.w	#8,origY(a1)
0088BDFA 5769 002C                  		subq.w	#3,origY(a1)
0088BDFE 0469 0040 0008             		subi.w	#$40,obX(a1)
0088BE04 2368 0030 0030             		move.l	$30(a0),$30(a1)
0088BE0A 2348 0038                  		move.l	a0,$38(a1)
0088BE0E 2448                       		movea.l	a0,a2
0088BE10 6100                       		bsr.s	sub_B09C
0088BE12                            
0088BE12                            loc_B07A:
0088BE12 7400                       		moveq	#0,d2
0088BE14 45E8 0036                  		lea	$36(a0),a2
0088BE18 141A                       		move.b	(a2)+,d2
0088BE1A 5302                       		subq.b	#1,d2
0088BE1C 6500                       		bcs.s	locret_B09A
0088BE1E                            
0088BE1E                            loc_B086:
0088BE1E 7000                       		moveq	#0,d0
0088BE20 101A                       		move.b	(a2)+,d0
0088BE22 ED48                       		lsl.w	#6,d0
0088BE24 0640 D000                  		addi.w	#$D000,d0
0088BE28 3240                       		movea.w	d0,a1
0088BE2A 3341 003C                  		move.w	d1,$3C(a1)
0088BE2E 51CA FFEE                  		dbf	d2,loc_B086
0088BE32                            
0088BE32                            locret_B09A:
0088BE32 4E75                       		rts	
0088BE34                            
0088BE34                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088BE34                            
0088BE34                            
0088BE34                            sub_B09C:
0088BE34 45EA 0036                  		lea	$36(a2),a2
0088BE38 7000                       		moveq	#0,d0
0088BE3A 1012                       		move.b	(a2),d0
0088BE3C 5212                       		addq.b	#1,(a2)
0088BE3E 45F2 0001                  		lea	1(a2,d0.w),a2
0088BE42 3009                       		move.w	a1,d0
0088BE44 0440 D000                  		subi.w	#$D000,d0
0088BE48 EC48                       		lsr.w	#6,d0
0088BE4A 0240 007F                  		andi.w	#$7F,d0
0088BE4E 1480                       		move.b	d0,(a2)
0088BE50 4E75                       		rts	
0088BE52                            ; End of function sub_B09C
0088BE52                            
0088BE52                            ; ===========================================================================
0088BE52                            
0088BE52                            LGrass_ChkDel:				; XREF: LGrass_Display
0088BE52 4A28 0035                  		tst.b	$35(a0)
0088BE56 6700                       		beq.s	loc_B0C6
0088BE58 4A28 0001                  		tst.b	obRender(a0)
0088BE5C 6A00                       		bpl.s	LGrass_DelFlames
0088BE5E                            
0088BE5E                            loc_B0C6:
0088BE7C 4E75                       		rts	
0088BE7E                            ; ===========================================================================
0088BE7E                            
0088BE7E                            LGrass_DelFlames:			; XREF: LGrass_ChkDel
0088BE7E 7400                       		moveq	#0,d2
0088BE80                            
0088BE80                            loc_B0E8:
0088BE80 45E8 0036                  		lea	$36(a0),a2
0088BE84 1412                       		move.b	(a2),d2
0088BE86 421A                       		clr.b	(a2)+
0088BE88 5302                       		subq.b	#1,d2
0088BE8A 6500                       		bcs.s	locret_B116
0088BE8C                            
0088BE8C                            loc_B0F4:
0088BE8C 7000                       		moveq	#0,d0
0088BE8E 1012                       		move.b	(a2),d0
0088BE90 421A                       		clr.b	(a2)+
0088BE92 ED48                       		lsl.w	#6,d0
0088BE94 0640 D000                  		addi.w	#$D000,d0
0088BE98 3240                       		movea.w	d0,a1
0088BE9A 6100 0000                  		bsr.w	DeleteChild
0088BE9E 51CA FFEC                  		dbf	d2,loc_B0F4
0088BEA2 117C 0000 0035             		move.b	#0,$35(a0)
0088BEA8 117C 0000 0034             		move.b	#0,$34(a0)
0088BEAE                            
0088BEAE                            locret_B116:
0088BEAE 4E75                       		rts	
0088BEB0                            ; ===========================================================================
0088BEB0                            ; ---------------------------------------------------------------------------
0088BEB0                            ; Collision data for large moving platforms (MZ)
0088BEB0                            ; ---------------------------------------------------------------------------
0088BEB0                            LGrass_Data1:	incbin	misc\mz_pfm1.bin
0088BEFC                            		even
0088BEFC                            LGrass_Data2:	incbin	misc\mz_pfm2.bin
0088BF28                            		even
0088BF28                            LGrass_Data3:	incbin	misc\mz_pfm3.bin
0088BF74                            		even
0088BF74                            		even
0088BF74                            		include	"_incObj\35 Burning Grass.asm"
0088BF74                            ; ---------------------------------------------------------------------------
0088BF74                            ; Object 35 - fireball that sits on the	floor (MZ)
0088BF74                            ; (appears when	you walk on sinking platforms)
0088BF74                            ; ---------------------------------------------------------------------------
0088BF74                            
0088BF74                            GrassFire:				; XREF: Obj_Index
0088BF74 7000                       		moveq	#0,d0
0088BF76 1028 0024                  		move.b	obRoutine(a0),d0
0088BF7A 323B 0000                  		move.w	GFire_Index(pc,d0.w),d1
0088BF7E 4EFB 1000                  		jmp	GFire_Index(pc,d1.w)
0088BF82                            ; ===========================================================================
0088BF82 0000                       GFire_Index:	dc.w GFire_Main-GFire_Index
0088BF84 0000                       		dc.w loc_B238-GFire_Index
0088BF86 0000                       		dc.w GFire_Move-GFire_Index
0088BF88                            
0088BF88 =0000002A                  origX:		= $2A
0088BF88                            ; ===========================================================================
0088BF88                            
0088BF88                            GFire_Main:	; Routine 0
0088BF88 5428 0024                  		addq.b	#2,obRoutine(a0)
0088BF8C 217C 0000 0000 0004        		move.l	#Map_Fire,obMap(a0)
0088BF94 317C 0345 0002             		move.w	#$345,obGfx(a0)
0088BF9A 3168 0008 002A             		move.w	obX(a0),origX(a0)
0088BFA0 117C 0004 0001             		move.b	#4,obRender(a0)
0088BFA6 117C 0001 0018             		move.b	#1,obPriority(a0)
0088BFAC 117C 008B 0020             		move.b	#$8B,obColType(a0)
0088BFB2 117C 0008 0019             		move.b	#8,obActWid(a0)
0088BFC2 4A28 0028                  		tst.b	obSubtype(a0)
0088BFC6 6700                       		beq.s	loc_B238
0088BFC8 5428 0024                  		addq.b	#2,obRoutine(a0)
0088BFCC 6000 0000                  		bra.w	GFire_Move
0088BFD0                            ; ===========================================================================
0088BFD0                            
0088BFD0                            loc_B238:	; Routine 2
0088BFD0 2268 0030                  		movea.l	$30(a0),a1
0088BFD4 3228 0008                  		move.w	obX(a0),d1
0088BFD8 9268 002A                  		sub.w	origX(a0),d1
0088BFDC 0641 000C                  		addi.w	#$C,d1
0088BFE0 3001                       		move.w	d1,d0
0088BFE2 E248                       		lsr.w	#1,d0
0088BFE4 1031 0000                  		move.b	(a1,d0.w),d0
0088BFE8 4440                       		neg.w	d0
0088BFEA D068 002C                  		add.w	$2C(a0),d0
0088BFEE 3400                       		move.w	d0,d2
0088BFF0 D068 003C                  		add.w	$3C(a0),d0
0088BFF4 3140 000C                  		move.w	d0,obY(a0)
0088BFF8 0C41 0084                  		cmpi.w	#$84,d1
0088BFFC 6400                       		bcc.s	loc_B2B0
0088BFFE 06A8 0001 0000 0008        		addi.l	#$10000,obX(a0)
0088C006 0C41 0080                  		cmpi.w	#$80,d1
0088C00A 6400                       		bcc.s	loc_B2B0
0088C00C 2028 0008                  		move.l	obX(a0),d0
0088C010 0680 0008 0000             		addi.l	#$80000,d0
0088C016 0280 000F FFFF             		andi.l	#$FFFFF,d0
0088C01C 6600                       		bne.s	loc_B2B0
0088C01E 6100 0000                  		bsr.w	FindNextFreeObj
0088C022 6600                       		bne.s	loc_B2B0
0088C024 137C 0000 0000             		move.b	#id_GrassFire,0(a1)
0088C02A 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088C030 3342 002C                  		move.w	d2,$2C(a1)
0088C034 3368 003C 003C             		move.w	$3C(a0),$3C(a1)
0088C03A 137C 0001 0028             		move.b	#1,obSubtype(a1)
0088C040 2468 0038                  		movea.l	$38(a0),a2
0088C044 6100 FDEE                  		bsr.w	sub_B09C
0088C048                            
0088C048                            loc_B2B0:
0088C048 6000                       		bra.s	GFire_Animate
0088C04A                            ; ===========================================================================
0088C04A                            
0088C04A                            GFire_Move:	; Routine 4
0088C04A 3028 002C                  		move.w	$2C(a0),d0
0088C04E D068 003C                  		add.w	$3C(a0),d0
0088C052 3140 000C                  		move.w	d0,obY(a0)
0088C056                            
0088C056                            GFire_Animate:				; XREF: loc_B238
0088C056 43F9 0000 0000             		lea	(Ani_GFire).l,a1
0088C05C 6100 F452                  		bsr.w	AnimateSprite
0088C060 6000 0000                  		bra.w	DisplaySprite
0088C060 6000 0000                  		bra.w	DisplaySprite
0088C064                            		include	"_anim\Burning Grass.asm"
0088C064                            ; ---------------------------------------------------------------------------
0088C064                            ; Animation script - burning grass that sits on the floor (MZ)
0088C064                            ; ---------------------------------------------------------------------------
0088C064 0000                       Ani_GFire:	dc.w @burn-Ani_GFire
0088C066 0500 2001 21FF             @burn:		dc.b 5,	0, $20,	1, $21,	afEnd
0088C06C                            		even
0088C06C                            		even
0088C06C                            		include	"_maps\MZ Large Grassy Platforms.asm"
0088C06C                            ; ---------------------------------------------------------------------------
0088C06C                            ; Sprite mappings - large moving grass-covered platforms (MZ)
0088C06C                            ; ---------------------------------------------------------------------------
0088C06C 0000                       Map_LGrass:	dc.w @wide-Map_LGrass
0088C06E 0000                       		dc.w @sloped-Map_LGrass
0088C070 0000                       		dc.w @narrow-Map_LGrass
0088C072 0D                         @wide:		dc.b $D
0088C073 D806 0057 C0               		dc.b $D8, 6, 0,	$57, $C0 ; wide platform
0088C078 F005 0053 C0               		dc.b $F0, 5, 0,	$53, $C0
0088C07D 000F 0001 C0               		dc.b 0,	$F, 0, 1, $C0
0088C082 D00F 0027 D0               		dc.b $D0, $F, 0, $27, $D0
0088C087 F00D 0037 D0               		dc.b $F0, $D, 0, $37, $D0
0088C08C F00F 0001 E0               		dc.b $F0, $F, 0, 1, $E0
0088C091 D00F 0011 F0               		dc.b $D0, $F, 0, $11, $F0
0088C096 D00F 003F 10               		dc.b $D0, $F, 0, $3F, $10
0088C09B F00D 004F 10               		dc.b $F0, $D, 0, $4F, $10
0088C0A0 F00F 0001 00               		dc.b $F0, $F, 0, 1, 0
0088C0A5 000F 0001 20               		dc.b 0,	$F, 0, 1, $20
0088C0AA D806 0057 30               		dc.b $D8, 6, 0,	$57, $30
0088C0AF F005 0053 30               		dc.b $F0, 5, 0,	$53, $30
0088C0B4 0A                         @sloped:	dc.b $A
0088C0B5 D00F 0027 C0               		dc.b $D0, $F, 0, $27, $C0 ; sloped platform (catches fire)
0088C0BA F00D 0037 C0               		dc.b $F0, $D, 0, $37, $C0
0088C0BF 000F 0001 C0               		dc.b 0,	$F, 0, 1, $C0
0088C0C4 C00F 0027 E0               		dc.b $C0, $F, 0, $27, $E0
0088C0C9 E00D 0037 E0               		dc.b $E0, $D, 0, $37, $E0
0088C0CE F00F 0001 E0               		dc.b $F0, $F, 0, 1, $E0
0088C0D3 C00F 0011 00               		dc.b $C0, $F, 0, $11, 0
0088C0D8 E00F 0001 00               		dc.b $E0, $F, 0, 1, 0
0088C0DD C00F 003F 20               		dc.b $C0, $F, 0, $3F, $20
0088C0E2 E00D 004F 20               		dc.b $E0, $D, 0, $4F, $20
0088C0E7 06                         @narrow:	dc.b 6
0088C0E8 D00F 0011 E0               		dc.b $D0, $F, 0, $11, $E0 ; narrow platform
0088C0ED F00F 0001 E0               		dc.b $F0, $F, 0, 1, $E0
0088C0F2 100F 0001 E0               		dc.b $10, $F, 0, 1, $E0
0088C0F7 D00F 0011 00               		dc.b $D0, $F, 0, $11, 0
0088C0FC F00F 0001 00               		dc.b $F0, $F, 0, 1, 0
0088C101 100F 0001 00               		dc.b $10, $F, 0, 1, 0
0088C106                            		even
0088C106                            		even
0088C106                            		include	"_maps\Fireballs.asm"
0088C106                            ; ---------------------------------------------------------------------------
0088C106                            ; Sprite mappings - fire balls (MZ, SLZ)
0088C106                            ; ---------------------------------------------------------------------------
0088C106 0000                       Map_Fire:	dc.w @vertical1-Map_Fire
0088C108 0000                       		dc.w @vertical2-Map_Fire
0088C10A 0000                       		dc.w @vertcollide-Map_Fire
0088C10C 0000                       		dc.w @horizontal1-Map_Fire
0088C10E 0000                       		dc.w @horizontal2-Map_Fire
0088C110 0000                       		dc.w @horicollide-Map_Fire
0088C112 01                         @vertical1:	dc.b 1
0088C113 E807 0000 F8               		dc.b $E8, 7, 0,	0, $F8
0088C118 01                         @vertical2:	dc.b 1
0088C119 E807 0008 F8               		dc.b $E8, 7, 0,	8, $F8
0088C11E 01                         @vertcollide:	dc.b 1
0088C11F F006 0010 F8               		dc.b $F0, 6, 0,	$10, $F8
0088C124 01                         @horizontal1:	dc.b 1
0088C125 F80D 0016 E8               		dc.b $F8, $D, 0, $16, $E8
0088C12A 01                         @horizontal2:	dc.b 1
0088C12B F80D 001E E8               		dc.b $F8, $D, 0, $1E, $E8
0088C130 01                         @horicollide:	dc.b 1
0088C131 F809 0026 F0               		dc.b $F8, 9, 0,	$26, $F0
0088C136                            		even
0088C136                            		even
0088C136                            		include	"_incObj\30 MZ Large Green Glass Blocks.asm"
0088C136                            ; ---------------------------------------------------------------------------
0088C136                            ; Object 30 - large green glass blocks (MZ)
0088C136                            ; ---------------------------------------------------------------------------
0088C136                            
0088C136                            GlassBlock:				; XREF: Obj_Index
0088C136 7000                       		moveq	#0,d0
0088C138 1028 0024                  		move.b	obRoutine(a0),d0
0088C13C 323B 0000                  		move.w	Glass_Index(pc,d0.w),d1
0088C140 4EBB 1000                  		jsr	Glass_Index(pc,d1.w)
0088C162 6000 0000                  		bra.w	DisplaySprite
0088C166                            ; ===========================================================================
0088C166                            
0088C166                            Glass_Delete:
0088C166 6000 0000                  		bra.w	DeleteObject
0088C16A                            ; ===========================================================================
0088C16A 0000                       Glass_Index:	dc.w Glass_Main-Glass_Index
0088C16C 0000                       		dc.w Glass_Block012-Glass_Index
0088C16E 0000                       		dc.w Glass_Reflect012-Glass_Index
0088C170 0000                       		dc.w Glass_Block34-Glass_Index
0088C172 0000                       		dc.w Glass_Reflect34-Glass_Index
0088C174                            
0088C174 =00000032                  glass_dist:	= $32		; distance block moves when switch is pressed
0088C174 =0000003C                  glass_parent:	= $3C		; address of parent object
0088C174                            
0088C174 0200 00                    Glass_Vars1:	dc.b 2,	0, 0	; routine num, y-axis dist from	origin,	frame num
0088C177 0400 01                    		dc.b 4,	0, 1
0088C17A 0600 02                    Glass_Vars2:	dc.b 6,	0, 2
0088C17D 0800 01                    		dc.b 8,	0, 1
0088C180                            ; ===========================================================================
0088C180                            
0088C180                            Glass_Main:	; Routine 0
0088C180 45F9 0088 C174             		lea	(Glass_Vars1).l,a2
0088C186 7201                       		moveq	#1,d1
0088C188 117C 0048 0016             		move.b	#$48,obHeight(a0)
0088C18E 0C28 0003 0028             		cmpi.b	#3,obSubtype(a0) ; is object type 0/1/2 ?
0088C194 6500                       		bcs.s	@IsType012	; if yes, branch
0088C196                            
0088C196 45F9 0088 C17A             		lea	(Glass_Vars2).l,a2
0088C19C 7201                       		moveq	#1,d1
0088C19E 117C 0038 0016             		move.b	#$38,obHeight(a0)
0088C1A4                            
0088C1A4                            	@IsType012:
0088C1A4 2248                       		movea.l	a0,a1
0088C1A6 6000                       		bra.s	@Load		; load main object
0088C1A8                            ; ===========================================================================
0088C1A8                            
0088C1A8                            	@Repeat:
0088C1A8 6100 0000                  		bsr.w	FindNextFreeObj
0088C1AC 6600                       		bne.s	@Fail
0088C1AE                            
0088C1AE                            @Load:
0088C1AE 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088C1B2 137C 0000 0000             		move.b	#id_GlassBlock,0(a1)
0088C1B8 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088C1BE 101A                       		move.b	(a2)+,d0
0088C1C0 4880                       		ext.w	d0
0088C1C2 D068 000C                  		add.w	obY(a0),d0
0088C1C6 3340 000C                  		move.w	d0,obY(a1)
0088C1CA 237C 0000 0000 0004        		move.l	#Map_Glass,obMap(a1)
0088C1D2 337C C38E 0002             		move.w	#$C38E,obGfx(a1)
0088C1D8 137C 0004 0001             		move.b	#4,obRender(a1)
0088C1DE 3369 000C 0030             		move.w	obY(a1),$30(a1)
0088C1E4 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088C1EA 137C 0020 0019             		move.b	#$20,obActWid(a1)
0088C1F0 137C 0004 0018             		move.b	#4,obPriority(a1)
0088C1F6 135A 001A                  		move.b	(a2)+,obFrame(a1)
0088C1FA 2348 003C                  		move.l	a0,glass_parent(a1)
0088C1FE 51C9 FFA8                  		dbf	d1,@Repeat	; repeat once to load "reflection object"
0088C202                            
0088C202 137C 0010 0019             		move.b	#$10,obActWid(a1)
0088C208 137C 0003 0018             		move.b	#3,obPriority(a1)
0088C20E 5029 0028                  		addq.b	#8,obSubtype(a1)
0088C212 0229 000F 0028             		andi.b	#$F,obSubtype(a1)
0088C218                            
0088C218                            	@Fail:
0088C218 317C 0090 0032             		move.w	#$90,glass_dist(a0)
0088C21E 08E8 0004 0001             		bset	#4,obRender(a0)
0088C224                            
0088C224                            Glass_Block012:	; Routine 2
0088C224 6100 0000                  		bsr.w	Glass_Types
0088C228 323C 002B                  		move.w	#$2B,d1
0088C22C 343C 0048                  		move.w	#$48,d2
0088C230 363C 0049                  		move.w	#$49,d3
0088C234 3828 0008                  		move.w	obX(a0),d4
0088C238 6000 0000                  		bra.w	SolidObject
0088C23C                            ; ===========================================================================
0088C23C                            
0088C23C                            Glass_Reflect012:
0088C23C                            		; Routine 4
0088C23C 2268 003C                  		movea.l	$3C(a0),a1
0088C240 3169 0032 0032             		move.w	glass_dist(a1),glass_dist(a0)
0088C246 6000 0000                  		bra.w	Glass_Types
0088C24A                            ; ===========================================================================
0088C24A                            
0088C24A                            Glass_Block34:	; Routine 6
0088C24A 6100 0000                  		bsr.w	Glass_Types
0088C24E 323C 002B                  		move.w	#$2B,d1
0088C252 343C 0038                  		move.w	#$38,d2
0088C256 363C 0039                  		move.w	#$39,d3
0088C25A 3828 0008                  		move.w	obX(a0),d4
0088C25E 6000 0000                  		bra.w	SolidObject
0088C262                            ; ===========================================================================
0088C262                            
0088C262                            Glass_Reflect34:
0088C262                            		; Routine 8
0088C262 2268 003C                  		movea.l	$3C(a0),a1
0088C266 3169 0032 0032             		move.w	glass_dist(a1),glass_dist(a0)
0088C26C 3169 000C 0030             		move.w	obY(a1),$30(a0)
0088C272 6000 0002                  		bra.w	*+4
0088C276                            
0088C276                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088C276                            
0088C276                            
0088C276                            Glass_Types:				; XREF: Glass_Block012; et al
0088C276 7000                       		moveq	#0,d0
0088C278 1028 0028                  		move.b	obSubtype(a0),d0
0088C27C 0240 0007                  		andi.w	#7,d0
0088C280 D040                       		add.w	d0,d0
0088C282 323B 0000                  		move.w	Glass_TypeIndex(pc,d0.w),d1
0088C286 4EFB 1000                  		jmp	Glass_TypeIndex(pc,d1.w)
0088C28A                            ; End of function Glass_Types
0088C28A                            
0088C28A                            ; ===========================================================================
0088C28A 0000                       Glass_TypeIndex:dc.w Glass_Type00-Glass_TypeIndex
0088C28C 0000                       		dc.w Glass_Type01-Glass_TypeIndex
0088C28E 0000                       		dc.w Glass_Type02-Glass_TypeIndex
0088C290 0000                       		dc.w Glass_Type03-Glass_TypeIndex
0088C292 0000                       		dc.w Glass_Type04-Glass_TypeIndex
0088C294                            ; ===========================================================================
0088C294                            
0088C294                            Glass_Type00:				; XREF: Glass_TypeIndex
0088C294 4E75                       		rts	
0088C296                            ; ===========================================================================
0088C296                            
0088C296                            Glass_Type01:				; XREF: Glass_TypeIndex
0088C296 1038 FE70                  		move.b	(v_oscillate+$12).w,d0
0088C29A 323C 0040                  		move.w	#$40,d1
0088C29E 6000                       		bra.s	loc_B514
0088C2A0                            ; ===========================================================================
0088C2A0                            
0088C2A0                            Glass_Type02:				; XREF: Glass_TypeIndex
0088C2A0 1038 FE70                  		move.b	(v_oscillate+$12).w,d0
0088C2A4 323C 0040                  		move.w	#$40,d1
0088C2A8 4440                       		neg.w	d0
0088C2AA D041                       		add.w	d1,d0
0088C2AC                            
0088C2AC                            loc_B514:				; XREF: Glass_Type01
0088C2AC 0828 0003 0028             		btst	#3,obSubtype(a0)
0088C2B2 6700                       		beq.s	loc_B526
0088C2B4 4440                       		neg.w	d0
0088C2B6 D041                       		add.w	d1,d0
0088C2B8 E208                       		lsr.b	#1,d0
0088C2BA 0640 0020                  		addi.w	#$20,d0
0088C2BE                            
0088C2BE                            loc_B526:
0088C2BE 6000 0000                  		bra.w	loc_B5EE
0088C2C2                            ; ===========================================================================
0088C2C2                            
0088C2C2                            Glass_Type03:				; XREF: Glass_TypeIndex
0088C2C2 0828 0003 0028             		btst	#3,obSubtype(a0)
0088C2C8 6700                       		beq.s	loc_B53E
0088C2CA 1038 FE70                  		move.b	(v_oscillate+$12).w,d0
0088C2CE 0440 0010                  		subi.w	#$10,d0
0088C2D2 6000 0000                  		bra.w	loc_B5EE
0088C2D6                            ; ===========================================================================
0088C2D6                            
0088C2D6                            loc_B53E:
0088C2D6 0828 0003 0022             		btst	#3,obStatus(a0)
0088C2DC 6600                       		bne.s	loc_B54E
0088C2DE 08A8 0000 0034             		bclr	#0,$34(a0)
0088C2E4 6000                       		bra.s	loc_B582
0088C2E6                            ; ===========================================================================
0088C2E6                            
0088C2E6                            loc_B54E:
0088C2E6 4A28 0034                  		tst.b	$34(a0)
0088C2EA 6600                       		bne.s	loc_B582
0088C2EC 117C 0001 0034             		move.b	#1,$34(a0)
0088C2F2 08E8 0000 0035             		bset	#0,$35(a0)
0088C2F8 6700                       		beq.s	loc_B582
0088C2FA 08E8 0007 0034             		bset	#7,$34(a0)
0088C300 317C 0010 0036             		move.w	#$10,$36(a0)
0088C306 117C 000A 0038             		move.b	#$A,$38(a0)
0088C30C 0C68 0040 0032             		cmpi.w	#$40,glass_dist(a0)
0088C312 6600                       		bne.s	loc_B582
0088C314 317C 0040 0036             		move.w	#$40,$36(a0)
0088C31A                            
0088C31A                            loc_B582:
0088C31A 4A28 0034                  		tst.b	$34(a0)
0088C31E 6A00                       		bpl.s	loc_B5AA
0088C320 4A28 0038                  		tst.b	$38(a0)
0088C324 6700                       		beq.s	loc_B594
0088C326 5328 0038                  		subq.b	#1,$38(a0)
0088C32A 6600                       		bne.s	loc_B5AA
0088C32C                            
0088C32C                            loc_B594:
0088C32C 4A68 0032                  		tst.w	glass_dist(a0)
0088C330 6700                       		beq.s	loc_B5A4
0088C332 5368 0032                  		subq.w	#1,glass_dist(a0)
0088C336 5368 0036                  		subq.w	#1,$36(a0)
0088C33A 6600                       		bne.s	loc_B5AA
0088C33C                            
0088C33C                            loc_B5A4:
0088C33C 08A8 0007 0034             		bclr	#7,$34(a0)
0088C342                            
0088C342                            loc_B5AA:
0088C342 3028 0032                  		move.w	glass_dist(a0),d0
0088C346 6000                       		bra.s	loc_B5EE
0088C348                            ; ===========================================================================
0088C348                            
0088C348                            Glass_Type04:				; XREF: Glass_TypeIndex
0088C348 0828 0003 0028             		btst	#3,obSubtype(a0)
0088C34E 6700                       		beq.s	Glass_ChkSwitch
0088C350 1038 FE70                  		move.b	(v_oscillate+$12).w,d0
0088C354 0440 0010                  		subi.w	#$10,d0
0088C358 6000                       		bra.s	loc_B5EE
0088C35A                            ; ===========================================================================
0088C35A                            
0088C35A                            Glass_ChkSwitch:			; XREF: Glass_Type04
0088C35A 4A28 0034                  		tst.b	$34(a0)
0088C35E 6600                       		bne.s	loc_B5E0
0088C360 45F8 F7E0                  		lea	(f_switch).w,a2
0088C364 7000                       		moveq	#0,d0
0088C366 1028 0028                  		move.b	obSubtype(a0),d0 ; load object type number
0088C36A E848                       		lsr.w	#4,d0		; read only the	first nybble
0088C36C 4A32 0000                  		tst.b	(a2,d0.w)	; has switch number d0 been pressed?
0088C370 6700                       		beq.s	loc_B5EA	; if not, branch
0088C372 117C 0001 0034             		move.b	#1,$34(a0)
0088C378                            
0088C378                            loc_B5E0:
0088C378 4A68 0032                  		tst.w	glass_dist(a0)
0088C37C 6700                       		beq.s	loc_B5EA
0088C37E 5568 0032                  		subq.w	#2,glass_dist(a0)
0088C382                            
0088C382                            loc_B5EA:
0088C382 3028 0032                  		move.w	glass_dist(a0),d0
0088C386                            
0088C386                            loc_B5EE:
0088C386 3228 0030                  		move.w	$30(a0),d1
0088C38A 9240                       		sub.w	d0,d1
0088C38C 3141 000C                  		move.w	d1,obY(a0)
0088C390 4E75                       		rts	
0088C390 4E75                       		rts	
0088C392                            		include	"_maps\MZ Large Green Glass Blocks.asm"
0088C392                            ; ---------------------------------------------------------------------------
0088C392                            ; Sprite mappings - large green	glassy blocks (MZ)
0088C392                            ; ---------------------------------------------------------------------------
0088C392 0000                       Map_Glass:	dc.w @tall-Map_Glass
0088C394 0000                       		dc.w @shine-Map_Glass
0088C396 0000                       		dc.w @short-Map_Glass
0088C398 0C                         @tall:		dc.b $C
0088C399 B80C 0000 E0               		dc.b $B8, $C, 0, 0, $E0	; tall block
0088C39E B80C 0800 00               		dc.b $B8, $C, 8, 0, 0
0088C3A3 C00F 0004 E0               		dc.b $C0, $F, 0, 4, $E0
0088C3A8 C00F 0804 00               		dc.b $C0, $F, 8, 4, 0
0088C3AD E00F 0004 E0               		dc.b $E0, $F, 0, 4, $E0
0088C3B2 E00F 0804 00               		dc.b $E0, $F, 8, 4, 0
0088C3B7 000F 0004 E0               		dc.b 0,	$F, 0, 4, $E0
0088C3BC 000F 0804 00               		dc.b 0,	$F, 8, 4, 0
0088C3C1 200F 0004 E0               		dc.b $20, $F, 0, 4, $E0
0088C3C6 200F 0804 00               		dc.b $20, $F, 8, 4, 0
0088C3CB 400C 1000 E0               		dc.b $40, $C, $10, 0, $E0
0088C3D0 400C 1800 00               		dc.b $40, $C, $18, 0, 0
0088C3D5 02                         @shine:		dc.b 2
0088C3D6 0806 0014 F0               		dc.b 8,	6, 0, $14, $F0	; reflected shine on block
0088C3DB 0006 0014 00               		dc.b 0,	6, 0, $14, 0
0088C3E0 0A                         @short:		dc.b $A
0088C3E1 C80C 0000 E0               		dc.b $C8, $C, 0, 0, $E0	; short block
0088C3E6 C80C 0800 00               		dc.b $C8, $C, 8, 0, 0
0088C3EB D00F 0004 E0               		dc.b $D0, $F, 0, 4, $E0
0088C3F0 D00F 0804 00               		dc.b $D0, $F, 8, 4, 0
0088C3F5 F00F 0004 E0               		dc.b $F0, $F, 0, 4, $E0
0088C3FA F00F 0804 00               		dc.b $F0, $F, 8, 4, 0
0088C3FF 100F 0004 E0               		dc.b $10, $F, 0, 4, $E0
0088C404 100F 0804 00               		dc.b $10, $F, 8, 4, 0
0088C409 300C 1000 E0               		dc.b $30, $C, $10, 0, $E0
0088C40E 300C 1800 00               		dc.b $30, $C, $18, 0, 0
0088C414 00                         		even
0088C414 00                         		even
0088C414                            		include	"_incObj\31 Chained Stompers.asm"
0088C414                            ; ---------------------------------------------------------------------------
0088C414                            ; Object 31 - stomping metal blocks on chains (MZ)
0088C414                            ; ---------------------------------------------------------------------------
0088C414                            
0088C414                            ChainStomp:				; XREF: Obj_Index
0088C414 7000                       		moveq	#0,d0
0088C416 1028 0024                  		move.b	obRoutine(a0),d0
0088C41A 323B 0000                  		move.w	CStom_Index(pc,d0.w),d1
0088C41E 4EFB 1000                  		jmp	CStom_Index(pc,d1.w)
0088C422                            ; ===========================================================================
0088C422 0000                       CStom_Index:	dc.w CStom_Main-CStom_Index
0088C424 0000                       		dc.w loc_B798-CStom_Index
0088C426 0000                       		dc.w loc_B7FE-CStom_Index
0088C428 0000                       		dc.w CStom_Display2-CStom_Index
0088C42A 0000                       		dc.w loc_B7E2-CStom_Index
0088C42C                            
0088C42C =0000003A                  CStom_switch:	= $3A			; switch number for the current stomper
0088C42C                            
0088C42C 0000                       CStom_SwchNums:	dc.b 0,	0		; switch number, obj number
0088C42E 0100                       		dc.b 1,	0
0088C430                            
0088C430 0200 00                    CStom_Var:	dc.b 2,	0, 0		; routine number, y-position, frame number
0088C433 041C 01                    		dc.b 4,	$1C, 1
0088C436 08CC 03                    		dc.b 8,	$CC, 3
0088C439 06F0 02                    		dc.b 6,	$F0, 2
0088C43C                            
0088C43C 7000 A000                  word_B6A4:	dc.w $7000, $A000
0088C440 5000 7800                  		dc.w $5000, $7800
0088C444 3800 5800                  		dc.w $3800, $5800
0088C448 B800                       		dc.w $B800
0088C44A                            ; ===========================================================================
0088C44A                            
0088C44A                            CStom_Main:	; Routine 0
0088C44A 7000                       		moveq	#0,d0
0088C44C 1028 0028                  		move.b	obSubtype(a0),d0
0088C450 6A00                       		bpl.s	loc_B6CE
0088C452 0240 007F                  		andi.w	#$7F,d0
0088C456 D040                       		add.w	d0,d0
0088C458 45FB 00D2                  		lea	CStom_SwchNums(pc,d0.w),a2
0088C45C 115A 003A                  		move.b	(a2)+,CStom_switch(a0)
0088C460 101A                       		move.b	(a2)+,d0
0088C462 1140 0028                  		move.b	d0,obSubtype(a0)
0088C466                            
0088C466                            loc_B6CE:
0088C466 0200 000F                  		andi.b	#$F,d0
0088C46A D040                       		add.w	d0,d0
0088C46C 343B 00CE                  		move.w	word_B6A4(pc,d0.w),d2
0088C470 4A40                       		tst.w	d0
0088C472 6600                       		bne.s	loc_B6E0
0088C474 3142 0032                  		move.w	d2,$32(a0)
0088C478                            
0088C478                            loc_B6E0:
0088C478 45F9 0088 C430             		lea	(CStom_Var).l,a2
0088C47E 2248                       		movea.l	a0,a1
0088C480 7203                       		moveq	#3,d1
0088C482 6000                       		bra.s	CStom_MakeStomper
0088C484                            ; ===========================================================================
0088C484                            
0088C484                            CStom_Loop:
0088C484 6100 0000                  		bsr.w	FindNextFreeObj
0088C488 6600 0000                  		bne.w	CStom_SetSize
0088C48C                            
0088C48C                            CStom_MakeStomper:
0088C48C 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088C490 137C 0000 0000             		move.b	#id_ChainStomp,0(a1)
0088C496 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088C49C 101A                       		move.b	(a2)+,d0
0088C49E 4880                       		ext.w	d0
0088C4A0 D068 000C                  		add.w	obY(a0),d0
0088C4A4 3340 000C                  		move.w	d0,obY(a1)
0088C4A8 237C 0000 0000 0004        		move.l	#Map_CStom,obMap(a1)
0088C4B0 337C 0300 0002             		move.w	#$300,obGfx(a1)
0088C4B6 137C 0004 0001             		move.b	#4,obRender(a1)
0088C4BC 3369 000C 0030             		move.w	obY(a1),$30(a1)
0088C4C2 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088C4C8 137C 0010 0019             		move.b	#$10,obActWid(a1)
0088C4CE 3342 0034                  		move.w	d2,$34(a1)
0088C4D2 137C 0004 0018             		move.b	#4,obPriority(a1)
0088C4D8 135A 001A                  		move.b	(a2)+,obFrame(a1)
0088C4DC 0C29 0001 001A             		cmpi.b	#1,obFrame(a1)
0088C4E2 6600                       		bne.s	loc_B76A
0088C4E4 5341                       		subq.w	#1,d1
0088C4E6 1028 0028                  		move.b	obSubtype(a0),d0
0088C4EA 0240 00F0                  		andi.w	#$F0,d0
0088C4EE 0C40 0020                  		cmpi.w	#$20,d0
0088C4F2 6798                       		beq.s	CStom_MakeStomper
0088C4F4 137C 0038 0019             		move.b	#$38,obActWid(a1)
0088C4FA 137C 0090 0020             		move.b	#$90,obColType(a1)
0088C500 5241                       		addq.w	#1,d1
0088C502                            
0088C502                            loc_B76A:
0088C502 2348 003C                  		move.l	a0,$3C(a1)
0088C506 51C9 FF7C                  		dbf	d1,CStom_Loop
0088C50A                            
0088C50A 137C 0003 0018             		move.b	#3,obPriority(a1)
0088C510                            
0088C510                            CStom_SetSize:
0088C510 7000                       		moveq	#0,d0
0088C512 1028 0028                  		move.b	obSubtype(a0),d0
0088C516 E648                       		lsr.w	#3,d0
0088C518 0200 000E                  		andi.b	#$E,d0
0088C51C 45FB 0000                  		lea	CStom_Var2(pc,d0.w),a2
0088C520 115A 0019                  		move.b	(a2)+,obActWid(a0)
0088C524 115A 001A                  		move.b	(a2)+,obFrame(a0)
0088C528 6000                       		bra.s	loc_B798
0088C52A                            ; ===========================================================================
0088C52A 3800                       CStom_Var2:	dc.b $38, 0		; width, frame number
0088C52C 3009                       		dc.b $30, 9
0088C52E 100A                       		dc.b $10, $A
0088C530                            ; ===========================================================================
0088C530                            
0088C530                            loc_B798:	; Routine 2
0088C530 6100 0000                  		bsr.w	CStom_Types
0088C534 31E8 000C F7A4             		move.w	obY(a0),(v_obj31ypos).w
0088C53A 7200                       		moveq	#0,d1
0088C53C 1228 0019                  		move.b	obActWid(a0),d1
0088C540 0641 000B                  		addi.w	#$B,d1
0088C544 343C 000C                  		move.w	#$C,d2
0088C548 363C 000D                  		move.w	#$D,d3
0088C54C 3828 0008                  		move.w	obX(a0),d4
0088C550 6100 0000                  		bsr.w	SolidObject
0088C554 0828 0003 0022             		btst	#3,obStatus(a0)
0088C55A 6700                       		beq.s	CStom_Display
0088C55C 0C28 0010 0032             		cmpi.b	#$10,$32(a0)
0088C562 6400                       		bcc.s	CStom_Display
0088C564 2448                       		movea.l	a0,a2
0088C566 41F8 D000                  		lea	(v_objspace).w,a0
0088C56A 4EB9 0000 0000             		jsr	KillSonic
0088C570 204A                       		movea.l	a2,a0
0088C572                            
0088C572                            CStom_Display:
0088C572 6100 0000                  		bsr.w	DisplaySprite
0088C576 6000 0000                  		bra.w	CStom_ChkDel
0088C57A                            ; ===========================================================================
0088C57A                            
0088C57A                            loc_B7E2:	; Routine 8
0088C57A 117C 0080 0016             		move.b	#$80,obHeight(a0)
0088C580 08E8 0004 0001             		bset	#4,obRender(a0)
0088C586 2268 003C                  		movea.l	$3C(a0),a1
0088C58A 1029 0032                  		move.b	$32(a1),d0
0088C58E EA08                       		lsr.b	#5,d0
0088C590 5600                       		addq.b	#3,d0
0088C592 1140 001A                  		move.b	d0,obFrame(a0)
0088C596                            
0088C596                            loc_B7FE:	; Routine 4
0088C596 2268 003C                  		movea.l	$3C(a0),a1
0088C59A 7000                       		moveq	#0,d0
0088C59C 1029 0032                  		move.b	$32(a1),d0
0088C5A0 D068 0030                  		add.w	$30(a0),d0
0088C5A4 3140 000C                  		move.w	d0,obY(a0)
0088C5A8                            
0088C5A8                            CStom_Display2:	; Routine 6
0088C5A8 6100 0000                  		bsr.w	DisplaySprite
0088C5AC                            
0088C5AC                            CStom_ChkDel:				; XREF: CStom_Display
0088C5CA 4E75                       		rts	
0088C5CC                            ; ===========================================================================
0088C5CC                            
0088C5CC                            CStom_Types:				; XREF: loc_B798
0088C5CC 1028 0028                  		move.b	obSubtype(a0),d0
0088C5D0 0240 000F                  		andi.w	#$F,d0
0088C5D4 D040                       		add.w	d0,d0
0088C5D6 323B 0000                  		move.w	CStom_TypeIndex(pc,d0.w),d1
0088C5DA 4EFB 1000                  		jmp	CStom_TypeIndex(pc,d1.w)
0088C5DE                            ; ===========================================================================
0088C5DE 0000                       CStom_TypeIndex:dc.w CStom_Type00-CStom_TypeIndex
0088C5E0 0000                       		dc.w CStom_Type01-CStom_TypeIndex
0088C5E2 0000                       		dc.w CStom_Type01-CStom_TypeIndex
0088C5E4 0000                       		dc.w CStom_Type03-CStom_TypeIndex
0088C5E6 0000                       		dc.w CStom_Type01-CStom_TypeIndex
0088C5E8 0000                       		dc.w CStom_Type03-CStom_TypeIndex
0088C5EA 0000                       		dc.w CStom_Type01-CStom_TypeIndex
0088C5EC                            ; ===========================================================================
0088C5EC                            
0088C5EC                            CStom_Type00:				; XREF: CStom_TypeIndex
0088C5EC 45F8 F7E0                  		lea	(f_switch).w,a2	; load switch statuses
0088C5F0 7000                       		moveq	#0,d0
0088C5F2 1028 003A                  		move.b	CStom_switch(a0),d0 ; move number 0 or 1 to d0
0088C5F6 4A32 0000                  		tst.b	(a2,d0.w)	; has switch (d0) been pressed?
0088C5FA 6700                       		beq.s	loc_B8A8	; if not, branch
0088C5FC 4A78 F7A4                  		tst.w	(v_obj31ypos).w
0088C600 6A00                       		bpl.s	loc_B872
0088C602 0C28 0010 0032             		cmpi.b	#$10,$32(a0)
0088C608 6700                       		beq.s	loc_B8A0
0088C60A                            
0088C60A                            loc_B872:
0088C60A 4A68 0032                  		tst.w	$32(a0)
0088C60E 6700                       		beq.s	loc_B8A0
0088C610 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088C614 0200 000F                  		andi.b	#$F,d0
0088C618 6600                       		bne.s	loc_B892
0088C61A 4A28 0001                  		tst.b	1(a0)
0088C61E 6A00                       		bpl.s	loc_B892
0088C62A                            
0088C62A                            loc_B892:
0088C62A 0468 0080 0032             		subi.w	#$80,$32(a0)
0088C630 6400                       		bcc.s	CStom_Restart
0088C632 317C 0000 0032             		move.w	#0,$32(a0)
0088C638                            
0088C638                            loc_B8A0:
0088C638 317C 0000 0012             		move.w	#0,obVelY(a0)
0088C63E 6000                       		bra.s	CStom_Restart
0088C640                            ; ===========================================================================
0088C640                            
0088C640                            loc_B8A8:				; XREF: CStom_Type00
0088C640 3228 0034                  		move.w	$34(a0),d1
0088C644 B268 0032                  		cmp.w	$32(a0),d1
0088C648 6700                       		beq.s	CStom_Restart
0088C64A 3028 0012                  		move.w	obVelY(a0),d0
0088C64E 0668 0070 0012             		addi.w	#$70,obVelY(a0)	; make object fall
0088C654 D168 0032                  		add.w	d0,$32(a0)
0088C658 B268 0032                  		cmp.w	$32(a0),d1
0088C65C 6200                       		bhi.s	CStom_Restart
0088C65E 3141 0032                  		move.w	d1,$32(a0)
0088C662 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop object falling
0088C668 4A28 0001                  		tst.b	obRender(a0)
0088C66C 6A00                       		bpl.s	CStom_Restart
0088C678                            
0088C678                            CStom_Restart:
0088C678 7000                       		moveq	#0,d0
0088C67A 1028 0032                  		move.b	$32(a0),d0
0088C67E D068 0030                  		add.w	$30(a0),d0
0088C682 3140 000C                  		move.w	d0,obY(a0)
0088C686 4E75                       		rts	
0088C688                            ; ===========================================================================
0088C688                            
0088C688                            CStom_Type01:				; XREF: CStom_TypeIndex
0088C688 4A68 0036                  		tst.w	$36(a0)
0088C68C 6700                       		beq.s	loc_B938
0088C68E 4A68 0038                  		tst.w	$38(a0)
0088C692 6700                       		beq.s	loc_B902
0088C694 5368 0038                  		subq.w	#1,$38(a0)
0088C698 6000                       		bra.s	loc_B97C
0088C69A                            ; ===========================================================================
0088C69A                            
0088C69A                            loc_B902:
0088C69A 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088C69E 0200 000F                  		andi.b	#$F,d0
0088C6A2 6600                       		bne.s	loc_B91C
0088C6A4 4A28 0001                  		tst.b	obRender(a0)
0088C6A8 6A00                       		bpl.s	loc_B91C
0088C6B4                            
0088C6B4                            loc_B91C:
0088C6B4 0468 0080 0032             		subi.w	#$80,$32(a0)
0088C6BA 6400                       		bcc.s	loc_B97C
0088C6BC 317C 0000 0032             		move.w	#0,$32(a0)
0088C6C2 317C 0000 0012             		move.w	#0,obVelY(a0)
0088C6C8 317C 0000 0036             		move.w	#0,$36(a0)
0088C6CE 6000                       		bra.s	loc_B97C
0088C6D0                            ; ===========================================================================
0088C6D0                            
0088C6D0                            loc_B938:				; XREF: CStom_Type01
0088C6D0 3228 0034                  		move.w	$34(a0),d1
0088C6D4 B268 0032                  		cmp.w	$32(a0),d1
0088C6D8 6700                       		beq.s	loc_B97C
0088C6DA 3028 0012                  		move.w	obVelY(a0),d0
0088C6DE 0668 0070 0012             		addi.w	#$70,obVelY(a0)	; make object fall
0088C6E4 D168 0032                  		add.w	d0,$32(a0)
0088C6E8 B268 0032                  		cmp.w	$32(a0),d1
0088C6EC 6200                       		bhi.s	loc_B97C
0088C6EE 3141 0032                  		move.w	d1,$32(a0)
0088C6F2 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop object falling
0088C6F8 317C 0001 0036             		move.w	#1,$36(a0)
0088C6FE 317C 003C 0038             		move.w	#$3C,$38(a0)
0088C704 4A28 0001                  		tst.b	obRender(a0)
0088C708 6A00                       		bpl.s	loc_B97C
0088C714                            
0088C714                            loc_B97C:
0088C714 6000 FF62                  		bra.w	CStom_Restart
0088C718                            ; ===========================================================================
0088C718                            
0088C718                            CStom_Type03:				; XREF: CStom_TypeIndex
0088C718 3038 D008                  		move.w	(v_player+obX).w,d0
0088C71C 9068 0008                  		sub.w	obX(a0),d0
0088C720 6400                       		bcc.s	loc_B98C
0088C722 4440                       		neg.w	d0
0088C724                            
0088C724                            loc_B98C:
0088C724 0C40 0090                  		cmpi.w	#$90,d0
0088C728 6400                       		bcc.s	loc_B996
0088C72A 5228 0028                  		addq.b	#1,obSubtype(a0)
0088C72E                            
0088C72E                            loc_B996:
0088C72E 6000 FF48                  		bra.w	CStom_Restart
0088C72E 6000 FF48                  		bra.w	CStom_Restart
0088C732                            		include	"_incObj\45 Sideways Stomper.asm"
0088C732                            ; ---------------------------------------------------------------------------
0088C732                            ; Object 45 - spiked metal block from beta version (MZ)
0088C732                            ; ---------------------------------------------------------------------------
0088C732                            
0088C732                            SideStomp:				; XREF: Obj_Index
0088C732 7000                       		moveq	#0,d0
0088C734 1028 0024                  		move.b	obRoutine(a0),d0
0088C738 323B 0000                  		move.w	SStom_Index(pc,d0.w),d1
0088C73C 4EFB 1000                  		jmp	SStom_Index(pc,d1.w)
0088C740                            ; ===========================================================================
0088C740 0000                       SStom_Index:	dc.w SStom_Main-SStom_Index
0088C742 0000                       		dc.w SStom_Solid-SStom_Index
0088C744 0000                       		dc.w loc_BA8E-SStom_Index
0088C746 0000                       		dc.w SStom_Display-SStom_Index
0088C748 0000                       		dc.w SStom_Pole-SStom_Index
0088C74A                            
0088C74A                            		;	routine		frame
0088C74A                            		;		xpos
0088C74A 0204 00                    SStom_Var:	dc.b	2,  	4,	0	; main block
0088C74D 04E4 01                    		dc.b	4,	$E4,	1	; spikes
0088C750 0834 03                    		dc.b	8,	$34,	3	; pole
0088C753 0628 02                    		dc.b	6,	$28,	2	; wall bracket
0088C756                            
0088C756 3800                       word_B9BE:	dc.w $3800
0088C758 A000                       		dc.w -$6000
0088C75A 5000                       		dc.w $5000
0088C75C                            ; ===========================================================================
0088C75C                            
0088C75C                            SStom_Main:	; Routine 0
0088C75C 7000                       		moveq	#0,d0
0088C75E 1028 0028                  		move.b	obSubtype(a0),d0
0088C762 D040                       		add.w	d0,d0
0088C764 343B 00F0                  		move.w	word_B9BE(pc,d0.w),d2
0088C768 45F9 0088 C74A             		lea	(SStom_Var).l,a2
0088C76E 2248                       		movea.l	a0,a1
0088C770 7203                       		moveq	#3,d1
0088C772 6000                       		bra.s	@load
0088C774                            
0088C774                            	@loop:
0088C774 6100 0000                  		bsr.w	FindNextFreeObj
0088C778 6600                       		bne.s	@fail
0088C77A                            
0088C77A                            	@load:
0088C77A 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088C77E 137C 0000 0000             		move.b	#id_SideStomp,0(a1)
0088C784 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088C78A 101A                       		move.b	(a2)+,d0
0088C78C 4880                       		ext.w	d0
0088C78E D068 0008                  		add.w	obX(a0),d0
0088C792 3340 0008                  		move.w	d0,obX(a1)
0088C796 237C 0000 0000 0004        		move.l	#Map_SStom,obMap(a1)
0088C79E 337C 0300 0002             		move.w	#$300,obGfx(a1)
0088C7A4 137C 0004 0001             		move.b	#4,obRender(a1)
0088C7AA 3369 0008 0030             		move.w	obX(a1),$30(a1)
0088C7B0 3368 0008 003A             		move.w	obX(a0),$3A(a1)
0088C7B6 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088C7BC 137C 0020 0019             		move.b	#$20,obActWid(a1)
0088C7C2 3342 0034                  		move.w	d2,$34(a1)
0088C7C6 137C 0004 0018             		move.b	#4,obPriority(a1)
0088C7CC 0C12 0001                  		cmpi.b	#1,(a2)		; is subobject spikes?
0088C7D0 6600                       		bne.s	@notspikes	; if not, branch
0088C7D2 137C 0091 0020             		move.b	#$91,obColType(a1) ; use harmful collision type
0088C7D8                            
0088C7D8                            	@notspikes:
0088C7D8 135A 001A                  		move.b	(a2)+,obFrame(a1)
0088C7DC 2348 003C                  		move.l	a0,$3C(a1)
0088C7E0 51C9 FF92                  		dbf	d1,@loop	; repeat 3 times
0088C7E4                            
0088C7E4 137C 0003 0018             		move.b	#3,obPriority(a1)
0088C7EA                            
0088C7EA                            	@fail:
0088C7EA 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088C7F0                            
0088C7F0                            SStom_Solid:	; Routine 2
0088C7F0 3F28 0008                  		move.w	obX(a0),-(sp)
0088C7F4 6100 0000                  		bsr.w	SStom_Move
0088C7F8 323C 0017                  		move.w	#$17,d1
0088C7FC 343C 0020                  		move.w	#$20,d2
0088C800 363C 0020                  		move.w	#$20,d3
0088C804 381F                       		move.w	(sp)+,d4
0088C806 6100 0000                  		bsr.w	SolidObject
0088C80A 6100 0000                  		bsr.w	DisplaySprite
0088C80E 6000 0000                  		bra.w	SStom_ChkDel
0088C812                            ; ===========================================================================
0088C812                            
0088C812                            SStom_Pole:	; Routine 8
0088C812 2268 003C                  		movea.l	$3C(a0),a1
0088C816 1029 0032                  		move.b	$32(a1),d0
0088C81A 0600 0010                  		addi.b	#$10,d0
0088C81E EA08                       		lsr.b	#5,d0
0088C820 5600                       		addq.b	#3,d0
0088C822 1140 001A                  		move.b	d0,obFrame(a0)
0088C826                            
0088C826                            loc_BA8E:	; Routine 4
0088C826 2268 003C                  		movea.l	$3C(a0),a1
0088C82A 7000                       		moveq	#0,d0
0088C82C 1029 0032                  		move.b	$32(a1),d0
0088C830 4440                       		neg.w	d0
0088C832 D068 0030                  		add.w	$30(a0),d0
0088C836 3140 0008                  		move.w	d0,obX(a0)
0088C83A                            
0088C83A                            SStom_Display:	; Routine 6
0088C83A 6100 0000                  		bsr.w	DisplaySprite
0088C83E                            
0088C83E                            SStom_ChkDel:
0088C85C 4E75                       		rts	
0088C85E                            
0088C85E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088C85E                            
0088C85E                            
0088C85E                            SStom_Move:				; XREF: SStom_Solid
0088C85E 7000                       		moveq	#0,d0
0088C860 1028 0028                  		move.b	obSubtype(a0),d0
0088C864 D040                       		add.w	d0,d0
0088C866 323B 0000                  		move.w	off_BAD6(pc,d0.w),d1
0088C86A 4EFB 1000                  		jmp	off_BAD6(pc,d1.w)
0088C86E                            ; End of function SStom_Move
0088C86E                            
0088C86E                            ; ===========================================================================
0088C86E 0000                       off_BAD6:	dc.w loc_BADA-off_BAD6
0088C870 0000                       		dc.w loc_BADA-off_BAD6
0088C872                            ; ===========================================================================
0088C872                            
0088C872                            loc_BADA:				; XREF: off_BAD6
0088C872 4A68 0036                  		tst.w	$36(a0)
0088C876 6700                       		beq.s	loc_BB08
0088C878 4A68 0038                  		tst.w	$38(a0)
0088C87C 6700                       		beq.s	loc_BAEC
0088C87E 5368 0038                  		subq.w	#1,$38(a0)
0088C882 6000                       		bra.s	loc_BB3C
0088C884                            ; ===========================================================================
0088C884                            
0088C884                            loc_BAEC:
0088C884 0468 0080 0032             		subi.w	#$80,$32(a0)
0088C88A 6400                       		bcc.s	loc_BB3C
0088C88C 317C 0000 0032             		move.w	#0,$32(a0)
0088C892 317C 0000 0010             		move.w	#0,obVelX(a0)
0088C898 317C 0000 0036             		move.w	#0,$36(a0)
0088C89E 6000                       		bra.s	loc_BB3C
0088C8A0                            ; ===========================================================================
0088C8A0                            
0088C8A0                            loc_BB08:				; XREF: loc_BADA
0088C8A0 3228 0034                  		move.w	$34(a0),d1
0088C8A4 B268 0032                  		cmp.w	$32(a0),d1
0088C8A8 6700                       		beq.s	loc_BB3C
0088C8AA 3028 0010                  		move.w	obVelX(a0),d0
0088C8AE 0668 0070 0010             		addi.w	#$70,obVelX(a0)
0088C8B4 D168 0032                  		add.w	d0,$32(a0)
0088C8B8 B268 0032                  		cmp.w	$32(a0),d1
0088C8BC 6200                       		bhi.s	loc_BB3C
0088C8BE 3141 0032                  		move.w	d1,$32(a0)
0088C8C2 317C 0000 0010             		move.w	#0,obVelX(a0)
0088C8C8 317C 0001 0036             		move.w	#1,$36(a0)
0088C8CE 317C 003C 0038             		move.w	#$3C,$38(a0)
0088C8D4                            
0088C8D4                            loc_BB3C:
0088C8D4 7000                       		moveq	#0,d0
0088C8D6 1028 0032                  		move.b	$32(a0),d0
0088C8DA 4440                       		neg.w	d0
0088C8DC D068 0030                  		add.w	$30(a0),d0
0088C8E0 3140 0008                  		move.w	d0,obX(a0)
0088C8E4 4E75                       		rts	
0088C8E4 4E75                       		rts	
0088C8E6                            		include	"_maps\Chained Stompers.asm"
0088C8E6                            ; ---------------------------------------------------------------------------
0088C8E6                            ; Sprite mappings - metal stomping blocks on chains (MZ)
0088C8E6                            ; ---------------------------------------------------------------------------
0088C8E6 0000                       Map_CStom:	dc.w @wideblock-Map_CStom
0088C8E8 0000                       		dc.w @spikes-Map_CStom
0088C8EA 0000                       		dc.w @ceiling-Map_CStom
0088C8EC 0000                       		dc.w @chain1-Map_CStom
0088C8EE 0000                       		dc.w @chain2-Map_CStom
0088C8F0 0000                       		dc.w @chain3-Map_CStom
0088C8F2 0000                       		dc.w @chain4-Map_CStom
0088C8F4 0000                       		dc.w @chain5-Map_CStom
0088C8F6 0000                       		dc.w @chain5-Map_CStom
0088C8F8 0000                       		dc.w @mediumblock-Map_CStom
0088C8FA 0000                       		dc.w @smallblock-Map_CStom
0088C8FC 05                         @wideblock:	dc.b 5
0088C8FD F406 0000 C8               		dc.b $F4, 6, 0,	0, $C8
0088C902 F40A 0006 D8               		dc.b $F4, $A, 0, 6, $D8
0088C907 EC0F 000F F0               		dc.b $EC, $F, 0, $F, $F0
0088C90C F40A 0806 10               		dc.b $F4, $A, 8, 6, $10
0088C911 F406 0800 28               		dc.b $F4, 6, 8,	0, $28
0088C916 05                         @spikes:	dc.b 5
0088C917 F003 121F D4               		dc.b $F0, 3, $12, $1F, $D4
0088C91C F003 121F E8               		dc.b $F0, 3, $12, $1F, $E8
0088C921 F003 121F FC               		dc.b $F0, 3, $12, $1F, $FC
0088C926 F003 121F 10               		dc.b $F0, 3, $12, $1F, $10
0088C92B F003 121F 24               		dc.b $F0, 3, $12, $1F, $24
0088C930 01                         @ceiling:	dc.b 1
0088C931 DC0F 100F F0               		dc.b $DC, $F, $10, $F, $F0
0088C936 02                         @chain1:	dc.b 2
0088C937 0001 003F FC               		dc.b 0,	1, 0, $3F, $FC
0088C93C 1001 003F FC               		dc.b $10, 1, 0,	$3F, $FC
0088C941 04                         @chain2:	dc.b 4
0088C942 E001 003F FC               		dc.b $E0, 1, 0,	$3F, $FC
0088C947 F001 003F FC               		dc.b $F0, 1, 0,	$3F, $FC
0088C94C 0001 003F FC               		dc.b 0,	1, 0, $3F, $FC
0088C951 1001 003F FC               		dc.b $10, 1, 0,	$3F, $FC
0088C956 06                         @chain3:	dc.b 6
0088C957 C001 003F FC               		dc.b $C0, 1, 0,	$3F, $FC
0088C95C D001 003F FC               		dc.b $D0, 1, 0,	$3F, $FC
0088C961 E001 003F FC               		dc.b $E0, 1, 0,	$3F, $FC
0088C966 F001 003F FC               		dc.b $F0, 1, 0,	$3F, $FC
0088C96B 0001 003F FC               		dc.b 0,	1, 0, $3F, $FC
0088C970 1001 003F FC               		dc.b $10, 1, 0,	$3F, $FC
0088C975 08                         @chain4:	dc.b 8
0088C976 A001 003F FC               		dc.b $A0, 1, 0,	$3F, $FC
0088C97B B001 003F FC               		dc.b $B0, 1, 0,	$3F, $FC
0088C980 C001 003F FC               		dc.b $C0, 1, 0,	$3F, $FC
0088C985 D001 003F FC               		dc.b $D0, 1, 0,	$3F, $FC
0088C98A E001 003F FC               		dc.b $E0, 1, 0,	$3F, $FC
0088C98F F001 003F FC               		dc.b $F0, 1, 0,	$3F, $FC
0088C994 0001 003F FC               		dc.b 0,	1, 0, $3F, $FC
0088C999 1001 003F FC               		dc.b $10, 1, 0,	$3F, $FC
0088C99E 0A                         @chain5:	dc.b $A
0088C99F 8001 003F FC               		dc.b $80, 1, 0,	$3F, $FC
0088C9A4 9001 003F FC               		dc.b $90, 1, 0,	$3F, $FC
0088C9A9 A001 003F FC               		dc.b $A0, 1, 0,	$3F, $FC
0088C9AE B001 003F FC               		dc.b $B0, 1, 0,	$3F, $FC
0088C9B3 C001 003F FC               		dc.b $C0, 1, 0,	$3F, $FC
0088C9B8 D001 003F FC               		dc.b $D0, 1, 0,	$3F, $FC
0088C9BD E001 003F FC               		dc.b $E0, 1, 0,	$3F, $FC
0088C9C2 F001 003F FC               		dc.b $F0, 1, 0,	$3F, $FC
0088C9C7 0001 003F FC               		dc.b 0,	1, 0, $3F, $FC
0088C9CC 1001 003F FC               		dc.b $10, 1, 0,	$3F, $FC
0088C9D1 05                         @mediumblock:	dc.b 5
0088C9D2 F406 0000 D0               		dc.b $F4, 6, 0,	0, $D0
0088C9D7 F40A 0006 E0               		dc.b $F4, $A, 0, 6, $E0
0088C9DC F40A 0806 08               		dc.b $F4, $A, 8, 6, 8
0088C9E1 F406 0800 20               		dc.b $F4, 6, 8,	0, $20
0088C9E6 EC0F 000F F0               		dc.b $EC, $F, 0, $F, $F0
0088C9EB 01                         @smallblock:	dc.b 1
0088C9EC EC0F 002F F0               		dc.b $EC, $F, 0, $2F, $F0
0088C9F2 00                         		even
0088C9F2 00                         		even
0088C9F2                            		include	"_maps\Sideways Stomper.asm"
0088C9F2                            ; ---------------------------------------------------------------------------
0088C9F2                            ; Sprite mappings - spiked metal block from beta version (MZ)
0088C9F2                            ; ---------------------------------------------------------------------------
0088C9F2 0000                       Map_SStom:	dc.w @block-Map_SStom
0088C9F4 0000                       		dc.w @spikes-Map_SStom
0088C9F6 0000                       		dc.w @wallbracket-Map_SStom
0088C9F8 0000                       		dc.w @pole1-Map_SStom
0088C9FA 0000                       		dc.w @pole2-Map_SStom
0088C9FC 0000                       		dc.w @pole3-Map_SStom
0088C9FE 0000                       		dc.w @pole4-Map_SStom
0088CA00 0000                       		dc.w @pole5-Map_SStom
0088CA02 0000                       		dc.w @pole5-Map_SStom
0088CA04 03                         @block:		dc.b 3
0088CA05 E00B 001F F4               		dc.b $E0, $B, 0, $1F, $F4 ; main metal block
0088CA0A 000B 101F F4               		dc.b 0,	$B, $10, $1F, $F4
0088CA0F F003 002B 0C               		dc.b $F0, 3, 0,	$2B, $C
0088CA14 03                         @spikes:	dc.b 3
0088CA15 E80C 121B F0               		dc.b $E8, $C, $12, $1B,	$F0 ; three spikes
0088CA1A FC0C 121B F0               		dc.b $FC, $C, $12, $1B,	$F0
0088CA1F 100C 121B F0               		dc.b $10, $C, $12, $1B,	$F0
0088CA24 01                         @wallbracket:	dc.b 1
0088CA25 F003 082B FC               		dc.b $F0, 3, 8,	$2B, $FC ; thing holding it to the wall
0088CA2A 02                         @pole1:		dc.b 2
0088CA2B F805 0041 E0               		dc.b $F8, 5, 0,	$41, $E0 ; poles of various lengths
0088CA30 F805 0041 F0               		dc.b $F8, 5, 0,	$41, $F0
0088CA35 04                         @pole2:		dc.b 4
0088CA36 F805 0041 E0               		dc.b $F8, 5, 0,	$41, $E0
0088CA3B F805 0041 F0               		dc.b $F8, 5, 0,	$41, $F0
0088CA40 F805 0041 00               		dc.b $F8, 5, 0,	$41, 0
0088CA45 F805 0041 10               		dc.b $F8, 5, 0,	$41, $10
0088CA4A 06                         @pole3:		dc.b 6
0088CA4B F805 0041 E0               		dc.b $F8, 5, 0,	$41, $E0
0088CA50 F805 0041 F0               		dc.b $F8, 5, 0,	$41, $F0
0088CA55 F805 0041 00               		dc.b $F8, 5, 0,	$41, 0
0088CA5A F805 0041 10               		dc.b $F8, 5, 0,	$41, $10
0088CA5F F805 0041 20               		dc.b $F8, 5, 0,	$41, $20
0088CA64 F805 0041 30               		dc.b $F8, 5, 0,	$41, $30
0088CA69 08                         @pole4:		dc.b 8
0088CA6A F805 0041 E0               		dc.b $F8, 5, 0,	$41, $E0
0088CA6F F805 0041 F0               		dc.b $F8, 5, 0,	$41, $F0
0088CA74 F805 0041 00               		dc.b $F8, 5, 0,	$41, 0
0088CA79 F805 0041 10               		dc.b $F8, 5, 0,	$41, $10
0088CA7E F805 0041 20               		dc.b $F8, 5, 0,	$41, $20
0088CA83 F805 0041 30               		dc.b $F8, 5, 0,	$41, $30
0088CA88 F805 0041 40               		dc.b $F8, 5, 0,	$41, $40
0088CA8D F805 0041 50               		dc.b $F8, 5, 0,	$41, $50
0088CA92 08                         @pole5:		dc.b 8
0088CA93 F805 0041 E0               		dc.b $F8, 5, 0,	$41, $E0
0088CA98 F805 0041 F0               		dc.b $F8, 5, 0,	$41, $F0
0088CA9D F805 0041 00               		dc.b $F8, 5, 0,	$41, 0
0088CAA2 F805 0041 10               		dc.b $F8, 5, 0,	$41, $10
0088CAA7 F805 0041 20               		dc.b $F8, 5, 0,	$41, $20
0088CAAC F805 0041 30               		dc.b $F8, 5, 0,	$41, $30
0088CAB1 F805 0041 40               		dc.b $F8, 5, 0,	$41, $40
0088CAB6 F805 0041 50               		dc.b $F8, 5, 0,	$41, $50
0088CABB F805 0041 60               		dc.b $F8, 5, 0,	$41, $60
0088CAC0 F805 0041 70               		dc.b $F8, 5, 0,	$41, $70
0088CAC6 00                         		even
0088CAC6 00                         		even
0088CAC6                            
0088CAC6                            		include	"_incObj\32 Button.asm"
0088CAC6                            ; ---------------------------------------------------------------------------
0088CAC6                            ; Object 32 - buttons (MZ, SYZ, LZ, SBZ)
0088CAC6                            ; ---------------------------------------------------------------------------
0088CAC6                            
0088CAC6                            Button:					; XREF: Obj_Index
0088CAC6 7000                       		moveq	#0,d0
0088CAC8 1028 0024                  		move.b	obRoutine(a0),d0
0088CACC 323B 0000                  		move.w	But_Index(pc,d0.w),d1
0088CAD0 4EFB 1000                  		jmp	But_Index(pc,d1.w)
0088CAD4                            ; ===========================================================================
0088CAD4 0000                       But_Index:	dc.w But_Main-But_Index
0088CAD6 0000                       		dc.w But_Pressed-But_Index
0088CAD8                            ; ===========================================================================
0088CAD8                            
0088CAD8                            But_Main:	; Routine 0
0088CAD8 5428 0024                  		addq.b	#2,obRoutine(a0)
0088CADC 217C 0000 0000 0004        		move.l	#Map_But,obMap(a0)
0088CAE4 317C 4513 0002             		move.w	#$4513,obGfx(a0) ; MZ specific code
0088CAEA 0C38 0002 FE10             		cmpi.b	#id_MZ,(v_zone).w ; is level Marble Zone?
0088CAF0 6700                       		beq.s	But_IsMZ	; if yes, branch
0088CAF2                            
0088CAF2 317C 0513 0002             		move.w	#$513,obGfx(a0)	; SYZ, LZ and SBZ specific code
0088CAF8                            
0088CAF8                            	But_IsMZ:
0088CAF8 117C 0004 0001             		move.b	#4,obRender(a0)
0088CAFE 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088CB04 117C 0004 0018             		move.b	#4,obPriority(a0)
0088CB0A 5668 000C                  		addq.w	#3,obY(a0)
0088CB0E                            
0088CB0E                            But_Pressed:	; Routine 2
0088CB0E 4A28 0001                  		tst.b	obRender(a0)
0088CB12 6A00                       		bpl.s	But_Display
0088CB14 323C 001B                  		move.w	#$1B,d1
0088CB18 343C 0005                  		move.w	#5,d2
0088CB1C 363C 0005                  		move.w	#5,d3
0088CB20 3828 0008                  		move.w	obX(a0),d4
0088CB24 6100 0000                  		bsr.w	SolidObject
0088CB28 08A8 0000 001A             		bclr	#0,obFrame(a0)	; use "unpressed" frame
0088CB2E 1028 0028                  		move.b	obSubtype(a0),d0
0088CB32 0240 000F                  		andi.w	#$F,d0
0088CB36 47F8 F7E0                  		lea	(f_switch).w,a3
0088CB3A 47F3 0000                  		lea	(a3,d0.w),a3
0088CB3E 7600                       		moveq	#0,d3
0088CB40 0828 0006 0028             		btst	#6,obSubtype(a0)
0088CB46 6700                       		beq.s	loc_BDB2
0088CB48 7607                       		moveq	#7,d3
0088CB4A                            
0088CB4A                            loc_BDB2:
0088CB4A 4A28 0028                  		tst.b	obSubtype(a0)
0088CB4E 6A00                       		bpl.s	loc_BDBE
0088CB50 6100 0000                  		bsr.w	But_MZBlock
0088CB54 6600                       		bne.s	loc_BDC8
0088CB56                            
0088CB56                            loc_BDBE:
0088CB56 4A28 0025                  		tst.b	ob2ndRout(a0)
0088CB5A 6600                       		bne.s	loc_BDC8
0088CB5C 0793                       		bclr	d3,(a3)
0088CB5E 6000                       		bra.s	loc_BDDE
0088CB60                            ; ===========================================================================
0088CB60                            
0088CB60                            loc_BDC8:
0088CB60 4A13                       		tst.b	(a3)
0088CB62 6600                       		bne.s	loc_BDD6
0088CB6E                            
0088CB6E                            loc_BDD6:
0088CB6E 07D3                       		bset	d3,(a3)
0088CB70 08E8 0000 001A             		bset	#0,obFrame(a0)	; use "pressed"	frame
0088CB76                            
0088CB76                            loc_BDDE:
0088CB76 0828 0005 0028             		btst	#5,obSubtype(a0)
0088CB7C 6700                       		beq.s	But_Display
0088CB7E 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0088CB82 6A00                       		bpl.s	But_Display
0088CB84 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
0088CB8A 0868 0001 001A             		bchg	#1,obFrame(a0)
0088CB90                            
0088CB90                            But_Display:
0088CB90 6100 0000                  		bsr.w	DisplaySprite
0088CBB2 4E75                       		rts	
0088CBB4                            ; ===========================================================================
0088CBB4                            
0088CBB4                            But_Delete:
0088CBB4 6100 0000                  		bsr.w	DeleteObject
0088CBB8 4E75                       		rts	
0088CBBA                            
0088CBBA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088CBBA                            
0088CBBA                            
0088CBBA                            But_MZBlock:				; XREF: But_Pressed
0088CBBA 3F03                       		move.w	d3,-(sp)
0088CBBC 3428 0008                  		move.w	obX(a0),d2
0088CBC0 3628 000C                  		move.w	obY(a0),d3
0088CBC4 0442 0010                  		subi.w	#$10,d2
0088CBC8 5143                       		subq.w	#8,d3
0088CBCA 383C 0020                  		move.w	#$20,d4
0088CBCE 3A3C 0010                  		move.w	#$10,d5
0088CBD2 43F8 D800                  		lea	(v_lvlobjspace).w,a1 ; begin checking object RAM
0088CBD6 3C3C 005F                  		move.w	#$5F,d6
0088CBDA                            
0088CBDA                            But_MZLoop:
0088CBDA 4A29 0001                  		tst.b	obRender(a1)
0088CBDE 6A00                       		bpl.s	loc_BE4E
0088CBE0 0C11 0000                  		cmpi.b	#id_PushBlock,(a1) ; is the object a green MZ block?
0088CBE4 6700                       		beq.s	loc_BE5E	; if yes, branch
0088CBE6                            
0088CBE6                            loc_BE4E:
0088CBE6 43E9 0040                  		lea	$40(a1),a1	; check	next object
0088CBEA 51CE FFEE                  		dbf	d6,But_MZLoop	; repeat $5F times
0088CBEE                            
0088CBEE 361F                       		move.w	(sp)+,d3
0088CBF0 7000                       		moveq	#0,d0
0088CBF2                            
0088CBF2                            locret_BE5A:
0088CBF2 4E75                       		rts	
0088CBF4                            ; ===========================================================================
0088CBF4 1010                       But_MZData:	dc.b $10, $10
0088CBF6                            ; ===========================================================================
0088CBF6                            
0088CBF6                            loc_BE5E:				; XREF: But_MZBlock
0088CBF6 7001                       		moveq	#1,d0
0088CBF8 0240 003F                  		andi.w	#$3F,d0
0088CBFC D040                       		add.w	d0,d0
0088CBFE 45FB 00F2                  		lea	But_MZData-2(pc,d0.w),a2
0088CC02 121A                       		move.b	(a2)+,d1
0088CC04 4881                       		ext.w	d1
0088CC06 3029 0008                  		move.w	obX(a1),d0
0088CC0A 9041                       		sub.w	d1,d0
0088CC0C 9042                       		sub.w	d2,d0
0088CC0E 6400                       		bcc.s	loc_BE80
0088CC10 D241                       		add.w	d1,d1
0088CC12 D041                       		add.w	d1,d0
0088CC14 6500                       		bcs.s	loc_BE84
0088CC16 60CE                       		bra.s	loc_BE4E
0088CC18                            ; ===========================================================================
0088CC18                            
0088CC18                            loc_BE80:
0088CC18 B044                       		cmp.w	d4,d0
0088CC1A 62CA                       		bhi.s	loc_BE4E
0088CC1C                            
0088CC1C                            loc_BE84:
0088CC1C 121A                       		move.b	(a2)+,d1
0088CC1E 4881                       		ext.w	d1
0088CC20 3029 000C                  		move.w	obY(a1),d0
0088CC24 9041                       		sub.w	d1,d0
0088CC26 9043                       		sub.w	d3,d0
0088CC28 6400                       		bcc.s	loc_BE9A
0088CC2A D241                       		add.w	d1,d1
0088CC2C D041                       		add.w	d1,d0
0088CC2E 6500                       		bcs.s	loc_BE9E
0088CC30 60B4                       		bra.s	loc_BE4E
0088CC32                            ; ===========================================================================
0088CC32                            
0088CC32                            loc_BE9A:
0088CC32 B045                       		cmp.w	d5,d0
0088CC34 62B0                       		bhi.s	loc_BE4E
0088CC36                            
0088CC36                            loc_BE9E:
0088CC36 361F                       		move.w	(sp)+,d3
0088CC38 7001                       		moveq	#1,d0
0088CC3A 4E75                       		rts	
0088CC3C                            ; End of function But_MZBlock
0088CC3C                            ; End of function But_MZBlock
0088CC3C                            		include	"_maps\Button.asm"
0088CC3C                            ; ---------------------------------------------------------------------------
0088CC3C                            ; Sprite mappings - switches (MZ, SYZ, LZ, SBZ)
0088CC3C                            ; ---------------------------------------------------------------------------
0088CC3C 0000                       Map_But:	dc.w byte_BEAC-Map_But
0088CC3E 0000                       		dc.w byte_BEB7-Map_But
0088CC40 0000                       		dc.w byte_BEC2-Map_But
0088CC42 0000                       		dc.w byte_BEB7-Map_But
0088CC44 02                         byte_BEAC:	dc.b 2
0088CC45 F505 0000 F0               		dc.b $F5, 5, 0,	0, $F0
0088CC4A F505 0800 00               		dc.b $F5, 5, 8,	0, 0
0088CC4F 02                         byte_BEB7:	dc.b 2
0088CC50 F505 0004 F0               		dc.b $F5, 5, 0,	4, $F0
0088CC55 F505 0804 00               		dc.b $F5, 5, 8,	4, 0
0088CC5A 02                         byte_BEC2:	dc.b 2
0088CC5B F505 FFFC F0               		dc.b $F5, 5, $FF, $FC, $F0
0088CC60 F505 07FC 00               		dc.b $F5, 5, 7,	$FC, 0
0088CC65 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
0088CC6A                            		even
0088CC6A                            		even
0088CC6A                            
0088CC6A                            		include	"_incObj\33 Pushable Blocks.asm"
0088CC6A                            ; ---------------------------------------------------------------------------
0088CC6A                            ; Object 33 - pushable blocks (MZ, LZ)
0088CC6A                            ; ---------------------------------------------------------------------------
0088CC6A                            
0088CC6A                            PushBlock:				; XREF: Obj_Index
0088CC6A 7000                       		moveq	#0,d0
0088CC6C 1028 0024                  		move.b	obRoutine(a0),d0
0088CC70 323B 0000                  		move.w	PushB_Index(pc,d0.w),d1
0088CC74 4EFB 1000                  		jmp	PushB_Index(pc,d1.w)
0088CC78                            ; ===========================================================================
0088CC78 0000                       PushB_Index:	dc.w PushB_Main-PushB_Index
0088CC7A 0000                       		dc.w loc_BF6E-PushB_Index
0088CC7C 0000                       		dc.w loc_C02C-PushB_Index
0088CC7E                            
0088CC7E 1000                       PushB_Var:	dc.b $10, 0	; object width,	frame number
0088CC80 4001                       		dc.b $40, 1
0088CC82                            ; ===========================================================================
0088CC82                            
0088CC82                            PushB_Main:	; Routine 0
0088CC82 5428 0024                  		addq.b	#2,obRoutine(a0)
0088CC86 117C 000F 0016             		move.b	#$F,obHeight(a0)
0088CC8C 117C 000F 0017             		move.b	#$F,obWidth(a0)
0088CC92 217C 0000 0000 0004        		move.l	#Map_Push,obMap(a0)
0088CC9A 317C 42B8 0002             		move.w	#$42B8,obGfx(a0) ; MZ specific code
0088CCA0 0C38 0001 FE10             		cmpi.b	#1,(v_zone).w
0088CCA6 6600                       		bne.s	@notLZ
0088CCA8 317C 43DE 0002             		move.w	#$43DE,obGfx(a0) ; LZ specific code
0088CCAE                            
0088CCAE                            	@notLZ:
0088CCAE 117C 0004 0001             		move.b	#4,obRender(a0)
0088CCB4 117C 0003 0018             		move.b	#3,obPriority(a0)
0088CCBA 3168 0008 0034             		move.w	obX(a0),$34(a0)
0088CCC0 3168 000C 0036             		move.w	obY(a0),$36(a0)
0088CCC6 7000                       		moveq	#0,d0
0088CCC8 1028 0028                  		move.b	obSubtype(a0),d0
0088CCCC D040                       		add.w	d0,d0
0088CCCE 0240 000E                  		andi.w	#$E,d0
0088CCD2 45FB 00AA                  		lea	PushB_Var(pc,d0.w),a2
0088CCD6 115A 0019                  		move.b	(a2)+,obActWid(a0)
0088CCDA 115A 001A                  		move.b	(a2)+,obFrame(a0)
0088CCDE 4A28 0028                  		tst.b	obSubtype(a0)
0088CCE2 6700                       		beq.s	@chkgone
0088CCE4 317C C2B8 0002             		move.w	#$C2B8,obGfx(a0)
0088CCEA                            
0088CCEA                            	@chkgone:
0088CCEA 45F8 FC00                  		lea	(v_objstate).w,a2
0088CCEE 7000                       		moveq	#0,d0
0088CCF0 1028 0023                  		move.b	obRespawnNo(a0),d0
0088CCF4 6700                       		beq.s	loc_BF6E
0088CCF6 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
0088CCFC 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0088CD02 6600 0000                  		bne.w	DeleteObject
0088CD06                            
0088CD06                            loc_BF6E:	; Routine 2
0088CD06 4A28 0032                  		tst.b	$32(a0)
0088CD0A 6600 0000                  		bne.w	loc_C046
0088CD0E 7200                       		moveq	#0,d1
0088CD10 1228 0019                  		move.b	obActWid(a0),d1
0088CD14 0641 000B                  		addi.w	#$B,d1
0088CD18 343C 0010                  		move.w	#$10,d2
0088CD1C 363C 0011                  		move.w	#$11,d3
0088CD20 3828 0008                  		move.w	obX(a0),d4
0088CD24 6100 0000                  		bsr.w	loc_C186
0088CD28 0C78 0200 FE10             		cmpi.w	#(id_MZ<<8)+0,(v_zone).w ; is the level MZ act 1?
0088CD2E 6600                       		bne.s	loc_BFC6	; if not, branch
0088CD30 08A8 0007 0028             		bclr	#7,obSubtype(a0)
0088CD36 3028 0008                  		move.w	obX(a0),d0
0088CD3A 0C40 0A20                  		cmpi.w	#$A20,d0
0088CD3E 6500                       		bcs.s	loc_BFC6
0088CD40 0C40 0AA1                  		cmpi.w	#$AA1,d0
0088CD44 6400                       		bcc.s	loc_BFC6
0088CD46 3038 F7A4                  		move.w	(v_obj31ypos).w,d0
0088CD4A 0440 001C                  		subi.w	#$1C,d0
0088CD4E 3140 000C                  		move.w	d0,obY(a0)
0088CD52 08F8 0007 F7A4             		bset	#7,(v_obj31ypos).w
0088CD58 08E8 0007 0028             		bset	#7,obSubtype(a0)
0088CD5E                            
0088CD5E                            	loc_BFC6:
0088CD7A 6000 0000                  		bra.w	DisplaySprite
0088CD7E                            ; ===========================================================================
0088CD7E                            
0088CD7E                            loc_ppppp:
0088CD9A 3168 0034 0008             		move.w	$34(a0),obX(a0)
0088CDA0 3168 0036 000C             		move.w	$36(a0),obY(a0)
0088CDA6 117C 0004 0024             		move.b	#4,obRoutine(a0)
0088CDAC 6000                       		bra.s	loc_C02C
0088CDAE                            ; ===========================================================================
0088CDAE                            
0088CDAE                            loc_C016:
0088CDAE 45F8 FC00                  		lea	(v_objstate).w,a2
0088CDB2 7000                       		moveq	#0,d0
0088CDB4 1028 0023                  		move.b	obRespawnNo(a0),d0
0088CDB8 6700                       		beq.s	loc_C028
0088CDBA 08B2 0000 0002             		bclr	#0,2(a2,d0.w)
0088CDC0                            
0088CDC0                            loc_C028:
0088CDC0 6000 0000                  		bra.w	DeleteObject
0088CDC4                            ; ===========================================================================
0088CDC4                            
0088CDC4                            loc_C02C:	; Routine 4
0088CDC4 6100 0000                  		bsr.w	ChkPartiallyVisible
0088CDC8 6700                       		beq.s	locret_C044
0088CDCA 117C 0002 0024             		move.b	#2,obRoutine(a0)
0088CDD0 4228 0032                  		clr.b	$32(a0)
0088CDD4 4268 0010                  		clr.w	obVelX(a0)
0088CDD8 4268 0012                  		clr.w	obVelY(a0)
0088CDDC                            
0088CDDC                            locret_C044:
0088CDDC 4E75                       		rts	
0088CDDE                            ; ===========================================================================
0088CDDE                            
0088CDDE                            loc_C046:				; XREF: loc_BF6E
0088CDDE 3F28 0008                  		move.w	obX(a0),-(sp)
0088CDE2 0C28 0004 0025             		cmpi.b	#4,ob2ndRout(a0)
0088CDE8 6400                       		bcc.s	loc_C056
0088CDEA 6100 0000                  		bsr.w	ObjectMove
0088CDEE                            
0088CDEE                            loc_C056:
0088CDEE 0828 0001 0022             		btst	#1,obStatus(a0)
0088CDF4 6700                       		beq.s	loc_C0A0
0088CDF6 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0088CDFC 4EB9 0000 0000             		jsr	ObjFloorDist
0088CE02 4A41                       		tst.w	d1
0088CE04 6A00 0000                  		bpl.w	loc_C09E
0088CE08 D368 000C                  		add.w	d1,obY(a0)
0088CE0C 4268 0012                  		clr.w	obVelY(a0)
0088CE10 08A8 0001 0022             		bclr	#1,obStatus(a0)
0088CE16 3011                       		move.w	(a1),d0
0088CE18 0240 03FF                  		andi.w	#$3FF,d0
0088CE1C 0C40 016A                  		cmpi.w	#$16A,d0
0088CE20 6500                       		bcs.s	loc_C09E
0088CE22 3028 0030                  		move.w	$30(a0),d0
0088CE26 E640                       		asr.w	#3,d0
0088CE28 3140 0010                  		move.w	d0,obVelX(a0)
0088CE2C 117C 0001 0032             		move.b	#1,$32(a0)
0088CE32 4268 000E                  		clr.w	$E(a0)
0088CE36                            
0088CE36                            loc_C09E:
0088CE36 6000                       		bra.s	loc_C0E6
0088CE38                            ; ===========================================================================
0088CE38                            
0088CE38                            loc_C0A0:
0088CE38 4A68 0010                  		tst.w	obVelX(a0)
0088CE3C 6700 0000                  		beq.w	loc_C0D6
0088CE40 6B00                       		bmi.s	loc_C0BC
0088CE42 7600                       		moveq	#0,d3
0088CE44 1628 0019                  		move.b	obActWid(a0),d3
0088CE48 4EB9 0000 0000             		jsr	ObjHitWallRight
0088CE4E 4A41                       		tst.w	d1		; has block touched a wall?
0088CE50 6B00                       		bmi.s	PushB_StopPush	; if yes, branch
0088CE52 6000                       		bra.s	loc_C0E6
0088CE54                            ; ===========================================================================
0088CE54                            
0088CE54                            loc_C0BC:
0088CE54 7600                       		moveq	#0,d3
0088CE56 1628 0019                  		move.b	obActWid(a0),d3
0088CE5A 4643                       		not.w	d3
0088CE5C 4EB9 0000 0000             		jsr	ObjHitWallLeft
0088CE62 4A41                       		tst.w	d1		; has block touched a wall?
0088CE64 6B00                       		bmi.s	PushB_StopPush	; if yes, branch
0088CE66 6000                       		bra.s	loc_C0E6
0088CE68                            ; ===========================================================================
0088CE68                            
0088CE68                            PushB_StopPush:
0088CE68 4268 0010                  		clr.w	obVelX(a0)		; stop block moving
0088CE6C 6000                       		bra.s	loc_C0E6
0088CE6E                            ; ===========================================================================
0088CE6E                            
0088CE6E                            loc_C0D6:
0088CE6E 06A8 0000 2001 000C        		addi.l	#$2001,obY(a0)
0088CE76 0C28 00A0 000F             		cmpi.b	#$A0,obY+3(a0)
0088CE7C 6400                       		bcc.s	loc_C104
0088CE7E                            
0088CE7E                            loc_C0E6:
0088CE7E 7200                       		moveq	#0,d1
0088CE80 1228 0019                  		move.b	obActWid(a0),d1
0088CE84 0641 000B                  		addi.w	#$B,d1
0088CE88 343C 0010                  		move.w	#$10,d2
0088CE8C 363C 0011                  		move.w	#$11,d3
0088CE90 381F                       		move.w	(sp)+,d4
0088CE92 6100 0000                  		bsr.w	loc_C186
0088CE96 6100                       		bsr.s	PushB_ChkLava
0088CE98 6000 FEC4                  		bra.w	loc_BFC6
0088CE9C                            ; ===========================================================================
0088CE9C                            
0088CE9C                            loc_C104:
0088CE9C 381F                       		move.w	(sp)+,d4
0088CE9E 43F8 D000                  		lea	(v_player).w,a1
0088CEA2 08A9 0003 0022             		bclr	#3,obStatus(a1)
0088CEA8 08A8 0003 0022             		bclr	#3,obStatus(a0)
0088CEAE 6000 FECE                  		bra.w	loc_ppppp
0088CEB2                            ; ===========================================================================
0088CEB2                            
0088CEB2                            PushB_ChkLava:
0088CEB2 0C78 0201 FE10             		cmpi.w	#(id_MZ<<8)+1,(v_zone).w ; is the level MZ act 2?
0088CEB8 6600                       		bne.s	PushB_ChkLava2	; if not, branch
0088CEBA 343C FFE0                  		move.w	#-$20,d2
0088CEBE 0C68 0DD0 0008             		cmpi.w	#$DD0,obX(a0)
0088CEC4 6700                       		beq.s	PushB_LoadLava
0088CEC6 0C68 0CC0 0008             		cmpi.w	#$CC0,obX(a0)
0088CECC 6700                       		beq.s	PushB_LoadLava
0088CECE 0C68 0BA0 0008             		cmpi.w	#$BA0,obX(a0)
0088CED4 6700                       		beq.s	PushB_LoadLava
0088CED6 4E75                       		rts	
0088CED8                            ; ===========================================================================
0088CED8                            
0088CED8                            PushB_ChkLava2:
0088CED8 0C78 0202 FE10             		cmpi.w	#(id_MZ<<8)+2,(v_zone).w ; is the level MZ act 3?
0088CEDE 6600                       		bne.s	PushB_NoLava	; if not, branch
0088CEE0 343C 0020                  		move.w	#$20,d2
0088CEE4 0C68 0560 0008             		cmpi.w	#$560,obX(a0)
0088CEEA 6700                       		beq.s	PushB_LoadLava
0088CEEC 0C68 05C0 0008             		cmpi.w	#$5C0,obX(a0)
0088CEF2 6700                       		beq.s	PushB_LoadLava
0088CEF4                            
0088CEF4                            PushB_NoLava:
0088CEF4 4E75                       		rts	
0088CEF6                            ; ===========================================================================
0088CEF6                            
0088CEF6                            PushB_LoadLava:
0088CEF6 6100 0000                  		bsr.w	FindFreeObj
0088CEFA 6600                       		bne.s	locret_C184
0088CEFC 137C 0000 0000             		move.b	#id_GeyserMaker,0(a1) ; load lava geyser object
0088CF02 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088CF08 D569 0008                  		add.w	d2,obX(a1)
0088CF0C 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088CF12 0669 0010 000C             		addi.w	#$10,obY(a1)
0088CF18 2348 003C                  		move.l	a0,$3C(a1)
0088CF1C                            
0088CF1C                            locret_C184:
0088CF1C 4E75                       		rts	
0088CF1E                            ; ===========================================================================
0088CF1E                            
0088CF1E                            loc_C186:				; XREF: loc_BF6E
0088CF1E 1028 0025                  		move.b	ob2ndRout(a0),d0
0088CF22 6700 0000                  		beq.w	loc_C218
0088CF26 5500                       		subq.b	#2,d0
0088CF28 6600                       		bne.s	loc_C1AA
0088CF2A 6100 B2C8                  		bsr.w	ExitPlatform
0088CF2E 0829 0003 0022             		btst	#3,obStatus(a1)
0088CF34 6600                       		bne.s	loc_C1A4
0088CF36 4228 0025                  		clr.b	ob2ndRout(a0)
0088CF3A 4E75                       		rts	
0088CF3C                            ; ===========================================================================
0088CF3C                            
0088CF3C                            loc_C1A4:
0088CF3C 3404                       		move.w	d4,d2
0088CF3E 6000 B816                  		bra.w	MvSonicOnPtfm
0088CF42                            ; ===========================================================================
0088CF42                            
0088CF42                            loc_C1AA:
0088CF42 5500                       		subq.b	#2,d0
0088CF44 6600                       		bne.s	loc_C1F2
0088CF46 6100 0000                  		bsr.w	ObjectMove
0088CF4A 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0088CF50 4EB9 0000 0000             		jsr	ObjFloorDist
0088CF56 4A41                       		tst.w	d1
0088CF58 6A00 0000                  		bpl.w	locret_C1F0
0088CF5C D368 000C                  		add.w	d1,obY(a0)
0088CF60 4268 0012                  		clr.w	obVelY(a0)
0088CF64 4228 0025                  		clr.b	ob2ndRout(a0)
0088CF68 3011                       		move.w	(a1),d0
0088CF6A 0240 03FF                  		andi.w	#$3FF,d0
0088CF6E 0C40 016A                  		cmpi.w	#$16A,d0
0088CF72 6500                       		bcs.s	locret_C1F0
0088CF74 3028 0030                  		move.w	$30(a0),d0
0088CF78 E640                       		asr.w	#3,d0
0088CF7A 3140 0010                  		move.w	d0,obVelX(a0)
0088CF7E 117C 0001 0032             		move.b	#1,$32(a0)
0088CF84 4268 000E                  		clr.w	obY+2(a0)
0088CF88                            
0088CF88                            locret_C1F0:
0088CF88 4E75                       		rts	
0088CF8A                            ; ===========================================================================
0088CF8A                            
0088CF8A                            loc_C1F2:
0088CF8A 6100 0000                  		bsr.w	ObjectMove
0088CF8E 3028 0008                  		move.w	obX(a0),d0
0088CF92 0240 000C                  		andi.w	#$C,d0
0088CF96 6600 0000                  		bne.w	locret_C2E4
0088CF9A 0268 FFF0 0008             		andi.w	#-$10,obX(a0)
0088CFA0 3168 0010 0030             		move.w	obVelX(a0),$30(a0)
0088CFA6 4268 0010                  		clr.w	obVelX(a0)
0088CFAA 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088CFAE 4E75                       		rts	
0088CFB0                            ; ===========================================================================
0088CFB0                            
0088CFB0                            loc_C218:
0088CFB0 6100 0000                  		bsr.w	Solid_ChkEnter
0088CFB4 4A44                       		tst.w	d4
0088CFB6 6700 0000                  		beq.w	locret_C2E4
0088CFBA 6B00 0000                  		bmi.w	locret_C2E4
0088CFBE 4A28 0032                  		tst.b	$32(a0)
0088CFC2 6700                       		beq.s	loc_C230
0088CFC4 6000 0000                  		bra.w	locret_C2E4
0088CFC8                            ; ===========================================================================
0088CFC8                            
0088CFC8                            loc_C230:
0088CFC8 4A40                       		tst.w	d0
0088CFCA 6700 0000                  		beq.w	locret_C2E4
0088CFCE 6B00                       		bmi.s	loc_C268
0088CFD0 0829 0000 0022             		btst	#0,obStatus(a1)
0088CFD6 6600 0000                  		bne.w	locret_C2E4
0088CFDA 3F00                       		move.w	d0,-(sp)
0088CFDC 7600                       		moveq	#0,d3
0088CFDE 1628 0019                  		move.b	obActWid(a0),d3
0088CFE2 4EB9 0000 0000             		jsr	ObjHitWallRight
0088CFE8 301F                       		move.w	(sp)+,d0
0088CFEA 4A41                       		tst.w	d1
0088CFEC 6B00 0000                  		bmi.w	locret_C2E4
0088CFF0 06A8 0001 0000 0008        		addi.l	#$10000,obX(a0)
0088CFF8 7001                       		moveq	#1,d0
0088CFFA 323C 0040                  		move.w	#$40,d1
0088CFFE 6000                       		bra.s	loc_C294
0088D000                            ; ===========================================================================
0088D000                            
0088D000                            loc_C268:
0088D000 0829 0000 0022             		btst	#0,obStatus(a1)
0088D006 6700                       		beq.s	locret_C2E4
0088D008 3F00                       		move.w	d0,-(sp)
0088D00A 7600                       		moveq	#0,d3
0088D00C 1628 0019                  		move.b	obActWid(a0),d3
0088D010 4643                       		not.w	d3
0088D012 4EB9 0000 0000             		jsr	ObjHitWallLeft
0088D018 301F                       		move.w	(sp)+,d0
0088D01A 4A41                       		tst.w	d1
0088D01C 6B00                       		bmi.s	locret_C2E4
0088D01E 04A8 0001 0000 0008        		subi.l	#$10000,obX(a0)
0088D026 70FF                       		moveq	#-1,d0
0088D028 323C FFC0                  		move.w	#-$40,d1
0088D02C                            
0088D02C                            loc_C294:
0088D02C 43F8 D000                  		lea	(v_player).w,a1
0088D030 D169 0008                  		add.w	d0,obX(a1)
0088D034 3341 0014                  		move.w	d1,obInertia(a1)
0088D038 337C 0000 0010             		move.w	#0,obVelX(a1)
0088D03E 3F00                       		move.w	d0,-(sp)
0088D04A 301F                       		move.w	(sp)+,d0
0088D04C 4A28 0028                  		tst.b	obSubtype(a0)
0088D050 6B00                       		bmi.s	locret_C2E4
0088D052 3F00                       		move.w	d0,-(sp)
0088D054 4EB9 0000 0000             		jsr	ObjFloorDist
0088D05A 301F                       		move.w	(sp)+,d0
0088D05C 0C41 0004                  		cmpi.w	#4,d1
0088D060 6F00                       		ble.s	loc_C2E0
0088D062 317C 0400 0010             		move.w	#$400,obVelX(a0)
0088D068 4A40                       		tst.w	d0
0088D06A 6A00                       		bpl.s	loc_C2D8
0088D06C 4468 0010                  		neg.w	obVelX(a0)
0088D070                            
0088D070                            loc_C2D8:
0088D070 117C 0006 0025             		move.b	#6,ob2ndRout(a0)
0088D076 6000                       		bra.s	locret_C2E4
0088D078                            ; ===========================================================================
0088D078                            
0088D078                            loc_C2E0:
0088D078 D368 000C                  		add.w	d1,obY(a0)
0088D07C                            
0088D07C                            locret_C2E4:
0088D07C 4E75                       		rts	
0088D07C 4E75                       		rts	
0088D07E                            		include	"_maps\Pushable Blocks.asm"
0088D07E                            ; ---------------------------------------------------------------------------
0088D07E                            ; Sprite mappings - pushable blocks (MZ, LZ)
0088D07E                            ; ---------------------------------------------------------------------------
0088D07E 0000                       Map_Push:	dc.w @single-Map_Push
0088D080 0000                       		dc.w @four-Map_Push
0088D082 01                         @single:	dc.b 1
0088D083 F00F 0008 F0               		dc.b $F0, $F, 0, 8, $F0	; single block
0088D088 04                         @four:		dc.b 4
0088D089 F00F 0008 C0               		dc.b $F0, $F, 0, 8, $C0	; row of 4 blocks
0088D08E F00F 0008 E0               		dc.b $F0, $F, 0, 8, $E0
0088D093 F00F 0008 00               		dc.b $F0, $F, 0, 8, 0
0088D098 F00F 0008 20               		dc.b $F0, $F, 0, 8, $20
0088D09E 00                         		even
0088D09E 00                         		even
0088D09E                            
0088D09E                            		include	"_incObj\34 Title Cards.asm"
0088D09E                            ; ---------------------------------------------------------------------------
0088D09E                            ; Object 34 - zone title cards
0088D09E                            ; ---------------------------------------------------------------------------
0088D09E                            
0088D09E                            TitleCard:					; XREF: Obj_Index
0088D09E 7000                       		moveq	#0,d0
0088D0A0 1028 0024                  		move.b	obRoutine(a0),d0
0088D0A4 323B 0000                  		move.w	Card_Index(pc,d0.w),d1
0088D0A8 4EFB 1000                  		jmp	Card_Index(pc,d1.w)
0088D0AC                            ; ===========================================================================
0088D0AC 0000                       Card_Index:	dc.w Card_CheckSBZ3-Card_Index
0088D0AE 0000                       		dc.w Card_ChkPos-Card_Index
0088D0B0 0000                       		dc.w Card_Wait-Card_Index
0088D0B2 0000                       		dc.w Card_Wait-Card_Index
0088D0B4                            
0088D0B4 =00000030                  card_mainX:	= $30		; position for card to display on
0088D0B4 =00000032                  card_finalX:	= $32		; position for card to finish on
0088D0B4                            ; ===========================================================================
0088D0B4                            
0088D0B4                            Card_CheckSBZ3:	; Routine 0
0088D0B4 2248                       		movea.l	a0,a1
0088D0B6 7000                       		moveq	#0,d0
0088D0B8 1038 FE10                  		move.b	(v_zone).w,d0
0088D0BC 0C78 0103 FE10             		cmpi.w	#(id_LZ<<8)+3,(v_zone).w ; check if level is SBZ 3
0088D0C2 6600                       		bne.s	Card_CheckFZ
0088D0C4 7005                       		moveq	#5,d0		; load title card number 5 (SBZ)
0088D0C6                            
0088D0C6                            	Card_CheckFZ:
0088D0C6 3400                       		move.w	d0,d2
0088D0C8 0C78 0502 FE10             		cmpi.w	#(id_SBZ<<8)+2,(v_zone).w ; check if level is FZ
0088D0CE 6600                       		bne.s	Card_LoadConfig
0088D0D0 7006                       		moveq	#6,d0		; load title card number 6 (FZ)
0088D0D2 740B                       		moveq	#$B,d2		; use "FINAL" mappings
0088D0D4                            
0088D0D4                            	Card_LoadConfig:
0088D0D4 47F9 0000 0000             		lea	(Card_ConData).l,a3
0088D0DA E948                       		lsl.w	#4,d0
0088D0DC D6C0                       		adda.w	d0,a3
0088D0DE 45F9 0000 0000             		lea	(Card_ItemData).l,a2
0088D0E4 7203                       		moveq	#3,d1
0088D0E6                            
0088D0E6                            Card_Loop:
0088D0E6 137C 0000 0000             		move.b	#id_TitleCard,0(a1)
0088D0EC 3353 0008                  		move.w	(a3),obX(a1)	; load start x-position
0088D0F0 335B 0032                  		move.w	(a3)+,card_finalX(a1) ; load finish x-position (same as start)
0088D0F4 335B 0030                  		move.w	(a3)+,card_mainX(a1) ; load main x-position
0088D0F8 335A 000A                  		move.w	(a2)+,obScreenY(a1)
0088D0FC 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088D100 101A                       		move.b	(a2)+,d0
0088D102 6600                       		bne.s	Card_ActNumber
0088D104 1002                       		move.b	d2,d0
0088D106                            
0088D106                            	Card_ActNumber:
0088D106 0C00 0007                  		cmpi.b	#7,d0
0088D10A 6600                       		bne.s	Card_MakeSprite
0088D10C D038 FE11                  		add.b	(v_act).w,d0
0088D110 0C38 0003 FE11             		cmpi.b	#3,(v_act).w
0088D116 6600                       		bne.s	Card_MakeSprite
0088D118 5300                       		subq.b	#1,d0
0088D11A                            
0088D11A                            	Card_MakeSprite:
0088D11A 1340 001A                  		move.b	d0,obFrame(a1)	; display frame	number d0
0088D11E 237C 0000 0000 0004        		move.l	#Map_Card,obMap(a1)
0088D126 337C 8580 0002             		move.w	#$8580,obGfx(a1)
0088D12C 137C 0078 0019             		move.b	#$78,obActWid(a1)
0088D132 137C 0000 0001             		move.b	#0,obRender(a1)
0088D138 137C 0000 0018             		move.b	#0,obPriority(a1)
0088D13E 337C 003C 001E             		move.w	#60,obTimeFrame(a1) ; set time delay to 1 second
0088D144 43E9 0040                  		lea	$40(a1),a1	; next object
0088D148 51C9 FF9C                  		dbf	d1,Card_Loop	; repeat sequence another 3 times
0088D14C                            
0088D14C                            Card_ChkPos:	; Routine 2
0088D14C 7210                       		moveq	#$10,d1		; set horizontal speed
0088D14E 3028 0030                  		move.w	card_mainX(a0),d0
0088D152 B068 0008                  		cmp.w	obX(a0),d0	; has item reached the target position?
0088D156 6700                       		beq.s	Card_NoMove	; if yes, branch
0088D158 6C00                       		bge.s	Card_Move
0088D15A 4441                       		neg.w	d1
0088D15C                            
0088D15C                            Card_Move:
0088D15C D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D160                            
0088D160                            Card_NoMove:
0088D160 3028 0008                  		move.w	obX(a0),d0
0088D164 6B00                       		bmi.s	locret_C3D8
0088D166 0C40 0200                  		cmpi.w	#$200,d0	; has item moved beyond	$200 on	x-axis?
0088D16A 6400                       		bcc.s	locret_C3D8	; if yes, branch
0088D16C 6000 0000                  		bra.w	DisplaySprite
0088D170                            ; ===========================================================================
0088D170                            
0088D170                            locret_C3D8:
0088D170 4E75                       		rts	
0088D172                            ; ===========================================================================
0088D172                            
0088D172                            Card_Wait:	; Routine 4/6
0088D172 4A68 001E                  		tst.w	obTimeFrame(a0)	; is time remaining zero?
0088D176 6700                       		beq.s	Card_ChkPos2	; if yes, branch
0088D178 5368 001E                  		subq.w	#1,obTimeFrame(a0) ; subtract 1 from time
0088D17C 6000 0000                  		bra.w	DisplaySprite
0088D180                            ; ===========================================================================
0088D180                            
0088D180                            Card_ChkPos2:				; XREF: Card_Wait
0088D180 4A28 0001                  		tst.b	obRender(a0)
0088D184 6A00                       		bpl.s	Card_ChangeArt
0088D186 7220                       		moveq	#$20,d1
0088D188 3028 0032                  		move.w	card_finalX(a0),d0
0088D18C B068 0008                  		cmp.w	obX(a0),d0	; has item reached the finish position?
0088D190 6700                       		beq.s	Card_ChangeArt	; if yes, branch
0088D192 6C00                       		bge.s	Card_Move2
0088D194 4441                       		neg.w	d1
0088D196                            
0088D196                            Card_Move2:
0088D196 D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D19A 3028 0008                  		move.w	obX(a0),d0
0088D19E 6B00                       		bmi.s	locret_C412
0088D1A0 0C40 0200                  		cmpi.w	#$200,d0	; has item moved beyond	$200 on	x-axis?
0088D1A4 6400                       		bcc.s	locret_C412	; if yes, branch
0088D1A6 6000 0000                  		bra.w	DisplaySprite
0088D1AA                            ; ===========================================================================
0088D1AA                            
0088D1AA                            locret_C412:
0088D1AA 4E75                       		rts	
0088D1AC                            ; ===========================================================================
0088D1AC                            
0088D1AC                            Card_ChangeArt:			; XREF: Card_ChkPos2
0088D1AC 0C28 0004 0024             		cmpi.b	#4,obRoutine(a0)
0088D1B2 6600                       		bne.s	Card_Delete
0088D1B4 7000                       		moveq	#plcid_Explode,d0
0088D1B6 4EB9 0088 1BA2             		jsr	(AddPLC).l	; load explosion patterns
0088D1BC 7000                       		moveq	#0,d0
0088D1BE 1038 FE10                  		move.b	(v_zone).w,d0
0088D1C2 0640 0000                  		addi.w	#plcid_GHZAnimals,d0
0088D1C6 4EB9 0088 1BA2             		jsr	(AddPLC).l	; load animal patterns
0088D1CC                            
0088D1CC                            Card_Delete:
0088D1CC 6000 0000                  		bra.w	DeleteObject
0088D1D0                            ; ===========================================================================
0088D1D0 00D0                       Card_ItemData:	dc.w $D0	; y-axis position
0088D1D2 0200                       		dc.b 2,	0	; routine number, frame	number (changes)
0088D1D4 00E4                       		dc.w $E4
0088D1D6 0206                       		dc.b 2,	6
0088D1D8 00EA                       		dc.w $EA
0088D1DA 0207                       		dc.b 2,	7
0088D1DC 00E0                       		dc.w $E0
0088D1DE 020A                       		dc.b 2,	$A
0088D1E0                            ; ---------------------------------------------------------------------------
0088D1E0                            ; Title	card configuration data
0088D1E0                            ; Format:
0088D1E0                            ; 4 bytes per item (YYYY XXXX)
0088D1E0                            ; 4 items per level (GREEN HILL, ZONE, ACT X, oval)
0088D1E0                            ; ---------------------------------------------------------------------------
0088D1E0 0000 0120 FEFC 013C 0414+  Card_ConData:	dc.w 0,	$120, $FEFC, $13C, $414, $154, $214, $154 ; GHZ
0088D1F0 0000 0120 FEF4 0134 040C+  		dc.w 0,	$120, $FEF4, $134, $40C, $14C, $20C, $14C ; LZ
0088D200 0000 0120 FEE0 0120 03F8+  		dc.w 0,	$120, $FEE0, $120, $3F8, $138, $1F8, $138 ; MZ
0088D210 0000 0120 FEFC 013C 0414+  		dc.w 0,	$120, $FEFC, $13C, $414, $154, $214, $154 ; SLZ
0088D220 0000 0120 FF04 0144 041C+  		dc.w 0,	$120, $FF04, $144, $41C, $15C, $21C, $15C ; SYZ
0088D230 0000 0120 FF04 0144 041C+  		dc.w 0,	$120, $FF04, $144, $41C, $15C, $21C, $15C ; SBZ
0088D240 0000 0120 FEE4 0124 03EC+  		dc.w 0,	$120, $FEE4, $124, $3EC, $3EC, $1EC, $12C ; FZ
0088D250                            ; ===========================================================================
0088D250                            ; ===========================================================================
0088D250                            		include	"_incObj\39 Game Over.asm"
0088D250                            ; ---------------------------------------------------------------------------
0088D250                            ; Object 39 - "GAME OVER" and "TIME OVER"
0088D250                            ; ---------------------------------------------------------------------------
0088D250                            
0088D250                            GameOverCard:				; XREF: Obj_Index
0088D250 7000                       		moveq	#0,d0
0088D252 1028 0024                  		move.b	obRoutine(a0),d0
0088D256 323B 0000                  		move.w	Over_Index(pc,d0.w),d1
0088D25A 4EFB 1000                  		jmp	Over_Index(pc,d1.w)
0088D25E                            ; ===========================================================================
0088D25E 0000                       Over_Index:	dc.w Over_ChkPLC-Over_Index
0088D260 0000                       		dc.w Over_Move-Over_Index
0088D262 0000                       		dc.w Over_Wait-Over_Index
0088D264                            ; ===========================================================================
0088D264                            
0088D264                            Over_ChkPLC:	; Routine 0
0088D264 4AB8 F680                  		tst.l	(v_plc_buffer).w ; are the pattern load cues empty?
0088D268 6700                       		beq.s	Over_Main	; if yes, branch
0088D26A 4E75                       		rts	
0088D26C                            ; ===========================================================================
0088D26C                            
0088D26C                            Over_Main:
0088D26C 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D270 317C 0050 0008             		move.w	#$50,obX(a0)	; set x-position
0088D276 0828 0000 001A             		btst	#0,obFrame(a0)	; is the object	"OVER"?
0088D27C 6700                       		beq.s	Over_1stWord	; if not, branch
0088D27E 317C 01F0 0008             		move.w	#$1F0,obX(a0)	; set x-position for "OVER"
0088D284                            
0088D284                            	Over_1stWord:
0088D284 317C 00F0 000A             		move.w	#$F0,obScreenY(a0)
0088D28A 217C 0000 0000 0004        		move.l	#Map_Over,obMap(a0)
0088D292 317C 855E 0002             		move.w	#$855E,obGfx(a0)
0088D298 117C 0000 0001             		move.b	#0,obRender(a0)
0088D29E 117C 0000 0018             		move.b	#0,obPriority(a0)
0088D2A4                            
0088D2A4                            Over_Move:	; Routine 2
0088D2A4 7210                       		moveq	#$10,d1		; set horizontal speed
0088D2A6 0C68 0120 0008             		cmpi.w	#$120,obX(a0)	; has item reached its target position?
0088D2AC 6700                       		beq.s	Over_SetWait	; if yes, branch
0088D2AE 6500                       		bcs.s	Over_UpdatePos
0088D2B0 4441                       		neg.w	d1
0088D2B2                            
0088D2B2                            	Over_UpdatePos:
0088D2B2 D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D2B6 6000 0000                  		bra.w	DisplaySprite
0088D2BA                            ; ===========================================================================
0088D2BA                            
0088D2BA                            Over_SetWait:
0088D2BA 317C 02D0 001E             		move.w	#720,obTimeFrame(a0) ; set time delay to 12 seconds
0088D2C0 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D2C4 4E75                       		rts	
0088D2C6                            ; ===========================================================================
0088D2C6                            
0088D2C6                            Over_Wait:	; Routine 4
0088D2C6 1038 F605                  		move.b	(v_jpadpress1).w,d0
0088D2CA 0200 0070                  		andi.b	#btnABC,d0	; is button A, B or C pressed?
0088D2CE 6600                       		bne.s	Over_ChgMode	; if yes, branch
0088D2D0 0828 0000 001A             		btst	#0,obFrame(a0)
0088D2D6 6600                       		bne.s	Over_Display
0088D2D8 4A68 001E                  		tst.w	obTimeFrame(a0)	; has time delay reached zero?
0088D2DC 6700                       		beq.s	Over_ChgMode	; if yes, branch
0088D2DE 5368 001E                  		subq.w	#1,obTimeFrame(a0) ; subtract 1 from time delay
0088D2E2 6000 0000                  		bra.w	DisplaySprite
0088D2E6                            ; ===========================================================================
0088D2E6                            
0088D2E6                            Over_ChgMode:				; XREF: Over_Wait
0088D2E6 4A38 FE1A                  		tst.b	(f_timeover).w	; is time over flag set?
0088D2EA 6600                       		bne.s	Over_ResetLvl	; if yes, branch
0088D2EC 11FC 0000 F600             		move.b	#id_Continue,(v_gamemode).w ; set mode to $14 (continue screen)
0088D2F2 4A38 FE18                  		tst.b	(v_continues).w	; do you have any continues?
0088D2F6 6600                       		bne.s	Over_Display	; if yes, branch
0088D2F8 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w ; set mode to 0 (Sega screen)
0088D2FE 6000                       		bra.s	Over_Display
0088D300                            ; ===========================================================================
0088D300                            
0088D300                            Over_ResetLvl:				; XREF: Over_ChgMode
0088D300                            
0088D300 42B8 FE38                  		clr.l	(v_lamp_time).w
0088D304 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart level
0088D30A                            
0088D30A                            Over_Display:				; XREF: Over_ChgMode
0088D30A 6000 0000                  		bra.w	DisplaySprite
0088D30A 6000 0000                  		bra.w	DisplaySprite
0088D30E                            		include	"_incObj\3A Got Through Card.asm"
0088D30E                            ; ---------------------------------------------------------------------------
0088D30E                            ; Object 3A - "SONIC GOT THROUGH" title	card
0088D30E                            ; ---------------------------------------------------------------------------
0088D30E                            
0088D30E                            GotThroughCard:					; XREF: Obj_Index
0088D30E 7000                       		moveq	#0,d0
0088D310 1028 0024                  		move.b	obRoutine(a0),d0
0088D314 323B 0000                  		move.w	Got_Index(pc,d0.w),d1
0088D318 4EFB 1000                  		jmp	Got_Index(pc,d1.w)
0088D31C                            ; ===========================================================================
0088D31C 0000                       Got_Index:	dc.w Got_ChkPLC-Got_Index
0088D31E 0000                       		dc.w Got_Move-Got_Index
0088D320 0000                       		dc.w Got_Wait-Got_Index
0088D322 0000                       		dc.w Got_TimeBonus-Got_Index
0088D324 0000                       		dc.w Got_Wait-Got_Index
0088D326 0000                       		dc.w Got_NextLevel-Got_Index
0088D328 0000                       		dc.w Got_Wait-Got_Index
0088D32A 0000                       		dc.w Got_Move2-Got_Index
0088D32C 0000                       		dc.w loc_C766-Got_Index
0088D32E                            
0088D32E =00000030                  got_mainX:	= $30		; position for card to display on
0088D32E =00000032                  got_finalX:	= $32		; position for card to finish on
0088D32E                            ; ===========================================================================
0088D32E                            
0088D32E                            Got_ChkPLC:	; Routine 0
0088D32E 4AB8 F680                  		tst.l	(v_plc_buffer).w ; are the pattern load cues empty?
0088D332 6700                       		beq.s	Got_Main	; if yes, branch
0088D334 4E75                       		rts	
0088D336                            ; ===========================================================================
0088D336                            
0088D336                            Got_Main:
0088D336                            
0088D336                            	;Mercury Remove Speed Shoes At Signpost Fix
0088D336 31FC 0001 D034             		move.w	#1,(v_player+obShoes).w	; clear Super Shoes	;Mercury Constants
0088D33C                            	;end Remove Speed Shoes At Signpost Fix
0088D33C                            	
0088D33C 2248                       		movea.l	a0,a1
0088D33E 45F9 0000 0000             		lea	(Got_Config).l,a2
0088D344 7206                       		moveq	#6,d1
0088D346                            
0088D346                            Got_Loop:
0088D346 137C 0000 0000             		move.b	#id_GotThroughCard,0(a1)
0088D34C 3352 0008                  		move.w	(a2),obX(a1)	; load start x-position
0088D350 335A 0032                  		move.w	(a2)+,got_finalX(a1) ; load finish x-position (same as start)
0088D354 335A 0030                  		move.w	(a2)+,got_mainX(a1) ; load main x-position
0088D358 335A 000A                  		move.w	(a2)+,obScreenY(a1) ; load y-position
0088D35C 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088D360 101A                       		move.b	(a2)+,d0
0088D362 0C00 0006                  		cmpi.b	#6,d0
0088D366 6600                       		bne.s	loc_C5CA
0088D368 D038 FE11                  		add.b	(v_act).w,d0	; add act number to frame number
0088D36C                            
0088D36C                            	loc_C5CA:
0088D36C 1340 001A                  		move.b	d0,obFrame(a1)
0088D370 237C 0000 0000 0004        		move.l	#Map_Got,obMap(a1)
0088D378 337C 8580 0002             		move.w	#$8580,obGfx(a1)
0088D37E 137C 0000 0001             		move.b	#0,obRender(a1)
0088D384 43E9 0040                  		lea	$40(a1),a1
0088D388 51C9 FFBC                  		dbf	d1,Got_Loop	; repeat 6 times
0088D38C                            
0088D38C                            Got_Move:	; Routine 2
0088D38C 7210                       		moveq	#$10,d1		; set horizontal speed
0088D38E 3028 0030                  		move.w	got_mainX(a0),d0
0088D392 B068 0008                  		cmp.w	obX(a0),d0	; has item reached its target position?
0088D396 6700                       		beq.s	loc_C61A	; if yes, branch
0088D398 6C00                       		bge.s	Got_ChgPos
0088D39A 4441                       		neg.w	d1
0088D39C                            
0088D39C                            	Got_ChgPos:
0088D39C D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D3A0                            
0088D3A0                            	loc_C5FE:			; XREF: loc_C61A
0088D3A0 3028 0008                  		move.w	obX(a0),d0
0088D3A4 6B00                       		bmi.s	locret_C60E
0088D3A6 0C40 0200                  		cmpi.w	#$200,d0	; has item moved beyond	$200 on	x-axis?
0088D3AA 6400                       		bcc.s	locret_C60E	; if yes, branch
0088D3AC 6000 0000                  		bra.w	DisplaySprite
0088D3B0                            ; ===========================================================================
0088D3B0                            
0088D3B0                            locret_C60E:
0088D3B0 4E75                       		rts	
0088D3B2                            ; ===========================================================================
0088D3B2                            
0088D3B2                            loc_C610:				; XREF: loc_C61A
0088D3B2 117C 000E 0024             		move.b	#$E,obRoutine(a0)
0088D3B8 6000 0000                  		bra.w	Got_Move2
0088D3BC                            ; ===========================================================================
0088D3BC                            
0088D3BC                            loc_C61A:				; XREF: Got_Move
0088D3BC 0C38 000E D724             		cmpi.b	#$E,($FFFFD724).w
0088D3C2 67EE                       		beq.s	loc_C610
0088D3C4 0C28 0004 001A             		cmpi.b	#4,obFrame(a0)
0088D3CA 66D4                       		bne.s	loc_C5FE
0088D3CC 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D3D0 317C 00B4 001E             		move.w	#180,obTimeFrame(a0) ; set time delay to 3 seconds
0088D3D6                            
0088D3D6                            Got_Wait:	; Routine 4, 8, $C
0088D3D6 5368 001E                  		subq.w	#1,obTimeFrame(a0) ; subtract 1 from time delay
0088D3DA 6600                       		bne.s	Got_Display
0088D3DC 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D3E0                            
0088D3E0                            Got_Display:
0088D3E0 6000 0000                  		bra.w	DisplaySprite
0088D3E4                            ; ===========================================================================
0088D3E4                            
0088D3E4                            Got_TimeBonus:	; Routine 6
0088D3E4                            
0088D3E4 6100 0000                  		bsr.w	DisplaySprite
0088D3E8 123C 000A                  		move.b	#10,d1	; set score decrement to 10
0088D3EC 1038 F604                  		move.b	(v_jpadhold1).w,d0
0088D3F0 0200 0070                  		andi.b	#btnABC,d0	; is A, B or C pressed?
0088D3F4 6700 0000                  		beq.w	@dontspeedup	; if not, branch
0088D3F8 123C 0064                  		move.b	#100,d1	; increase score decrement to 100
0088D3FC                            		
0088D3FC                            	@dontspeedup:
0088D3FC 11FC 0001 F7D6             		move.b	#1,(f_endactbonus).w ; set time/ring bonus update flag
0088D402 7000                       		moveq	#0,d0
0088D404 4A78 F7D2                  		tst.w	(v_timebonus).w	; is time bonus	= zero?
0088D408 6700                       		beq.s	Got_RingBonus	; if yes, branch
0088D40A B278 F7D2                  		cmp.w	(v_timebonus).w,d1	; compare time bonus to score decrement
0088D40E 6D00                       		blt.s	@skip	; if it's greater or equal, branch
0088D410 3238 F7D2                  		move.w	(v_timebonus).w,d1	; else, set the decrement to the remaining bonus
0088D414                            	@skip:
0088D414 D041                       		add.w	d1,d0		; add decrement to score
0088D416 9378 F7D2                  		sub.w	d1,(v_timebonus).w ; subtract decrement from time bonus
0088D41A                            
0088D41A                            Got_RingBonus:
0088D41A 4A78 F7D4                  		tst.w	(v_ringbonus).w	; is ring bonus	= zero?
0088D41E 6700                       		beq.s	Got_ChkBonus	; if yes, branch
0088D420 B278 F7D4                  		cmp.w	(v_ringbonus).w,d1	; compare ring bonus to score decrement
0088D424 6D00                       		blt.s	@skip	; if it's greater or equal, branch
0088D426 3238 F7D4                  		move.w	(v_ringbonus).w,d1	; else, set the decrement to the remaining bonus
0088D42A                            	@skip:
0088D42A D041                       		add.w	d1,d0		; add decrement to score
0088D42C 9378 F7D4                  		sub.w	d1,(v_ringbonus).w ; subtract decrement from ring bonus
0088D430                            
0088D430                            Got_ChkBonus:
0088D430 4A40                       		tst.w	d0		; is there any bonus?
0088D432 6600                       		bne.s	Got_AddBonus	; if yes, branch
0088D43E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D442 0C78 0501 FE10             		cmpi.w	#(id_SBZ<<8)+1,(v_zone).w
0088D448 6600                       		bne.s	Got_SetDelay
0088D44A 5828 0024                  		addq.b	#4,obRoutine(a0)
0088D44E                            
0088D44E                            Got_SetDelay:
0088D44E 317C 00B4 001E             		move.w	#180,obTimeFrame(a0) ; set time delay to 3 seconds
0088D454                            
0088D454                            locret_C692:
0088D454 4E75                       		rts	
0088D456                            ; ===========================================================================
0088D456                            
0088D456                            Got_AddBonus:				; XREF: Got_ChkBonus
0088D456 4EB9 0000 0000             		jsr	AddPoints
0088D45C 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088D460 0200 0003                  		andi.b	#3,d0
0088D464 66EE                       		bne.s	locret_C692
0088D470                            ; ===========================================================================
0088D470                            
0088D470                            Got_NextLevel:	; Routine $A
0088D470 1038 FE10                  		move.b	(v_zone).w,d0
0088D474 0240 0007                  		andi.w	#7,d0
0088D478 E748                       		lsl.w	#3,d0
0088D47A 1238 FE11                  		move.b	(v_act).w,d1
0088D47E 0241 0003                  		andi.w	#3,d1
0088D482 D241                       		add.w	d1,d1
0088D484 D041                       		add.w	d1,d0
0088D486 303B 0000                  		move.w	LevelOrder(pc,d0.w),d0 ; load level from level order array
0088D48A 31C0 FE10                  		move.w	d0,(v_zone).w	; set level number
0088D48E 4A40                       		tst.w	d0
0088D490 6600                       		bne.s	Got_ChkSS
0088D492 11FC 0000 F600             		move.b	#id_Sega,(v_gamemode).w
0088D498 6000                       		bra.s	Got_Display2
0088D49A                            ; ===========================================================================
0088D49A                            
0088D49A                            Got_ChkSS:				; XREF: Got_NextLevel
0088D49A 4238 FE30                  		clr.b	(v_lastlamp).w	; clear	lamppost counter
0088D49E 4A38 F7CD                  		tst.b	(f_bigring).w	; has Sonic jumped into	a giant	ring?
0088D4A2 6700                       		beq.s	VBla_08A	; if not, branch
0088D4A4 11FC 0000 F600             		move.b	#id_Special,(v_gamemode).w ; set game mode to Special Stage (10)
0088D4AA 6000                       		bra.s	Got_Display2
0088D4AC                            ; ===========================================================================
0088D4AC                            
0088D4AC                            VBla_08A:				; XREF: Got_ChkSS
0088D4AC 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart level
0088D4B2                            
0088D4B2                            Got_Display2:				; XREF: Got_NextLevel, Got_ChkSS
0088D4B2 6000 0000                  		bra.w	DisplaySprite
0088D4B6                            ; ===========================================================================
0088D4B6                            ; ---------------------------------------------------------------------------
0088D4B6                            ; Level	order array
0088D4B6                            ; ---------------------------------------------------------------------------
0088D4B6                            LevelOrder:	incbin	"misc\Level Order.bin"
0088D4E6                            		even
0088D4E6                            ; ===========================================================================
0088D4E6                            
0088D4E6                            Got_Move2:	; Routine $E
0088D4E6 7220                       		moveq	#$20,d1		; set horizontal speed
0088D4E8 3028 0032                  		move.w	got_finalX(a0),d0
0088D4EC B068 0008                  		cmp.w	obX(a0),d0	; has item reached its finish position?
0088D4F0 6700                       		beq.s	Got_SBZ2	; if yes, branch
0088D4F2 6C00                       		bge.s	Got_ChgPos2
0088D4F4 4441                       		neg.w	d1
0088D4F6                            
0088D4F6                            	Got_ChgPos2:
0088D4F6 D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D4FA 3028 0008                  		move.w	obX(a0),d0
0088D4FE 6B00                       		bmi.s	locret_C748
0088D500 0C40 0200                  		cmpi.w	#$200,d0	; has item moved beyond	$200 on	x-axis?
0088D504 6400                       		bcc.s	locret_C748	; if yes, branch
0088D506 6000 0000                  		bra.w	DisplaySprite
0088D50A                            ; ===========================================================================
0088D50A                            
0088D50A                            locret_C748:
0088D50A 4E75                       		rts	
0088D50C                            ; ===========================================================================
0088D50C                            
0088D50C                            Got_SBZ2:				; XREF: Got_Move2
0088D50C 0C28 0004 001A             		cmpi.b	#4,obFrame(a0)
0088D512 6600 0000                  		bne.w	DeleteObject
0088D516 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D51A 4238 F7CC                  		clr.b	(f_lockctrl).w	; unlock controls
0088D528                            ; ===========================================================================
0088D528                            
0088D528                            loc_C766:	; Routine $10
0088D528 5478 F72A                  		addq.w	#2,(v_limitright2).w
0088D52C 0C78 2100 F72A             		cmpi.w	#$2100,(v_limitright2).w
0088D532 6700 0000                  		beq.w	DeleteObject
0088D536 4E75                       		rts	
0088D538                            ; ===========================================================================
0088D538                            		;    x-start,	x-main,	y-main,
0088D538                            		;				routine, frame number
0088D538                            
0088D538 0004 0124 00BC             Got_Config:	dc.w 4,		$124,	$BC			; "SONIC HAS"
0088D53E 0200                       		dc.b 				2,	0
0088D540                            
0088D540 FEE0 0120 00D0             		dc.w -$120,	$120,	$D0			; "PASSED"
0088D546 0201                       		dc.b 				2,	1
0088D548                            
0088D548 040C 014C 00D6             		dc.w $40C,	$14C,	$D6			; "ACT" 1/2/3
0088D54E 0206                       		dc.b 				2,	6
0088D550                            
0088D550 0520 0120 00EC             		dc.w $520,	$120,	$EC			; score
0088D556 0202                       		dc.b 				2,	2
0088D558                            
0088D558 0540 0120 00FC             		dc.w $540,	$120,	$FC			; time bonus
0088D55E 0203                       		dc.b 				2,	3
0088D560                            
0088D560 0560 0120 010C             		dc.w $560,	$120,	$10C			; ring bonus
0088D566 0204                       		dc.b 				2,	4
0088D568                            
0088D568 020C 014C 00CC             		dc.w $20C,	$14C,	$CC			; oval
0088D56E 0205                       		dc.b 				2,	5
0088D56E 0205                       		dc.b 				2,	5
0088D570                            		include	"_incObj\7E Special Stage Results.asm"
0088D570                            ; ---------------------------------------------------------------------------
0088D570                            ; Object 7E - special stage results screen
0088D570                            ; ---------------------------------------------------------------------------
0088D570                            
0088D570                            SSResult:				; XREF: Obj_Index
0088D570 7000                       		moveq	#0,d0
0088D572 1028 0024                  		move.b	obRoutine(a0),d0
0088D576 323B 0000                  		move.w	SSR_Index(pc,d0.w),d1
0088D57A 4EFB 1000                  		jmp	SSR_Index(pc,d1.w)
0088D57E                            ; ===========================================================================
0088D57E 0000                       SSR_Index:	dc.w SSR_ChkPLC-SSR_Index
0088D580 0000                       		dc.w SSR_Move-SSR_Index
0088D582 0000                       		dc.w SSR_Wait-SSR_Index
0088D584 0000                       		dc.w SSR_RingBonus-SSR_Index
0088D586 0000                       		dc.w SSR_Wait-SSR_Index
0088D588 0000                       		dc.w SSR_Exit-SSR_Index
0088D58A 0000                       		dc.w SSR_Wait-SSR_Index
0088D58C 0000                       		dc.w SSR_Continue-SSR_Index
0088D58E 0000                       		dc.w SSR_Wait-SSR_Index
0088D590 0000                       		dc.w SSR_Exit-SSR_Index
0088D592 0000                       		dc.w loc_C91A-SSR_Index
0088D594                            
0088D594 =00000030                  ssr_mainX:	= $30		; position for card to display on
0088D594                            ; ===========================================================================
0088D594                            
0088D594                            SSR_ChkPLC:	; Routine 0
0088D594 4AB8 F680                  		tst.l	(v_plc_buffer).w ; are the pattern load cues empty?
0088D598 6700                       		beq.s	SSR_Main	; if yes, branch
0088D59A 4E75                       		rts	
0088D59C                            ; ===========================================================================
0088D59C                            
0088D59C                            SSR_Main:
0088D59C 2248                       		movea.l	a0,a1
0088D59E 45F9 0000 0000             		lea	(SSR_Config).l,a2
0088D5A4 7203                       		moveq	#3,d1
0088D5A6                            		
0088D5A6 0838 0007 FE18             		btst	#7,(v_continues).w
0088D5AC 6700                       		beq.s	SSR_Loop	; if no, branch
0088D5AE                            		
0088D5AE 5241                       		addq.w	#1,d1		; if yes, add 1	to d1 (number of sprites)
0088D5B0                            
0088D5B0                            	SSR_Loop:
0088D5B0 137C 0000 0000             		move.b	#id_SSResult,0(a1)
0088D5B6 335A 0008                  		move.w	(a2)+,obX(a1)	; load start x-position
0088D5BA 335A 0030                  		move.w	(a2)+,ssr_mainX(a1) ; load main x-position
0088D5BE 335A 000A                  		move.w	(a2)+,obScreenY(a1) ; load y-position
0088D5C2 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0088D5C6 135A 001A                  		move.b	(a2)+,obFrame(a1)
0088D5CA 237C 0000 0000 0004        		move.l	#Map_SSR,obMap(a1)
0088D5D2 337C 8580 0002             		move.w	#$8580,obGfx(a1)
0088D5D8 137C 0000 0001             		move.b	#0,obRender(a1)
0088D5DE 43E9 0040                  		lea	$40(a1),a1
0088D5E2 51C9 FFCC                  		dbf	d1,SSR_Loop	; repeat sequence 3 or 4 times
0088D5E6                            
0088D5E6 7007                       		moveq	#7,d0
0088D5E8 1238 FE57                  		move.b	(v_emeralds).w,d1
0088D5EC 6700                       		beq.s	loc_C842
0088D5EE 7000                       		moveq	#0,d0
0088D5F0 0C01 0006                  		cmpi.b	#6,d1		; do you have all chaos	emeralds?
0088D5F4 6600                       		bne.s	loc_C842	; if not, branch
0088D5F6 7008                       		moveq	#8,d0		; load "Sonic got them all" text
0088D5F8 317C 0018 0008             		move.w	#$18,obX(a0)
0088D5FE 317C 0118 0030             		move.w	#$118,ssr_mainX(a0) ; change position of text
0088D604                            
0088D604                            loc_C842:
0088D604 1140 001A                  		move.b	d0,obFrame(a0)
0088D608                            
0088D608                            SSR_Move:	; Routine 2
0088D608 7210                       		moveq	#$10,d1		; set horizontal speed
0088D60A 3028 0030                  		move.w	ssr_mainX(a0),d0
0088D60E B068 0008                  		cmp.w	obX(a0),d0	; has item reached its target position?
0088D612 6700                       		beq.s	loc_C86C	; if yes, branch
0088D614 6C00                       		bge.s	SSR_ChgPos
0088D616 4441                       		neg.w	d1
0088D618                            
0088D618                            SSR_ChgPos:
0088D618 D368 0008                  		add.w	d1,obX(a0)	; change item's position
0088D61C                            
0088D61C                            loc_C85A:				; XREF: loc_C86C
0088D61C 3028 0008                  		move.w	obX(a0),d0
0088D620 6B00                       		bmi.s	locret_C86A
0088D622 0C40 0200                  		cmpi.w	#$200,d0	; has item moved beyond	$200 on	x-axis?
0088D626 6400                       		bcc.s	locret_C86A	; if yes, branch
0088D628 6000 0000                  		bra.w	DisplaySprite
0088D62C                            ; ===========================================================================
0088D62C                            
0088D62C                            locret_C86A:
0088D62C 4E75                       		rts	
0088D62E                            ; ===========================================================================
0088D62E                            
0088D62E                            loc_C86C:				; XREF: SSR_Move
0088D62E 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
0088D634 66E6                       		bne.s	loc_C85A
0088D636 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D63A 317C 00B4 001E             		move.w	#180,obTimeFrame(a0) ; set time delay to 3 seconds
0088D640 11FC 0000 D800             		move.b	#id_SSRChaos,(v_objspace+$800).w ; load chaos emerald object
0088D646                            
0088D646                            SSR_Wait:	; Routine 4, 8, $C, $10
0088D646 5368 001E                  		subq.w	#1,obTimeFrame(a0) ; subtract 1 from time delay
0088D64A 6600                       		bne.s	SSR_Display
0088D64C 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D650                            
0088D650                            SSR_Display:
0088D650 6000 0000                  		bra.w	DisplaySprite
0088D654                            ; ===========================================================================
0088D654                            
0088D654                            SSR_RingBonus:	; Routine 6
0088D654 6100 0000                  		bsr.w	DisplaySprite
0088D658 11FC 0001 F7D6             		move.b	#1,(f_endactbonus).w ; set ring bonus update flag
0088D65E 4A78 F7D4                  		tst.w	(v_ringbonus).w	; is ring bonus	= zero?
0088D662 6700                       		beq.s	loc_C8C4	; if yes, branch
0088D664                            		
0088D664 123C 000A                  		move.b	#10,d1	; set score decrement to 10
0088D668 1038 F604                  		move.b	(v_jpadhold1).w,d0
0088D66C 0200 0070                  		andi.b	#btnABC,d0	; is A, B or C pressed?
0088D670 6700 0000                  		beq.w	@dontspeedup	; if not, branch
0088D674 123C 0064                  		move.b	#100,d1	; increase score decrement to 100
0088D678                            		
0088D678                            	@dontspeedup:
0088D678 7000                       		moveq	#0,d0
0088D67A B278 F7D4                  		cmp.w	(v_ringbonus).w,d1	; compare ring bonus to score decrement
0088D67E 6D00                       		blt.s	@skip	; if it's greater or equal, branch
0088D680 3238 F7D4                  		move.w	(v_ringbonus).w,d1	; else, set the decrement to the remaining bonus
0088D684                            	@skip:
0088D684 D041                       		add.w	d1,d0		; add decrement to score
0088D686 9378 F7D4                  		sub.w	d1,(v_ringbonus).w ; subtract decrement from ring bonus
0088D68A                            		
0088D68A 4EB9 0000 0000             		jsr	AddPoints
0088D690 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088D694 0200 0003                  		andi.b	#3,d0
0088D698 6600                       		bne.s	locret_C8EA
0088D6A4                            ; ===========================================================================
0088D6A4                            
0088D6A4                            loc_C8C4:
0088D6AE 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D6B2 317C 00B4 001E             		move.w	#180,obTimeFrame(a0) ; set time delay to 3 seconds
0088D6B8                            		
0088D6B8 0838 0007 FE18             		btst	#7,(v_continues).w
0088D6BE 6700                       		beq.s	locret_C8EA	; if not, branch
0088D6C0 08B8 0007 FE18             		bclr	#7,(v_continues).w
0088D6C6                            
0088D6C6 317C 003C 001E             		move.w	#60,obTimeFrame(a0) ; set time delay to 1 second
0088D6CC 5828 0024                  		addq.b	#4,obRoutine(a0) ; goto "SSR_Continue" routine
0088D6D0                            
0088D6D0                            locret_C8EA:
0088D6D0 4E75                       		rts	
0088D6D2                            ; ===========================================================================
0088D6D2                            
0088D6D2                            SSR_Exit:	; Routine $A, $12
0088D6D2 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart level
0088D6D8 6000 0000                  		bra.w	DisplaySprite
0088D6DC                            ; ===========================================================================
0088D6DC                            
0088D6DC                            SSR_Continue:	; Routine $E
0088D6DC 11FC 0004 D6DA             		move.b	#4,(v_objspace+$6C0+obFrame).w
0088D6E2 11FC 0014 D6E4             		move.b	#$14,(v_objspace+$6C0+obRoutine).w
0088D6F2 5428 0024                  		addq.b	#2,obRoutine(a0)
0088D6F6 317C 0168 001E             		move.w	#360,obTimeFrame(a0) ; set time delay to 6 seconds
0088D6FC 6000 0000                  		bra.w	DisplaySprite
0088D700                            ; ===========================================================================
0088D700                            
0088D700                            loc_C91A:	; Routine $14
0088D700 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
0088D704 0200 000F                  		andi.b	#$F,d0
0088D708 6600                       		bne.s	SSR_Display2
0088D70A 0868 0000 001A             		bchg	#0,obFrame(a0)
0088D710                            
0088D710                            SSR_Display2:
0088D710 6000 0000                  		bra.w	DisplaySprite
0088D714                            ; ===========================================================================
0088D714 0020 0120 00C4             SSR_Config:	dc.w $20, $120,	$C4	; start	x-pos, main x-pos, y-pos
0088D71A 0200                       		dc.b 2,	0		; rountine number, frame number
0088D71C 0320 0120 0118             		dc.w $320, $120, $118
0088D722 0201                       		dc.b 2,	1
0088D724 0360 0120 0128             		dc.w $360, $120, $128
0088D72A 0202                       		dc.b 2,	2
0088D72C 01EC 011C 00C4             		dc.w $1EC, $11C, $C4
0088D732 0203                       		dc.b 2,	3
0088D734 03A0 0120 0138             		dc.w $3A0, $120, $138
0088D73A 0206                       		dc.b 2,	6
0088D73A 0206                       		dc.b 2,	6
0088D73C                            		include	"_incObj\7F SS Result Chaos Emeralds.asm"
0088D73C                            ; ---------------------------------------------------------------------------
0088D73C                            ; Object 7F - chaos emeralds from the special stage results screen
0088D73C                            ; ---------------------------------------------------------------------------
0088D73C                            
0088D73C                            SSRChaos:				; XREF: Obj_Index
0088D73C 7000                       		moveq	#0,d0
0088D73E 1028 0024                  		move.b	obRoutine(a0),d0
0088D742 323B 0000                  		move.w	SSRC_Index(pc,d0.w),d1
0088D746 4EFB 1000                  		jmp	SSRC_Index(pc,d1.w)
0088D74A                            ; ===========================================================================
0088D74A 0000                       SSRC_Index:	dc.w SSRC_Main-SSRC_Index
0088D74C 0000                       		dc.w SSRC_Flash-SSRC_Index
0088D74E                            
0088D74E                            ; ---------------------------------------------------------------------------
0088D74E                            ; X-axis positions for chaos emeralds
0088D74E                            ; ---------------------------------------------------------------------------
0088D74E 0110 0128 00F8 0140 00E0+  SSRC_PosData:	dc.w $110, $128, $F8, $140, $E0, $158
0088D75A                            ; ===========================================================================
0088D75A                            
0088D75A                            SSRC_Main:	; Routine 0
0088D75A 2248                       		movea.l	a0,a1
0088D75C 45F9 0088 D74E             		lea	(SSRC_PosData).l,a2
0088D762 7400                       		moveq	#0,d2
0088D764 7200                       		moveq	#0,d1
0088D766 1238 FE57                  		move.b	(v_emeralds).w,d1 ; d1 is number of emeralds
0088D76A 5301                       		subq.b	#1,d1		; subtract 1 from d1
0088D76C 6500 0000                  		bcs.w	DeleteObject	; if you have 0	emeralds, branch
0088D770                            
0088D770                            	SSRC_Loop:
0088D770 137C 0000 0000             		move.b	#id_SSRChaos,0(a1)
0088D776 335A 0008                  		move.w	(a2)+,obX(a1)	; set x-position
0088D77A 337C 00F0 000A             		move.w	#$F0,obScreenY(a1) ; set y-position
0088D780 47F8 FE58                  		lea	(v_emldlist).w,a3 ; check which emeralds you have
0088D784 1633 2000                  		move.b	(a3,d2.w),d3
0088D788 1343 001A                  		move.b	d3,obFrame(a1)
0088D78C 1343 001C                  		move.b	d3,obAnim(a1)
0088D790 5202                       		addq.b	#1,d2
0088D792 5429 0024                  		addq.b	#2,obRoutine(a1)
0088D796 237C 0000 0000 0004        		move.l	#Map_SSRC,obMap(a1)
0088D79E 337C 8541 0002             		move.w	#$8541,obGfx(a1)
0088D7A4 137C 0000 0001             		move.b	#0,obRender(a1)
0088D7AA 43E9 0040                  		lea	$40(a1),a1	; next object
0088D7AE 51C9 FFC0                  		dbf	d1,SSRC_Loop	; loop for d1 number of	emeralds
0088D7B2                            
0088D7B2                            SSRC_Flash:	; Routine 2
0088D7B2 1028 001A                  		move.b	obFrame(a0),d0
0088D7B6 117C 0006 001A             		move.b	#6,obFrame(a0)	; load 6th frame (blank)
0088D7BC 0C00 0006                  		cmpi.b	#6,d0
0088D7C0 6600                       		bne.s	SSRC_Display
0088D7C2 1168 001C 001A             		move.b	obAnim(a0),obFrame(a0) ; load visible frame
0088D7C8                            
0088D7C8                            	SSRC_Display:
0088D7C8 6000 0000                  		bra.w	DisplaySprite
0088D7C8 6000 0000                  		bra.w	DisplaySprite
0088D7CC                            
0088D7CC                            ; ---------------------------------------------------------------------------
0088D7CC                            ; Sprite mappings - zone title cards
0088D7CC                            ; ---------------------------------------------------------------------------
0088D7CC 0000                       Map_Card:	dc.w M_Card_GHZ-Map_Card
0088D7CE 0000                       		dc.w M_Card_LZ-Map_Card
0088D7D0 0000                       		dc.w M_Card_MZ-Map_Card
0088D7D2 0000                       		dc.w M_Card_SLZ-Map_Card
0088D7D4 0000                       		dc.w M_Card_SYZ-Map_Card
0088D7D6 0000                       		dc.w M_Card_SBZ-Map_Card
0088D7D8 0000                       		dc.w M_Card_Zone-Map_Card
0088D7DA 0000                       		dc.w M_Card_Act1-Map_Card
0088D7DC 0000                       		dc.w M_Card_Act2-Map_Card
0088D7DE 0000                       		dc.w M_Card_Act3-Map_Card
0088D7E0 0000                       		dc.w M_Card_Oval-Map_Card
0088D7E2 0000                       		dc.w M_Card_FZ-Map_Card
0088D7E4 09                         M_Card_GHZ:	dc.b 9 			; GREEN HILL
0088D7E5 F805 0018 B4               		dc.b $F8, 5, 0,	$18, $B4
0088D7EA F805 003A C4               		dc.b $F8, 5, 0,	$3A, $C4
0088D7EF F805 0010 D4               		dc.b $F8, 5, 0,	$10, $D4
0088D7F4 F805 0010 E4               		dc.b $F8, 5, 0,	$10, $E4
0088D7F9 F805 002E F4               		dc.b $F8, 5, 0,	$2E, $F4
0088D7FE F805 001C 14               		dc.b $F8, 5, 0,	$1C, $14
0088D803 F801 0020 24               		dc.b $F8, 1, 0,	$20, $24
0088D808 F805 0026 2C               		dc.b $F8, 5, 0,	$26, $2C
0088D80D F805 0026 3C               		dc.b $F8, 5, 0,	$26, $3C
0088D812                            		even
0088D812 09                         M_Card_LZ:	dc.b 9			; LABYRINTH
0088D813 F805 0026 BC               		dc.b $F8, 5, 0,	$26, $BC
0088D818 F805 0000 CC               		dc.b $F8, 5, 0,	0, $CC
0088D81D F805 0004 DC               		dc.b $F8, 5, 0,	4, $DC
0088D822 F805 004A EC               		dc.b $F8, 5, 0,	$4A, $EC
0088D827 F805 003A FC               		dc.b $F8, 5, 0,	$3A, $FC
0088D82C F801 0020 0C               		dc.b $F8, 1, 0,	$20, $C
0088D831 F805 002E 14               		dc.b $F8, 5, 0,	$2E, $14
0088D836 F805 0042 24               		dc.b $F8, 5, 0,	$42, $24
0088D83B F805 001C 34               		dc.b $F8, 5, 0,	$1C, $34
0088D840                            		even
0088D840 06                         M_Card_MZ:	dc.b 6			; MARBLE
0088D841 F805 002A CF               		dc.b $F8, 5, 0,	$2A, $CF
0088D846 F805 0000 E0               		dc.b $F8, 5, 0,	0, $E0
0088D84B F805 003A F0               		dc.b $F8, 5, 0,	$3A, $F0
0088D850 F805 0004 00               		dc.b $F8, 5, 0,	4, 0
0088D855 F805 0026 10               		dc.b $F8, 5, 0,	$26, $10
0088D85A F805 0010 20               		dc.b $F8, 5, 0,	$10, $20
0088D860 00                         		even
0088D860 09                         M_Card_SLZ:	dc.b 9			; STAR LIGHT
0088D861 F805 003E B4               		dc.b $F8, 5, 0,	$3E, $B4
0088D866 F805 0042 C4               		dc.b $F8, 5, 0,	$42, $C4
0088D86B F805 0000 D4               		dc.b $F8, 5, 0,	0, $D4
0088D870 F805 003A E4               		dc.b $F8, 5, 0,	$3A, $E4
0088D875 F805 0026 04               		dc.b $F8, 5, 0,	$26, 4
0088D87A F801 0020 14               		dc.b $F8, 1, 0,	$20, $14
0088D87F F805 0018 1C               		dc.b $F8, 5, 0,	$18, $1C
0088D884 F805 001C 2C               		dc.b $F8, 5, 0,	$1C, $2C
0088D889 F805 0042 3C               		dc.b $F8, 5, 0,	$42, $3C
0088D88E                            		even
0088D88E 0A                         M_Card_SYZ:	dc.b $A			; SPRING YARD
0088D88F F805 003E AC               		dc.b $F8, 5, 0,	$3E, $AC
0088D894 F805 0036 BC               		dc.b $F8, 5, 0,	$36, $BC
0088D899 F805 003A CC               		dc.b $F8, 5, 0,	$3A, $CC
0088D89E F801 0020 DC               		dc.b $F8, 1, 0,	$20, $DC
0088D8A3 F805 002E E4               		dc.b $F8, 5, 0,	$2E, $E4
0088D8A8 F805 0018 F4               		dc.b $F8, 5, 0,	$18, $F4
0088D8AD F805 004A 14               		dc.b $F8, 5, 0,	$4A, $14
0088D8B2 F805 0000 24               		dc.b $F8, 5, 0,	0, $24
0088D8B7 F805 003A 34               		dc.b $F8, 5, 0,	$3A, $34
0088D8BC F805 000C 44               		dc.b $F8, 5, 0,	$C, $44
0088D8C2 00                         		even
0088D8C2 0A                         M_Card_SBZ:	dc.b $A			; SCRAP BRAIN
0088D8C3 F805 003E AC               		dc.b $F8, 5, 0,	$3E, $AC
0088D8C8 F805 0008 BC               		dc.b $F8, 5, 0,	8, $BC
0088D8CD F805 003A CC               		dc.b $F8, 5, 0,	$3A, $CC
0088D8D2 F805 0000 DC               		dc.b $F8, 5, 0,	0, $DC
0088D8D7 F805 0036 EC               		dc.b $F8, 5, 0,	$36, $EC
0088D8DC F805 0004 0C               		dc.b $F8, 5, 0,	4, $C
0088D8E1 F805 003A 1C               		dc.b $F8, 5, 0,	$3A, $1C
0088D8E6 F805 0000 2C               		dc.b $F8, 5, 0,	0, $2C
0088D8EB F801 0020 3C               		dc.b $F8, 1, 0,	$20, $3C
0088D8F0 F805 002E 44               		dc.b $F8, 5, 0,	$2E, $44
0088D8F6 00                         		even
0088D8F6 04                         M_Card_Zone:	dc.b 4			; ZONE
0088D8F7 F805 004E E0               		dc.b $F8, 5, 0,	$4E, $E0
0088D8FC F805 0032 F0               		dc.b $F8, 5, 0,	$32, $F0
0088D901 F805 002E 00               		dc.b $F8, 5, 0,	$2E, 0
0088D906 F805 0010 10               		dc.b $F8, 5, 0,	$10, $10
0088D90C 00                         		even
0088D90C 02                         M_Card_Act1:	dc.b 2			; ACT 1
0088D90D 040C 0053 EC               		dc.b 4,	$C, 0, $53, $EC
0088D912 F402 0057 0C               		dc.b $F4, 2, 0,	$57, $C
0088D917 02                         M_Card_Act2:	dc.b 2			; ACT 2
0088D918 040C 0053 EC               		dc.b 4,	$C, 0, $53, $EC
0088D91D F406 005A 08               		dc.b $F4, 6, 0,	$5A, 8
0088D922 02                         M_Card_Act3:	dc.b 2			; ACT 3
0088D923 040C 0053 EC               		dc.b 4,	$C, 0, $53, $EC
0088D928 F406 0060 08               		dc.b $F4, 6, 0,	$60, 8
0088D92D 0D                         M_Card_Oval:	dc.b $D			; Oval
0088D92E E40C 0070 F4               		dc.b $E4, $C, 0, $70, $F4
0088D933 E402 0074 14               		dc.b $E4, 2, 0,	$74, $14
0088D938 EC04 0077 EC               		dc.b $EC, 4, 0,	$77, $EC
0088D93D F405 0079 E4               		dc.b $F4, 5, 0,	$79, $E4
0088D942 140C 1870 EC               		dc.b $14, $C, $18, $70,	$EC
0088D947 0402 1874 E4               		dc.b 4,	2, $18,	$74, $E4
0088D94C 0C04 1877 04               		dc.b $C, 4, $18, $77, 4
0088D951 FC05 1879 0C               		dc.b $FC, 5, $18, $79, $C
0088D956 EC08 007D FC               		dc.b $EC, 8, 0,	$7D, $FC
0088D95B F40C 007C F4               		dc.b $F4, $C, 0, $7C, $F4
0088D960 FC08 007C F4               		dc.b $FC, 8, 0,	$7C, $F4
0088D965 040C 007C EC               		dc.b 4,	$C, 0, $7C, $EC
0088D96A 0C08 007C EC               		dc.b $C, 8, 0, $7C, $EC
0088D970 00                         		even
0088D970 05                         M_Card_FZ:	dc.b 5			; FINAL
0088D971 F805 0014 DC               		dc.b $F8, 5, 0,	$14, $DC
0088D976 F801 0020 EC               		dc.b $F8, 1, 0,	$20, $EC
0088D97B F805 002E F4               		dc.b $F8, 5, 0,	$2E, $F4
0088D980 F805 0000 04               		dc.b $F8, 5, 0,	0, 4
0088D985 F805 0026 14               		dc.b $F8, 5, 0,	$26, $14
0088D98A                            		even
0088D98A                            
0088D98A                            		include	"_maps\Game Over.asm"
0088D98A                            ; ---------------------------------------------------------------------------
0088D98A                            ; Sprite mappings - "GAME OVER"	and "TIME OVER"
0088D98A                            ; ---------------------------------------------------------------------------
0088D98A 0000                       Map_Over:	dc.w byte_CBAC-Map_Over
0088D98C 0000                       		dc.w byte_CBB7-Map_Over
0088D98E 0000                       		dc.w byte_CBC2-Map_Over
0088D990 0000                       		dc.w byte_CBCD-Map_Over
0088D992 02                         byte_CBAC:	dc.b 2			; GAME
0088D993 F80D 0000 B8               		dc.b $F8, $D, 0, 0, $B8
0088D998 F80D 0008 D8               		dc.b $F8, $D, 0, 8, $D8
0088D99D 02                         byte_CBB7:	dc.b 2			; OVER
0088D99E F80D 0014 08               		dc.b $F8, $D, 0, $14, 8
0088D9A3 F80D 000C 28               		dc.b $F8, $D, 0, $C, $28
0088D9A8 02                         byte_CBC2:	dc.b 2			; TIME
0088D9A9 F809 001C C4               		dc.b $F8, 9, 0,	$1C, $C4
0088D9AE F80D 0008 DC               		dc.b $F8, $D, 0, 8, $DC
0088D9B3 02                         byte_CBCD:	dc.b 2			; OVER
0088D9B4 F80D 0014 0C               		dc.b $F8, $D, 0, $14, $C
0088D9B9 F80D 000C 2C               		dc.b $F8, $D, 0, $C, $2C
0088D9BE                            		even
0088D9BE                            		even
0088D9BE                            
0088D9BE                            ; ---------------------------------------------------------------------------
0088D9BE                            ; Sprite mappings - "SONIC HAS PASSED" title card
0088D9BE                            ; ---------------------------------------------------------------------------
0088D9BE 0000                       Map_Got:	dc.w M_Got_SonicHas-Map_Got
0088D9C0 0000                       		dc.w M_Got_Passed-Map_Got
0088D9C2 0000                       		dc.w M_Got_Score-Map_Got
0088D9C4 0000                       		dc.w M_Got_TBonus-Map_Got
0088D9C6 0000                       		dc.w M_Got_RBonus-Map_Got
0088D9C8 FF6F                       		dc.w M_Card_Oval-Map_Got
0088D9CA FF4E                       		dc.w M_Card_Act1-Map_Got
0088D9CC FF59                       		dc.w M_Card_Act2-Map_Got
0088D9CE FF64                       		dc.w M_Card_Act3-Map_Got
0088D9D0 08                         M_Got_SonicHas:	dc.b 8			; SONIC HAS
0088D9D1 F805 003E B8               		dc.b $F8, 5, 0,	$3E, $B8
0088D9D6 F805 0032 C8               		dc.b $F8, 5, 0,	$32, $C8
0088D9DB F805 002E D8               		dc.b $F8, 5, 0,	$2E, $D8
0088D9E0 F801 0020 E8               		dc.b $F8, 1, 0,	$20, $E8
0088D9E5 F805 0008 F0               		dc.b $F8, 5, 0,	8, $F0
0088D9EA F805 001C 10               		dc.b $F8, 5, 0,	$1C, $10
0088D9EF F805 0000 20               		dc.b $F8, 5, 0,	0, $20
0088D9F4 F805 003E 30               		dc.b $F8, 5, 0,	$3E, $30
0088D9F9 06                         M_Got_Passed:	dc.b 6			; PASSED
0088D9FA F805 0036 D0               		dc.b $F8, 5, 0,	$36, $D0
0088D9FF F805 0000 E0               		dc.b $F8, 5, 0,	0, $E0
0088DA04 F805 003E F0               		dc.b $F8, 5, 0,	$3E, $F0
0088DA09 F805 003E 00               		dc.b $F8, 5, 0,	$3E, 0
0088DA0E F805 0010 10               		dc.b $F8, 5, 0,	$10, $10
0088DA13 F805 000C 20               		dc.b $F8, 5, 0,	$C, $20
0088DA18 06                         M_Got_Score:	dc.b 6			; SCORE
0088DA19 F80D 014A B0               		dc.b $F8, $D, 1, $4A, $B0
0088DA1E F801 0162 D0               		dc.b $F8, 1, 1,	$62, $D0
0088DA23 F809 0164 18               		dc.b $F8, 9, 1,	$64, $18
0088DA28 F80D 016A 30               		dc.b $F8, $D, 1, $6A, $30
0088DA2D F704 006E CD               		dc.b $F7, 4, 0,	$6E, $CD
0088DA32 FF04 186E CD               		dc.b $FF, 4, $18, $6E, $CD
0088DA37 07                         M_Got_TBonus:	dc.b 7			; TIME BONUS
0088DA38 F80D 015A B0               		dc.b $F8, $D, 1, $5A, $B0
0088DA3D F80D 0066 D9               		dc.b $F8, $D, 0, $66, $D9
0088DA42 F801 014A F9               		dc.b $F8, 1, 1,	$4A, $F9
0088DA47 F704 006E F6               		dc.b $F7, 4, 0,	$6E, $F6
0088DA4C FF04 186E F6               		dc.b $FF, 4, $18, $6E, $F6
0088DA51 F80D FFF0 28               		dc.b $F8, $D, $FF, $F0,	$28
0088DA56 F801 0170 48               		dc.b $F8, 1, 1,	$70, $48
0088DA5B 07                         M_Got_RBonus:	dc.b 7			; RING BONUS
0088DA5C F80D 0152 B0               		dc.b $F8, $D, 1, $52, $B0
0088DA61 F80D 0066 D9               		dc.b $F8, $D, 0, $66, $D9
0088DA66 F801 014A F9               		dc.b $F8, 1, 1,	$4A, $F9
0088DA6B F704 006E F6               		dc.b $F7, 4, 0,	$6E, $F6
0088DA70 FF04 186E F6               		dc.b $FF, 4, $18, $6E, $F6
0088DA75 F80D FFF8 28               		dc.b $F8, $D, $FF, $F8,	$28
0088DA7A F801 0170 48               		dc.b $F8, 1, 1,	$70, $48
0088DA80 00                         		even
0088DA80                            ; ---------------------------------------------------------------------------
0088DA80                            ; Sprite mappings - special stage results screen
0088DA80                            ; ---------------------------------------------------------------------------
0088DA80 0000                       Map_SSR:	dc.w M_SSR_Chaos-Map_SSR
0088DA82 0000                       		dc.w M_SSR_Score-Map_SSR
0088DA84 0000                       		dc.w byte_CD0D-Map_SSR
0088DA86 FEAD                       		dc.w M_Card_Oval-Map_SSR
0088DA88 0000                       		dc.w byte_CD31-Map_SSR
0088DA8A 0000                       		dc.w byte_CD46-Map_SSR
0088DA8C 0000                       		dc.w byte_CD5B-Map_SSR
0088DA8E 0000                       		dc.w byte_CD6B-Map_SSR
0088DA90 0000                       		dc.w byte_CDA8-Map_SSR
0088DA92 0D                         M_SSR_Chaos:	dc.b $D			; "CHAOS EMERALDS"
0088DA93 F805 0008 90               		dc.b $F8, 5, 0,	8, $90
0088DA98 F805 001C A0               		dc.b $F8, 5, 0,	$1C, $A0
0088DA9D F805 0000 B0               		dc.b $F8, 5, 0,	0, $B0
0088DAA2 F805 0032 C0               		dc.b $F8, 5, 0,	$32, $C0
0088DAA7 F805 003E D0               		dc.b $F8, 5, 0,	$3E, $D0
0088DAAC F805 0010 F0               		dc.b $F8, 5, 0,	$10, $F0
0088DAB1 F805 002A 00               		dc.b $F8, 5, 0,	$2A, 0
0088DAB6 F805 0010 10               		dc.b $F8, 5, 0,	$10, $10
0088DABB F805 003A 20               		dc.b $F8, 5, 0,	$3A, $20
0088DAC0 F805 0000 30               		dc.b $F8, 5, 0,	0, $30
0088DAC5 F805 0026 40               		dc.b $F8, 5, 0,	$26, $40
0088DACA F805 000C 50               		dc.b $F8, 5, 0,	$C, $50
0088DACF F805 003E 60               		dc.b $F8, 5, 0,	$3E, $60
0088DAD4 06                         M_SSR_Score:	dc.b 6			; "SCORE"
0088DAD5 F80D 014A B0               		dc.b $F8, $D, 1, $4A, $B0
0088DADA F801 0162 D0               		dc.b $F8, 1, 1,	$62, $D0
0088DADF F809 0164 18               		dc.b $F8, 9, 1,	$64, $18
0088DAE4 F80D 016A 30               		dc.b $F8, $D, 1, $6A, $30
0088DAE9 F704 006E CD               		dc.b $F7, 4, 0,	$6E, $CD
0088DAEE FF04 186E CD               		dc.b $FF, 4, $18, $6E, $CD
0088DAF3 07                         byte_CD0D:	dc.b 7
0088DAF4 F80D 0152 B0               		dc.b $F8, $D, 1, $52, $B0
0088DAF9 F80D 0066 D9               		dc.b $F8, $D, 0, $66, $D9
0088DAFE F801 014A F9               		dc.b $F8, 1, 1,	$4A, $F9
0088DB03 F704 006E F6               		dc.b $F7, 4, 0,	$6E, $F6
0088DB08 FF04 186E F6               		dc.b $FF, 4, $18, $6E, $F6
0088DB0D F80D FFF8 28               		dc.b $F8, $D, $FF, $F8,	$28
0088DB12 F801 0170 48               		dc.b $F8, 1, 1,	$70, $48
0088DB17 04                         byte_CD31:	dc.b 4
0088DB18 F80D FFD1 B0               		dc.b $F8, $D, $FF, $D1,	$B0
0088DB1D F80D FFD9 D0               		dc.b $F8, $D, $FF, $D9,	$D0
0088DB22 F801 FFE1 F0               		dc.b $F8, 1, $FF, $E1, $F0
0088DB27 F806 1FE3 40               		dc.b $F8, 6, $1F, $E3, $40
0088DB2C 04                         byte_CD46:	dc.b 4
0088DB2D F80D FFD1 B0               		dc.b $F8, $D, $FF, $D1,	$B0
0088DB32 F80D FFD9 D0               		dc.b $F8, $D, $FF, $D9,	$D0
0088DB37 F801 FFE1 F0               		dc.b $F8, 1, $FF, $E1, $F0
0088DB3C F806 1FE9 40               		dc.b $F8, 6, $1F, $E9, $40
0088DB41 03                         byte_CD5B:	dc.b 3
0088DB42 F80D FFD1 B0               		dc.b $F8, $D, $FF, $D1,	$B0
0088DB47 F80D FFD9 D0               		dc.b $F8, $D, $FF, $D9,	$D0
0088DB4C F801 FFE1 F0               		dc.b $F8, 1, $FF, $E1, $F0
0088DB51 0C                         byte_CD6B:	dc.b $C			; "SPECIAL STAGE"
0088DB52 F805 003E 9C               		dc.b $F8, 5, 0,	$3E, $9C
0088DB57 F805 0036 AC               		dc.b $F8, 5, 0,	$36, $AC
0088DB5C F805 0010 BC               		dc.b $F8, 5, 0,	$10, $BC
0088DB61 F805 0008 CC               		dc.b $F8, 5, 0,	8, $CC
0088DB66 F801 0020 DC               		dc.b $F8, 1, 0,	$20, $DC
0088DB6B F805 0000 E4               		dc.b $F8, 5, 0,	0, $E4
0088DB70 F805 0026 F4               		dc.b $F8, 5, 0,	$26, $F4
0088DB75 F805 003E 14               		dc.b $F8, 5, 0,	$3E, $14
0088DB7A F805 0042 24               		dc.b $F8, 5, 0,	$42, $24
0088DB7F F805 0000 34               		dc.b $F8, 5, 0,	0, $34
0088DB84 F805 0018 44               		dc.b $F8, 5, 0,	$18, $44
0088DB89 F805 0010 54               		dc.b $F8, 5, 0,	$10, $54
0088DB8E 0F                         byte_CDA8:	dc.b $F			; "SONIC GOT THEM ALL"
0088DB8F F805 003E 88               		dc.b $F8, 5, 0,	$3E, $88
0088DB94 F805 0032 98               		dc.b $F8, 5, 0,	$32, $98
0088DB99 F805 002E A8               		dc.b $F8, 5, 0,	$2E, $A8
0088DB9E F801 0020 B8               		dc.b $F8, 1, 0,	$20, $B8
0088DBA3 F805 0008 C0               		dc.b $F8, 5, 0,	8, $C0
0088DBA8 F805 0018 D8               		dc.b $F8, 5, 0,	$18, $D8
0088DBAD F805 0032 E8               		dc.b $F8, 5, 0,	$32, $E8
0088DBB2 F805 0042 F8               		dc.b $F8, 5, 0,	$42, $F8
0088DBB7 F805 0042 10               		dc.b $F8, 5, 0,	$42, $10
0088DBBC F805 001C 20               		dc.b $F8, 5, 0,	$1C, $20
0088DBC1 F805 0010 30               		dc.b $F8, 5, 0,	$10, $30
0088DBC6 F805 002A 40               		dc.b $F8, 5, 0,	$2A, $40
0088DBCB F805 0000 58               		dc.b $F8, 5, 0,	0, $58
0088DBD0 F805 0026 68               		dc.b $F8, 5, 0,	$26, $68
0088DBD5 F805 0026 78               		dc.b $F8, 5, 0,	$26, $78
0088DBDA                            		even
0088DBDA                            
0088DBDA                            		include	"_maps\SS Result Chaos Emeralds.asm"
0088DBDA                            ; ---------------------------------------------------------------------------
0088DBDA                            ; Sprite mappings - chaos emeralds from	the special stage results screen
0088DBDA                            ; ---------------------------------------------------------------------------
0088DBDA 0000                       Map_SSRC:	dc.w byte_CE02-Map_SSRC
0088DBDC 0000                       		dc.w byte_CE08-Map_SSRC
0088DBDE 0000                       		dc.w byte_CE0E-Map_SSRC
0088DBE0 0000                       		dc.w byte_CE14-Map_SSRC
0088DBE2 0000                       		dc.w byte_CE1A-Map_SSRC
0088DBE4 0000                       		dc.w byte_CE20-Map_SSRC
0088DBE6 0000                       		dc.w byte_CE26-Map_SSRC
0088DBE8 01                         byte_CE02:	dc.b 1
0088DBE9 F805 2004 F8               		dc.b $F8, 5, $20, 4, $F8
0088DBEE 01                         byte_CE08:	dc.b 1
0088DBEF F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
0088DBF4 01                         byte_CE0E:	dc.b 1
0088DBF5 F805 4004 F8               		dc.b $F8, 5, $40, 4, $F8
0088DBFA 01                         byte_CE14:	dc.b 1
0088DBFB F805 6004 F8               		dc.b $F8, 5, $60, 4, $F8
0088DC00 01                         byte_CE1A:	dc.b 1
0088DC01 F805 2008 F8               		dc.b $F8, 5, $20, 8, $F8
0088DC06 01                         byte_CE20:	dc.b 1
0088DC07 F805 200C F8               		dc.b $F8, 5, $20, $C, $F8
0088DC0C 00                         byte_CE26:	dc.b 0			; Blank frame
0088DC0E 00                         		even
0088DC0E 00                         		even
0088DC0E                            
0088DC0E                            		include	"_incObj\36 Spikes.asm"
0088DC0E                            ; ---------------------------------------------------------------------------
0088DC0E                            ; Object 36 - spikes
0088DC0E                            ; ---------------------------------------------------------------------------
0088DC0E                            
0088DC0E                            Spikes:					; XREF: Obj_Index
0088DC0E 7000                       		moveq	#0,d0
0088DC10 1028 0024                  		move.b	obRoutine(a0),d0
0088DC14 323B 0000                  		move.w	Spik_Index(pc,d0.w),d1
0088DC18 4EFB 1000                  		jmp	Spik_Index(pc,d1.w)
0088DC1C                            ; ===========================================================================
0088DC1C 0000                       Spik_Index:	dc.w Spik_Main-Spik_Index
0088DC1E 0000                       		dc.w Spik_Solid-Spik_Index
0088DC20                            
0088DC20 =00000030                  spik_origX:	= $30		; start X position
0088DC20 =00000032                  spik_origY:	= $32		; start Y position
0088DC20                            
0088DC20 0014                       Spik_Var:	dc.b 0,	$14		; frame	number,	object width
0088DC22 0110                       		dc.b 1,	$10
0088DC24 0204                       		dc.b 2,	4
0088DC26 031C                       		dc.b 3,	$1C
0088DC28 0440                       		dc.b 4,	$40
0088DC2A 0510                       		dc.b 5,	$10
0088DC2C                            ; ===========================================================================
0088DC2C                            
0088DC2C                            Spik_Main:	; Routine 0
0088DC2C 5428 0024                  		addq.b	#2,obRoutine(a0)
0088DC30 217C 0000 0000 0004        		move.l	#Map_Spike,obMap(a0)
0088DC38 317C 051B 0002             		move.w	#$51B,obGfx(a0)
0088DC3E 0028 0004 0001             		ori.b	#4,obRender(a0)
0088DC44 117C 0004 0018             		move.b	#4,obPriority(a0)
0088DC4A 1028 0028                  		move.b	obSubtype(a0),d0
0088DC4E 0228 000F 0028             		andi.b	#$F,obSubtype(a0)
0088DC54 0240 00F0                  		andi.w	#$F0,d0
0088DC58 43F9 0088 DC20             		lea	(Spik_Var).l,a1
0088DC5E E648                       		lsr.w	#3,d0
0088DC60 D2C0                       		adda.w	d0,a1
0088DC62 1159 001A                  		move.b	(a1)+,obFrame(a0)
0088DC66 1159 0019                  		move.b	(a1)+,obActWid(a0)
0088DC6A 3168 0008 0030             		move.w	obX(a0),spik_origX(a0)
0088DC70 3168 000C 0032             		move.w	obY(a0),spik_origY(a0)
0088DC76                            
0088DC76                            Spik_Solid:	; Routine 2
0088DC76 6100 0000                  		bsr.w	Spik_Type0x	; make the object move
0088DC7A 343C 0004                  		move.w	#4,d2
0088DC7E 0C28 0005 001A             		cmpi.b	#5,obFrame(a0)	; is object type $5x ?
0088DC84 6700                       		beq.s	Spik_SideWays	; if yes, branch
0088DC86 0C28 0001 001A             		cmpi.b	#1,obFrame(a0)	; is object type $1x ?
0088DC8C 6600                       		bne.s	Spik_Upright	; if not, branch
0088DC8E 343C 0014                  		move.w	#$14,d2
0088DC92                            
0088DC92                            ; Spikes types $1x and $5x face	sideways
0088DC92                            
0088DC92                            Spik_SideWays:				; XREF: Spik_Solid
0088DC92 323C 001B                  		move.w	#$1B,d1
0088DC96 3602                       		move.w	d2,d3
0088DC98 5243                       		addq.w	#1,d3
0088DC9A 3828 0008                  		move.w	obX(a0),d4
0088DC9E 6100 0000                  		bsr.w	SolidObject
0088DCA2 0828 0003 0022             		btst	#3,obStatus(a0)
0088DCA8 6600                       		bne.s	Spik_Display
0088DCAA 0C44 0001                  		cmpi.w	#1,d4
0088DCAE 6700                       		beq.s	Spik_Hurt
0088DCB0 6000                       		bra.s	Spik_Display
0088DCB2                            ; ===========================================================================
0088DCB2                            
0088DCB2                            ; Spikes types $0x, $2x, $3x and $4x face up or	down
0088DCB2                            
0088DCB2                            Spik_Upright:				; XREF: Spik_Solid
0088DCB2 7200                       		moveq	#0,d1
0088DCB4 1228 0019                  		move.b	obActWid(a0),d1
0088DCB8 0641 000B                  		addi.w	#$B,d1
0088DCBC 343C 0010                  		move.w	#$10,d2
0088DCC0 363C 0011                  		move.w	#$11,d3
0088DCC4 3828 0008                  		move.w	obX(a0),d4
0088DCC8 6100 0000                  		bsr.w	SolidObject
0088DCCC 0828 0003 0022             		btst	#3,obStatus(a0)
0088DCD2 6600                       		bne.s	Spik_Hurt
0088DCD4 4A44                       		tst.w	d4
0088DCD6 6A00                       		bpl.s	Spik_Display
0088DCD8                            
0088DCD8                            Spik_Hurt:				; XREF: Spik_SideWays; Spik_Upright
0088DCD8 4A38 FE2D                  		tst.b	(v_invinc).w	; is Sonic invincible?
0088DCDC 6600                       		bne.s	Spik_Display	; if yes, branch
0088DCDE                            		
0088DCDE 4A78 D030                  		tst.w	(v_player+obInvuln).w ; +++ is Sonic invulnerable?	;Mercury Constants
0088DCE2 6600                       		bne.s	Spik_Display	; +++ if yes, branch
0088DCE4                            		
0088DCE4 2F08                       		move.l	a0,-(sp)
0088DCE6 2448                       		movea.l	a0,a2
0088DCE8 41F8 D000                  		lea	(v_player).w,a0
0088DCEC 0C28 0004 0024             		cmpi.b	#4,obRoutine(a0)
0088DCF2 6400                       		bcc.s	loc_CF20
0088DCF4 2628 000C                  		move.l	obY(a0),d3
0088DCF8 3028 0012                  		move.w	obVelY(a0),d0
0088DCFC 48C0                       		ext.l	d0
0088DCFE E180                       		asl.l	#8,d0
0088DD00 9680                       		sub.l	d0,d3
0088DD02 2143 000C                  		move.l	d3,obY(a0)
0088DD06 4EB9 0000 0000             		jsr	HurtSonic
0088DD0C                            
0088DD0C                            loc_CF20:
0088DD0C 205F                       		movea.l	(sp)+,a0
0088DD0E                            
0088DD0E                            Spik_Display:
0088DD0E 6100 0000                  		bsr.w	DisplaySprite
0088DD30 4E75                       		rts	
0088DD32                            ; ===========================================================================
0088DD32                            
0088DD32                            Spik_Type0x:				; XREF: Spik_Solid
0088DD32 7000                       		moveq	#0,d0
0088DD34 1028 0028                  		move.b	obSubtype(a0),d0
0088DD38 D040                       		add.w	d0,d0
0088DD3A 323B 0000                  		move.w	Spik_TypeIndex(pc,d0.w),d1
0088DD3E 4EFB 1000                  		jmp	Spik_TypeIndex(pc,d1.w)
0088DD42                            ; ===========================================================================
0088DD42 0000                       Spik_TypeIndex:	dc.w Spik_Type00-Spik_TypeIndex
0088DD44 0000                       		dc.w Spik_Type01-Spik_TypeIndex
0088DD46 0000                       		dc.w Spik_Type02-Spik_TypeIndex
0088DD48                            ; ===========================================================================
0088DD48                            
0088DD48                            Spik_Type00:				; XREF: Spik_TypeIndex
0088DD48 4E75                       		rts			; don't move the object
0088DD4A                            ; ===========================================================================
0088DD4A                            
0088DD4A                            Spik_Type01:				; XREF: Spik_TypeIndex
0088DD4A 6100 0000                  		bsr.w	Spik_Wait
0088DD4E 7000                       		moveq	#0,d0
0088DD50 1028 0034                  		move.b	$34(a0),d0
0088DD54 D068 0032                  		add.w	spik_origY(a0),d0
0088DD58 3140 000C                  		move.w	d0,obY(a0)	; move the object vertically
0088DD5C 4E75                       		rts	
0088DD5E                            ; ===========================================================================
0088DD5E                            
0088DD5E                            Spik_Type02:				; XREF: Spik_TypeIndex
0088DD5E 6100 0000                  		bsr.w	Spik_Wait
0088DD62 7000                       		moveq	#0,d0
0088DD64 1028 0034                  		move.b	$34(a0),d0
0088DD68 D068 0030                  		add.w	spik_origX(a0),d0
0088DD6C 3140 0008                  		move.w	d0,obX(a0)	; move the object horizontally
0088DD70 4E75                       		rts	
0088DD72                            ; ===========================================================================
0088DD72                            
0088DD72                            Spik_Wait:
0088DD72 4A68 0038                  		tst.w	$38(a0)		; is time delay	= zero?
0088DD76 6700                       		beq.s	loc_CFA4	; if yes, branch
0088DD78 5368 0038                  		subq.w	#1,$38(a0)	; subtract 1 from time delay
0088DD7C 6600                       		bne.s	locret_CFE6
0088DD7E 4A28 0001                  		tst.b	obRender(a0)
0088DD82 6A00                       		bpl.s	locret_CFE6
0088DD8E 6000                       		bra.s	locret_CFE6
0088DD90                            ; ===========================================================================
0088DD90                            
0088DD90                            loc_CFA4:
0088DD90 4A68 0036                  		tst.w	$36(a0)
0088DD94 6700                       		beq.s	loc_CFC6
0088DD96 0468 0800 0034             		subi.w	#$800,$34(a0)
0088DD9C 6400                       		bcc.s	locret_CFE6
0088DD9E 317C 0000 0034             		move.w	#0,$34(a0)
0088DDA4 317C 0000 0036             		move.w	#0,$36(a0)
0088DDAA 317C 003C 0038             		move.w	#60,$38(a0)	; set time delay to 1 second
0088DDB0 6000                       		bra.s	locret_CFE6
0088DDB2                            ; ===========================================================================
0088DDB2                            
0088DDB2                            loc_CFC6:
0088DDB2 0668 0800 0034             		addi.w	#$800,$34(a0)
0088DDB8 0C68 2000 0034             		cmpi.w	#$2000,$34(a0)
0088DDBE 6500                       		bcs.s	locret_CFE6
0088DDC0 317C 2000 0034             		move.w	#$2000,$34(a0)
0088DDC6 317C 0001 0036             		move.w	#1,$36(a0)
0088DDCC 317C 003C 0038             		move.w	#60,$38(a0)	; set time delay to 1 second
0088DDD2                            
0088DDD2                            locret_CFE6:
0088DDD2 4E75                       		rts	
0088DDD2 4E75                       		rts	
0088DDD4                            		include	"_maps\Spikes.asm"
0088DDD4                            ; ---------------------------------------------------------------------------
0088DDD4                            ; Sprite mappings - spikes
0088DDD4                            ; ---------------------------------------------------------------------------
0088DDD4 0000                       Map_Spike:	dc.w byte_CFF4-Map_Spike
0088DDD6 0000                       		dc.w byte_D004-Map_Spike
0088DDD8 0000                       		dc.w byte_D014-Map_Spike
0088DDDA 0000                       		dc.w byte_D01A-Map_Spike
0088DDDC 0000                       		dc.w byte_D02A-Map_Spike
0088DDDE 0000                       		dc.w byte_D049-Map_Spike
0088DDE0 03                         byte_CFF4:	dc.b 3			; 3 spikes
0088DDE1 F003 0004 EC               		dc.b $F0, 3, 0,	4, $EC
0088DDE6 F003 0004 FC               		dc.b $F0, 3, 0,	4, $FC
0088DDEB F003 0004 0C               		dc.b $F0, 3, 0,	4, $C
0088DDF0 03                         byte_D004:	dc.b 3			; 3 spikes facing sideways
0088DDF1 EC0C 0000 F0               		dc.b $EC, $C, 0, 0, $F0
0088DDF6 FC0C 0000 F0               		dc.b $FC, $C, 0, 0, $F0
0088DDFB 0C0C 0000 F0               		dc.b $C, $C, 0,	0, $F0
0088DE00 01                         byte_D014:	dc.b 1			; 1 spike
0088DE01 F003 0004 FC               		dc.b $F0, 3, 0,	4, $FC
0088DE06 03                         byte_D01A:	dc.b 3			; 3 spikes widely spaced
0088DE07 F003 0004 E4               		dc.b $F0, 3, 0,	4, $E4
0088DE0C F003 0004 FC               		dc.b $F0, 3, 0,	4, $FC
0088DE11 F003 0004 14               		dc.b $F0, 3, 0,	4, $14
0088DE16 06                         byte_D02A:	dc.b 6			; 6 spikes
0088DE17 F003 0004 C0               		dc.b $F0, 3, 0,	4, $C0
0088DE1C F003 0004 D8               		dc.b $F0, 3, 0,	4, $D8
0088DE21 F003 0004 F0               		dc.b $F0, 3, 0,	4, $F0
0088DE26 F003 0004 08               		dc.b $F0, 3, 0,	4, 8
0088DE2B F003 0004 20               		dc.b $F0, 3, 0,	4, $20
0088DE30 F003 0004 38               		dc.b $F0, 3, 0,	4, $38
0088DE35 01                         byte_D049:	dc.b 1			; 1 spike facing sideways
0088DE36 FC0C 0000 F0               		dc.b $FC, $C, 0, 0, $F0
0088DE3C 00                         		even
0088DE3C 00                         		even
0088DE3C                            		include	"_incObj\3B Purple Rock.asm"
0088DE3C                            ; ---------------------------------------------------------------------------
0088DE3C                            ; Object 3B - purple rock (GHZ)
0088DE3C                            ; ---------------------------------------------------------------------------
0088DE3C                            
0088DE3C                            PurpleRock:				; XREF: Obj_Index
0088DE3C 7000                       		moveq	#0,d0
0088DE3E 1028 0024                  		move.b	obRoutine(a0),d0
0088DE42 323B 0000                  		move.w	Rock_Index(pc,d0.w),d1
0088DE46 4EFB 1000                  		jmp	Rock_Index(pc,d1.w)
0088DE4A                            ; ===========================================================================
0088DE4A 0000                       Rock_Index:	dc.w Rock_Main-Rock_Index
0088DE4C 0000                       		dc.w Rock_Solid-Rock_Index
0088DE4E                            ; ===========================================================================
0088DE4E                            
0088DE4E                            Rock_Main:	; Routine 0
0088DE4E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088DE52 217C 0000 0000 0004        		move.l	#Map_PRock,obMap(a0)
0088DE5A 317C 63D0 0002             		move.w	#$63D0,obGfx(a0)
0088DE60 117C 0004 0001             		move.b	#4,obRender(a0)
0088DE66 117C 0013 0019             		move.b	#$13,obActWid(a0)
0088DE6C 117C 0004 0018             		move.b	#4,obPriority(a0)
0088DE72                            
0088DE72                            Rock_Solid:	; Routine 2
0088DE72 323C 001B                  		move.w	#$1B,d1
0088DE76 343C 0010                  		move.w	#$10,d2
0088DE7A 363C 0010                  		move.w	#$10,d3
0088DE7E 3828 0008                  		move.w	obX(a0),d4
0088DE82 6100 0000                  		bsr.w	SolidObject
0088DE86 6100 0000                  		bsr.w	DisplaySprite
0088DEA8 4E75                       		rts	
0088DEA8 4E75                       		rts	
0088DEAA                            		include	"_incObj\49 Waterfall Sound.asm"
0088DEAA                            ; ---------------------------------------------------------------------------
0088DEAA                            ; Object 49 - waterfall	sound effect (GHZ)
0088DEAA                            ; ---------------------------------------------------------------------------
0088DEAA                            
0088DEAA                            WaterSound:				; XREF: Obj_Index
0088DEAA 7000                       		moveq	#0,d0
0088DEAC 1028 0024                  		move.b	obRoutine(a0),d0
0088DEB0 323B 0000                  		move.w	WSnd_Index(pc,d0.w),d1
0088DEB4 4EFB 1000                  		jmp	WSnd_Index(pc,d1.w)
0088DEB8                            ; ===========================================================================
0088DEB8 0000                       WSnd_Index:	dc.w WSnd_Main-WSnd_Index
0088DEBA 0000                       		dc.w WSnd_PlaySnd-WSnd_Index
0088DEBC                            ; ===========================================================================
0088DEBC                            
0088DEBC                            WSnd_Main:	; Routine 0
0088DEBC 5428 0024                  		addq.b	#2,obRoutine(a0)
0088DEC0 117C 0004 0001             		move.b	#4,obRender(a0)
0088DEC6                            
0088DEC6                            WSnd_PlaySnd:	; Routine 2
0088DEC6 1038 FE0F                  		move.b	(v_vbla_byte).w,d0 ; get low byte of VBlank counter
0088DECA 0200 003F                  		andi.b	#$3F,d0
0088DECE                            		;bne.s	WSnd_ChkDel
0088DECE                            		;sfx	sfx_Waterfall	; play waterfall sound
0088DECE                            
0088DECE                            	WSnd_ChkDel:
0088DEEC 4E75                       		rts	
0088DEEC 4E75                       		rts	
0088DEEE                            		include	"_maps\Purple Rock.asm"
0088DEEE                            ; ---------------------------------------------------------------------------
0088DEEE                            ; Sprite mappings - purple rock	(GHZ)
0088DEEE                            ; ---------------------------------------------------------------------------
0088DEEE 0000                       Map_PRock:	dc.w byte_D110-Map_PRock
0088DEF0 02                         byte_D110:	dc.b 2
0088DEF1 F00B 0000 E8               		dc.b $F0, $B, 0, 0, $E8
0088DEF6 F00B 000C 00               		dc.b $F0, $B, 0, $C, 0
0088DEFC 00                         		even
0088DEFC 00                         		even
0088DEFC                            		include	"_incObj\3C Smashable Wall.asm"
0088DEFC                            ; ---------------------------------------------------------------------------
0088DEFC                            ; Object 3C - smashable	wall (GHZ, SLZ)
0088DEFC                            ; ---------------------------------------------------------------------------
0088DEFC                            
0088DEFC                            SmashWall:				; XREF: Obj_Index
0088DEFC 7000                       		moveq	#0,d0
0088DEFE 1028 0024                  		move.b	obRoutine(a0),d0
0088DF02 323B 0000                  		move.w	Smash_Index(pc,d0.w),d1
0088DF06 4EBB 1000                  		jsr	Smash_Index(pc,d1.w)
0088DF0A 6000 0000                  		bra.w	RememberState
0088DF0E                            ; ===========================================================================
0088DF0E 0000                       Smash_Index:	dc.w Smash_Main-Smash_Index
0088DF10 0000                       		dc.w Smash_Solid-Smash_Index
0088DF12 0000                       		dc.w Smash_FragMove-Smash_Index
0088DF14                            
0088DF14 =00000030                  speed:		= $30		; Sonic's horizontal speed
0088DF14                            ; ===========================================================================
0088DF14                            
0088DF14                            Smash_Main:	; Routine 0
0088DF14 5428 0024                  		addq.b	#2,obRoutine(a0)
0088DF18 217C 0000 0000 0004        		move.l	#Map_Smash,obMap(a0)
0088DF20 317C 450F 0002             		move.w	#$450F,obGfx(a0)
0088DF26 117C 0004 0001             		move.b	#4,obRender(a0)
0088DF2C 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088DF32 117C 0004 0018             		move.b	#4,obPriority(a0)
0088DF38 1168 0028 001A             		move.b	obSubtype(a0),obFrame(a0)
0088DF3E                            
0088DF3E                            Smash_Solid:	; Routine 2
0088DF3E 3178 D010 0030             		move.w	(v_player+obVelX).w,speed(a0) ; load Sonic's horizontal speed
0088DF44 323C 001B                  		move.w	#$1B,d1
0088DF48 343C 0020                  		move.w	#$20,d2
0088DF4C 363C 0020                  		move.w	#$20,d3
0088DF50 3828 0008                  		move.w	obX(a0),d4
0088DF54 6100 0000                  		bsr.w	SolidObject
0088DF58 0828 0005 0022             		btst	#staPush,obStatus(a0)	; is Sonic pushing against the wall?	;Mercury Constants
0088DF5E 6600                       		bne.s	@chkroll	; if yes, branch
0088DF60                            
0088DF60                            @donothing:
0088DF60 4E75                       		rts	
0088DF62                            ; ===========================================================================
0088DF62                            
0088DF62                            @chkroll:
0088DF62 0C29 0000 001C             		cmpi.b	#id_Roll,obAnim(a1) ; is Sonic rolling?
0088DF68 66F6                       		bne.s	@donothing	; if not, branch
0088DF6A 3028 0030                  		move.w	speed(a0),d0
0088DF6E 6A00                       		bpl.s	@chkspeed
0088DF70 4440                       		neg.w	d0
0088DF72                            
0088DF72                            	@chkspeed:
0088DF72 0C40 0480                  		cmpi.w	#$480,d0	; is Sonic's speed $480 or higher?
0088DF76 65E8                       		bcs.s	@donothing	; if not, branch
0088DF78 3368 0030 0010             		move.w	speed(a0),obVelX(a1)
0088DF7E 5869 0008                  		addq.w	#4,obX(a1)
0088DF82 49F9 0000 0000             		lea	(Smash_FragSpd1).l,a4 ;	use fragments that move	right
0088DF88 3028 0008                  		move.w	obX(a0),d0
0088DF8C B069 0008                  		cmp.w	obX(a1),d0	; is Sonic to the right	of the block?
0088DF90 6500                       		bcs.s	@smash		; if yes, branch
0088DF92 5169 0008                  		subq.w	#8,obX(a1)
0088DF96 49F9 0000 0000             		lea	(Smash_FragSpd2).l,a4 ;	use fragments that move	left
0088DF9C                            
0088DF9C                            	@smash:
0088DF9C 3369 0010 0014             		move.w	obVelX(a1),obInertia(a1)
0088DFA2 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
0088DFA8 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
0088DFAE 7207                       		moveq	#7,d1		; load 8 fragments
0088DFB0 343C 0070                  		move.w	#$70,d2
0088DFB4 6100                       		bsr.s	SmashObject
0088DFB6                            
0088DFB6                            Smash_FragMove:	; Routine 4
0088DFB6 6100 0000                  		bsr.w	ObjectMove
0088DFBA 0668 0070 0012             		addi.w	#$70,obVelY(a0)	; make fragment	fall faster
0088DFC0 6100 0000                  		bsr.w	DisplaySprite
0088DFC4 4A28 0001                  		tst.b	obRender(a0)
0088DFC8 6A00 0000                  		bpl.w	DeleteObject
0088DFCC 4E75                       		rts	
0088DFCC 4E75                       		rts	
0088DFCE                            
0088DFCE                            		include	"_incObj\sub SmashObject.asm"
0088DFCE                            ; ---------------------------------------------------------------------------
0088DFCE                            ; Subroutine to	smash a	block (GHZ walls and MZ	blocks)
0088DFCE                            ; ---------------------------------------------------------------------------
0088DFCE                            
0088DFCE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088DFCE                            
0088DFCE                            
0088DFCE                            SmashObject:
0088DFCE 7000                       		moveq	#0,d0
0088DFD0 1028 001A                  		move.b	obFrame(a0),d0
0088DFD4 D040                       		add.w	d0,d0
0088DFD6 2668 0004                  		movea.l	obMap(a0),a3
0088DFDA D6F3 0000                  		adda.w	(a3,d0.w),a3
0088DFDE 524B                       		addq.w	#1,a3
0088DFE0 08E8 0005 0001             		bset	#5,obRender(a0)
0088DFE6 1828 0000                  		move.b	0(a0),d4
0088DFEA 1A28 0001                  		move.b	obRender(a0),d5
0088DFEE 2248                       		movea.l	a0,a1
0088DFF0 6000                       		bra.s	@loadfrag
0088DFF2                            ; ===========================================================================
0088DFF2                            
0088DFF2                            	@loop:
0088DFF2 6100 0000                  		bsr.w	FindFreeObj
0088DFF6 6600                       		bne.s	@playsnd
0088DFF8 5A4B                       		addq.w	#5,a3
0088DFFA                            
0088DFFA                            @loadfrag:
0088DFFA 137C 0004 0024             		move.b	#4,obRoutine(a1)
0088E000 1344 0000                  		move.b	d4,0(a1)
0088E004 234B 0004                  		move.l	a3,obMap(a1)
0088E008 1345 0001                  		move.b	d5,obRender(a1)
0088E00C 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088E012 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088E018 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
0088E01E 1368 0018 0018             		move.b	obPriority(a0),obPriority(a1)
0088E024 1368 0019 0019             		move.b	obActWid(a0),obActWid(a1)
0088E02A 335C 0010                  		move.w	(a4)+,obVelX(a1)
0088E02E 335C 0012                  		move.w	(a4)+,obVelY(a1)
0088E032 B3C8                       		cmpa.l	a0,a1
0088E034 6400                       		bcc.s	@loc_D268
0088E036 2F08                       		move.l	a0,-(sp)
0088E038 2049                       		movea.l	a1,a0
0088E03A 6100 0000                  		bsr.w	ObjectMove
0088E03E D568 0012                  		add.w	d2,obVelY(a0)
0088E042 205F                       		movea.l	(sp)+,a0
0088E044 6100 0000                  		bsr.w	DisplaySprite1
0088E048                            
0088E048                            	@loc_D268:
0088E048 51C9 FFA8                  		dbf	d1,@loop
0088E04C                            
0088E04C                            	@playsnd:
0088E056                            
0088E056                            ; End of function SmashObject
0088E056                            ; End of function SmashObject
0088E056                            
0088E056                            ; ===========================================================================
0088E056                            ; Smashed block	fragment speeds
0088E056                            ;
0088E056 0400 FB00                  Smash_FragSpd1:	dc.w $400, -$500	; x-move speed,	y-move speed
0088E05A 0600 FF00                  		dc.w $600, -$100
0088E05E 0600 0100                  		dc.w $600, $100
0088E062 0400 0500                  		dc.w $400, $500
0088E066 0600 FA00                  		dc.w $600, -$600
0088E06A 0800 FE00                  		dc.w $800, -$200
0088E06E 0800 0200                  		dc.w $800, $200
0088E072 0600 0600                  		dc.w $600, $600
0088E076                            
0088E076 FA00 FA00                  Smash_FragSpd2:	dc.w -$600, -$600
0088E07A F800 FE00                  		dc.w -$800, -$200
0088E07E F800 0200                  		dc.w -$800, $200
0088E082 FA00 0600                  		dc.w -$600, $600
0088E086 FC00 FB00                  		dc.w -$400, -$500
0088E08A FA00 FF00                  		dc.w -$600, -$100
0088E08E FA00 0100                  		dc.w -$600, $100
0088E092 FC00 0500                  		dc.w -$400, $500
0088E096                            
0088E096                            		include	"_maps\Smashable Walls.asm"
0088E096                            ; ---------------------------------------------------------------------------
0088E096                            ; Sprite mappings - smashable walls (GHZ, SLZ)
0088E096                            ; ---------------------------------------------------------------------------
0088E096 0000                       Map_Smash:	dc.w @left-Map_Smash
0088E098 0000                       		dc.w @middle-Map_Smash
0088E09A 0000                       		dc.w @right-Map_Smash
0088E09C 08                         @left:		dc.b 8
0088E09D E005 0000 F0               		dc.b $E0, 5, 0,	0, $F0
0088E0A2 F005 0000 F0               		dc.b $F0, 5, 0,	0, $F0
0088E0A7 0005 0000 F0               		dc.b 0,	5, 0, 0, $F0
0088E0AC 1005 0000 F0               		dc.b $10, 5, 0,	0, $F0
0088E0B1 E005 0004 00               		dc.b $E0, 5, 0,	4, 0
0088E0B6 F005 0004 00               		dc.b $F0, 5, 0,	4, 0
0088E0BB 0005 0004 00               		dc.b 0,	5, 0, 4, 0
0088E0C0 1005 0004 00               		dc.b $10, 5, 0,	4, 0
0088E0C5 08                         @middle:	dc.b 8
0088E0C6 E005 0004 F0               		dc.b $E0, 5, 0,	4, $F0
0088E0CB F005 0004 F0               		dc.b $F0, 5, 0,	4, $F0
0088E0D0 0005 0004 F0               		dc.b 0,	5, 0, 4, $F0
0088E0D5 1005 0004 F0               		dc.b $10, 5, 0,	4, $F0
0088E0DA E005 0004 00               		dc.b $E0, 5, 0,	4, 0
0088E0DF F005 0004 00               		dc.b $F0, 5, 0,	4, 0
0088E0E4 0005 0004 00               		dc.b 0,	5, 0, 4, 0
0088E0E9 1005 0004 00               		dc.b $10, 5, 0,	4, 0
0088E0EE 08                         @right:		dc.b 8
0088E0EF E005 0004 F0               		dc.b $E0, 5, 0,	4, $F0
0088E0F4 F005 0004 F0               		dc.b $F0, 5, 0,	4, $F0
0088E0F9 0005 0004 F0               		dc.b 0,	5, 0, 4, $F0
0088E0FE 1005 0004 F0               		dc.b $10, 5, 0,	4, $F0
0088E103 E005 0008 00               		dc.b $E0, 5, 0,	8, 0
0088E108 F005 0008 00               		dc.b $F0, 5, 0,	8, 0
0088E10D 0005 0008 00               		dc.b 0,	5, 0, 8, 0
0088E112 1005 0008 00               		dc.b $10, 5, 0,	8, 0
0088E118 00                         		even
0088E118 00                         		even
0088E118                            
0088E118                            ; ---------------------------------------------------------------------------
0088E118                            ; Object code execution subroutine
0088E118                            ; ---------------------------------------------------------------------------
0088E118                            
0088E118                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E118                            
0088E118                            
0088E118                            ExecuteObjects:				; XREF: GM_Title; et al
0088E118 41F8 D000                  		lea	(v_objspace).w,a0 		; set address for object RAM
0088E11C 7E7F                       		moveq	#$7F,d7		 		; Loop $7F times ($80 objects)
0088E11E 7000                       		moveq	#0,d0				
0088E120 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w	; Is player dying?
0088E126 6400                       		bcc.s	@ExecuteDeath			; If yes, branch
0088E128                            
0088E128                            @ExecuteNextObject:
0088E128 1010                       		move.b	(a0),d0				; load object number from RAM
0088E12A 6700                       		beq.s	@skipobject			; If object number = 0, branch
0088E12C D040                       		add.w	d0,d0				; Convert value to offset
0088E12E D040                       		add.w	d0,d0				; Convert value to offset [part 2]
0088E130 227B 0000                  		movea.l	Obj_Index-4(pc,d0.w),a1		; Load pointer to objects code
0088E134 4E91                       		jsr	(a1)				; run the object's code
0088E136 7000                       		moveq	#0,d0
0088E138                            
0088E138                            @skipobject:
0088E138 41E8 0040                  		lea	$40(a0),a0			; next object
0088E13C 51CF FFEA                  		dbf	d7,@ExecuteNextObject		; loop
0088E140 4E75                       		rts	
0088E142                            ; ===========================================================================
0088E142                            
0088E142                            @ExecuteDeath:
0088E142 7E1F                       		moveq	#$1F,d7				; Set loop counter to $1F (execute only first $20 objects)
0088E144 61E2                       		bsr.s	@ExecuteNextObject		; Call normal execute loop
0088E146 7E5F                       		moveq	#$5F,d7				; Set loop counter to $5F (process remaining objects)
0088E148                            
0088E148                            @displayNextObject:
0088E148 7000                       		moveq	#0,d0				; Clear d0
0088E14A 1010                       		move.b	(a0),d0				; Read object number to RAM
0088E14C 6700                       		beq.s	@SkipDisplay			; If object is 0, skip it
0088E14E 4A28 0001                  		tst.b	obRender(a0)			; Check render flag
0088E152 6A00                       		bpl.s	@SkipDisplay			; If object is invisible, skip it
0088E154 6100 0000                  		bsr.w	DisplaySprite			; Display the object
0088E158                            
0088E158                            @SkipDisplay:
0088E158 41E8 0040                  		lea	$40(a0),a0			; next object
0088E15C 51CF FFEA                  		dbf	d7,@displayNextObject		; loop
0088E160 4E75                       		rts		
0088E162                            ; End of function ExecuteObjects
0088E162                            
0088E162                            ; ===========================================================================
0088E162                            ; ---------------------------------------------------------------------------
0088E162                            ; Object pointers
0088E162                            ; ---------------------------------------------------------------------------
0088E162                            Obj_Index:
0088E162                            		include	"_inc\Object Pointers.asm"
0088E162                            ; ---------------------------------------------------------------------------
0088E162                            ; Object pointers
0088E162                            ; ---------------------------------------------------------------------------
0088E162 0000 0000                  ptr_SonicPlayer:	dc.l SonicPlayer	; $01
0088E166 0000 0000                  ptr_Obj02:		dc.l ObjectMoveAndFall
0088E16A 0000 0000                  ptr_Obj03:		dc.l ObjectMoveAndFall
0088E16E 0000 0000                  ptr_Obj04:		dc.l ObjectMoveAndFall
0088E172                            
0088E172 0000 0000                  ptr_SonicEffects:	dc.l SonicEffects
0088E176                            
0088E176 0000 0000                  ptr_Obj06:		dc.l ObjectMoveAndFall
0088E17A 0000 0000                  ptr_Obj07:		dc.l ObjectMoveAndFall
0088E17E 0000 0000                  ptr_Splash:		dc.l Splash		; $08
0088E182 0000 0000                  ptr_SonicSpecial:	dc.l SonicSpecial
0088E186 0000 0000                  ptr_DrownCount:		dc.l DrownCount
0088E18A 0000 0000                  ptr_Pole:		dc.l Pole
0088E18E 0000 0000                  ptr_FlapDoor:		dc.l FlapDoor
0088E192 0000 0000                  ptr_Signpost:		dc.l Signpost
0088E196 0088 B3B4                  ptr_TitleSonic:		dc.l TitleSonic
0088E19A 0088 B434                  ptr_PSBTM:		dc.l PSBTM
0088E19E 0000 0000                  ptr_Obj10:		dc.l Obj10		; $10
0088E1A2 0088 7F5C                  ptr_Bridge:		dc.l Bridge
0088E1A6 0000 0000                  ptr_SpinningLight:	dc.l SpinningLight
0088E1AA 0000 0000                  ptr_LavaMaker:		dc.l LavaMaker
0088E1AE 0000 0000                  ptr_LavaBall:		dc.l LavaBall
0088E1B2 0088 8586                  ptr_SwingingPlatform:	dc.l SwingingPlatform
0088E1B6 0000 0000                  ptr_Harpoon:		dc.l Harpoon
0088E1BA 0088 88D6                  ptr_Helix:		dc.l Helix
0088E1BE 0088 8A66                  ptr_BasicPlatform:	dc.l BasicPlatform	; $18
0088E1C2 0088 8DDC                  ptr_Obj19:		dc.l Obj19
0088E1C6 0088 8E44                  ptr_CollapseLedge:	dc.l CollapseLedge
0088E1CA 0000 0000                  ptr_WaterSurface:	dc.l WaterSurface
0088E1CE 0088 93FE                  ptr_Scenery:		dc.l Scenery
0088E1D2 0088 9492                  ptr_MagicSwitch:	dc.l MagicSwitch
0088E1D6 0088 97AA                  ptr_BallHog:		dc.l BallHog
0088E1DA 0088 A14E                  ptr_Crabmeat:		dc.l Crabmeat
0088E1DE 0088 987A                  ptr_Cannonball:		dc.l Cannonball		; $20
0088E1E2 0000 0000                  ptr_HUD:		dc.l HUD
0088E1E6 0088 A43C                  ptr_BuzzBomber:		dc.l BuzzBomber
0088E1EA 0088 A590                  ptr_Missile:		dc.l Missile
0088E1EE 0088 9950                  ptr_MissileDissolve:	dc.l MissileDissolve
0088E1F2 0088 A784                  ptr_Rings:		dc.l Rings
0088E1F6 0088 AE8C                  ptr_Monitor:		dc.l Monitor
0088E1FA 0088 99C0                  ptr_ExplosionItem:	dc.l ExplosionItem
0088E1FE 0088 9B80                  ptr_Animals:		dc.l Animals		; $28
0088E202 0088 A070                  ptr_Points:		dc.l Points
0088E206 0088 9568                  ptr_AutoDoor:		dc.l AutoDoor
0088E20A 0088 B8B8                  ptr_Chopper:		dc.l Chopper
0088E20E 0088 B972                  ptr_Jaws:		dc.l Jaws
0088E212 0088 BA3C                  ptr_Burrobot:		dc.l Burrobot
0088E216 0088 B070                  ptr_PowerUp:		dc.l PowerUp
0088E21A 0088 BC50                  ptr_LargeGrass:		dc.l LargeGrass
0088E21E 0088 C136                  ptr_GlassBlock:		dc.l GlassBlock		; $30
0088E222 0088 C414                  ptr_ChainStomp:		dc.l ChainStomp
0088E226 0088 CAC6                  ptr_Button:		dc.l Button
0088E22A 0088 CC6A                  ptr_PushBlock:		dc.l PushBlock
0088E22E 0088 D09E                  ptr_TitleCard:		dc.l TitleCard
0088E232 0088 BF74                  ptr_GrassFire:		dc.l GrassFire
0088E236 0088 DC0E                  ptr_Spikes:		dc.l Spikes
0088E23A 0088 A9E4                  ptr_RingLoss:		dc.l RingLoss
0088E23E 0000 0000                  ptr_ShieldItem:		dc.l ShieldItem		; $38
0088E242 0088 D250                  ptr_GameOverCard:	dc.l GameOverCard
0088E246 0088 D30E                  ptr_GotThroughCard:	dc.l GotThroughCard
0088E24A 0088 DE3C                  ptr_PurpleRock:		dc.l PurpleRock
0088E24E 0088 DEFC                  ptr_SmashWall:		dc.l SmashWall
0088E252 0000 0000                  ptr_BossGreenHill:	dc.l BossGreenHill
0088E256 0000 0000                  ptr_Prison:		dc.l Prison
0088E25A 0088 9A54                  ptr_ExplosionBomb:	dc.l ExplosionBomb
0088E25E 0000 0000                  ptr_MotoBug:		dc.l MotoBug		; $40
0088E262 0000 0000                  ptr_Springs:		dc.l Springs
0088E266 0000 0000                  ptr_Newtron:		dc.l Newtron
0088E26A 0000 0000                  ptr_Roller:		dc.l Roller
0088E26E 0000 0000                  ptr_EdgeWalls:		dc.l EdgeWalls
0088E272 0088 C732                  ptr_SideStomp:		dc.l SideStomp
0088E276 0000 0000                  ptr_MarbleBrick:	dc.l MarbleBrick
0088E27A 0000 0000                  ptr_Bumper:		dc.l Bumper
0088E27E 0000 0000                  ptr_BossBall:		dc.l BossBall		; $48
0088E282 0088 DEAA                  ptr_WaterSound:		dc.l WaterSound
0088E286 0000 0000                  ptr_VanishSonic:	dc.l VanishSonic
0088E28A 0088 AB86                  ptr_GiantRing:		dc.l GiantRing
0088E28E 0000 0000                  ptr_GeyserMaker:	dc.l GeyserMaker
0088E292 0000 0000                  ptr_LavaGeyser:		dc.l LavaGeyser
0088E296 0000 0000                  ptr_LavaWall:		dc.l LavaWall
0088E29A 0000 0000                  ptr_Obj4F:		dc.l Obj4F
0088E29E 0000 0000                  ptr_Yadrin:		dc.l Yadrin		; $50
0088E2A2 0000 0000                  ptr_SmashBlock:		dc.l SmashBlock
0088E2A6 0000 0000                  ptr_MovingBlock:	dc.l MovingBlock
0088E2AA 0088 8F54                  ptr_CollapseFloor:	dc.l CollapseFloor
0088E2AE 0000 0000                  ptr_LavaTag:		dc.l LavaTag
0088E2B2 0000 0000                  ptr_Basaran:		dc.l Basaran
0088E2B6 0000 0000                  ptr_FloatingBlock:	dc.l FloatingBlock
0088E2BA 0000 0000                  ptr_SpikeBall:		dc.l SpikeBall
0088E2BE 0000 0000                  ptr_BigSpikeBall:	dc.l BigSpikeBall	; $58
0088E2C2 0000 0000                  ptr_Elevator:		dc.l Elevator
0088E2C6 0000 0000                  ptr_CirclingPlatform:	dc.l CirclingPlatform
0088E2CA 0000 0000                  ptr_Staircase:		dc.l Staircase
0088E2CE 0000 0000                  ptr_Pylon:		dc.l Pylon
0088E2D2 0000 0000                  ptr_Fan:		dc.l Fan
0088E2D6 0000 0000                  ptr_Seesaw:		dc.l Seesaw
0088E2DA 0000 0000                  ptr_Bomb:		dc.l Bomb
0088E2DE 0000 0000                  ptr_Orbinaut:		dc.l Orbinaut		; $60
0088E2E2 0000 0000                  ptr_LabyrinthBlock:	dc.l LabyrinthBlock
0088E2E6 0000 0000                  ptr_Gargoyle:		dc.l Gargoyle
0088E2EA 0000 0000                  ptr_LabyrinthConvey:	dc.l LabyrinthConvey
0088E2EE 0000 0000                  ptr_Bubble:		dc.l Bubble
0088E2F2 0000 0000                  ptr_Waterfall:		dc.l Waterfall
0088E2F6 0000 0000                  ptr_Junction:		dc.l Junction
0088E2FA 0000 0000                  ptr_RunningDisc:	dc.l RunningDisc
0088E2FE 0000 0000                  ptr_Conveyor:		dc.l Conveyor		; $68
0088E302 0000 0000                  ptr_SpinPlatform:	dc.l SpinPlatform
0088E306 0000 0000                  ptr_Saws:		dc.l Saws
0088E30A 0000 0000                  ptr_ScrapStomp:		dc.l ScrapStomp
0088E30E 0000 0000                  ptr_VanishPlatform:	dc.l VanishPlatform
0088E312 0000 0000                  ptr_Flamethrower:	dc.l Flamethrower
0088E316 0000 0000                  ptr_Electro:		dc.l Electro
0088E31A 0000 0000                  ptr_SpinConvey:		dc.l SpinConvey
0088E31E 0000 0000                  ptr_Girder:		dc.l Girder		; $70
0088E322 0000 0000                  ptr_Invisibarrier:	dc.l Invisibarrier
0088E326 0000 0000                  ptr_Teleport:		dc.l Teleport
0088E32A 0000 0000                  ptr_BossMarble:		dc.l BossMarble
0088E32E 0000 0000                  ptr_BossFire:		dc.l BossFire
0088E332 0000 0000                  ptr_BossSpringYard:	dc.l BossSpringYard
0088E336 0000 0000                  ptr_BossBlock:		dc.l BossBlock
0088E33A 0000 0000                  ptr_BossLabyrinth:	dc.l BossLabyrinth
0088E33E 0000 0000                  ptr_Caterkiller:	dc.l Caterkiller	; $78
0088E342 0000 0000                  ptr_Lamppost:		dc.l Lamppost
0088E346 0000 0000                  ptr_BossStarLight:	dc.l BossStarLight
0088E34A 0000 0000                  ptr_BossSpikeball:	dc.l BossSpikeball
0088E34E 0088 AC46                  ptr_RingFlash:		dc.l RingFlash
0088E352 0000 0000                  ptr_HiddenBonus:	dc.l HiddenBonus
0088E356 0088 D570                  ptr_SSResult:		dc.l SSResult
0088E35A 0088 D73C                  ptr_SSRChaos:		dc.l SSRChaos
0088E35E 0088 538A                  ptr_ContScrItem:	dc.l ContScrItem	; $80
0088E362 0088 54A4                  ptr_ContSonic:		dc.l ContSonic
0088E366 0000 0000                  ptr_ScrapEggman:	dc.l ScrapEggman
0088E36A 0000 0000                  ptr_FalseFloor:		dc.l FalseFloor
0088E36E 0000 0000                  ptr_EggmanCylinder:	dc.l EggmanCylinder
0088E372 0000 0000                  ptr_BossFinal:		dc.l BossFinal
0088E376 0000 0000                  ptr_BossPlasma:		dc.l BossPlasma
0088E37A 0088 592A                  ptr_EndSonic:		dc.l EndSonic
0088E37E 0088 5A84                  ptr_EndChaos:		dc.l EndChaos		; $88
0088E382 0088 5B5E                  ptr_EndSTH:		dc.l EndSTH
0088E386 0000 0000                  ptr_CreditsText:	dc.l CreditsText
0088E38A 0088 5F2C                  ptr_EndEggman:		dc.l EndEggman
0088E38E 0088 600C                  ptr_TryChaos:		dc.l TryChaos
0088E392                            
0088E392 =00000001                  id_SonicPlayer:		equ ((ptr_SonicPlayer-Obj_Index)/4)+1		; $01
0088E392                            id_Obj02:		equ ((ptr_ObjectMoveAndFall-Obj_Index)/4)+1
0088E392                            id_Obj03:		equ ((ptr_ObjectMoveAndFall-Obj_Index)/4)+1
0088E392                            id_Obj04:		equ ((ptr_ObjectMoveAndFall-Obj_Index)/4)+1
0088E392                            
0088E392 =00000005                  id_SonicEffects:	equ ((ptr_SonicEffects-Obj_Index)/4)+1
0088E392                            
0088E392                            id_Obj06:		equ ((ptr_ObjectMoveAndFall-Obj_Index)/4)+1
0088E392                            id_Obj07:		equ ((ptr_ObjectMoveAndFall-Obj_Index)/4)+1
0088E392 =00000008                  id_Splash:		equ ((ptr_Splash-Obj_Index)/4)+1		; $08
0088E392 =00000009                  id_SonicSpecial:	equ ((ptr_SonicSpecial-Obj_Index)/4)+1
0088E392 =0000000A                  id_DrownCount:		equ ((ptr_DrownCount-Obj_Index)/4)+1
0088E392 =0000000B                  id_Pole:		equ ((ptr_Pole-Obj_Index)/4)+1
0088E392 =0000000C                  id_FlapDoor:		equ ((ptr_FlapDoor-Obj_Index)/4)+1
0088E392 =0000000D                  id_Signpost:		equ ((ptr_Signpost-Obj_Index)/4)+1
0088E392 =0000000E                  id_TitleSonic:		equ ((ptr_TitleSonic-Obj_Index)/4)+1
0088E392 =0000000F                  id_PSBTM:		equ ((ptr_PSBTM-Obj_Index)/4)+1
0088E392 =00000010                  id_Obj10:		equ ((ptr_Obj10-Obj_Index)/4)+1			; $10
0088E392 =00000011                  id_Bridge:		equ ((ptr_Bridge-Obj_Index)/4)+1
0088E392 =00000012                  id_SpinningLight:	equ ((ptr_SpinningLight-Obj_Index)/4)+1
0088E392 =00000013                  id_LavaMaker:		equ ((ptr_LavaMaker-Obj_Index)/4)+1
0088E392 =00000014                  id_LavaBall:		equ ((ptr_LavaBall-Obj_Index)/4)+1
0088E392 =00000015                  id_SwingingPlatform:	equ ((ptr_SwingingPlatform-Obj_Index)/4)+1
0088E392 =00000016                  id_Harpoon:		equ ((ptr_Harpoon-Obj_Index)/4)+1
0088E392 =00000017                  id_Helix:		equ ((ptr_Helix-Obj_Index)/4)+1
0088E392 =00000018                  id_BasicPlatform:	equ ((ptr_BasicPlatform-Obj_Index)/4)+1		; $18
0088E392 =00000019                  id_Obj19:		equ ((ptr_Obj19-Obj_Index)/4)+1
0088E392 =0000001A                  id_CollapseLedge:	equ ((ptr_CollapseLedge-Obj_Index)/4)+1
0088E392 =0000001B                  id_WaterSurface:	equ ((ptr_WaterSurface-Obj_Index)/4)+1
0088E392 =0000001C                  id_Scenery:		equ ((ptr_Scenery-Obj_Index)/4)+1
0088E392 =0000001D                  id_MagicSwitch:		equ ((ptr_MagicSwitch-Obj_Index)/4)+1
0088E392 =0000001E                  id_BallHog:		equ ((ptr_BallHog-Obj_Index)/4)+1
0088E392 =0000001F                  id_Crabmeat:		equ ((ptr_Crabmeat-Obj_Index)/4)+1
0088E392 =00000020                  id_Cannonball:		equ ((ptr_Cannonball-Obj_Index)/4)+1		; $20
0088E392 =00000021                  id_HUD:			equ ((ptr_HUD-Obj_Index)/4)+1
0088E392 =00000022                  id_BuzzBomber:		equ ((ptr_BuzzBomber-Obj_Index)/4)+1
0088E392 =00000023                  id_Missile:		equ ((ptr_Missile-Obj_Index)/4)+1
0088E392 =00000024                  id_MissileDissolve:	equ ((ptr_MissileDissolve-Obj_Index)/4)+1
0088E392 =00000025                  id_Rings:		equ ((ptr_Rings-Obj_Index)/4)+1
0088E392 =00000026                  id_Monitor:		equ ((ptr_Monitor-Obj_Index)/4)+1
0088E392 =00000027                  id_ExplosionItem:	equ ((ptr_ExplosionItem-Obj_Index)/4)+1
0088E392 =00000028                  id_Animals:		equ ((ptr_Animals-Obj_Index)/4)+1		; $28
0088E392 =00000029                  id_Points:		equ ((ptr_Points-Obj_Index)/4)+1
0088E392 =0000002A                  id_AutoDoor:		equ ((ptr_AutoDoor-Obj_Index)/4)+1
0088E392 =0000002B                  id_Chopper:		equ ((ptr_Chopper-Obj_Index)/4)+1
0088E392 =0000002C                  id_Jaws:		equ ((ptr_Jaws-Obj_Index)/4)+1
0088E392 =0000002D                  id_Burrobot:		equ ((ptr_Burrobot-Obj_Index)/4)+1
0088E392 =0000002E                  id_PowerUp:		equ ((ptr_PowerUp-Obj_Index)/4)+1
0088E392 =0000002F                  id_LargeGrass:		equ ((ptr_LargeGrass-Obj_Index)/4)+1
0088E392 =00000030                  id_GlassBlock:		equ ((ptr_GlassBlock-Obj_Index)/4)+1		; $30
0088E392 =00000031                  id_ChainStomp:		equ ((ptr_ChainStomp-Obj_Index)/4)+1
0088E392 =00000032                  id_Button:		equ ((ptr_Button-Obj_Index)/4)+1
0088E392 =00000033                  id_PushBlock:		equ ((ptr_PushBlock-Obj_Index)/4)+1
0088E392 =00000034                  id_TitleCard:		equ ((ptr_TitleCard-Obj_Index)/4)+1
0088E392 =00000035                  id_GrassFire:		equ ((ptr_GrassFire-Obj_Index)/4)+1
0088E392 =00000036                  id_Spikes:		equ ((ptr_Spikes-Obj_Index)/4)+1
0088E392 =00000037                  id_RingLoss:		equ ((ptr_RingLoss-Obj_Index)/4)+1
0088E392 =00000038                  id_ShieldItem:		equ ((ptr_ShieldItem-Obj_Index)/4)+1		; $38
0088E392 =00000039                  id_GameOverCard:	equ ((ptr_GameOverCard-Obj_Index)/4)+1
0088E392 =0000003A                  id_GotThroughCard:	equ ((ptr_GotThroughCard-Obj_Index)/4)+1
0088E392 =0000003B                  id_PurpleRock:		equ ((ptr_PurpleRock-Obj_Index)/4)+1
0088E392 =0000003C                  id_SmashWall:		equ ((ptr_SmashWall-Obj_Index)/4)+1
0088E392 =0000003D                  id_BossGreenHill:	equ ((ptr_BossGreenHill-Obj_Index)/4)+1
0088E392 =0000003E                  id_Prison:		equ ((ptr_Prison-Obj_Index)/4)+1
0088E392 =0000003F                  id_ExplosionBomb:	equ ((ptr_ExplosionBomb-Obj_Index)/4)+1
0088E392 =00000040                  id_MotoBug:		equ ((ptr_MotoBug-Obj_Index)/4)+1		; $40
0088E392 =00000041                  id_Springs:		equ ((ptr_Springs-Obj_Index)/4)+1
0088E392 =00000042                  id_Newtron:		equ ((ptr_Newtron-Obj_Index)/4)+1
0088E392 =00000043                  id_Roller:		equ ((ptr_Roller-Obj_Index)/4)+1
0088E392 =00000044                  id_EdgeWalls:		equ ((ptr_EdgeWalls-Obj_Index)/4)+1
0088E392 =00000045                  id_SideStomp:		equ ((ptr_SideStomp-Obj_Index)/4)+1
0088E392 =00000046                  id_MarbleBrick:		equ ((ptr_MarbleBrick-Obj_Index)/4)+1
0088E392 =00000047                  id_Bumper:		equ ((ptr_Bumper-Obj_Index)/4)+1
0088E392 =00000048                  id_BossBall:		equ ((ptr_BossBall-Obj_Index)/4)+1		; $48
0088E392 =00000049                  id_WaterSound:		equ ((ptr_WaterSound-Obj_Index)/4)+1
0088E392 =0000004A                  id_VanishSonic:		equ ((ptr_VanishSonic-Obj_Index)/4)+1
0088E392 =0000004B                  id_GiantRing:		equ ((ptr_GiantRing-Obj_Index)/4)+1
0088E392 =0000004C                  id_GeyserMaker:		equ ((ptr_GeyserMaker-Obj_Index)/4)+1
0088E392 =0000004D                  id_LavaGeyser:		equ ((ptr_LavaGeyser-Obj_Index)/4)+1
0088E392 =0000004E                  id_LavaWall:		equ ((ptr_LavaWall-Obj_Index)/4)+1
0088E392 =0000004F                  id_Obj4F:		equ ((ptr_Obj4F-Obj_Index)/4)+1
0088E392 =00000050                  id_Yadrin:		equ ((ptr_Yadrin-Obj_Index)/4)+1		; $50
0088E392 =00000051                  id_SmashBlock:		equ ((ptr_SmashBlock-Obj_Index)/4)+1
0088E392 =00000052                  id_MovingBlock:		equ ((ptr_MovingBlock-Obj_Index)/4)+1
0088E392 =00000053                  id_CollapseFloor:	equ ((ptr_CollapseFloor-Obj_Index)/4)+1
0088E392 =00000054                  id_LavaTag:		equ ((ptr_LavaTag-Obj_Index)/4)+1
0088E392 =00000055                  id_Basaran:		equ ((ptr_Basaran-Obj_Index)/4)+1
0088E392 =00000056                  id_FloatingBlock:	equ ((ptr_FloatingBlock-Obj_Index)/4)+1
0088E392 =00000057                  id_SpikeBall:		equ ((ptr_SpikeBall-Obj_Index)/4)+1
0088E392 =00000058                  id_BigSpikeBall:	equ ((ptr_BigSpikeBall-Obj_Index)/4)+1		; $58
0088E392 =00000059                  id_Elevator:		equ ((ptr_Elevator-Obj_Index)/4)+1
0088E392 =0000005A                  id_CirclingPlatform:	equ ((ptr_CirclingPlatform-Obj_Index)/4)+1
0088E392 =0000005B                  id_Staircase:		equ ((ptr_Staircase-Obj_Index)/4)+1
0088E392 =0000005C                  id_Pylon:		equ ((ptr_Pylon-Obj_Index)/4)+1
0088E392 =0000005D                  id_Fan:			equ ((ptr_Fan-Obj_Index)/4)+1
0088E392 =0000005E                  id_Seesaw:		equ ((ptr_Seesaw-Obj_Index)/4)+1
0088E392 =0000005F                  id_Bomb:		equ ((ptr_Bomb-Obj_Index)/4)+1
0088E392 =00000060                  id_Orbinaut:		equ ((ptr_Orbinaut-Obj_Index)/4)+1		; $60
0088E392 =00000061                  id_LabyrinthBlock:	equ ((ptr_LabyrinthBlock-Obj_Index)/4)+1
0088E392 =00000062                  id_Gargoyle:		equ ((ptr_Gargoyle-Obj_Index)/4)+1
0088E392 =00000063                  id_LabyrinthConvey:	equ ((ptr_LabyrinthConvey-Obj_Index)/4)+1
0088E392 =00000064                  id_Bubble:		equ ((ptr_Bubble-Obj_Index)/4)+1
0088E392 =00000065                  id_Waterfall:		equ ((ptr_Waterfall-Obj_Index)/4)+1
0088E392 =00000066                  id_Junction:		equ ((ptr_Junction-Obj_Index)/4)+1
0088E392 =00000067                  id_RunningDisc:		equ ((ptr_RunningDisc-Obj_Index)/4)+1
0088E392 =00000068                  id_Conveyor:		equ ((ptr_Conveyor-Obj_Index)/4)+1		; $68
0088E392 =00000069                  id_SpinPlatform:	equ ((ptr_SpinPlatform-Obj_Index)/4)+1
0088E392 =0000006A                  id_Saws:		equ ((ptr_Saws-Obj_Index)/4)+1
0088E392 =0000006B                  id_ScrapStomp:		equ ((ptr_ScrapStomp-Obj_Index)/4)+1
0088E392 =0000006C                  id_VanishPlatform:	equ ((ptr_VanishPlatform-Obj_Index)/4)+1
0088E392 =0000006D                  id_Flamethrower:	equ ((ptr_Flamethrower-Obj_Index)/4)+1
0088E392 =0000006E                  id_Electro:		equ ((ptr_Electro-Obj_Index)/4)+1
0088E392 =0000006F                  id_SpinConvey:		equ ((ptr_SpinConvey-Obj_Index)/4)+1
0088E392 =00000070                  id_Girder:		equ ((ptr_Girder-Obj_Index)/4)+1		; $70
0088E392 =00000071                  id_Invisibarrier:	equ ((ptr_Invisibarrier-Obj_Index)/4)+1
0088E392 =00000072                  id_Teleport:		equ ((ptr_Teleport-Obj_Index)/4)+1
0088E392 =00000073                  id_BossMarble:		equ ((ptr_BossMarble-Obj_Index)/4)+1
0088E392 =00000074                  id_BossFire:		equ ((ptr_BossFire-Obj_Index)/4)+1
0088E392 =00000075                  id_BossSpringYard:	equ ((ptr_BossSpringYard-Obj_Index)/4)+1
0088E392 =00000076                  id_BossBlock:		equ ((ptr_BossBlock-Obj_Index)/4)+1
0088E392 =00000077                  id_BossLabyrinth:	equ ((ptr_BossLabyrinth-Obj_Index)/4)+1
0088E392 =00000078                  id_Caterkiller:		equ ((ptr_Caterkiller-Obj_Index)/4)+1		; $78
0088E392 =00000079                  id_Lamppost:		equ ((ptr_Lamppost-Obj_Index)/4)+1
0088E392 =0000007A                  id_BossStarLight:	equ ((ptr_BossStarLight-Obj_Index)/4)+1
0088E392 =0000007B                  id_BossSpikeball:	equ ((ptr_BossSpikeball-Obj_Index)/4)+1
0088E392 =0000007C                  id_RingFlash:		equ ((ptr_RingFlash-Obj_Index)/4)+1
0088E392 =0000007D                  id_HiddenBonus:		equ ((ptr_HiddenBonus-Obj_Index)/4)+1
0088E392 =0000007E                  id_SSResult:		equ ((ptr_SSResult-Obj_Index)/4)+1
0088E392 =0000007F                  id_SSRChaos:		equ ((ptr_SSRChaos-Obj_Index)/4)+1
0088E392 =00000080                  id_ContScrItem:		equ ((ptr_ContScrItem-Obj_Index)/4)+1		; $80
0088E392 =00000081                  id_ContSonic:		equ ((ptr_ContSonic-Obj_Index)/4)+1
0088E392 =00000082                  id_ScrapEggman:		equ ((ptr_ScrapEggman-Obj_Index)/4)+1
0088E392 =00000083                  id_FalseFloor:		equ ((ptr_FalseFloor-Obj_Index)/4)+1
0088E392 =00000084                  id_EggmanCylinder:	equ ((ptr_EggmanCylinder-Obj_Index)/4)+1
0088E392 =00000085                  id_BossFinal:		equ ((ptr_BossFinal-Obj_Index)/4)+1
0088E392 =00000086                  id_BossPlasma:		equ ((ptr_BossPlasma-Obj_Index)/4)+1
0088E392 =00000087                  id_EndSonic:		equ ((ptr_EndSonic-Obj_Index)/4)+1
0088E392 =00000088                  id_EndChaos:		equ ((ptr_EndChaos-Obj_Index)/4)+1		; $88
0088E392 =00000089                  id_EndSTH:		equ ((ptr_EndSTH-Obj_Index)/4)+1
0088E392 =0000008A                  id_CreditsText:		equ ((ptr_CreditsText-Obj_Index)/4)+1
0088E392 =0000008B                  id_EndEggman:		equ ((ptr_EndEggman-Obj_Index)/4)+1
0088E392 =0000008C                  id_TryChaos:		equ ((ptr_TryChaos-Obj_Index)/4)+1
0088E392 =0000008C                  id_TryChaos:		equ ((ptr_TryChaos-Obj_Index)/4)+1
0088E392                            		include	"_incObj\sub ObjectMoveAndFall.asm"
0088E392                            ; ---------------------------------------------------------------------------
0088E392                            ; Subroutine to	make an	object fall downwards, increasingly fast
0088E392                            ; ---------------------------------------------------------------------------
0088E392                            
0088E392                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E392                            
0088E392                            
0088E392                            ObjectMoveAndFall:
0088E392 3028 0010                          move.w  obVelX(a0),d0	; Read object's velocity
0088E396 48C0                               ext.l   d0
0088E398 E188                               lsl.l   #8,d0		
0088E39A D1A8 0008                          add.l   d0,obX(a0)	; Add to objects X position
0088E39E 3028 0012                          move.w  obVelY(a0),d0	; Read objects Y velocity
0088E3A2 0668 0038 0012                     addi.w  #$38,obVelY(a0) ; Increase by gravity amount
0088E3A8 48C0                               ext.l   d0
0088E3AA E188                               lsl.l   #8,d0
0088E3AC D1A8 000C                          add.l   d0,obY(a0)	; Add to objects Y position
0088E3B0 4E75                               rts
0088E3B0 4E75                               rts
0088E3B2                            		include	"_incObj\sub ObjectMove.asm"
0088E3B2                            ; ---------------------------------------------------------------------------
0088E3B2                            ; Subroutine translating object	speed to update	object position
0088E3B2                            ; ---------------------------------------------------------------------------
0088E3B2                            
0088E3B2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E3B2                            
0088E3B2                            
0088E3B2                            ObjectMove:
0088E3B2 3028 0010                  	move.w  obVelX(a0),d0
0088E3B6 48C0                               ext.l   d0
0088E3B8 E188                               lsl.l   #8,d0
0088E3BA D1A8 0008                          add.l   d0,obX(a0)
0088E3BE 3028 0012                          move.w  obVelY(a0),d0
0088E3C2 48C0                               ext.l   d0
0088E3C4 E188                               lsl.l   #8,d0
0088E3C6 D1A8 000C                          add.l   d0,obY(a0)
0088E3CA 4E75                               rts
0088E3CC                            
0088E3CC                            ; End of function ObjectMove
0088E3CC                            ; End of function ObjectMove
0088E3CC                            		include	"_incObj\sub DisplaySprite.asm"
0088E3CC                            ; ---------------------------------------------------------------------------
0088E3CC                            ; Subroutine to	display	a sprite/object, when a0 is the	object RAM
0088E3CC                            ; ---------------------------------------------------------------------------
0088E3CC                            
0088E3CC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E3CC                            
0088E3CC                            
0088E3CC                            DisplaySprite:
0088E3CC 43F8 AC00                  		lea	(v_spritequeue).w,a1
0088E3D0 3028 0018                  		move.w	obPriority(a0),d0 ; get sprite priority
0088E3D4 E248                       		lsr.w	#1,d0
0088E3D6 0240 0380                  		andi.w	#$380,d0
0088E3DA D2C0                       		adda.w	d0,a1		; jump to position in queue
0088E3DC 0C51 007E                  		cmpi.w	#$7E,(a1)	; is this part of the queue full?
0088E3E0 6400                       		bcc.s	DSpr_Full	; if yes, branch
0088E3E2 5451                       		addq.w	#2,(a1)		; increment sprite count
0088E3E4 D2D1                       		adda.w	(a1),a1		; jump to empty position
0088E3E6 3288                       		move.w	a0,(a1)		; insert RAM address for object
0088E3E8                            
0088E3E8                            	DSpr_Full:
0088E3E8 4E75                       		rts	
0088E3EA                            
0088E3EA                            ; End of function DisplaySprite
0088E3EA                            
0088E3EA                            
0088E3EA                            ; ---------------------------------------------------------------------------
0088E3EA                            ; Subroutine to	display	a 2nd sprite/object, when a1 is	the object RAM
0088E3EA                            ; ---------------------------------------------------------------------------
0088E3EA                            
0088E3EA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E3EA                            
0088E3EA                            
0088E3EA                            DisplaySprite1:
0088E3EA 45F8 AC00                  		lea	(v_spritequeue).w,a2
0088E3EE 3029 0018                  		move.w	obPriority(a1),d0
0088E3F2 E248                       		lsr.w	#1,d0
0088E3F4 0240 0380                  		andi.w	#$380,d0
0088E3F8 D4C0                       		adda.w	d0,a2
0088E3FA 0C52 007E                  		cmpi.w	#$7E,(a2)
0088E3FE 6400                       		bcc.s	DSpr1_Full
0088E400 5452                       		addq.w	#2,(a2)
0088E402 D4D2                       		adda.w	(a2),a2
0088E404 3489                       		move.w	a1,(a2)
0088E406                            
0088E406                            	DSpr1_Full:
0088E406 4E75                       		rts	
0088E408                            
0088E408                            ; End of function DisplaySprite1
0088E408                            ; End of function DisplaySprite1
0088E408                            		include	"_incObj\sub DeleteObject.asm"
0088E408                            ; ---------------------------------------------------------------------------
0088E408                            ; Subroutine to	delete an object
0088E408                            ; ---------------------------------------------------------------------------
0088E408                            
0088E408                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E408                            
0088E408                            
0088E408                            DeleteObject:
0088E408 2248                       		movea.l	a0,a1		; move object RAM address to (a1)
0088E40A                            
0088E40A                            DeleteChild:				; child objects are already in (a1)
0088E40A 7200                       		moveq	#0,d1
0088E40C 700F                       		moveq	#$F,d0
0088E40E                            
0088E40E                            	DelObj_Loop:
0088E40E 22C1                       		move.l	d1,(a1)+	; clear	the object RAM
0088E410 51C8 FFFC                  		dbf	d0,DelObj_Loop	; repeat for length of object RAM
0088E414 4E75                       		rts	
0088E416                            
0088E416                            ; End of function DeleteObject
0088E416                            ; End of function DeleteObject
0088E416                            
0088E416                            ; ===========================================================================
0088E416 0000 0000                  BldSpr_ScrPos:	dc.l 0			; blank
0088E41A 00FF F700                  		dc.l $FFF700		; main screen x-position
0088E41E 00FF F708                  		dc.l $FFF708		; background x-position	1
0088E422 00FF F718                  		dc.l $FFF718		; background x-position	2
0088E426                            ; ---------------------------------------------------------------------------
0088E426                            ; Subroutine to	convert	mappings (etc) to proper Megadrive sprites
0088E426                            ; ---------------------------------------------------------------------------
0088E426                            
0088E426                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E426                            
0088E426                            
0088E426                            BuildSprites:				; XREF: GM_Title; et al
0088E426 45F8 F800                  		lea	(v_spritetablebuffer).w,a2 ; set address for sprite table
0088E42A 7A00                       		moveq	#0,d5
0088E42C 49F8 AC00                  		lea	(v_spritequeue).w,a4
0088E430 7E07                       		moveq	#7,d7
0088E432                            
0088E432                            loc_D66A:
0088E432 4A54                       		tst.w	(a4)
0088E434 6700 0000                  		beq.w	loc_D72E
0088E438 7C02                       		moveq	#2,d6
0088E43A                            
0088E43A                            loc_D672:
0088E43A 3074 6000                  		movea.w	(a4,d6.w),a0
0088E43E 4A10                       		tst.b	(a0)
0088E440 6700 0000                  		beq.w	loc_D726
0088E444 08A8 0007 0001             		bclr	#7,obRender(a0)
0088E44A 1028 0001                  		move.b	obRender(a0),d0
0088E44E 1800                       		move.b	d0,d4
0088E450 0240 000C                  		andi.w	#$C,d0
0088E454 6700                       		beq.s	loc_D6DE
0088E456 227B 00BE                  		movea.l	BldSpr_ScrPos(pc,d0.w),a1
0088E45A 7000                       		moveq	#0,d0
0088E45C 1028 0019                  		move.b	obActWid(a0),d0
0088E460 3628 0008                  		move.w	obX(a0),d3
0088E464 9651                       		sub.w	(a1),d3
0088E466 3203                       		move.w	d3,d1
0088E468 D240                       		add.w	d0,d1
0088E46A 6B00 0000                  		bmi.w	loc_D726
0088E46E 3203                       		move.w	d3,d1
0088E470 9240                       		sub.w	d0,d1
0088E472 0C41 0140                  		cmpi.w	#$140,d1
0088E476 6C00                       		bge.s	loc_D726
0088E478 0643 0080                  		addi.w	#$80,d3
0088E47C 0804 0004                  		btst	#4,d4
0088E480 6700                       		beq.s	loc_D6E8
0088E482 7000                       		moveq	#0,d0
0088E484 1028 0016                  		move.b	obHeight(a0),d0
0088E488 3428 000C                  		move.w	obY(a0),d2
0088E48C 9469 0004                  		sub.w	4(a1),d2
0088E490 3202                       		move.w	d2,d1
0088E492 D240                       		add.w	d0,d1
0088E494 6B00                       		bmi.s	loc_D726
0088E496 3202                       		move.w	d2,d1
0088E498 9240                       		sub.w	d0,d1
0088E49A 0C41 00E0                  		cmpi.w	#$E0,d1
0088E49E 6C00                       		bge.s	loc_D726
0088E4A0 0642 0080                  		addi.w	#$80,d2
0088E4A4 6000                       		bra.s	loc_D700
0088E4A6                            ; ===========================================================================
0088E4A6                            
0088E4A6                            loc_D6DE:
0088E4A6 3428 000A                  		move.w	$A(a0),d2
0088E4AA 3628 0008                  		move.w	obX(a0),d3
0088E4AE 6000                       		bra.s	loc_D700
0088E4B0                            ; ===========================================================================
0088E4B0                            
0088E4B0                            loc_D6E8:
0088E4B0 3428 000C                  		move.w	obY(a0),d2
0088E4B4 9469 0004                  		sub.w	obMap(a1),d2
0088E4B8 0642 0080                  		addi.w	#$80,d2
0088E4BC 0C42 0060                  		cmpi.w	#$60,d2
0088E4C0 6500                       		bcs.s	loc_D726
0088E4C2 0C42 0180                  		cmpi.w	#$180,d2
0088E4C6 6400                       		bcc.s	loc_D726
0088E4C8                            
0088E4C8                            loc_D700:
0088E4C8 2268 0004                  		movea.l	obMap(a0),a1
0088E4CC 7200                       		moveq	#0,d1
0088E4CE 0804 0005                  		btst	#5,d4
0088E4D2 6600                       		bne.s	loc_D71C
0088E4D4 1228 001A                  		move.b	obFrame(a0),d1
0088E4D8 D201                       		add.b	d1,d1
0088E4DA D2F1 1000                  		adda.w	(a1,d1.w),a1
0088E4DE 1219                       		move.b	(a1)+,d1
0088E4E0 5301                       		subq.b	#1,d1
0088E4E2 6B00                       		bmi.s	loc_D720
0088E4E4                            
0088E4E4                            loc_D71C:
0088E4E4 6100 0000                  		bsr.w	sub_D750
0088E4E8                            
0088E4E8                            loc_D720:
0088E4E8 08E8 0007 0001             		bset	#7,obRender(a0)
0088E4EE                            
0088E4EE                            loc_D726:
0088E4EE 5446                       		addq.w	#2,d6
0088E4F0 5554                       		subq.w	#2,(a4)
0088E4F2 6600 FF46                  		bne.w	loc_D672
0088E4F6                            
0088E4F6                            loc_D72E:
0088E4F6 49EC 0080                  		lea	$80(a4),a4
0088E4FA 51CF FF36                  		dbf	d7,loc_D66A
0088E4FE 11C5 F62C                  		move.b	d5,(v_spritecount).w
0088E502 0C05 0050                  		cmpi.b	#$50,d5
0088E506 6700                       		beq.s	loc_D748
0088E508 24BC 0000 0000             		move.l	#0,(a2)
0088E50E 4E75                       		rts	
0088E510                            ; ===========================================================================
0088E510                            
0088E510                            loc_D748:
0088E510 157C 0000 FFFB             		move.b	#0,-5(a2)
0088E516 4E75                       		rts	
0088E518                            ; End of function BuildSprites
0088E518                            
0088E518                            
0088E518                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E518                            
0088E518                            
0088E518                            sub_D750:				; XREF: BuildSprites
0088E518 3668 0002                  		movea.w	obGfx(a0),a3
0088E51C 0804 0000                  		btst	#0,d4
0088E520 6600                       		bne.s	loc_D796
0088E522 0804 0001                  		btst	#1,d4
0088E526 6600 0000                  		bne.w	loc_D7E4
0088E52A                            ; End of function sub_D750
0088E52A                            
0088E52A                            
0088E52A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E52A                            
0088E52A                            
0088E52A                            sub_D762:				; XREF: sub_D762; SS_ShowLayout
0088E52A 0C05 0050                  		cmpi.b	#$50,d5
0088E52E 6700                       		beq.s	locret_D794
0088E530 1019                       		move.b	(a1)+,d0
0088E532 4880                       		ext.w	d0
0088E534 D042                       		add.w	d2,d0
0088E536 34C0                       		move.w	d0,(a2)+
0088E538 14D9                       		move.b	(a1)+,(a2)+
0088E53A 5205                       		addq.b	#1,d5
0088E53C 14C5                       		move.b	d5,(a2)+
0088E53E 1019                       		move.b	(a1)+,d0
0088E540 E148                       		lsl.w	#8,d0
0088E542 1019                       		move.b	(a1)+,d0
0088E544 D04B                       		add.w	a3,d0
0088E546 34C0                       		move.w	d0,(a2)+
0088E548 1019                       		move.b	(a1)+,d0
0088E54A 4880                       		ext.w	d0
0088E54C D043                       		add.w	d3,d0
0088E54E 0240 01FF                  		andi.w	#$1FF,d0
0088E552 6600                       		bne.s	loc_D78E
0088E554 5240                       		addq.w	#1,d0
0088E556                            
0088E556                            loc_D78E:
0088E556 34C0                       		move.w	d0,(a2)+
0088E558 51C9 FFD0                  		dbf	d1,sub_D762
0088E55C                            
0088E55C                            locret_D794:
0088E55C 4E75                       		rts	
0088E55E                            ; End of function sub_D762
0088E55E                            
0088E55E                            ; ===========================================================================
0088E55E                            
0088E55E                            loc_D796:
0088E55E 0804 0001                  		btst	#1,d4
0088E562 6600 0000                  		bne.w	loc_D82A
0088E566                            
0088E566                            loc_D79E:
0088E566 0C05 0050                  		cmpi.b	#$50,d5
0088E56A 6700                       		beq.s	locret_D7E2
0088E56C 1019                       		move.b	(a1)+,d0
0088E56E 4880                       		ext.w	d0
0088E570 D042                       		add.w	d2,d0
0088E572 34C0                       		move.w	d0,(a2)+
0088E574 1819                       		move.b	(a1)+,d4
0088E576 14C4                       		move.b	d4,(a2)+
0088E578 5205                       		addq.b	#1,d5
0088E57A 14C5                       		move.b	d5,(a2)+
0088E57C 1019                       		move.b	(a1)+,d0
0088E57E E148                       		lsl.w	#8,d0
0088E580 1019                       		move.b	(a1)+,d0
0088E582 D04B                       		add.w	a3,d0
0088E584 0A40 0800                  		eori.w	#$800,d0
0088E588 34C0                       		move.w	d0,(a2)+
0088E58A 1019                       		move.b	(a1)+,d0
0088E58C 4880                       		ext.w	d0
0088E58E 4440                       		neg.w	d0
0088E590 D804                       		add.b	d4,d4
0088E592 0244 0018                  		andi.w	#$18,d4
0088E596 5044                       		addq.w	#8,d4
0088E598 9044                       		sub.w	d4,d0
0088E59A D043                       		add.w	d3,d0
0088E59C 0240 01FF                  		andi.w	#$1FF,d0
0088E5A0 6600                       		bne.s	loc_D7DC
0088E5A2 5240                       		addq.w	#1,d0
0088E5A4                            
0088E5A4                            loc_D7DC:
0088E5A4 34C0                       		move.w	d0,(a2)+
0088E5A6 51C9 FFBE                  		dbf	d1,loc_D79E
0088E5AA                            
0088E5AA                            locret_D7E2:
0088E5AA 4E75                       		rts	
0088E5AC                            ; ===========================================================================
0088E5AC                            
0088E5AC                            loc_D7E4:				; XREF: sub_D750
0088E5AC 0C05 0050                  		cmpi.b	#$50,d5
0088E5B0 6700                       		beq.s	locret_D828
0088E5B2 1019                       		move.b	(a1)+,d0
0088E5B4 1811                       		move.b	(a1),d4
0088E5B6 4880                       		ext.w	d0
0088E5B8 4440                       		neg.w	d0
0088E5BA E70C                       		lsl.b	#3,d4
0088E5BC 0244 0018                  		andi.w	#$18,d4
0088E5C0 5044                       		addq.w	#8,d4
0088E5C2 9044                       		sub.w	d4,d0
0088E5C4 D042                       		add.w	d2,d0
0088E5C6 34C0                       		move.w	d0,(a2)+
0088E5C8 14D9                       		move.b	(a1)+,(a2)+
0088E5CA 5205                       		addq.b	#1,d5
0088E5CC 14C5                       		move.b	d5,(a2)+
0088E5CE 1019                       		move.b	(a1)+,d0
0088E5D0 E148                       		lsl.w	#8,d0
0088E5D2 1019                       		move.b	(a1)+,d0
0088E5D4 D04B                       		add.w	a3,d0
0088E5D6 0A40 1000                  		eori.w	#$1000,d0
0088E5DA 34C0                       		move.w	d0,(a2)+
0088E5DC 1019                       		move.b	(a1)+,d0
0088E5DE 4880                       		ext.w	d0
0088E5E0 D043                       		add.w	d3,d0
0088E5E2 0240 01FF                  		andi.w	#$1FF,d0
0088E5E6 6600                       		bne.s	loc_D822
0088E5E8 5240                       		addq.w	#1,d0
0088E5EA                            
0088E5EA                            loc_D822:
0088E5EA 34C0                       		move.w	d0,(a2)+
0088E5EC 51C9 FFBE                  		dbf	d1,loc_D7E4
0088E5F0                            
0088E5F0                            locret_D828:
0088E5F0 4E75                       		rts	
0088E5F2                            ; ===========================================================================
0088E5F2                            
0088E5F2                            loc_D82A:
0088E5F2 0C05 0050                  		cmpi.b	#$50,d5
0088E5F6 6700                       		beq.s	locret_D87C
0088E5F8 1019                       		move.b	(a1)+,d0
0088E5FA 1811                       		move.b	(a1),d4
0088E5FC 4880                       		ext.w	d0
0088E5FE 4440                       		neg.w	d0
0088E600 E70C                       		lsl.b	#3,d4
0088E602 0244 0018                  		andi.w	#$18,d4
0088E606 5044                       		addq.w	#8,d4
0088E608 9044                       		sub.w	d4,d0
0088E60A D042                       		add.w	d2,d0
0088E60C 34C0                       		move.w	d0,(a2)+
0088E60E 1819                       		move.b	(a1)+,d4
0088E610 14C4                       		move.b	d4,(a2)+
0088E612 5205                       		addq.b	#1,d5
0088E614 14C5                       		move.b	d5,(a2)+
0088E616 1019                       		move.b	(a1)+,d0
0088E618 E148                       		lsl.w	#8,d0
0088E61A 1019                       		move.b	(a1)+,d0
0088E61C D04B                       		add.w	a3,d0
0088E61E 0A40 1800                  		eori.w	#$1800,d0
0088E622 34C0                       		move.w	d0,(a2)+
0088E624 1019                       		move.b	(a1)+,d0
0088E626 4880                       		ext.w	d0
0088E628 4440                       		neg.w	d0
0088E62A D804                       		add.b	d4,d4
0088E62C 0244 0018                  		andi.w	#$18,d4
0088E630 5044                       		addq.w	#8,d4
0088E632 9044                       		sub.w	d4,d0
0088E634 D043                       		add.w	d3,d0
0088E636 0240 01FF                  		andi.w	#$1FF,d0
0088E63A 6600                       		bne.s	loc_D876
0088E63C 5240                       		addq.w	#1,d0
0088E63E                            
0088E63E                            loc_D876:
0088E63E 34C0                       		move.w	d0,(a2)+
0088E640 51C9 FFB0                  		dbf	d1,loc_D82A
0088E644                            
0088E644                            locret_D87C:
0088E644 4E75                       		rts	
0088E646                            
0088E646                            		include	"_incObj\sub ChkObjectVisible.asm"
0088E646                            ; ---------------------------------------------------------------------------
0088E646                            ; Subroutine to	check if an object is off screen
0088E646                            
0088E646                            ; output:
0088E646                            ;	d0 = flag set if object is off screen
0088E646                            ; ---------------------------------------------------------------------------
0088E646                            
0088E646                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E646                            
0088E646                            
0088E646                            ChkObjectVisible:
0088E646 3028 0008                  		move.w	obX(a0),d0	; get object x-position
0088E64A 9078 F700                  		sub.w	(v_screenposx).w,d0 ; subtract screen x-position
0088E64E 6B00                       		bmi.s	@offscreen
0088E650 0C40 0140                  		cmpi.w	#320,d0		; is object on the screen?
0088E654 6C00                       		bge.s	@offscreen	; if not, branch
0088E656                            
0088E656 3228 000C                  		move.w	obY(a0),d1	; get object y-position
0088E65A 9278 F704                  		sub.w	(v_screenposy).w,d1 ; subtract screen y-position
0088E65E 6B00                       		bmi.s	@offscreen
0088E660 0C41 00E0                  		cmpi.w	#224,d1		; is object on the screen?
0088E664 6C00                       		bge.s	@offscreen	; if not, branch
0088E666                            
0088E666 7000                       		moveq	#0,d0		; set flag to 0
0088E668 4E75                       		rts	
0088E66A                            
0088E66A                            	@offscreen:
0088E66A 7001                       		moveq	#1,d0		; set flag to 1
0088E66C 4E75                       		rts	
0088E66E                            ; End of function ChkObjectVisible
0088E66E                            
0088E66E                            ; ---------------------------------------------------------------------------
0088E66E                            ; Subroutine to	check if an object is off screen
0088E66E                            ; More precise than above subroutine, taking width into account
0088E66E                            
0088E66E                            ; output:
0088E66E                            ;	d0 = flag set if object is off screen
0088E66E                            ; ---------------------------------------------------------------------------
0088E66E                            
0088E66E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E66E                            
0088E66E                            
0088E66E                            ChkPartiallyVisible:
0088E66E 7200                       		moveq	#0,d1
0088E670 1228 0019                  		move.b	obActWid(a0),d1
0088E674 3028 0008                  		move.w	obX(a0),d0	; get object x-position
0088E678 9078 F700                  		sub.w	(v_screenposx).w,d0 ; subtract screen x-position
0088E67C D041                       		add.w	d1,d0		; add object width
0088E67E 6B00                       		bmi.s	@offscreen2
0088E680 D241                       		add.w	d1,d1
0088E682 9041                       		sub.w	d1,d0
0088E684 0C40 0140                  		cmpi.w	#320,d0
0088E688 6C00                       		bge.s	@offscreen2
0088E68A                            
0088E68A 3228 000C                  		move.w	obY(a0),d1
0088E68E 9278 F704                  		sub.w	(v_screenposy).w,d1
0088E692 6B00                       		bmi.s	@offscreen2
0088E694 0C41 00E0                  		cmpi.w	#224,d1
0088E698 6C00                       		bge.s	@offscreen2
0088E69A                            
0088E69A 7000                       		moveq	#0,d0
0088E69C 4E75                       		rts	
0088E69E                            
0088E69E                            	@offscreen2:
0088E69E 7001                       		moveq	#1,d0
0088E6A0 4E75                       		rts	
0088E6A2                            ; End of function ChkPartiallyVisible
0088E6A2                            ; End of function ChkPartiallyVisible
0088E6A2                            
0088E6A2                            ; ---------------------------------------------------------------------------
0088E6A2                            ; Subroutine to	load a level's objects
0088E6A2                            ; ---------------------------------------------------------------------------
0088E6A2                            
0088E6A2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E6A2                            
0088E6A2                            
0088E6A2                            ObjPosLoad:				; XREF: GM_Level; et al
0088E6A2 7000                       		moveq	#0,d0
0088E6A4 1038 F76C                  		move.b	(v_opl_routine).w,d0
0088E6A8 303B 0000                  		move.w	OPL_Index(pc,d0.w),d0
0088E6AC 4EFB 0000                  		jmp	OPL_Index(pc,d0.w)
0088E6B0                            ; End of function ObjPosLoad
0088E6B0                            
0088E6B0                            ; ===========================================================================
0088E6B0 0000                       OPL_Index:	dc.w OPL_Main-OPL_Index
0088E6B2 0000                       		dc.w OPL_Next-OPL_Index
0088E6B4                            ; ===========================================================================
0088E6B4                            
0088E6B4                            OPL_Main:				; XREF: OPL_Index
0088E6B4 5438 F76C                  		addq.b	#2,(v_opl_routine).w
0088E6B8 3038 FE10                  		move.w	(v_zone).w,d0
0088E6BC ED08                       		lsl.b	#6,d0
0088E6BE E848                       		lsr.w	#4,d0
0088E6C0 41F9 0000 0000             		lea	(ObjPos_Index).l,a0
0088E6C6 2248                       		movea.l	a0,a1
0088E6C8 D0F0 0000                  		adda.w	(a0,d0.w),a0
0088E6CC 21C8 F770                  		move.l	a0,(v_opl_data).w
0088E6D0 21C8 F774                  		move.l	a0,(v_opl_data+4).w
0088E6D4 D2F1 0002                  		adda.w	2(a1,d0.w),a1
0088E6D8 21C9 F778                  		move.l	a1,(v_opl_data+8).w
0088E6DC 21C9 F77C                  		move.l	a1,(v_opl_data+$C).w
0088E6E0 45F8 FC00                  		lea	(v_objstate).w,a2
0088E6E4 34FC 0101                  		move.w	#$101,(a2)+
0088E6E8 303C 005E                  		move.w	#$5E,d0
0088E6EC                            
0088E6EC                            OPL_ClrList:
0088E6EC 429A                       		clr.l	(a2)+
0088E6EE 51C8 FFFC                  		dbf	d0,OPL_ClrList	; clear	pre-destroyed object list
0088E6F2                            		
0088E6F2                            	;Mercury SLZ Pylons Fix
0088E6F2 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w
0088E6F8 6600                       		bne.s	@notSLZ
0088E6FA 11FC 005C D800             		move.b	#id_Pylon,(v_lvlobjspace).w
0088E700                            	@notSLZ:
0088E700                            	;end SLZ Pylons Fix
0088E700                            
0088E700 45F8 FC00                  		lea	(v_objstate).w,a2
0088E704 7400                       		moveq	#0,d2
0088E706 3C38 F700                  		move.w	(v_screenposx).w,d6
0088E70A 0446 0080                  		subi.w	#$80,d6
0088E70E 6400                       		bcc.s	loc_D93C
0088E710 7C00                       		moveq	#0,d6
0088E712                            
0088E712                            loc_D93C:
0088E712 0246 FF80                  		andi.w	#$FF80,d6
0088E716 2078 F770                  		movea.l	(v_opl_data).w,a0
0088E71A                            
0088E71A                            loc_D944:
0088E71A BC50                       		cmp.w	(a0),d6
0088E71C 6300                       		bls.s	loc_D956
0088E71E 4A28 0004                  		tst.b	4(a0)
0088E722 6A00                       		bpl.s	loc_D952
0088E724 1412                       		move.b	(a2),d2
0088E726 5212                       		addq.b	#1,(a2)
0088E728                            
0088E728                            loc_D952:
0088E728 5C48                       		addq.w	#6,a0
0088E72A 60EE                       		bra.s	loc_D944
0088E72C                            ; ===========================================================================
0088E72C                            
0088E72C                            loc_D956:
0088E72C 21C8 F770                  		move.l	a0,(v_opl_data).w
0088E730 2078 F774                  		movea.l	(v_opl_data+4).w,a0
0088E734 0446 0080                  		subi.w	#$80,d6
0088E738 6500                       		bcs.s	loc_D976
0088E73A                            
0088E73A                            loc_D964:
0088E73A BC50                       		cmp.w	(a0),d6
0088E73C 6300                       		bls.s	loc_D976
0088E73E 4A28 0004                  		tst.b	4(a0)
0088E742 6A00                       		bpl.s	loc_D972
0088E744 522A 0001                  		addq.b	#1,1(a2)
0088E748                            
0088E748                            loc_D972:
0088E748 5C48                       		addq.w	#6,a0
0088E74A 60EE                       		bra.s	loc_D964
0088E74C                            ; ===========================================================================
0088E74C                            
0088E74C                            loc_D976:
0088E74C 21C8 F774                  		move.l	a0,(v_opl_data+4).w
0088E750 31FC FFFF F76E             		move.w	#-1,(v_opl_screen).w
0088E756                            
0088E756                            OPL_Next:				; XREF: OPL_Index
0088E756 45F8 FC00                  		lea	(v_objstate).w,a2
0088E75A 7400                       		moveq	#0,d2
0088E75C 3C38 F700                  		move.w	(v_screenposx).w,d6
0088E760 0246 FF80                  		andi.w	#$FF80,d6
0088E764 BC78 F76E                  		cmp.w	(v_opl_screen).w,d6
0088E768 6700 0000                  		beq.w	locret_DA3A
0088E76C 6C00                       		bge.s	loc_D9F6
0088E76E 31C6 F76E                  		move.w	d6,(v_opl_screen).w
0088E772 2078 F774                  		movea.l	(v_opl_data+4).w,a0
0088E776 0446 0080                  		subi.w	#$80,d6
0088E77A 6500                       		bcs.s	loc_D9D2
0088E77C                            
0088E77C                            loc_D9A6:
0088E77C BC68 FFFA                  		cmp.w	-6(a0),d6
0088E780 6C00                       		bge.s	loc_D9D2
0088E782 5D48                       		subq.w	#6,a0
0088E784 4A28 0004                  		tst.b	4(a0)
0088E788 6A00                       		bpl.s	loc_D9BC
0088E78A 532A 0001                  		subq.b	#1,1(a2)
0088E78E 142A 0001                  		move.b	1(a2),d2
0088E792                            
0088E792                            loc_D9BC:
0088E792 6100 0000                  		bsr.w	loc_DA3C
0088E796 6600                       		bne.s	loc_D9C6
0088E798 5D48                       		subq.w	#6,a0
0088E79A 60E0                       		bra.s	loc_D9A6
0088E79C                            ; ===========================================================================
0088E79C                            
0088E79C                            loc_D9C6:
0088E79C 4A28 0004                  		tst.b	4(a0)
0088E7A0 6A00                       		bpl.s	loc_D9D0
0088E7A2 522A 0001                  		addq.b	#1,1(a2)
0088E7A6                            
0088E7A6                            loc_D9D0:
0088E7A6 5C48                       		addq.w	#6,a0
0088E7A8                            
0088E7A8                            loc_D9D2:
0088E7A8 21C8 F774                  		move.l	a0,(v_opl_data+4).w
0088E7AC 2078 F770                  		movea.l	(v_opl_data).w,a0
0088E7B0 0646 0300                  		addi.w	#$300,d6
0088E7B4                            
0088E7B4                            loc_D9DE:
0088E7B4 BC68 FFFA                  		cmp.w	-6(a0),d6
0088E7B8 6E00                       		bgt.s	loc_D9F0
0088E7BA 4A28 FFFE                  		tst.b	-2(a0)
0088E7BE 6A00                       		bpl.s	loc_D9EC
0088E7C0 5312                       		subq.b	#1,(a2)
0088E7C2                            
0088E7C2                            loc_D9EC:
0088E7C2 5D48                       		subq.w	#6,a0
0088E7C4 60EE                       		bra.s	loc_D9DE
0088E7C6                            ; ===========================================================================
0088E7C6                            
0088E7C6                            loc_D9F0:
0088E7C6 21C8 F770                  		move.l	a0,(v_opl_data).w
0088E7CA 4E75                       		rts	
0088E7CC                            ; ===========================================================================
0088E7CC                            
0088E7CC                            loc_D9F6:
0088E7CC 31C6 F76E                  		move.w	d6,(v_opl_screen).w
0088E7D0 2078 F770                  		movea.l	(v_opl_data).w,a0
0088E7D4 0646 0280                  		addi.w	#$280,d6
0088E7D8                            
0088E7D8                            loc_DA02:
0088E7D8 BC50                       		cmp.w	(a0),d6
0088E7DA 6300                       		bls.s	loc_DA16
0088E7DC 4A28 0004                  		tst.b	4(a0)
0088E7E0 6A00                       		bpl.s	loc_DA10
0088E7E2 1412                       		move.b	(a2),d2
0088E7E4 5212                       		addq.b	#1,(a2)
0088E7E6                            
0088E7E6                            loc_DA10:
0088E7E6 6100 0000                  		bsr.w	loc_DA3C
0088E7EA 67EC                       		beq.s	loc_DA02
0088E7EC                            
0088E7EC                            loc_DA16:
0088E7EC 21C8 F770                  		move.l	a0,(v_opl_data).w
0088E7F0 2078 F774                  		movea.l	(v_opl_data+4).w,a0
0088E7F4 0446 0300                  		subi.w	#$300,d6
0088E7F8 6500                       		bcs.s	loc_DA36
0088E7FA                            
0088E7FA                            loc_DA24:
0088E7FA BC50                       		cmp.w	(a0),d6
0088E7FC 6300                       		bls.s	loc_DA36
0088E7FE 4A28 0004                  		tst.b	4(a0)
0088E802 6A00                       		bpl.s	loc_DA32
0088E804 522A 0001                  		addq.b	#1,1(a2)
0088E808                            
0088E808                            loc_DA32:
0088E808 5C48                       		addq.w	#6,a0
0088E80A 60EE                       		bra.s	loc_DA24
0088E80C                            ; ===========================================================================
0088E80C                            
0088E80C                            loc_DA36:
0088E80C 21C8 F774                  		move.l	a0,(v_opl_data+4).w
0088E810                            
0088E810                            locret_DA3A:
0088E810 4E75                       		rts	
0088E812                            ; ===========================================================================
0088E812                            
0088E812                            loc_DA3C:
0088E812 4A28 0004                  		tst.b	4(a0)
0088E816 6A00                       		bpl.s	OPL_MakeItem
0088E818 08F2 0007 2002             		bset	#7,2(a2,d2.w)
0088E81E 6700                       		beq.s	OPL_MakeItem
0088E820 5C48                       		addq.w	#6,a0
0088E822 7000                       		moveq	#0,d0
0088E824 4E75                       		rts	
0088E826                            ; ===========================================================================
0088E826                            
0088E826                            OPL_MakeItem:
0088E826 6100 0000                  		bsr.w	FindFreeObj
0088E82A 6600                       		bne.s	locret_DA8A
0088E82C 3358 0008                  		move.w	(a0)+,obX(a1)
0088E830 3018                       		move.w	(a0)+,d0
0088E832 3200                       		move.w	d0,d1
0088E834 0240 0FFF                  		andi.w	#$FFF,d0
0088E838 3340 000C                  		move.w	d0,obY(a1)
0088E83C E559                       		rol.w	#2,d1
0088E83E 0201 0003                  		andi.b	#3,d1
0088E842 1341 0001                  		move.b	d1,obRender(a1)
0088E846 1341 0022                  		move.b	d1,obStatus(a1)
0088E84A 1018                       		move.b	(a0)+,d0
0088E84C 6A00                       		bpl.s	loc_DA80
0088E84E 0200 007F                  		andi.b	#$7F,d0
0088E852 1342 0023                  		move.b	d2,obRespawnNo(a1)
0088E856                            
0088E856                            loc_DA80:
0088E856 1340 0000                  		move.b	d0,0(a1)
0088E85A 1358 0028                  		move.b	(a0)+,obSubtype(a1)
0088E85E 7000                       		moveq	#0,d0
0088E860                            
0088E860                            locret_DA8A:
0088E860 4E75                       		rts	
0088E862                            
0088E862                            		include	"_incObj\sub FindFreeObj.asm"
0088E862                            ; ---------------------------------------------------------------------------
0088E862                            ; Subroutine to find a free object space
0088E862                            
0088E862                            ; output:
0088E862                            ;	a1 = free position in object RAM
0088E862                            ; ---------------------------------------------------------------------------
0088E862                            
0088E862                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E862                            
0088E862                            
0088E862                            FindFreeObj:
0088E862 43F8 D800                  		lea	(v_objspace+$800).w,a1 ; start address for object RAM
0088E866 303C 005F                  		move.w	#$5F,d0
0088E86A                            
0088E86A                            	FFree_Loop:
0088E86A 4A11                       		tst.b	(a1)		; is object RAM	slot empty?
0088E86C 6700                       		beq.s	FFree_Found	; if yes, branch
0088E86E 43E9 0040                  		lea	$40(a1),a1	; goto next object RAM slot
0088E872 51C8 FFF6                  		dbf	d0,FFree_Loop	; repeat $5F times
0088E876                            
0088E876                            	FFree_Found:
0088E876 4E75                       		rts	
0088E878                            
0088E878                            ; End of function FindFreeObj
0088E878                            
0088E878                            
0088E878                            ; ---------------------------------------------------------------------------
0088E878                            ; Subroutine to find a free object space AFTER the current one
0088E878                            
0088E878                            ; output:
0088E878                            ;	a1 = free position in object RAM
0088E878                            ; ---------------------------------------------------------------------------
0088E878                            
0088E878                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088E878                            
0088E878                            
0088E878                            FindNextFreeObj:
0088E878 2248                       		movea.l	a0,a1
0088E87A 303C F000                  		move.w	#$F000,d0
0088E87E 9048                       		sub.w	a0,d0
0088E880 EC48                       		lsr.w	#6,d0
0088E882 5340                       		subq.w	#1,d0
0088E884 6500                       		bcs.s	NFree_Found
0088E886                            
0088E886                            	NFree_Loop:
0088E886 4A11                       		tst.b	(a1)
0088E888 6700                       		beq.s	NFree_Found
0088E88A 43E9 0040                  		lea	$40(a1),a1
0088E88E 51C8 FFF6                  		dbf	d0,NFree_Loop
0088E892                            
0088E892                            	NFree_Found:
0088E892 4E75                       		rts	
0088E894                            
0088E894                            ; End of function FindNextFreeObj
0088E894                            ; End of function FindNextFreeObj
0088E894                            		include	"_incObj\41 Springs.asm"
0088E894                            ; ---------------------------------------------------------------------------
0088E894                            ; Object 41 - springs
0088E894                            ; ---------------------------------------------------------------------------
0088E894                            
0088E894                            Springs:				; XREF: Obj_Index
0088E894 7000                       		moveq	#0,d0
0088E896 1028 0024                  		move.b	obRoutine(a0),d0
0088E89A 323B 0000                  		move.w	Spring_Index(pc,d0.w),d1
0088E89E 4EBB 1000                  		jsr	Spring_Index(pc,d1.w)
0088E8A2 6100 FB28                  		bsr.w	DisplaySprite
0088E8C4 4E75                       		rts	
0088E8C6                            ; ===========================================================================
0088E8C6 0000                       Spring_Index:	dc.w Spring_Main-Spring_Index
0088E8C8 0000                       		dc.w Spring_Up-Spring_Index
0088E8CA 0000                       		dc.w Spring_AniUp-Spring_Index
0088E8CC 0000                       		dc.w Spring_ResetUp-Spring_Index
0088E8CE 0000                       		dc.w Spring_LR-Spring_Index
0088E8D0 0000                       		dc.w Spring_AniLR-Spring_Index
0088E8D2 0000                       		dc.w Spring_ResetLR-Spring_Index
0088E8D4 0000                       		dc.w Spring_Dwn-Spring_Index
0088E8D6 0000                       		dc.w Spring_AniDwn-Spring_Index
0088E8D8 0000                       		dc.w Spring_ResetDwn-Spring_Index
0088E8DA                            
0088E8DA =00000030                  spring_pow:	= $30			; power of current spring
0088E8DA                            
0088E8DA F000                       Spring_Powers:	dc.w -$1000		; power	of red spring
0088E8DC F600                       		dc.w -$A00		; power	of yellow spring
0088E8DE                            ; ===========================================================================
0088E8DE                            
0088E8DE                            Spring_Main:	; Routine 0
0088E8DE 5428 0024                  		addq.b	#2,obRoutine(a0)
0088E8E2 217C 0000 0000 0004        		move.l	#Map_Spring,obMap(a0)
0088E8EA 317C 0523 0002             		move.w	#$523,obGfx(a0)
0088E8F0 0028 0004 0001             		ori.b	#4,obRender(a0)
0088E8F6 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088E8FC 117C 0004 0018             		move.b	#4,obPriority(a0)
0088E902 1028 0028                  		move.b	obSubtype(a0),d0
0088E906 0800 0004                  		btst	#4,d0		; does the spring face left/right?
0088E90A 6700                       		beq.s	Spring_NotLR	; if not, branch
0088E90C                            
0088E90C 117C 0008 0024             		move.b	#8,obRoutine(a0) ; use "Spring_LR" routine
0088E912 117C 0001 001C             		move.b	#1,obAnim(a0)
0088E918 117C 0003 001A             		move.b	#3,obFrame(a0)
0088E91E 317C 0533 0002             		move.w	#$533,obGfx(a0)
0088E924 117C 0008 0019             		move.b	#8,obActWid(a0)
0088E92A                            
0088E92A                            	Spring_NotLR:
0088E92A 0800 0005                  		btst	#5,d0		; does the spring face downwards?
0088E92E 6700                       		beq.s	Spring_NotDwn	; if not, branch
0088E930                            
0088E930 117C 000E 0024             		move.b	#$E,obRoutine(a0) ; use "Spring_Dwn" routine
0088E936 08E8 0001 0022             		bset	#1,obStatus(a0)
0088E93C                            
0088E93C                            	Spring_NotDwn:
0088E93C 0800 0001                  		btst	#1,d0
0088E940 6700                       		beq.s	loc_DB72
0088E942 08E8 0005 0002             		bset	#5,obGfx(a0)
0088E948                            
0088E948                            loc_DB72:
0088E948 0240 000F                  		andi.w	#$F,d0
0088E94C 317B 008C 0030             		move.w	Spring_Powers(pc,d0.w),spring_pow(a0)
0088E952 4E75                       		rts	
0088E954                            ; ===========================================================================
0088E954                            
0088E954                            Spring_Up:	; Routine 2
0088E954 323C 001B                  		move.w	#$1B,d1
0088E958 343C 0008                  		move.w	#8,d2
0088E95C 363C 0010                  		move.w	#$10,d3
0088E960 3828 0008                  		move.w	obX(a0),d4
0088E964 6100 0000                  		bsr.w	SolidObject
0088E968 4A28 0025                  		tst.b	ob2ndRout(a0)	; is Sonic on top of the spring?
0088E96C 6600                       		bne.s	Spring_BounceUp	; if yes, branch
0088E96E 4E75                       		rts	
0088E970                            ; ===========================================================================
0088E970                            
0088E970                            Spring_BounceUp:
0088E970 5428 0024                  		addq.b	#2,obRoutine(a0)
0088E974 5069 000C                  		addq.w	#8,obY(a1)
0088E978 3368 0030 0012             		move.w	spring_pow(a0),obVelY(a1) ; move Sonic upwards
0088E97E 08E9 0001 0022             		bset	#1,obStatus(a1)
0088E984 08A9 0003 0022             		bclr	#3,obStatus(a1)
0088E98A 137C 0000 001C             		move.b	#id_Spring,obAnim(a1) ; use "bouncing" animation
0088E990 137C 0002 0024             		move.b	#2,obRoutine(a1)
0088E996 08A8 0003 0022             		bclr	#3,obStatus(a0)
0088E99C 4228 0025                  		clr.b	ob2ndRout(a0)
0088E9AA                            
0088E9AA                            Spring_AniUp:	; Routine 4
0088E9AA 43F9 0000 0000             		lea	(Ani_Spring).l,a1
0088E9B0 6000 CAFE                  		bra.w	AnimateSprite
0088E9B4                            ; ===========================================================================
0088E9B4                            
0088E9B4                            Spring_ResetUp:	; Routine 6
0088E9B4 117C 0001 001D             		move.b	#1,obNextAni(a0) ; reset animation
0088E9BA 5928 0024                  		subq.b	#4,obRoutine(a0) ; goto "Spring_Up" routine
0088E9BE 4E75                       		rts	
0088E9C0                            ; ===========================================================================
0088E9C0                            
0088E9C0                            Spring_LR:	; Routine 8
0088E9C0 323C 0013                  		move.w	#$13,d1
0088E9C4 343C 000E                  		move.w	#$E,d2
0088E9C8 363C 000F                  		move.w	#$F,d3
0088E9CC 3828 0008                  		move.w	obX(a0),d4
0088E9D0 6100 0000                  		bsr.w	SolidObject
0088E9D4 0C28 0002 0024             		cmpi.b	#2,obRoutine(a0)
0088E9DA 6600                       		bne.s	loc_DC0C
0088E9DC 117C 0008 0024             		move.b	#8,obRoutine(a0)
0088E9E2                            
0088E9E2                            loc_DC0C:
0088E9E2 0828 0005 0022             		btst	#staPush,obStatus(a0)	;Mercury Constants
0088E9E8 6600                       		bne.s	Spring_BounceLR
0088E9EA 4E75                       		rts	
0088E9EC                            ; ===========================================================================
0088E9EC                            
0088E9EC                            Spring_BounceLR:
0088E9EC 5428 0024                  		addq.b	#2,obRoutine(a0)
0088E9F0 3368 0030 0010             		move.w	spring_pow(a0),obVelX(a1) ; move Sonic to the left
0088E9F6 5069 0008                  		addq.w	#8,obX(a1)
0088E9FA 0828 0000 0022             		btst	#0,obStatus(a0)	; is object flipped?
0088EA00 6600                       		bne.s	Spring_Flipped	; if yes, branch
0088EA02 0469 0010 0008             		subi.w	#$10,obX(a1)
0088EA08 4469 0010                  		neg.w	obVelX(a1)	; move Sonic to	the right
0088EA0C                            
0088EA0C                            	Spring_Flipped:
0088EA0C 337C 000F 003E             		move.w	#$F,$3E(a1)
0088EA12 3369 0010 0014             		move.w	obVelX(a1),obInertia(a1)
0088EA18 0869 0000 0022             		bchg	#0,obStatus(a1)
0088EA1E 0829 0002 0022             		btst	#2,obStatus(a1)
0088EA24 6600                       		bne.s	loc_DC56
0088EA26 137C 0000 001C             		move.b	#0,obAnim(a1)	; use running animation
0088EA2C                            
0088EA2C                            loc_DC56:
0088EA2C 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
0088EA32 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
0088EA38                            		
0088EA38 4238 FEB3                  		clr.b	(v_cameralag).w
0088EA3C                            		
0088EA46                            
0088EA46                            Spring_AniLR:	; Routine $A
0088EA46 43F9 0000 0000             		lea	(Ani_Spring).l,a1
0088EA4C 6000 CA62                  		bra.w	AnimateSprite
0088EA50                            ; ===========================================================================
0088EA50                            
0088EA50                            Spring_ResetLR:	; Routine $C
0088EA50 117C 0002 001D             		move.b	#2,obNextAni(a0) ; reset animation
0088EA56 5928 0024                  		subq.b	#4,obRoutine(a0) ; goto "Spring_LR" routine
0088EA5A 4E75                       		rts	
0088EA5C                            ; ===========================================================================
0088EA5C                            
0088EA5C                            Spring_Dwn:	; Routine $E
0088EA5C 323C 001B                  		move.w	#$1B,d1
0088EA60 343C 0008                  		move.w	#8,d2
0088EA64 363C 0010                  		move.w	#$10,d3
0088EA68 3828 0008                  		move.w	obX(a0),d4
0088EA6C 6100 0000                  		bsr.w	SolidObject
0088EA70 0C28 0002 0024             		cmpi.b	#2,obRoutine(a0)
0088EA76 6600                       		bne.s	loc_DCA4
0088EA78 117C 000E 0024             		move.b	#$E,obRoutine(a0)
0088EA7E                            
0088EA7E                            loc_DCA4:
0088EA7E 4A28 0025                  		tst.b	ob2ndRout(a0)
0088EA82 6600                       		bne.s	locret_DCAE
0088EA84 4A44                       		tst.w	d4
0088EA86 6B00                       		bmi.s	Spring_BounceDwn
0088EA88                            
0088EA88                            locret_DCAE:
0088EA88 4E75                       		rts	
0088EA8A                            ; ===========================================================================
0088EA8A                            
0088EA8A                            Spring_BounceDwn:			; XREF: Spring_Dwn
0088EA8A 5428 0024                  		addq.b	#2,obRoutine(a0)
0088EA8E 5169 000C                  		subq.w	#8,obY(a1)
0088EA92 3368 0030 0012             		move.w	spring_pow(a0),obVelY(a1)
0088EA98 4469 0012                  		neg.w	obVelY(a1)	; move Sonic downwards
0088EA9C 08E9 0001 0022             		bset	#1,obStatus(a1)
0088EAA2 08A9 0003 0022             		bclr	#3,obStatus(a1)
0088EAA8 137C 0002 0024             		move.b	#2,obRoutine(a1)
0088EAAE 08A8 0003 0022             		bclr	#3,obStatus(a0)
0088EAB4 4228 0025                  		clr.b	ob2ndRout(a0)
0088EAC2                            
0088EAC2                            Spring_AniDwn:	; Routine $10
0088EAC2 43F9 0000 0000             		lea	(Ani_Spring).l,a1
0088EAC8 6000 C9E6                  		bra.w	AnimateSprite
0088EACC                            ; ===========================================================================
0088EACC                            
0088EACC                            Spring_ResetDwn:
0088EACC                            		; Routine $12
0088EACC 117C 0001 001D             		move.b	#1,obNextAni(a0) ; reset animation
0088EAD2 5928 0024                  		subq.b	#4,obRoutine(a0) ; goto "Spring_Dwn" routine
0088EAD6 4E75                       		rts	
0088EAD6 4E75                       		rts	
0088EAD8                            		include	"_anim\Springs.asm"
0088EAD8                            ; ---------------------------------------------------------------------------
0088EAD8                            ; Animation script - springs
0088EAD8                            ; ---------------------------------------------------------------------------
0088EAD8 0000                       Ani_Spring:	dc.w byte_DD02-Ani_Spring
0088EADA 0000                       		dc.w byte_DD0E-Ani_Spring
0088EADC 0001 0000 0202 0202 0202+  byte_DD02:	dc.b 0,	1, 0, 0, 2, 2, 2, 2, 2,	2, 0, afRoutine
0088EAE8 0004 0303 0505 0505 0505+  byte_DD0E:	dc.b 0,	4, 3, 3, 5, 5, 5, 5, 5,	5, 3, afRoutine
0088EAF4                            		even
0088EAF4                            		even
0088EAF4                            		include	"_maps\Springs.asm"
0088EAF4                            ; ---------------------------------------------------------------------------
0088EAF4                            ; Sprite mappings - springs
0088EAF4                            ; ---------------------------------------------------------------------------
0088EAF4 0000                       Map_Spring:	dc.w M_Spg_Up-Map_Spring
0088EAF6 0000                       		dc.w M_Spg_UpFlat-Map_Spring
0088EAF8 0000                       		dc.w M_Spg_UpExt-Map_Spring
0088EAFA 0000                       		dc.w M_Spg_Left-Map_Spring
0088EAFC 0000                       		dc.w M_Spg_LeftFlat-Map_Spring
0088EAFE 0000                       		dc.w M_Spg_LeftExt-Map_Spring
0088EB00 02                         M_Spg_Up:	dc.b 2			; facing up
0088EB01 F80C 0000 F0               		dc.b $F8, $C, 0, 0, $F0
0088EB06 000C 0004 F0               		dc.b 0,	$C, 0, 4, $F0
0088EB0B 01                         M_Spg_UpFlat:	dc.b 1			; facing up, flattened
0088EB0C 000C 0000 F0               		dc.b 0,	$C, 0, 0, $F0
0088EB11 03                         M_Spg_UpExt:	dc.b 3			; facing up, extended
0088EB12 E80C 0000 F0               		dc.b $E8, $C, 0, 0, $F0
0088EB17 F005 0008 F8               		dc.b $F0, 5, 0,	8, $F8
0088EB1C 000C 000C F0               		dc.b 0,	$C, 0, $C, $F0
0088EB21 01                         M_Spg_Left:	dc.b 1			; facing left
0088EB22 F007 0000 F8               		dc.b $F0, 7, 0,	0, $F8
0088EB27 01                         M_Spg_LeftFlat:	dc.b 1			; facing left, flattened
0088EB28 F003 0004 F8               		dc.b $F0, 3, 0,	4, $F8
0088EB2D 04                         M_Spg_LeftExt:	dc.b 4			; facing left, extended
0088EB2E F003 0004 10               		dc.b $F0, 3, 0,	4, $10
0088EB33 F809 0008 F8               		dc.b $F8, 9, 0,	8, $F8
0088EB38 F000 0000 F8               		dc.b $F0, 0, 0,	0, $F8
0088EB3D 0800 0003 F8               		dc.b 8,	0, 0, 3, $F8
0088EB42                            		even
0088EB42                            		even
0088EB42                            
0088EB42                            		include	"_incObj\42 Newtron.asm"
0088EB42                            ; ---------------------------------------------------------------------------
0088EB42                            ; Object 42 - Newtron enemy (GHZ)
0088EB42                            ; ---------------------------------------------------------------------------
0088EB42                            
0088EB42                            Newtron:				; XREF: Obj_Index
0088EB42 7000                       		moveq	#0,d0
0088EB44 1028 0024                  		move.b	obRoutine(a0),d0
0088EB48 323B 0000                  		move.w	Newt_Index(pc,d0.w),d1
0088EB4C 4EFB 1000                  		jmp	Newt_Index(pc,d1.w)
0088EB50                            ; ===========================================================================
0088EB50 0000                       Newt_Index:	dc.w Newt_Main-Newt_Index
0088EB52 0000                       		dc.w Newt_Action-Newt_Index
0088EB54 0000                       		dc.w Newt_Delete-Newt_Index
0088EB56                            ; ===========================================================================
0088EB56                            
0088EB56                            Newt_Main:	; Routine 0
0088EB56 5428 0024                  		addq.b	#2,obRoutine(a0)
0088EB5A 217C 0000 0000 0004        		move.l	#Map_Newt,obMap(a0)
0088EB62 317C 049B 0002             		move.w	#$49B,obGfx(a0)
0088EB68 117C 0004 0001             		move.b	#4,obRender(a0)
0088EB6E 117C 0004 0018             		move.b	#4,obPriority(a0)
0088EB74 117C 0014 0019             		move.b	#$14,obActWid(a0)
0088EB7A 117C 0010 0016             		move.b	#$10,obHeight(a0)
0088EB80 117C 0008 0017             		move.b	#8,obWidth(a0)
0088EB86                            
0088EB86                            Newt_Action:	; Routine 2
0088EB86 7000                       		moveq	#0,d0
0088EB88 1028 0025                  		move.b	ob2ndRout(a0),d0
0088EB8C 323B 0000                  		move.w	@index(pc,d0.w),d1
0088EB90 4EBB 1000                  		jsr	@index(pc,d1.w)
0088EB94 43F9 0000 0000             		lea	(Ani_Newt).l,a1
0088EB9A 6100 C914                  		bsr.w	AnimateSprite
0088EB9E 6000 0000                  		bra.w	RememberState
0088EBA2                            ; ===========================================================================
0088EBA2 0000                       @index:		dc.w @chkdistance-@index
0088EBA4 0000                       		dc.w @type00-@index
0088EBA6 0000                       		dc.w @matchfloor-@index
0088EBA8 0000                       		dc.w @speed-@index
0088EBAA 0000                       		dc.w @type01-@index
0088EBAC                            ; ===========================================================================
0088EBAC                            
0088EBAC                            @chkdistance:				; XREF: @index
0088EBAC 08E8 0000 0022             		bset	#0,obStatus(a0)
0088EBB2 3038 D008                  		move.w	(v_player+obX).w,d0
0088EBB6 9068 0008                  		sub.w	obX(a0),d0
0088EBBA 6400                       		bcc.s	@sonicisright
0088EBBC 4440                       		neg.w	d0
0088EBBE 08A8 0000 0022             		bclr	#0,obStatus(a0)
0088EBC4                            
0088EBC4                            	@sonicisright:
0088EBC4 0C40 0080                  		cmpi.w	#$80,d0		; is Sonic within $80 pixels of	the newtron?
0088EBC8 6400                       		bcc.s	@outofrange	; if not, branch
0088EBCA 5428 0025                  		addq.b	#2,ob2ndRout(a0) ; goto @type00 next
0088EBCE 117C 0001 001C             		move.b	#1,obAnim(a0)
0088EBD4 4A28 0028                  		tst.b	obSubtype(a0)	; check	object type
0088EBD8 6700                       		beq.s	@istype00	; if type is 00, branch
0088EBDA                            
0088EBDA 317C 249B 0002             		move.w	#$249B,obGfx(a0)
0088EBE0 117C 0008 0025             		move.b	#8,ob2ndRout(a0) ; goto @type01 next
0088EBE6 117C 0004 001C             		move.b	#4,obAnim(a0)	; use different	animation
0088EBEC                            
0088EBEC                            	@outofrange:
0088EBEC                            	@istype00:
0088EBEC 4E75                       		rts	
0088EBEE                            ; ===========================================================================
0088EBEE                            
0088EBEE                            @type00:				; XREF: @index
0088EBEE 0C28 0004 001A             		cmpi.b	#4,obFrame(a0)	; has "appearing" animation finished?
0088EBF4 6400                       		bcc.s	@fall		; is yes, branch
0088EBF6                            		
0088EBF6 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
0088EBFC 6500                       		bcs.s	@next
0088EBFE 117C 000C 0020             		move.b	#$C,obColType(a0)
0088EC04                            	@next:
0088EC04                            		
0088EC04 08E8 0000 0022             		bset	#0,obStatus(a0)
0088EC0A 3038 D008                  		move.w	(v_player+obX).w,d0
0088EC0E 9068 0008                  		sub.w	obX(a0),d0
0088EC12 6400                       		bcc.s	@sonicisright2
0088EC14 08A8 0000 0022             		bclr	#0,obStatus(a0)
0088EC1A                            
0088EC1A                            	@sonicisright2:
0088EC1A 4E75                       		rts	
0088EC1C                            ; ===========================================================================
0088EC1C                            
0088EC1C                            	@fall:
0088EC1C 0C28 0001 001A             		cmpi.b	#1,obFrame(a0)
0088EC22 6600                       		bne.s	@loc_DE42
0088EC24 117C 000C 0020             		move.b	#$C,obColType(a0)
0088EC2A                            
0088EC2A                            	@loc_DE42:
0088EC2A 6100 F766                  		bsr.w	ObjectMoveAndFall
0088EC2E 6100 0000                  		bsr.w	ObjFloorDist
0088EC32 4A41                       		tst.w	d1		; has newtron hit the floor?
0088EC34 6A00                       		bpl.s	@keepfalling	; if not, branch
0088EC36                            
0088EC36 D368 000C                  		add.w	d1,obY(a0)
0088EC3A 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop newtron falling
0088EC40 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088EC44 117C 0002 001C             		move.b	#2,obAnim(a0)
0088EC4A 0828 0005 0002             		btst	#5,obGfx(a0)
0088EC50 6700                       		beq.s	@pppppppp
0088EC52 5228 001C                  		addq.b	#1,obAnim(a0)
0088EC56                            
0088EC56                            	@pppppppp:
0088EC56 117C 000D 0020             		move.b	#$D,obColType(a0)
0088EC5C 317C 0200 0010             		move.w	#$200,obVelX(a0) ; move newtron horizontally
0088EC62 0828 0000 0022             		btst	#0,obStatus(a0)
0088EC68 6600                       		bne.s	@keepfalling
0088EC6A 4468 0010                  		neg.w	obVelX(a0)
0088EC6E                            
0088EC6E                            	@keepfalling:
0088EC6E 4E75                       		rts	
0088EC70                            ; ===========================================================================
0088EC70                            
0088EC70                            @matchfloor:				; XREF: @index
0088EC70 6100 F740                  		bsr.w	ObjectMove
0088EC74 6100 0000                  		bsr.w	ObjFloorDist
0088EC78 0C41 FFF8                  		cmpi.w	#-8,d1
0088EC7C 6D00                       		blt.s	@nextroutine
0088EC7E 0C41 000C                  		cmpi.w	#$C,d1
0088EC82 6C00                       		bge.s	@nextroutine
0088EC84 D368 000C                  		add.w	d1,obY(a0)	; match	newtron's position with floor
0088EC88 4E75                       		rts	
0088EC8A                            ; ===========================================================================
0088EC8A                            
0088EC8A                            	@nextroutine:
0088EC8A 5428 0025                  		addq.b	#2,ob2ndRout(a0) ; goto @speed next
0088EC8E 4E75                       		rts	
0088EC90                            ; ===========================================================================
0088EC90                            
0088EC90                            @speed:					; XREF: @index
0088EC90 6100 F720                  		bsr.w	ObjectMove
0088EC94 4E75                       		rts	
0088EC96                            ; ===========================================================================
0088EC96                            
0088EC96                            @type01:				; XREF: @index
0088EC96 0C28 0001 001A             		cmpi.b	#1,obFrame(a0)
0088EC9C 6600                       		bne.s	@firemissile
0088EC9E 117C 000C 0020             		move.b	#$C,obColType(a0)
0088ECA4                            
0088ECA4                            	@firemissile:
0088ECA4 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
0088ECAA 6600                       		bne.s	@fail
0088ECAC 4A28 0032                  		tst.b	$32(a0)
0088ECB0 6600                       		bne.s	@fail
0088ECB2 117C 0001 0032             		move.b	#1,$32(a0)
0088ECB8 6100 FBA8                  		bsr.w	FindFreeObj
0088ECBC 6600                       		bne.s	@fail
0088ECBE 137C 0023 0000             		move.b	#id_Missile,0(a1) ; load missile object
0088ECC4 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088ECCA 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088ECD0 5169 000C                  		subq.w	#8,obY(a1)
0088ECD4 337C 0200 0010             		move.w	#$200,obVelX(a1)
0088ECDA 303C 0014                  		move.w	#$14,d0
0088ECDE 0828 0000 0022             		btst	#0,obStatus(a0)
0088ECE4 6600                       		bne.s	@noflip
0088ECE6 4440                       		neg.w	d0
0088ECE8 4469 0010                  		neg.w	obVelX(a1)
0088ECEC                            
0088ECEC                            	@noflip:
0088ECEC D169 0008                  		add.w	d0,obX(a1)
0088ECF0 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
0088ECF6 137C 0001 0028             		move.b	#1,obSubtype(a1)
0088ECFC                            
0088ECFC                            	@fail:
0088ECFC 4E75                       		rts	
0088ECFE                            ; ===========================================================================
0088ECFE                            
0088ECFE                            Newt_Delete:	; Routine 4
0088ECFE 6000 F708                  		bra.w	DeleteObject
0088ECFE 6000 F708                  		bra.w	DeleteObject
0088ED02                            		include	"_anim\Newtron.asm"
0088ED02                            ; ---------------------------------------------------------------------------
0088ED02                            ; Animation script - Newtron enemy
0088ED02                            ; ---------------------------------------------------------------------------
0088ED02 0000                       Ani_Newt:	dc.w A_Newt_Blank-Ani_Newt
0088ED04 0000                       		dc.w A_Newt_Drop-Ani_Newt
0088ED06 0000                       		dc.w A_Newt_Fly1-Ani_Newt
0088ED08 0000                       		dc.w A_Newt_Fly2-Ani_Newt
0088ED0A 0000                       		dc.w A_Newt_Fires-Ani_Newt
0088ED0C 0F0A FF                    A_Newt_Blank:	dc.b $F, $A, afEnd
0088ED10 00                         		even
0088ED10 1300 0103 0405 FE01        A_Newt_Drop:	dc.b $13, 0, 1,	3, 4, 5, afBack, 1
0088ED18 0206 07FF                  A_Newt_Fly1:	dc.b 2,	6, 7, afEnd
0088ED1C 0208 09FF                  A_Newt_Fly2:	dc.b 2,	8, 9, afEnd
0088ED20                            
0088ED20 1300 0101 0201 0100 FD00   A_Newt_Fires:	dc.b $13, 0, 1,	1, 2, 1, 1, 0, afChange, 0
0088ED2A                            
0088ED2A                            		even
0088ED2A                            		
0088ED2A                            		
0088ED2A                            		include	"_maps\Newtron.asm"
0088ED2A                            ; ---------------------------------------------------------------------------
0088ED2A                            ; Sprite mappings - Newtron enemy (GHZ)
0088ED2A                            ; ---------------------------------------------------------------------------
0088ED2A 0000 0000                  Map_Newt:	dc.w M_Newt_Trans-Map_Newt, M_Newt_Norm-Map_Newt
0088ED2E 0000 0000                  		dc.w M_Newt_Fires-Map_Newt, M_Newt_Drop1-Map_Newt
0088ED32 0000 0000                  		dc.w M_Newt_Drop2-Map_Newt, M_Newt_Drop3-Map_Newt
0088ED36 0000 0000                  		dc.w M_Newt_Fly1a-Map_Newt, M_Newt_Fly1b-Map_Newt
0088ED3A 0000 0000                  		dc.w M_Newt_Fly2a-Map_Newt, M_Newt_Fly2b-Map_Newt
0088ED3E 0000                       		dc.w M_Newt_Blank-Map_Newt
0088ED40 03                         M_Newt_Trans:	dc.b 3
0088ED41 EC0D 0000 EC               		dc.b $EC, $D, 0, 0, $EC	; partially visible
0088ED46 F400 0008 0C               		dc.b $F4, 0, 0,	8, $C
0088ED4B FC0E 0009 F4               		dc.b $FC, $E, 0, 9, $F4
0088ED50 03                         M_Newt_Norm:	dc.b 3
0088ED51 EC06 0015 EC               		dc.b $EC, 6, 0,	$15, $EC ; visible
0088ED56 EC09 001B FC               		dc.b $EC, 9, 0,	$1B, $FC
0088ED5B FC0A 0021 FC               		dc.b $FC, $A, 0, $21, $FC
0088ED60 03                         M_Newt_Fires:	dc.b 3
0088ED61 EC06 002A EC               		dc.b $EC, 6, 0,	$2A, $EC ; open mouth, firing
0088ED66 EC09 001B FC               		dc.b $EC, 9, 0,	$1B, $FC
0088ED6B FC0A 0021 FC               		dc.b $FC, $A, 0, $21, $FC
0088ED70 04                         M_Newt_Drop1:	dc.b 4
0088ED71 EC06 0030 EC               		dc.b $EC, 6, 0,	$30, $EC ; dropping
0088ED76 EC09 001B FC               		dc.b $EC, 9, 0,	$1B, $FC
0088ED7B FC09 0036 FC               		dc.b $FC, 9, 0,	$36, $FC
0088ED80 0C00 003C 0C               		dc.b $C, 0, 0, $3C, $C
0088ED85 03                         M_Newt_Drop2:	dc.b 3
0088ED86 F40D 003D EC               		dc.b $F4, $D, 0, $3D, $EC
0088ED8B FC00 0020 0C               		dc.b $FC, 0, 0,	$20, $C
0088ED90 0408 0045 FC               		dc.b 4,	8, 0, $45, $FC
0088ED95 02                         M_Newt_Drop3:	dc.b 2
0088ED96 F80D 0048 EC               		dc.b $F8, $D, 0, $48, $EC
0088ED9B F801 0050 0C               		dc.b $F8, 1, 0,	$50, $C
0088EDA0 03                         M_Newt_Fly1a:	dc.b 3
0088EDA1 F80D 0048 EC               		dc.b $F8, $D, 0, $48, $EC ; flying
0088EDA6 F801 0050 0C               		dc.b $F8, 1, 0,	$50, $C
0088EDAB FE00 0052 14               		dc.b $FE, 0, 0,	$52, $14
0088EDB0 03                         M_Newt_Fly1b:	dc.b 3
0088EDB1 F80D 0048 EC               		dc.b $F8, $D, 0, $48, $EC
0088EDB6 F801 0050 0C               		dc.b $F8, 1, 0,	$50, $C
0088EDBB FE04 0053 14               		dc.b $FE, 4, 0,	$53, $14
0088EDC0 03                         M_Newt_Fly2a:	dc.b 3
0088EDC1 F80D 0048 EC               		dc.b $F8, $D, 0, $48, $EC
0088EDC6 F801 0050 0C               		dc.b $F8, 1, 0,	$50, $C
0088EDCB FE00 E052 14               		dc.b $FE, 0, $E0, $52, $14
0088EDD0 03                         M_Newt_Fly2b:	dc.b 3
0088EDD1 F80D 0048 EC               		dc.b $F8, $D, 0, $48, $EC
0088EDD6 F801 0050 0C               		dc.b $F8, 1, 0,	$50, $C
0088EDDB FE04 E053 14               		dc.b $FE, 4, $E0, $53, $14
0088EDE0 00                         M_Newt_Blank:	dc.b 0
0088EDE2 00                         		even
0088EDE2 00                         		even
0088EDE2                            		include	"_incObj\43 Roller.asm"
0088EDE2                            ; ---------------------------------------------------------------------------
0088EDE2                            ; Object 43 - Roller enemy (SYZ)
0088EDE2                            ; ---------------------------------------------------------------------------
0088EDE2                            
0088EDE2                            Roller:					; XREF: Obj_Index
0088EDE2 7000                       		moveq	#0,d0
0088EDE4 1028 0024                  		move.b	obRoutine(a0),d0
0088EDE8 323B 0000                  		move.w	Roll_Index(pc,d0.w),d1
0088EDEC 4EFB 1000                  		jmp	Roll_Index(pc,d1.w)
0088EDF0                            ; ===========================================================================
0088EDF0 0000                       Roll_Index:	dc.w Roll_Main-Roll_Index
0088EDF2 0000                       		dc.w Roll_Action-Roll_Index
0088EDF4                            ; ===========================================================================
0088EDF4                            
0088EDF4                            Roll_Main:	; Routine 0
0088EDF4 117C 000E 0016             		move.b	#$E,obHeight(a0)
0088EDFA 117C 0008 0017             		move.b	#8,obWidth(a0)
0088EE00 6100 F590                  		bsr.w	ObjectMoveAndFall
0088EE04 6100 0000                  		bsr.w	ObjFloorDist
0088EE08 4A41                       		tst.w	d1
0088EE0A 6A00                       		bpl.s	locret_E052
0088EE0C D368 000C                  		add.w	d1,obY(a0)	; match	roller's position with the floor
0088EE10 317C 0000 0012             		move.w	#0,obVelY(a0)
0088EE16 5428 0024                  		addq.b	#2,obRoutine(a0)
0088EE1A 217C 0000 0000 0004        		move.l	#Map_Roll,obMap(a0)
0088EE22 317C 04B8 0002             		move.w	#$4B8,obGfx(a0)
0088EE28 117C 0004 0001             		move.b	#4,obRender(a0)
0088EE2E 117C 0004 0018             		move.b	#4,obPriority(a0)
0088EE34 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088EE3A                            
0088EE3A                            	locret_E052:
0088EE3A 4E75                       		rts	
0088EE3C                            ; ===========================================================================
0088EE3C                            
0088EE3C                            Roll_Action:	; Routine 2
0088EE3C 7000                       		moveq	#0,d0
0088EE3E 1028 0025                  		move.b	ob2ndRout(a0),d0
0088EE42 323B 0000                  		move.w	Roll_Index2(pc,d0.w),d1
0088EE46 4EBB 1000                  		jsr	Roll_Index2(pc,d1.w)
0088EE4A 43F9 0000 0000             		lea	(Ani_Roll).l,a1
0088EE50 6100 C65E                  		bsr.w	AnimateSprite
0088EE54 3028 0008                  		move.w	obX(a0),d0
0088EE58 0240 FF80                  		andi.w	#$FF80,d0
0088EE5C 3238 F700                  		move.w	(v_screenposx).w,d1
0088EE60 0441 0080                  		subi.w	#$80,d1
0088EE64 0241 FF80                  		andi.w	#$FF80,d1
0088EE68 9041                       		sub.w	d1,d0
0088EE6A 0C40 0280                  		cmpi.w	#$280,d0
0088EE6E 6E00 0000                  		bgt.w	Roll_ChkGone
0088EE72 6000 F558                  		bra.w	DisplaySprite
0088EE76                            ; ===========================================================================
0088EE76                            
0088EE76                            Roll_ChkGone:
0088EE76 45F8 FC00                  		lea	(v_objstate).w,a2
0088EE7A 7000                       		moveq	#0,d0
0088EE7C 1028 0023                  		move.b	obRespawnNo(a0),d0
0088EE80 6700                       		beq.s	Roll_Delete
0088EE82 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
0088EE88                            
0088EE88                            Roll_Delete:
0088EE88 6000 F57E                  		bra.w	DeleteObject
0088EE8C                            ; ===========================================================================
0088EE8C 0000                       Roll_Index2:	dc.w Roll_RollChk-Roll_Index2
0088EE8E 0000                       		dc.w Roll_RollNoChk-Roll_Index2
0088EE90 0000                       		dc.w Roll_ChkJump-Roll_Index2
0088EE92 0000                       		dc.w Roll_MatchFloor-Roll_Index2
0088EE94                            ; ===========================================================================
0088EE94                            
0088EE94                            Roll_RollChk:				; XREF: Roll_Index2
0088EE94 3038 D008                  		move.w	(v_player+obX).w,d0
0088EE98 0440 0100                  		subi.w	#$100,d0
0088EE9C 6500                       		bcs.s	loc_E0D2
0088EE9E 9068 0008                  		sub.w	obX(a0),d0	; check	distance between Roller	and Sonic
0088EEA2 6500                       		bcs.s	loc_E0D2
0088EEA4 5828 0025                  		addq.b	#4,ob2ndRout(a0)
0088EEA8 117C 0002 001C             		move.b	#2,obAnim(a0)
0088EEAE 317C 0700 0010             		move.w	#$700,obVelX(a0) ; move Roller horizontally
0088EEB4 117C 008E 0020             		move.b	#$8E,obColType(a0) ; make Roller invincible
0088EEBA                            
0088EEBA                            loc_E0D2:
0088EEBA 588F                       		addq.l	#4,sp
0088EEBC 4E75                       		rts	
0088EEBE                            ; ===========================================================================
0088EEBE                            
0088EEBE                            Roll_RollNoChk:			; XREF: Roll_Index2
0088EEBE 0C28 0002 001C             		cmpi.b	#2,obAnim(a0)
0088EEC4 6700                       		beq.s	loc_E0F8
0088EEC6 5368 0030                  		subq.w	#1,$30(a0)
0088EECA 6A00                       		bpl.s	locret_E0F6
0088EECC 117C 0001 001C             		move.b	#1,obAnim(a0)
0088EED2 317C 0700 0010             		move.w	#$700,obVelX(a0)
0088EED8 117C 008E 0020             		move.b	#$8E,obColType(a0)
0088EEDE                            
0088EEDE                            locret_E0F6:
0088EEDE 4E75                       		rts	
0088EEE0                            ; ===========================================================================
0088EEE0                            
0088EEE0                            loc_E0F8:
0088EEE0 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088EEE4 4E75                       		rts	
0088EEE6                            ; ===========================================================================
0088EEE6                            
0088EEE6                            Roll_ChkJump:				; XREF: Roll_Index2
0088EEE6 6100 0000                  		bsr.w	Roll_Stop
0088EEEA 6100 F4C6                  		bsr.w	ObjectMove
0088EEEE 6100 0000                  		bsr.w	ObjFloorDist
0088EEF2 0C41 FFF8                  		cmpi.w	#-8,d1
0088EEF6 6D00                       		blt.s	Roll_Jump
0088EEF8 0C41 000C                  		cmpi.w	#$C,d1
0088EEFC 6C00                       		bge.s	Roll_Jump
0088EEFE D368 000C                  		add.w	d1,obY(a0)
0088EF02 4E75                       		rts	
0088EF04                            ; ===========================================================================
0088EF04                            
0088EF04                            Roll_Jump:
0088EF04 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0088EF08 08E8 0000 0032             		bset	#0,$32(a0)
0088EF0E 6700                       		beq.s	locret_E12E
0088EF10 317C FA00 0012             		move.w	#-$600,obVelY(a0)	; move Roller vertically
0088EF16                            
0088EF16                            locret_E12E:
0088EF16 4E75                       		rts	
0088EF18                            ; ===========================================================================
0088EF18                            
0088EF18                            Roll_MatchFloor:			; XREF: Roll_Index2
0088EF18 6100 F478                  		bsr.w	ObjectMoveAndFall
0088EF1C 4A68 0012                  		tst.w	obVelY(a0)
0088EF20 6B00                       		bmi.s	locret_E150
0088EF22 6100 0000                  		bsr.w	ObjFloorDist
0088EF26 4A41                       		tst.w	d1
0088EF28 6A00                       		bpl.s	locret_E150
0088EF2A D368 000C                  		add.w	d1,obY(a0)	; match	Roller's position with the floor
0088EF2E 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0088EF32 317C 0000 0012             		move.w	#0,obVelY(a0)
0088EF38                            
0088EF38                            locret_E150:
0088EF38 4E75                       		rts	
0088EF3A                            
0088EF3A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088EF3A                            
0088EF3A                            
0088EF3A                            Roll_Stop:				; XREF: Roll_ChkJump
0088EF3A 4A28 0032                  		tst.b	$32(a0)
0088EF3E 6B00                       		bmi.s	locret_E188
0088EF40 3038 D008                  		move.w	(v_player+obX).w,d0
0088EF44 0440 0030                  		subi.w	#$30,d0
0088EF48 9068 0008                  		sub.w	obX(a0),d0
0088EF4C 6400                       		bcc.s	locret_E188
0088EF4E 117C 0000 001C             		move.b	#0,obAnim(a0)
0088EF54 117C 000E 0020             		move.b	#$E,obColType(a0)
0088EF5A 4268 0010                  		clr.w	obVelX(a0)
0088EF5E 317C 0078 0030             		move.w	#120,$30(a0)	; set waiting time to 2	seconds
0088EF64 117C 0002 0025             		move.b	#2,ob2ndRout(a0)
0088EF6A 08E8 0007 0032             		bset	#7,$32(a0)
0088EF70                            
0088EF70                            locret_E188:
0088EF70 4E75                       		rts	
0088EF72                            ; End of function Roll_Stop
0088EF72                            ; End of function Roll_Stop
0088EF72                            		include	"_anim\Roller.asm"
0088EF72                            ; ---------------------------------------------------------------------------
0088EF72                            ; Animation script - Roller enemy
0088EF72                            ; ---------------------------------------------------------------------------
0088EF72 0000                       Ani_Roll:	dc.w A_Roll_Unfold-Ani_Roll
0088EF74 0000                       		dc.w A_Roll_Fold-Ani_Roll
0088EF76 0000                       		dc.w A_Roll_Roll-Ani_Roll
0088EF78 0F02 0100 FE01             A_Roll_Unfold:	dc.b $F, 2, 1, 0, afBack, 1
0088EF7E 0F01 02FD 02               A_Roll_Fold:	dc.b $F, 1, 2, afChange, 2
0088EF84 00                         		even
0088EF84 0303 0402 FF               A_Roll_Roll:	dc.b 3,	3, 4, 2, afEnd
0088EF8A 00                         		even
0088EF8A 00                         		even
0088EF8A                            		include	"_maps\Roller.asm"
0088EF8A                            ; ---------------------------------------------------------------------------
0088EF8A                            ; Sprite mappings - Roller enemy (SYZ)
0088EF8A                            ; ---------------------------------------------------------------------------
0088EF8A 0000                       Map_Roll:	dc.w M_Roll_Stand-Map_Roll
0088EF8C 0000                       		dc.w M_Roll_Fold-Map_Roll
0088EF8E 0000                       		dc.w M_Roll_Roll1-Map_Roll
0088EF90 0000                       		dc.w M_Roll_Roll2-Map_Roll
0088EF92 0000                       		dc.w M_Roll_Roll3-Map_Roll
0088EF94 02                         M_Roll_Stand:	dc.b 2
0088EF95 DE0E 0000 F0               		dc.b $DE, $E, 0, 0, $F0	; standing
0088EF9A F60E 000C F0               		dc.b $F6, $E, 0, $C, $F0
0088EF9F 02                         M_Roll_Fold:	dc.b 2
0088EFA0 E60E 0000 F0               		dc.b $E6, $E, 0, 0, $F0	; folding
0088EFA5 FE0D 0018 F0               		dc.b $FE, $D, 0, $18, $F0
0088EFAA 01                         M_Roll_Roll1:	dc.b 1
0088EFAB F00F 0020 F0               		dc.b $F0, $F, 0, $20, $F0 ; rolling
0088EFB0 01                         M_Roll_Roll2:	dc.b 1
0088EFB1 F00F 0030 F0               		dc.b $F0, $F, 0, $30, $F0 ; rolling
0088EFB6 01                         M_Roll_Roll3:	dc.b 1
0088EFB7 F00F 0040 F0               		dc.b $F0, $F, 0, $40, $F0 ; rolling
0088EFBC                            		even
0088EFBC                            		even
0088EFBC                            
0088EFBC                            		include	"_incObj\44 GHZ Edge Walls.asm"
0088EFBC                            ; ---------------------------------------------------------------------------
0088EFBC                            ; Object 44 - edge walls (GHZ)
0088EFBC                            ; ---------------------------------------------------------------------------
0088EFBC                            
0088EFBC                            EdgeWalls:				; XREF: Obj_Index
0088EFBC 7000                       		moveq	#0,d0
0088EFBE 1028 0024                  		move.b	obRoutine(a0),d0
0088EFC2 323B 0000                  		move.w	Edge_Index(pc,d0.w),d1
0088EFC6 4EFB 1000                  		jmp	Edge_Index(pc,d1.w)
0088EFCA                            ; ===========================================================================
0088EFCA 0000                       Edge_Index:	dc.w Edge_Main-Edge_Index
0088EFCC 0000                       		dc.w Edge_Solid-Edge_Index
0088EFCE 0000                       		dc.w Edge_Display-Edge_Index
0088EFD0                            ; ===========================================================================
0088EFD0                            
0088EFD0                            Edge_Main:	; Routine 0
0088EFD0 5428 0024                  		addq.b	#2,obRoutine(a0)
0088EFD4 217C 0000 0000 0004        		move.l	#Map_Edge,obMap(a0)
0088EFDC 317C 434C 0002             		move.w	#$434C,obGfx(a0)
0088EFE2 0028 0004 0001             		ori.b	#4,obRender(a0)
0088EFE8 117C 0008 0019             		move.b	#8,obActWid(a0)
0088EFEE 117C 0006 0018             		move.b	#6,obPriority(a0)
0088EFF4 1168 0028 001A             		move.b	obSubtype(a0),obFrame(a0) ; copy object type number to frame number
0088EFFA 08A8 0004 001A             		bclr	#4,obFrame(a0)	; clear	4th bit	(deduct	$10)
0088F000 6700                       		beq.s	Edge_Solid	; make object solid if 4th bit = 0
0088F002 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F006 6000                       		bra.s	Edge_Display	; don't make it solid if 4th bit = 1
0088F008                            ; ===========================================================================
0088F008                            
0088F008                            Edge_Solid:	; Routine 2
0088F008 323C 0013                  		move.w	#$13,d1
0088F00C 343C 0028                  		move.w	#$28,d2
0088F010 6100 A684                  		bsr.w	Obj44_SolidWall
0088F014                            
0088F014                            Edge_Display:	; Routine 4
0088F014 6100 F3B6                  		bsr.w	DisplaySprite
0088F036 4E75                       		rts	
0088F036 4E75                       		rts	
0088F038                            		include	"_maps\GHZ Edge Walls.asm"
0088F038                            ; ---------------------------------------------------------------------------
0088F038                            ; Sprite mappings - walls (GHZ)
0088F038                            ; ---------------------------------------------------------------------------
0088F038 0000                       Map_Edge:	dc.w M_Edge_Shadow-Map_Edge
0088F03A 0000                       		dc.w M_Edge_Light-Map_Edge
0088F03C 0000                       		dc.w M_Edge_Dark-Map_Edge
0088F03E 04                         M_Edge_Shadow:	dc.b 4
0088F03F E005 0004 F8               		dc.b $E0, 5, 0,	4, $F8	; light with shadow
0088F044 F005 0008 F8               		dc.b $F0, 5, 0,	8, $F8
0088F049 0005 0008 F8               		dc.b 0,	5, 0, 8, $F8
0088F04E 1005 0008 F8               		dc.b $10, 5, 0,	8, $F8
0088F053 04                         M_Edge_Light:	dc.b 4
0088F054 E005 0008 F8               		dc.b $E0, 5, 0,	8, $F8	; light with no shadow
0088F059 F005 0008 F8               		dc.b $F0, 5, 0,	8, $F8
0088F05E 0005 0008 F8               		dc.b 0,	5, 0, 8, $F8
0088F063 1005 0008 F8               		dc.b $10, 5, 0,	8, $F8
0088F068 04                         M_Edge_Dark:	dc.b 4
0088F069 E005 0000 F8               		dc.b $E0, 5, 0,	0, $F8	; all shadow
0088F06E F005 0000 F8               		dc.b $F0, 5, 0,	0, $F8
0088F073 0005 0000 F8               		dc.b 0,	5, 0, 0, $F8
0088F078 1005 0000 F8               		dc.b $10, 5, 0,	0, $F8
0088F07E 00                         		even
0088F07E 00                         		even
0088F07E                            
0088F07E                            		include	"_incObj\13 Lava Ball Maker.asm"
0088F07E                            ; ---------------------------------------------------------------------------
0088F07E                            ; Object 13 - lava ball	maker (MZ, SLZ)
0088F07E                            ; ---------------------------------------------------------------------------
0088F07E                            
0088F07E                            LavaMaker:				; XREF: Obj_Index
0088F07E 7000                       		moveq	#0,d0
0088F080 1028 0024                  		move.b	obRoutine(a0),d0
0088F084 323B 0000                  		move.w	LavaM_Index(pc,d0.w),d1
0088F088 4EBB 1000                  		jsr	LavaM_Index(pc,d1.w)
0088F08C 6000 0000                  		bra.w	LBall_ChkDel
0088F090                            ; ===========================================================================
0088F090 0000                       LavaM_Index:	dc.w LavaM_Main-LavaM_Index
0088F092 0000                       		dc.w LavaM_MakeLava-LavaM_Index
0088F094                            ; ---------------------------------------------------------------------------
0088F094                            ;
0088F094                            ; Lava ball production rates
0088F094                            ;
0088F094 1E3C 5A78 96B4             LavaM_Rates:	dc.b 30, 60, 90, 120, 150, 180
0088F09A                            ; ===========================================================================
0088F09A                            
0088F09A                            LavaM_Main:	; Routine 0
0088F09A 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F09E 1028 0028                  		move.b	obSubtype(a0),d0
0088F0A2 E848                       		lsr.w	#4,d0
0088F0A4 0240 000F                  		andi.w	#$F,d0
0088F0A8 117B 00EA 001F             		move.b	LavaM_Rates(pc,d0.w),obDelayAni(a0)
0088F0AE 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0) ; set time delay for lava balls
0088F0B4 0228 000F 0028             		andi.b	#$F,obSubtype(a0)
0088F0BA                            
0088F0BA                            LavaM_MakeLava:	; Routine 2
0088F0BA 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from time delay
0088F0BE 6600                       		bne.s	LavaM_Wait	; if time still	remains, branch
0088F0C0 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0) ; reset time delay
0088F0C6 6100 F57E                  		bsr.w	ChkObjectVisible
0088F0CA 6600                       		bne.s	LavaM_Wait
0088F0CC 6100 F794                  		bsr.w	FindFreeObj
0088F0D0 6600                       		bne.s	LavaM_Wait
0088F0D2 137C 0014 0000             		move.b	#id_LavaBall,0(a1) ; load lava ball object
0088F0D8 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088F0DE 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088F0E4 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088F0EA                            
0088F0EA                            	LavaM_Wait:
0088F0EA 4E75                       		rts	
0088F0EA 4E75                       		rts	
0088F0EC                            		include	"_incObj\14 Lava Ball.asm"
0088F0EC                            ; ---------------------------------------------------------------------------
0088F0EC                            ; Object 14 - lava balls (MZ, SLZ)
0088F0EC                            ; ---------------------------------------------------------------------------
0088F0EC                            
0088F0EC                            LavaBall:				; XREF: Obj_Index
0088F0EC 7000                       		moveq	#0,d0
0088F0EE 1028 0024                  		move.b	obRoutine(a0),d0
0088F0F2 323B 0000                  		move.w	LBall_Index(pc,d0.w),d1
0088F0F6 4EBB 1000                  		jsr	LBall_Index(pc,d1.w)
0088F0FA 6000 F2D0                  		bra.w	DisplaySprite
0088F0FE                            ; ===========================================================================
0088F0FE 0000                       LBall_Index:	dc.w LBall_Main-LBall_Index
0088F100 0000                       		dc.w LBall_Action-LBall_Index
0088F102 0000                       		dc.w LBall_Delete-LBall_Index
0088F104                            
0088F104 FC00 FB00 FA00 F900 FE00   LBall_Speeds:	dc.w -$400, -$500, -$600, -$700, -$200
0088F10E 0200 FE00 0200 0000        		dc.w $200, -$200, $200,	0
0088F116                            ; ===========================================================================
0088F116                            
0088F116                            LBall_Main:	; Routine 0
0088F116 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F11A 117C 0008 0016             		move.b	#8,obHeight(a0)
0088F120 117C 0008 0017             		move.b	#8,obWidth(a0)
0088F126 217C 0088 C106 0004        		move.l	#Map_Fire,obMap(a0)
0088F12E 317C 0345 0002             		move.w	#$345,obGfx(a0)
0088F134 0C38 0003 FE10             		cmpi.b	#3,(v_zone).w	; check if level is SLZ
0088F13A 6600                       		bne.s	@notSLZ
0088F13C 317C 0480 0002             		move.w	#$480,obGfx(a0)	; SLZ specific code
0088F142                            
0088F142                            	@notSLZ:
0088F142 117C 0004 0001             		move.b	#4,obRender(a0)
0088F148 117C 0003 0018             		move.b	#3,obPriority(a0)
0088F14E 117C 008B 0020             		move.b	#$8B,obColType(a0)
0088F154 3168 000C 0030             		move.w	obY(a0),$30(a0)
0088F15A 4A28 0029                  		tst.b	$29(a0)
0088F15E 6700                       		beq.s	@speed
0088F160 5428 0018                  		addq.b	#2,obPriority(a0)
0088F164                            
0088F164                            	@speed:
0088F164 7000                       		moveq	#0,d0
0088F166 1028 0028                  		move.b	obSubtype(a0),d0
0088F16A D040                       		add.w	d0,d0
0088F16C 317B 0096 0012             		move.w	LBall_Speeds(pc,d0.w),obVelY(a0) ; load object speed (vertical)
0088F172 117C 0008 0019             		move.b	#8,obActWid(a0)
0088F178 0C28 0006 0028             		cmpi.b	#6,obSubtype(a0) ; is object type below $6 ?
0088F17E 6500                       		bcs.s	@sound		; if yes, branch
0088F180                            
0088F180 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088F186 117C 0002 001C             		move.b	#2,obAnim(a0)	; use horizontal animation
0088F18C 3168 0012 0010             		move.w	obVelY(a0),obVelX(a0) ; set horizontal speed
0088F192 317C 0000 0012             		move.w	#0,obVelY(a0)	; delete vertical speed
0088F198                            
0088F198                            	@sound:
0088F1A2                            
0088F1A2                            LBall_Action:	; Routine 2
0088F1A2 7000                       		moveq	#0,d0
0088F1A4 1028 0028                  		move.b	obSubtype(a0),d0
0088F1A8 D040                       		add.w	d0,d0
0088F1AA 323B 0000                  		move.w	LBall_TypeIndex(pc,d0.w),d1
0088F1AE 4EBB 1000                  		jsr	LBall_TypeIndex(pc,d1.w)
0088F1B2 6100 F1FE                  		bsr.w	ObjectMove
0088F1B6 43F9 0000 0000             		lea	(Ani_Fire).l,a1
0088F1BC 6100 C2F2                  		bsr.w	AnimateSprite
0088F1C0                            
0088F1C0                            LBall_ChkDel:				; XREF: LavaMaker
0088F1DE 4E75                       		rts	
0088F1E0                            ; ===========================================================================
0088F1E0 0000 0000                  LBall_TypeIndex:dc.w LBall_Type00-LBall_TypeIndex, LBall_Type00-LBall_TypeIndex
0088F1E4 0000 0000                  		dc.w LBall_Type00-LBall_TypeIndex, LBall_Type00-LBall_TypeIndex
0088F1E8 0000 0000                  		dc.w LBall_Type04-LBall_TypeIndex, LBall_Type05-LBall_TypeIndex
0088F1EC 0000 0000                  		dc.w LBall_Type06-LBall_TypeIndex, LBall_Type07-LBall_TypeIndex
0088F1F0 0000                       		dc.w LBall_Type08-LBall_TypeIndex
0088F1F2                            ; ===========================================================================
0088F1F2                            ; lavaball types 00-03 fly up and fall back down
0088F1F2                            
0088F1F2                            LBall_Type00:				; XREF: LBall_TypeIndex
0088F1F2 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; increase object's downward speed
0088F1F8 3028 0030                  		move.w	$30(a0),d0
0088F1FC B068 000C                  		cmp.w	obY(a0),d0	; has object fallen back to its	original position?
0088F200 6400                       		bcc.s	loc_E41E	; if not, branch
0088F202 5428 0024                  		addq.b	#2,obRoutine(a0)	; goto "LBall_Delete" routine
0088F206                            
0088F206                            loc_E41E:
0088F206 08A8 0001 0022             		bclr	#1,obStatus(a0)
0088F20C 4A68 0012                  		tst.w	obVelY(a0)
0088F210 6A00                       		bpl.s	locret_E430
0088F212 08E8 0001 0022             		bset	#1,obStatus(a0)
0088F218                            
0088F218                            locret_E430:
0088F218 4E75                       		rts	
0088F21A                            ; ===========================================================================
0088F21A                            ; lavaball type	04 flies up until it hits the ceiling
0088F21A                            
0088F21A                            LBall_Type04:				; XREF: LBall_TypeIndex
0088F21A 08E8 0001 0022             		bset	#1,obStatus(a0)
0088F220 6100 0000                  		bsr.w	ObjHitCeiling
0088F224 4A41                       		tst.w	d1
0088F226 6A00                       		bpl.s	locret_E452
0088F228 117C 0008 0028             		move.b	#8,obSubtype(a0)
0088F22E 117C 0001 001C             		move.b	#1,obAnim(a0)
0088F234 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop the object when it touches the ceiling
0088F23A                            
0088F23A                            locret_E452:
0088F23A 4E75                       		rts	
0088F23C                            ; ===========================================================================
0088F23C                            ; lavaball type	05 falls down until it hits the	floor
0088F23C                            
0088F23C                            LBall_Type05:				; XREF: LBall_TypeIndex
0088F23C 08A8 0001 0022             		bclr	#1,obStatus(a0)
0088F242 6100 0000                  		bsr.w	ObjFloorDist
0088F246 4A41                       		tst.w	d1
0088F248 6A00                       		bpl.s	locret_E474
0088F24A 117C 0008 0028             		move.b	#8,obSubtype(a0)
0088F250 117C 0001 001C             		move.b	#1,obAnim(a0)
0088F256 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop the object when it touches the floor
0088F25C                            
0088F25C                            locret_E474:
0088F25C 4E75                       		rts	
0088F25E                            ; ===========================================================================
0088F25E                            ; lavaball types 06-07 move sideways
0088F25E                            
0088F25E                            LBall_Type06:				; XREF: LBall_TypeIndex
0088F25E 08E8 0000 0022             		bset	#0,obStatus(a0)
0088F264 76F8                       		moveq	#-8,d3
0088F266 6100 0000                  		bsr.w	ObjHitWallLeft
0088F26A 4A41                       		tst.w	d1
0088F26C 6A00                       		bpl.s	locret_E498
0088F26E 117C 0008 0028             		move.b	#8,obSubtype(a0)
0088F274 117C 0003 001C             		move.b	#3,obAnim(a0)
0088F27A 317C 0000 0010             		move.w	#0,obVelX(a0)	; stop object when it touches a	wall
0088F280                            
0088F280                            locret_E498:
0088F280 4E75                       		rts	
0088F282                            ; ===========================================================================
0088F282                            
0088F282                            LBall_Type07:				; XREF: LBall_TypeIndex
0088F282 08A8 0000 0022             		bclr	#0,obStatus(a0)
0088F288 7608                       		moveq	#8,d3
0088F28A 6100 0000                  		bsr.w	ObjHitWallRight
0088F28E 4A41                       		tst.w	d1
0088F290 6A00                       		bpl.s	locret_E4BC
0088F292 117C 0008 0028             		move.b	#8,obSubtype(a0)
0088F298 117C 0003 001C             		move.b	#3,obAnim(a0)
0088F29E 317C 0000 0010             		move.w	#0,obVelX(a0)	; stop object when it touches a	wall
0088F2A4                            
0088F2A4                            locret_E4BC:
0088F2A4 4E75                       		rts	
0088F2A6                            ; ===========================================================================
0088F2A6                            
0088F2A6                            LBall_Type08:				; XREF: LBall_TypeIndex
0088F2A6 4E75                       		rts	
0088F2A8                            ; ===========================================================================
0088F2A8                            
0088F2A8                            LBall_Delete:				; XREF: LBall_Index
0088F2A8 6000 F15E                  		bra.w	DeleteObject
0088F2A8 6000 F15E                  		bra.w	DeleteObject
0088F2AC                            		include	"_anim\Fireballs.asm"
0088F2AC                            ; ---------------------------------------------------------------------------
0088F2AC                            ; Animation script - lava balls
0088F2AC                            ; ---------------------------------------------------------------------------
0088F2AC 0000                       Ani_Fire:	dc.w @vertical-Ani_Fire
0088F2AE 0000                       		dc.w @vertcollide-Ani_Fire
0088F2B0 0000                       		dc.w @horizontal-Ani_Fire
0088F2B2 0000                       		dc.w @horicollide-Ani_Fire
0088F2B4 0500 2001 21FF             @vertical:	dc.b 5,	0, $20,	1, $21,	afEnd
0088F2BA 0502 FC                    @vertcollide:	dc.b 5,	2, afRoutine
0088F2BE 00                         		even
0088F2BE 0503 4304 44FF             @horizontal:	dc.b 5,	3, $43,	4, $44,	afEnd
0088F2C4 0505 FC                    @horicollide:	dc.b 5,	5, afRoutine
0088F2C8 00                         		even
0088F2C8 00                         		even
0088F2C8                            
0088F2C8                            		include	"_incObj\6D Flamethrower.asm"
0088F2C8                            ; ---------------------------------------------------------------------------
0088F2C8                            ; Object 6D - flame thrower (SBZ)
0088F2C8                            ; ---------------------------------------------------------------------------
0088F2C8                            
0088F2C8                            Flamethrower:				; XREF: Obj_Index
0088F2C8 7000                       		moveq	#0,d0
0088F2CA 1028 0024                  		move.b	obRoutine(a0),d0
0088F2CE 323B 0000                  		move.w	Flame_Index(pc,d0.w),d1
0088F2D2 4EFB 1000                  		jmp	Flame_Index(pc,d1.w)
0088F2D6                            ; ===========================================================================
0088F2D6 0000                       Flame_Index:	dc.w Flame_Main-Flame_Index
0088F2D8 0000                       		dc.w Flame_Action-Flame_Index
0088F2DA                            ; ===========================================================================
0088F2DA                            
0088F2DA                            Flame_Main:	; Routine 0
0088F2DA 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F2DE 217C 0000 0000 0004        		move.l	#Map_Flame,obMap(a0)
0088F2E6 317C 83D9 0002             		move.w	#$83D9,obGfx(a0)
0088F2EC 0028 0004 0001             		ori.b	#4,obRender(a0)
0088F2F2 117C 0001 0018             		move.b	#1,obPriority(a0)
0088F2F8 3168 000C 0030             		move.w	obY(a0),$30(a0)
0088F2FE 117C 000C 0019             		move.b	#$C,obActWid(a0)
0088F304 1028 0028                  		move.b	obSubtype(a0),d0
0088F308 0240 00F0                  		andi.w	#$F0,d0		; read 1st digit of object type
0088F30C D040                       		add.w	d0,d0		; multiply by 2
0088F30E 3140 0030                  		move.w	d0,$30(a0)
0088F312 3140 0032                  		move.w	d0,$32(a0)	; set flaming time
0088F316 1028 0028                  		move.b	obSubtype(a0),d0
0088F31A 0240 000F                  		andi.w	#$F,d0		; read 2nd digit of object type
0088F31E EB48                       		lsl.w	#5,d0		; multiply by $20
0088F320 3140 0034                  		move.w	d0,$34(a0)	; set pause time
0088F324 117C 000A 0036             		move.b	#$A,$36(a0)
0088F32A 0828 0001 0022             		btst	#1,obStatus(a0)
0088F330 6700                       		beq.s	Flame_Action
0088F332 117C 0002 001C             		move.b	#2,obAnim(a0)
0088F338 117C 0015 0036             		move.b	#$15,$36(a0)
0088F33E                            
0088F33E                            Flame_Action:	; Routine 2
0088F33E 5368 0030                  		subq.w	#1,$30(a0)	; subtract 1 from time
0088F342 6A00                       		bpl.s	loc_E57A	; if time remains, branch
0088F344 3168 0034 0030             		move.w	$34(a0),$30(a0)	; begin	pause time
0088F34A 0868 0000 001C             		bchg	#0,obAnim(a0)
0088F350 6700                       		beq.s	loc_E57A
0088F352 3168 0032 0030             		move.w	$32(a0),$30(a0)	; begin	flaming	time
0088F362                            
0088F362                            loc_E57A:
0088F362 43F9 0000 0000             		lea	(Ani_Flame).l,a1
0088F368 6100 C146                  		bsr.w	AnimateSprite
0088F36C 117C 0000 0020             		move.b	#0,obColType(a0)
0088F372 1028 0036                  		move.b	$36(a0),d0
0088F376 B028 001A                  		cmp.b	obFrame(a0),d0
0088F37A 6600                       		bne.s	Flame_ChkDel
0088F37C 117C 00A3 0020             		move.b	#$A3,obColType(a0)
0088F382                            
0088F382                            Flame_ChkDel:
0088F3A0 6000 F02A                  		bra.w	DisplaySprite
0088F3A0 6000 F02A                  		bra.w	DisplaySprite
0088F3A4                            		include	"_anim\Flamethrower.asm"
0088F3A4                            ; ---------------------------------------------------------------------------
0088F3A4                            ; Animation script - flamethrower (SBZ)
0088F3A4                            ; ---------------------------------------------------------------------------
0088F3A4 0000                       Ani_Flame:	dc.w @pipe1-Ani_Flame
0088F3A6 0000                       		dc.w @pipe2-Ani_Flame
0088F3A8 0000                       		dc.w @valve1-Ani_Flame
0088F3AA 0000                       		dc.w @valve2-Ani_Flame
0088F3AC 0300 0102 0304 0506 0708+  @pipe1:		dc.b 3,	0, 1, 2, 3, 4, 5, 6, 7,	8, 9, $A, afBack, 2
0088F3BA 0009 0705 0301 00FE 01     @pipe2:		dc.b 0,	9, 7, 5, 3, 1, 0, afBack, 1
0088F3C4 00                         		even
0088F3C4 030B 0C0D 0E0F 1011 1213+  @valve1:	dc.b 3,	$B, $C,	$D, $E,	$F, $10, $11, $12, $13,	$14, $15, afBack, 2
0088F3D2 0014 1211 0F0D 0BFE 01     @valve2:	dc.b 0,	$14, $12, $11, $F, $D, $B, afBack, 1
0088F3DC 00                         		even
0088F3DC 00                         		even
0088F3DC                            		include	"_maps\Flamethrower.asm"
0088F3DC                            ; ---------------------------------------------------------------------------
0088F3DC                            ; Sprite mappings - flame thrower (SBZ)
0088F3DC                            ; ---------------------------------------------------------------------------
0088F3DC 0000 0000                  Map_Flame:	dc.w @pipe1-Map_Flame, @pipe2-Map_Flame
0088F3E0 0000 0000                  		dc.w @pipe3-Map_Flame, @pipe4-Map_Flame
0088F3E4 0000 0000                  		dc.w @pipe5-Map_Flame, @pipe6-Map_Flame
0088F3E8 0000 0000                  		dc.w @pipe7-Map_Flame, @pipe8-Map_Flame
0088F3EC 0000 0000                  		dc.w @pipe9-Map_Flame, @pipe10-Map_Flame
0088F3F0 0000 0000                  		dc.w @pipe11-Map_Flame, @valve1-Map_Flame
0088F3F4 0000 0000                  		dc.w @valve2-Map_Flame, @valve3-Map_Flame
0088F3F8 0000 0000                  		dc.w @valve4-Map_Flame, @valve5-Map_Flame
0088F3FC 0000 0000                  		dc.w @valve6-Map_Flame, @valve7-Map_Flame
0088F400 0000 0000                  		dc.w @valve8-Map_Flame, @valve9-Map_Flame
0088F404 0000 0000                  		dc.w @valve10-Map_Flame, @valve11-Map_Flame
0088F408 01                         @pipe1:		dc.b 1
0088F409 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB ; broken pipe style flamethrower
0088F40E 02                         @pipe2:		dc.b 2
0088F40F 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F414 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F419 02                         @pipe3:		dc.b 2
0088F41A 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F41F 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F424 03                         @pipe4:		dc.b 3
0088F425 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F42A 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F42F 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F434 03                         @pipe5:		dc.b 3
0088F435 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F43A 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F43F 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F444 04                         @pipe6:		dc.b 4
0088F445 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F44A 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F44F 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F454 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F459 04                         @pipe7:		dc.b 4
0088F45A 0806 0802 F8               		dc.b 8,	6, 8, 2, $F8
0088F45F 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F464 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F469 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F46E 05                         @pipe8:		dc.b 5
0088F46F F80B 0008 F4               		dc.b $F8, $B, 0, 8, $F4
0088F474 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F479 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F47E 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F483 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F488 05                         @pipe9:		dc.b 5
0088F489 F80B 0808 F4               		dc.b $F8, $B, 8, 8, $F4
0088F48E 0806 0802 F8               		dc.b 8,	6, 8, 2, $F8
0088F493 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F498 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F49D 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F4A2 06                         @pipe10:	dc.b 6
0088F4A3 E80B 0008 F4               		dc.b $E8, $B, 0, 8, $F4
0088F4A8 F70B 0008 F4               		dc.b $F7, $B, 0, 8, $F4
0088F4AD 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F4B2 0F06 0002 F8               		dc.b $F, 6, 0, 2, $F8
0088F4B7 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F4BC 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F4C1 06                         @pipe11:	dc.b 6
0088F4C2 E70B 0808 F4               		dc.b $E7, $B, 8, 8, $F4
0088F4C7 F80B 0808 F4               		dc.b $F8, $B, 8, 8, $F4
0088F4CC 0706 0802 F8               		dc.b 7,	6, 8, 2, $F8
0088F4D1 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F4D6 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F4DB 2805 4014 FB               		dc.b $28, 5, $40, $14, $FB
0088F4E0 01                         @valve1:	dc.b 1
0088F4E1 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9 ; valve style flamethrower
0088F4E6 02                         @valve2:	dc.b 2
0088F4E7 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F4EC 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F4F1 02                         @valve3:	dc.b 2
0088F4F2 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F4F7 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F4FC 03                         @valve4:	dc.b 3
0088F4FD 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F502 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F507 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F50C 03                         @valve5:	dc.b 3
0088F50D 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F512 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F517 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F51C 04                         @valve6:	dc.b 4
0088F51D 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F522 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F527 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F52C 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F531 04                         @valve7:	dc.b 4
0088F532 0806 0802 F8               		dc.b 8,	6, 8, 2, $F8
0088F537 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F53C 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F541 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F546 05                         @valve8:	dc.b 5
0088F547 F80B 0008 F4               		dc.b $F8, $B, 0, 8, $F4
0088F54C 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F551 1006 0002 F8               		dc.b $10, 6, 0,	2, $F8
0088F556 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F55B 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F560 05                         @valve9:	dc.b 5
0088F561 F80B 0808 F4               		dc.b $F8, $B, 8, 8, $F4
0088F566 0806 0802 F8               		dc.b 8,	6, 8, 2, $F8
0088F56B 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F570 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F575 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F57A 06                         @valve10:	dc.b 6
0088F57B E80B 0008 F4               		dc.b $E8, $B, 0, 8, $F4
0088F580 F70B 0008 F4               		dc.b $F7, $B, 0, 8, $F4
0088F585 0806 0002 F8               		dc.b 8,	6, 0, 2, $F8
0088F58A 0F06 0002 F8               		dc.b $F, 6, 0, 2, $F8
0088F58F 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F594 2001 0000 FD               		dc.b $20, 1, 0,	0, $FD
0088F599 06                         @valve11:	dc.b 6
0088F59A E70B 0808 F4               		dc.b $E7, $B, 8, 8, $F4
0088F59F F80B 0808 F4               		dc.b $F8, $B, 8, 8, $F4
0088F5A4 0706 0802 F8               		dc.b 7,	6, 8, 2, $F8
0088F5A9 1006 0802 F8               		dc.b $10, 6, 8,	2, $F8
0088F5AE 2805 4018 F9               		dc.b $28, 5, $40, $18, $F9
0088F5B3 2001 0800 FC               		dc.b $20, 1, 8,	0, $FC
0088F5B8                            		even
0088F5B8                            		even
0088F5B8                            
0088F5B8                            		include	"_incObj\46 MZ Bricks.asm"
0088F5B8                            ; ---------------------------------------------------------------------------
0088F5B8                            ; Object 46 - solid blocks and blocks that fall	from the ceiling (MZ)
0088F5B8                            ; ---------------------------------------------------------------------------
0088F5B8                            
0088F5B8                            MarbleBrick:				; XREF: Obj_Index
0088F5B8 7000                       		moveq	#0,d0
0088F5BA 1028 0024                  		move.b	obRoutine(a0),d0
0088F5BE 323B 0000                  		move.w	Brick_Index(pc,d0.w),d1
0088F5C2 4EFB 1000                  		jmp	Brick_Index(pc,d1.w)
0088F5C6                            ; ===========================================================================
0088F5C6 0000                       Brick_Index:	dc.w Brick_Main-Brick_Index
0088F5C8 0000                       		dc.w Brick_Action-Brick_Index
0088F5CA                            
0088F5CA =00000030                  origY:		= $30
0088F5CA                            ; ===========================================================================
0088F5CA                            
0088F5CA                            Brick_Main:	; Routine 0
0088F5CA 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F5CE 117C 000F 0016             		move.b	#$F,obHeight(a0)
0088F5D4 117C 000F 0017             		move.b	#$F,obWidth(a0)
0088F5DA 217C 0000 0000 0004        		move.l	#Map_Brick,obMap(a0)
0088F5E2 317C 4000 0002             		move.w	#$4000,obGfx(a0)
0088F5E8 117C 0004 0001             		move.b	#4,obRender(a0)
0088F5EE 117C 0003 0018             		move.b	#3,obPriority(a0)
0088F5F4 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088F5FA 3168 000C 0030             		move.w	obY(a0),origY(a0)
0088F600 317C 05C0 0032             		move.w	#$5C0,$32(a0)
0088F606                            
0088F606                            Brick_Action:	; Routine 2
0088F606 4A28 0001                  		tst.b	obRender(a0)
0088F60A 6A00                       		bpl.s	@chkdel
0088F60C 7000                       		moveq	#0,d0
0088F60E 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
0088F612 0240 0007                  		andi.w	#7,d0		; read only the	1st digit
0088F616 D040                       		add.w	d0,d0
0088F618 323B 0000                  		move.w	Brick_TypeIndex(pc,d0.w),d1
0088F61C 4EBB 1000                  		jsr	Brick_TypeIndex(pc,d1.w)
0088F620 323C 001B                  		move.w	#$1B,d1
0088F624 343C 0010                  		move.w	#$10,d2
0088F628 363C 0011                  		move.w	#$11,d3
0088F62C 3828 0008                  		move.w	obX(a0),d4
0088F630 6100 0000                  		bsr.w	SolidObject
0088F634                            
0088F634                            	@chkdel:
0088F652 6000 ED78                  		bra.w	DisplaySprite
0088F656                            
0088F656                            		; ===========================================================================
0088F656 0000                       Brick_TypeIndex:dc.w Brick_Type00-Brick_TypeIndex
0088F658 0000                       		dc.w Brick_Type01-Brick_TypeIndex
0088F65A 0000                       		dc.w Brick_Type02-Brick_TypeIndex
0088F65C 0000                       		dc.w Brick_Type03-Brick_TypeIndex
0088F65E 0000                       		dc.w Brick_Type04-Brick_TypeIndex
0088F660                            ; ===========================================================================
0088F660                            
0088F660                            Brick_Type00:				; XREF: Brick_TypeIndex
0088F660 4E75                       		rts	
0088F662                            ; ===========================================================================
0088F662                            
0088F662                            Brick_Type02:				; XREF: Brick_TypeIndex
0088F662 3038 D008                  		move.w	(v_player+obX).w,d0
0088F666 9068 0008                  		sub.w	obX(a0),d0
0088F66A 6400                       		bcc.s	loc_E888
0088F66C 4440                       		neg.w	d0
0088F66E                            
0088F66E                            loc_E888:
0088F66E 0C40 0090                  		cmpi.w	#$90,d0		; is Sonic within $90 pixels of	the block?
0088F672 6400                       		bcc.s	Brick_Type01	; if not, resume wobbling
0088F674 117C 0003 0028             		move.b	#3,obSubtype(a0)	; if yes, make the block fall
0088F67A                            
0088F67A                            Brick_Type01:				; XREF: Brick_TypeIndex
0088F67A 7000                       		moveq	#0,d0
0088F67C 1038 FE74                  		move.b	(v_oscillate+$16).w,d0
0088F680 0828 0003 0028             		btst	#3,obSubtype(a0)
0088F686 6700                       		beq.s	loc_E8A8
0088F688 4440                       		neg.w	d0
0088F68A 0640 0010                  		addi.w	#$10,d0
0088F68E                            
0088F68E                            loc_E8A8:
0088F68E 3228 0030                  		move.w	origY(a0),d1
0088F692 9240                       		sub.w	d0,d1
0088F694 3141 000C                  		move.w	d1,obY(a0)	; update the block's position to make it wobble
0088F698 4E75                       		rts	
0088F69A                            ; ===========================================================================
0088F69A                            
0088F69A                            Brick_Type03:				; XREF: Brick_TypeIndex
0088F69A 6100 ED16                  		bsr.w	ObjectMove
0088F69E 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; increase falling speed
0088F6A4 6100 0000                  		bsr.w	ObjFloorDist
0088F6A8 4A41                       		tst.w	d1		; has the block	hit the	floor?
0088F6AA 6A00 0000                  		bpl.w	locret_E8EE	; if not, branch
0088F6AE D368 000C                  		add.w	d1,obY(a0)
0088F6B2 4268 0012                  		clr.w	obVelY(a0)	; stop the block falling
0088F6B6 3168 000C 0030             		move.w	obY(a0),origY(a0)
0088F6BC 117C 0004 0028             		move.b	#4,obSubtype(a0)
0088F6C2 3011                       		move.w	(a1),d0
0088F6C4 0240 03FF                  		andi.w	#$3FF,d0
0088F6C8 0C40 016A                  			cmpi.w	#$16A,d0
0088F6CC 6400                       		bcc.s	locret_E8EE
0088F6CE 117C 0000 0028             		move.b	#0,obSubtype(a0)
0088F6D4                            
0088F6D4                            locret_E8EE:
0088F6D4 4E75                       		rts	
0088F6D6                            ; ===========================================================================
0088F6D6                            
0088F6D6                            Brick_Type04:				; XREF: Brick_TypeIndex
0088F6D6 7000                       		moveq	#0,d0
0088F6D8 1038 FE70                  		move.b	(v_oscillate+$12).w,d0
0088F6DC E648                       		lsr.w	#3,d0
0088F6DE 3228 0030                  		move.w	origY(a0),d1
0088F6E2 9240                       		sub.w	d0,d1
0088F6E4 3141 000C                  		move.w	d1,obY(a0)	; make the block wobble
0088F6E8 4E75                       		rts	
0088F6E8 4E75                       		rts	
0088F6EA                            		include	"_maps\MZ Bricks.asm"
0088F6EA                            ; ---------------------------------------------------------------------------
0088F6EA                            ; Sprite mappings - solid blocks and blocks that fall from the ceiling (MZ)
0088F6EA                            ; ---------------------------------------------------------------------------
0088F6EA 0000                       Map_Brick:	dc.w @brick-Map_Brick
0088F6EC 01                         @brick:		dc.b 1
0088F6ED F00F 0001 F0               		dc.b $F0, $F, 0, 1, $F0
0088F6F2                            		even
0088F6F2                            		even
0088F6F2                            
0088F6F2                            		include	"_incObj\12 Light.asm"
0088F6F2                            ; ---------------------------------------------------------------------------
0088F6F2                            ; Object 12 - lamp (SYZ)
0088F6F2                            ; ---------------------------------------------------------------------------
0088F6F2                            
0088F6F2                            SpinningLight:				; XREF: Obj_Index
0088F6F2 7000                       		moveq	#0,d0
0088F6F4 1028 0024                  		move.b	obRoutine(a0),d0
0088F6F8 323B 0000                  		move.w	Light_Index(pc,d0.w),d1
0088F6FC 4EFB 1000                  		jmp	Light_Index(pc,d1.w)
0088F700                            ; ===========================================================================
0088F700 0000                       Light_Index:	dc.w Light_Main-Light_Index
0088F702 0000                       		dc.w Light_Animate-Light_Index
0088F704                            ; ===========================================================================
0088F704                            
0088F704                            Light_Main:	; Routine 0
0088F704 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F708 217C 0000 0000 0004        		move.l	#Map_Light,obMap(a0)
0088F710 317C 0000 0002             		move.w	#0,obGfx(a0)
0088F716 117C 0004 0001             		move.b	#4,obRender(a0)
0088F71C 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088F722 117C 0006 0018             		move.b	#6,obPriority(a0)
0088F728                            
0088F728                            Light_Animate:	; Routine 2
0088F728 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0088F72C 6A00                       		bpl.s	@chkdel
0088F72E 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
0088F734 5228 001A                  		addq.b	#1,obFrame(a0)
0088F738 0C28 0006 001A             		cmpi.b	#6,obFrame(a0)
0088F73E 6500                       		bcs.s	@chkdel
0088F740 117C 0000 001A             		move.b	#0,obFrame(a0)
0088F746                            
0088F746                            	@chkdel:
0088F764 6000 EC66                  		bra.w	DisplaySprite
0088F764 6000 EC66                  		bra.w	DisplaySprite
0088F768                            		include	"_maps\Light.asm"
0088F768                            ; ---------------------------------------------------------------------------
0088F768                            ; Sprite mappings - lamp (SYZ)
0088F768                            ; ---------------------------------------------------------------------------
0088F768 0000 0000                  Map_Light:	dc.w @0-Map_Light, @1-Map_Light
0088F76C 0000 0000                  		dc.w @2-Map_Light, @3-Map_Light
0088F770 0000 0000                  		dc.w @4-Map_Light, @5-Map_Light
0088F774 02                         @0:		dc.b 2
0088F775 F80C 0031 F0               		dc.b $F8, $C, 0, $31, $F0
0088F77A 000C 1031 F0               		dc.b 0,	$C, $10, $31, $F0
0088F77F 02                         @1:		dc.b 2
0088F780 F80C 0035 F0               		dc.b $F8, $C, 0, $35, $F0
0088F785 000C 1035 F0               		dc.b 0,	$C, $10, $35, $F0
0088F78A 02                         @2:		dc.b 2
0088F78B F80C 0039 F0               		dc.b $F8, $C, 0, $39, $F0
0088F790 000C 1039 F0               		dc.b 0,	$C, $10, $39, $F0
0088F795 02                         @3:		dc.b 2
0088F796 F80C 003D F0               		dc.b $F8, $C, 0, $3D, $F0
0088F79B 000C 103D F0               		dc.b 0,	$C, $10, $3D, $F0
0088F7A0 02                         @4:		dc.b 2
0088F7A1 F80C 0041 F0               		dc.b $F8, $C, 0, $41, $F0
0088F7A6 000C 1041 F0               		dc.b 0,	$C, $10, $41, $F0
0088F7AB 02                         @5:		dc.b 2
0088F7AC F80C 0045 F0               		dc.b $F8, $C, 0, $45, $F0
0088F7B1 000C 1045 F0               		dc.b 0,	$C, $10, $45, $F0
0088F7B6                            		even
0088F7B6                            		even
0088F7B6                            		include	"_incObj\47 Bumper.asm"
0088F7B6                            ; ---------------------------------------------------------------------------
0088F7B6                            ; Object 47 - pinball bumper (SYZ)
0088F7B6                            ; ---------------------------------------------------------------------------
0088F7B6                            
0088F7B6                            Bumper:					; XREF: Obj_Index
0088F7B6 7000                       		moveq	#0,d0
0088F7B8 1028 0024                  		move.b	obRoutine(a0),d0
0088F7BC 323B 0000                  		move.w	Bump_Index(pc,d0.w),d1
0088F7C0 4EFB 1000                  		jmp	Bump_Index(pc,d1.w)
0088F7C4                            ; ===========================================================================
0088F7C4 0000                       Bump_Index:	dc.w Bump_Main-Bump_Index
0088F7C6 0000                       		dc.w Bump_Hit-Bump_Index
0088F7C8                            ; ===========================================================================
0088F7C8                            
0088F7C8                            Bump_Main:	; Routine 0
0088F7C8 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F7CC 217C 0000 0000 0004        		move.l	#Map_Bump,obMap(a0)
0088F7D4 317C 0380 0002             		move.w	#$380,obGfx(a0)
0088F7DA 117C 0004 0001             		move.b	#4,obRender(a0)
0088F7E0 117C 0010 0019             		move.b	#$10,obActWid(a0)
0088F7E6 117C 0001 0018             		move.b	#1,obPriority(a0)
0088F7EC 117C 00D7 0020             		move.b	#$D7,obColType(a0)
0088F7F2                            
0088F7F2                            Bump_Hit:	; Routine 2
0088F7F2 4A28 0021                  		tst.b	obColProp(a0)	; has Sonic touched the	bumper?
0088F7F6 6700 0000                  		beq.w	@display	; if not, branch
0088F7FA 4228 0021                  		clr.b	obColProp(a0)
0088F7FE 43F8 D000                  		lea	(v_player).w,a1
0088F802 3228 0008                  		move.w	obX(a0),d1
0088F806 3428 000C                  		move.w	obY(a0),d2
0088F80A 9269 0008                  		sub.w	obX(a1),d1
0088F80E 9469 000C                  		sub.w	obY(a1),d2
0088F812 4EB9 0088 32B4             		jsr	(CalcAngle).l
0088F818 4EB9 0088 301C             		jsr	(CalcSine).l
0088F81E C3FC F900                  		muls.w	#-$700,d1
0088F822 E081                       		asr.l	#8,d1
0088F824 3341 0010                  		move.w	d1,obVelX(a1)	; bounce Sonic away
0088F828 C1FC F900                  		muls.w	#-$700,d0
0088F82C E080                       		asr.l	#8,d0
0088F82E 3340 0012                  		move.w	d0,obVelY(a1)	; bounce Sonic away
0088F832 08E9 0001 0022             		bset	#1,obStatus(a1)
0088F838                            		
0088F838                            	
0088F838 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
0088F83E 4229 003C                  		clr.b	$3C(a1)
0088F842 117C 0001 001C             		move.b	#1,obAnim(a0)	; use "hit" animation
0088F852 45F8 FC00                  		lea	(v_objstate).w,a2
0088F856 7000                       		moveq	#0,d0
0088F858 1028 0023                  		move.b	obRespawnNo(a0),d0
0088F85C 6700                       		beq.s	@addscore
0088F85E 0C32 008A 0002             		cmpi.b	#$8A,2(a2,d0.w)	; has bumper been hit 10 times?
0088F864 6400                       		bcc.s	@display	; if yes, Sonic	gets no	points
0088F866 5232 0002                  		addq.b	#1,2(a2,d0.w)
0088F86A                            
0088F86A                            	@addscore:
0088F86A 7001                       		moveq	#1,d0
0088F86C 4EB9 0000 0000             		jsr	AddPoints	; add 10 to score
0088F872 6100 EFEE                  		bsr.w	FindFreeObj
0088F876 6600                       		bne.s	@display
0088F878 137C 0029 0000             		move.b	#id_Points,0(a1) ; load points object
0088F87E 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088F884 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088F88A 137C 0004 001A             		move.b	#4,obFrame(a1)
0088F890                            
0088F890                            	@display:
0088F890 43F9 0000 0000             		lea	(Ani_Bump).l,a1
0088F896 6100 BC18                  		bsr.w	AnimateSprite
0088F8B6 6000 EB14                  		bra.w	DisplaySprite
0088F8BA                            ; ===========================================================================
0088F8BA                            
0088F8BA                            @resetcount:
0088F8BA 45F8 FC00                  		lea	(v_objstate).w,a2
0088F8BE 7000                       		moveq	#0,d0
0088F8C0 1028 0023                  		move.b	obRespawnNo(a0),d0
0088F8C4 6700                       		beq.s	@delete
0088F8C6 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
0088F8CC                            
0088F8CC                            	@delete:
0088F8CC 6000 EB3A                  		bra.w	DeleteObject
0088F8CC 6000 EB3A                  		bra.w	DeleteObject
0088F8D0                            		include	"_anim\Bumper.asm"
0088F8D0                            ; ---------------------------------------------------------------------------
0088F8D0                            ; Animation script - flamethrower (SBZ)
0088F8D0                            ; ---------------------------------------------------------------------------
0088F8D0 0000                       Ani_Bump:	dc.w byte_EAF4-Ani_Bump
0088F8D2 0000                       		dc.w byte_EAF8-Ani_Bump
0088F8D4 0F00 FF                    byte_EAF4:	dc.b $F, 0, afEnd
0088F8D8 00                         		even
0088F8D8 0301 0201 02FD 00          byte_EAF8:	dc.b 3,	1, 2, 1, 2, afChange, 0
0088F8E0 00                         		even
0088F8E0 00                         		even
0088F8E0                            		include	"_maps\Bumper.asm"
0088F8E0                            ; ---------------------------------------------------------------------------
0088F8E0                            ; Sprite mappings - pinball bumper (SYZ)
0088F8E0                            ; ---------------------------------------------------------------------------
0088F8E0 0000                       Map_Bump:	dc.w @normal-Map_Bump
0088F8E2 0000                       		dc.w @bumped1-Map_Bump
0088F8E4 0000                       		dc.w @bumped2-Map_Bump
0088F8E6 02                         @normal:	dc.b 2
0088F8E7 F007 0000 F0               		dc.b $F0, 7, 0,	0, $F0
0088F8EC F007 0800 00               		dc.b $F0, 7, 8,	0, 0
0088F8F1 02                         @bumped1:	dc.b 2
0088F8F2 F406 0008 F4               		dc.b $F4, 6, 0,	8, $F4
0088F8F7 F402 0808 04               		dc.b $F4, 2, 8,	8, 4
0088F8FC 02                         @bumped2:	dc.b 2
0088F8FD F007 000E F0               		dc.b $F0, 7, 0,	$E, $F0
0088F902 F007 080E 00               		dc.b $F0, 7, 8,	$E, 0
0088F908 00                         		even
0088F908 00                         		even
0088F908                            
0088F908                            		include	"_incObj\0D Signpost.asm" ; includes "GotThroughAct" subroutine
0088F908                            ; ---------------------------------------------------------------------------
0088F908                            ; Object 0D - signpost at the end of a level
0088F908                            ; ---------------------------------------------------------------------------
0088F908                            
0088F908                            Signpost:				; XREF: Obj_Index
0088F908 7000                       		moveq	#0,d0
0088F90A 1028 0024                  		move.b	obRoutine(a0),d0
0088F90E 323B 0000                  		move.w	Sign_Index(pc,d0.w),d1
0088F912 4EBB 1000                  		jsr	Sign_Index(pc,d1.w)
0088F916 43F9 0000 0000             		lea	(Ani_Sign).l,a1
0088F91C 6100 BB92                  		bsr.w	AnimateSprite
0088F920 6100 EAAA                  		bsr.w	DisplaySprite
0088F942 4E75                       		rts	
0088F944                            ; ===========================================================================
0088F944 0000                       Sign_Index:	dc.w Sign_Main-Sign_Index
0088F946 0000                       		dc.w Sign_Touch-Sign_Index
0088F948 0000                       		dc.w Sign_Spin-Sign_Index
0088F94A 0000                       		dc.w Sign_SonicRun-Sign_Index
0088F94C 0000                       		dc.w Sign_Exit-Sign_Index
0088F94E                            
0088F94E =00000030                  spintime:	= $30		; time for signpost to spin
0088F94E =00000032                  sparkletime:	= $32		; time between sparkles
0088F94E =00000034                  sparkle_id:	= $34		; counter to keep track of sparkles
0088F94E                            ; ===========================================================================
0088F94E                            
0088F94E                            Sign_Main:	; Routine 0
0088F94E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F952 217C 0000 0000 0004        		move.l	#Map_Sign,obMap(a0)
0088F95A 317C 0680 0002             		move.w	#$680,obGfx(a0)
0088F960 117C 0004 0001             		move.b	#4,obRender(a0)
0088F966 117C 0018 0019             		move.b	#$18,obActWid(a0)
0088F96C 117C 0004 0018             		move.b	#4,obPriority(a0)
0088F972                            
0088F972                            Sign_Touch:	; Routine 2
0088F972 3038 D008                  		move.w	(v_player+obX).w,d0
0088F976 9068 0008                  		sub.w	obX(a0),d0
0088F97A 6500                       		bcs.s	@notouch
0088F97C 0C40 0020                  		cmpi.w	#$20,d0		; is Sonic within $20 pixels of	the signpost?
0088F980 6400                       		bcc.s	@notouch	; if not, branch
0088F98C 4238 FE1E                  		clr.b	(f_timecount).w	; stop time counter
0088F990 31F8 F72A F728             		move.w	(v_limitright2).w,(v_limitleft2).w ; lock screen position
0088F996 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F99A                            
0088F99A                            	@notouch:
0088F99A 4E75                       		rts	
0088F99C                            ; ===========================================================================
0088F99C                            
0088F99C                            Sign_Spin:	; Routine 4
0088F99C 5368 0030                  		subq.w	#1,spintime(a0)	; subtract 1 from spin time
0088F9A0 6A00                       		bpl.s	@chksparkle	; if time remains, branch
0088F9A2 317C 003C 0030             		move.w	#60,spintime(a0) ; set spin cycle time to 1 second
0088F9A8 5228 001C                  		addq.b	#1,obAnim(a0)	; next spin cycle
0088F9AC 0C28 0003 001C             		cmpi.b	#3,obAnim(a0)	; have 3 spin cycles completed?
0088F9B2 6600                       		bne.s	@chksparkle	; if not, branch
0088F9B4 5428 0024                  		addq.b	#2,obRoutine(a0)
0088F9B8                            
0088F9B8                            	@chksparkle:
0088F9B8 5368 0032                  		subq.w	#1,sparkletime(a0) ; subtract 1 from time delay
0088F9BC 6A00                       		bpl.s	@fail		; if time remains, branch
0088F9BE 317C 000B 0032             		move.w	#$B,sparkletime(a0) ; set time between sparkles to $B frames
0088F9C4 7000                       		moveq	#0,d0
0088F9C6 1028 0034                  		move.b	sparkle_id(a0),d0 ; get sparkle id
0088F9CA 5428 0034                  		addq.b	#2,sparkle_id(a0) ; increment sparkle counter
0088F9CE 0228 000E 0034             		andi.b	#$E,sparkle_id(a0)
0088F9D4 45FB 0000                  		lea	Sign_SparkPos(pc,d0.w),a2 ; load sparkle position data
0088F9D8 6100 EE88                  		bsr.w	FindFreeObj
0088F9DC 6600                       		bne.s	@fail
0088F9DE 137C 0025 0000             		move.b	#id_Rings,0(a1)	; load rings object
0088F9E4 137C 0006 0024             		move.b	#id_Ring_Sparkle,obRoutine(a1) ; jump to ring sparkle subroutine
0088F9EA 101A                       		move.b	(a2)+,d0
0088F9EC 4880                       		ext.w	d0
0088F9EE D068 0008                  		add.w	obX(a0),d0
0088F9F2 3340 0008                  		move.w	d0,obX(a1)
0088F9F6 101A                       		move.b	(a2)+,d0
0088F9F8 4880                       		ext.w	d0
0088F9FA D068 000C                  		add.w	obY(a0),d0
0088F9FE 3340 000C                  		move.w	d0,obY(a1)
0088FA02 237C 0088 AD02 0004        		move.l	#Map_Ring,obMap(a1)
0088FA0A 337C 27B2 0002             		move.w	#$27B2,obGfx(a1)
0088FA10 137C 0004 0001             		move.b	#4,obRender(a1)
0088FA16 137C 0002 0018             		move.b	#2,obPriority(a1)
0088FA1C 137C 0008 0019             		move.b	#8,obActWid(a1)
0088FA22                            
0088FA22                            	@fail:
0088FA22 4E75                       		rts	
0088FA24                            ; ===========================================================================
0088FA24 E8F0                       Sign_SparkPos:	dc.b -$18,-$10		; x-position, y-position
0088FA26 0808                       		dc.b	8,   8
0088FA28 F000                       		dc.b -$10,   0
0088FA2A 18F8                       		dc.b  $18,  -8
0088FA2C 00F8                       		dc.b	0,  -8
0088FA2E 1000                       		dc.b  $10,   0
0088FA30 E808                       		dc.b -$18,   8
0088FA32 1810                       		dc.b  $18, $10
0088FA34                            ; ===========================================================================
0088FA34                            
0088FA34                            Sign_SonicRun:	; Routine 6
0088FA34 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	on?
0088FA38 6600 0000                  		bne.w	locret_ECEE	; if yes, branch
0088FA3C 0838 0001 D022             		btst	#1,(v_player+obStatus).w
0088FA42 6600                       		bne.s	loc_EC70
0088FA44 11FC 0001 F7CC             		move.b	#1,(f_lockctrl).w ; lock controls
0088FA4A 31FC 0800 F602             		move.w	#btnR<<8,(v_jpadhold2).w ; make Sonic run to the right
0088FA50                            
0088FA50                            	loc_EC70:
0088FA50 4A38 D000                  		tst.b	(v_player).w
0088FA54 6700                       		beq.s	loc_EC86
0088FA56 3038 D008                  		move.w	(v_player+obX).w,d0
0088FA5A 3238 F72A                  		move.w	(v_limitright2).w,d1
0088FA5E 0641 0128                  		addi.w	#$128,d1
0088FA62 B041                       		cmp.w	d1,d0
0088FA64 6500                       		bcs.s	locret_ECEE
0088FA66                            
0088FA66                            	loc_EC86:
0088FA66 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FA6A                            
0088FA6A                            
0088FA6A                            ; ---------------------------------------------------------------------------
0088FA6A                            ; Subroutine to	set up bonuses at the end of an	act
0088FA6A                            ; ---------------------------------------------------------------------------
0088FA6A                            
0088FA6A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0088FA6A                            
0088FA6A                            
0088FA6A                            GotThroughAct:				; XREF: Obj3E_EndAct
0088FA6A 4A38 D5C0                  		tst.b	(v_objspace+$5C0).w
0088FA6E 6600                       		bne.s	locret_ECEE
0088FA70 31F8 F72A F728             		move.w	(v_limitright2).w,(v_limitleft2).w
0088FA76 4238 FE2D                  		clr.b	(v_invinc).w	; disable invincibility
0088FA7A 4238 FE1E                  		clr.b	(f_timecount).w	; stop time counter
0088FA7E 11FC 003A D5C0             		move.b	#id_GotThroughCard,(v_objspace+$5C0).w
0088FA84 7000                       		moveq	#plcid_TitleCard,d0
0088FA86 4EB9 0088 1BD4             		jsr	(NewPLC).l	; load title card patterns
0088FA8C 11FC 0001 F7D6             		move.b	#1,(f_endactbonus).w
0088FA92 7000                       		moveq	#0,d0
0088FA94 1038 FE23                  		move.b	(v_timemin).w,d0
0088FA98 C0FC 003C                  		mulu.w	#60,d0		; convert minutes to seconds
0088FA9C 7200                       		moveq	#0,d1
0088FA9E 1238 FE24                  		move.b	(v_timesec).w,d1
0088FAA2 D041                       		add.w	d1,d0		; add up your time
0088FAA4 80FC 000F                  		divu.w	#15,d0		; divide by 15
0088FAA8 7214                       		moveq	#$14,d1
0088FAAA B041                       		cmp.w	d1,d0		; is time 5 minutes or higher?
0088FAAC 6500                       		bcs.s	@hastimebonus	; if not, branch
0088FAAE 3001                       		move.w	d1,d0		; use minimum time bonus (0)
0088FAB0                            
0088FAB0                            	@hastimebonus:
0088FAB0 D040                       		add.w	d0,d0
0088FAB2 31FB 0000 F7D2             		move.w	TimeBonuses(pc,d0.w),(v_timebonus).w ; set time bonus
0088FAB8 3038 FE20                  		move.w	(v_rings).w,d0	; load number of rings
0088FABC C0FC 000A                  		mulu.w	#10,d0		; multiply by 10
0088FAC0 31C0 F7D4                  		move.w	d0,(v_ringbonus).w ; set ring bonus
0088FACE                            
0088FACE                            locret_ECEE:
0088FACE 4E75                       		rts	
0088FAD0                            ; End of function GotThroughAct
0088FAD0                            
0088FAD0                            ; ===========================================================================
0088FAD0 1388 1388 03E8 01F4 0190+  TimeBonuses:	dc.w 5000, 5000, 1000, 500, 400, 400, 300, 300,	200, 200
0088FAE4 00C8 00C8 0064 0064 0064+  		dc.w 200, 200, 100, 100, 100, 100, 50, 50, 50, 50, 0
0088FAFA                            ; ===========================================================================
0088FAFA                            
0088FAFA                            Sign_Exit:	; Routine 8
0088FAFA 4E75                       		rts	
0088FAFA 4E75                       		rts	
0088FAFC                            		include	"_anim\Signpost.asm"
0088FAFC                            ; ---------------------------------------------------------------------------
0088FAFC                            ; Animation script - signpost
0088FAFC                            ; ---------------------------------------------------------------------------
0088FAFC 0000                       Ani_Sign:	dc.w @eggman-Ani_Sign
0088FAFE 0000                       		dc.w @spin1-Ani_Sign
0088FB00 0000                       		dc.w @spin2-Ani_Sign
0088FB02 0000                       		dc.w @sonic-Ani_Sign
0088FB04 0F00 FF                    @eggman:	dc.b $F, 0, afEnd
0088FB08 00                         		even
0088FB08 0100 0102 03FF             @spin1:		dc.b 1,	0, 1, 2, 3, afEnd
0088FB0E 0104 0102 03FF             @spin2:		dc.b 1,	4, 1, 2, 3, afEnd
0088FB14 0F04 FF                    @sonic:		dc.b $F, 4, afEnd
0088FB18 00                         		even
0088FB18 00                         		even
0088FB18                            		include	"_maps\Signpost.asm"
0088FB18                            ; ---------------------------------------------------------------------------
0088FB18                            ; Sprite mappings - signpost
0088FB18                            ; ---------------------------------------------------------------------------
0088FB18 0000 0000                  Map_Sign:	dc.w @eggman-Map_Sign, @spin1-Map_Sign
0088FB1C 0000 0000                  		dc.w @spin2-Map_Sign, @spin3-Map_Sign
0088FB20 0000                       		dc.w @sonic-Map_Sign
0088FB22 03                         @eggman:	dc.b 3
0088FB23 F00B 0000 E8               		dc.b $F0, $B, 0, 0, $E8
0088FB28 F00B 0800 00               		dc.b $F0, $B, 8, 0, 0
0088FB2D 1001 0038 FC               		dc.b $10, 1, 0,	$38, $FC
0088FB32 02                         @spin1:		dc.b 2
0088FB33 F00F 000C F0               		dc.b $F0, $F, 0, $C, $F0
0088FB38 1001 0038 FC               		dc.b $10, 1, 0,	$38, $FC
0088FB3D 02                         @spin2:		dc.b 2
0088FB3E F003 001C FC               		dc.b $F0, 3, 0,	$1C, $FC
0088FB43 1001 0838 FC               		dc.b $10, 1, 8,	$38, $FC
0088FB48 02                         @spin3:		dc.b 2
0088FB49 F00F 080C F0               		dc.b $F0, $F, 8, $C, $F0
0088FB4E 1001 0838 FC               		dc.b $10, 1, 8,	$38, $FC
0088FB53 03                         @sonic:		dc.b 3
0088FB54 F00B 0020 E8               		dc.b $F0, $B, 0, $20, $E8
0088FB59 F00B 002C 00               		dc.b $F0, $B, 0, $2C, 0
0088FB5E 1001 0038 FC               		dc.b $10, 1, 0,	$38, $FC
0088FB64 00                         		even
0088FB64 00                         		even
0088FB64                            
0088FB64                            		include	"_incObj\4C & 4D Lava Geyser Maker.asm"
0088FB64                            ; ---------------------------------------------------------------------------
0088FB64                            ; Object 4C - lava geyser / lavafall producer (MZ)
0088FB64                            ; ---------------------------------------------------------------------------
0088FB64                            
0088FB64                            GeyserMaker:				; XREF: Obj_Index
0088FB64 7000                       		moveq	#0,d0
0088FB66 1028 0024                  		move.b	obRoutine(a0),d0
0088FB6A 323B 0000                  		move.w	GMake_Index(pc,d0.w),d1
0088FB6E 4EBB 1000                  		jsr	GMake_Index(pc,d1.w)
0088FB72 6000 0000                  		bra.w	Geyser_ChkDel
0088FB76                            ; ===========================================================================
0088FB76 0000                       GMake_Index:	dc.w GMake_Main-GMake_Index
0088FB78 0000                       		dc.w GMake_Wait-GMake_Index
0088FB7A 0000                       		dc.w GMake_ChkType-GMake_Index
0088FB7C 0000                       		dc.w GMake_MakeLava-GMake_Index
0088FB7E 0000                       		dc.w GMake_Display-GMake_Index
0088FB80 0000                       		dc.w GMake_Delete-GMake_Index
0088FB82                            
0088FB82 =00000034                  gmake_time:	= $34		; time delay (2 bytes)
0088FB82 =00000032                  gmake_timer:	= $32		; current time remaining (2 bytes)
0088FB82 =0000003C                  gmake_parent:	= $3C		; address of parent object
0088FB82                            ; ===========================================================================
0088FB82                            
0088FB82                            GMake_Main:	; Routine 0
0088FB82 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FB86 217C 0000 0000 0004        		move.l	#Map_Geyser,obMap(a0)
0088FB8E 317C E3A8 0002             		move.w	#$E3A8,obGfx(a0)
0088FB94 117C 0004 0001             		move.b	#4,obRender(a0)
0088FB9A 117C 0001 0018             		move.b	#1,obPriority(a0)
0088FBA0 117C 0038 0019             		move.b	#$38,obActWid(a0)
0088FBA6 317C 0078 0034             		move.w	#120,gmake_time(a0) ; set time delay to 2 seconds
0088FBAC                            
0088FBAC                            GMake_Wait:	; Routine 2
0088FBAC 5368 0032                  		subq.w	#1,gmake_timer(a0) ; decrement timer
0088FBB0 6A00                       		bpl.s	@cancel		; if time remains, branch
0088FBB2                            
0088FBB2 3168 0034 0032             		move.w	gmake_time(a0),gmake_timer(a0) ; reset timer
0088FBB8 3038 D00C                  		move.w	(v_player+obY).w,d0
0088FBBC 3228 000C                  		move.w	obY(a0),d1
0088FBC0 B041                       		cmp.w	d1,d0
0088FBC2 6400                       		bcc.s	@cancel
0088FBC4 0441 0170                  		subi.w	#$170,d1
0088FBC8 B041                       		cmp.w	d1,d0
0088FBCA 6500                       		bcs.s	@cancel
0088FBCC 5428 0024                  		addq.b	#2,obRoutine(a0) ; if Sonic is within range, goto GMake_ChkType
0088FBD0                            
0088FBD0                            	@cancel:
0088FBD0 4E75                       		rts	
0088FBD2                            ; ===========================================================================
0088FBD2                            
0088FBD2                            GMake_MakeLava:	; Routine 6
0088FBD2 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FBD6 6100 ECA0                  		bsr.w	FindNextFreeObj
0088FBDA 6600                       		bne.s	@fail
0088FBDC 137C 004D 0000             		move.b	#id_LavaGeyser,0(a1) ; load lavafall object
0088FBE2 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088FBE8 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088FBEE 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088FBF4 2348 003C                  		move.l	a0,gmake_parent(a1)
0088FBF8                            
0088FBF8                            	@fail:
0088FBF8 117C 0001 001C             		move.b	#1,obAnim(a0)
0088FBFE 4A28 0028                  		tst.b	obSubtype(a0)	; is object type 0 (geyser) ?
0088FC02 6700                       		beq.s	@isgeyser	; if yes, branch
0088FC04 117C 0004 001C             		move.b	#4,obAnim(a0)
0088FC0A 6000                       		bra.s	GMake_Display
0088FC0C                            ; ===========================================================================
0088FC0C                            
0088FC0C                            	@isgeyser:
0088FC0C 2268 003C                  		movea.l	gmake_parent(a0),a1 ; get parent object address
0088FC10 08E9 0001 0022             		bset	#1,obStatus(a1)
0088FC16 337C FA80 0012             		move.w	#-$580,obVelY(a1)
0088FC1C 6000                       		bra.s	GMake_Display
0088FC1E                            ; ===========================================================================
0088FC1E                            
0088FC1E                            GMake_ChkType:	; Routine 4
0088FC1E 4A28 0028                  		tst.b	obSubtype(a0)	; is object type 00 (geyser) ?
0088FC22 6700                       		beq.s	GMake_Display	; if yes, branch
0088FC24 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FC28 4E75                       		rts	
0088FC2A                            ; ===========================================================================
0088FC2A                            
0088FC2A                            GMake_Display:	; Routine 8
0088FC2A 43F9 0000 0000             		lea	(Ani_Geyser).l,a1
0088FC30 6100 B87E                  		bsr.w	AnimateSprite
0088FC34 6100 E796                  		bsr.w	DisplaySprite
0088FC38 4E75                       		rts	
0088FC3A                            ; ===========================================================================
0088FC3A                            
0088FC3A                            GMake_Delete:	; Routine $A
0088FC3A 117C 0000 001C             		move.b	#0,obAnim(a0)
0088FC40 117C 0002 0024             		move.b	#2,obRoutine(a0)
0088FC46 4A28 0028                  		tst.b	obSubtype(a0)
0088FC4A 6700 E7BC                  		beq.w	DeleteObject
0088FC4E 4E75                       		rts	
0088FC50                            
0088FC50                            
0088FC50                            ; ---------------------------------------------------------------------------
0088FC50                            ; Object 4D - lava geyser / lavafall (MZ)
0088FC50                            ; ---------------------------------------------------------------------------
0088FC50                            
0088FC50                            LavaGeyser:				; XREF: Obj_Index
0088FC50 7000                       		moveq	#0,d0
0088FC52 1028 0024                  		move.b	obRoutine(a0),d0
0088FC56 323B 0000                  		move.w	Geyser_Index(pc,d0.w),d1
0088FC5A 4EBB 1000                  		jsr	Geyser_Index(pc,d1.w)
0088FC5E 6000 E76C                  		bra.w	DisplaySprite
0088FC62                            ; ===========================================================================
0088FC62 0000                       Geyser_Index:	dc.w Geyser_Main-Geyser_Index
0088FC64 0000                       		dc.w Geyser_Action-Geyser_Index
0088FC66 0000                       		dc.w loc_EFFC-Geyser_Index
0088FC68 0000                       		dc.w Geyser_Delete-Geyser_Index
0088FC6A                            
0088FC6A FB00 0000                  Geyser_Speeds:	dc.w $FB00, 0
0088FC6E                            ; ===========================================================================
0088FC6E                            
0088FC6E                            Geyser_Main:	; Routine 0
0088FC6E 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FC72 3168 000C 0030             		move.w	obY(a0),$30(a0)
0088FC78 4A28 0028                  		tst.b	obSubtype(a0)
0088FC7C 6700                       		beq.s	@isgeyser
0088FC7E 0468 0250 000C             		subi.w	#$250,obY(a0)
0088FC84                            
0088FC84                            	@isgeyser:
0088FC84 7000                       		moveq	#0,d0
0088FC86 1028 0028                  		move.b	obSubtype(a0),d0
0088FC8A D040                       		add.w	d0,d0
0088FC8C 317B 00DC 0012             		move.w	Geyser_Speeds(pc,d0.w),obVelY(a0)
0088FC92 2248                       		movea.l	a0,a1
0088FC94 7201                       		moveq	#1,d1
0088FC96 6100                       		bsr.s	@makelava
0088FC98 6000                       		bra.s	@activate
0088FC9A                            ; ===========================================================================
0088FC9A                            
0088FC9A                            	@loop:
0088FC9A 6100 EBDC                  		bsr.w	FindNextFreeObj
0088FC9E 6600                       		bne.s	@fail
0088FCA0                            
0088FCA0                            @makelava:				; XREF: Geyser_Main
0088FCA0 137C 004D 0000             		move.b	#id_LavaGeyser,0(a1)
0088FCA6 237C 0000 0000 0004        		move.l	#Map_Geyser,obMap(a1)
0088FCAE 337C 63A8 0002             		move.w	#$63A8,obGfx(a1)
0088FCB4 137C 0004 0001             		move.b	#4,obRender(a1)
0088FCBA 137C 0020 0019             		move.b	#$20,obActWid(a1)
0088FCC0 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088FCC6 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088FCCC 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
0088FCD2 137C 0001 0018             		move.b	#1,obPriority(a1)
0088FCD8 137C 0005 001C             		move.b	#5,obAnim(a1)
0088FCDE 4A28 0028                  		tst.b	obSubtype(a0)
0088FCE2 6700                       		beq.s	@fail
0088FCE4 137C 0002 001C             		move.b	#2,obAnim(a1)
0088FCEA                            
0088FCEA                            	@fail:
0088FCEA 51C9 FFAE                  		dbf	d1,@loop
0088FCEE 4E75                       		rts	
0088FCF0                            ; ===========================================================================
0088FCF0                            
0088FCF0                            @activate:				; XREF: Geyser_Main
0088FCF0 0669 0060 000C             		addi.w	#$60,obY(a1)
0088FCF6 3368 0030 0030             		move.w	$30(a0),$30(a1)
0088FCFC 0669 0060 0030             		addi.w	#$60,$30(a1)
0088FD02 137C 0093 0020             		move.b	#$93,obColType(a1)
0088FD08 137C 0080 0016             		move.b	#$80,obHeight(a1)
0088FD0E 08E9 0004 0001             		bset	#4,obRender(a1)
0088FD14 5829 0024                  		addq.b	#4,obRoutine(a1)
0088FD18 2348 003C                  		move.l	a0,$3C(a1)
0088FD1C 4A28 0028                  		tst.b	obSubtype(a0)
0088FD20 6700                       		beq.s	@sound
0088FD22 7200                       		moveq	#0,d1
0088FD24 6100 FF74                  		bsr.w	@loop
0088FD28 5429 0024                  		addq.b	#2,obRoutine(a1)
0088FD2C 08E9 0004 0002             		bset	#4,obGfx(a1)
0088FD32 0669 0100 000C             		addi.w	#$100,obY(a1)
0088FD38 137C 0000 0018             		move.b	#0,obPriority(a1)
0088FD3E 3368 0030 0030             		move.w	$30(a0),$30(a1)
0088FD44 2368 003C 003C             		move.l	$3C(a0),$3C(a1)
0088FD4A 117C 0000 0028             		move.b	#0,obSubtype(a0)
0088FD50                            
0088FD50                            	@sound:
0088FD5A                            
0088FD5A                            Geyser_Action:	; Routine 2
0088FD5A 7000                       		moveq	#0,d0
0088FD5C 1028 0028                  		move.b	obSubtype(a0),d0
0088FD60 D040                       		add.w	d0,d0
0088FD62 323B 0000                  		move.w	Geyser_Types(pc,d0.w),d1
0088FD66 4EBB 1000                  		jsr	Geyser_Types(pc,d1.w)
0088FD6A 6100 E646                  		bsr.w	ObjectMove
0088FD6E 43F9 0000 0000             		lea	(Ani_Geyser).l,a1
0088FD74 6100 B73A                  		bsr.w	AnimateSprite
0088FD78                            
0088FD78                            Geyser_ChkDel:				; XREF: GeyserMaker
0088FD96 4E75                       		rts	
0088FD98                            ; ===========================================================================
0088FD98 0000                       Geyser_Types:	dc.w Geyser_Type00-Geyser_Types
0088FD9A 0000                       		dc.w Geyser_Type01-Geyser_Types
0088FD9C                            ; ===========================================================================
0088FD9C                            
0088FD9C                            Geyser_Type00:				; XREF: Geyser_Types
0088FD9C 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; increase object's falling speed
0088FDA2 3028 0030                  		move.w	$30(a0),d0
0088FDA6 B068 000C                  		cmp.w	obY(a0),d0
0088FDAA 6400                       		bcc.s	locret_EFDA
0088FDAC 5828 0024                  		addq.b	#4,obRoutine(a0)
0088FDB0 2268 003C                  		movea.l	$3C(a0),a1
0088FDB4 137C 0003 001C             		move.b	#3,obAnim(a1)
0088FDBA                            
0088FDBA                            locret_EFDA:
0088FDBA 4E75                       		rts	
0088FDBC                            ; ===========================================================================
0088FDBC                            
0088FDBC                            Geyser_Type01:				; XREF: Geyser_Types
0088FDBC 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; increase object's falling speed
0088FDC2 3028 0030                  		move.w	$30(a0),d0
0088FDC6 B068 000C                  		cmp.w	obY(a0),d0
0088FDCA 6400                       		bcc.s	locret_EFFA
0088FDCC 5828 0024                  		addq.b	#4,obRoutine(a0)
0088FDD0 2268 003C                  		movea.l	$3C(a0),a1
0088FDD4 137C 0001 001C             		move.b	#1,obAnim(a1)
0088FDDA                            
0088FDDA                            locret_EFFA:
0088FDDA 4E75                       		rts	
0088FDDC                            ; ===========================================================================
0088FDDC                            
0088FDDC                            loc_EFFC:	; Routine 4
0088FDDC 2268 003C                  		movea.l	$3C(a0),a1
0088FDE0 0C29 0006 0024             		cmpi.b	#6,obRoutine(a1)
0088FDE6 6700 0000                  		beq.w	Geyser_Delete
0088FDEA 3029 000C                  		move.w	obY(a1),d0
0088FDEE 0640 0060                  		addi.w	#$60,d0
0088FDF2 3140 000C                  		move.w	d0,obY(a0)
0088FDF6 9068 0030                  		sub.w	$30(a0),d0
0088FDFA 4440                       		neg.w	d0
0088FDFC 7208                       		moveq	#8,d1
0088FDFE 0C40 0040                  		cmpi.w	#$40,d0
0088FE02 6C00                       		bge.s	loc_F026
0088FE04 720B                       		moveq	#$B,d1
0088FE06                            
0088FE06                            loc_F026:
0088FE06 0C40 0080                  		cmpi.w	#$80,d0
0088FE0A 6F00                       		ble.s	loc_F02E
0088FE0C 720E                       		moveq	#$E,d1
0088FE0E                            
0088FE0E                            loc_F02E:
0088FE0E 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0088FE12 6A00                       		bpl.s	loc_F04C
0088FE14 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
0088FE1A 5228 001B                  		addq.b	#1,obAniFrame(a0)
0088FE1E 0C28 0002 001B             		cmpi.b	#2,obAniFrame(a0)
0088FE24 6500                       		bcs.s	loc_F04C
0088FE26 117C 0000 001B             		move.b	#0,obAniFrame(a0)
0088FE2C                            
0088FE2C                            loc_F04C:
0088FE2C 1028 001B                  		move.b	obAniFrame(a0),d0
0088FE30 D001                       		add.b	d1,d0
0088FE32 1140 001A                  		move.b	d0,obFrame(a0)
0088FE36 6000 FF40                  		bra.w	Geyser_ChkDel
0088FE3A                            ; ===========================================================================
0088FE3A                            
0088FE3A                            Geyser_Delete:	; Routine 6
0088FE3A 6000 E5CC                  		bra.w	DeleteObject
0088FE3A 6000 E5CC                  		bra.w	DeleteObject
0088FE3E                            		include	"_incObj\4E Wall of Lava.asm"
0088FE3E                            ; ---------------------------------------------------------------------------
0088FE3E                            ; Object 4E - advancing	wall of	lava (MZ)
0088FE3E                            ; ---------------------------------------------------------------------------
0088FE3E                            
0088FE3E                            LavaWall:				; XREF: Obj_Index
0088FE3E 7000                       		moveq	#0,d0
0088FE40 1028 0024                  		move.b	obRoutine(a0),d0
0088FE44 323B 0000                  		move.w	LWall_Index(pc,d0.w),d1
0088FE48 4EFB 1000                  		jmp	LWall_Index(pc,d1.w)
0088FE4C                            ; ===========================================================================
0088FE4C 0000                       LWall_Index:	dc.w LWall_Main-LWall_Index
0088FE4E 0000                       		dc.w LWall_Solid-LWall_Index
0088FE50 0000                       		dc.w LWall_Action-LWall_Index
0088FE52 0000                       		dc.w LWall_Move-LWall_Index
0088FE54 0000                       		dc.w LWall_Delete-LWall_Index
0088FE56                            
0088FE56 =00000036                  lwall_flag:	= $36		; flag to start wall moving
0088FE56                            ; ===========================================================================
0088FE56                            
0088FE56                            LWall_Main:	; Routine 0
0088FE56 5828 0024                  		addq.b	#4,obRoutine(a0)
0088FE5A 2248                       		movea.l	a0,a1
0088FE5C 7201                       		moveq	#1,d1
0088FE5E 6000                       		bra.s	@make
0088FE60                            ; ===========================================================================
0088FE60                            
0088FE60                            	@loop:
0088FE60 6100 EA16                  		bsr.w	FindNextFreeObj
0088FE64 6600                       		bne.s	@fail
0088FE66                            
0088FE66                            @make:
0088FE66 137C 004E 0000             		move.b	#$4E,0(a1)	; load object
0088FE6C 237C 0000 0000 0004        		move.l	#Map_LWall,obMap(a1)
0088FE74 337C 63A8 0002             		move.w	#$63A8,obGfx(a1)
0088FE7A 137C 0004 0001             		move.b	#4,obRender(a1)
0088FE80 137C 0050 0019             		move.b	#$50,obActWid(a1)
0088FE86 3368 0008 0008             		move.w	obX(a0),obX(a1)
0088FE8C 3368 000C 000C             		move.w	obY(a0),obY(a1)
0088FE92 137C 0001 0018             		move.b	#1,obPriority(a1)
0088FE98 137C 0000 001C             		move.b	#0,obAnim(a1)
0088FE9E 137C 0094 0020             		move.b	#$94,obColType(a1)
0088FEA4 2348 003C                  		move.l	a0,$3C(a1)
0088FEA8                            
0088FEA8                            	@fail:
0088FEA8 51C9 FFB6                  		dbf	d1,@loop	; repeat sequence once
0088FEAC                            
0088FEAC 5C29 0024                  		addq.b	#6,obRoutine(a1)
0088FEB0 137C 0004 001A             		move.b	#4,obFrame(a1)
0088FEB6                            
0088FEB6                            LWall_Action:	; Routine 4
0088FEB6 3038 D008                  		move.w	(v_player+obX).w,d0
0088FEBA 9068 0008                  		sub.w	obX(a0),d0
0088FEBE 6400                       		bcc.s	@rangechk
0088FEC0 4440                       		neg.w	d0
0088FEC2                            
0088FEC2                            	@rangechk:
0088FEC2 0C40 00C0                  		cmpi.w	#$C0,d0		; is Sonic within $C0 pixels (x-axis)?
0088FEC6 6400                       		bcc.s	@movewall	; if not, branch
0088FEC8 3038 D00C                  		move.w	(v_player+obY).w,d0
0088FECC 9068 000C                  		sub.w	obY(a0),d0
0088FED0 6400                       		bcc.s	@rangechk2
0088FED2 4440                       		neg.w	d0
0088FED4                            
0088FED4                            	@rangechk2:
0088FED4 0C40 0060                  		cmpi.w	#$60,d0		; is Sonic within $60 pixels (y-axis)?
0088FED8 6400                       		bcc.s	@movewall	; if not, branch
0088FEDA 117C 0001 0036             		move.b	#1,lwall_flag(a0) ; set object to move
0088FEE0 6000                       		bra.s	LWall_Solid
0088FEE2                            ; ===========================================================================
0088FEE2                            
0088FEE2                            @movewall:
0088FEE2 4A28 0036                  		tst.b	lwall_flag(a0)	; is object set	to move?
0088FEE6 6700                       		beq.s	LWall_Solid	; if not, branch
0088FEE8 317C 0180 0010             		move.w	#$180,obVelX(a0) ; set object speed
0088FEEE 5528 0024                  		subq.b	#2,$24(a0)
0088FEF2                            
0088FEF2                            LWall_Solid:	; Routine 2
0088FEF2 323C 002B                  		move.w	#$2B,d1
0088FEF6 343C 0018                  		move.w	#$18,d2
0088FEFA 3602                       		move.w	d2,d3
0088FEFC 5243                       		addq.w	#1,d3
0088FEFE 3828 0008                  		move.w	obX(a0),d4
0088FF02 1028 0024                  		move.b	obRoutine(a0),d0
0088FF06 3F00                       		move.w	d0,-(sp)
0088FF08 6100 0000                  		bsr.w	SolidObject
0088FF0C 301F                       		move.w	(sp)+,d0
0088FF0E 1140 0024                  		move.b	d0,obRoutine(a0)
0088FF12 0C68 06A0 0008             		cmpi.w	#$6A0,obX(a0)	; has object reached $6A0 on the x-axis?
0088FF18 6600                       		bne.s	@animate	; if not, branch
0088FF1A 4268 0010                  		clr.w	obVelX(a0)	; stop object moving
0088FF1E 4228 0036                  		clr.b	lwall_flag(a0)
0088FF22                            
0088FF22                            	@animate:
0088FF22 43F9 0000 0000             		lea	(Ani_LWall).l,a1
0088FF28 6100 B586                  		bsr.w	AnimateSprite
0088FF2C 0C38 0004 D024             		cmpi.b	#4,(v_player+obRoutine).w
0088FF32 6400                       		bcc.s	@rangechk
0088FF34 6100 E47C                  		bsr.w	ObjectMove
0088FF38                            
0088FF38                            	@rangechk:
0088FF38 6100 E492                  		bsr.w	DisplaySprite
0088FF3C 4A28 0036                  		tst.b	lwall_flag(a0)	; is wall already moving?
0088FF40 6600                       		bne.s	@moving		; if yes, branch
0088FF5E                            
0088FF5E                            	@moving:
0088FF5E 4E75                       		rts	
0088FF60                            ; ===========================================================================
0088FF60                            
0088FF60                            @chkgone:
0088FF60 45F8 FC00                  		lea	(v_objstate).w,a2
0088FF64 7000                       		moveq	#0,d0
0088FF66 1028 0023                  		move.b	obRespawnNo(a0),d0
0088FF6A 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
0088FF70 117C 0008 0024             		move.b	#8,obRoutine(a0)
0088FF76 4E75                       		rts	
0088FF78                            ; ===========================================================================
0088FF78                            
0088FF78                            LWall_Move:	; Routine 6
0088FF78 2268 003C                  		movea.l	$3C(a0),a1
0088FF7C 0C29 0008 0024             		cmpi.b	#8,obRoutine(a1)
0088FF82 6700                       		beq.s	LWall_Delete
0088FF84 3169 0008 0008             		move.w	obX(a1),obX(a0)	; move rest of lava wall
0088FF8A 0468 0080 0008             		subi.w	#$80,obX(a0)
0088FF90 6000 E43A                  		bra.w	DisplaySprite
0088FF94                            ; ===========================================================================
0088FF94                            
0088FF94                            LWall_Delete:	; Routine 8
0088FF94 6000 E472                  		bra.w	DeleteObject
0088FF94 6000 E472                  		bra.w	DeleteObject
0088FF98                            		include	"_incObj\54 Lava Tag.asm"
0088FF98                            ; ---------------------------------------------------------------------------
0088FF98                            ; Object 54 - invisible	lava tag (MZ)
0088FF98                            ; ---------------------------------------------------------------------------
0088FF98                            
0088FF98                            LavaTag:				; XREF: Obj_Index
0088FF98 7000                       		moveq	#0,d0
0088FF9A 1028 0024                  		move.b	obRoutine(a0),d0
0088FF9E 323B 0000                  		move.w	LTag_Index(pc,d0.w),d1
0088FFA2 4EFB 1000                  		jmp	LTag_Index(pc,d1.w)
0088FFA6                            ; ===========================================================================
0088FFA6 0000                       LTag_Index:	dc.w LTag_Main-LTag_Index
0088FFA8 0000                       		dc.w LTag_ChkDel-LTag_Index
0088FFAA                            
0088FFAA 9694 95                    LTag_ColTypes:	dc.b $96, $94, $95
0088FFAE 00                         		even
0088FFAE                            ; ===========================================================================
0088FFAE                            
0088FFAE                            LTag_Main:	; Routine 0
0088FFAE 5428 0024                  		addq.b	#2,obRoutine(a0)
0088FFB2 7000                       		moveq	#0,d0
0088FFB4 1028 0028                  		move.b	obSubtype(a0),d0
0088FFB8 117B 00F0 0020             		move.b	LTag_ColTypes(pc,d0.w),obColType(a0)
0088FFBE 217C 0000 0000 0004        		move.l	#Map_LTag,obMap(a0)
0088FFC6 117C 0084 0001             		move.b	#$84,obRender(a0)
0088FFCC                            
0088FFCC                            LTag_ChkDel:	; Routine 2
0088FFCC 3028 0008                  		move.w	obX(a0),d0
0088FFD0 0240 FF80                  		andi.w	#$FF80,d0
0088FFD4 3238 F700                  		move.w	(v_screenposx).w,d1
0088FFD8 0441 0080                  		subi.w	#$80,d1
0088FFDC 0241 FF80                  		andi.w	#$FF80,d1
0088FFE0 9041                       		sub.w	d1,d0
0088FFE2 6B00 E424                  		bmi.w	DeleteObject
0088FFE6 0C40 0280                  		cmpi.w	#$280,d0
0088FFEA 6200 E41C                  		bhi.w	DeleteObject
0088FFEE 4E75                       		rts	
0088FFEE 4E75                       		rts	
0088FFF0                            		include	"_maps\Lava Tag.asm"
0088FFF0                            ; ---------------------------------------------------------------------------
0088FFF0                            ; Sprite mappings - invisible lava tag (MZ)
0088FFF0                            ; ---------------------------------------------------------------------------
0088FFF0 0000                       Map_LTag:	dc.w @0-Map_LTag
0088FFF2 00                         @0:		dc.b 0		; no sprite, because the tag is invisible!
0088FFF4 00                         		even
0088FFF4 00                         		even
0088FFF4                            		include	"_anim\Lava Geyser.asm"
0088FFF4                            ; ---------------------------------------------------------------------------
0088FFF4                            ; Animation script - geyser of lava (MZ)
0088FFF4                            ; ---------------------------------------------------------------------------
0088FFF4 0000                       Ani_Geyser:	dc.w @bubble1-Ani_Geyser
0088FFF6 0000                       		dc.w @bubble2-Ani_Geyser
0088FFF8 0000                       		dc.w @end-Ani_Geyser
0088FFFA 0000                       		dc.w @bubble3-Ani_Geyser
0088FFFC 0000                       		dc.w @blank-Ani_Geyser
0088FFFE 0000                       		dc.w @bubble4-Ani_Geyser
00890000 0200 0100 0104 0504 05FC   @bubble1:	dc.b 2,	0, 1, 0, 1, 4, 5, 4, 5,	afRoutine
0089000A 0202 03FF                  @bubble2:	dc.b 2,	2, 3, afEnd
0089000E 0206 07FF                  @end:		dc.b 2,	6, 7, afEnd
00890012 0202 0300 0100 01FC        @bubble3:	dc.b 2,	2, 3, 0, 1, 0, 1, afRoutine
0089001A 0F13 FF                    @blank:		dc.b $F, $13, afEnd
0089001E 00                         		even
0089001E 0211 12FF                  @bubble4:	dc.b 2,	$11, $12, afEnd
00890022                            		even
00890022                            		even
00890022                            		include	"_anim\Wall of Lava.asm"
00890022                            ; ---------------------------------------------------------------------------
00890022                            ; Animation script - advancing wall of lava (MZ)
00890022                            ; ---------------------------------------------------------------------------
00890022 0000                       Ani_LWall:	dc.w @wall-Ani_LWall
00890024 0900 0102 03FF             @wall:		dc.b 9,	0, 1, 2, 3, afEnd
0089002A                            		even
0089002A                            		even
0089002A                            		include	"_maps\Lava Geyser.asm"
0089002A                            ; ---------------------------------------------------------------------------
0089002A                            ; Sprite mappings - lava geyser / lava that falls from the ceiling (MZ)
0089002A                            ; ---------------------------------------------------------------------------
0089002A 0000 0000                  Map_Geyser:	dc.w @bubble1-Map_Geyser, @bubble2-Map_Geyser
0089002E 0000 0000                  		dc.w @bubble3-Map_Geyser, @bubble4-Map_Geyser
00890032 0000 0000                  		dc.w @bubble5-Map_Geyser, @bubble6-Map_Geyser
00890036 0000 0000                  		dc.w @end1-Map_Geyser, @end2-Map_Geyser
0089003A 0000 0000                  		dc.w @medcolumn1-Map_Geyser, @medcolumn2-Map_Geyser
0089003E 0000 0000                  		dc.w @medcolumn3-Map_Geyser, @shortcolumn1-Map_Geyser
00890042 0000 0000                  		dc.w @shortcolumn2-Map_Geyser, @shortcolumn3-Map_Geyser
00890046 0000 0000                  		dc.w @longcolumn1-Map_Geyser, @longcolumn2-Map_Geyser
0089004A 0000 0000                  		dc.w @longcolumn3-Map_Geyser, @bubble7-Map_Geyser
0089004E 0000 0000                  		dc.w @bubble8-Map_Geyser, @blank-Map_Geyser
00890052 02                         @bubble1:	dc.b 2
00890053 EC0B 0000 E8               		dc.b $EC, $B, 0, 0, $E8
00890058 EC0B 0800 00               		dc.b $EC, $B, 8, 0, 0
0089005D 02                         @bubble2:	dc.b 2
0089005E EC0B 0018 E8               		dc.b $EC, $B, 0, $18, $E8
00890063 EC0B 0818 00               		dc.b $EC, $B, 8, $18, 0
00890068 04                         @bubble3:	dc.b 4
00890069 EC0B 0000 C8               		dc.b $EC, $B, 0, 0, $C8
0089006E F40E 000C E0               		dc.b $F4, $E, 0, $C, $E0
00890073 F40E 080C 00               		dc.b $F4, $E, 8, $C, 0
00890078 EC0B 0800 20               		dc.b $EC, $B, 8, 0, $20
0089007D 04                         @bubble4:	dc.b 4
0089007E EC0B 0018 C8               		dc.b $EC, $B, 0, $18, $C8
00890083 F40E 0024 E0               		dc.b $F4, $E, 0, $24, $E0
00890088 F40E 0824 00               		dc.b $F4, $E, 8, $24, 0
0089008D EC0B 0818 20               		dc.b $EC, $B, 8, $18, $20
00890092 06                         @bubble5:	dc.b 6
00890093 EC0B 0000 C8               		dc.b $EC, $B, 0, 0, $C8
00890098 F40E 000C E0               		dc.b $F4, $E, 0, $C, $E0
0089009D F40E 080C 00               		dc.b $F4, $E, 8, $C, 0
008900A2 EC0B 0800 20               		dc.b $EC, $B, 8, 0, $20
008900A7 E80E 0090 E0               		dc.b $E8, $E, 0, $90, $E0
008900AC E80E 0890 00               		dc.b $E8, $E, 8, $90, 0
008900B1 06                         @bubble6:	dc.b 6
008900B2 EC0B 0018 C8               		dc.b $EC, $B, 0, $18, $C8
008900B7 F40E 0024 E0               		dc.b $F4, $E, 0, $24, $E0
008900BC F40E 0824 00               		dc.b $F4, $E, 8, $24, 0
008900C1 EC0B 0818 20               		dc.b $EC, $B, 8, $18, $20
008900C6 E80E 0890 E0               		dc.b $E8, $E, 8, $90, $E0
008900CB E80E 0090 00               		dc.b $E8, $E, 0, $90, 0
008900D0 02                         @end1:		dc.b 2
008900D1 E00F 0030 E0               		dc.b $E0, $F, 0, $30, $E0
008900D6 E00F 0830 00               		dc.b $E0, $F, 8, $30, 0
008900DB 02                         @end2:		dc.b 2
008900DC E00F 0830 E0               		dc.b $E0, $F, 8, $30, $E0
008900E1 E00F 0030 00               		dc.b $E0, $F, 0, $30, 0
008900E6 0A                         @medcolumn1:	dc.b $A
008900E7 900F 0040 E0               		dc.b $90, $F, 0, $40, $E0
008900EC 900F 0840 00               		dc.b $90, $F, 8, $40, 0
008900F1 B00F 0040 E0               		dc.b $B0, $F, 0, $40, $E0
008900F6 B00F 0840 00               		dc.b $B0, $F, 8, $40, 0
008900FB D00F 0040 E0               		dc.b $D0, $F, 0, $40, $E0
00890100 D00F 0840 00               		dc.b $D0, $F, 8, $40, 0
00890105 F00F 0040 E0               		dc.b $F0, $F, 0, $40, $E0
0089010A F00F 0840 00               		dc.b $F0, $F, 8, $40, 0
0089010F 100F 0040 E0               		dc.b $10, $F, 0, $40, $E0
00890114 100F 0840 00               		dc.b $10, $F, 8, $40, 0
00890119 0A                         @medcolumn2:	dc.b $A
0089011A 900F 0050 E0               		dc.b $90, $F, 0, $50, $E0
0089011F 900F 0850 00               		dc.b $90, $F, 8, $50, 0
00890124 B00F 0050 E0               		dc.b $B0, $F, 0, $50, $E0
00890129 B00F 0850 00               		dc.b $B0, $F, 8, $50, 0
0089012E D00F 0050 E0               		dc.b $D0, $F, 0, $50, $E0
00890133 D00F 0850 00               		dc.b $D0, $F, 8, $50, 0
00890138 F00F 0050 E0               		dc.b $F0, $F, 0, $50, $E0
0089013D F00F 0850 00               		dc.b $F0, $F, 8, $50, 0
00890142 100F 0050 E0               		dc.b $10, $F, 0, $50, $E0
00890147 100F 0850 00               		dc.b $10, $F, 8, $50, 0
0089014C 0A                         @medcolumn3:	dc.b $A
0089014D 900F 0060 E0               		dc.b $90, $F, 0, $60, $E0
00890152 900F 0860 00               		dc.b $90, $F, 8, $60, 0
00890157 B00F 0060 E0               		dc.b $B0, $F, 0, $60, $E0
0089015C B00F 0860 00               		dc.b $B0, $F, 8, $60, 0
00890161 D00F 0060 E0               		dc.b $D0, $F, 0, $60, $E0
00890166 D00F 0860 00               		dc.b $D0, $F, 8, $60, 0
0089016B F00F 0060 E0               		dc.b $F0, $F, 0, $60, $E0
00890170 F00F 0860 00               		dc.b $F0, $F, 8, $60, 0
00890175 100F 0060 E0               		dc.b $10, $F, 0, $60, $E0
0089017A 100F 0860 00               		dc.b $10, $F, 8, $60, 0
0089017F 06                         @shortcolumn1:	dc.b 6
00890180 900F 0040 E0               		dc.b $90, $F, 0, $40, $E0
00890185 900F 0840 00               		dc.b $90, $F, 8, $40, 0
0089018A B00F 0040 E0               		dc.b $B0, $F, 0, $40, $E0
0089018F B00F 0840 00               		dc.b $B0, $F, 8, $40, 0
00890194 D00F 0040 E0               		dc.b $D0, $F, 0, $40, $E0
00890199 D00F 0840 00               		dc.b $D0, $F, 8, $40, 0
0089019E 06                         @shortcolumn2:	dc.b 6
0089019F 900F 0050 E0               		dc.b $90, $F, 0, $50, $E0
008901A4 900F 0850 00               		dc.b $90, $F, 8, $50, 0
008901A9 B00F 0050 E0               		dc.b $B0, $F, 0, $50, $E0
008901AE B00F 0850 00               		dc.b $B0, $F, 8, $50, 0
008901B3 D00F 0050 E0               		dc.b $D0, $F, 0, $50, $E0
008901B8 D00F 0850 00               		dc.b $D0, $F, 8, $50, 0
008901BD 06                         @shortcolumn3:	dc.b 6
008901BE 900F 0060 E0               		dc.b $90, $F, 0, $60, $E0
008901C3 900F 0860 00               		dc.b $90, $F, 8, $60, 0
008901C8 B00F 0060 E0               		dc.b $B0, $F, 0, $60, $E0
008901CD B00F 0860 00               		dc.b $B0, $F, 8, $60, 0
008901D2 D00F 0060 E0               		dc.b $D0, $F, 0, $60, $E0
008901D7 D00F 0860 00               		dc.b $D0, $F, 8, $60, 0
008901DC 10                         @longcolumn1:	dc.b $10
008901DD 900F 0040 E0               		dc.b $90, $F, 0, $40, $E0
008901E2 900F 0840 00               		dc.b $90, $F, 8, $40, 0
008901E7 B00F 0040 E0               		dc.b $B0, $F, 0, $40, $E0
008901EC B00F 0840 00               		dc.b $B0, $F, 8, $40, 0
008901F1 D00F 0040 E0               		dc.b $D0, $F, 0, $40, $E0
008901F6 D00F 0840 00               		dc.b $D0, $F, 8, $40, 0
008901FB F00F 0040 E0               		dc.b $F0, $F, 0, $40, $E0
00890200 F00F 0840 00               		dc.b $F0, $F, 8, $40, 0
00890205 100F 0040 E0               		dc.b $10, $F, 0, $40, $E0
0089020A 100F 0840 00               		dc.b $10, $F, 8, $40, 0
0089020F 300F 0040 E0               		dc.b $30, $F, 0, $40, $E0
00890214 300F 0840 00               		dc.b $30, $F, 8, $40, 0
00890219 500F 0040 E0               		dc.b $50, $F, 0, $40, $E0
0089021E 500F 0840 00               		dc.b $50, $F, 8, $40, 0
00890223 700F 0040 E0               		dc.b $70, $F, 0, $40, $E0
00890228 700F 0840 00               		dc.b $70, $F, 8, $40, 0
0089022D 10                         @longcolumn2:	dc.b $10
0089022E 900F 0050 E0               		dc.b $90, $F, 0, $50, $E0
00890233 900F 0850 00               		dc.b $90, $F, 8, $50, 0
00890238 B00F 0050 E0               		dc.b $B0, $F, 0, $50, $E0
0089023D B00F 0850 00               		dc.b $B0, $F, 8, $50, 0
00890242 D00F 0050 E0               		dc.b $D0, $F, 0, $50, $E0
00890247 D00F 0850 00               		dc.b $D0, $F, 8, $50, 0
0089024C F00F 0050 E0               		dc.b $F0, $F, 0, $50, $E0
00890251 F00F 0850 00               		dc.b $F0, $F, 8, $50, 0
00890256 100F 0050 E0               		dc.b $10, $F, 0, $50, $E0
0089025B 100F 0850 00               		dc.b $10, $F, 8, $50, 0
00890260 300F 0050 E0               		dc.b $30, $F, 0, $50, $E0
00890265 300F 0850 00               		dc.b $30, $F, 8, $50, 0
0089026A 500F 0050 E0               		dc.b $50, $F, 0, $50, $E0
0089026F 500F 0850 00               		dc.b $50, $F, 8, $50, 0
00890274 700F 0050 E0               		dc.b $70, $F, 0, $50, $E0
00890279 700F 0850 00               		dc.b $70, $F, 8, $50, 0
0089027E 10                         @longcolumn3:	dc.b $10
0089027F 900F 0060 E0               		dc.b $90, $F, 0, $60, $E0
00890284 900F 0860 00               		dc.b $90, $F, 8, $60, 0
00890289 B00F 0060 E0               		dc.b $B0, $F, 0, $60, $E0
0089028E B00F 0860 00               		dc.b $B0, $F, 8, $60, 0
00890293 D00F 0060 E0               		dc.b $D0, $F, 0, $60, $E0
00890298 D00F 0860 00               		dc.b $D0, $F, 8, $60, 0
0089029D F00F 0060 E0               		dc.b $F0, $F, 0, $60, $E0
008902A2 F00F 0860 00               		dc.b $F0, $F, 8, $60, 0
008902A7 100F 0060 E0               		dc.b $10, $F, 0, $60, $E0
008902AC 100F 0860 00               		dc.b $10, $F, 8, $60, 0
008902B1 300F 0060 E0               		dc.b $30, $F, 0, $60, $E0
008902B6 300F 0860 00               		dc.b $30, $F, 8, $60, 0
008902BB 500F 0060 E0               		dc.b $50, $F, 0, $60, $E0
008902C0 500F 0860 00               		dc.b $50, $F, 8, $60, 0
008902C5 700F 0060 E0               		dc.b $70, $F, 0, $60, $E0
008902CA 700F 0860 00               		dc.b $70, $F, 8, $60, 0
008902CF 06                         @bubble7:	dc.b 6
008902D0 E00B 0000 C8               		dc.b $E0, $B, 0, 0, $C8
008902D5 E80E 000C E0               		dc.b $E8, $E, 0, $C, $E0
008902DA E80E 080C 00               		dc.b $E8, $E, 8, $C, 0
008902DF E00B 0800 20               		dc.b $E0, $B, 8, 0, $20
008902E4 D80E 0090 E0               		dc.b $D8, $E, 0, $90, $E0
008902E9 D80E 0890 00               		dc.b $D8, $E, 8, $90, 0
008902EE 06                         @bubble8:	dc.b 6
008902EF E00B 0018 C8               		dc.b $E0, $B, 0, $18, $C8
008902F4 E80E 0024 E0               		dc.b $E8, $E, 0, $24, $E0
008902F9 E80E 0824 00               		dc.b $E8, $E, 8, $24, 0
008902FE E00B 0818 20               		dc.b $E0, $B, 8, $18, $20
00890303 D80E 0890 E0               		dc.b $D8, $E, 8, $90, $E0
00890308 D80E 0090 00               		dc.b $D8, $E, 0, $90, 0
0089030D 00                         @blank:	dc.b 0
0089030E                            		even
0089030E                            		even
0089030E                            		include	"_maps\Wall of Lava.asm"
0089030E                            ; ---------------------------------------------------------------------------
0089030E                            ; Sprite mappings - advancing wall of lava (MZ)
0089030E                            ; ---------------------------------------------------------------------------
0089030E 0000                       Map_LWall:	dc.w byte_F538-Map_LWall
00890310 0000                       		dc.w byte_F566-Map_LWall
00890312 0000                       		dc.w byte_F594-Map_LWall
00890314 0000                       		dc.w byte_F5C2-Map_LWall
00890316 0000                       		dc.w byte_F5F0-Map_LWall
00890318 09                         byte_F538:	dc.b 9
00890319 E00F 0060 20               		dc.b $E0, $F, 0, $60, $20
0089031E 000F 0070 3C               		dc.b 0,	$F, 0, $70, $3C
00890323 000F FF2A 20               		dc.b 0,	$F, $FF, $2A, $20
00890328 E00F FF2A 00               		dc.b $E0, $F, $FF, $2A,	0
0089032D 000F FF2A 00               		dc.b 0,	$F, $FF, $2A, 0
00890332 E00F FF2A E0               		dc.b $E0, $F, $FF, $2A,	$E0
00890337 000F FF2A E0               		dc.b 0,	$F, $FF, $2A, $E0
0089033C E00F FF2A C0               		dc.b $E0, $F, $FF, $2A,	$C0
00890341 000F FF2A C0               		dc.b 0,	$F, $FF, $2A, $C0
00890346 09                         byte_F566:	dc.b 9
00890347 E00F 0070 20               		dc.b $E0, $F, 0, $70, $20
0089034C 000F 0080 3C               		dc.b 0,	$F, 0, $80, $3C
00890351 000F FF2A 20               		dc.b 0,	$F, $FF, $2A, $20
00890356 E00F FF2A 00               		dc.b $E0, $F, $FF, $2A,	0
0089035B 000F FF2A 00               		dc.b 0,	$F, $FF, $2A, 0
00890360 E00F FF2A E0               		dc.b $E0, $F, $FF, $2A,	$E0
00890365 000F FF2A E0               		dc.b 0,	$F, $FF, $2A, $E0
0089036A E00F FF2A C0               		dc.b $E0, $F, $FF, $2A,	$C0
0089036F 000F FF2A C0               		dc.b 0,	$F, $FF, $2A, $C0
00890374 09                         byte_F594:	dc.b 9
00890375 E00F 0080 20               		dc.b $E0, $F, 0, $80, $20
0089037A 000F 0070 3C               		dc.b 0,	$F, 0, $70, $3C
0089037F 000F FF2A 20               		dc.b 0,	$F, $FF, $2A, $20
00890384 E00F FF2A 00               		dc.b $E0, $F, $FF, $2A,	0
00890389 000F FF2A 00               		dc.b 0,	$F, $FF, $2A, 0
0089038E E00F FF2A E0               		dc.b $E0, $F, $FF, $2A,	$E0
00890393 000F FF2A E0               		dc.b 0,	$F, $FF, $2A, $E0
00890398 E00F FF2A C0               		dc.b $E0, $F, $FF, $2A,	$C0
0089039D 000F FF2A C0               		dc.b 0,	$F, $FF, $2A, $C0
008903A2 09                         byte_F5C2:	dc.b 9
008903A3 E00F 0070 20               		dc.b $E0, $F, 0, $70, $20
008903A8 000F 0060 3C               		dc.b 0,	$F, 0, $60, $3C
008903AD 000F FF2A 20               		dc.b 0,	$F, $FF, $2A, $20
008903B2 E00F FF2A 00               		dc.b $E0, $F, $FF, $2A,	0
008903B7 000F FF2A 00               		dc.b 0,	$F, $FF, $2A, 0
008903BC E00F FF2A E0               		dc.b $E0, $F, $FF, $2A,	$E0
008903C1 000F FF2A E0               		dc.b 0,	$F, $FF, $2A, $E0
008903C6 E00F FF2A C0               		dc.b $E0, $F, $FF, $2A,	$C0
008903CB 000F FF2A C0               		dc.b 0,	$F, $FF, $2A, $C0
008903D0 08                         byte_F5F0:	dc.b 8
008903D1 E00F FF2A 20               		dc.b $E0, $F, $FF, $2A,	$20
008903D6 000F FF2A 20               		dc.b 0,	$F, $FF, $2A, $20
008903DB E00F FF2A 00               		dc.b $E0, $F, $FF, $2A,	0
008903E0 000F FF2A 00               		dc.b 0,	$F, $FF, $2A, 0
008903E5 E00F FF2A E0               		dc.b $E0, $F, $FF, $2A,	$E0
008903EA 000F FF2A E0               		dc.b 0,	$F, $FF, $2A, $E0
008903EF E00F FF2A C0               		dc.b $E0, $F, $FF, $2A,	$C0
008903F4 000F FF2A C0               		dc.b 0,	$F, $FF, $2A, $C0
008903FA 00                         		even
008903FA 00                         		even
008903FA                            
008903FA                            		include	"_incObj\40 Moto Bug.asm" ; includes "_incObj\sub RememberState.asm"
008903FA                            ; ---------------------------------------------------------------------------
008903FA                            ; Object 40 - Moto Bug enemy (GHZ)
008903FA                            ; ---------------------------------------------------------------------------
008903FA                            
008903FA                            MotoBug:				; XREF: Obj_Index
008903FA 7000                       		moveq	#0,d0
008903FC 1028 0024                  		move.b	obRoutine(a0),d0
00890400 323B 0000                  		move.w	Moto_Index(pc,d0.w),d1
00890404 4EFB 1000                  		jmp	Moto_Index(pc,d1.w)
00890408                            ; ===========================================================================
00890408 0000                       Moto_Index:	dc.w Moto_Main-Moto_Index
0089040A 0000                       		dc.w Moto_Action-Moto_Index
0089040C 0000                       		dc.w Moto_Animate-Moto_Index
0089040E 0000                       		dc.w Moto_Delete-Moto_Index
00890410                            ; ===========================================================================
00890410                            
00890410                            Moto_Main:	; Routine 0
00890410 217C 0000 0000 0004        		move.l	#Map_Moto,obMap(a0)
00890418 317C 04F0 0002             		move.w	#$4F0,obGfx(a0)
0089041E 117C 0004 0001             		move.b	#4,obRender(a0)
00890424 117C 0004 0018             		move.b	#4,obPriority(a0)
0089042A 117C 0014 0019             		move.b	#$14,obActWid(a0)
00890430 4A28 001C                  		tst.b	obAnim(a0)	; is object a smoke trail?
00890434 6600                       		bne.s	@smoke		; if yes, branch
00890436 117C 000E 0016             		move.b	#$E,obHeight(a0)
0089043C 117C 0008 0017             		move.b	#8,obWidth(a0)
00890442 117C 000C 0020             		move.b	#$C,obColType(a0)
00890448 6100 DF48                  		bsr.w	ObjectMoveAndFall
0089044C 4EB9 0000 0000             		jsr	ObjFloorDist
00890452 4A41                       		tst.w	d1
00890454 6A00                       		bpl.s	@notonfloor
00890456 D368 000C                  		add.w	d1,obY(a0)	; match	object's position with the floor
0089045A 317C 0000 0012             		move.w	#0,obVelY(a0)
00890460 5428 0024                  		addq.b	#2,obRoutine(a0) ; goto Moto_Action next
00890464 0868 0000 0022             		bchg	#0,obStatus(a0)
0089046A                            
0089046A                            	@notonfloor:
0089046A 4E75                       		rts	
0089046C                            ; ===========================================================================
0089046C                            
0089046C                            @smoke:
0089046C 5828 0024                  		addq.b	#4,obRoutine(a0) ; goto Moto_Animate next
00890470 6000 0000                  		bra.w	Moto_Animate
00890474                            ; ===========================================================================
00890474                            
00890474                            Moto_Action:	; Routine 2
00890474 7000                       		moveq	#0,d0
00890476 1028 0025                  		move.b	ob2ndRout(a0),d0
0089047A 323B 0000                  		move.w	Moto_ActIndex(pc,d0.w),d1
0089047E 4EBB 1000                  		jsr	Moto_ActIndex(pc,d1.w)
00890482 43F9 0000 0000             		lea	(Ani_Moto).l,a1
00890488 6100 B026                  		bsr.w	AnimateSprite
0089048C                            
0089048C                            		include	"_incObj\sub RememberState.asm" ; Moto_Action terminates in this file
0089048C                            ; ---------------------------------------------------------------------------
0089048C                            ; Subroutine to remember whether an object is destroyed/collected
0089048C                            ; ---------------------------------------------------------------------------
0089048C                            
0089048C                            RememberState:
008904AA 6000 DF20                  		bra.w	DisplaySprite
008904AE                            
008904AE                            	@offscreen:
008904AE 45F8 FC00                  		lea	(v_objstate).w,a2
008904B2 7000                       		moveq	#0,d0
008904B4 1028 0023                  		move.b	obRespawnNo(a0),d0
008904B8 6700                       		beq.s	@delete
008904BA 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
008904C0                            
008904C0                            	@delete:
008904C0 6000 DF46                  		bra.w	DeleteObject
008904C0 6000 DF46                  		bra.w	DeleteObject
008904C4                            
008904C4                            ; ===========================================================================
008904C4 0000                       Moto_ActIndex:	dc.w @move-Moto_ActIndex
008904C6 0000                       		dc.w @findfloor-Moto_ActIndex
008904C8                            
008904C8 =00000030                  @time:		= $30
008904C8 =00000033                  @smokedelay:	= $33
008904C8                            ; ===========================================================================
008904C8                            
008904C8                            @move:
008904C8 5368 0030                  		subq.w	#1,@time(a0)	; subtract 1 from pause	time
008904CC 6A00                       		bpl.s	@wait		; if time remains, branch
008904CE 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008904D2 317C FF00 0010             		move.w	#-$100,obVelX(a0) ; move object to the left
008904D8 117C 0001 001C             		move.b	#1,obAnim(a0)
008904DE 0868 0000 0022             		bchg	#0,obStatus(a0)
008904E4 6600                       		bne.s	@wait
008904E6 4468 0010                  		neg.w	obVelX(a0)	; change direction
008904EA                            
008904EA                            	@wait:
008904EA 4E75                       		rts	
008904EC                            ; ===========================================================================
008904EC                            
008904EC                            @findfloor:
008904EC 6100 DEC4                  		bsr.w	ObjectMove
008904F0 4EB9 0000 0000             		jsr	ObjFloorDist
008904F6 0C41 FFF8                  		cmpi.w	#-8,d1
008904FA 6D00                       		blt.s	@pause
008904FC 0C41 000C                  		cmpi.w	#$C,d1
00890500 6C00                       		bge.s	@pause
00890502 D368 000C                  		add.w	d1,obY(a0)	; match	object's position with the floor
00890506 5328 0033                  		subq.b	#1,@smokedelay(a0)
0089050A 6A00                       		bpl.s	@nosmoke
0089050C 117C 000F 0033             		move.b	#$F,@smokedelay(a0)
00890512 6100 E34E                  		bsr.w	FindFreeObj
00890516 6600                       		bne.s	@nosmoke
00890518 137C 0040 0000             		move.b	#id_MotoBug,0(a1) ; load exhaust smoke object
0089051E 3368 0008 0008             		move.w	obX(a0),obX(a1)
00890524 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089052A 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
00890530 137C 0002 001C             		move.b	#2,obAnim(a1)
00890536                            
00890536                            	@nosmoke:
00890536 4E75                       		rts	
00890538                            
00890538                            @pause:
00890538 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0089053C 317C 003B 0030             		move.w	#59,@time(a0)	; set pause time to 1 second
00890542 317C 0000 0010             		move.w	#0,obVelX(a0)	; stop the object moving
00890548 117C 0000 001C             		move.b	#0,obAnim(a0)
0089054E 4E75                       		rts	
00890550                            ; ===========================================================================
00890550                            
00890550                            Moto_Animate:	; Routine 4
00890550 43F9 0000 0000             		lea	(Ani_Moto).l,a1
00890556 6100 AF58                  		bsr.w	AnimateSprite
0089055A 6000 DE70                  		bra.w	DisplaySprite
0089055E                            ; ===========================================================================
0089055E                            
0089055E                            Moto_Delete:	; Routine 6
0089055E 6000 DEA8                  		bra.w	DeleteObject
0089055E 6000 DEA8                  		bra.w	DeleteObject
00890562                            		include	"_anim\Moto Bug.asm"
00890562                            ; ---------------------------------------------------------------------------
00890562                            ; Animation script - Motobug enemy
00890562                            ; ---------------------------------------------------------------------------
00890562 0000                       Ani_Moto:	dc.w @stand-Ani_Moto
00890564 0000                       		dc.w @walk-Ani_Moto
00890566 0000                       		dc.w @smoke-Ani_Moto
00890568                            
00890568 0F02 FF                    @stand:		dc.b $F, 2, afEnd
0089056C 00                         		even
0089056C 0700 0100 02FF             @walk:		dc.b 7,	0, 1, 0, 2, afEnd
00890572 0103 0603 0604 0604 0604+  @smoke:		dc.b 1,	3, 6, 3, 6, 4, 6, 4, 6,	4, 6, 5, afRoutine
00890580 00                         		even
00890580 00                         		even
00890580                            		include	"_maps\Moto Bug.asm"
00890580                            ; ---------------------------------------------------------------------------
00890580                            ; Sprite mappings - Moto Bug enemy (GHZ)
00890580                            ; ---------------------------------------------------------------------------
00890580 0000 0000                  Map_Moto:	dc.w @moto1-Map_Moto, @moto2-Map_Moto
00890584 0000 0000                  		dc.w @moto3-Map_Moto, @smoke1-Map_Moto
00890588 0000 0000                  		dc.w @smoke2-Map_Moto, @smoke3-Map_Moto
0089058C 0000                       		dc.w @blank-Map_Moto
0089058E 04                         @moto1:		dc.b 4
0089058F F00D 0000 EC               		dc.b $F0, $D, 0, 0, $EC
00890594 000C 0008 EC               		dc.b 0,	$C, 0, 8, $EC
00890599 F801 000C 0C               		dc.b $F8, 1, 0,	$C, $C
0089059E 0808 000E F4               		dc.b 8,	8, 0, $E, $F4
008905A3 04                         @moto2:		dc.b 4
008905A4 F10D 0000 EC               		dc.b $F1, $D, 0, 0, $EC
008905A9 010C 0008 EC               		dc.b 1,	$C, 0, 8, $EC
008905AE F901 000C 0C               		dc.b $F9, 1, 0,	$C, $C
008905B3 0908 0011 F4               		dc.b 9,	8, 0, $11, $F4
008905B8 05                         @moto3:		dc.b 5
008905B9 F00D 0000 EC               		dc.b $F0, $D, 0, 0, $EC
008905BE 000C 0014 EC               		dc.b 0,	$C, 0, $14, $EC
008905C3 F801 000C 0C               		dc.b $F8, 1, 0,	$C, $C
008905C8 0804 0018 EC               		dc.b 8,	4, 0, $18, $EC
008905CD 0804 0012 FC               		dc.b 8,	4, 0, $12, $FC
008905D2 01                         @smoke1:	dc.b 1
008905D3 FA00 001A 10               		dc.b $FA, 0, 0,	$1A, $10
008905D8 01                         @smoke2:	dc.b 1
008905D9 FA00 001B 10               		dc.b $FA, 0, 0,	$1B, $10
008905DE 01                         @smoke3:	dc.b 1
008905DF FA00 001C 10               		dc.b $FA, 0, 0,	$1C, $10
008905E4 00                         @blank:		dc.b 0
008905E6 00                         		even
008905E6 00                         		even
008905E6                            		include	"_incObj\4F.asm"
008905E6                            ; ---------------------------------------------------------------------------
008905E6                            ; Object 4F - blank
008905E6                            ; ---------------------------------------------------------------------------
008905E6                            
008905E6                            Obj4F:					; XREF: Obj_Index
008905E6 4E75                       		rts	
008905E6 4E75                       		rts	
008905E8                            
008905E8                            		include	"_incObj\50 Yadrin.asm"
008905E8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008905E8                            
008905E8                            
008905E8                            Yad_ChkWall:				; XREF: Yad_FixToFloor
008905E8 3038 FE04                  		move.w	(v_framecount).w,d0
008905EC D047                       		add.w	d7,d0
008905EE 0240 0003                  		andi.w	#3,d0
008905F2 6600                       		bne.s	loc_F836
008905F4 7600                       		moveq	#0,d3
008905F6 1628 0019                  		move.b	obActWid(a0),d3
008905FA 4A68 0010                  		tst.w	obVelX(a0)
008905FE 6B00                       		bmi.s	loc_F82C
00890600 6100 0000                  		bsr.w	ObjHitWallRight
00890604 4A41                       		tst.w	d1
00890606 6A00                       		bpl.s	loc_F836
00890608                            
00890608                            loc_F828:
00890608 7001                       		moveq	#1,d0
0089060A 4E75                       		rts	
0089060C                            ; ===========================================================================
0089060C                            
0089060C                            loc_F82C:
0089060C 4643                       		not.w	d3
0089060E 6100 0000                  		bsr.w	ObjHitWallLeft
00890612 4A41                       		tst.w	d1
00890614 6BF2                       		bmi.s	loc_F828
00890616                            
00890616                            loc_F836:
00890616 7000                       		moveq	#0,d0
00890618 4E75                       		rts	
0089061A                            ; End of function Yad_ChkWall
0089061A                            
0089061A                            ; ===========================================================================
0089061A                            ; ---------------------------------------------------------------------------
0089061A                            ; Object 50 - Yadrin enemy (SYZ)
0089061A                            ; ---------------------------------------------------------------------------
0089061A                            
0089061A                            Yadrin:					; XREF: Obj_Index
0089061A 7000                       		moveq	#0,d0
0089061C 1028 0024                  		move.b	obRoutine(a0),d0
00890620 323B 0000                  		move.w	Yad_Index(pc,d0.w),d1
00890624 4EFB 1000                  		jmp	Yad_Index(pc,d1.w)
00890628                            ; ===========================================================================
00890628 0000                       Yad_Index:	dc.w Yad_Main-Yad_Index
0089062A 0000                       		dc.w Yad_Action-Yad_Index
0089062C                            
0089062C =00000030                  timedelay:	= $30
0089062C                            ; ===========================================================================
0089062C                            
0089062C                            Yad_Main:	; Routine 0
0089062C 217C 0000 0000 0004        		move.l	#Map_Yad,obMap(a0)
00890634 317C 247B 0002             		move.w	#$247B,obGfx(a0)
0089063A 117C 0004 0001             		move.b	#4,obRender(a0)
00890640 117C 0004 0018             		move.b	#4,obPriority(a0)
00890646 117C 0014 0019             		move.b	#$14,obActWid(a0)
0089064C 117C 0011 0016             		move.b	#$11,obHeight(a0)
00890652 117C 0008 0017             		move.b	#8,obWidth(a0)
00890658 117C 00CC 0020             		move.b	#$CC,obColType(a0)
0089065E 6100 DD32                  		bsr.w	ObjectMoveAndFall
00890662 6100 0000                  		bsr.w	ObjFloorDist
00890666 4A41                       		tst.w	d1
00890668 6A00                       		bpl.s	locret_F89E
0089066A D368 000C                  		add.w	d1,obY(a0)	; match	object's position with the floor
0089066E 317C 0000 0012             		move.w	#0,obVelY(a0)
00890674 5428 0024                  		addq.b	#2,obRoutine(a0)
00890678 0868 0000 0022             		bchg	#0,obStatus(a0)
0089067E                            
0089067E                            	locret_F89E:
0089067E 4E75                       		rts	
00890680                            ; ===========================================================================
00890680                            
00890680                            Yad_Action:	; Routine 2
00890680 7000                       		moveq	#0,d0
00890682 1028 0025                  		move.b	ob2ndRout(a0),d0
00890686 323B 0000                  		move.w	Yad_Index2(pc,d0.w),d1
0089068A 4EBB 1000                  		jsr	Yad_Index2(pc,d1.w)
0089068E 43F9 0000 0000             		lea	(Ani_Yad).l,a1
00890694 6100 AE1A                  		bsr.w	AnimateSprite
00890698 6000 FDF2                  		bra.w	RememberState
0089069C                            ; ===========================================================================
0089069C 0000                       Yad_Index2:	dc.w Yad_Move-Yad_Index2
0089069E 0000                       		dc.w Yad_FixToFloor-Yad_Index2
008906A0                            ; ===========================================================================
008906A0                            
008906A0                            Yad_Move:				; XREF: Yad_Index2
008906A0 5368 0030                  		subq.w	#1,timedelay(a0) ; subtract 1 from pause time
008906A4 6A00                       		bpl.s	locret_F8E2	; if time remains, branch
008906A6 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008906AA 317C FF00 0010             		move.w	#-$100,obVelX(a0) ; move object
008906B0 117C 0001 001C             		move.b	#1,obAnim(a0)
008906B6 0868 0000 0022             		bchg	#0,obStatus(a0)
008906BC 6600                       		bne.s	locret_F8E2
008906BE 4468 0010                  		neg.w	obVelX(a0)	; change direction
008906C2                            
008906C2                            	locret_F8E2:
008906C2 4E75                       		rts	
008906C4                            ; ===========================================================================
008906C4                            
008906C4                            Yad_FixToFloor:			; XREF: Yad_Index2
008906C4 6100 DCEC                  		bsr.w	ObjectMove
008906C8 6100 0000                  		bsr.w	ObjFloorDist
008906CC 0C41 FFF8                  		cmpi.w	#-8,d1
008906D0 6D00                       		blt.s	Yad_Pause
008906D2 0C41 000C                  		cmpi.w	#$C,d1
008906D6 6C00                       		bge.s	Yad_Pause
008906D8 D368 000C                  		add.w	d1,obY(a0)	; match	object's position to the floor
008906DC 6100 FF0A                  		bsr.w	Yad_ChkWall
008906E0 6600                       		bne.s	Yad_Pause
008906E2 4E75                       		rts	
008906E4                            ; ===========================================================================
008906E4                            
008906E4                            Yad_Pause:
008906E4 5528 0025                  		subq.b	#2,ob2ndRout(a0)
008906E8 317C 003B 0030             		move.w	#59,timedelay(a0) ; set pause time to 1 second
008906EE 317C 0000 0010             		move.w	#0,obVelX(a0)
008906F4 117C 0000 001C             		move.b	#0,obAnim(a0)
008906FA 4E75                       		rts	
008906FA 4E75                       		rts	
008906FC                            		include	"_anim\Yadrin.asm"
008906FC                            ; ---------------------------------------------------------------------------
008906FC                            ; Animation script - Yadrin enemy
008906FC                            ; ---------------------------------------------------------------------------
008906FC 0000                       Ani_Yad:	dc.w @stand-Ani_Yad
008906FE 0000                       		dc.w @walk-Ani_Yad
00890700                            
00890700 0700 FF                    @stand:		dc.b 7,	0, afEnd
00890704 00                         		even
00890704 0700 0301 0400 0302 05FF   @walk:		dc.b 7,	0, 3, 1, 4, 0, 3, 2, 5,	afEnd
0089070E                            		even
0089070E                            		even
0089070E                            		include	"_maps\Yadrin.asm"
0089070E                            ; ---------------------------------------------------------------------------
0089070E                            ; Sprite mappings - Yadrin enemy (SYZ)
0089070E                            ; ---------------------------------------------------------------------------
0089070E 0000 0000                  Map_Yad:	dc.w @walk0-Map_Yad, @walk1-Map_Yad
00890712 0000 0000                  		dc.w @walk2-Map_Yad, @walk3-Map_Yad
00890716 0000 0000                  		dc.w @walk4-Map_Yad, @walk5-Map_Yad
0089071A 05                         @walk0:		dc.b 5
0089071B F408 0000 F4               		dc.b $F4, 8, 0,	0, $F4
00890720 FC0E 0003 EC               		dc.b $FC, $E, 0, 3, $EC
00890725 EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
0089072A F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
0089072F 0409 0031 FC               		dc.b 4,	9, 0, $31, $FC
00890734 05                         @walk1:		dc.b 5
00890735 F408 0014 F4               		dc.b $F4, 8, 0,	$14, $F4
0089073A FC0E 0017 EC               		dc.b $FC, $E, 0, $17, $EC
0089073F EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
00890744 F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
00890749 0409 0031 FC               		dc.b 4,	9, 0, $31, $FC
0089074E 05                         @walk2:		dc.b 5
0089074F F409 0023 F4               		dc.b $F4, 9, 0,	$23, $F4
00890754 040D 0029 EC               		dc.b 4,	$D, 0, $29, $EC
00890759 EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
0089075E F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
00890763 0409 0031 FC               		dc.b 4,	9, 0, $31, $FC
00890768 05                         @walk3:		dc.b 5
00890769 F408 0000 F4               		dc.b $F4, 8, 0,	0, $F4
0089076E FC0E 0003 EC               		dc.b $FC, $E, 0, 3, $EC
00890773 EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
00890778 F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
0089077D 0409 0037 FC               		dc.b 4,	9, 0, $37, $FC
00890782 05                         @walk4:		dc.b 5
00890783 F408 0014 F4               		dc.b $F4, 8, 0,	$14, $F4
00890788 FC0E 0017 EC               		dc.b $FC, $E, 0, $17, $EC
0089078D EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
00890792 F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
00890797 0409 0037 FC               		dc.b 4,	9, 0, $37, $FC
0089079C 05                         @walk5:		dc.b 5
0089079D F409 0023 F4               		dc.b $F4, 9, 0,	$23, $F4
008907A2 040D 0029 EC               		dc.b 4,	$D, 0, $29, $EC
008907A7 EC04 000F FC               		dc.b $EC, 4, 0,	$F, $FC
008907AC F402 0011 0C               		dc.b $F4, 2, 0,	$11, $C
008907B1 0409 0037 FC               		dc.b 4,	9, 0, $37, $FC
008907B6                            		even
008907B6                            		even
008907B6                            
008907B6                            		include	"_incObj\sub SolidObject.asm"
008907B6                            ; ---------------------------------------------------------------------------
008907B6                            ; Solid	object subroutine (includes spikes, blocks, rocks etc)
008907B6                            ;
008907B6                            ; input:
008907B6                            ;	d1 = width
008907B6                            ;	d2 = height / 2 (when jumping)
008907B6                            ;	d3 = height / 2 (when walking)
008907B6                            ;	d4 = x-axis position
008907B6                            ; ---------------------------------------------------------------------------
008907B6                            
008907B6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008907B6                            
008907B6                            
008907B6                            SolidObject:
008907B6 4A28 0025                  		tst.b	obSolid(a0)	; is Sonic standing on the object?
008907BA 6700 0000                  		beq.w	Solid_ChkEnter	; if not, branch
008907BE 3401                       		move.w	d1,d2
008907C0 D442                       		add.w	d2,d2
008907C2 43F8 D000                  		lea	(v_player).w,a1
008907C6 0829 0001 0022             		btst	#1,obStatus(a1)	; is Sonic in the air?
008907CC 6600                       		bne.s	@leave		; if yes, branch
008907CE 3029 0008                  		move.w	obX(a1),d0
008907D2 9068 0008                  		sub.w	obX(a0),d0
008907D6 D041                       		add.w	d1,d0
008907D8 6B00                       		bmi.s	@leave		; if Sonic moves off the left, branch
008907DA B042                       		cmp.w	d2,d0		; has Sonic moved off the right?
008907DC 6500                       		bcs.s	@stand		; if not, branch
008907DE                            
008907DE                            	@leave:
008907DE 08A9 0003 0022             		bclr	#3,obStatus(a1)	; clear Sonic's standing flag
008907E4 08A8 0003 0022             		bclr	#3,obStatus(a0)	; clear object's standing flag
008907EA 4228 0025                  		clr.b	obSolid(a0)
008907EE 7800                       		moveq	#0,d4
008907F0 4E75                       		rts	
008907F2                            
008907F2                            	@stand:
008907F2 3404                       		move.w	d4,d2
008907F4 4EB9 0088 8756             		jsr	MvSonicOnPtfm
008907FA 7800                       		moveq	#0,d4
008907FC 4E75                       		rts	
008907FE                            ; ===========================================================================
008907FE                            
008907FE                            SolidObject71:				; XREF: Obj71_Solid
008907FE 4A28 0025                  		tst.b	obSolid(a0)
00890802 6700 0000                  		beq.w	loc_FAD0
00890806 3401                       		move.w	d1,d2
00890808 D442                       		add.w	d2,d2
0089080A 43F8 D000                  		lea	(v_player).w,a1
0089080E 0829 0001 0022             		btst	#1,obStatus(a1)
00890814 6600                       		bne.s	@leave
00890816 3029 0008                  		move.w	obX(a1),d0
0089081A 9068 0008                  		sub.w	obX(a0),d0
0089081E D041                       		add.w	d1,d0
00890820 6B00                       		bmi.s	@leave
00890822 B042                       		cmp.w	d2,d0
00890824 6500                       		bcs.s	@stand
00890826                            
00890826                            	@leave:
00890826 08A9 0003 0022             		bclr	#3,obStatus(a1)
0089082C 08A8 0003 0022             		bclr	#3,obStatus(a0)
00890832 4228 0025                  		clr.b	obSolid(a0)
00890836 7800                       		moveq	#0,d4
00890838 4E75                       		rts	
0089083A                            
0089083A                            	@stand:
0089083A 3404                       		move.w	d4,d2
0089083C 4EB9 0088 8756             		jsr	MvSonicOnPtfm
00890842 7800                       		moveq	#0,d4
00890844 4E75                       		rts	
00890846                            ; ===========================================================================
00890846                            
00890846                            SolidObject2F:				; XREF: Obj2F_Solid
00890846 43F8 D000                  		lea	(v_player).w,a1
0089084A 4A28 0001                  		tst.b	obRender(a0)
0089084E 6A00 0000                  		bpl.w	Solid_Ignore
00890852 3029 0008                  		move.w	obX(a1),d0
00890856 9068 0008                  		sub.w	obX(a0),d0
0089085A D041                       		add.w	d1,d0
0089085C 6B00 0000                  		bmi.w	Solid_Ignore
00890860 3601                       		move.w	d1,d3
00890862 D643                       		add.w	d3,d3
00890864 B043                       		cmp.w	d3,d0
00890866 6200 0000                  		bhi.w	Solid_Ignore
0089086A 3A00                       		move.w	d0,d5
0089086C 0828 0000 0001             		btst	#0,obRender(a0)	; is object horizontally flipped?
00890872 6700                       		beq.s	@notflipped	; if not, branch
00890874 4645                       		not.w	d5
00890876 DA43                       		add.w	d3,d5
00890878                            
00890878                            	@notflipped:
00890878 E24D                       		lsr.w	#1,d5
0089087A 7600                       		moveq	#0,d3
0089087C 1632 5000                  		move.b	(a2,d5.w),d3
00890880 9612                       		sub.b	(a2),d3
00890882 3A28 000C                  		move.w	obY(a0),d5
00890886 9A43                       		sub.w	d3,d5
00890888 1629 0016                  		move.b	obHeight(a1),d3
0089088C 4883                       		ext.w	d3
0089088E D443                       		add.w	d3,d2
00890890 3629 000C                  		move.w	obY(a1),d3
00890894 9645                       		sub.w	d5,d3
00890896 5843                       		addq.w	#4,d3
00890898 D642                       		add.w	d2,d3
0089089A 6B00 0000                  		bmi.w	Solid_Ignore
0089089E 3802                       		move.w	d2,d4
008908A0 D844                       		add.w	d4,d4
008908A2 B644                       		cmp.w	d4,d3
008908A4 6400 0000                  		bcc.w	Solid_Ignore
008908A8 6000 0000                  		bra.w	loc_FB0E
008908AC                            ; ===========================================================================
008908AC                            
008908AC                            Solid_ChkEnter:
008908AC 4A28 0001                  		tst.b	obRender(a0)
008908B0 6A00 0000                  		bpl.w	Solid_Ignore
008908B4                            
008908B4                            loc_FAD0:
008908B4 43F8 D000                  		lea	(v_player).w,a1
008908B8 3029 0008                  		move.w	obX(a1),d0
008908BC 9068 0008                  		sub.w	obX(a0),d0
008908C0 D041                       		add.w	d1,d0
008908C2 6B00 0000                  		bmi.w	Solid_Ignore	; if Sonic moves off the left, branch
008908C6 3601                       		move.w	d1,d3
008908C8 D643                       		add.w	d3,d3
008908CA B043                       		cmp.w	d3,d0		; has Sonic moved off the right?
008908CC 6200 0000                  		bhi.w	Solid_Ignore	; if yes, branch
008908D0 1629 0016                  		move.b	obHeight(a1),d3
008908D4 4883                       		ext.w	d3
008908D6 D443                       		add.w	d3,d2
008908D8 3629 000C                  		move.w	obY(a1),d3
008908DC                            		
008908DC                            	;Mercury Ducking Size Fix
008908DC                            	
008908DC 0C29 0000 001C             		cmpi.b	#id_SpinDash,obAnim(a1)
008908E2 6700                       		beq.s	@short
008908E4                            	
008908E4 0C29 0000 001C             		cmpi.b	#id_Duck,obAnim(a1)
008908EA 6600                       		bne.s	@skip
008908EC                            		
008908EC                            	@short:
008908EC 0442 0005                  		subi.w	#5,d2
008908F0 0643 0005                  		addi.w	#5,d3
008908F4                            		
008908F4                            	@skip:
008908F4                            	;end Ducking Size Fix
008908F4                            		
008908F4 9668 000C                  		sub.w	obY(a0),d3
008908F8 5843                       		addq.w	#4,d3
008908FA D642                       		add.w	d2,d3
008908FC 6B00 0000                  		bmi.w	Solid_Ignore	; if Sonic moves above, branch
00890900 3802                       		move.w	d2,d4
00890902 D844                       		add.w	d4,d4
00890904 B644                       		cmp.w	d4,d3		; has Sonic moved below?
00890906 6400 0000                  		bcc.w	Solid_Ignore	; if yes, branch
0089090A                            
0089090A                            loc_FB0E:
0089090A 4A38 F7C8                  		tst.b	(f_lockmulti).w	; are controls locked?
0089090E 6B00 0000                  		bmi.w	Solid_Ignore	; if yes, branch
00890912 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w ; is Sonic dying?
00890918                            
00890918 6400 0000                  		bcc.w	Solid_Debug
0089091C                            
0089091C 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode being used?
00890920 6600 0000                  		bne.w	Solid_Debug	; if yes, branch
00890924 3A00                       		move.w	d0,d5
00890926 B240                       		cmp.w	d0,d1		; is Sonic right of centre of object?
00890928 6400                       		bcc.s	@isright	; if yes, branch
0089092A D241                       		add.w	d1,d1
0089092C 9041                       		sub.w	d1,d0
0089092E 3A00                       		move.w	d0,d5
00890930 4445                       		neg.w	d5
00890932                            
00890932                            	@isright:
00890932 3203                       		move.w	d3,d1
00890934 B443                       		cmp.w	d3,d2		; is Sonic below centre of object?
00890936 6400                       		bcc.s	@isbelow	; if yes, branch
00890938                            
00890938 5943                       		subq.w	#4,d3
0089093A 9644                       		sub.w	d4,d3
0089093C 3203                       		move.w	d3,d1
0089093E 4441                       		neg.w	d1
00890940                            
00890940                            	@isbelow:
00890940 BA41                       		cmp.w	d1,d5
00890942 6200 0000                  		bhi.w	Solid_TopBottom	; if Sonic hits top or bottom, branch
00890946 0C41 0004                  		cmpi.w	#4,d1
0089094A                            
0089094A 6300                       		bls.s	Solid_SideAir2
0089094C 7200                       		moveq	#0,d1
0089094E                            
0089094E 4A40                       		tst.w	d0		; where is Sonic?
00890950 6700                       		beq.s	Solid_Centre	; if inside the object, branch
00890952 6B00                       		bmi.s	Solid_Right	; if right of the object, branch
00890954 4A69 0010                  		tst.w	obVelX(a1)	; is Sonic moving left?
00890958 6B00                       		bmi.s	Solid_Centre	; if yes, branch
0089095A                            		
0089095A 123C 0008                  		move.b	#btnR,d1
0089095E                            	
0089095E 6000                       		bra.s	Solid_Left
00890960                            ; ===========================================================================
00890960                            
00890960                            Solid_Right:
00890960 4A69 0010                  		tst.w	obVelX(a1)	; is Sonic moving right?
00890964 6A00                       		bpl.s	Solid_Centre	; if yes, branch
00890966                            	
00890966 123C 0004                  		move.b	#btnL,d1
0089096A                            
0089096A                            Solid_Left:
0089096A 337C 0000 0014             		move.w	#0,obInertia(a1)
00890970 337C 0000 0010             		move.w	#0,obVelX(a1)	; stop Sonic moving
00890976                            
00890976                            Solid_Centre:
00890976 9169 0008                  		sub.w	d0,obX(a1)	; correct Sonic's position
0089097A 0829 0001 0022             		btst	#1,obStatus(a1)	; is Sonic in the air?
00890980 6600                       		bne.s	Solid_SideAir	; if yes, branch
00890982 08E9 0005 0022             		bset	#staPush,obStatus(a1)	; make Sonic push object	;Mercury Constants
00890988 08E8 0005 0022             		bset	#staPush,obStatus(a0)	; make object be pushed	;Mercury Constants
0089098E 7801                       		moveq	#1,d4		; return side collision
00890990 4E75                       		rts	
00890992                            ; ===========================================================================
00890992                            
00890992                            Solid_SideAir:
00890992                            
00890992 2F08                       		move.l	a0,-(sp)
00890994 2049                       		movea.l	a1,a0
00890996 6100 0000                  		bsr.w	WallJump
0089099A 205F                       		movea.l	(sp)+,a0
0089099C                            		
0089099C                            Solid_SideAir2:
0089099C                            	
0089099C 6100                       		bsr.s	Solid_NotPushing	
0089099E 7801                       		moveq	#1,d4		; return side collision
008909A0 4E75                       		rts	
008909A2                            ; ===========================================================================
008909A2                            
008909A2                            Solid_Ignore:
008909A2 0828 0005 0022             		btst	#staPush,obStatus(a0)	; is Sonic pushing?	;Mercury Constants
008909A8 6700                       		beq.s	Solid_Debug	; if not, branch
008909AA                            		
008909AA                            		;move.w	#id_Run,obAnim(a1) ; use running animation	;Mercury Walking In Air Fix
008909AA                            
008909AA                            Solid_NotPushing:
008909AA 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	; clear pushing flag	;Mercury Constants
008909B0 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	; clear Sonic's pushing flag	;Mercury Constants
008909B6                            
008909B6                            Solid_Debug:
008909B6 7800                       		moveq	#0,d4		; return no collision
008909B8 4E75                       		rts	
008909BA                            ; ===========================================================================
008909BA                            
008909BA                            Solid_TopBottom:
008909BA 4A43                       		tst.w	d3		; is Sonic below the object?
008909BC 6B00                       		bmi.s	Solid_Below	; if yes, branch
008909BE 0C43 0010                  		cmpi.w	#$10,d3		; has Sonic landed on the object?
008909C2 6500                       		bcs.s	Solid_Landed	; if yes, branch
008909C4 60DC                       		bra.s	Solid_Ignore
008909C6                            ; ===========================================================================
008909C6                            
008909C6                            Solid_Below:
008909C6 4A69 0012                  		tst.w	obVelY(a1)	; is Sonic moving vertically?
008909CA 6700                       		beq.s	Solid_Squash	; if not, branch
008909CC 6A00                       		bpl.s	Solid_TopBtmAir	; if moving downwards, branch
008909CE 4A43                       		tst.w	d3		; is Sonic above the object?
008909D0 6A00                       		bpl.s	Solid_TopBtmAir	; if yes, branch
008909D2 9769 000C                  		sub.w	d3,obY(a1)	; correct Sonic's position
008909D6 337C 0000 0012             		move.w	#0,obVelY(a1)	; stop Sonic moving
008909DC                            
008909DC                            Solid_TopBtmAir:
008909DC 78FF                       		moveq	#-1,d4
008909DE 4E75                       		rts	
008909E0                            ; ===========================================================================
008909E0                            
008909E0                            Solid_Squash:
008909E0 0829 0001 0022             		btst	#1,obStatus(a1)	; is Sonic in the air?
008909E6 66F4                       		bne.s	Solid_TopBtmAir	; if yes, branch
008909E8 2F08                       		move.l	a0,-(sp)
008909EA 2049                       		movea.l	a1,a0
008909EC 4EB9 0000 0000             		jsr	KillSonic	; kill Sonic
008909F2 205F                       		movea.l	(sp)+,a0
008909F4 78FF                       		moveq	#-1,d4
008909F6 4E75                       		rts	
008909F8                            ; ===========================================================================
008909F8                            
008909F8                            Solid_Landed:
008909F8 5943                       		subq.w	#4,d3
008909FA 7200                       		moveq	#0,d1
008909FC 1228 0019                  		move.b	obActWid(a0),d1
00890A00 3401                       		move.w	d1,d2
00890A02 D442                       		add.w	d2,d2
00890A04 D269 0008                  		add.w	obX(a1),d1
00890A08 9268 0008                  		sub.w	obX(a0),d1
00890A0C 6B00                       		bmi.s	Solid_Miss	; if Sonic is right of object, branch
00890A0E B242                       		cmp.w	d2,d1		; is Sonic left of object?
00890A10 6400                       		bcc.s	Solid_Miss	; if yes, branch
00890A12 4A69 0012                  		tst.w	obVelY(a1)	; is Sonic moving upwards?
00890A16 6B00                       		bmi.s	Solid_Miss	; if yes, branch
00890A18 9769 000C                  		sub.w	d3,obY(a1)	; correct Sonic's position
00890A1C 5369 000C                  		subq.w	#1,obY(a1)
00890A20 6100                       		bsr.s	Solid_ResetFloor
00890A22 117C 0002 0025             		move.b	#2,obSolid(a0) ; set standing flags
00890A28 08E8 0003 0022             		bset	#3,obStatus(a0)
00890A2E 78FF                       		moveq	#-1,d4		; return top/bottom collision
00890A30 4E75                       		rts	
00890A32                            ; ===========================================================================
00890A32                            
00890A32                            Solid_Miss:
00890A32 7800                       		moveq	#0,d4
00890A34 4E75                       		rts	
00890A36                            ; End of function SolidObject
00890A36                            
00890A36                            
00890A36                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00890A36                            
00890A36                            
00890A36                            Solid_ResetFloor:
00890A36 0829 0003 0022             		btst	#3,obStatus(a1)	; is Sonic standing on something?
00890A3C 6700                       		beq.s	@notonobj	; if not, branch
00890A3E                            
00890A3E 7000                       		moveq	#0,d0
00890A40 1029 003D                  		move.b	$3D(a1),d0	; get object being stood on
00890A44 ED48                       		lsl.w	#6,d0
00890A46 0680 00FF D000             		addi.l	#(v_objspace&$FFFFFF),d0
00890A4C 2440                       		movea.l	d0,a2
00890A4E 08AA 0003 0022             		bclr	#3,obStatus(a2)	; clear object's standing flags
00890A54 422A 0025                  		clr.b	obSolid(a2)
00890A58                            
00890A58                            	@notonobj:
00890A58 3008                       		move.w	a0,d0
00890A5A 0440 D000                  		subi.w	#$D000,d0
00890A5E EC48                       		lsr.w	#6,d0
00890A60 0240 007F                  		andi.w	#$7F,d0
00890A64 1340 003D                  		move.b	d0,$3D(a1)	; set object being stood on
00890A68 137C 0000 0026             		move.b	#0,obAngle(a1)	; clear Sonic's angle
00890A6E 337C 0000 0012             		move.w	#0,obVelY(a1)	; stop Sonic
00890A74 3369 0010 0014             		move.w	obVelX(a1),obInertia(a1)
00890A7A 0829 0001 0022             		btst	#1,obStatus(a1)	; is Sonic in the air?
00890A80 6700                       		beq.s	@notinair	; if not, branch
00890A82 2F08                       		move.l	a0,-(sp)
00890A84 2049                       		movea.l	a1,a0
00890A86 4EB9 0000 0000             		jsr	Sonic_ResetOnFloor ; reset Sonic as if on floor
00890A8C 205F                       		movea.l	(sp)+,a0
00890A8E                            
00890A8E                            	@notinair:
00890A8E 08E9 0003 0022             		bset	#3,obStatus(a1)	; set object standing flag
00890A94 08E8 0003 0022             		bset	#3,obStatus(a0)	; set Sonic standing on object flag
00890A9A 4E75                       		rts	
00890A9C                            ; End of function Solid_ResetFloor
00890A9C                            ; End of function Solid_ResetFloor
00890A9C                            
00890A9C                            		include	"_incObj\51 Smashable Green Block.asm"
00890A9C                            ; ---------------------------------------------------------------------------
00890A9C                            ; Object 51 - smashable	green block (MZ)
00890A9C                            ; ---------------------------------------------------------------------------
00890A9C                            
00890A9C                            SmashBlock:				; XREF: Obj_Index
00890A9C 7000                       		moveq	#0,d0
00890A9E 1028 0024                  		move.b	obRoutine(a0),d0
00890AA2 323B 0000                  		move.w	Smab_Index(pc,d0.w),d1
00890AA6 4EBB 1000                  		jsr	Smab_Index(pc,d1.w)
00890AAA 6000 F9E0                  		bra.w	RememberState
00890AAE                            ; ===========================================================================
00890AAE 0000                       Smab_Index:	dc.w Smab_Main-Smab_Index
00890AB0 0000                       		dc.w Smab_Solid-Smab_Index
00890AB2 0000                       		dc.w Smab_Points-Smab_Index
00890AB4                            ; ===========================================================================
00890AB4                            
00890AB4                            Smab_Main:	; Routine 0
00890AB4 5428 0024                  		addq.b	#2,obRoutine(a0)
00890AB8 217C 0000 0000 0004        		move.l	#Map_Smab,obMap(a0)
00890AC0 317C 42B8 0002             		move.w	#$42B8,obGfx(a0)
00890AC6 117C 0004 0001             		move.b	#4,obRender(a0)
00890ACC 117C 0010 0019             		move.b	#$10,obActWid(a0)
00890AD2 117C 0004 0018             		move.b	#4,obPriority(a0)
00890AD8 1168 0028 001A             		move.b	obSubtype(a0),obFrame(a0)
00890ADE                            
00890ADE                            Smab_Solid:	; Routine 2
00890ADE                            
00890ADE =00000032                  sonicAniFrame:	= $32		; Sonic's current animation number
00890ADE =00000034                  @count:		= $34		; number of blocks hit + previous stuff
00890ADE                            
00890ADE 3178 F7D0 0034             		move.w	(v_itembonus).w,$34(a0)
00890AE4 1178 D01C 0032             		move.b	(v_player+obAnim).w,sonicAniFrame(a0) ; load Sonic's animation number
00890AEA 323C 001B                  		move.w	#$1B,d1
00890AEE 343C 0010                  		move.w	#$10,d2
00890AF2 363C 0011                  		move.w	#$11,d3
00890AF6 3828 0008                  		move.w	obX(a0),d4
00890AFA 6100 FCBA                  		bsr.w	SolidObject
00890AFE 0828 0003 0022             		btst	#3,obStatus(a0)	; has Sonic landed on the block?
00890B04 6600                       		bne.s	@smash		; if yes, branch
00890B06                            
00890B06                            	@notspinning:
00890B06 4E75                       		rts	
00890B08                            ; ===========================================================================
00890B08                            
00890B08                            @smash:
00890B08 0C28 0000 0032             		cmpi.b	#id_Roll,sonicAniFrame(a0) ; is Sonic rolling/jumping?
00890B0E 66F6                       		bne.s	@notspinning	; if not, branch
00890B10 31E8 0034 F7D0             		move.w	@count(a0),(v_itembonus).w
00890B16 08E9 0002 0022             		bset	#2,obStatus(a1)
00890B1C 137C 000E 0016             		move.b	#$E,obHeight(a1)
00890B22 137C 0007 0017             		move.b	#7,obWidth(a1)
00890B28 137C 0000 001C             		move.b	#id_Roll,obAnim(a1) ; make Sonic roll
00890B2E 337C FD00 0012             		move.w	#-$300,obVelY(a1) ; rebound Sonic
00890B34 08E9 0001 0022             		bset	#1,obStatus(a1)
00890B3A 08A9 0003 0022             		bclr	#3,obStatus(a1)
00890B40 137C 0002 0024             		move.b	#2,obRoutine(a1)
00890B46 08A8 0003 0022             		bclr	#3,obStatus(a0)
00890B4C 4228 0025                  		clr.b	obSolid(a0)
00890B50 117C 0001 001A             		move.b	#1,obFrame(a0)
00890B56 49F9 0000 0000             		lea	(Smab_Speeds).l,a4 ; load broken fragment speed data
00890B5C 7203                       		moveq	#3,d1		; set number of	fragments to 4
00890B5E 343C 0038                  		move.w	#$38,d2
00890B62 6100 D46A                  		bsr.w	SmashObject
00890B66 6100 DCFA                  		bsr.w	FindFreeObj
00890B6A 6600                       		bne.s	Smab_Points
00890B6C 137C 0029 0000             		move.b	#id_Points,0(a1) ; load points object
00890B72 3368 0008 0008             		move.w	obX(a0),obX(a1)
00890B78 3368 000C 000C             		move.w	obY(a0),obY(a1)
00890B7E 3438 F7D0                  		move.w	(v_itembonus).w,d2
00890B82 5478 F7D0                  		addq.w	#2,(v_itembonus).w ; increment bonus counter
00890B86 0C42 0006                  		cmpi.w	#6,d2		; have fewer than 3 blocks broken?
00890B8A 6500                       		bcs.s	@bonus		; if yes, branch
00890B8C 7406                       		moveq	#6,d2		; set cap for points
00890B8E                            
00890B8E                            	@bonus:
00890B8E 7000                       		moveq	#0,d0
00890B90 303B 2000                  		move.w	Smab_Scores(pc,d2.w),d0
00890B94 0C78 0020 F7D0             		cmpi.w	#$20,(v_itembonus).w ; have 16 blocks been smashed?
00890B9A 6500                       		bcs.s	@givepoints	; if not, branch
00890B9C 303C 03E8                  		move.w	#1000,d0	; give higher points for 16th block
00890BA0 740A                       		moveq	#10,d2
00890BA2                            
00890BA2                            	@givepoints:
00890BA2 4EB9 0000 0000             		jsr	AddPoints
00890BA8 E24A                       		lsr.w	#1,d2
00890BAA 1342 001A                  		move.b	d2,obFrame(a1)
00890BAE                            
00890BAE                            Smab_Points:	; Routine 4
00890BAE 6100 D802                  		bsr.w	ObjectMove
00890BB2 0668 0038 0012             		addi.w	#$38,obVelY(a0)
00890BB8 6100 D812                  		bsr.w	DisplaySprite
00890BBC 4A28 0001                  		tst.b	obRender(a0)
00890BC0 6A00 D846                  		bpl.w	DeleteObject
00890BC4 4E75                       		rts	
00890BC6                            ; ===========================================================================
00890BC6 FE00 FE00                  Smab_Speeds:	dc.w -$200, -$200	; x-speed, y-speed
00890BCA FF00 FF00                  		dc.w -$100, -$100
00890BCE 0200 FE00                  		dc.w $200, -$200
00890BD2 0100 FF00                  		dc.w $100, -$100
00890BD6                            
00890BD6 000A 0014 0032 0064        Smab_Scores:	dc.w 10, 20, 50, 100
00890BD6 000A 0014 0032 0064        Smab_Scores:	dc.w 10, 20, 50, 100
00890BDE                            		include	"_maps\Smashable Green Block.asm"
00890BDE                            ; ---------------------------------------------------------------------------
00890BDE                            ; Sprite mappings - smashable green block (MZ)
00890BDE                            ; ---------------------------------------------------------------------------
00890BDE 0000                       Map_Smab:	dc.w @two-Map_Smab
00890BE0 0000                       		dc.w @four-Map_Smab
00890BE2 02                         @two:		dc.b 2
00890BE3 F00D 0000 F0               		dc.b $F0, $D, 0, 0, $F0	; two fragments, arranged vertically
00890BE8 000D 0000 F0               		dc.b 0,	$D, 0, 0, $F0
00890BED 04                         @four:		dc.b 4
00890BEE F005 8000 F0               		dc.b $F0, 5, $80, 0, $F0 ; four fragments
00890BF3 0005 8000 F0               		dc.b 0,	5, $80,	0, $F0
00890BF8 F005 8000 00               		dc.b $F0, 5, $80, 0, 0
00890BFD 0005 8000 00               		dc.b 0,	5, $80,	0, 0
00890C02                            		even
00890C02                            		even
00890C02                            
00890C02                            		include	"_incObj\52 Moving Blocks.asm"
00890C02                            ; ---------------------------------------------------------------------------
00890C02                            ; Object 52 - moving platform blocks (MZ, LZ, SBZ)
00890C02                            ; ---------------------------------------------------------------------------
00890C02                            
00890C02                            MovingBlock:				; XREF: Obj_Index
00890C02 7000                       		moveq	#0,d0
00890C04 1028 0024                  		move.b	obRoutine(a0),d0
00890C08 323B 0000                  		move.w	MBlock_Index(pc,d0.w),d1
00890C0C 4EFB 1000                  		jmp	MBlock_Index(pc,d1.w)
00890C10                            ; ===========================================================================
00890C10 0000                       MBlock_Index:	dc.w MBlock_Main-MBlock_Index
00890C12 0000                       		dc.w MBlock_Platform-MBlock_Index
00890C14 0000                       		dc.w MBlock_StandOn-MBlock_Index
00890C16                            
00890C16 =00000030                  origX:		= $30
00890C16 =00000032                  origY:		= $32
00890C16                            
00890C16 1000                       MBlock_Var:	dc.b $10, 0		; object width,	frame number
00890C18 2001                       		dc.b $20, 1
00890C1A 2002                       		dc.b $20, 2
00890C1C 4003                       		dc.b $40, 3
00890C1E 3004                       		dc.b $30, 4
00890C20                            ; ===========================================================================
00890C20                            
00890C20                            MBlock_Main:	; Routine 0
00890C20 5428 0024                  		addq.b	#2,obRoutine(a0)
00890C24 217C 0000 0000 0004        		move.l	#Map_MBlock,obMap(a0)
00890C2C 317C 42B8 0002             		move.w	#$42B8,obGfx(a0)
00890C32 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
00890C38 6600                       		bne.s	loc_FE44
00890C3A 217C 0000 0000 0004        		move.l	#Map_MBlockLZ,obMap(a0) ; LZ specific code
00890C42 317C 43BC 0002             		move.w	#$43BC,obGfx(a0)
00890C48 117C 0007 0016             		move.b	#7,obHeight(a0)
00890C4E                            
00890C4E                            loc_FE44:
00890C4E 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; check if level is SBZ
00890C54 6600                       		bne.s	loc_FE60
00890C56 317C 22C0 0002             		move.w	#$22C0,obGfx(a0) ; SBZ specific code (object 5228)
00890C5C 0C28 0028 0028             		cmpi.b	#$28,obSubtype(a0) ; is object 5228 ?
00890C62 6700                       		beq.s	loc_FE60	; if yes, branch
00890C64 317C 4460 0002             		move.w	#$4460,obGfx(a0) ; SBZ specific code (object 523x)
00890C6A                            
00890C6A                            loc_FE60:
00890C6A 117C 0004 0001             		move.b	#4,obRender(a0)
00890C70 7000                       		moveq	#0,d0
00890C72 1028 0028                  		move.b	obSubtype(a0),d0
00890C76 E648                       		lsr.w	#3,d0
00890C78 0240 001E                  		andi.w	#$1E,d0
00890C7C 45FB 0098                  		lea	MBlock_Var(pc,d0.w),a2
00890C80 115A 0019                  		move.b	(a2)+,obActWid(a0)
00890C84 115A 001A                  		move.b	(a2)+,obFrame(a0)
00890C88 117C 0004 0018             		move.b	#4,obPriority(a0)
00890C8E 3168 0008 0030             		move.w	obX(a0),origX(a0)
00890C94 3168 000C 0032             		move.w	obY(a0),origY(a0)
00890C9A 0228 000F 0028             		andi.b	#$F,obSubtype(a0)
00890CA0                            
00890CA0                            MBlock_Platform: ; Routine 2
00890CA0 6100 0000                  		bsr.w	MBlock_Move
00890CA4 7200                       		moveq	#0,d1
00890CA6 1228 0019                  		move.b	obActWid(a0),d1
00890CAA 4EB9 0088 8080             		jsr	(PlatformObject).l
00890CB0 6000                       		bra.s	MBlock_ChkDel
00890CB2                            ; ===========================================================================
00890CB2                            
00890CB2                            MBlock_StandOn:	; Routine 4
00890CB2 7200                       		moveq	#0,d1
00890CB4 1228 0019                  		move.b	obActWid(a0),d1
00890CB8 4EB9 0088 81F4             		jsr	(ExitPlatform).l
00890CBE 3F28 0008                  		move.w	obX(a0),-(sp)
00890CC2 6100 0000                  		bsr.w	MBlock_Move
00890CC6 341F                       		move.w	(sp)+,d2
00890CC8 4EB9 0088 8762             		jsr	(MvSonicOnPtfm2).l
00890CCE                            
00890CCE                            MBlock_ChkDel:				; XREF: MBlock_Platform
00890CEC 6000 D6DE                  		bra.w	DisplaySprite
00890CF0                            ; ===========================================================================
00890CF0                            
00890CF0                            MBlock_Move:				; XREF: MBlock_Platform; MBlock_StandOn
00890CF0 7000                       		moveq	#0,d0
00890CF2 1028 0028                  		move.b	obSubtype(a0),d0
00890CF6 0240 000F                  		andi.w	#$F,d0
00890CFA D040                       		add.w	d0,d0
00890CFC 323B 0000                  		move.w	MBlock_TypeIndex(pc,d0.w),d1
00890D00 4EFB 1000                  		jmp	MBlock_TypeIndex(pc,d1.w)
00890D04                            ; ===========================================================================
00890D04 0000 0000                  MBlock_TypeIndex:dc.w MBlock_Type00-MBlock_TypeIndex, MBlock_Type01-MBlock_TypeIndex
00890D08 0000 0000                  		dc.w MBlock_Type02-MBlock_TypeIndex, MBlock_Type03-MBlock_TypeIndex
00890D0C 0000 0000                  		dc.w MBlock_Type02-MBlock_TypeIndex, MBlock_Type05-MBlock_TypeIndex
00890D10 0000 0000                  		dc.w MBlock_Type06-MBlock_TypeIndex, MBlock_Type07-MBlock_TypeIndex
00890D14 0000 0000                  		dc.w MBlock_Type08-MBlock_TypeIndex, MBlock_Type02-MBlock_TypeIndex
00890D18 0000                       		dc.w MBlock_Type0A-MBlock_TypeIndex
00890D1A                            ; ===========================================================================
00890D1A                            
00890D1A                            MBlock_Type00:				; XREF: MBlock_TypeIndex
00890D1A 4E75                       		rts	
00890D1C                            ; ===========================================================================
00890D1C                            
00890D1C                            MBlock_Type01:				; XREF: MBlock_TypeIndex
00890D1C 1038 FE6C                  		move.b	(v_oscillate+$E).w,d0
00890D20 323C 0060                  		move.w	#$60,d1
00890D24 0828 0000 0022             		btst	#0,obStatus(a0)
00890D2A 6700                       		beq.s	loc_FF26
00890D2C 4440                       		neg.w	d0
00890D2E D041                       		add.w	d1,d0
00890D30                            
00890D30                            loc_FF26:
00890D30 3228 0030                  		move.w	origX(a0),d1
00890D34 9240                       		sub.w	d0,d1
00890D36 3141 0008                  		move.w	d1,obX(a0)
00890D3A 4E75                       		rts	
00890D3C                            ; ===========================================================================
00890D3C                            
00890D3C                            MBlock_Type02:				; XREF: MBlock_TypeIndex
00890D3C 0C28 0004 0024             		cmpi.b	#4,obRoutine(a0) ; is Sonic standing on the platform?
00890D42 6600                       		bne.s	MBlock_02_Wait
00890D44 5228 0028                  		addq.b	#1,obSubtype(a0) ; if yes, add 1 to type
00890D48                            
00890D48                            MBlock_02_Wait:
00890D48 4E75                       		rts	
00890D4A                            ; ===========================================================================
00890D4A                            
00890D4A                            MBlock_Type03:				; XREF: MBlock_TypeIndex
00890D4A 7600                       		moveq	#0,d3
00890D4C 1628 0019                  		move.b	obActWid(a0),d3
00890D50 6100 0000                  		bsr.w	ObjHitWallRight
00890D54 4A41                       		tst.w	d1		; has the platform hit a wall?
00890D56 6B00                       		bmi.s	MBlock_03_End	; if yes, branch
00890D58 5268 0008                  		addq.w	#1,obX(a0)	; move platform	to the right
00890D5C 3168 0008 0030             		move.w	obX(a0),origX(a0)
00890D62 4E75                       		rts	
00890D64                            ; ===========================================================================
00890D64                            
00890D64                            MBlock_03_End:
00890D64 4228 0028                  		clr.b	obSubtype(a0)	; change to type 00 (non-moving	type)
00890D68 4E75                       		rts	
00890D6A                            ; ===========================================================================
00890D6A                            
00890D6A                            MBlock_Type05:				; XREF: MBlock_TypeIndex
00890D6A 7600                       		moveq	#0,d3
00890D6C 1628 0019                  		move.b	obActWid(a0),d3
00890D70 6100 0000                  		bsr.w	ObjHitWallRight
00890D74 4A41                       		tst.w	d1		; has the platform hit a wall?
00890D76 6B00                       		bmi.s	MBlock_05_End	; if yes, branch
00890D78 5268 0008                  		addq.w	#1,obX(a0)	; move platform	to the right
00890D7C 3168 0008 0030             		move.w	obX(a0),origX(a0)
00890D82 4E75                       		rts	
00890D84                            ; ===========================================================================
00890D84                            
00890D84                            MBlock_05_End:
00890D84 5228 0028                  		addq.b	#1,obSubtype(a0) ; change to type 06 (falling)
00890D88 4E75                       		rts	
00890D8A                            ; ===========================================================================
00890D8A                            
00890D8A                            MBlock_Type06:				; XREF: MBlock_TypeIndex
00890D8A 6100 D626                  		bsr.w	ObjectMove
00890D8E 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; make the platform fall
00890D94 6100 0000                  		bsr.w	ObjFloorDist
00890D98 4A41                       		tst.w	d1		; has platform hit the floor?
00890D9A 6A00 0000                  		bpl.w	locret_FFA0	; if not, branch
00890D9E D368 000C                  		add.w	d1,obY(a0)
00890DA2 4268 0012                  		clr.w	obVelY(a0)	; stop platform	falling
00890DA6 4228 0028                  		clr.b	obSubtype(a0)	; change to type 00 (non-moving)
00890DAA                            
00890DAA                            locret_FFA0:
00890DAA 4E75                       		rts	
00890DAC                            ; ===========================================================================
00890DAC                            
00890DAC                            MBlock_Type07:				; XREF: MBlock_TypeIndex
00890DAC 4A38 F7E2                  		tst.b	(f_switch+2).w	; has switch number 02 been pressed?
00890DB0 6700                       		beq.s	MBlock_07_ChkDel
00890DB2 5728 0028                  		subq.b	#3,obSubtype(a0) ; if yes, change object type to 04
00890DB6                            
00890DB6                            MBlock_07_ChkDel:
00890DB6 588F                       		addq.l	#4,sp
00890DD6 4E75                       		rts	
00890DD8                            ; ===========================================================================
00890DD8                            
00890DD8                            MBlock_Type08:				; XREF: MBlock_TypeIndex
00890DD8 1038 FE7C                  		move.b	(v_oscillate+$1E).w,d0
00890DDC 323C 0080                  		move.w	#$80,d1
00890DE0 0828 0000 0022             		btst	#0,obStatus(a0)
00890DE6 6700                       		beq.s	loc_FFE2
00890DE8 4440                       		neg.w	d0
00890DEA D041                       		add.w	d1,d0
00890DEC                            
00890DEC                            loc_FFE2:
00890DEC 3228 0032                  		move.w	origY(a0),d1
00890DF0 9240                       		sub.w	d0,d1
00890DF2 3141 000C                  		move.w	d1,obY(a0)
00890DF6 4E75                       		rts	
00890DF8                            ; ===========================================================================
00890DF8                            
00890DF8                            MBlock_Type0A:				; XREF: MBlock_TypeIndex
00890DF8 7600                       		moveq	#0,d3
00890DFA 1628 0019                  		move.b	obActWid(a0),d3
00890DFE D643                       		add.w	d3,d3
00890E00 7208                       		moveq	#8,d1
00890E02 0828 0000 0022             		btst	#0,obStatus(a0)
00890E08 6700                       		beq.s	loc_10004
00890E0A 4441                       		neg.w	d1
00890E0C 4443                       		neg.w	d3
00890E0E                            
00890E0E                            loc_10004:
00890E0E 4A68 0036                  		tst.w	$36(a0)		; is platform set to move back?
00890E12 6600                       		bne.s	MBlock_0A_Back	; if yes, branch
00890E14 3028 0008                  		move.w	obX(a0),d0
00890E18 9068 0030                  		sub.w	origX(a0),d0
00890E1C B043                       		cmp.w	d3,d0
00890E1E 6700                       		beq.s	MBlock_0A_Wait
00890E20 D368 0008                  		add.w	d1,obX(a0)	; move platform
00890E24 317C 012C 0034             		move.w	#300,$34(a0)	; set time delay to 5 seconds
00890E2A 4E75                       		rts	
00890E2C                            ; ===========================================================================
00890E2C                            
00890E2C                            MBlock_0A_Wait:
00890E2C 5368 0034                  		subq.w	#1,$34(a0)	; subtract 1 from time delay
00890E30 6600                       		bne.s	locret_1002E	; if time remains, branch
00890E32 317C 0001 0036             		move.w	#1,$36(a0)	; set platform to move back to its original position
00890E38                            
00890E38                            locret_1002E:
00890E38 4E75                       		rts	
00890E3A                            ; ===========================================================================
00890E3A                            
00890E3A                            MBlock_0A_Back:
00890E3A 3028 0008                  		move.w	obX(a0),d0
00890E3E 9068 0030                  		sub.w	origX(a0),d0
00890E42 6700                       		beq.s	MBlock_0A_Reset
00890E44 9368 0008                  		sub.w	d1,obX(a0)	; return platform to its original position
00890E48 4E75                       		rts	
00890E4A                            ; ===========================================================================
00890E4A                            
00890E4A                            MBlock_0A_Reset:
00890E4A 4268 0036                  		clr.w	$36(a0)
00890E4E 5328 0028                  		subq.b	#1,obSubtype(a0)
00890E52 4E75                       		rts	
00890E52 4E75                       		rts	
00890E54                            		include	"_maps\Moving Blocks (MZ and SBZ).asm"
00890E54                            ; ---------------------------------------------------------------------------
00890E54                            ; Sprite mappings - moving blocks (MZ, SBZ)
00890E54                            ; ---------------------------------------------------------------------------
00890E54 0000 0000                  Map_MBlock:	dc.w @mz1-Map_MBlock, @mz2-Map_MBlock
00890E58 0000 0000                  		dc.w @sbz-Map_MBlock, @sbzwide-Map_MBlock
00890E5C 0000                       		dc.w @mz3-Map_MBlock
00890E5E 01                         @mz1:		dc.b 1
00890E5F F80F 0008 F0               		dc.b $F8, $F, 0, 8, $F0
00890E64 02                         @mz2:		dc.b 2
00890E65 F80F 0008 E0               		dc.b $F8, $F, 0, 8, $E0
00890E6A F80F 0008 00               		dc.b $F8, $F, 0, 8, 0
00890E6F 04                         @sbz:		dc.b 4
00890E70 F80C 2000 E0               		dc.b $F8, $C, $20, 0, $E0
00890E75 000D 0004 E0               		dc.b 0,	$D, 0, 4, $E0
00890E7A F80C 2000 00               		dc.b $F8, $C, $20, 0, 0
00890E7F 000D 0004 00               		dc.b 0,	$D, 0, 4, 0
00890E84 04                         @sbzwide:	dc.b 4
00890E85 F80E 0000 C0               		dc.b $F8, $E, 0, 0, $C0
00890E8A F80E 0003 E0               		dc.b $F8, $E, 0, 3, $E0
00890E8F F80E 0003 00               		dc.b $F8, $E, 0, 3, 0
00890E94 F80E 0800 20               		dc.b $F8, $E, 8, 0, $20
00890E99 03                         @mz3:		dc.b 3
00890E9A F80F 0008 D0               		dc.b $F8, $F, 0, 8, $D0
00890E9F F80F 0008 F0               		dc.b $F8, $F, 0, 8, $F0
00890EA4 F80F 0008 10               		dc.b $F8, $F, 0, 8, $10
00890EAA 00                         		even
00890EAA 00                         		even
00890EAA                            		include	"_maps\Moving Blocks (LZ).asm"
00890EAA                            ; ---------------------------------------------------------------------------
00890EAA                            ; Sprite mappings - moving block (LZ)
00890EAA                            ; ---------------------------------------------------------------------------
00890EAA 0000                       Map_MBlockLZ:	dc.w @0-Map_MBlockLZ
00890EAC 01                         @0:		dc.b 1
00890EAD F80D 0000 F0               		dc.b $F8, $D, 0, 0, $F0
00890EB2                            		even
00890EB2                            		even
00890EB2                            
00890EB2                            		include	"_incObj\55 Basaran.asm"
00890EB2                            ; ---------------------------------------------------------------------------
00890EB2                            ; Object 55 - Basaran enemy (MZ)
00890EB2                            ; ---------------------------------------------------------------------------
00890EB2                            
00890EB2                            Basaran:				; XREF: Obj_Index
00890EB2 7000                       		moveq	#0,d0
00890EB4 1028 0024                  		move.b	obRoutine(a0),d0
00890EB8 323B 0000                  		move.w	Bas_Index(pc,d0.w),d1
00890EBC 4EFB 1000                  		jmp	Bas_Index(pc,d1.w)
00890EC0                            ; ===========================================================================
00890EC0 0000                       Bas_Index:	dc.w Bas_Main-Bas_Index
00890EC2 0000                       		dc.w Bas_Action-Bas_Index
00890EC4                            ; ===========================================================================
00890EC4                            
00890EC4                            Bas_Main:	; Routine 0
00890EC4 5428 0024                  		addq.b	#2,obRoutine(a0)
00890EC8 217C 0000 0000 0004        		move.l	#Map_Bas,obMap(a0)
00890ED0 317C 84B8 0002             		move.w	#$84B8,obGfx(a0)
00890ED6 117C 0004 0001             		move.b	#4,obRender(a0)
00890EDC 117C 000C 0016             		move.b	#$C,obHeight(a0)
00890EE2 117C 0002 0018             		move.b	#2,obPriority(a0)
00890EE8 117C 000B 0020             		move.b	#$B,obColType(a0)
00890EEE 117C 0010 0019             		move.b	#$10,obActWid(a0)
00890EF4                            
00890EF4                            Bas_Action:	; Routine 2
00890EF4 7000                       		moveq	#0,d0
00890EF6 1028 0025                  		move.b	ob2ndRout(a0),d0
00890EFA 323B 0000                  		move.w	@index(pc,d0.w),d1
00890EFE 4EBB 1000                  		jsr	@index(pc,d1.w)
00890F02 43F9 0000 0000             		lea	(Ani_Bas).l,a1
00890F08 6100 A5A6                  		bsr.w	AnimateSprite
00890F0C 6000 F57E                  		bra.w	RememberState
00890F10                            ; ===========================================================================
00890F10 0000                       @index:		dc.w @dropcheck-@index
00890F12 0000                       		dc.w @dropfly-@index
00890F14 0000                       		dc.w @flapsound-@index
00890F16 0000                       		dc.w @flyup-@index
00890F18                            ; ===========================================================================
00890F18                            
00890F18                            @dropcheck:				; XREF: @index
00890F18 343C 0080                  		move.w	#$80,d2
00890F1C 6100 0000                  		bsr.w	@chkdistance	; is Sonic < $80 pixels from basaran?
00890F20 6400                       		bcc.s	@nodrop		; if not, branch
00890F22 3038 D00C                  		move.w	(v_player+obY).w,d0
00890F26 3140 0036                  		move.w	d0,$36(a0)
00890F2A 9068 000C                  		sub.w	obY(a0),d0
00890F2E 6500                       		bcs.s	@nodrop
00890F30 0C40 0080                  		cmpi.w	#$80,d0		; is Sonic < $80 pixels from basaran?
00890F34 6400                       		bcc.s	@nodrop		; if not, branch
00890F36 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	on?
00890F3A 6600                       		bne.s	@nodrop		; if yes, branch
00890F3C                            
00890F3C 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
00890F40 D007                       		add.b	d7,d0
00890F42 0200 0007                  		andi.b	#7,d0
00890F46 6600                       		bne.s	@nodrop
00890F48 117C 0001 001C             		move.b	#1,obAnim(a0)
00890F4E 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00890F52                            
00890F52                            	@nodrop:
00890F52 4E75                       		rts	
00890F54                            ; ===========================================================================
00890F54                            
00890F54                            @dropfly:				; XREF: @index
00890F54 6100 D45C                  		bsr.w	ObjectMove
00890F58 0668 0018 0012             		addi.w	#$18,obVelY(a0)	; make basaran fall
00890F5E 343C 0080                  		move.w	#$80,d2
00890F62 6100 0000                  		bsr.w	@chkdistance
00890F66 3028 0036                  		move.w	$36(a0),d0
00890F6A 9068 000C                  		sub.w	obY(a0),d0
00890F6E 6500                       		bcs.s	@chkdel
00890F70 0C40 0010                  		cmpi.w	#$10,d0		; is basaran close to Sonic vertically?
00890F74 6400                       		bcc.s	@dropmore	; if not, branch
00890F76 3141 0010                  		move.w	d1,obVelX(a0)	; make basaran fly horizontally
00890F7A 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop basaran falling
00890F80 117C 0002 001C             		move.b	#2,obAnim(a0)
00890F86 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00890F8A                            
00890F8A                            	@dropmore:
00890F8A 4E75                       		rts	
00890F8C                            
00890F8C                            	@chkdel:
00890F8C 4A28 0001                  		tst.b	obRender(a0)
00890F90 6A00 D476                  		bpl.w	DeleteObject
00890F94 4E75                       		rts	
00890F96                            ; ===========================================================================
00890F96                            
00890F96                            @flapsound:				; XREF: @index
00890F96 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
00890F9A 0200 000F                  		andi.b	#$F,d0
00890F9E 6600                       		bne.s	@nosound
00890FAA                            
00890FAA                            	@nosound:
00890FAA 6100 D406                  		bsr.w	ObjectMove
00890FAE 3038 D008                  		move.w	(v_player+obX).w,d0
00890FB2 9068 0008                  		sub.w	obX(a0),d0
00890FB6 6400                       		bcc.s	@isright	; if Sonic is right of basaran, branch
00890FB8 4440                       		neg.w	d0
00890FBA                            
00890FBA                            	@isright:
00890FBA 0C40 0080                  		cmpi.w	#$80,d0		; is Sonic within $80 pixels of basaran?
00890FBE 6500                       		bcs.s	@dontflyup	; if yes, branch
00890FC0 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
00890FC4 D007                       		add.b	d7,d0
00890FC6 0200 0007                  		andi.b	#7,d0
00890FCA 6600                       		bne.s	@dontflyup
00890FCC 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00890FD0                            
00890FD0                            @dontflyup:
00890FD0 4E75                       		rts	
00890FD2                            ; ===========================================================================
00890FD2                            
00890FD2                            @flyup:					; XREF: @index
00890FD2 6100 D3DE                  		bsr.w	ObjectMove
00890FD6 0468 0018 0012             		subi.w	#$18,obVelY(a0)	; make basaran fly upwards
00890FDC 6100 0000                  		bsr.w	ObjHitCeiling
00890FE0 4A41                       		tst.w	d1		; has basaran hit the ceiling?
00890FE2 6A00                       		bpl.s	@noceiling	; if not, branch
00890FE4 9368 000C                  		sub.w	d1,obY(a0)
00890FE8 0268 FFF8 0008             		andi.w	#$FFF8,obX(a0)
00890FEE 4268 0010                  		clr.w	obVelX(a0)	; stop basaran moving
00890FF2 4268 0012                  		clr.w	obVelY(a0)
00890FF6 4228 001C                  		clr.b	obAnim(a0)
00890FFA 4228 0025                  		clr.b	ob2ndRout(a0)
00890FFE                            
00890FFE                            	@noceiling:
00890FFE 4E75                       		rts	
00891000                            ; ===========================================================================
00891000                            
00891000                            ; Subroutine to check Sonic's distance from the basaran
00891000                            
00891000                            ; input:
00891000                            ;	d2 = distance to compare
00891000                            
00891000                            ; output:
00891000                            ;	d0 = distance between Sonic and basaran
00891000                            ;	d1 = speed/direction for basaran to fly
00891000                            
00891000                            @chkdistance:
00891000 323C 0100                  		move.w	#$100,d1
00891004 08E8 0000 0022             		bset	#0,obStatus(a0)
0089100A 3038 D008                  		move.w	(v_player+obX).w,d0
0089100E 9068 0008                  		sub.w	obX(a0),d0
00891012 6400                       		bcc.s	@right		; if Sonic is right of basaran, branch
00891014 4440                       		neg.w	d0
00891016 4441                       		neg.w	d1
00891018 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089101E                            
0089101E                            	@right:
0089101E B042                       		cmp.w	d2,d0
00891020 4E75                       		rts	
00891022                            ; ===========================================================================
00891022                            ; unused crap
00891022 6100 D38E                  		bsr.w	ObjectMove
00891026 6100 D3A4                  		bsr.w	DisplaySprite
0089102A 4A28 0001                  		tst.b	obRender(a0)
0089102E 6A00 D3D8                  		bpl.w	DeleteObject
00891032 4E75                       		rts	
00891032 4E75                       		rts	
00891034                            		include	"_anim\Basaran.asm"
00891034                            ; ---------------------------------------------------------------------------
00891034                            ; Animation script - Basaran enemy
00891034                            ; ---------------------------------------------------------------------------
00891034 0000                       Ani_Bas:	dc.w @still-Ani_Bas
00891036 0000                       		dc.w @fall-Ani_Bas
00891038 0000                       		dc.w @fly-Ani_Bas
0089103A 0F00 FF                    @still:		dc.b $F, 0, afEnd
0089103E 00                         		even
0089103E 0F01 FF                    @fall:		dc.b $F, 1, afEnd
00891042 00                         		even
00891042 0301 0203 02FF             @fly:		dc.b 3,	1, 2, 3, 2, afEnd
00891048                            		even
00891048                            		even
00891048                            		include	"_maps\Basaran.asm"
00891048                            ; ---------------------------------------------------------------------------
00891048                            ; Sprite mappings - Basaran enemy (MZ)
00891048                            ; ---------------------------------------------------------------------------
00891048 0000 0000                  Map_Bas:	dc.w @still-Map_Bas, @fly1-Map_Bas
0089104C 0000 0000                  		dc.w @fly2-Map_Bas, @fly3-Map_Bas
00891050 01                         @still:		dc.b 1
00891051 F406 0000 F8               		dc.b $F4, 6, 0,	0, $F8
00891056 03                         @fly1:		dc.b 3
00891057 F20E 0006 F4               		dc.b $F2, $E, 0, 6, $F4
0089105C 0A04 0012 FC               		dc.b $A, 4, 0, $12, $FC
00891061 0200 0027 0C               		dc.b 2,	0, 0, $27, $C
00891066 04                         @fly2:		dc.b 4
00891067 F804 0014 F8               		dc.b $F8, 4, 0,	$14, $F8
0089106C 000C 0016 F0               		dc.b 0,	$C, 0, $16, $F0
00891071 0804 001A 00               		dc.b 8,	4, 0, $1A, 0
00891076 0000 0028 0C               		dc.b 0,	0, 0, $28, $C
0089107B 04                         @fly3:		dc.b 4
0089107C F609 001C F5               		dc.b $F6, 9, 0,	$1C, $F5
00891081 0608 0022 F4               		dc.b 6,	8, 0, $22, $F4
00891086 0E04 0025 F4               		dc.b $E, 4, 0, $25, $F4
0089108B FE00 0027 0C               		dc.b $FE, 0, 0,	$27, $C
00891090                            		even
00891090                            		even
00891090                            
00891090                            		include	"_incObj\56 Floating Blocks and Doors.asm"
00891090                            ; ---------------------------------------------------------------------------
00891090                            ; Object 56 - floating blocks (SYZ/SLZ), large doors (LZ)
00891090                            ; ---------------------------------------------------------------------------
00891090                            
00891090                            FloatingBlock:				; XREF: Obj_Index
00891090 7000                       		moveq	#0,d0
00891092 1028 0024                  		move.b	obRoutine(a0),d0
00891096 323B 0000                  		move.w	FBlock_Index(pc,d0.w),d1
0089109A 4EFB 1000                  		jmp	FBlock_Index(pc,d1.w)
0089109E                            ; ===========================================================================
0089109E 0000                       FBlock_Index:	dc.w FBlock_Main-FBlock_Index
008910A0 0000                       		dc.w FBlock_Action-FBlock_Index
008910A2                            
008910A2 =00000034                  fb_origX:	= $34		; original x-axis position
008910A2 =00000030                  fb_origY:	= $30		; original y-axis position
008910A2 =0000003A                  fb_height:	= $3A		; total object height
008910A2 =0000003C                  fb_type:	= $3C		; subtype (2nd digit only)
008910A2                            
008910A2                            FBlock_Var:	; width/2, height/2
008910A2 1010                       		dc.b  $10, $10	; subtype 0x/8x
008910A4 2020                       		dc.b  $20, $20	; subtype 1x/9x
008910A6 1020                       		dc.b  $10, $20	; subtype 2x/Ax
008910A8 201A                       		dc.b  $20, $1A	; subtype 3x/Bx
008910AA 1027                       		dc.b  $10, $27	; subtype 4x/Cx
008910AC 1010                       		dc.b  $10, $10	; subtype 5x/Dx
008910AE 0820                       		dc.b	8, $20	; subtype 6x/Ex
008910B0 4010                       		dc.b  $40, $10	; subtype 7x/Fx
008910B2                            ; ===========================================================================
008910B2                            
008910B2                            FBlock_Main:	; Routine 0
008910B2 5428 0024                  		addq.b	#2,obRoutine(a0)
008910B6 217C 0000 0000 0004        		move.l	#Map_FBlock,obMap(a0)
008910BE 317C 4000 0002             		move.w	#$4000,obGfx(a0)
008910C4 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
008910CA 6600                       		bne.s	@notLZ
008910CC 317C 43C4 0002             		move.w	#$43C4,obGfx(a0) ; LZ specific code
008910D2                            
008910D2                            	@notLZ:
008910D2 117C 0004 0001             		move.b	#4,obRender(a0)
008910D8 117C 0003 0018             		move.b	#3,obPriority(a0)
008910DE 7000                       		moveq	#0,d0
008910E0 1028 0028                  		move.b	obSubtype(a0),d0 ; get subtype
008910E4 E648                       		lsr.w	#3,d0
008910E6 0240 000E                  		andi.w	#$E,d0		; read only the 1st digit
008910EA 45FB 00B6                  		lea	FBlock_Var(pc,d0.w),a2 ; get size data
008910EE 115A 0019                  		move.b	(a2)+,obActWid(a0)
008910F2 1152 0016                  		move.b	(a2),obHeight(a0)
008910F6 E248                       		lsr.w	#1,d0
008910F8 1140 001A                  		move.b	d0,obFrame(a0)
008910FC 3168 0008 0034             		move.w	obX(a0),fb_origX(a0)
00891102 3168 000C 0030             		move.w	obY(a0),fb_origY(a0)
00891108 7000                       		moveq	#0,d0
0089110A 1012                       		move.b	(a2),d0
0089110C D040                       		add.w	d0,d0
0089110E 3140 003A                  		move.w	d0,fb_height(a0)
00891112                            
00891112 0C28 0037 0028             		cmpi.b	#$37,obSubtype(a0)
00891118 6600                       		bne.s	@dontdelete
0089111A 0C68 1BB8 0008             		cmpi.w	#$1BB8,obX(a0)
00891120 6600                       		bne.s	@notatpos
00891122 4A38 F7CE                  		tst.b	($FFFFF7CE).w
00891126 6700                       		beq.s	@dontdelete
00891128 4EF9 0088 E408             		jmp	DeleteObject
0089112E                            @notatpos:
0089112E 4228 0028                  		clr.b	obSubtype(a0)
00891132 4A38 F7CE                  		tst.b	($FFFFF7CE).w
00891136 6600                       		bne.s	@dontdelete
00891138 4EF9 0088 E408             		jmp	DeleteObject
0089113E                            @dontdelete:
0089113E                            
0089113E 7000                       		moveq	#0,d0
00891140 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
00891146 6700                       		beq.s	@stillnotLZ
00891148 1028 0028                  		move.b	obSubtype(a0),d0 ; SYZ/SLZ specific code
0089114C 0240 000F                  		andi.w	#$F,d0
00891150 5140                       		subq.w	#8,d0
00891152 6500                       		bcs.s	@stillnotLZ
00891154 E548                       		lsl.w	#2,d0
00891156 45F8 FE8A                  		lea	(v_oscillate+$2C).w,a2
0089115A 45F2 0000                  		lea	(a2,d0.w),a2
0089115E 4A52                       		tst.w	(a2)
00891160 6A00                       		bpl.s	@stillnotLZ
00891162 0868 0000 0022             		bchg	#0,obStatus(a0)
00891168                            
00891168                            	@stillnotLZ:
00891168 1028 0028                  		move.b	obSubtype(a0),d0
0089116C 6A00                       		bpl.s	FBlock_Action
0089116E 0200 000F                  		andi.b	#$F,d0
00891172 1140 003C                  		move.b	d0,fb_type(a0)
00891176 117C 0005 0028             		move.b	#5,obSubtype(a0)
0089117C 0C28 0007 001A             		cmpi.b	#7,obFrame(a0)
00891182 6600                       		bne.s	@chkstate
00891184 117C 000C 0028             		move.b	#$C,obSubtype(a0)
0089118A 317C 0080 003A             		move.w	#$80,fb_height(a0)
00891190                            
00891190                            @chkstate:
00891190 45F8 FC00                  		lea	(v_objstate).w,a2
00891194 7000                       		moveq	#0,d0
00891196 1028 0023                  		move.b	obRespawnNo(a0),d0
0089119A 6700                       		beq.s	FBlock_Action
0089119C 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
008911A2 0832 0000 0002             		btst	#0,2(a2,d0.w)
008911A8 6700                       		beq.s	FBlock_Action
008911AA 5228 0028                  		addq.b	#1,obSubtype(a0)
008911AE 4268 003A                  		clr.w	fb_height(a0)
008911B2                            
008911B2                            FBlock_Action:	; Routine 2
008911B2 3F28 0008                  		move.w	obX(a0),-(sp)
008911B6 7000                       		moveq	#0,d0
008911B8 1028 0028                  		move.b	obSubtype(a0),d0 ; get object subtype
008911BC 0240 000F                  		andi.w	#$F,d0		; read only the	2nd digit
008911C0 D040                       		add.w	d0,d0
008911C2 323B 0000                  		move.w	@index(pc,d0.w),d1
008911C6 4EBB 1000                  		jsr	@index(pc,d1.w)	; move block subroutines
008911CA 381F                       		move.w	(sp)+,d4
008911CC 4A28 0001                  		tst.b	obRender(a0)
008911D0 6A00                       		bpl.s	@chkdel
008911D2 7200                       		moveq	#0,d1
008911D4 1228 0019                  		move.b	obActWid(a0),d1
008911D8 0641 000B                  		addi.w	#$B,d1
008911DC 7400                       		moveq	#0,d2
008911DE 1428 0016                  		move.b	obHeight(a0),d2
008911E2 3602                       		move.w	d2,d3
008911E4 5243                       		addq.w	#1,d3
008911E6 6100 F5CE                  		bsr.w	SolidObject
008911EA                            
008911EA                            	@chkdel:
00891206                            	@display:                
00891206 6000 D1C4                  		bra	DisplaySprite
0089120A                            	@chkdel2:
0089120A 0C28 0037 0028             		cmpi.b	#$37,obSubtype(a0)
00891210 6600                       		bne.s	@delete
00891212 4A28 0038                  		tst.b	$38(a0)
00891216 66EE                       		bne.s	@display
00891218                            	@delete:
00891218 4EF9 0088 E408             		jmp     DeleteObject
0089121E                            
0089121E                            ; ===========================================================================
0089121E 0000 0000                  @index:		dc.w @type00-@index, @type01-@index
00891222 0000 0000                  		dc.w @type02-@index, @type03-@index
00891226 0000 0000                  		dc.w @type04-@index, @type05-@index
0089122A 0000 0000                  		dc.w @type06-@index, @type07-@index
0089122E 0000 0000                  		dc.w @type08-@index, @type09-@index
00891232 0000 0000                  		dc.w @type0A-@index, @type0B-@index
00891236 0000 0000                  		dc.w @type0C-@index, @type0D-@index
0089123A                            ; ===========================================================================
0089123A                            
0089123A                            @type00:				; XREF: @index
0089123A                            ; doesn't move
0089123A 4E75                       		rts	
0089123C                            ; ===========================================================================
0089123C                            
0089123C                            @type01:				; XREF: @index
0089123C                            ; moves side-to-side
0089123C 323C 0040                  		move.w	#$40,d1		; set move distance
00891240 7000                       		moveq	#0,d0
00891242 1038 FE68                  		move.b	(v_oscillate+$A).w,d0
00891246 6000                       		bra.s	@moveLR
00891248                            ; ===========================================================================
00891248                            
00891248                            @type02:				; XREF: @index
00891248                            ; moves side-to-side
00891248 323C 0080                  		move.w	#$80,d1		; set move distance
0089124C 7000                       		moveq	#0,d0
0089124E 1038 FE7C                  		move.b	(v_oscillate+$1E).w,d0
00891252                            
00891252                            	@moveLR:
00891252 0828 0000 0022             		btst	#0,obStatus(a0)
00891258 6700                       		beq.s	@noflip
0089125A 4440                       		neg.w	d0
0089125C D041                       		add.w	d1,d0
0089125E                            
0089125E                            	@noflip:
0089125E 3228 0034                  		move.w	fb_origX(a0),d1
00891262 9240                       		sub.w	d0,d1
00891264 3141 0008                  		move.w	d1,obX(a0)	; move object horizontally
00891268 4E75                       		rts	
0089126A                            ; ===========================================================================
0089126A                            
0089126A                            @type03:				; XREF: @index
0089126A                            ; moves up/down
0089126A 323C 0040                  		move.w	#$40,d1		; set move distance
0089126E 7000                       		moveq	#0,d0
00891270 1038 FE68                  		move.b	(v_oscillate+$A).w,d0
00891274 6000                       		bra.s	@moveUD
00891276                            ; ===========================================================================
00891276                            
00891276                            @type04:				; XREF: @index
00891276                            ; moves up/down
00891276 323C 0080                  		move.w	#$80,d1		; set move distance
0089127A 7000                       		moveq	#0,d0
0089127C 1038 FE7C                  		move.b	(v_oscillate+$1E).w,d0
00891280                            
00891280                            	@moveUD:
00891280 0828 0000 0022             		btst	#0,obStatus(a0)
00891286 6700                       		beq.s	@noflip04
00891288 4440                       		neg.w	d0
0089128A D041                       		add.w	d1,d0
0089128C                            
0089128C                            	@noflip04:
0089128C 3228 0030                  		move.w	fb_origY(a0),d1
00891290 9240                       		sub.w	d0,d1
00891292 3141 000C                  		move.w	d1,obY(a0)	; move object vertically
00891296 4E75                       		rts	
00891298                            ; ===========================================================================
00891298                            
00891298                            @type05:				; XREF: @index
00891298                            ; moves up when a switch is pressed
00891298 4A28 0038                  		tst.b	$38(a0)
0089129C 6600                       		bne.s	@loc_104A4
0089129E 0C78 0100 FE10             		cmpi.w	#(id_LZ<<8)+0,(v_zone).w ; is level LZ1 ?
008912A4 6600                       		bne.s	@aaa		; if not, branch
008912A6 0C28 0003 003C             		cmpi.b	#3,fb_type(a0)
008912AC 6600                       		bne.s	@aaa
008912AE 4238 F7C9                  		clr.b	(f_wtunnelallow).w
008912B2 3038 D008                  		move.w	(v_player+obX).w,d0
008912B6 B068 0008                  		cmp.w	obX(a0),d0
008912BA 6400                       		bcc.s	@aaa
008912BC 11FC 0001 F7C9             		move.b	#1,(f_wtunnelallow).w
008912C2                            
008912C2                            	@aaa:
008912C2 45F8 F7E0                  		lea	(f_switch).w,a2
008912C6 7000                       		moveq	#0,d0
008912C8 1028 003C                  		move.b	fb_type(a0),d0
008912CC 0832 0000 0000             		btst	#0,(a2,d0.w)
008912D2 6700                       		beq.s	@loc_104AE
008912D4 0C78 0100 FE10             		cmpi.w	#(id_LZ<<8)+0,(v_zone).w ; is level LZ1 ?
008912DA 6600                       		bne.s	@loc_1049E	; if not, branch
008912DC 0C00 0003                  		cmpi.b	#3,d0
008912E0 6600                       		bne.s	@loc_1049E
008912E2 4238 F7C9                  		clr.b	(f_wtunnelallow).w
008912E6                            
008912E6                            @loc_1049E:
008912E6 117C 0001 0038             		move.b	#1,$38(a0)
008912EC                            
008912EC                            @loc_104A4:
008912EC 4A68 003A                  		tst.w	fb_height(a0)
008912F0 6700                       		beq.s	@loc_104C8
008912F2 5568 003A                  		subq.w	#2,fb_height(a0)
008912F6                            
008912F6                            @loc_104AE:
008912F6 3028 003A                  		move.w	fb_height(a0),d0
008912FA 0828 0000 0022             		btst	#0,$22(a0)
00891300 6700                       		beq.s	@loc_104BC
00891302 4440                       		neg.w	d0
00891304                            
00891304                            @loc_104BC:
00891304 3228 0030                  		move.w	fb_origY(a0),d1
00891308 D240                       		add.w	d0,d1
0089130A 3141 000C                  		move.w	d1,obY(a0)
0089130E 4E75                       		rts	
00891310                            ; ===========================================================================
00891310                            
00891310                            @loc_104C8:
00891310 5228 0028                  		addq.b	#1,$28(a0)
00891314 4228 0038                  		clr.b	$38(a0)
00891318 45F8 FC00                  		lea	(v_objstate).w,a2
0089131C 7000                       		moveq	#0,d0
0089131E 1028 0023                  		move.b	obRespawnNo(a0),d0
00891322 67D2                       		beq.s	@loc_104AE
00891324 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0089132A 60CA                       		bra.s	@loc_104AE
0089132C                            ; ===========================================================================
0089132C                            
0089132C                            @type06:				; XREF: @index
0089132C 4A28 0038                  		tst.b	$38(a0)
00891330 6600                       		bne.s	@loc_10500
00891332 45F8 F7E0                  		lea	(f_switch).w,a2
00891336 7000                       		moveq	#0,d0
00891338 1028 003C                  		move.b	fb_type(a0),d0
0089133C 4A32 0000                  		tst.b	(a2,d0.w)
00891340 6A00                       		bpl.s	@loc_10512
00891342 117C 0001 0038             		move.b	#1,$38(a0)
00891348                            
00891348                            @loc_10500:
00891348 7000                       		moveq	#0,d0
0089134A 1028 0016                  		move.b	obHeight(a0),d0
0089134E D040                       		add.w	d0,d0
00891350 B068 003A                  		cmp.w	fb_height(a0),d0
00891354 6700                       		beq.s	@loc_1052C
00891356 5468 003A                  		addq.w	#2,fb_height(a0)
0089135A                            
0089135A                            @loc_10512:
0089135A 3028 003A                  		move.w	fb_height(a0),d0
0089135E 0828 0000 0022             		btst	#0,obStatus(a0)
00891364 6700                       		beq.s	@loc_10520
00891366 4440                       		neg.w	d0
00891368                            
00891368                            @loc_10520:
00891368 3228 0030                  		move.w	fb_origY(a0),d1
0089136C D240                       		add.w	d0,d1
0089136E 3141 000C                  		move.w	d1,obY(a0)
00891372 4E75                       		rts	
00891374                            ; ===========================================================================
00891374                            
00891374                            @loc_1052C:
00891374 5328 0028                  		subq.b	#1,obSubtype(a0)
00891378 4228 0038                  		clr.b	$38(a0)
0089137C 45F8 FC00                  		lea	(v_objstate).w,a2
00891380 7000                       		moveq	#0,d0
00891382 1028 0023                  		move.b	obRespawnNo(a0),d0
00891386 67D2                       		beq.s	@loc_10512
00891388 08B2 0000 0002             		bclr	#0,2(a2,d0.w)
0089138E 60CA                       		bra.s	@loc_10512
00891390                            ; ===========================================================================
00891390                            
00891390                            @type07:				; XREF: @index
00891390 4A28 0038                  		tst.b	$38(a0)
00891394 6600                       		bne.s	@loc_1055E
00891396 4A38 F7EF                  		tst.b	(f_switch+$F).w	; has switch number $F been pressed?
0089139A 6700                       		beq.s	@locret_10578
0089139C 117C 0001 0038             		move.b	#1,$38(a0)
008913A2 4268 003A                  		clr.w	fb_height(a0)
008913A6                            
008913A6                            @loc_1055E:
008913A6 5268 0008                  		addq.w	#1,obX(a0)
008913AA 3168 0008 0034             		move.w	obX(a0),fb_origX(a0)
008913B0 5268 003A                  		addq.w	#1,fb_height(a0)
008913B4 0C68 0380 003A             		cmpi.w	#$380,fb_height(a0)
008913BA 6600                       		bne.s	@locret_10578
008913BC                            
008913BC 11FC 0001 F7CE             		move.b	#1,($FFFFF7CE).w
008913C2 4228 0038                  		clr.b	$38(a0)
008913C6                            
008913C6 4228 0028                  		clr.b	obSubtype(a0)
008913CA                            
008913CA                            @locret_10578:
008913CA 4E75                       		rts	
008913CC                            ; ===========================================================================
008913CC                            
008913CC                            @type0C:				; XREF: @index
008913CC 4A28 0038                  		tst.b	$38(a0)
008913D0 6600                       		bne.s	@loc_10598
008913D2 45F8 F7E0                  		lea	(f_switch).w,a2
008913D6 7000                       		moveq	#0,d0
008913D8 1028 003C                  		move.b	fb_type(a0),d0
008913DC 0832 0000 0000             		btst	#0,(a2,d0.w)
008913E2 6700                       		beq.s	@loc_105A2
008913E4 117C 0001 0038             		move.b	#1,$38(a0)
008913EA                            
008913EA                            @loc_10598:
008913EA 4A68 003A                  		tst.w	fb_height(a0)
008913EE 6700                       		beq.s	@loc_105C0
008913F0 5568 003A                  		subq.w	#2,fb_height(a0)
008913F4                            
008913F4                            @loc_105A2:
008913F4 3028 003A                  		move.w	fb_height(a0),d0
008913F8 0828 0000 0022             		btst	#0,obStatus(a0)
008913FE 6700                       		beq.s	@loc_105B4
00891400 4440                       		neg.w	d0
00891402 0640 0080                  		addi.w	#$80,d0
00891406                            
00891406                            @loc_105B4:
00891406 3228 0034                  		move.w	fb_origX(a0),d1
0089140A D240                       		add.w	d0,d1
0089140C 3141 0008                  		move.w	d1,obX(a0)
00891410 4E75                       		rts	
00891412                            ; ===========================================================================
00891412                            
00891412                            @loc_105C0:
00891412 5228 0028                  		addq.b	#1,obSubtype(a0)
00891416 4228 0038                  		clr.b	$38(a0)
0089141A 45F8 FC00                  		lea	(v_objstate).w,a2
0089141E 7000                       		moveq	#0,d0
00891420 1028 0023                  		move.b	obRespawnNo(a0),d0
00891424 67CE                       		beq.s	@loc_105A2
00891426 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0089142C 60C6                       		bra.s	@loc_105A2
0089142E                            ; ===========================================================================
0089142E                            
0089142E                            @type0D:				; XREF: @index
0089142E 4A28 0038                  		tst.b	$38(a0)
00891432 6600                       		bne.s	@loc_105F8
00891434 45F8 F7E0                  		lea	(f_switch).w,a2
00891438 7000                       		moveq	#0,d0
0089143A 1028 003C                  		move.b	fb_type(a0),d0
0089143E 4A32 0000                  		tst.b	(a2,d0.w)
00891442 6A00                       		bpl.s	@wtf
00891444 117C 0001 0038             		move.b	#1,$38(a0)
0089144A                            
0089144A                            @loc_105F8:
0089144A 303C 0080                  		move.w	#$80,d0
0089144E B068 003A                  		cmp.w	fb_height(a0),d0
00891452 6700                       		beq.s	@loc_10624
00891454 5468 003A                  		addq.w	#2,fb_height(a0)
00891458                            
00891458                            @wtf:
00891458 3028 003A                  		move.w	fb_height(a0),d0
0089145C 0828 0000 0022             		btst	#0,obStatus(a0)
00891462 6700                       		beq.s	@loc_10618
00891464 4440                       		neg.w	d0
00891466 0640 0080                  		addi.w	#$80,d0
0089146A                            
0089146A                            @loc_10618:
0089146A 3228 0034                  		move.w	fb_origX(a0),d1
0089146E D240                       		add.w	d0,d1
00891470 3141 0008                  		move.w	d1,obX(a0)
00891474 4E75                       		rts	
00891476                            ; ===========================================================================
00891476                            
00891476                            @loc_10624:
00891476 5328 0028                  		subq.b	#1,obSubtype(a0)
0089147A 4228 0038                  		clr.b	$38(a0)
0089147E 45F8 FC00                  		lea	(v_objstate).w,a2
00891482 7000                       		moveq	#0,d0
00891484 1028 0023                  		move.b	obRespawnNo(a0),d0
00891488 67CE                       		beq.s	@wtf
0089148A 08B2 0000 0002             		bclr	#0,2(a2,d0.w)
00891490 60C6                       		bra.s	@wtf
00891492                            ; ===========================================================================
00891492                            
00891492                            @type08:				; XREF: @index
00891492 323C 0010                  		move.w	#$10,d1
00891496 7000                       		moveq	#0,d0
00891498 1038 FE88                  		move.b	(v_oscillate+$2A).w,d0
0089149C E248                       		lsr.w	#1,d0
0089149E 3638 FE8A                  		move.w	(v_oscillate+$2C).w,d3
008914A2 6000                       		bra.s	@square
008914A4                            ; ===========================================================================
008914A4                            
008914A4                            @type09:				; XREF: @index
008914A4 323C 0030                  		move.w	#$30,d1
008914A8 7000                       		moveq	#0,d0
008914AA 1038 FE8C                  		move.b	(v_oscillate+$2E).w,d0
008914AE 3638 FE8E                  		move.w	(v_oscillate+$30).w,d3
008914B2 6000                       		bra.s	@square
008914B4                            ; ===========================================================================
008914B4                            
008914B4                            @type0A:				; XREF: @index
008914B4 323C 0050                  		move.w	#$50,d1
008914B8 7000                       		moveq	#0,d0
008914BA 1038 FE90                  		move.b	(v_oscillate+$32).w,d0
008914BE 3638 FE92                  		move.w	(v_oscillate+$34).w,d3
008914C2 6000                       		bra.s	@square
008914C4                            ; ===========================================================================
008914C4                            
008914C4                            @type0B:				; XREF: @index
008914C4 323C 0070                  		move.w	#$70,d1
008914C8 7000                       		moveq	#0,d0
008914CA 1038 FE94                  		move.b	(v_oscillate+$36).w,d0
008914CE 3638 FE96                  		move.w	(v_oscillate+$38).w,d3
008914D2                            
008914D2                            @square:
008914D2 4A43                       		tst.w	d3
008914D4 6600                       		bne.s	@loc_1068E
008914D6 5228 0022                  		addq.b	#1,obStatus(a0)
008914DA 0228 0003 0022             		andi.b	#3,obStatus(a0)
008914E0                            
008914E0                            @loc_1068E:
008914E0 1428 0022                  		move.b	obStatus(a0),d2
008914E4 0202 0003                  		andi.b	#3,d2
008914E8 6600                       		bne.s	@loc_106AE
008914EA 9041                       		sub.w	d1,d0
008914EC D068 0034                  		add.w	fb_origX(a0),d0
008914F0 3140 0008                  		move.w	d0,obX(a0)
008914F4 4441                       		neg.w	d1
008914F6 D268 0030                  		add.w	fb_origY(a0),d1
008914FA 3141 000C                  		move.w	d1,obY(a0)
008914FE 4E75                       		rts	
00891500                            ; ===========================================================================
00891500                            
00891500                            @loc_106AE:
00891500 5302                       		subq.b	#1,d2
00891502 6600                       		bne.s	@loc_106CC
00891504 5341                       		subq.w	#1,d1
00891506 9041                       		sub.w	d1,d0
00891508 4440                       		neg.w	d0
0089150A D068 0030                  		add.w	fb_origY(a0),d0
0089150E 3140 000C                  		move.w	d0,obY(a0)
00891512 5241                       		addq.w	#1,d1
00891514 D268 0034                  		add.w	fb_origX(a0),d1
00891518 3141 0008                  		move.w	d1,obX(a0)
0089151C 4E75                       		rts	
0089151E                            ; ===========================================================================
0089151E                            
0089151E                            @loc_106CC:
0089151E 5302                       		subq.b	#1,d2
00891520 6600                       		bne.s	@loc_106EA
00891522 5341                       		subq.w	#1,d1
00891524 9041                       		sub.w	d1,d0
00891526 4440                       		neg.w	d0
00891528 D068 0034                  		add.w	fb_origX(a0),d0
0089152C 3140 0008                  		move.w	d0,obX(a0)
00891530 5241                       		addq.w	#1,d1
00891532 D268 0030                  		add.w	fb_origY(a0),d1
00891536 3141 000C                  		move.w	d1,obY(a0)
0089153A 4E75                       		rts	
0089153C                            ; ===========================================================================
0089153C                            
0089153C                            @loc_106EA:
0089153C 9041                       		sub.w	d1,d0
0089153E D068 0030                  		add.w	fb_origY(a0),d0
00891542 3140 000C                  		move.w	d0,obY(a0)
00891546 4441                       		neg.w	d1
00891548 D268 0034                  		add.w	fb_origX(a0),d1
0089154C 3141 0008                  		move.w	d1,obX(a0)
00891550 4E75                       		rts	
00891550 4E75                       		rts	
00891552                            		include	"_maps\Floating Blocks and Doors.asm"
00891552                            ; ---------------------------------------------------------------------------
00891552                            ; Sprite mappings - moving blocks (SYZ/SLZ/LZ)
00891552                            ; ---------------------------------------------------------------------------
00891552 0000 0000                  Map_FBlock:	dc.w @syz1x1-Map_FBlock, @syz2x2-Map_FBlock
00891556 0000 0000                  		dc.w @syz1x2-Map_FBlock, @syzrect2x2-Map_FBlock
0089155A 0000 0000                  		dc.w @syzrect1x3-Map_FBlock, @slz-Map_FBlock
0089155E 0000 0000                  		dc.w @lzvert-Map_FBlock, @lzhoriz-Map_FBlock
00891562 01                         @syz1x1:	dc.b 1
00891563 F00F 0061 F0               		dc.b $F0, $F, 0, $61, $F0 ; SYZ - 1x1 square block
00891568 04                         @syz2x2:	dc.b 4
00891569 E00F 0061 E0               		dc.b $E0, $F, 0, $61, $E0 ; SYZ - 2x2 square blocks
0089156E E00F 0061 00               		dc.b $E0, $F, 0, $61, 0
00891573 000F 0061 E0               		dc.b 0,	$F, 0, $61, $E0
00891578 000F 0061 00               		dc.b 0,	$F, 0, $61, 0
0089157D 02                         @syz1x2:	dc.b 2
0089157E E00F 0061 F0               		dc.b $E0, $F, 0, $61, $F0 ; SYZ - 1x2 square blocks
00891583 000F 0061 F0               		dc.b 0,	$F, 0, $61, $F0
00891588 04                         @syzrect2x2:	dc.b 4
00891589 E60F 0081 E0               		dc.b $E6, $F, 0, $81, $E0 ; SYZ - 2x2 rectangular blocks
0089158E E60F 0081 00               		dc.b $E6, $F, 0, $81, 0
00891593 000F 0081 E0               		dc.b 0,	$F, 0, $81, $E0
00891598 000F 0081 00               		dc.b 0,	$F, 0, $81, 0
0089159D 03                         @syzrect1x3:	dc.b 3
0089159E D90F 0081 F0               		dc.b $D9, $F, 0, $81, $F0 ; SYZ - 1x3 rectangular blocks
008915A3 F30F 0081 F0               		dc.b $F3, $F, 0, $81, $F0
008915A8 0D0F 0081 F0               		dc.b $D, $F, 0,	$81, $F0
008915AD 01                         @slz:		dc.b 1
008915AE F00F 0021 F0               		dc.b $F0, $F, 0, $21, $F0 ; SLZ - 1x1 square block
008915B3 02                         @lzvert:	dc.b 2
008915B4 E007 0000 F8               		dc.b $E0, 7, 0,	0, $F8	; LZ - small vertical door
008915B9 0007 1000 F8               		dc.b 0,	7, $10,	0, $F8
008915BE 04                         @lzhoriz:	dc.b 4
008915BF F00F 0022 C0               		dc.b $F0, $F, 0, $22, $C0 ; LZ - large horizontal door
008915C4 F00F 0022 E0               		dc.b $F0, $F, 0, $22, $E0
008915C9 F00F 0022 00               		dc.b $F0, $F, 0, $22, 0
008915CE F00F 0022 20               		dc.b $F0, $F, 0, $22, $20
008915D4 00                         		even
008915D4 00                         		even
008915D4                            
008915D4                            		include	"_incObj\57 Spiked Ball and Chain.asm"
008915D4                            ; ---------------------------------------------------------------------------
008915D4                            ; Object 57 - spiked balls (SYZ, LZ)
008915D4                            ; ---------------------------------------------------------------------------
008915D4                            
008915D4                            SpikeBall:				; XREF: Obj_Index
008915D4 7000                       		moveq	#0,d0
008915D6 1028 0024                  		move.b	obRoutine(a0),d0
008915DA 323B 0000                  		move.w	SBall_Index(pc,d0.w),d1
008915DE 4EFB 1000                  		jmp	SBall_Index(pc,d1.w)
008915E2                            ; ===========================================================================
008915E2 0000                       SBall_Index:	dc.w SBall_Main-SBall_Index
008915E4 0000                       		dc.w SBall_Move-SBall_Index
008915E6 0000                       		dc.w SBall_Display-SBall_Index
008915E8                            
008915E8 =00000029                  sball_childs:	= $29		; number of child objects (1 byte)
008915E8                            		; $30-$37	; object RAM numbers of childs (1 byte each)
008915E8 =0000003A                  sball_origX:	= $3A		; centre x-axis position (2 bytes)
008915E8 =00000038                  sball_origY:	= $38		; centre y-axis position (2 bytes)
008915E8 =0000003C                  sball_radius:	= $3C		; radius (1 byte)
008915E8 =0000003E                  sball_speed:	= $3E		; rate of spin (2 bytes)
008915E8                            ; ===========================================================================
008915E8                            
008915E8                            SBall_Main:	; Routine 0
008915E8 5428 0024                  		addq.b	#2,obRoutine(a0)
008915EC 217C 0000 0000 0004        		move.l	#Map_SBall,obMap(a0)
008915F4 317C 03BA 0002             		move.w	#$3BA,obGfx(a0)
008915FA 117C 0004 0001             		move.b	#4,obRender(a0)
00891600 117C 0004 0018             		move.b	#4,obPriority(a0)
00891606 117C 0008 0019             		move.b	#8,obActWid(a0)
0089160C 3168 0008 003A             		move.w	obX(a0),sball_origX(a0)
00891612 3168 000C 0038             		move.w	obY(a0),sball_origY(a0)
00891618 117C 0098 0020             		move.b	#$98,obColType(a0) ; SYZ specific code (chain hurts Sonic)
0089161E 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
00891624 6600                       		bne.s	@notlz
00891626                            
00891626 117C 0000 0020             		move.b	#0,obColType(a0) ; LZ specific code (chain doesn't hurt)
0089162C 317C 0310 0002             		move.w	#$310,obGfx(a0)
00891632 217C 0000 0000 0004        		move.l	#Map_SBall2,obMap(a0)
0089163A                            
0089163A                            	@notlz:
0089163A 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
0089163E 0201 00F0                  		andi.b	#$F0,d1		; read only the	1st digit
00891642 4881                       		ext.w	d1
00891644 E741                       		asl.w	#3,d1		; multiply by 8
00891646 3141 003E                  		move.w	d1,sball_speed(a0) ; set object twirl speed
0089164A 1028 0022                  		move.b	obStatus(a0),d0
0089164E E418                       		ror.b	#2,d0
00891650 0200 00C0                  		andi.b	#$C0,d0
00891654 1140 0026                  		move.b	d0,obAngle(a0)
00891658 45E8 0029                  		lea	sball_childs(a0),a2
0089165C 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00891660 0241 0007                  		andi.w	#7,d1		; read only the	2nd digit
00891664 14FC 0000                  		move.b	#0,(a2)+
00891668 3601                       		move.w	d1,d3
0089166A E94B                       		lsl.w	#4,d3
0089166C 1143 003C                  		move.b	d3,sball_radius(a0)
00891670 5341                       		subq.w	#1,d1		; set chain length (type-1)
00891672 6500                       		bcs.s	@fail
00891674 0828 0003 0028             		btst	#3,obSubtype(a0)
0089167A 6700                       		beq.s	@makechain
0089167C 5341                       		subq.w	#1,d1
0089167E 6500                       		bcs.s	@fail
00891680                            
00891680                            @makechain:
00891680 6100 D1E0                  		bsr.w	FindFreeObj
00891684 6600                       		bne.s	@fail
00891686 5228 0029                  		addq.b	#1,sball_childs(a0) ; increment child object counter
0089168A 3A09                       		move.w	a1,d5		; get child object RAM address
0089168C 0445 D000                  		subi.w	#$D000,d5	; subtract $D000
00891690 EC4D                       		lsr.w	#6,d5		; divide by $40
00891692 0245 007F                  		andi.w	#$7F,d5
00891696 14C5                       		move.b	d5,(a2)+	; copy child RAM number
00891698 137C 0004 0024             		move.b	#4,obRoutine(a1)
0089169E 1368 0000 0000             		move.b	0(a0),0(a1)
008916A4 2368 0004 0004             		move.l	obMap(a0),obMap(a1)
008916AA 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
008916B0 1368 0001 0001             		move.b	obRender(a0),obRender(a1)
008916B6 1368 0018 0018             		move.b	obPriority(a0),obPriority(a1)
008916BC 1368 0019 0019             		move.b	obActWid(a0),obActWid(a1)
008916C2 1368 0020 0020             		move.b	obColType(a0),obColType(a1)
008916C8 0403 0010                  		subi.b	#$10,d3
008916CC 1343 003C                  		move.b	d3,sball_radius(a1)
008916D0 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
008916D6 6600                       		bne.s	@notlzagain
008916D8                            
008916D8 4A03                       		tst.b	d3
008916DA 6600                       		bne.s	@notlzagain
008916DC 137C 0002 001A             		move.b	#2,obFrame(a1)	; use different frame for LZ chain
008916E2                            
008916E2                            	@notlzagain:
008916E2 51C9 FF9C                  		dbf	d1,@makechain ; repeat for length of chain
008916E6                            
008916E6                            	@fail:
008916E6 3A08                       		move.w	a0,d5
008916E8 0445 D000                  		subi.w	#$D000,d5
008916EC EC4D                       		lsr.w	#6,d5
008916EE 0245 007F                  		andi.w	#$7F,d5
008916F2 14C5                       		move.b	d5,(a2)+
008916F4 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
008916FA 6600                       		bne.s	SBall_Move
008916FC                            
008916FC 117C 008B 0020             		move.b	#$8B,obColType(a0) ; if yes, make last spikeball larger
00891702 117C 0001 001A             		move.b	#1,obFrame(a0)	; use different	frame
00891708                            
00891708                            SBall_Move:	; Routine 2
00891708 6100 0000                  		bsr.w	@movesub
0089170C 6000 0000                  		bra.w	@chkdel
00891710                            ; ===========================================================================
00891710                            
00891710                            @movesub:
00891710 3028 003E                  		move.w	sball_speed(a0),d0
00891714 D168 0026                  		add.w	d0,obAngle(a0)
00891718 1028 0026                  		move.b	obAngle(a0),d0
0089171C 4EB9 0088 301C             		jsr	(CalcSine).l
00891722 3428 0038                  		move.w	sball_origY(a0),d2
00891726 3628 003A                  		move.w	sball_origX(a0),d3
0089172A 45E8 0029                  		lea	sball_childs(a0),a2
0089172E 7C00                       		moveq	#0,d6
00891730 1C1A                       		move.b	(a2)+,d6
00891732                            
00891732                            	@loop:
00891732 7800                       		moveq	#0,d4
00891734 181A                       		move.b	(a2)+,d4
00891736 ED4C                       		lsl.w	#6,d4
00891738 0684 00FF D000             		addi.l	#v_objspace&$FFFFFF,d4
0089173E 2244                       		movea.l	d4,a1
00891740 7800                       		moveq	#0,d4
00891742 1829 003C                  		move.b	sball_radius(a1),d4
00891746 2A04                       		move.l	d4,d5
00891748 C9C0                       		muls.w	d0,d4
0089174A E084                       		asr.l	#8,d4
0089174C CBC1                       		muls.w	d1,d5
0089174E E085                       		asr.l	#8,d5
00891750 D842                       		add.w	d2,d4
00891752 DA43                       		add.w	d3,d5
00891754 3344 000C                  		move.w	d4,obY(a1)
00891758 3345 0008                  		move.w	d5,obX(a1)
0089175C 51CE FFD4                  		dbf	d6,@loop
00891760 4E75                       		rts	
00891762                            ; ===========================================================================
00891762                            
00891762                            @chkdel:
00891780 6000 CC4A                  		bra.w	DisplaySprite
00891784                            ; ===========================================================================
00891784                            
00891784                            @delete:
00891784 7400                       		moveq	#0,d2
00891786 45E8 0029                  		lea	sball_childs(a0),a2
0089178A 141A                       		move.b	(a2)+,d2
0089178C                            
0089178C                            	@deleteloop:
0089178C 7000                       		moveq	#0,d0
0089178E 101A                       		move.b	(a2)+,d0
00891790 ED48                       		lsl.w	#6,d0
00891792 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
00891798 2240                       		movea.l	d0,a1
0089179A 6100 CC6E                  		bsr.w	DeleteChild
0089179E 51CA FFEC                  		dbf	d2,@deleteloop ; delete all pieces of	chain
008917A2                            
008917A2 4E75                       		rts	
008917A4                            ; ===========================================================================
008917A4                            
008917A4                            SBall_Display:	; Routine 4
008917A4 6000 CC26                  		bra.w	DisplaySprite
008917A4 6000 CC26                  		bra.w	DisplaySprite
008917A8                            		include	"_maps\Spiked Ball and Chain (SYZ).asm"
008917A8                            ; ---------------------------------------------------------------------------
008917A8                            ; Sprite mappings - chain of spiked balls (SYZ)
008917A8                            ; ---------------------------------------------------------------------------
008917A8 0000                       Map_SBall:	dc.w @0-Map_SBall
008917AA 01                         @0:		dc.b 1
008917AB F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
008917B0                            		even
008917B0                            		even
008917B0                            		include	"_maps\Spiked Ball and Chain (LZ).asm"
008917B0                            ; ---------------------------------------------------------------------------
008917B0                            ; Sprite mappings - spiked ball	on a chain (LZ)
008917B0                            ; ---------------------------------------------------------------------------
008917B0 0000                       Map_SBall2:	dc.w @chain-Map_SBall2
008917B2 0000                       		dc.w @spikeball-Map_SBall2
008917B4 0000                       		dc.w @base-Map_SBall2
008917B6 01                         @chain:		dc.b 1
008917B7 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8	; chain link
008917BC 01                         @spikeball:	dc.b 1
008917BD F00F 0004 F0               		dc.b $F0, $F, 0, 4, $F0	; spikeball
008917C2 01                         @base:		dc.b 1
008917C3 F805 0014 F8               		dc.b $F8, 5, 0,	$14, $F8 ; wall attachment
008917C8                            		even
008917C8                            		even
008917C8                            		include	"_incObj\58 Big Spiked Ball.asm"
008917C8                            ; ---------------------------------------------------------------------------
008917C8                            ; Object 58 - giant spiked balls (SYZ)
008917C8                            ; ---------------------------------------------------------------------------
008917C8                            
008917C8                            BigSpikeBall:				; XREF: Obj_Index
008917C8 7000                       		moveq	#0,d0
008917CA 1028 0024                  		move.b	obRoutine(a0),d0
008917CE 323B 0000                  		move.w	BBall_Index(pc,d0.w),d1
008917D2 4EFB 1000                  		jmp	BBall_Index(pc,d1.w)
008917D6                            ; ===========================================================================
008917D6 0000                       BBall_Index:	dc.w BBall_Main-BBall_Index
008917D8 0000                       		dc.w BBall_Move-BBall_Index
008917DA                            
008917DA =0000003A                  bball_origX:	= $3A		; original x-axis position
008917DA =00000038                  bball_origY:	= $38		; original y-axis position
008917DA =0000003C                  bball_radius:	= $3C		; radius of circle
008917DA =0000003E                  bball_speed:	= $3E		; speed
008917DA                            ; ===========================================================================
008917DA                            
008917DA                            BBall_Main:	; Routine 0
008917DA 5428 0024                  		addq.b	#2,obRoutine(a0)
008917DE 217C 0000 0000 0004        		move.l	#Map_BBall,obMap(a0)
008917E6 317C 0396 0002             		move.w	#$396,obGfx(a0)
008917EC 117C 0004 0001             		move.b	#4,obRender(a0)
008917F2 117C 0004 0018             		move.b	#4,obPriority(a0)
008917F8 117C 0018 0019             		move.b	#$18,obActWid(a0)
008917FE 3168 0008 003A             		move.w	obX(a0),bball_origX(a0)
00891804 3168 000C 0038             		move.w	obY(a0),bball_origY(a0)
0089180A 117C 0086 0020             		move.b	#$86,obColType(a0)
00891810 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00891814 0201 00F0                  		andi.b	#$F0,d1		; read only the	1st digit
00891818 4881                       		ext.w	d1
0089181A E741                       		asl.w	#3,d1		; multiply by 8
0089181C 3141 003E                  		move.w	d1,bball_speed(a0) ; set object speed
00891820 1028 0022                  		move.b	obStatus(a0),d0
00891824 E418                       		ror.b	#2,d0
00891826 0200 00C0                  		andi.b	#$C0,d0
0089182A 1140 0026                  		move.b	d0,obAngle(a0)
0089182E 117C 0050 003C             		move.b	#$50,bball_radius(a0) ; set radius of circle motion
00891834                            
00891834                            BBall_Move:	; Routine 2
00891834 7000                       		moveq	#0,d0
00891836 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
0089183A 0240 0007                  		andi.w	#7,d0		; read only the	2nd digit
0089183E D040                       		add.w	d0,d0
00891840 323B 0000                  		move.w	@index(pc,d0.w),d1
00891844 4EBB 1000                  		jsr	@index(pc,d1.w)
00891866 6000 CB64                  		bra.w	DisplaySprite
0089186A                            ; ===========================================================================
0089186A 0000                       @index:		dc.w @type00-@index
0089186C 0000                       		dc.w @type01-@index
0089186E 0000                       		dc.w @type02-@index
00891870 0000                       		dc.w @type03-@index
00891872                            ; ===========================================================================
00891872                            
00891872                            @type00:				; XREF: @index
00891872 4E75                       		rts	
00891874                            ; ===========================================================================
00891874                            
00891874                            @type01:				; XREF: @index
00891874 323C 0060                  		move.w	#$60,d1
00891878 7000                       		moveq	#0,d0
0089187A 1038 FE6C                  		move.b	(v_oscillate+$E).w,d0
0089187E 0828 0000 0022             		btst	#0,obStatus(a0)
00891884 6700                       		beq.s	@noflip1
00891886 4440                       		neg.w	d0
00891888 D041                       		add.w	d1,d0
0089188A                            
0089188A                            	@noflip1:
0089188A 3228 003A                  		move.w	bball_origX(a0),d1
0089188E 9240                       		sub.w	d0,d1
00891890 3141 0008                  		move.w	d1,obX(a0)	; move object horizontally
00891894 4E75                       		rts	
00891896                            ; ===========================================================================
00891896                            
00891896                            @type02:				; XREF: @index
00891896 323C 0060                  		move.w	#$60,d1
0089189A 7000                       		moveq	#0,d0
0089189C 1038 FE6C                  		move.b	(v_oscillate+$E).w,d0
008918A0 0828 0000 0022             		btst	#0,obStatus(a0)
008918A6 6700                       		beq.s	@noflip2
008918A8 4440                       		neg.w	d0
008918AA 0640 0080                  		addi.w	#$80,d0
008918AE                            
008918AE                            	@noflip2:
008918AE 3228 0038                  		move.w	bball_origY(a0),d1
008918B2 9240                       		sub.w	d0,d1
008918B4 3141 000C                  		move.w	d1,obY(a0)	; move object vertically
008918B8 4E75                       		rts	
008918BA                            ; ===========================================================================
008918BA                            
008918BA                            @type03:				; XREF: @index
008918BA 3028 003E                  		move.w	bball_speed(a0),d0
008918BE D168 0026                  		add.w	d0,obAngle(a0)
008918C2 1028 0026                  		move.b	obAngle(a0),d0
008918C6 4EB9 0088 301C             		jsr	(CalcSine).l
008918CC 3428 0038                  		move.w	bball_origY(a0),d2
008918D0 3628 003A                  		move.w	bball_origX(a0),d3
008918D4 7800                       		moveq	#0,d4
008918D6 1828 003C                  		move.b	bball_radius(a0),d4
008918DA 2A04                       		move.l	d4,d5
008918DC C9C0                       		muls.w	d0,d4
008918DE E084                       		asr.l	#8,d4
008918E0 CBC1                       		muls.w	d1,d5
008918E2 E085                       		asr.l	#8,d5
008918E4 D842                       		add.w	d2,d4
008918E6 DA43                       		add.w	d3,d5
008918E8 3144 000C                  		move.w	d4,obY(a0)	; move object circularly
008918EC 3145 0008                  		move.w	d5,obX(a0)
008918F0 4E75                       		rts	
008918F0 4E75                       		rts	
008918F2                            		include	"_maps\Big Spiked Ball.asm"
008918F2                            ; ---------------------------------------------------------------------------
008918F2                            ; Sprite mappings - spiked ball on a chain (SBZ) and big spiked ball (SYZ)
008918F2                            ; ---------------------------------------------------------------------------
008918F2 0000                       Map_BBall:	dc.w @ball-Map_BBall
008918F4 0000                       		dc.w @chain-Map_BBall
008918F6 0000                       		dc.w @anchor-Map_BBall
008918F8 05                         @ball:		dc.b 5
008918F9 E804 0000 F8               		dc.b $E8, 4, 0,	0, $F8	; big spiked ball
008918FE F00F 0002 F0               		dc.b $F0, $F, 0, 2, $F0
00891903 F801 0012 E8               		dc.b $F8, 1, 0,	$12, $E8
00891908 F801 0014 10               		dc.b $F8, 1, 0,	$14, $10
0089190D 1004 0016 F8               		dc.b $10, 4, 0,	$16, $F8
00891912 01                         @chain:		dc.b 1
00891913 F805 0020 F8               		dc.b $F8, 5, 0,	$20, $F8 ; chain link (SBZ)
00891918 02                         @anchor:	dc.b 2
00891919 F80D 0018 F0               		dc.b $F8, $D, 0, $18, $F0 ; anchor at base of chain (SBZ)
0089191E E80D 1018 F0               		dc.b $E8, $D, $10, $18,	$F0
00891924 00                         		even
00891924 00                         		even
00891924                            		include	"_incObj\59 SLZ Elevators.asm"
00891924                            ; ---------------------------------------------------------------------------
00891924                            ; Object 59 - platforms	that move when you stand on them (SLZ)
00891924                            ; ---------------------------------------------------------------------------
00891924 =00000032                  elev_origX:	= $32		; original x-axis position
00891924 =00000030                  elev_origY:	= $30		; original y-axis position
00891924 =0000003C                  elev_dist:	= $3C		; distance to move (2 bytes)
00891924                            
00891924                            Elevator:				; XREF: Obj_Index
00891924 7000                       		moveq	#0,d0
00891926 1028 0024                  		move.b	obRoutine(a0),d0
0089192A 323B 0000                  		move.w	Elev_Index(pc,d0.w),d1
0089192E 4EBB 1000                  		jsr	Elev_Index(pc,d1.w)
00891950 6000 CA7A                  		bra.w	DisplaySprite
00891954                            ; ===========================================================================
00891954 0000                       Elev_Index:	dc.w Elev_Main-Elev_Index
00891956 0000                       		dc.w Elev_Platform-Elev_Index
00891958 0000                       		dc.w Elev_Action-Elev_Index
0089195A 0000                       		dc.w Elev_MakeMulti-Elev_Index
0089195C                            
0089195C 2800                       Elev_Var1:	dc.b $28, 0		; width, frame number
0089195E                            
0089195E 1001                       Elev_Var2:	dc.b $10, 1		; distance to move, action type
00891960 2001                       		dc.b $20, 1
00891962 3401                       		dc.b $34, 1
00891964 1003                       		dc.b $10, 3
00891966 2003                       		dc.b $20, 3
00891968 3403                       		dc.b $34, 3
0089196A 1401                       		dc.b $14, 1
0089196C 2401                       		dc.b $24, 1
0089196E 2C01                       		dc.b $2C, 1
00891970 1403                       		dc.b $14, 3
00891972 2403                       		dc.b $24, 3
00891974 2C03                       		dc.b $2C, 3
00891976 2005                       		dc.b $20, 5
00891978 2007                       		dc.b $20, 7
0089197A 3009                       		dc.b $30, 9
0089197C                            ; ===========================================================================
0089197C                            
0089197C                            Elev_Main:	; Routine 0
0089197C 5428 0024                  		addq.b	#2,obRoutine(a0)
00891980 7000                       		moveq	#0,d0
00891982 1028 0028                  		move.b	obSubtype(a0),d0
00891986 6A00                       		bpl.s	@normal		; branch for types 00-7F
00891988 5828 0024                  		addq.b	#4,obRoutine(a0) ; goto Elev_MakeMulti next
0089198C 0240 007F                  		andi.w	#$7F,d0
00891990 C0FC 0006                  		mulu.w	#6,d0
00891994 3140 003C                  		move.w	d0,elev_dist(a0)
00891998 3140 003E                  		move.w	d0,$3E(a0)
0089199C 588F                       		addq.l	#4,sp
0089199E 4E75                       		rts	
008919A0                            ; ===========================================================================
008919A0                            
008919A0                            	@normal:
008919A0 E648                       		lsr.w	#3,d0
008919A2 0240 001E                  		andi.w	#$1E,d0
008919A6 45FB 00B4                  		lea	Elev_Var1(pc,d0.w),a2
008919AA 115A 0019                  		move.b	(a2)+,obActWid(a0) ; set width
008919AE 115A 001A                  		move.b	(a2)+,obFrame(a0) ; set frame
008919B2 7000                       		moveq	#0,d0
008919B4 1028 0028                  		move.b	obSubtype(a0),d0
008919B8 D040                       		add.w	d0,d0
008919BA 0240 001E                  		andi.w	#$1E,d0
008919BE 45FB 009E                  		lea	Elev_Var2(pc,d0.w),a2
008919C2 101A                       		move.b	(a2)+,d0
008919C4 E548                       		lsl.w	#2,d0
008919C6 3140 003C                  		move.w	d0,elev_dist(a0)	; set distance to move
008919CA 115A 0028                  		move.b	(a2)+,obSubtype(a0)	; set type
008919CE 217C 0000 0000 0004        		move.l	#Map_Elev,obMap(a0)
008919D6 317C 4000 0002             		move.w	#$4000,obGfx(a0)
008919DC 117C 0004 0001             		move.b	#4,obRender(a0)
008919E2 117C 0004 0018             		move.b	#4,obPriority(a0)
008919E8 3168 0008 0032             		move.w	obX(a0),elev_origX(a0)
008919EE 3168 000C 0030             		move.w	obY(a0),elev_origY(a0)
008919F4                            
008919F4                            Elev_Platform:	; Routine 2
008919F4 7200                       		moveq	#0,d1
008919F6 1228 0019                  		move.b	obActWid(a0),d1
008919FA 4EB9 0088 8080             		jsr	(PlatformObject).l
00891A00 6000 0000                  		bra.w	Elev_Types
00891A04                            ; ===========================================================================
00891A04                            
00891A04                            Elev_Action:	; Routine 4
00891A04 7200                       		moveq	#0,d1
00891A06 1228 0019                  		move.b	obActWid(a0),d1
00891A0A 4EB9 0088 81F4             		jsr	(ExitPlatform).l
00891A10 3F28 0008                  		move.w	obX(a0),-(sp)
00891A14 6100 0000                  		bsr.w	Elev_Types
00891A18 341F                       		move.w	(sp)+,d2
00891A1A 4A28 0000                  		tst.b	0(a0)
00891A1E 6700                       		beq.s	@deleted
00891A20 4EF9 0088 8762             		jmp	(MvSonicOnPtfm2).l
00891A26                            
00891A26                            	@deleted:
00891A26 4E75                       		rts	
00891A28                            ; ===========================================================================
00891A28                            
00891A28                            Elev_Types:
00891A28 7000                       		moveq	#0,d0
00891A2A 1028 0028                  		move.b	obSubtype(a0),d0
00891A2E 0240 000F                  		andi.w	#$F,d0
00891A32 D040                       		add.w	d0,d0
00891A34 323B 0000                  		move.w	@index(pc,d0.w),d1
00891A38 4EFB 1000                  		jmp	@index(pc,d1.w)
00891A3C                            ; ===========================================================================
00891A3C 0000 0000                  @index:		dc.w @type00-@index, @type01-@index
00891A40 0000 0000                  		dc.w @type02-@index, @type01-@index
00891A44 0000 0000                  		dc.w @type04-@index, @type01-@index
00891A48 0000 0000                  		dc.w @type06-@index, @type01-@index
00891A4C 0000 0000                  		dc.w @type08-@index, @type09-@index
00891A50                            ; ===========================================================================
00891A50                            
00891A50                            @type00:				; XREF: @index
00891A50 4E75                       		rts	
00891A52                            ; ===========================================================================
00891A52                            
00891A52                            @type01:				; XREF: @index
00891A52 0C28 0004 0024             		cmpi.b	#4,obRoutine(a0) ; check if Sonic is standing on the object
00891A58 6600                       		bne.s	@notstanding
00891A5A 5228 0028                  		addq.b	#1,obSubtype(a0) ; if yes, add 1 to type
00891A5E                            
00891A5E                            	@notstanding:
00891A5E 4E75                       		rts	
00891A60                            ; ===========================================================================
00891A60                            
00891A60                            @type02:				; XREF: @index
00891A60 6100 0000                  		bsr.w	Elev_Move
00891A64 3028 0034                  		move.w	$34(a0),d0
00891A68 4440                       		neg.w	d0
00891A6A D068 0030                  		add.w	elev_origY(a0),d0
00891A6E 3140 000C                  		move.w	d0,obY(a0)
00891A72 4E75                       		rts	
00891A74                            ; ===========================================================================
00891A74                            
00891A74                            @type04:				; XREF: @index
00891A74 6100 0000                  		bsr.w	Elev_Move
00891A78 3028 0034                  		move.w	$34(a0),d0
00891A7C D068 0030                  		add.w	elev_origY(a0),d0
00891A80 3140 000C                  		move.w	d0,obY(a0)
00891A84 4E75                       		rts	
00891A86                            ; ===========================================================================
00891A86                            
00891A86                            @type06:				; XREF: @index
00891A86 6100 0000                  		bsr.w	Elev_Move
00891A8A 3028 0034                  		move.w	$34(a0),d0
00891A8E E240                       		asr.w	#1,d0
00891A90 4440                       		neg.w	d0
00891A92 D068 0030                  		add.w	elev_origY(a0),d0
00891A96 3140 000C                  		move.w	d0,obY(a0)
00891A9A 3028 0034                  		move.w	$34(a0),d0
00891A9E D068 0032                  		add.w	elev_origX(a0),d0
00891AA2 3140 0008                  		move.w	d0,obX(a0)
00891AA6 4E75                       		rts	
00891AA8                            ; ===========================================================================
00891AA8                            
00891AA8                            @type08:				; XREF: @index
00891AA8 6100 0000                  		bsr.w	Elev_Move
00891AAC 3028 0034                  		move.w	$34(a0),d0
00891AB0 E240                       		asr.w	#1,d0
00891AB2 D068 0030                  		add.w	elev_origY(a0),d0
00891AB6 3140 000C                  		move.w	d0,obY(a0)
00891ABA 3028 0034                  		move.w	$34(a0),d0
00891ABE 4440                       		neg.w	d0
00891AC0 D068 0032                  		add.w	elev_origX(a0),d0
00891AC4 3140 0008                  		move.w	d0,obX(a0)
00891AC8 4E75                       		rts	
00891ACA                            ; ===========================================================================
00891ACA                            
00891ACA                            @type09:				; XREF: @index
00891ACA 6100 0000                  		bsr.w	Elev_Move
00891ACE 3028 0034                  		move.w	$34(a0),d0
00891AD2 4440                       		neg.w	d0
00891AD4 D068 0030                  		add.w	elev_origY(a0),d0
00891AD8 3140 000C                  		move.w	d0,obY(a0)
00891ADC 4A28 0028                  		tst.b	obSubtype(a0)
00891AE0 6700 0000                  		beq.w	@typereset
00891AE4 4E75                       		rts	
00891AE6                            ; ===========================================================================
00891AE6                            
00891AE6                            	@typereset:
00891AE6 0828 0003 0022             		btst	#3,obStatus(a0)
00891AEC 6700                       		beq.s	@delete
00891AEE 08E9 0001 0022             		bset	#1,obStatus(a1)
00891AF4 08A9 0003 0022             		bclr	#3,obStatus(a1)
00891AFA 137C 0002 0024             		move.b	#2,obRoutine(a1)
00891B00                            
00891B00                            	@delete:
00891B00 6000 C906                  		bra.w	DeleteObject
00891B04                            
00891B04                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00891B04                            
00891B04                            
00891B04                            Elev_Move:				; XREF: @type02; et al
00891B04 3028 0038                  		move.w	$38(a0),d0
00891B08 4A28 003A                  		tst.b	$3A(a0)
00891B0C 6600                       		bne.s	loc_10CC8
00891B0E 0C40 0800                  		cmpi.w	#$800,d0
00891B12 6400                       		bcc.s	loc_10CD0
00891B14 0640 0010                  		addi.w	#$10,d0
00891B18 6000                       		bra.s	loc_10CD0
00891B1A                            ; ===========================================================================
00891B1A                            
00891B1A                            loc_10CC8:
00891B1A 4A40                       		tst.w	d0
00891B1C 6700                       		beq.s	loc_10CD0
00891B1E 0440 0010                  		subi.w	#$10,d0
00891B22                            
00891B22                            loc_10CD0:
00891B22 3140 0038                  		move.w	d0,$38(a0)
00891B26 48C0                       		ext.l	d0
00891B28 E180                       		asl.l	#8,d0
00891B2A D0A8 0034                  		add.l	$34(a0),d0
00891B2E 2140 0034                  		move.l	d0,$34(a0)
00891B32 4840                       		swap	d0
00891B34 3428 003C                  		move.w	elev_dist(a0),d2
00891B38 B042                       		cmp.w	d2,d0
00891B3A 6300                       		bls.s	loc_10CF0
00891B3C 117C 0001 003A             		move.b	#1,$3A(a0)
00891B42                            
00891B42                            loc_10CF0:
00891B42 D442                       		add.w	d2,d2
00891B44 B042                       		cmp.w	d2,d0
00891B46 6600                       		bne.s	locret_10CFA
00891B48 4228 0028                  		clr.b	obSubtype(a0)
00891B4C                            
00891B4C                            locret_10CFA:
00891B4C 4E75                       		rts	
00891B4E                            ; End of function Elev_Move
00891B4E                            
00891B4E                            ; ===========================================================================
00891B4E                            
00891B4E                            Elev_MakeMulti:	; Routine 6
00891B4E 5368 003C                  		subq.w	#1,elev_dist(a0)
00891B52 6600                       		bne.s	@chkdel
00891B54 3168 003E 003C             		move.w	$3E(a0),elev_dist(a0)
00891B5A 6100 CD06                  		bsr.w	FindFreeObj
00891B5E 6600                       		bne.s	@chkdel
00891B60 137C 0059 0000             		move.b	#id_Elevator,0(a1) ; duplicate the object
00891B66 3368 0008 0008             		move.w	obX(a0),obX(a1)
00891B6C 3368 000C 000C             		move.w	obY(a0),obY(a1)
00891B72 137C 000E 0028             		move.b	#$E,obSubtype(a1)
00891B78                            
00891B78                            @chkdel:
00891B78 588F                       		addq.l	#4,sp
00891B98 4E75                       		rts	
00891B98 4E75                       		rts	
00891B9A                            		include	"_maps\SLZ Elevators.asm"
00891B9A                            ; ---------------------------------------------------------------------------
00891B9A                            ; Sprite mappings - platforms that move	when you stand on them (SLZ)
00891B9A                            ; ---------------------------------------------------------------------------
00891B9A 0000                       Map_Elev:	dc.w @elevator-Map_Elev
00891B9C 03                         @elevator:	dc.b 3
00891B9D F80F 0041 D8               		dc.b $F8, $F, 0, $41, $D8
00891BA2 F80F 0041 F8               		dc.b $F8, $F, 0, $41, $F8
00891BA7 F807 0041 18               		dc.b $F8, 7, 0,	$41, $18
00891BAC                            		even
00891BAC                            		even
00891BAC                            		include	"_incObj\5A SLZ Circling Platform.asm"
00891BAC                            
00891BAC =00000032                  circ_origX:	= $32		; original x-axis position
00891BAC =00000030                  circ_origY:	= $30		; original y-axis position
00891BAC                            
00891BAC                            ; ---------------------------------------------------------------------------
00891BAC                            ; Object 5A - platforms	moving in circles (SLZ)
00891BAC                            ; ---------------------------------------------------------------------------
00891BAC                            
00891BAC                            CirclingPlatform:			; XREF: Obj_Index
00891BAC 7000                       		moveq	#0,d0
00891BAE 1028 0024                  		move.b	obRoutine(a0),d0
00891BB2 323B 0000                  		move.w	Circ_Index(pc,d0.w),d1
00891BB6 4EBB 1000                  		jsr	Circ_Index(pc,d1.w)
00891BD8 6000 C7F2                  		bra.w	DisplaySprite
00891BDC                            ; ===========================================================================
00891BDC 0000                       Circ_Index:	dc.w Circ_Main-Circ_Index
00891BDE 0000                       		dc.w Circ_Platform-Circ_Index
00891BE0 0000                       		dc.w Circ_Action-Circ_Index
00891BE2                            
00891BE2                            ; ===========================================================================
00891BE2                            
00891BE2                            Circ_Main:	; Routine 0
00891BE2 5428 0024                  		addq.b	#2,obRoutine(a0)
00891BE6 217C 0000 0000 0004        		move.l	#Map_Circ,obMap(a0)
00891BEE 317C 4000 0002             		move.w	#$4000,obGfx(a0)
00891BF4 117C 0004 0001             		move.b	#4,obRender(a0)
00891BFA 117C 0004 0018             		move.b	#4,obPriority(a0)
00891C00 117C 0018 0019             		move.b	#$18,obActWid(a0)
00891C06 3168 0008 0032             		move.w	obX(a0),circ_origX(a0)
00891C0C 3168 000C 0030             		move.w	obY(a0),circ_origY(a0)
00891C12                            
00891C12                            Circ_Platform:	; Routine 2
00891C12 7200                       		moveq	#0,d1
00891C14 1228 0019                  		move.b	obActWid(a0),d1
00891C18 4EB9 0088 8080             		jsr	(PlatformObject).l
00891C1E 6000 0000                  		bra.w	Circ_Types
00891C22                            ; ===========================================================================
00891C22                            
00891C22                            Circ_Action:	; Routine 4
00891C22 7200                       		moveq	#0,d1
00891C24 1228 0019                  		move.b	obActWid(a0),d1
00891C28 4EB9 0088 81F4             		jsr	(ExitPlatform).l
00891C2E 3F28 0008                  		move.w	obX(a0),-(sp)
00891C32 6100 0000                  		bsr.w	Circ_Types
00891C36 341F                       		move.w	(sp)+,d2
00891C38 4EF9 0088 8762             		jmp	(MvSonicOnPtfm2).l
00891C3E                            ; ===========================================================================
00891C3E                            
00891C3E                            Circ_Types:
00891C3E 7000                       		moveq	#0,d0
00891C40 1028 0028                  		move.b	obSubtype(a0),d0
00891C44 0240 000C                  		andi.w	#$C,d0
00891C48 E248                       		lsr.w	#1,d0
00891C4A 323B 0000                  		move.w	@index(pc,d0.w),d1
00891C4E 4EFB 1000                  		jmp	@index(pc,d1.w)
00891C52                            ; ===========================================================================
00891C52 0000                       @index:		dc.w @type00-@index
00891C54 0000                       		dc.w @type04-@index
00891C56                            ; ===========================================================================
00891C56                            
00891C56                            @type00:				; XREF: @index
00891C56 1238 FE80                  		move.b	(v_oscillate+$22).w,d1 ; get rotating value
00891C5A 0401 0050                  		subi.b	#$50,d1		; set radius of circle
00891C5E 4881                       		ext.w	d1
00891C60 1438 FE84                  		move.b	(v_oscillate+$26).w,d2
00891C64 0402 0050                  		subi.b	#$50,d2
00891C68 4882                       		ext.w	d2
00891C6A 0828 0000 0028             		btst	#0,obSubtype(a0)
00891C70 6700                       		beq.s	@noshift00a
00891C72 4441                       		neg.w	d1
00891C74 4442                       		neg.w	d2
00891C76                            
00891C76                            	@noshift00a:
00891C76 0828 0001 0028             		btst	#1,obSubtype(a0)
00891C7C 6700                       		beq.s	@noshift00b
00891C7E 4441                       		neg.w	d1
00891C80 C342                       		exg	d1,d2
00891C82                            
00891C82                            	@noshift00b:
00891C82 D268 0032                  		add.w	circ_origX(a0),d1
00891C86 3141 0008                  		move.w	d1,obX(a0)
00891C8A D468 0030                  		add.w	circ_origY(a0),d2
00891C8E 3142 000C                  		move.w	d2,obY(a0)
00891C92 4E75                       		rts	
00891C94                            ; ===========================================================================
00891C94                            
00891C94                            @type04:				; XREF: @index
00891C94 1238 FE80                  		move.b	(v_oscillate+$22).w,d1
00891C98 0401 0050                  		subi.b	#$50,d1
00891C9C 4881                       		ext.w	d1
00891C9E 1438 FE84                  		move.b	(v_oscillate+$26).w,d2
00891CA2 0402 0050                  		subi.b	#$50,d2
00891CA6 4882                       		ext.w	d2
00891CA8 0828 0000 0028             		btst	#0,obSubtype(a0)
00891CAE 6700                       		beq.s	@noshift04a
00891CB0 4441                       		neg.w	d1
00891CB2 4442                       		neg.w	d2
00891CB4                            
00891CB4                            	@noshift04a:
00891CB4 0828 0001 0028             		btst	#1,obSubtype(a0)
00891CBA 6700                       		beq.s	@noshift04b
00891CBC 4441                       		neg.w	d1
00891CBE C342                       		exg	d1,d2
00891CC0                            
00891CC0                            	@noshift04b:
00891CC0 4441                       		neg.w	d1
00891CC2 D268 0032                  		add.w	circ_origX(a0),d1
00891CC6 3141 0008                  		move.w	d1,obX(a0)
00891CCA D468 0030                  		add.w	circ_origY(a0),d2
00891CCE 3142 000C                  		move.w	d2,obY(a0)
00891CD2 4E75                       		rts	
00891CD2 4E75                       		rts	
00891CD4                            		include	"_maps\SLZ Circling Platform.asm"
00891CD4                            ; ---------------------------------------------------------------------------
00891CD4                            ; Sprite mappings - platforms that move	in circles (SLZ)
00891CD4                            ; ---------------------------------------------------------------------------
00891CD4 0000                       Map_Circ:	dc.w @platform-Map_Circ
00891CD6 02                         @platform:	dc.b 2
00891CD7 F809 0051 E8               		dc.b $F8, 9, 0,	$51, $E8
00891CDC F809 0851 00               		dc.b $F8, 9, 8,	$51, 0
00891CE2 00                         		even
00891CE2 00                         		even
00891CE2                            		include	"_incObj\5B Staircase.asm"
00891CE2                            ; ---------------------------------------------------------------------------
00891CE2                            ; Object 5B - blocks that form a staircase (SLZ)
00891CE2                            ; ---------------------------------------------------------------------------
00891CE2                            
00891CE2 =00000030                  stair_origX:	= $30		; original x-axis position
00891CE2 =00000032                  stair_origY:	= $32		; original y-axis position
00891CE2                            
00891CE2 =0000003C                  stair_parent:	= $3C		; address of parent object (4 bytes)
00891CE2                            
00891CE2                            Staircase:				; XREF: Obj_Index
00891CE2 7000                       		moveq	#0,d0
00891CE4 1028 0024                  		move.b	obRoutine(a0),d0
00891CE8 323B 0000                  		move.w	Stair_Index(pc,d0.w),d1
00891CEC 4EBB 1000                  		jsr	Stair_Index(pc,d1.w)
00891D0E 6000 C6BC                  		bra.w	DisplaySprite
00891D12                            ; ===========================================================================
00891D12 0000                       Stair_Index:	dc.w Stair_Main-Stair_Index
00891D14 0000                       		dc.w Stair_Move-Stair_Index
00891D16 0000                       		dc.w Stair_Solid-Stair_Index
00891D18                            ; ===========================================================================
00891D18                            
00891D18                            Stair_Main:	; Routine 0
00891D18 5428 0024                  		addq.b	#2,obRoutine(a0)
00891D1C 7638                       		moveq	#$38,d3
00891D1E 7801                       		moveq	#1,d4
00891D20 0828 0000 0022             		btst	#0,obStatus(a0)	; is object flipped?
00891D26 6700                       		beq.s	@notflipped	; if not, branch
00891D28 763B                       		moveq	#$3B,d3
00891D2A 78FF                       		moveq	#-1,d4
00891D2C                            
00891D2C                            	@notflipped:
00891D2C 3428 0008                  		move.w	obX(a0),d2
00891D30 2248                       		movea.l	a0,a1
00891D32 7203                       		moveq	#3,d1
00891D34 6000                       		bra.s	@makeblocks
00891D36                            ; ===========================================================================
00891D36                            
00891D36                            @loop:
00891D36 6100 CB40                  		bsr.w	FindNextFreeObj
00891D3A 6600 0000                  		bne.w	@fail
00891D3E 137C 0004 0024             		move.b	#4,obRoutine(a1)
00891D44                            
00891D44                            @makeblocks:
00891D44 137C 005B 0000             		move.b	#id_Staircase,0(a1) ; load another block object
00891D4A 237C 0000 0000 0004        		move.l	#Map_Stair,obMap(a1)
00891D52 337C 4000 0002             		move.w	#$4000,obGfx(a1)
00891D58 137C 0004 0001             		move.b	#4,obRender(a1)
00891D5E 137C 0003 0018             		move.b	#3,obPriority(a1)
00891D64 137C 0010 0019             		move.b	#$10,obActWid(a1)
00891D6A 1368 0028 0028             		move.b	obSubtype(a0),obSubtype(a1)
00891D70 3342 0008                  		move.w	d2,obX(a1)
00891D74 3368 000C 000C             		move.w	obY(a0),obY(a1)
00891D7A 3368 0008 0030             		move.w	obX(a0),stair_origX(a1)
00891D80 3369 000C 0032             		move.w	obY(a1),stair_origY(a1)
00891D86 0642 0020                  		addi.w	#$20,d2
00891D8A 1343 0037                  		move.b	d3,$37(a1)
00891D8E 2348 003C                  		move.l	a0,stair_parent(a1)
00891D92 D604                       		add.b	d4,d3
00891D94 51C9 FFA0                  		dbf	d1,@loop	; repeat sequence 3 times
00891D98                            
00891D98                            	@fail:
00891D98                            
00891D98                            Stair_Move:	; Routine 2
00891D98 7000                       		moveq	#0,d0
00891D9A 1028 0028                  		move.b	obSubtype(a0),d0
00891D9E 0240 0007                  		andi.w	#7,d0
00891DA2 D040                       		add.w	d0,d0
00891DA4 323B 0000                  		move.w	Stair_TypeIndex(pc,d0.w),d1
00891DA8 4EBB 1000                  		jsr	Stair_TypeIndex(pc,d1.w)
00891DAC                            
00891DAC                            Stair_Solid:	; Routine 4
00891DAC 2468 003C                  		movea.l	stair_parent(a0),a2
00891DB0 7000                       		moveq	#0,d0
00891DB2 1028 0037                  		move.b	$37(a0),d0
00891DB6 1032 0000                  		move.b	(a2,d0.w),d0
00891DBA D068 0032                  		add.w	stair_origY(a0),d0
00891DBE 3140 000C                  		move.w	d0,obY(a0)
00891DC2 7200                       		moveq	#0,d1
00891DC4 1228 0019                  		move.b	obActWid(a0),d1
00891DC8 0641 000B                  		addi.w	#$B,d1
00891DCC 343C 0010                  		move.w	#$10,d2
00891DD0 363C 0011                  		move.w	#$11,d3
00891DD4 3828 0008                  		move.w	obX(a0),d4
00891DD8 6100 E9DC                  		bsr.w	SolidObject
00891DDC 4A04                       		tst.b	d4
00891DDE 6A00                       		bpl.s	loc_10F92
00891DE0 1544 0036                  		move.b	d4,$36(a2)
00891DE4                            
00891DE4                            loc_10F92:
00891DE4 0828 0003 0022             		btst	#3,obStatus(a0)
00891DEA 6700                       		beq.s	locret_10FA0
00891DEC 157C 0001 0036             		move.b	#1,$36(a2)
00891DF2                            
00891DF2                            locret_10FA0:
00891DF2 4E75                       		rts	
00891DF4                            ; ===========================================================================
00891DF4 0000                       Stair_TypeIndex:dc.w Stair_Type00-Stair_TypeIndex
00891DF6 0000                       		dc.w Stair_Type01-Stair_TypeIndex
00891DF8 0000                       		dc.w Stair_Type02-Stair_TypeIndex
00891DFA 0000                       		dc.w Stair_Type01-Stair_TypeIndex
00891DFC                            ; ===========================================================================
00891DFC                            
00891DFC                            Stair_Type00:				; XREF: Stair_TypeIndex
00891DFC 4A68 0034                  		tst.w	$34(a0)
00891E00 6600                       		bne.s	loc_10FC0
00891E02 0C28 0001 0036             		cmpi.b	#1,$36(a0)
00891E08 6600                       		bne.s	locret_10FBE
00891E0A 317C 001E 0034             		move.w	#$1E,$34(a0)
00891E10                            
00891E10                            locret_10FBE:
00891E10 4E75                       		rts	
00891E12                            ; ===========================================================================
00891E12                            
00891E12                            loc_10FC0:
00891E12 5368 0034                  		subq.w	#1,$34(a0)
00891E16 66F8                       		bne.s	locret_10FBE
00891E18 5228 0028                  		addq.b	#1,obSubtype(a0) ; add 1 to type
00891E1C 4E75                       		rts	
00891E1E                            ; ===========================================================================
00891E1E                            
00891E1E                            Stair_Type02:				; XREF: Stair_TypeIndex
00891E1E 4A68 0034                  		tst.w	$34(a0)
00891E22 6600                       		bne.s	loc_10FE0
00891E24 4A28 0036                  		tst.b	$36(a0)
00891E28 6A00                       		bpl.s	locret_10FDE
00891E2A 317C 003C 0034             		move.w	#$3C,$34(a0)
00891E30                            
00891E30                            locret_10FDE:
00891E30 4E75                       		rts	
00891E32                            ; ===========================================================================
00891E32                            
00891E32                            loc_10FE0:
00891E32 5368 0034                  		subq.w	#1,$34(a0)
00891E36 6600                       		bne.s	loc_10FEC
00891E38 5228 0028                  		addq.b	#1,obSubtype(a0) ; add 1 to type
00891E3C 4E75                       		rts	
00891E3E                            ; ===========================================================================
00891E3E                            
00891E3E                            loc_10FEC:
00891E3E 43E8 0038                  		lea	$38(a0),a1
00891E42 3028 0034                  		move.w	$34(a0),d0
00891E46 E408                       		lsr.b	#2,d0
00891E48 0200 0001                  		andi.b	#1,d0
00891E4C 12C0                       		move.b	d0,(a1)+
00891E4E 0A00 0001                  		eori.b	#1,d0
00891E52 12C0                       		move.b	d0,(a1)+
00891E54 0A00 0001                  		eori.b	#1,d0
00891E58 12C0                       		move.b	d0,(a1)+
00891E5A 0A00 0001                  		eori.b	#1,d0
00891E5E 12C0                       		move.b	d0,(a1)+
00891E60 4E75                       		rts	
00891E62                            ; ===========================================================================
00891E62                            
00891E62                            Stair_Type01:				; XREF: Stair_TypeIndex
00891E62 43E8 0038                  		lea	$38(a0),a1
00891E66 0C11 0080                  		cmpi.b	#$80,(a1)
00891E6A 6700                       		beq.s	locret_11038
00891E6C 5211                       		addq.b	#1,(a1)
00891E6E 7200                       		moveq	#0,d1
00891E70 1219                       		move.b	(a1)+,d1
00891E72 4841                       		swap	d1
00891E74 E289                       		lsr.l	#1,d1
00891E76 2401                       		move.l	d1,d2
00891E78 E289                       		lsr.l	#1,d1
00891E7A 2601                       		move.l	d1,d3
00891E7C D682                       		add.l	d2,d3
00891E7E 4841                       		swap	d1
00891E80 4842                       		swap	d2
00891E82 4843                       		swap	d3
00891E84 12C3                       		move.b	d3,(a1)+
00891E86 12C2                       		move.b	d2,(a1)+
00891E88 12C1                       		move.b	d1,(a1)+
00891E8A                            
00891E8A                            locret_11038:
00891E8A 4E75                       		rts	
00891E8C 4E75                       		rts	
00891E8C 4E75                       		rts	
00891E8E                            		include	"_maps\Staircase.asm"
00891E8E                            ; ---------------------------------------------------------------------------
00891E8E                            ; Sprite mappings - blocks that	form a staircase (SLZ)
00891E8E                            ; ---------------------------------------------------------------------------
00891E8E 0000                       Map_Stair:	dc.w @block-Map_Stair
00891E90 01                         @block:		dc.b 1
00891E91 F00F 0021 F0               		dc.b $F0, $F, 0, $21, $F0
00891E96                            		even
00891E96                            		even
00891E96                            		include	"_incObj\5C Pylon.asm"
00891E96                            ; ---------------------------------------------------------------------------
00891E96                            ; Object 5C - metal pylons in foreground (SLZ)
00891E96                            ; ---------------------------------------------------------------------------
00891E96                            
00891E96                            Pylon:					; XREF: Obj_Index
00891E96 7000                       		moveq	#0,d0
00891E98 1028 0024                  		move.b	obRoutine(a0),d0
00891E9C 323B 0000                  		move.w	Pyl_Index(pc,d0.w),d1
00891EA0 4EFB 1000                  		jmp	Pyl_Index(pc,d1.w)
00891EA4                            ; ===========================================================================
00891EA4 0000                       Pyl_Index:	dc.w Pyl_Main-Pyl_Index
00891EA6 0000                       		dc.w Pyl_Display-Pyl_Index
00891EA8                            ; ===========================================================================
00891EA8                            
00891EA8                            Pyl_Main:	; Routine 0
00891EA8 5428 0024                  		addq.b	#2,obRoutine(a0)
00891EAC 217C 0000 0000 0004        		move.l	#Map_Pylon,obMap(a0)
00891EB4 317C 83CC 0002             		move.w	#$83CC,obGfx(a0)
00891EBA 117C 0010 0019             		move.b	#$10,obActWid(a0)
00891EC0                            
00891EC0                            Pyl_Display:	; Routine 2
00891EC0 2238 F700                  		move.l	(v_screenposx).w,d1
00891EC4 D281                       		add.l	d1,d1
00891EC6 4841                       		swap	d1
00891EC8 4441                       		neg.w	d1
00891ECA 3141 0008                  		move.w	d1,obX(a0)
00891ECE 2238 F704                  		move.l	(v_screenposy).w,d1
00891ED2 D281                       		add.l	d1,d1
00891ED4 4841                       		swap	d1
00891ED6 0241 003F                  		andi.w	#$3F,d1
00891EDA 4441                       		neg.w	d1
00891EDC 0641 0100                  		addi.w	#$100,d1
00891EE0 3141 000A                  		move.w	d1,obScreenY(a0)
00891EE4 6000 C4E6                  		bra.w	DisplaySprite
00891EE4 6000 C4E6                  		bra.w	DisplaySprite
00891EE8                            		include	"_maps\Pylon.asm"
00891EE8                            ; ---------------------------------------------------------------------------
00891EE8                            ; Sprite mappings - metal pylons in foreground (SLZ)
00891EE8                            ; ---------------------------------------------------------------------------
00891EE8 0000                       Map_Pylon:	dc.w @pylon-Map_Pylon
00891EEA 09                         @pylon:		dc.b 9
00891EEB 800F 0000 F0               		dc.b $80, $F, 0, 0, $F0
00891EF0 A00F 1000 F0               		dc.b $A0, $F, $10, 0, $F0
00891EF5 C00F 0000 F0               		dc.b $C0, $F, 0, 0, $F0
00891EFA E00F 1000 F0               		dc.b $E0, $F, $10, 0, $F0
00891EFF 000F 0000 F0               		dc.b 0,	$F, 0, 0, $F0
00891F04 200F 1000 F0               		dc.b $20, $F, $10, 0, $F0
00891F09 400F 0000 F0               		dc.b $40, $F, 0, 0, $F0
00891F0E 600F 1000 F0               		dc.b $60, $F, $10, 0, $F0
00891F13 7F0F 0000 F0               		dc.b $7F, $F, 0, 0, $F0
00891F18                            		even
00891F18                            		even
00891F18                            
00891F18                            		include	"_incObj\1B Water Surface.asm"
00891F18                            ; ---------------------------------------------------------------------------
00891F18                            ; Object 1B - water surface (LZ)
00891F18                            ; ---------------------------------------------------------------------------
00891F18                            
00891F18                            WaterSurface:				; XREF: Obj_Index
00891F18 7000                       		moveq	#0,d0
00891F1A 1028 0024                  		move.b	obRoutine(a0),d0
00891F1E 323B 0000                  		move.w	Surf_Index(pc,d0.w),d1
00891F22 4EFB 1000                  		jmp	Surf_Index(pc,d1.w)
00891F26                            ; ===========================================================================
00891F26 0000                       Surf_Index:	dc.w Surf_Main-Surf_Index
00891F28 0000                       		dc.w Surf_Action-Surf_Index
00891F2A                            
00891F2A =00000030                  origX:		= $30		; original x-axis position
00891F2A =00000032                  freeze:		= $32		; flag to freeze animation
00891F2A                            ; ===========================================================================
00891F2A                            
00891F2A                            Surf_Main:	; Routine 0
00891F2A 5428 0024                  		addq.b	#2,obRoutine(a0)
00891F2E 217C 0000 0000 0004        		move.l	#Map_Surf,obMap(a0)
00891F36 317C C300 0002             		move.w	#$C300,obGfx(a0)
00891F3C 117C 0004 0001             		move.b	#4,obRender(a0)
00891F42 117C 0080 0019             		move.b	#$80,obActWid(a0)
00891F48 3168 0008 0030             		move.w	obX(a0),origX(a0)
00891F4E                            
00891F4E                            Surf_Action:	; Routine 2
00891F4E 3238 F700                  		move.w	(v_screenposx).w,d1
00891F52 0241 FFE0                  		andi.w	#$FFE0,d1
00891F56 D268 0030                  		add.w	origX(a0),d1
00891F5A 0838 0000 FE05             		btst	#0,(v_framebyte).w
00891F60 6700                       		beq.s	@even		; branch on even frames
00891F62 0641 0020                  		addi.w	#$20,d1
00891F66                            
00891F66                            	@even:
00891F66 3141 0008                  		move.w	d1,obX(a0)	; match	obj x-position to screen position
00891F6A 3238 F646                  		move.w	(v_waterpos1).w,d1
00891F6E 3141 000C                  		move.w	d1,obY(a0)	; match	obj y-position to water	height
00891F72 4A28 0032                  		tst.b	freeze(a0)
00891F76 6600                       		bne.s	@stopped
00891F78 0838 0007 F605             		btst	#bitStart,(v_jpadpress1).w ; is Start button pressed?
00891F7E 6700                       		beq.s	@animate	; if not, branch
00891F80 5628 001A                  		addq.b	#3,obFrame(a0)	; use different	frames
00891F84 117C 0001 0032             		move.b	#1,freeze(a0) ; stop animation
00891F8A 6000                       		bra.s	@display
00891F8C                            ; ===========================================================================
00891F8C                            
00891F8C                            @stopped:
00891F8C 4A78 F63A                  		tst.w	(f_pause).w	; is the game paused?
00891F90 6600                       		bne.s	@display	; if yes, branch
00891F92 117C 0000 0032             		move.b	#0,freeze(a0) ; resume animation
00891F98 5728 001A                  		subq.b	#3,obFrame(a0)	; use normal frames
00891F9C                            
00891F9C                            @animate:
00891F9C 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00891FA0 6A00                       		bpl.s	@display
00891FA2 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
00891FA8 5228 001A                  		addq.b	#1,obFrame(a0)
00891FAC 0C28 0003 001A             		cmpi.b	#3,obFrame(a0)
00891FB2 6500                       		bcs.s	@display
00891FB4 117C 0000 001A             		move.b	#0,obFrame(a0)
00891FBA                            
00891FBA                            @display:
00891FBA 6000 C410                  		bra.w	DisplaySprite
00891FBA 6000 C410                  		bra.w	DisplaySprite
00891FBE                            		include	"_maps\Water Surface.asm"
00891FBE                            ; ---------------------------------------------------------------------------
00891FBE                            ; Sprite mappings - water surface (LZ)
00891FBE                            ; ---------------------------------------------------------------------------
00891FBE 0000 0000                  Map_Surf:	dc.w @normal1-Map_Surf, @normal2-Map_Surf
00891FC2 0000 0000                  		dc.w @normal3-Map_Surf, @paused1-Map_Surf
00891FC6 0000 0000                  		dc.w @paused2-Map_Surf, @paused3-Map_Surf
00891FCA 03                         @normal1:	dc.b 3
00891FCB FD0D 0000 A0               		dc.b $FD, $D, 0, 0, $A0
00891FD0 FD0D 0000 E0               		dc.b $FD, $D, 0, 0, $E0
00891FD5 FD0D 0000 20               		dc.b $FD, $D, 0, 0, $20
00891FDA 03                         @normal2:	dc.b 3
00891FDB FD0D 0008 A0               		dc.b $FD, $D, 0, 8, $A0
00891FE0 FD0D 0008 E0               		dc.b $FD, $D, 0, 8, $E0
00891FE5 FD0D 0008 20               		dc.b $FD, $D, 0, 8, $20
00891FEA 03                         @normal3:	dc.b 3
00891FEB FD0D 0800 A0               		dc.b $FD, $D, 8, 0, $A0
00891FF0 FD0D 0800 E0               		dc.b $FD, $D, 8, 0, $E0
00891FF5 FD0D 0800 20               		dc.b $FD, $D, 8, 0, $20
00891FFA 06                         @paused1:	dc.b 6
00891FFB FD0D 0000 A0               		dc.b $FD, $D, 0, 0, $A0
00892000 FD0D 0000 C0               		dc.b $FD, $D, 0, 0, $C0
00892005 FD0D 0000 E0               		dc.b $FD, $D, 0, 0, $E0
0089200A FD0D 0000 00               		dc.b $FD, $D, 0, 0, 0
0089200F FD0D 0000 20               		dc.b $FD, $D, 0, 0, $20
00892014 FD0D 0000 40               		dc.b $FD, $D, 0, 0, $40
00892019 06                         @paused2:	dc.b 6
0089201A FD0D 0008 A0               		dc.b $FD, $D, 0, 8, $A0
0089201F FD0D 0008 C0               		dc.b $FD, $D, 0, 8, $C0
00892024 FD0D 0008 E0               		dc.b $FD, $D, 0, 8, $E0
00892029 FD0D 0008 00               		dc.b $FD, $D, 0, 8, 0
0089202E FD0D 0008 20               		dc.b $FD, $D, 0, 8, $20
00892033 FD0D 0008 40               		dc.b $FD, $D, 0, 8, $40
00892038 06                         @paused3:	dc.b 6
00892039 FD0D 0800 A0               		dc.b $FD, $D, 8, 0, $A0
0089203E FD0D 0800 C0               		dc.b $FD, $D, 8, 0, $C0
00892043 FD0D 0800 E0               		dc.b $FD, $D, 8, 0, $E0
00892048 FD0D 0800 00               		dc.b $FD, $D, 8, 0, 0
0089204D FD0D 0800 20               		dc.b $FD, $D, 8, 0, $20
00892052 FD0D 0800 40               		dc.b $FD, $D, 8, 0, $40
00892058 00                         		even
00892058 00                         		even
00892058                            		include	"_incObj\0B Pole that Breaks.asm"
00892058                            ; ---------------------------------------------------------------------------
00892058                            ; Object 0B - pole that	breaks (LZ)
00892058                            ; ---------------------------------------------------------------------------
00892058                            
00892058                            Pole:					; XREF: Obj_Index
00892058 7000                       		moveq	#0,d0
0089205A 1028 0024                  		move.b	obRoutine(a0),d0
0089205E 323B 0000                  		move.w	Pole_Index(pc,d0.w),d1
00892062 4EFB 1000                  		jmp	Pole_Index(pc,d1.w)
00892066                            ; ===========================================================================
00892066 0000                       Pole_Index:	dc.w Pole_Main-Pole_Index
00892068 0000                       		dc.w Pole_Action-Pole_Index
0089206A 0000                       		dc.w Pole_Display-Pole_Index
0089206C                            
0089206C =00000030                  pole_time:	= $30		; time between grabbing the pole & breaking
0089206C =00000032                  pole_grabbed:	= $32		; flag set when Sonic grabs the pole
0089206C                            ; ===========================================================================
0089206C                            
0089206C                            Pole_Main:	; Routine 0
0089206C 5428 0024                  		addq.b	#2,obRoutine(a0)
00892070 217C 0000 0000 0004        		move.l	#Map_Pole,obMap(a0)
00892078 317C 43DE 0002             		move.w	#$43DE,obGfx(a0)
0089207E 117C 0004 0001             		move.b	#4,obRender(a0)
00892084 117C 0008 0019             		move.b	#8,obActWid(a0)
0089208A 117C 0004 0018             		move.b	#4,obPriority(a0)
00892090 117C 00E1 0020             		move.b	#$E1,obColType(a0)
00892096 7000                       		moveq	#0,d0
00892098 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
0089209C C0FC 003C                  		mulu.w	#60,d0		; multiply by 60 (1 second)
008920A0 3140 0030                  		move.w	d0,pole_time(a0) ; set breakage time
008920A4                            
008920A4                            Pole_Action:	; Routine 2
008920A4 4A28 0032                  		tst.b	pole_grabbed(a0) ; has pole already been grabbed?
008920A8 6700                       		beq.s	@grab		; if not, branch
008920AA 4A68 0030                  		tst.w	pole_time(a0)
008920AE 6700                       		beq.s	@moveup
008920B0 5368 0030                  		subq.w	#1,pole_time(a0) ; decrement time until break
008920B4 6600                       		bne.s	@moveup
008920B6 117C 0001 001A             		move.b	#1,obFrame(a0)	; break	the pole
008920BC 6000                       		bra.s	@release
008920BE                            ; ===========================================================================
008920BE                            
008920BE                            @moveup:
008920BE 43F8 D000                  		lea	(v_player).w,a1
008920C2 3028 000C                  		move.w	obY(a0),d0
008920C6 0440 0018                  		subi.w	#$18,d0
008920CA 0838 0000 F604             		btst	#bitUp,(v_jpadhold1).w ; is "up" pressed?
008920D0 6700                       		beq.s	@movedown	; if not, branch
008920D2 5369 000C                  		subq.w	#1,obY(a1)	; move Sonic up
008920D6 B069 000C                  		cmp.w	obY(a1),d0
008920DA 6500                       		bcs.s	@movedown
008920DC 3340 000C                  		move.w	d0,obY(a1)
008920E0                            
008920E0                            @movedown:
008920E0 0640 0024                  		addi.w	#$24,d0
008920E4 0838 0001 F604             		btst	#bitDn,(v_jpadhold1).w ; is "down" pressed?
008920EA 6700                       		beq.s	@letgo		; if not, branch
008920EC 5269 000C                  		addq.w	#1,obY(a1)	; move Sonic down
008920F0 B069 000C                  		cmp.w	obY(a1),d0
008920F4 6400                       		bcc.s	@letgo
008920F6 3340 000C                  		move.w	d0,obY(a1)
008920FA                            
008920FA                            @letgo:
008920FA 1038 F603                  		move.b	(v_jpadpress2).w,d0
008920FE 0240 0070                  		andi.w	#btnABC,d0	; is A/B/C pressed?
00892102 6700                       		beq.s	Pole_Display	; if not, branch
00892104                            
00892104                            @release:
00892104 4228 0020                  		clr.b	obColType(a0)
00892108 5428 0024                  		addq.b	#2,obRoutine(a0) ; goto Pole_Display next
0089210C 4238 F7C8                  		clr.b	(f_lockmulti).w
00892110 4238 F7C9                  		clr.b	(f_wtunnelallow).w
00892114 4228 0032                  		clr.b	pole_grabbed(a0)
00892118 6000                       		bra.s	Pole_Display
0089211A                            ; ===========================================================================
0089211A                            
0089211A                            @grab:
0089211A 4A28 0021                  		tst.b	obColProp(a0)	; has Sonic touched the	pole?
0089211E 6700                       		beq.s	Pole_Display	; if not, branch
00892120 43F8 D000                  		lea	(v_player).w,a1
00892124 3028 0008                  		move.w	obX(a0),d0
00892128 0640 0014                  		addi.w	#$14,d0
0089212C B069 0008                  		cmp.w	obX(a1),d0
00892130 6400                       		bcc.s	Pole_Display
00892132 4228 0021                  		clr.b	obColProp(a0)
00892136 0C29 0004 0024             		cmpi.b	#4,obRoutine(a1)
0089213C 6400                       		bcc.s	Pole_Display
0089213E 4269 0010                  		clr.w	obVelX(a1)	; stop Sonic moving
00892142 4269 0012                  		clr.w	obVelY(a1)	; stop Sonic moving
00892146 3028 0008                  		move.w	obX(a0),d0
0089214A 0640 0014                  		addi.w	#$14,d0
0089214E 3340 0008                  		move.w	d0,obX(a1)
00892152 08A9 0000 0022             		bclr	#0,obStatus(a1)
00892158 137C 0000 001C             		move.b	#id_Hang,obAnim(a1) ; set Sonic's animation to "hanging" ($11)
0089215E 11FC 0001 F7C8             		move.b	#1,(f_lockmulti).w ; lock controls
00892164 11FC 0001 F7C9             		move.b	#1,(f_wtunnelallow).w ; disable wind tunnel
0089216A 117C 0001 0032             		move.b	#1,pole_grabbed(a0) ; begin countdown to breakage
00892170                            
00892170                            Pole_Display:	; Routine 4
00892170 6000 E31A                  		bra.w	RememberState
00892170 6000 E31A                  		bra.w	RememberState
00892174                            		include	"_maps\Pole that Breaks.asm"
00892174                            ; ---------------------------------------------------------------------------
00892174                            ; Sprite mappings - pole that breaks (LZ)
00892174                            ; ---------------------------------------------------------------------------
00892174 0000                       Map_Pole:	dc.w @normal-Map_Pole
00892176 0000                       		dc.w @broken-Map_Pole
00892178 02                         @normal:	dc.b 2			; normal pole
00892179 E003 0000 FC               		dc.b $E0, 3, 0,	0, $FC
0089217E 0003 1000 FC               		dc.b 0,	3, $10,	0, $FC
00892183 04                         @broken:	dc.b 4			; broken pole
00892184 E001 0000 FC               		dc.b $E0, 1, 0,	0, $FC
00892189 F005 0004 FC               		dc.b $F0, 5, 0,	4, $FC
0089218E 0005 1004 FC               		dc.b 0,	5, $10,	4, $FC
00892193 1001 1000 FC               		dc.b $10, 1, $10, 0, $FC
00892198                            		even
00892198                            		even
00892198                            		include	"_incObj\0C Flapping Door.asm"
00892198                            ; ---------------------------------------------------------------------------
00892198                            ; Object 0C - flapping door (LZ)
00892198                            ; ---------------------------------------------------------------------------
00892198                            
00892198                            FlapDoor:				; XREF: Obj_Index
00892198 7000                       		moveq	#0,d0
0089219A 1028 0024                  		move.b	obRoutine(a0),d0
0089219E 323B 0000                  		move.w	Flap_Index(pc,d0.w),d1
008921A2 4EFB 1000                  		jmp	Flap_Index(pc,d1.w)
008921A6                            ; ===========================================================================
008921A6 0000                       Flap_Index:	dc.w Flap_Main-Flap_Index
008921A8 0000                       		dc.w Flap_OpenClose-Flap_Index
008921AA                            
008921AA =00000032                  flap_time:	= $32		; time between opening/closing
008921AA =00000030                  flap_wait:	= $30		; time until change
008921AA                            ; ===========================================================================
008921AA                            
008921AA                            Flap_Main:	; Routine 0
008921AA 5428 0024                  		addq.b	#2,obRoutine(a0)
008921AE 217C 0000 0000 0004        		move.l	#Map_Flap,obMap(a0)
008921B6 317C 4328 0002             		move.w	#$4328,obGfx(a0)
008921BC 0028 0004 0001             		ori.b	#4,obRender(a0)
008921C2 117C 0028 0019             		move.b	#$28,obActWid(a0)
008921C8 7000                       		moveq	#0,d0
008921CA 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
008921CE C0FC 003C                  		mulu.w	#60,d0		; multiply by 60 (1 second)
008921D2 3140 0032                  		move.w	d0,flap_time(a0) ; set flap delay time
008921D6                            
008921D6                            Flap_OpenClose:	; Routine 2
008921D6 5368 0030                  		subq.w	#1,flap_wait(a0) ; decrement time delay
008921DA 6A00                       		bpl.s	@wait		; if time remains, branch
008921DC 3168 0032 0030             		move.w	flap_time(a0),flap_wait(a0) ; reset time delay
008921E2 0868 0000 001C             		bchg	#0,obAnim(a0)	; open/close door
008921E8 4A28 0001                  		tst.b	obRender(a0)
008921EC 6A00                       		bpl.s	@nosound
008921F8                            
008921F8                            	@wait:
008921F8                            	@nosound:
008921F8 43F9 0000 0000             		lea	(Ani_Flap).l,a1
008921FE 6100 92B0                  		bsr.w	AnimateSprite
00892202 4238 F7C9                  		clr.b	(f_wtunnelallow).w ; enable wind tunnel
00892206 4A28 001A                  		tst.b	obFrame(a0)	; is the door open?
0089220A 6600                       		bne.s	@display	; if yes, branch
0089220C 3038 D008                  		move.w	(v_player+obX).w,d0
00892210 B068 0008                  		cmp.w	obX(a0),d0	; has Sonic passed through the door?
00892214 6400                       		bcc.s	@display	; if yes, branch
00892216 11FC 0001 F7C9             		move.b	#1,(f_wtunnelallow).w ; disable wind tunnel
0089221C 323C 0013                  		move.w	#$13,d1
00892220 343C 0020                  		move.w	#$20,d2
00892224 3602                       		move.w	d2,d3
00892226 5243                       		addq.w	#1,d3
00892228 3828 0008                  		move.w	obX(a0),d4
0089222C 6100 E588                  		bsr.w	SolidObject	; make the door	solid
00892230                            
00892230                            	@display:
00892230 6000 E25A                  		bra.w	RememberState
00892230 6000 E25A                  		bra.w	RememberState
00892234                            		include	"_anim\Flapping Door.asm"
00892234                            ; ---------------------------------------------------------------------------
00892234                            ; Animation script - flapping door (LZ)
00892234                            ; ---------------------------------------------------------------------------
00892234 0000                       Ani_Flap:	dc.w @opening-Ani_Flap
00892236 0000                       		dc.w @closing-Ani_Flap
00892238 0300 0102 FE01             @opening:	dc.b 3,	0, 1, 2, afBack, 1
0089223E 0302 0100 FE01             @closing:	dc.b 3,	2, 1, 0, afBack, 1
00892244                            		even
00892244                            		even
00892244                            		include	"_maps\Flapping Door.asm"
00892244                            ; ---------------------------------------------------------------------------
00892244                            ; Sprite mappings - flapping door (LZ)
00892244                            ; ---------------------------------------------------------------------------
00892244 0000                       Map_Flap:	dc.w @closed-Map_Flap
00892246 0000                       		dc.w @halfway-Map_Flap
00892248 0000                       		dc.w @open-Map_Flap
0089224A 02                         @closed:	dc.b 2
0089224B E007 0000 F8               		dc.b $E0, 7, 0,	0, $F8
00892250 0007 1000 F8               		dc.b 0,	7, $10,	0, $F8
00892255 02                         @halfway:	dc.b 2
00892256 DA0F 0008 FB               		dc.b $DA, $F, 0, 8, $FB
0089225B 060F 1008 FB               		dc.b 6,	$F, $10, 8, $FB
00892260 02                         @open:		dc.b 2
00892261 D80D 0018 00               		dc.b $D8, $D, 0, $18, 0
00892266 180D 1018 00               		dc.b $18, $D, $10, $18,	0
0089226C 00                         		even
0089226C 00                         		even
0089226C                            
0089226C                            		include	"_incObj\71 Invisible Barriers.asm"
0089226C                            ; ---------------------------------------------------------------------------
0089226C                            ; Object 71 - invisible	solid barriers
0089226C                            ; ---------------------------------------------------------------------------
0089226C                            
0089226C                            Invisibarrier:				; XREF: Obj_Index
0089226C 7000                       		moveq	#0,d0
0089226E 1028 0024                  		move.b	obRoutine(a0),d0
00892272 323B 0000                  		move.w	Invis_Index(pc,d0.w),d1
00892276 4EFB 1000                  		jmp	Invis_Index(pc,d1.w)
0089227A                            ; ===========================================================================
0089227A 0000                       Invis_Index:	dc.w Invis_Main-Invis_Index
0089227C 0000                       		dc.w Invis_Solid-Invis_Index
0089227E                            
0089227E =00000016                  invis_height:	= $16		; height in pixels
0089227E                            ; ===========================================================================
0089227E                            
0089227E                            Invis_Main:	; Routine 0
0089227E 5428 0024                  		addq.b	#2,obRoutine(a0)
00892282 217C 0000 0000 0004        		move.l	#Map_Invis,obMap(a0)
0089228A 317C 8680 0002             		move.w	#$8680,obGfx(a0)
00892290 0028 0004 0001             		ori.b	#4,obRender(a0)
00892296 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
0089229A 1200                       		move.b	d0,d1
0089229C 0240 00F0                  		andi.w	#$F0,d0		; read only the	1st byte
008922A0 0640 0010                  		addi.w	#$10,d0
008922A4 E248                       		lsr.w	#1,d0
008922A6 1140 0019                  		move.b	d0,obActWid(a0)	; set object width
008922AA 0241 000F                  		andi.w	#$F,d1		; read only the	2nd byte
008922AE 5241                       		addq.w	#1,d1
008922B0 E749                       		lsl.w	#3,d1
008922B2 1141 0016                  		move.b	d1,invis_height(a0) ; set object height
008922B6                            
008922B6                            Invis_Solid:	; Routine 2
008922B6 6100 C38E                  		bsr.w	ChkObjectVisible
008922BA 6600                       		bne.s	@chkdel
008922BC 7200                       		moveq	#0,d1
008922BE 1228 0019                  		move.b	obActWid(a0),d1
008922C2 0641 000B                  		addi.w	#$B,d1
008922C6 7400                       		moveq	#0,d2
008922C8 1428 0016                  		move.b	invis_height(a0),d2
008922CC 3602                       		move.w	d2,d3
008922CE 5243                       		addq.w	#1,d3
008922D0 3828 0008                  		move.w	obX(a0),d4
008922D4 6100 E528                  		bsr.w	SolidObject71
008922D8                            
008922D8                            @chkdel:
008922F4 4A78 FE08                  		tst.w	(v_debuguse).w	; are you using	debug mode?
008922F8 6700                       		beq.s	@nodisplay	; if not, branch
008922FA 4EF9 0088 E3CC             		jmp	DisplaySprite	; if yes, display the object
00892300                            
00892300                            	@nodisplay:
00892300 4E75                       		rts	
00892302                            
00892302                            	@delete:
00892302 4EF9 0088 E408             		jmp	DeleteObject
00892302 4EF9 0088 E408             		jmp	DeleteObject
00892308                            		include	"_maps\Invisible Barriers.asm"
00892308                            ; ---------------------------------------------------------------------------
00892308                            ; Sprite mappings - invisible solid blocks
00892308                            ; ---------------------------------------------------------------------------
00892308 0000                       Map_Invis:	dc.w @solid-Map_Invis
0089230A 0000                       		dc.w @unused1-Map_Invis
0089230C 0000                       		dc.w @unused2-Map_Invis
0089230E 04                         @solid:		dc.b 4
0089230F F005 0018 F0               		dc.b $F0, 5, 0,	$18, $F0
00892314 F005 0018 00               		dc.b $F0, 5, 0,	$18, 0
00892319 0005 0018 F0               		dc.b 0,	5, 0, $18, $F0
0089231E 0005 0018 00               		dc.b 0,	5, 0, $18, 0
00892323 04                         @unused1:	dc.b 4
00892324 E005 0018 C0               		dc.b $E0, 5, 0,	$18, $C0
00892329 E005 0018 30               		dc.b $E0, 5, 0,	$18, $30
0089232E 1005 0018 C0               		dc.b $10, 5, 0,	$18, $C0
00892333 1005 0018 30               		dc.b $10, 5, 0,	$18, $30
00892338 04                         @unused2:	dc.b 4
00892339 E005 0018 80               		dc.b $E0, 5, 0,	$18, $80
0089233E E005 0018 70               		dc.b $E0, 5, 0,	$18, $70
00892343 1005 0018 80               		dc.b $10, 5, 0,	$18, $80
00892348 1005 0018 70               		dc.b $10, 5, 0,	$18, $70
0089234E 00                         		even
0089234E 00                         		even
0089234E                            
0089234E                            		include	"_incObj\5D Fan.asm"
0089234E                            ; ---------------------------------------------------------------------------
0089234E                            ; Object 5D - fans (SLZ)
0089234E                            ; ---------------------------------------------------------------------------
0089234E                            
0089234E                            Fan:					; XREF: Obj_Index
0089234E 7000                       		moveq	#0,d0
00892350 1028 0024                  		move.b	obRoutine(a0),d0
00892354 323B 0000                  		move.w	Fan_Index(pc,d0.w),d1
00892358 4EFB 1000                  		jmp	Fan_Index(pc,d1.w)
0089235C                            ; ===========================================================================
0089235C 0000                       Fan_Index:	dc.w Fan_Main-Fan_Index
0089235E 0000                       		dc.w Fan_Delay-Fan_Index
00892360                            
00892360 =00000030                  fan_time:	= $30		; time between switching on/off
00892360 =00000032                  fan_switch:	= $32		; on/off switch
00892360                            ; ===========================================================================
00892360                            
00892360                            Fan_Main:	; Routine 0
00892360 5428 0024                  		addq.b	#2,obRoutine(a0)
00892364 217C 0000 0000 0004        		move.l	#Map_Fan,obMap(a0)
0089236C 317C 43A0 0002             		move.w	#$43A0,obGfx(a0)
00892372 0028 0004 0001             		ori.b	#4,obRender(a0)
00892378 117C 0010 0019             		move.b	#$10,obActWid(a0)
0089237E 117C 0004 0018             		move.b	#4,obPriority(a0)
00892384                            
00892384                            Fan_Delay:	; Routine 2
00892384 0828 0001 0028             		btst	#1,obSubtype(a0) ; is object type 02/03 (always on)?
0089238A 6600                       		bne.s	@blow		; if yes, branch
0089238C 5368 0030                  		subq.w	#1,fan_time(a0)	; subtract 1 from time delay
00892390 6A00                       		bpl.s	@blow		; if time remains, branch
00892392 317C 0078 0030             		move.w	#120,fan_time(a0) ; set delay to 2 seconds
00892398 0868 0000 0032             		bchg	#0,fan_switch(a0) ; switch fan on/off
0089239E 6700                       		beq.s	@blow		; if fan is off, branch
008923A0 317C 00B4 0030             		move.w	#180,fan_time(a0) ; set delay to 3 seconds
008923A6                            
008923A6                            @blow:
008923A6 4A28 0032                  		tst.b	fan_switch(a0)	; is fan switched on?
008923AA 6600 0000                  		bne.w	@chkdel		; if not, branch
008923AE 43F8 D000                  		lea	(v_player).w,a1
008923B2 3029 0008                  		move.w	obX(a1),d0
008923B6 9068 0008                  		sub.w	obX(a0),d0
008923BA 0828 0000 0022             		btst	#0,obStatus(a0)	; is fan facing right?
008923C0 6600                       		bne.s	@chksonic	; if yes, branch
008923C2 4440                       		neg.w	d0
008923C4                            
008923C4                            @chksonic:
008923C4 0640 0050                  		addi.w	#$50,d0
008923C8 0C40 00F0                  		cmpi.w	#$F0,d0		; is Sonic more	than $A0 pixels	from the fan?
008923CC 6400                       		bcc.s	@animate	; if yes, branch
008923CE 3229 000C                  		move.w	obY(a1),d1
008923D2 0641 0060                  		addi.w	#$60,d1
008923D6 9268 000C                  		sub.w	obY(a0),d1
008923DA 6500                       		bcs.s	@animate	; branch if Sonic is too low
008923DC 0C41 0070                  		cmpi.w	#$70,d1
008923E0 6400                       		bcc.s	@animate	; branch if Sonic is too high
008923E2 0440 0050                  		subi.w	#$50,d0		; is Sonic more than $50 pixels from the fan?
008923E6 6400                       		bcc.s	@faraway	; if yes, branch
008923E8 4640                       		not.w	d0
008923EA D040                       		add.w	d0,d0
008923EC                            
008923EC                            	@faraway:
008923EC 0640 0060                  		addi.w	#$60,d0
008923F0 0828 0000 0022             		btst	#0,obStatus(a0)	; is fan facing right?
008923F6 6600                       		bne.s	@right		; if yes, branch
008923F8 4440                       		neg.w	d0
008923FA                            
008923FA                            	@right:
008923FA 4400                       		neg.b	d0
008923FC E840                       		asr.w	#4,d0
008923FE 0828 0000 0028             		btst	#0,obSubtype(a0)
00892404 6700                       		beq.s	@movesonic
00892406 4440                       		neg.w	d0
00892408                            
00892408                            	@movesonic:
00892408 D169 0008                  		add.w	d0,obX(a1)	; push Sonic away from the fan
0089240C                            		
0089240C 4238 FEB3                  		clr.b	(v_cameralag).w
00892410                            		
00892410                            @animate:
00892410 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00892414 6A00                       		bpl.s	@chkdel
00892416 117C 0000 001E             		move.b	#0,obTimeFrame(a0)
0089241C 5228 001B                  		addq.b	#1,obAniFrame(a0)
00892420 0C28 0003 001B             		cmpi.b	#3,obAniFrame(a0)
00892426 6500                       		bcs.s	@noreset
00892428 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; reset after 4 frames
0089242E                            
0089242E                            	@noreset:
0089242E 7000                       		moveq	#0,d0
00892430 0828 0000 0028             		btst	#0,obSubtype(a0)
00892436 6700                       		beq.s	@noflip
00892438 7002                       		moveq	#2,d0
0089243A                            
0089243A                            	@noflip:
0089243A D028 001B                  		add.b	obAniFrame(a0),d0
0089243E 1140 001A                  		move.b	d0,obFrame(a0)
00892442                            
00892442                            @chkdel:
00892442 6100 BF88                  		bsr.w	DisplaySprite
00892464 4E75                       		rts	
00892464 4E75                       		rts	
00892466                            		include	"_maps\Fan.asm"
00892466                            ; ---------------------------------------------------------------------------
00892466                            ; Sprite mappings - fans (SLZ)
00892466                            ; ---------------------------------------------------------------------------
00892466 0000 0000                  Map_Fan:	dc.w @fan1-Map_Fan, @fan2-Map_Fan
0089246A 0000 0000                  		dc.w @fan3-Map_Fan, @fan2-Map_Fan
0089246E 0000                       		dc.w @fan1-Map_Fan
00892470 02                         @fan1:		dc.b 2
00892471 F009 0000 F8               		dc.b $F0, 9, 0,	0, $F8
00892476 000D 0006 F0               		dc.b 0,	$D, 0, 6, $F0
0089247B 02                         @fan2:		dc.b 2
0089247C F00D 000E F0               		dc.b $F0, $D, 0, $E, $F0
00892481 000D 0016 F0               		dc.b 0,	$D, 0, $16, $F0
00892486 02                         @fan3:		dc.b 2
00892487 F00D 001E F0               		dc.b $F0, $D, 0, $1E, $F0
0089248C 0009 0026 F8               		dc.b 0,	9, 0, $26, $F8
00892492 00                         		even
00892492 00                         		even
00892492                            		include	"_incObj\5E Seesaw.asm"
00892492                            ; ---------------------------------------------------------------------------
00892492                            ; Object 5E - seesaws (SLZ)
00892492                            ; ---------------------------------------------------------------------------
00892492 =00000030                  see_origX:	= $30		; original x-axis position
00892492 =00000034                  see_origY:	= $34		; original y-axis position
00892492 =00000038                  see_speed:	= $38		; speed of collision
00892492 =0000003A                  see_frame:	= $3A		; 
00892492 =0000003C                  see_parent:	= $3C		; RAM address of parent object
00892492                            
00892492                            Seesaw:					; XREF: Obj_Index
00892492 7000                       		moveq	#0,d0
00892494 1028 0024                  		move.b	obRoutine(a0),d0
00892498 323B 0000                  		move.w	See_Index(pc,d0.w),d1
0089249C 4EBB 1000                  		jsr	See_Index(pc,d1.w)
008924A0 3028 0030                  		move.w	see_origX(a0),d0
008924A4 0240 FF80                  		andi.w	#$FF80,d0
008924A8 3238 F700                  		move.w	(v_screenposx).w,d1
008924AC 0441 0080                  		subi.w	#$80,d1
008924B0 0241 FF80                  		andi.w	#$FF80,d1
008924B4 9041                       		sub.w	d1,d0
008924B6 6B00 BF50                  		bmi.w	DeleteObject
008924BA 0C40 0280                  		cmpi.w	#$280,d0
008924BE 6200 BF48                  		bhi.w	DeleteObject
008924C2 6000 BF08                  		bra.w	DisplaySprite
008924C6                            ; ===========================================================================
008924C6 0000                       See_Index:	dc.w See_Main-See_Index
008924C8 0000                       		dc.w See_Slope-See_Index
008924CA 0000                       		dc.w See_Slope2-See_Index
008924CC 0000                       		dc.w See_Spikeball-See_Index
008924CE 0000                       		dc.w See_MoveSpike-See_Index
008924D0 0000                       		dc.w See_SpikeFall-See_Index
008924D2                            ; ===========================================================================
008924D2                            
008924D2                            See_Main:	; Routine 0
008924D2 5428 0024                  		addq.b	#2,obRoutine(a0)
008924D6 217C 0000 0000 0004        		move.l	#Map_Seesaw,obMap(a0)
008924DE 317C 0374 0002             		move.w	#$374,obGfx(a0)
008924E4 0028 0004 0001             		ori.b	#4,obRender(a0)
008924EA 117C 0004 0018             		move.b	#4,obPriority(a0)
008924F0 117C 0030 0019             		move.b	#$30,obActWid(a0)
008924F6 3168 0008 0030             		move.w	obX(a0),see_origX(a0)
008924FC 4A28 0028                  		tst.b	obSubtype(a0)	; is object type 00 ?
00892500 6600                       		bne.s	@noball		; if not, branch
00892502                            
00892502 6100 C374                  		bsr.w	FindNextFreeObj
00892506 6600                       		bne.s	@noball
00892508 137C 005E 0000             		move.b	#id_Seesaw,0(a1) ; load spikeball object
0089250E 5C29 0024                  		addq.b	#6,obRoutine(a1) ; use See_Spikeball routine
00892512 3368 0008 0008             		move.w	obX(a0),obX(a1)
00892518 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089251E 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
00892524 2348 003C                  		move.l	a0,see_parent(a1)
00892528                            
00892528                            	@noball:
00892528 0828 0000 0022             		btst	#0,obStatus(a0)	; is seesaw flipped?
0089252E 6700                       		beq.s	@noflip		; if not, branch
00892530 117C 0002 001A             		move.b	#2,obFrame(a0)	; use different frame
00892536                            
00892536                            	@noflip:
00892536 1168 001A 003A             		move.b	obFrame(a0),see_frame(a0)
0089253C                            
0089253C                            See_Slope:	; Routine 2
0089253C 1228 003A                  		move.b	see_frame(a0),d1
00892540 6100 0000                  		bsr.w	See_ChgFrame
00892544 45F9 0000 0000             		lea	(See_DataSlope).l,a2
0089254A 0828 0000 001A             		btst	#0,obFrame(a0)	; is seesaw flat?
00892550 6700                       		beq.s	@notflat	; if not, branch
00892552 45F9 0000 0000             		lea	(See_DataFlat).l,a2
00892558                            
00892558                            	@notflat:
00892558 43F8 D000                  		lea	(v_player).w,a1
0089255C 3169 0012 0038             		move.w	obVelY(a1),see_speed(a0)
00892562 323C 0030                  		move.w	#$30,d1
00892566 4EB9 0088 8154             		jsr	SlopeObject.L
0089256C 4E75                       		rts	
0089256E                            ; ===========================================================================
0089256E                            
0089256E                            See_Slope2:	; Routine 4
0089256E 6100 0000                  		bsr.w	See_ChkSide
00892572 45F9 0000 0000             		lea	(See_DataSlope).l,a2
00892578 0828 0000 001A             		btst	#0,obFrame(a0)	; is seesaw flat?
0089257E 6700                       		beq.s	@notflat	; if not, branch
00892580 45F9 0000 0000             		lea	(See_DataFlat).l,a2
00892586                            
00892586                            	@notflat:
00892586 323C 0030                  		move.w	#$30,d1
0089258A 4EB9 0088 81F4             		jsr	(ExitPlatform).l
00892590 323C 0030                  		move.w	#$30,d1
00892594 3428 0008                  		move.w	obX(a0),d2
00892598 4EB9 0088 915E             		jsr	SlopeObject2
0089259E 4E75                       		rts	
008925A0                            ; ===========================================================================
008925A0                            
008925A0                            See_ChkSide:
008925A0 7202                       		moveq	#2,d1
008925A2 43F8 D000                  		lea	(v_player).w,a1
008925A6 3028 0008                  		move.w	obX(a0),d0
008925AA 9069 0008                  		sub.w	obX(a1),d0	; is Sonic on the left side of the seesaw?
008925AE 6400                       		bcc.s	@leftside	; if yes, branch
008925B0 4440                       		neg.w	d0
008925B2 7200                       		moveq	#0,d1
008925B4                            
008925B4                            	@leftside:
008925B4 0C40 0008                  		cmpi.w	#8,d0
008925B8 6400                       		bcc.s	See_ChgFrame
008925BA 7201                       		moveq	#1,d1
008925BC                            
008925BC                            See_ChgFrame:
008925BC 1028 001A                  		move.b	obFrame(a0),d0
008925C0 B001                       		cmp.b	d1,d0		; does frame need to change?
008925C2 6700                       		beq.s	@noflip		; if not, branch
008925C4 6400                       		bcc.s	@loc_11772
008925C6 5400                       		addq.b	#2,d0
008925C8                            
008925C8                            	@loc_11772:
008925C8 5300                       		subq.b	#1,d0
008925CA 1140 001A                  		move.b	d0,obFrame(a0)
008925CE 1141 003A                  		move.b	d1,see_frame(a0)
008925D2 08A8 0000 0001             		bclr	#0,obRender(a0)
008925D8 0828 0001 001A             		btst	#1,obFrame(a0)
008925DE 6700                       		beq.s	@noflip
008925E0 08E8 0000 0001             		bset	#0,obRender(a0)
008925E6                            
008925E6                            	@noflip:
008925E6 4E75                       		rts	
008925E8                            ; ===========================================================================
008925E8                            
008925E8                            See_Spikeball:	; Routine 6
008925E8 5428 0024                  		addq.b	#2,obRoutine(a0)
008925EC 217C 0000 0000 0004        		move.l	#Map_SSawBall,obMap(a0)
008925F4 317C 04F0 0002             		move.w	#$4F0,obGfx(a0)
008925FA 0028 0004 0001             		ori.b	#4,obRender(a0)
00892600 117C 0004 0018             		move.b	#4,obPriority(a0)
00892606 117C 008B 0020             		move.b	#$8B,obColType(a0)
0089260C 117C 000C 0019             		move.b	#$C,obActWid(a0)
00892612 3168 0008 0030             		move.w	obX(a0),see_origX(a0)
00892618 0668 0028 0008             		addi.w	#$28,obX(a0)
0089261E 3168 000C 0034             		move.w	obY(a0),see_origY(a0)
00892624 117C 0001 001A             		move.b	#1,obFrame(a0)
0089262A 0828 0000 0022             		btst	#0,obStatus(a0)	; is seesaw flipped?
00892630 6700                       		beq.s	See_MoveSpike	; if not, branch
00892632 0468 0050 0008             		subi.w	#$50,obX(a0)	; move spikeball to the other side
00892638 117C 0002 003A             		move.b	#2,see_frame(a0)
0089263E                            
0089263E                            See_MoveSpike:	; Routine 8
0089263E 2268 003C                  		movea.l	see_parent(a0),a1
00892642 7000                       		moveq	#0,d0
00892644 1028 003A                  		move.b	see_frame(a0),d0
00892648 9029 003A                  		sub.b	see_frame(a1),d0
0089264C 6700                       		beq.s	loc_1183E
0089264E 6400                       		bcc.s	loc_117FC
00892650 4400                       		neg.b	d0
00892652                            
00892652                            loc_117FC:
00892652 323C F7E8                  		move.w	#-$818,d1
00892656 343C FEEC                  		move.w	#-$114,d2
0089265A 0C00 0001                  		cmpi.b	#1,d0
0089265E 6700                       		beq.s	loc_11822
00892660 323C F510                  		move.w	#-$AF0,d1
00892664 343C FF34                  		move.w	#-$CC,d2
00892668 0C69 0A00 0038             		cmpi.w	#$A00,$38(a1)
0089266E 6D00                       		blt.s	loc_11822
00892670 323C F200                  		move.w	#-$E00,d1
00892674 343C FF60                  		move.w	#-$A0,d2
00892678                            
00892678                            loc_11822:
00892678 3141 0012                  		move.w	d1,obVelY(a0)
0089267C 3142 0010                  		move.w	d2,obVelX(a0)
00892680 3028 0008                  		move.w	obX(a0),d0
00892684 9068 0030                  		sub.w	see_origX(a0),d0
00892688 6400                       		bcc.s	loc_11838
0089268A 4468 0010                  		neg.w	obVelX(a0)
0089268E                            
0089268E                            loc_11838:
0089268E 5428 0024                  		addq.b	#2,obRoutine(a0)
00892692 6000                       		bra.s	See_SpikeFall
00892694                            ; ===========================================================================
00892694                            
00892694                            loc_1183E:				; XREF: See_MoveSpike
00892694 45F9 0000 0000             		lea	(See_Speeds).l,a2
0089269A 7000                       		moveq	#0,d0
0089269C 1029 001A                  		move.b	obFrame(a1),d0
008926A0 343C 0028                  		move.w	#$28,d2
008926A4 3228 0008                  		move.w	obX(a0),d1
008926A8 9268 0030                  		sub.w	see_origX(a0),d1
008926AC 6400                       		bcc.s	loc_1185C
008926AE 4442                       		neg.w	d2
008926B0 5440                       		addq.w	#2,d0
008926B2                            
008926B2                            loc_1185C:
008926B2 D040                       		add.w	d0,d0
008926B4 3228 0034                  		move.w	see_origY(a0),d1
008926B8 D272 0000                  		add.w	(a2,d0.w),d1
008926BC 3141 000C                  		move.w	d1,obY(a0)
008926C0 D468 0030                  		add.w	see_origX(a0),d2
008926C4 3142 0008                  		move.w	d2,obX(a0)
008926C8 4268 000E                  		clr.w	obY+2(a0)
008926CC 4268 000A                  		clr.w	obX+2(a0)
008926D0 4E75                       		rts	
008926D2                            ; ===========================================================================
008926D2                            
008926D2                            See_SpikeFall:	; Routine $A
008926D2 4A68 0012                  		tst.w	obVelY(a0)	; is spikeball falling down?
008926D6 6A00                       		bpl.s	loc_1189A	; if yes, branch
008926D8 6100 BCB8                  		bsr.w	ObjectMoveAndFall
008926DC 3028 0034                  		move.w	see_origY(a0),d0
008926E0 0440 002F                  		subi.w	#$2F,d0
008926E4 B068 000C                  		cmp.w	obY(a0),d0
008926E8 6E00                       		bgt.s	locret_11898
008926EA 6100 BCA6                  		bsr.w	ObjectMoveAndFall
008926EE                            
008926EE                            locret_11898:
008926EE 4E75                       		rts	
008926F0                            ; ===========================================================================
008926F0                            
008926F0                            loc_1189A:				; XREF: See_SpikeFall
008926F0 6100 BCA0                  		bsr.w	ObjectMoveAndFall
008926F4 2268 003C                  		movea.l	see_parent(a0),a1
008926F8 45F9 0000 0000             		lea	(See_Speeds).l,a2
008926FE 7000                       		moveq	#0,d0
00892700 1029 001A                  		move.b	obFrame(a1),d0
00892704 3228 0008                  		move.w	obX(a0),d1
00892708 9268 0030                  		sub.w	see_origX(a0),d1
0089270C 6400                       		bcc.s	loc_118BA
0089270E 5440                       		addq.w	#2,d0
00892710                            
00892710                            loc_118BA:
00892710 D040                       		add.w	d0,d0
00892712 3228 0034                  		move.w	see_origY(a0),d1
00892716 D272 0000                  		add.w	(a2,d0.w),d1
0089271A B268 000C                  		cmp.w	obY(a0),d1
0089271E 6E00                       		bgt.s	locret_11938
00892720 2268 003C                  		movea.l	see_parent(a0),a1
00892724 7202                       		moveq	#2,d1
00892726 4A68 0010                  		tst.w	obVelX(a0)
0089272A 6B00                       		bmi.s	See_Spring
0089272C 7200                       		moveq	#0,d1
0089272E                            
0089272E                            See_Spring:
0089272E 1341 003A                  		move.b	d1,$3A(a1)
00892732 1141 003A                  		move.b	d1,see_frame(a0)
00892736 B229 001A                  		cmp.b	obFrame(a1),d1
0089273A 6700                       		beq.s	loc_1192C
0089273C 08A9 0003 0022             		bclr	#3,obStatus(a1)
00892742 6700                       		beq.s	loc_1192C
00892744 4229 0025                  		clr.b	ob2ndRout(a1)
00892748 137C 0002 0024             		move.b	#2,obRoutine(a1)
0089274E 45F8 D000                  		lea	(v_player).w,a2
00892752 3568 0012 0012             		move.w	obVelY(a0),obVelY(a2)
00892758 446A 0012                  		neg.w	obVelY(a2)
0089275C 08EA 0001 0022             		bset	#1,obStatus(a2)
00892762 08AA 0003 0022             		bclr	#3,obStatus(a2)
00892768 422A 003C                  		clr.b	$3C(a2)
0089276C 157C 0000 001C             		move.b	#id_Spring,obAnim(a2) ; change Sonic's animation to "spring" ($10)
00892772 157C 0002 0024             		move.b	#2,obRoutine(a2)
00892782                            
00892782                            loc_1192C:
00892782 4268 0010                  		clr.w	obVelX(a0)
00892786 4268 0012                  		clr.w	obVelY(a0)
0089278A 5528 0024                  		subq.b	#2,obRoutine(a0)
0089278E                            
0089278E                            locret_11938:
0089278E 4E75                       		rts	
00892790                            ; ===========================================================================
00892790 FFF8 FFE4 FFD1 FFE4 FFF8   See_Speeds:	dc.w -8, -$1C, -$2F, -$1C, -8
0089279A                            
0089279A                            See_DataSlope:	incbin	"misc\slzssaw1.bin"
008927CA                            		even
008927CA                            See_DataFlat:	incbin	"misc\slzssaw2.bin"
008927FA                            		even
008927FA                            		even
008927FA                            		include	"_maps\Seesaw.asm"
008927FA                            ; ---------------------------------------------------------------------------
008927FA                            ; Sprite mappings - seesaws (SLZ)
008927FA                            ; ---------------------------------------------------------------------------
008927FA 0000                       Map_Seesaw:	dc.w @sloping-Map_Seesaw
008927FC 0000                       		dc.w @flat-Map_Seesaw
008927FE 0000                       		dc.w @sloping-Map_Seesaw
00892800 0000                       		dc.w @flat-Map_Seesaw
00892802 07                         @sloping:	dc.b 7
00892803 D406 0000 D3               		dc.b $D4, 6, 0,	0, $D3
00892808 DC06 0006 E3               		dc.b $DC, 6, 0,	6, $E3
0089280D E404 000C F3               		dc.b $E4, 4, 0,	$C, $F3
00892812 EC0D 000E F3               		dc.b $EC, $D, 0, $E, $F3
00892817 FC08 0016 FB               		dc.b $FC, 8, 0,	$16, $FB
0089281C F406 0006 13               		dc.b $F4, 6, 0,	6, $13
00892821 FC05 0019 23               		dc.b $FC, 5, 0,	$19, $23
00892826 04                         @flat:		dc.b 4
00892827 E60A 001D D0               		dc.b $E6, $A, 0, $1D, $D0
0089282C E60A 0023 E8               		dc.b $E6, $A, 0, $23, $E8
00892831 E60A 0823 00               		dc.b $E6, $A, 8, $23, 0
00892836 E60A 081D 18               		dc.b $E6, $A, 8, $1D, $18
0089283C 00                         		even
0089283C 00                         		even
0089283C                            		include	"_maps\Seesaw Ball.asm"
0089283C                            ; ---------------------------------------------------------------------------
0089283C                            ; Sprite mappings - spiked balls on the	seesaws	(SLZ)
0089283C                            ; ---------------------------------------------------------------------------
0089283C 0000                       Map_SSawBall:	dc.w @red-Map_SSawBall
0089283E 0000                       		dc.w @silver-Map_SSawBall
00892840 01                         @red:		dc.b 1
00892841 F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
00892846 01                         @silver:	dc.b 1
00892847 F40A 0009 F4               		dc.b $F4, $A, 0, 9, $F4
0089284C                            		even
0089284C                            		even
0089284C                            		include	"_incObj\5F Bomb Enemy.asm"
0089284C                            ; ---------------------------------------------------------------------------
0089284C                            ; Object 5F - walking bomb enemy (SLZ, SBZ)
0089284C                            ; ---------------------------------------------------------------------------
0089284C                            
0089284C                            Bomb:					; XREF: Obj_Index
0089284C 7000                       		moveq	#0,d0
0089284E 1028 0024                  		move.b	obRoutine(a0),d0
00892852 323B 0000                  		move.w	Bom_Index(pc,d0.w),d1
00892856 4EFB 1000                  		jmp	Bom_Index(pc,d1.w)
0089285A                            ; ===========================================================================
0089285A 0000                       Bom_Index:	dc.w Bom_Main-Bom_Index
0089285C 0000                       		dc.w Bom_Action-Bom_Index
0089285E 0000                       		dc.w Bom_Display-Bom_Index
00892860 0000                       		dc.w Bom_End-Bom_Index
00892862                            
00892862 =00000030                  bom_time:	= $30		; time of fuse
00892862 =00000034                  bom_origY:	= $34		; original y-axis position
00892862 =0000003C                  bom_parent:	= $3C		; address of parent object
00892862                            ; ===========================================================================
00892862                            
00892862                            Bom_Main:	; Routine 0
00892862 5428 0024                  		addq.b	#2,obRoutine(a0)
00892866 217C 0000 0000 0004        		move.l	#Map_Bomb,obMap(a0)
0089286E 317C 0400 0002             		move.w	#$400,obGfx(a0)
00892874 0028 0004 0001             		ori.b	#4,obRender(a0)
0089287A 117C 0003 0018             		move.b	#3,obPriority(a0)
00892880 117C 000C 0019             		move.b	#$C,obActWid(a0)
00892886 1028 0028                  		move.b	obSubtype(a0),d0
0089288A 6700                       		beq.s	loc_11A3C
0089288C 1140 0024                  		move.b	d0,obRoutine(a0)
00892890 4E75                       		rts	
00892892                            ; ===========================================================================
00892892                            
00892892                            loc_11A3C:
00892892 117C 009A 0020             		move.b	#$9A,obColType(a0)
00892898 0868 0000 0022             		bchg	#0,obStatus(a0)
0089289E                            
0089289E                            Bom_Action:	; Routine 2
0089289E 7000                       		moveq	#0,d0
008928A0 1028 0025                  		move.b	ob2ndRout(a0),d0
008928A4 323B 0000                  		move.w	@index(pc,d0.w),d1
008928A8 4EBB 1000                  		jsr	@index(pc,d1.w)
008928AC 43F9 0000 0000             		lea	(Ani_Bomb).l,a1
008928B2 6100 8BFC                  		bsr.w	AnimateSprite
008928B6 6000 DBD4                  		bra.w	RememberState
008928BA                            ; ===========================================================================
008928BA 0000                       @index:		dc.w @walk-@index
008928BC 0000                       		dc.w @wait-@index
008928BE 0000                       		dc.w @explode-@index
008928C0                            ; ===========================================================================
008928C0                            
008928C0                            @walk:					; XREF: @index
008928C0 6100 0000                  		bsr.w	@chksonic
008928C4 5368 0030                  		subq.w	#1,bom_time(a0)	; subtract 1 from time delay
008928C8 6A00                       		bpl.s	@noflip		; if time remains, branch
008928CA 5428 0025                  		addq.b	#2,ob2ndRout(a0) ; goto @wait
008928CE 317C 05FF 0030             		move.w	#1535,bom_time(a0) ; set time delay to 25 seconds
008928D4 317C 0010 0010             		move.w	#$10,obVelX(a0)
008928DA 117C 0001 001C             		move.b	#1,obAnim(a0)	; use walking animation
008928E0 0868 0000 0022             		bchg	#0,obStatus(a0)
008928E6 6700                       		beq.s	@noflip
008928E8 4468 0010                  		neg.w	obVelX(a0)	; change direction
008928EC                            
008928EC                            	@noflip:
008928EC 4E75                       		rts	
008928EE                            ; ===========================================================================
008928EE                            
008928EE                            @wait:					; XREF: @index
008928EE 6100 0000                  		bsr.w	@chksonic
008928F2 5368 0030                  		subq.w	#1,bom_time(a0)	; subtract 1 from time delay
008928F6 6B00                       		bmi.s	@stopwalking	; if time expires, branch
008928F8 6100 BAB8                  		bsr.w	ObjectMove
008928FC 4E75                       		rts	
008928FE                            ; ===========================================================================
008928FE                            
008928FE                            	@stopwalking:
008928FE 5528 0025                  		subq.b	#2,ob2ndRout(a0)
00892902 317C 00B3 0030             		move.w	#179,bom_time(a0) ; set time delay to 3 seconds
00892908 4268 0010                  		clr.w	obVelX(a0)	; stop walking
0089290C 117C 0000 001C             		move.b	#0,obAnim(a0)	; use waiting animation
00892912 4E75                       		rts	
00892914                            ; ===========================================================================
00892914                            
00892914                            @explode:				; XREF: @index
00892914 5368 0030                  		subq.w	#1,bom_time(a0)	; subtract 1 from time delay
00892918 6A00                       		bpl.s	@noexplode	; if time remains, branch
0089291A 117C 003F 0000             		move.b	#id_ExplosionBomb,0(a0) ; change bomb into an explosion
00892920 117C 0000 0024             		move.b	#0,obRoutine(a0)
00892926                            
00892926                            	@noexplode:
00892926 4E75                       		rts	
00892928                            ; ===========================================================================
00892928                            
00892928                            @chksonic:				; XREF: @walk; @wait
00892928 3038 D008                  		move.w	(v_player+obX).w,d0
0089292C 9068 0008                  		sub.w	obX(a0),d0
00892930 6400                       		bcc.s	@isleft
00892932 4440                       		neg.w	d0
00892934                            
00892934                            	@isleft:
00892934 0C40 0060                  		cmpi.w	#$60,d0		; is Sonic within $60 pixels?
00892938 6400                       		bcc.s	@outofrange	; if not, branch
0089293A 3038 D00C                  		move.w	(v_player+obY).w,d0
0089293E 9068 000C                  		sub.w	obY(a0),d0
00892942 6400                       		bcc.s	@isabove
00892944 4440                       		neg.w	d0
00892946                            
00892946                            	@isabove:
00892946 0C40 0060                  		cmpi.w	#$60,d0
0089294A 6400                       		bcc.s	@outofrange
0089294C 4A78 FE08                  		tst.w	(v_debuguse).w
00892950 6600                       		bne.s	@outofrange
00892952                            
00892952 117C 0004 0025             		move.b	#4,ob2ndRout(a0)
00892958 317C 008F 0030             		move.w	#143,bom_time(a0) ; set fuse time
0089295E 4268 0010                  		clr.w	obVelX(a0)
00892962 117C 0002 001C             		move.b	#2,obAnim(a0)	; use activated animation
00892968 6100 BF0E                  		bsr.w	FindNextFreeObj
0089296C 6600                       		bne.s	@outofrange
0089296E 137C 005F 0000             		move.b	#id_Bomb,0(a1)	; load fuse object
00892974 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089297A 3368 000C 000C             		move.w	obY(a0),obY(a1)
00892980 3368 000C 0034             		move.w	obY(a0),bom_origY(a1)
00892986 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
0089298C 137C 0004 0028             		move.b	#4,obSubtype(a1)
00892992 137C 0003 001C             		move.b	#3,obAnim(a1)
00892998 337C 0010 0012             		move.w	#$10,obVelY(a1)
0089299E 0828 0001 0022             		btst	#1,obStatus(a0)	; is bomb upside-down?
008929A4 6700                       		beq.s	@normal		; if not, branch
008929A6 4469 0012                  		neg.w	obVelY(a1)	; reverse direction for fuse
008929AA                            
008929AA                            	@normal:
008929AA 337C 008F 0030             		move.w	#143,bom_time(a1) ; set fuse time
008929B0 2348 003C                  		move.l	a0,bom_parent(a1)
008929B4                            
008929B4                            @outofrange:
008929B4 4E75                       		rts	
008929B6                            ; ===========================================================================
008929B6                            
008929B6                            Bom_Display:	; Routine 4
008929B6 6100                       		bsr.s	loc_11B70
008929B8 43F9 0000 0000             		lea	(Ani_Bomb).l,a1
008929BE 6100 8AF0                  		bsr.w	AnimateSprite
008929C2 6000 DAC8                  		bra.w	RememberState
008929C6                            ; ===========================================================================
008929C6                            
008929C6                            loc_11B70:
008929C6 5368 0030                  		subq.w	#1,bom_time(a0)
008929CA 6B00                       		bmi.s	loc_11B7C
008929CC 6100 B9E4                  		bsr.w	ObjectMove
008929D0 4E75                       		rts	
008929D2                            ; ===========================================================================
008929D2                            
008929D2                            loc_11B7C:
008929D2 4268 0030                  		clr.w	bom_time(a0)
008929D6 4228 0024                  		clr.b	obRoutine(a0)
008929DA 3168 0034 000C             		move.w	bom_origY(a0),obY(a0)
008929E0 7203                       		moveq	#3,d1
008929E2 2248                       		movea.l	a0,a1
008929E4 45F9 0000 0000             		lea	(Bom_ShrSpeed).l,a2 ; load shrapnel speed data
008929EA 6000                       		bra.s	@makeshrapnel
008929EC                            ; ===========================================================================
008929EC                            
008929EC                            	@loop:
008929EC 6100 BE8A                  		bsr.w	FindNextFreeObj
008929F0 6600                       		bne.s	@fail
008929F2                            
008929F2                            @makeshrapnel:			; XREF: loc_11B7C
008929F2 137C 005F 0000             		move.b	#id_Bomb,0(a1)	; load shrapnel	object
008929F8 3368 0008 0008             		move.w	obX(a0),obX(a1)
008929FE 3368 000C 000C             		move.w	obY(a0),obY(a1)
00892A04 137C 0006 0028             		move.b	#6,obSubtype(a1)
00892A0A 137C 0004 001C             		move.b	#4,obAnim(a1)
00892A10 335A 0010                  		move.w	(a2)+,obVelX(a1)
00892A14 335A 0012                  		move.w	(a2)+,obVelY(a1)
00892A18 137C 0098 0020             		move.b	#$98,obColType(a1)
00892A1E 08E9 0007 0001             		bset	#7,obRender(a1)
00892A24                            
00892A24                            	@fail:
00892A24 51C9 FFC6                  		dbf	d1,@loop	; repeat 3 more	times
00892A28                            
00892A28 117C 0006 0024             		move.b	#6,obRoutine(a0)
00892A2E                            
00892A2E                            Bom_End:	; Routine 6
00892A2E 6100 B982                  		bsr.w	ObjectMove
00892A32 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00892A38 43F9 0000 0000             		lea	(Ani_Bomb).l,a1
00892A3E 6100 8A70                  		bsr.w	AnimateSprite
00892A42 4A28 0001                  		tst.b	obRender(a0)
00892A46 6A00 B9C0                  		bpl.w	DeleteObject
00892A4A 6000 B980                  		bra.w	DisplaySprite
00892A4E                            ; ===========================================================================
00892A4E FE00 FD00 FF00 FE00 0200+  Bom_ShrSpeed:	dc.w -$200, -$300, -$100, -$200, $200, -$300, $100, -$200
00892A4E FE00 FD00 FF00 FE00 0200+  Bom_ShrSpeed:	dc.w -$200, -$300, -$100, -$200, $200, -$300, $100, -$200
00892A5E                            		include	"_anim\Bomb Enemy.asm"
00892A5E                            ; ---------------------------------------------------------------------------
00892A5E                            ; Animation script - Bomb enemy
00892A5E                            ; ---------------------------------------------------------------------------
00892A5E 0000                       Ani_Bomb:	dc.w @stand-Ani_Bomb
00892A60 0000                       		dc.w @walk-Ani_Bomb
00892A62 0000                       		dc.w @activated-Ani_Bomb
00892A64 0000                       		dc.w @fuse-Ani_Bomb
00892A66 0000                       		dc.w @shrapnel-Ani_Bomb
00892A68 1301 00FF                  @stand:		dc.b $13, 1, 0,	afEnd
00892A6C 1305 0403 02FF             @walk:		dc.b $13, 5, 4,	3, 2, afEnd
00892A72 1307 06FF                  @activated:	dc.b $13, 7, 6,	afEnd
00892A76 0308 09FF                  @fuse:		dc.b 3,	8, 9, afEnd
00892A7A 030A 0BFF                  @shrapnel:	dc.b 3,	$A, $B,	afEnd
00892A7E                            		even
00892A7E                            		even
00892A7E                            		include	"_maps\Bomb Enemy.asm"
00892A7E                            ; ---------------------------------------------------------------------------
00892A7E                            ; Sprite mappings - walking bomb enemy (SLZ, SBZ)
00892A7E                            ; ---------------------------------------------------------------------------
00892A7E 0000 0000                  Map_Bomb:	dc.w @stand1-Map_Bomb, @stand2-Map_Bomb
00892A82 0000 0000                  		dc.w @walk1-Map_Bomb, @walk2-Map_Bomb
00892A86 0000 0000                  		dc.w @walk3-Map_Bomb, @walk4-Map_Bomb
00892A8A 0000 0000                  		dc.w @activate1-Map_Bomb, @activate2-Map_Bomb
00892A8E 0000 0000                  		dc.w @fuse1-Map_Bomb, @fuse2-Map_Bomb
00892A92 0000 0000                  		dc.w @shrapnel1-Map_Bomb, @shrapnel2-Map_Bomb
00892A96 03                         @stand1:	dc.b 3
00892A97 F10A 0000 F4               		dc.b $F1, $A, 0, 0, $F4	; bomb standing still
00892A9C 0908 0012 F4               		dc.b 9,	8, 0, $12, $F4
00892AA1 E701 0021 FC               		dc.b $E7, 1, 0,	$21, $FC
00892AA6 03                         @stand2:	dc.b 3
00892AA7 F10A 0009 F4               		dc.b $F1, $A, 0, 9, $F4
00892AAC 0908 0012 F4               		dc.b 9,	8, 0, $12, $F4
00892AB1 E701 0021 FC               		dc.b $E7, 1, 0,	$21, $FC
00892AB6 03                         @walk1:		dc.b 3
00892AB7 F00A 0000 F4               		dc.b $F0, $A, 0, 0, $F4	; bomb walking
00892ABC 0808 0015 F4               		dc.b 8,	8, 0, $15, $F4
00892AC1 E601 0021 FC               		dc.b $E6, 1, 0,	$21, $FC
00892AC6 03                         @walk2:		dc.b 3
00892AC7 F10A 0009 F4               		dc.b $F1, $A, 0, 9, $F4
00892ACC 0908 0018 F4               		dc.b 9,	8, 0, $18, $F4
00892AD1 E701 0021 FC               		dc.b $E7, 1, 0,	$21, $FC
00892AD6 03                         @walk3:		dc.b 3
00892AD7 F00A 0000 F4               		dc.b $F0, $A, 0, 0, $F4
00892ADC 0808 001B F4               		dc.b 8,	8, 0, $1B, $F4
00892AE1 E601 0021 FC               		dc.b $E6, 1, 0,	$21, $FC
00892AE6 03                         @walk4:		dc.b 3
00892AE7 F10A 0009 F4               		dc.b $F1, $A, 0, 9, $F4
00892AEC 0908 001E F4               		dc.b 9,	8, 0, $1E, $F4
00892AF1 E701 0021 FC               		dc.b $E7, 1, 0,	$21, $FC
00892AF6 02                         @activate1:	dc.b 2
00892AF7 F10A 0000 F4               		dc.b $F1, $A, 0, 0, $F4	; bomb during detonation countdown
00892AFC 0908 0012 F4               		dc.b 9,	8, 0, $12, $F4
00892B01 02                         @activate2:	dc.b 2
00892B02 F10A 0009 F4               		dc.b $F1, $A, 0, 9, $F4
00892B07 0908 0012 F4               		dc.b 9,	8, 0, $12, $F4
00892B0C 01                         @fuse1:		dc.b 1
00892B0D E701 0023 FC               		dc.b $E7, 1, 0,	$23, $FC ; fuse	(just before it	explodes)
00892B12 01                         @fuse2:		dc.b 1
00892B13 E701 0025 FC               		dc.b $E7, 1, 0,	$25, $FC
00892B18 01                         @shrapnel1:	dc.b 1
00892B19 FC00 0027 FC               		dc.b $FC, 0, 0,	$27, $FC ; shrapnel (after it exploded)
00892B1E 01                         @shrapnel2:	dc.b 1
00892B1F FC00 0028 FC               		dc.b $FC, 0, 0,	$28, $FC
00892B24                            		even
00892B24                            		even
00892B24                            
00892B24                            		include	"_incObj\60 Orbinaut.asm"
00892B24                            ; ---------------------------------------------------------------------------
00892B24                            ; Object 60 - Orbinaut enemy (LZ, SLZ, SBZ)
00892B24                            ; ---------------------------------------------------------------------------
00892B24                            
00892B24                            Orbinaut:				; XREF: Obj_Index
00892B24 7000                       		moveq	#0,d0
00892B26 1028 0024                  		move.b	obRoutine(a0),d0
00892B2A 323B 0000                  		move.w	Orb_Index(pc,d0.w),d1
00892B2E 4EFB 1000                  		jmp	Orb_Index(pc,d1.w)
00892B32                            ; ===========================================================================
00892B32 0000                       Orb_Index:	dc.w Orb_Main-Orb_Index
00892B34 0000                       		dc.w Orb_ChkSonic-Orb_Index
00892B36 0000                       		dc.w Orb_Display-Orb_Index
00892B38 0000                       		dc.w Orb_MoveOrb-Orb_Index
00892B3A 0000                       		dc.w Orb_ChkDel2-Orb_Index
00892B3C                            		
00892B3C 0000                       		dc.w Orb_Pause-Orb_Index
00892B3E 0000                       		dc.w Orb_MoveOut-Orb_Index
00892B40                            
00892B40 =0000002A                  orb_distance: = $2A		; distance of child orbs
00892B40                            
00892B40 =0000003C                  orb_parent:	= $3C		; address of parent object
00892B40                            ; ===========================================================================
00892B40                            
00892B40                            Orb_Main:	; Routine 0
00892B40 217C 0000 0000 0004        		move.l	#Map_Orb,obMap(a0)
00892B48 317C 0429 0002             		move.w	#$429,obGfx(a0)	; SBZ specific code
00892B4E 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; check if level is SBZ
00892B54 6700                       		beq.s	@isscrap
00892B56 317C 2429 0002             		move.w	#$2429,obGfx(a0) ; SLZ specific code
00892B5C                            
00892B5C                            	@isscrap:
00892B5C 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ
00892B62 6600                       		bne.s	@notlabyrinth
00892B64                            		
00892B64 317C 2467 0002             		move.w	#$2467,obGfx(a0)	; LZ specific code
00892B6A                            
00892B6A                            	@notlabyrinth:
00892B6A                            	
00892B6A 117C 0004 002A             		move.b	#4,orb_distance(a0)
00892B70                            	
00892B70 0028 0004 0001             		ori.b	#4,obRender(a0)
00892B76 117C 0004 0018             		move.b	#4,obPriority(a0)
00892B7C 117C 000B 0020             		move.b	#$B,obColType(a0)
00892B82 117C 000C 0019             		move.b	#$C,obActWid(a0)
00892B88 7400                       		moveq	#0,d2
00892B8A 45E8 0037                  		lea	$37(a0),a2
00892B8E 264A                       		movea.l	a2,a3
00892B90 524A                       		addq.w	#1,a2
00892B92 7203                       		moveq	#3,d1
00892B94                            
00892B94                            @makesatellites:
00892B94 6100 BCE2                  		bsr.w	FindNextFreeObj
00892B98 6600                       		bne.s	@fail
00892B9A 5213                       		addq.b	#1,(a3)
00892B9C 3A09                       		move.w	a1,d5
00892B9E 0445 D000                  		subi.w	#$D000,d5
00892BA2 EC4D                       		lsr.w	#6,d5
00892BA4 0245 007F                  		andi.w	#$7F,d5
00892BA8 14C5                       		move.b	d5,(a2)+
00892BAA 1368 0000 0000             		move.b	0(a0),0(a1)	; load spiked orb object
00892BB0 137C 0006 0024             		move.b	#6,obRoutine(a1) ; use Orb_MoveOrb routine
00892BB6 2368 0004 0004             		move.l	obMap(a0),obMap(a1)
00892BBC 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
00892BC2                            		
00892BC2 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w ; check if level is SLZ
00892BC8 6700                       		beq.s	@isSLZ
00892BCA 0469 2000 0002             		sub.w	#$2000,obGfx(a1)
00892BD0                            		
00892BD0                            	@isSLZ:
00892BD0                            		
00892BD0 0029 0004 0001             		ori.b	#4,obRender(a1)
00892BD6 137C 0004 0018             		move.b	#4,obPriority(a1)
00892BDC 137C 0008 0019             		move.b	#8,obActWid(a1)
00892BE2 137C 0003 001A             		move.b	#3,obFrame(a1)
00892BE8 137C 0098 0020             		move.b	#$98,obColType(a1)
00892BEE 1342 0026                  		move.b	d2,obAngle(a1)
00892BF2 0602 0040                  		addi.b	#$40,d2
00892BF6 2348 003C                  		move.l	a0,orb_parent(a1)
00892BFA 51C9 FF98                  		dbf	d1,@makesatellites ; repeat sequence 3 more times
00892BFE                            
00892BFE                            	@fail:
00892BFE 7001                       		moveq	#1,d0
00892C00                            		
00892C00 0C28 0002 0028             		cmpi.b	#2,obSubtype(a0)
00892C06 6600                       		bne.s	@add
00892C08 4440                       		neg.w	d0
00892C0A                            	@add:
00892C0A                            		
00892C0A 0828 0000 0022             		btst	#0,obStatus(a0)	; is orbinaut facing left?
00892C10 6700                       		beq.s	@noflip		; if not, branch
00892C12 4440                       		neg.w	d0
00892C14                            
00892C14                            	@noflip:
00892C14 1140 0036                  		move.b	d0,$36(a0)
00892C18                            		
00892C18                            		
00892C18 5428 0024                  		addq.b	#2,obRoutine(a0)
00892C1C 317C FFC0 0010             		move.w	#-$40,obVelX(a0) ; move orbinaut to the left
00892C22 0828 0000 0022             		btst	#0,obStatus(a0)	; is orbinaut facing left??
00892C28 6700                       		beq.s	@noflip2	; if not, branch
00892C2A 4468 0010                  		neg.w	obVelX(a0)	; move orbinaut	to the right
00892C2E                            
00892C2E                            	@noflip2:
00892C2E 4E75                       		rts	
00892C30                            ; ===========================================================================
00892C30                            
00892C30                            Orb_ChkSonic:	; Routine 2
00892C30 3038 D008                  		move.w	(v_player+obX).w,d0
00892C34 9068 0008                  		sub.w	obX(a0),d0	; is Sonic to the right of the orbinaut?
00892C38 6400                       		bcc.s	@isright	; if yes, branch
00892C3A 4440                       		neg.w	d0
00892C3C                            
00892C3C                            	@isright:
00892C3C                            	
00892C3C 0C40 0080                  		cmpi.w	#OrbinautAnimationTweakRange,d0
00892C40                            
00892C40 6400                       		bcc.s	@animate	; if not, branch
00892C42 3038 D00C                  		move.w	(v_player+obY).w,d0
00892C46 9068 000C                  		sub.w	obY(a0),d0	; is Sonic above the orbinaut?
00892C4A 6400                       		bcc.s	@isabove	; if yes, branch
00892C4C 4440                       		neg.w	d0
00892C4E                            
00892C4E                            	@isabove:
00892C4E 0C40 0050                  		cmpi.w	#$50,d0		; is Sonic within $50 pixels of	orbinaut?
00892C52 6400                       		bcc.s	@animate	; if not, branch
00892C54 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	on?
00892C58 6600                       		bne.s	@animate	; if yes, branch
00892C5A 117C 0001 001C             		move.b	#1,obAnim(a0)	; use "angry" animation
00892C60                            
00892C60                            @animate:
00892C60 43F9 0000 0000             		lea	(Ani_Orb).l,a1
00892C66 6100 8848                  		bsr.w	AnimateSprite
00892C6A 6000 0000                  		bra.w	Orb_ChkDel
00892C6E                            ; ===========================================================================
00892C6E                            
00892C6E                            Orb_Display:	; Routine 4
00892C6E 6100 B742                  		bsr.w	ObjectMove
00892C72                            
00892C72                            Orb_ChkDel:
00892C90 6000 B73A                  		bra.w	DisplaySprite
00892C94                            
00892C94                            @chkgone:
00892C94 45F8 FC00                  		lea	(v_objstate).w,a2
00892C98 7000                       		moveq	#0,d0
00892C9A 1028 0023                  		move.b	obRespawnNo(a0),d0
00892C9E 6700                       		beq.s	loc_11E34
00892CA0 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
00892CA6                            
00892CA6                            loc_11E34:
00892CA6 45E8 0037                  		lea	$37(a0),a2
00892CAA 7400                       		moveq	#0,d2
00892CAC 141A                       		move.b	(a2)+,d2
00892CAE 5342                       		subq.w	#1,d2
00892CB0 6500                       		bcs.s	Orb_Delete
00892CB2                            
00892CB2                            loc_11E40:
00892CB2 7000                       		moveq	#0,d0
00892CB4 101A                       		move.b	(a2)+,d0
00892CB6 ED48                       		lsl.w	#6,d0
00892CB8 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
00892CBE 2240                       		movea.l	d0,a1
00892CC0 6100 B748                  		bsr.w	DeleteChild
00892CC4 51CA FFEC                  		dbf	d2,loc_11E40
00892CC8                            
00892CC8                            Orb_Delete:
00892CC8 6000 B73E                  		bra.w	DeleteObject
00892CCC                            ; ===========================================================================
00892CCC                            
00892CCC                            Orb_MoveOrb:	; Routine 6
00892CCC 2268 003C                  		movea.l	orb_parent(a0),a1
00892CD0 0C29 0060 0000             		cmpi.b	#id_Orbinaut,0(a1) ; does parent object still exist?
00892CD6 6600 B730                  		bne.w	DeleteObject	; if not, delete
00892CDA 0C29 0002 001A             		cmpi.b	#2,obFrame(a1)	; is orbinaut angry?
00892CE0 6600 0000                  		bne.w	@circle		; if not, branch ;Mercury SLZ Orbinaut Behaviour Mod bne.s => bne.w
00892CE4                            		
00892CE4 0C29 0002 0028             		cmpi.b	#2,obSubtype(a1)
00892CEA 6700                       		beq.s	@fire2
00892CEC                            		
00892CEC 0C28 0040 0026             		cmpi.b	#$40,obAngle(a0) ; is spikeorb directly under the orbinaut?
00892CF2 6600                       		bne.s	@circle		; if not, branch
00892CF4 5428 0024                  		addq.b	#2,obRoutine(a0)
00892CF8 5329 0037                  		subq.b	#1,$37(a1)
00892CFC 6600                       		bne.s	@fire
00892CFE 5429 0024                  		addq.b	#2,obRoutine(a1)
00892D02                            
00892D02                            	@fire:
00892D02 317C FE00 0010             		move.w	#-$200,obVelX(a0) ; move orb to the left (quickly)
00892D08 0829 0000 0022             		btst	#0,obStatus(a1)
00892D0E 6700                       		beq.s	@noflip
00892D10 4468 0010                  		neg.w	obVelX(a0)
00892D14                            		
00892D14 6000                       		bra.s	@noflip
00892D16                            
00892D16                            	@fire2:
00892D16 0C29 0003 002A             		cmpi.b	#3,orb_distance(a1)	; is the orb distance high enough?
00892D1C 6700                       		beq.s	@circle			; if so, branch to the code that makes them circle
00892D1E 117C 000C 0024             		move.b	#12,obRoutine(a0)	; change orb to the routine that moves it outward
00892D24 117C 001E 002E             		move.b	#30,$2E(a0)		; set the orb timer to 30 steps
00892D2A 5329 0037                  		subq.b	#1,$37(a1)		; decrease the number of orbs left to be fired off
00892D2E 6600                       		bne.s	@skip			; if there are still orbs, branch
00892D30 137C 000A 0024             		move.b	#10,obRoutine(a1)	; change to the routine that pauses movement
00892D36 137C 0003 002A             		move.b	#3,orb_distance(a1)	; set orb distance
00892D3C 1029 0036                  		move.b	$36(a1),d0		; double orbit speed
00892D40 E300                       		asl.b	#1,d0
00892D42 1340 0036                  		move.b	d0,$36(a1)
00892D46 137C 001E 002E             		move.b	#30,$2E(a1)		; set a timer to 30 steps
00892D4C                            	
00892D4C                            	@skip:
00892D4C 3428 0008                  		move.w	obX(a0),d2		; set the velocity of the orb based on its position
00892D50 9469 0008                  		sub.w	obX(a1),d2		; relative to the Orbinaut
00892D54 E742                       		asl.w	#3,d2
00892D56 3142 0010                  		move.w	d2,obVelX(a0)
00892D5A 3428 000C                  		move.w	obY(a0),d2
00892D5E 9469 000C                  		sub.w	obY(a1),d2
00892D62 E742                       		asl.w	#3,d2
00892D64 3142 0012                  		move.w	d2,obVelY(a0)
00892D68                            		
00892D68                            	@noflip:
00892D68 6000 B662                  		bra.w	DisplaySprite
00892D6C                            ; ===========================================================================
00892D6C                            
00892D6C                            @circle:
00892D6C                            
00892D6C 1429 002A                  		move.b	orb_distance(a1),d2	; put orb distance into d2
00892D70                            
00892D70 1028 0026                  		move.b	obAngle(a0),d0
00892D74 4EB9 0088 301C             		jsr	(CalcSine).l
00892D7A                            		
00892D7A E461                       		asr.w	d2,d1
00892D7C                            		
00892D7C D269 0008                  		add.w	obX(a1),d1
00892D80 3141 0008                  		move.w	d1,obX(a0)
00892D84                            		
00892D84 E460                       		asr.w	d2,d0
00892D86                            
00892D86 D069 000C                  		add.w	obY(a1),d0
00892D8A 3140 000C                  		move.w	d0,obY(a0)
00892D8E 1029 0036                  		move.b	$36(a1),d0
00892D92 D128 0026                  		add.b	d0,obAngle(a0)
00892D96 6000 B634                  		bra.w	DisplaySprite
00892D9A                            ; ===========================================================================
00892D9A                            
00892D9A                            Orb_Pause:	; Routine 10
00892D9A 5328 002E                  		subq.b	#1,$2E(a0)		; decrease timer
00892D9E 6600                       		bne.s	Orb_ChkDel2Skip		; if it hasn't run out, branch
00892DA0 117C 0004 0024             		move.b	#4,obRoutine(a0)	; go back to the normal routine
00892DA6 6000                       		bra.s	Orb_ChkDel2Skip
00892DA8                            
00892DA8                            Orb_MoveOut:	; Routine 12
00892DA8 5328 002E                  		subq.b	#1,$2E(a0)		; decrease timer
00892DAC 6600                       		bne.s	Orb_ChkDel2		; if it hasn't run out, branch
00892DAE 117C 0006 0024             		move.b	#6,obRoutine(a0)	; go back to the normal routine
00892DB4                            
00892DB4                            Orb_ChkDel2:	; Routine 8
00892DB4 6100 B5FC                  		bsr.w	ObjectMove
00892DB8                            		
00892DB8                            Orb_ChkDel2Skip:
00892DB8                            		
00892DB8 4A28 0001                  		tst.b	obRender(a0)
00892DBC 6A00 B64A                  		bpl.w	DeleteObject
00892DC0 6000 B60A                  		bra.w	DisplaySprite
00892DC0 6000 B60A                  		bra.w	DisplaySprite
00892DC4                            		include	"_anim\Orbinaut.asm"
00892DC4                            ; ---------------------------------------------------------------------------
00892DC4                            ; Animation script - Orbinaut enemy
00892DC4                            ; ---------------------------------------------------------------------------
00892DC4 0000                       Ani_Orb:	dc.w @normal-Ani_Orb
00892DC6 0000                       		dc.w @angers-Ani_Orb
00892DC8 0F00 FF                    @normal:	dc.b $F, 0, afEnd
00892DCC 00                         		even
00892DCC                            		
00892DCC 0801 02FE 01               @angers:	dc.b OrbinautAnimationTweakSpeed, 1, 2, afBack, 1
00892DD1                            
00892DD2 00                         		even
00892DD2                            		
00892DD2                            		
00892DD2                            		include	"_maps\Orbinaut.asm"
00892DD2                            ; ---------------------------------------------------------------------------
00892DD2                            ; Sprite mappings - Orbinaut enemy (LZ,	SLZ, SBZ)
00892DD2                            ; ---------------------------------------------------------------------------
00892DD2 0000                       Map_Orb:	dc.w @normal-Map_Orb
00892DD4 0000                       		dc.w @medium-Map_Orb
00892DD6 0000                       		dc.w @angry-Map_Orb
00892DD8 0000                       		dc.w @spikeball-Map_Orb
00892DDA 01                         @normal:	dc.b 1
00892DDB F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
00892DE0 01                         @medium:	dc.b 1
00892DE1                            
00892DE1 F40A 0009 F4               		dc.b $F4, $A, 0, 9, $F4
00892DE6                            
00892DE6 01                         @angry:		dc.b 1
00892DE7 F40A 0012 F4               		dc.b $F4, $A, 0, $12, $F4
00892DEC 01                         @spikeball:	dc.b 1
00892DED F805 001B F8               		dc.b $F8, 5, 0,	$1B, $F8
00892DF2                            		even
00892DF2                            		even
00892DF2                            
00892DF2                            		include	"_incObj\16 Harpoon.asm"
00892DF2                            ; ---------------------------------------------------------------------------
00892DF2                            ; Object 16 - harpoon (LZ)
00892DF2                            ; ---------------------------------------------------------------------------
00892DF2                            
00892DF2                            Harpoon:				; XREF: Obj_Index
00892DF2 7000                       		moveq	#0,d0
00892DF4 1028 0024                  		move.b	obRoutine(a0),d0
00892DF8 323B 0000                  		move.w	Harp_Index(pc,d0.w),d1
00892DFC 4EFB 1000                  		jmp	Harp_Index(pc,d1.w)
00892E00                            ; ===========================================================================
00892E00 0000                       Harp_Index:	dc.w Harp_Main-Harp_Index
00892E02 0000                       		dc.w Harp_Move-Harp_Index
00892E04 0000                       		dc.w Harp_Wait-Harp_Index
00892E06                            
00892E06 =00000030                  harp_time:	= $30		; time between stabbing/retracting
00892E06                            ; ===========================================================================
00892E06                            
00892E06                            Harp_Main:	; Routine 0
00892E06 5428 0024                  		addq.b	#2,obRoutine(a0)
00892E0A 217C 0000 0000 0004        		move.l	#Map_Harp,obMap(a0)
00892E12 317C 03CC 0002             		move.w	#$3CC,obGfx(a0)
00892E18 0028 0004 0001             		ori.b	#4,obRender(a0)
00892E1E 117C 0004 0018             		move.b	#4,obPriority(a0)
00892E24 1168 0028 001C             		move.b	obSubtype(a0),obAnim(a0) ; get type (vert/horiz)
00892E2A 117C 0014 0019             		move.b	#$14,obActWid(a0)
00892E30 317C 003C 0030             		move.w	#60,harp_time(a0) ; set time to 1 second
00892E36                            
00892E36                            Harp_Move:	; Routine 2
00892E36 43F9 0000 0000             		lea	(Ani_Harp).l,a1
00892E3C 6100 8672                  		bsr.w	AnimateSprite
00892E40 7000                       		moveq	#0,d0
00892E42 1028 001A                  		move.b	obFrame(a0),d0	; get frame number
00892E46 117B 0000 0020             		move.b	@types(pc,d0.w),obColType(a0) ; get collision type
00892E4C 6000 D63E                  		bra.w	RememberState
00892E50                            
00892E50                            	@types:
00892E50 9B9C 9D9E 9FA0             		dc.b $9B, $9C, $9D, $9E, $9F, $A0
00892E56                            		even
00892E56                            
00892E56                            Harp_Wait:	; Routine 4
00892E56 5368 0030                  		subq.w	#1,harp_time(a0) ; decrement timer
00892E5A 6A00                       		bpl.s	@chkdel		; branch if time remains
00892E5C 317C 003C 0030             		move.w	#60,harp_time(a0) ; reset timer
00892E62 5528 0024                  		subq.b	#2,obRoutine(a0) ; run "Harp_Move" subroutine
00892E66 0868 0000 001C             		bchg	#0,obAnim(a0)	; reverse animation
00892E6C                            
00892E6C                            	@chkdel:
00892E6C 6000 D61E                  		bra.w	RememberState
00892E6C 6000 D61E                  		bra.w	RememberState
00892E70                            		include	"_anim\Harpoon.asm"
00892E70                            ; ---------------------------------------------------------------------------
00892E70                            ; Animation script - harpoon (LZ)
00892E70                            ; ---------------------------------------------------------------------------
00892E70 0000                       Ani_Harp:	dc.w @h_extending-Ani_Harp
00892E72 0000                       		dc.w @h_retracting-Ani_Harp
00892E74 0000                       		dc.w @v_extending-Ani_Harp
00892E76 0000                       		dc.w @v_retracting-Ani_Harp
00892E78 0301 02FC                  @h_extending:	dc.b 3,	1, 2, afRoutine
00892E7C 0301 00FC                  @h_retracting:	dc.b 3,	1, 0, afRoutine
00892E80 0304 05FC                  @v_extending:	dc.b 3,	4, 5, afRoutine
00892E84 0304 03FC                  @v_retracting:	dc.b 3,	4, 3, afRoutine
00892E88                            		even
00892E88                            		even
00892E88                            		include	"_maps\Harpoon.asm"
00892E88                            ; ---------------------------------------------------------------------------
00892E88                            ; Sprite mappings - harpoon (LZ)
00892E88                            ; ---------------------------------------------------------------------------
00892E88 0000 0000                  Map_Harp:	dc.w @h_retracted-Map_Harp, @h_middle-Map_Harp
00892E8C 0000 0000                  		dc.w @h_extended-Map_Harp, @v_retracted-Map_Harp
00892E90 0000 0000                  		dc.w @v_middle-Map_Harp, @v_extended-Map_Harp
00892E94 01                         @h_retracted:	dc.b 1
00892E95 FC04 0000 F8               		dc.b $FC, 4, 0,	0, $F8
00892E9A 01                         @h_middle:	dc.b 1
00892E9B FC0C 0002 F8               		dc.b $FC, $C, 0, 2, $F8
00892EA0 02                         @h_extended:	dc.b 2
00892EA1 FC08 0006 F8               		dc.b $FC, 8, 0,	6, $F8
00892EA6 FC08 0003 10               		dc.b $FC, 8, 0,	3, $10
00892EAB 01                         @v_retracted:	dc.b 1
00892EAC F801 0009 FC               		dc.b $F8, 1, 0,	9, $FC
00892EB1 01                         @v_middle:	dc.b 1
00892EB2 E803 000B FC               		dc.b $E8, 3, 0,	$B, $FC
00892EB7 02                         @v_extended:	dc.b 2
00892EB8 D802 000B FC               		dc.b $D8, 2, 0,	$B, $FC
00892EBD F002 000F FC               		dc.b $F0, 2, 0,	$F, $FC
00892EC2                            		even
00892EC2                            		even
00892EC2                            		include	"_incObj\61 LZ Blocks.asm"
00892EC2                            ; ---------------------------------------------------------------------------
00892EC2                            ; Object 61 - blocks (LZ)
00892EC2                            ; ---------------------------------------------------------------------------
00892EC2                            
00892EC2                            LabyrinthBlock:				; XREF: Obj_Index
00892EC2 7000                       		moveq	#0,d0
00892EC4 1028 0024                  		move.b	obRoutine(a0),d0
00892EC8 323B 0000                  		move.w	LBlk_Index(pc,d0.w),d1
00892ECC 4EFB 1000                  		jmp	LBlk_Index(pc,d1.w)
00892ED0                            ; ===========================================================================
00892ED0 0000                       LBlk_Index:	dc.w LBlk_Main-LBlk_Index
00892ED2 0000                       		dc.w LBlk_Action-LBlk_Index
00892ED4                            
00892ED4 1010                       LBlk_Var:	dc.b $10, $10		; width, height
00892ED6 200C                       		dc.b $20, $C
00892ED8 1010                       		dc.b $10, $10
00892EDA 1010                       		dc.b $10, $10
00892EDC                            
00892EDC =00000016                  lblk_height:	= $16		; block height
00892EDC =00000034                  lblk_origX:	= $34		; original x-axis position
00892EDC =00000030                  lblk_origY:	= $30		; original y-axis position
00892EDC =00000036                  lblk_time:	= $36		; time delay for block movement
00892EDC =00000038                  lblk_untouched:	= $38		; flag block as untouched
00892EDC                            ; ===========================================================================
00892EDC                            
00892EDC                            LBlk_Main:	; Routine 0
00892EDC 5428 0024                  		addq.b	#2,obRoutine(a0)
00892EE0 217C 0000 0000 0004        		move.l	#Map_LBlock,obMap(a0)
00892EE8 317C 43E6 0002             		move.w	#$43E6,obGfx(a0)
00892EEE 117C 0004 0001             		move.b	#4,obRender(a0)
00892EF4 117C 0003 0018             		move.b	#3,obPriority(a0)
00892EFA 7000                       		moveq	#0,d0
00892EFC 1028 0028                  		move.b	obSubtype(a0),d0 ; get block type
00892F00 E648                       		lsr.w	#3,d0		; read only the 1st digit
00892F02 0240 000E                  		andi.w	#$E,d0
00892F06 45FB 00CC                  		lea	LBlk_Var(pc,d0.w),a2
00892F0A 115A 0019                  		move.b	(a2)+,obActWid(a0) ; set width
00892F0E 1152 0016                  		move.b	(a2),lblk_height(a0) ; set height
00892F12 E248                       		lsr.w	#1,d0
00892F14 1140 001A                  		move.b	d0,obFrame(a0)
00892F18 3168 0008 0034             		move.w	obX(a0),lblk_origX(a0)
00892F1E 3168 000C 0030             		move.w	obY(a0),lblk_origY(a0)
00892F24 1028 0028                  		move.b	obSubtype(a0),d0 ; get block type
00892F28 0200 000F                  		andi.b	#$F,d0		; read only the 2nd digit
00892F2C 6700                       		beq.s	LBlk_Action	; branch if 0
00892F2E 0C00 0007                  		cmpi.b	#7,d0
00892F32 6700                       		beq.s	LBlk_Action	; branch if 7
00892F34 117C 0001 0038             		move.b	#1,lblk_untouched(a0)
00892F3A                            
00892F3A                            LBlk_Action:	; Routine 2
00892F3A 3F28 0008                  		move.w	obX(a0),-(sp)
00892F3E 7000                       		moveq	#0,d0
00892F40 1028 0028                  		move.b	obSubtype(a0),d0
00892F44 0240 000F                  		andi.w	#$F,d0
00892F48 D040                       		add.w	d0,d0
00892F4A 323B 0000                  		move.w	@index(pc,d0.w),d1
00892F4E 4EBB 1000                  		jsr	@index(pc,d1.w)
00892F52 381F                       		move.w	(sp)+,d4
00892F54 4A28 0001                  		tst.b	obRender(a0)
00892F58 6A00                       		bpl.s	@chkdel
00892F5A 7200                       		moveq	#0,d1
00892F5C 1228 0019                  		move.b	obActWid(a0),d1
00892F60 0641 000B                  		addi.w	#$B,d1
00892F64 7400                       		moveq	#0,d2
00892F66 1428 0016                  		move.b	lblk_height(a0),d2
00892F6A 3602                       		move.w	d2,d3
00892F6C 5243                       		addq.w	#1,d3
00892F6E 6100 D846                  		bsr.w	SolidObject
00892F72 1144 003F                  		move.b	d4,$3F(a0)
00892F76 6100 0000                  		bsr.w	loc_12180
00892F7A                            
00892F7A                            @chkdel:
00892F98 6000 B432                  		bra.w	DisplaySprite
00892F9C                            ; ===========================================================================
00892F9C 0000 0000                  @index:		dc.w @type00-@index, @type01-@index
00892FA0 0000 0000                  		dc.w @type02-@index, @type03-@index
00892FA4 0000 0000                  		dc.w @type04-@index, @type05-@index
00892FA8 0000 0000                  		dc.w @type06-@index, @type07-@index
00892FAC                            ; ===========================================================================
00892FAC                            
00892FAC                            @type00:
00892FAC 4E75                       		rts	
00892FAE                            ; ===========================================================================
00892FAE                            
00892FAE                            @type01:
00892FAE                            @type03:
00892FAE 4A68 0036                  		tst.w	lblk_time(a0)	; does time remain?
00892FB2 6600                       		bne.s	@wait01		; if yes, branch
00892FB4 0828 0003 0022             		btst	#3,obStatus(a0)	; is Sonic standing on the object?
00892FBA 6700                       		beq.s	@donothing01	; if not, branch
00892FBC 317C 001E 0036             		move.w	#30,lblk_time(a0) ; wait for half second
00892FC2                            
00892FC2                            	@donothing01:
00892FC2 4E75                       		rts	
00892FC4                            ; ===========================================================================
00892FC4                            
00892FC4                            	@wait01:
00892FC4 5368 0036                  		subq.w	#1,lblk_time(a0); decrement waiting time
00892FC8 66F8                       		bne.s	@donothing01	; if time remains, branch
00892FCA 5228 0028                  		addq.b	#1,obSubtype(a0) ; goto @type02 or @type04
00892FCE 4228 0038                  		clr.b	lblk_untouched(a0) ; flag block as touched
00892FD2 4E75                       		rts	
00892FD4                            ; ===========================================================================
00892FD4                            
00892FD4                            @type02:
00892FD4                            @type06:
00892FD4 6100 B3DC                  		bsr.w	ObjectMove
00892FD8 5068 0012                  		addq.w	#8,obVelY(a0)	; make block fall
00892FDC 6100 0000                  		bsr.w	ObjFloorDist
00892FE0 4A41                       		tst.w	d1		; has block hit the floor?
00892FE2 6A00 0000                  		bpl.w	@nofloor02	; if not, branch
00892FE6 5241                       		addq.w	#1,d1
00892FE8 D368 000C                  		add.w	d1,obY(a0)
00892FEC 4268 0012                  		clr.w	obVelY(a0)	; stop when it touches the floor
00892FF0 4228 0028                  		clr.b	obSubtype(a0)	; set type to 00 (non-moving type)
00892FF4                            
00892FF4                            	@nofloor02:
00892FF4 4E75                       		rts	
00892FF6                            ; ===========================================================================
00892FF6                            
00892FF6                            @type04:
00892FF6 6100 B3BA                  		bsr.w	ObjectMove
00892FFA                            		
00892FFA 0C68 FE00 0012             		cmpi.w	#-$200,obVelY(a0)
00893000 6700                       		beq.s	@attopspeed
00893002 5168 0012                  		subq.w	#8,obVelY(a0)	; make block rise
00893006                            		
00893006                            	@attopspeed:
00893006                            
00893006 6100 0000                  		bsr.w	ObjHitCeiling
0089300A 4A41                       		tst.w	d1		; has block hit the ceiling?
0089300C 6A00 0000                  		bpl.w	@noceiling04	; if not, branch
00893010 9368 000C                  		sub.w	d1,obY(a0)
00893014 4268 0012                  		clr.w	obVelY(a0)	; stop when it touches the ceiling
00893018 4228 0028                  		clr.b	obSubtype(a0)	; set type to 00 (non-moving type)
0089301C                            
0089301C                            	@noceiling04:
0089301C 4E75                       		rts	
0089301E                            ; ===========================================================================
0089301E                            
0089301E                            @type05:
0089301E 0C28 0001 003F             		cmpi.b	#1,$3F(a0)	; is Sonic touching the	block?
00893024 6600                       		bne.s	@notouch05	; if not, branch
00893026 5228 0028                  		addq.b	#1,obSubtype(a0) ; goto @type06
0089302A 4228 0038                  		clr.b	lblk_untouched(a0)
0089302E                            
0089302E                            	@notouch05:
0089302E 4E75                       		rts	
00893030                            ; ===========================================================================
00893030                            
00893030                            @type07:
00893030 3038 F646                  		move.w	(v_waterpos1).w,d0
00893034 9068 000C                  		sub.w	obY(a0),d0	; is block level with water?
00893038 6700                       		beq.s	@stop07		; if yes, branch
0089303A 6400                       		bcc.s	@fall07		; branch if block is above water
0089303C 0C40 FFFE                  		cmpi.w	#-2,d0
00893040 6C00                       		bge.s	@loc_1214E
00893042 70FE                       		moveq	#-2,d0
00893044                            
00893044                            	@loc_1214E:
00893044 D168 000C                  		add.w	d0,obY(a0)	; make the block rise with water level
00893048 6100 0000                  		bsr.w	ObjHitCeiling
0089304C 4A41                       		tst.w	d1		; has block hit the ceiling?
0089304E 6A00 0000                  		bpl.w	@noceiling07	; if not, branch
00893052 9368 000C                  		sub.w	d1,obY(a0)	; stop block
00893056                            
00893056                            	@noceiling07:
00893056 4E75                       		rts	
00893058                            ; ===========================================================================
00893058                            
00893058                            @fall07:
00893058 0C40 0002                  		cmpi.w	#2,d0
0089305C 6F00                       		ble.s	@loc_1216A
0089305E 7002                       		moveq	#2,d0
00893060                            
00893060                            	@loc_1216A:
00893060 D168 000C                  		add.w	d0,obY(a0)	; make the block sink with water level
00893064 6100 0000                  		bsr.w	ObjFloorDist
00893068 4A41                       		tst.w	d1
0089306A 6A00 0000                  		bpl.w	@stop07
0089306E 5241                       		addq.w	#1,d1
00893070 D368 000C                  		add.w	d1,obY(a0)
00893074                            
00893074                            	@stop07:
00893074 4E75                       		rts	
00893076                            ; ===========================================================================
00893076                            
00893076                            loc_12180:				; XREF: LBlk_Action
00893076 4A28 0038                  		tst.b	lblk_untouched(a0) ; has block been stood on or touched?
0089307A 6700                       		beq.s	locret_121C0	; if yes, branch
0089307C 0828 0003 0022             		btst	#3,obStatus(a0)	; is Sonic standing on it now?
00893082 6600                       		bne.s	loc_1219A	; if yes, branch
00893084 4A28 003E                  		tst.b	$3E(a0)
00893088 6700                       		beq.s	locret_121C0
0089308A 5928 003E                  		subq.b	#4,$3E(a0)
0089308E 6000                       		bra.s	loc_121A6
00893090                            ; ===========================================================================
00893090                            
00893090                            loc_1219A:
00893090 0C28 0040 003E             		cmpi.b	#$40,$3E(a0)
00893096 6700                       		beq.s	locret_121C0
00893098 5828 003E                  		addq.b	#4,$3E(a0)
0089309C                            
0089309C                            loc_121A6:
0089309C 1028 003E                  		move.b	$3E(a0),d0
008930A0 4EB9 0088 301C             		jsr	(CalcSine).l
008930A6 323C 0400                  		move.w	#$400,d1
008930AA C1C1                       		muls.w	d1,d0
008930AC 4840                       		swap	d0
008930AE D068 0030                  		add.w	lblk_origY(a0),d0
008930B2 3140 000C                  		move.w	d0,obY(a0)
008930B6                            
008930B6                            locret_121C0:
008930B6 4E75                       		rts	
008930B6 4E75                       		rts	
008930B8                            		include	"_maps\LZ Blocks.asm"
008930B8                            ; ---------------------------------------------------------------------------
008930B8                            ; Sprite mappings - blocks (LZ)
008930B8                            ; ---------------------------------------------------------------------------
008930B8 0000 0000                  Map_LBlock:	dc.w @sinkblock-Map_LBlock, @riseplatform-Map_LBlock
008930BC 0000 0000                  		dc.w @cork-Map_LBlock, @block-Map_LBlock
008930C0 01                         @sinkblock:	dc.b 1
008930C1 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0	; block, sinks when stood on
008930C6 02                         @riseplatform:	dc.b 2
008930C7 F40E 0069 E0               		dc.b $F4, $E, 0, $69, $E0 ; platform, rises when stood on
008930CC F40E 0075 00               		dc.b $F4, $E, 0, $75, 0
008930D1 01                         @cork:		dc.b 1
008930D2 F00F 011A F0               		dc.b $F0, $F, 1, $1A, $F0 ; cork, floats on water
008930D7 01                         @block:		dc.b 1
008930D8 F00F FDFA F0               		dc.b $F0, $F, $FD, $FA,	$F0 ; block
008930DE 00                         		even
008930DE 00                         		even
008930DE                            		include	"_incObj\62 Gargoyle.asm"
008930DE                            ; ---------------------------------------------------------------------------
008930DE                            ; Object 62 - gargoyle head (LZ)
008930DE                            ; ---------------------------------------------------------------------------
008930DE                            
008930DE                            Gargoyle:				; XREF: Obj_Index
008930DE 7000                       		moveq	#0,d0
008930E0 1028 0024                  		move.b	obRoutine(a0),d0
008930E4 323B 0000                  		move.w	Gar_Index(pc,d0.w),d1
008930E8 4EBB 1000                  		jsr	Gar_Index(pc,d1.w)
008930EC 6000 D39E                  		bra.w	RememberState
008930F0                            ; ===========================================================================
008930F0 0000                       Gar_Index:	dc.w Gar_Main-Gar_Index
008930F2 0000                       		dc.w Gar_MakeFire-Gar_Index
008930F4 0000                       		dc.w Gar_FireBall-Gar_Index
008930F6 0000                       		dc.w Gar_AniFire-Gar_Index
008930F8                            
008930F8 1E3C 5A78 96B4 D2F0        Gar_SpitRate:	dc.b 30, 60, 90, 120, 150, 180,	210, 240
00893100                            ; ===========================================================================
00893100                            
00893100                            Gar_Main:	; Routine 0
00893100 5428 0024                  		addq.b	#2,obRoutine(a0)
00893104 217C 0000 0000 0004        		move.l	#Map_Gar,obMap(a0)
0089310C 317C 42E9 0002             		move.w	#$42E9,obGfx(a0)
00893112 0028 0004 0001             		ori.b	#4,obRender(a0)
00893118 117C 0003 0018             		move.b	#3,obPriority(a0)
0089311E 117C 0010 0019             		move.b	#$10,obActWid(a0)
00893124 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
00893128 0240 000F                  		andi.w	#$F,d0		; read only the	2nd digit
0089312C 117B 00CA 001F             		move.b	Gar_SpitRate(pc,d0.w),obDelayAni(a0) ; set fireball spit rate
00893132 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0)
00893138 0228 000F 0028             		andi.b	#$F,obSubtype(a0)
0089313E                            
0089313E                            Gar_MakeFire:	; Routine 2
0089313E 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; decrement timer
00893142 6600                       		bne.s	@nofire		; if time remains, branch
00893144                            
00893144 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0) ; reset timer
0089314A 6100 B4FA                  		bsr.w	ChkObjectVisible
0089314E 6600                       		bne.s	@nofire
00893150 6100 B710                  		bsr.w	FindFreeObj
00893154 6600                       		bne.s	@nofire
00893156 137C 0062 0000             		move.b	#id_Gargoyle,0(a1) ; load fireball object
0089315C 5829 0024                  		addq.b	#4,obRoutine(a1) ; use Gar_FireBall routine
00893160 3368 0008 0008             		move.w	obX(a0),obX(a1)
00893166 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089316C 1368 0001 0001             		move.b	obRender(a0),obRender(a1)
00893172 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
00893178                            
00893178                            	@nofire:
00893178 4E75                       		rts	
0089317A                            ; ===========================================================================
0089317A                            
0089317A                            Gar_FireBall:	; Routine 4
0089317A 5428 0024                  		addq.b	#2,obRoutine(a0)
0089317E 117C 0008 0016             		move.b	#8,obHeight(a0)
00893184 117C 0008 0017             		move.b	#8,obWidth(a0)
0089318A 217C 0000 0000 0004        		move.l	#Map_Gar,obMap(a0)
00893192 317C 02E9 0002             		move.w	#$2E9,obGfx(a0)
00893198 0028 0004 0001             		ori.b	#4,obRender(a0)
0089319E 117C 0004 0018             		move.b	#4,obPriority(a0)
008931A4 117C 0098 0020             		move.b	#$98,obColType(a0)
008931AA 117C 0008 0019             		move.b	#8,obActWid(a0)
008931B0 117C 0002 001A             		move.b	#2,obFrame(a0)
008931B6 5068 000C                  		addq.w	#8,obY(a0)
008931BA 317C 0200 0010             		move.w	#$200,obVelX(a0)
008931C0 0828 0000 0022             		btst	#0,obStatus(a0)	; is gargoyle facing left?
008931C6 6600                       		bne.s	@noflip		; if not, branch
008931C8 4468 0010                  		neg.w	obVelX(a0)
008931CC                            
008931CC                            	@noflip:
008931D6                            
008931D6                            Gar_AniFire:	; Routine 6
008931D6 1038 FE05                  		move.b	(v_framebyte).w,d0
008931DA 0200 0007                  		andi.b	#7,d0
008931DE 6600                       		bne.s	@nochg
008931E0 0868 0000 001A             		bchg	#0,obFrame(a0)	; change every 8 frames
008931E6                            
008931E6                            	@nochg:
008931E6 6100 B1CA                  		bsr.w	ObjectMove
008931EA 0828 0000 0022             		btst	#0,obStatus(a0) ; is fireball moving left?
008931F0 6600                       		bne.s	@isright	; if not, branch
008931F2 76F8                       		moveq	#-8,d3
008931F4 6100 0000                  		bsr.w	ObjHitWallLeft
008931F8 4A41                       		tst.w	d1
008931FA 6B00 B20C                  		bmi.w	DeleteObject	; delete if the	fireball hits a	wall
008931FE 4E75                       		rts	
00893200                            
00893200                            	@isright:
00893200 7608                       		moveq	#8,d3
00893202 6100 0000                  		bsr.w	ObjHitWallRight
00893206 4A41                       		tst.w	d1
00893208 6B00 B1FE                  		bmi.w	DeleteObject
0089320C 4E75                       		rts	
0089320C 4E75                       		rts	
0089320E                            		include	"_maps\Gargoyle.asm"
0089320E                            ; ---------------------------------------------------------------------------
0089320E                            ; Sprite mappings - gargoyle head (LZ)
0089320E                            ; ---------------------------------------------------------------------------
0089320E 0000                       Map_Gar:	dc.w @head-Map_Gar
00893210 0000                       		dc.w @head-Map_Gar
00893212 0000                       		dc.w @fireball1-Map_Gar
00893214 0000                       		dc.w @fireball2-Map_Gar
00893216 03                         @head:		dc.b 3
00893217 F004 0000 00               		dc.b $F0, 4, 0,	0, 0
0089321C F80D 0002 F0               		dc.b $F8, $D, 0, 2, $F0
00893221 0808 000A F8               		dc.b 8,	8, 0, $A, $F8
00893226 01                         @fireball1:	dc.b 1
00893227 FC04 000D F8               		dc.b $FC, 4, 0,	$D, $F8
0089322C 01                         @fireball2:	dc.b 1
0089322D FC04 000F F8               		dc.b $FC, 4, 0,	$F, $F8
00893232                            		even
00893232                            		even
00893232                            		include	"_incObj\63 LZ Conveyor.asm"
00893232                            ; ---------------------------------------------------------------------------
00893232                            ; Object 63 - platforms	on a conveyor belt (LZ)
00893232                            ; ---------------------------------------------------------------------------
00893232                            
00893232                            LabyrinthConvey:				; XREF: Obj_Index
00893232 7000                       		moveq	#0,d0
00893234 1028 0024                  		move.b	obRoutine(a0),d0
00893238 323B 0000                  		move.w	LCon_Index(pc,d0.w),d1
0089323C 4EBB 1000                  		jsr	LCon_Index(pc,d1.w)
0089325C                            
0089325C                            LCon_Display:				; XREF: loc_1236A
0089325C 6000 B16E                  		bra.w	DisplaySprite
00893260                            ; ===========================================================================
00893260                            
00893260                            loc_1236A:				; XREF: Obj63
00893260 0C38 0002 FE11             		cmpi.b	#2,(v_act).w
00893266 6600                       		bne.s	loc_12378
00893268 0C40 FF80                  		cmpi.w	#-$80,d0
0089326C 64EE                       		bcc.s	LCon_Display
0089326E                            
0089326E                            loc_12378:
0089326E 1028 002F                  		move.b	$2F(a0),d0
00893272 6A00 B194                  		bpl.w	DeleteObject
00893276 0240 007F                  		andi.w	#$7F,d0
0089327A 45F8 F7C1                  		lea	(v_obj63).w,a2
0089327E 08B2 0000 0000             		bclr	#0,(a2,d0.w)
00893284 6000 B182                  		bra.w	DeleteObject
00893288                            ; ===========================================================================
00893288 0000                       LCon_Index:	dc.w LCon_Main-LCon_Index
0089328A 0000                       		dc.w loc_124B2-LCon_Index
0089328C 0000                       		dc.w loc_124C2-LCon_Index
0089328E 0000                       		dc.w loc_124DE-LCon_Index
00893290                            ; ===========================================================================
00893290                            
00893290                            LCon_Main:	; Routine 0
00893290 1028 0028                  		move.b	obSubtype(a0),d0
00893294 6B00 0000                  		bmi.w	loc_12460
00893298 5428 0024                  		addq.b	#2,obRoutine(a0)
0089329C 217C 0000 0000 0004        		move.l	#Map_LConv,obMap(a0)
008932A4 317C 43F6 0002             		move.w	#$43F6,obGfx(a0)
008932AA 0028 0004 0001             		ori.b	#4,obRender(a0)
008932B0 117C 0010 0019             		move.b	#$10,obActWid(a0)
008932B6 117C 0004 0018             		move.b	#4,obPriority(a0)
008932BC 0C28 007F 0028             		cmpi.b	#$7F,obSubtype(a0)
008932C2 6600                       		bne.s	loc_123E2
008932C4 5828 0024                  		addq.b	#4,obRoutine(a0)
008932C8 317C 03F6 0002             		move.w	#$3F6,obGfx(a0)
008932CE 117C 0001 0018             		move.b	#1,obPriority(a0)
008932D4 6000 0000                  		bra.w	loc_124DE
008932D8                            ; ===========================================================================
008932D8                            
008932D8                            loc_123E2:
008932D8 117C 0004 001A             		move.b	#4,obFrame(a0)
008932DE 7000                       		moveq	#0,d0
008932E0 1028 0028                  		move.b	obSubtype(a0),d0
008932E4 3200                       		move.w	d0,d1
008932E6 E648                       		lsr.w	#3,d0
008932E8 0240 001E                  		andi.w	#$1E,d0
008932EC 45FA 0000                  		lea	LCon_Data(pc),a2
008932F0 D4F2 0000                  		adda.w	(a2,d0.w),a2
008932F4 315A 0038                  		move.w	(a2)+,$38(a0)
008932F8 315A 0030                  		move.w	(a2)+,$30(a0)
008932FC 214A 003C                  		move.l	a2,$3C(a0)
00893300 0241 000F                  		andi.w	#$F,d1
00893304 E549                       		lsl.w	#2,d1
00893306 1141 0038                  		move.b	d1,$38(a0)
0089330A 117C 0004 003A             		move.b	#4,$3A(a0)
00893310 4A38 F7C0                  		tst.b	(f_conveyrev).w
00893314 6700                       		beq.s	loc_1244C
00893316 117C 0001 003B             		move.b	#1,$3B(a0)
0089331C 4428 003A                  		neg.b	$3A(a0)
00893320 7200                       		moveq	#0,d1
00893322 1228 0038                  		move.b	$38(a0),d1
00893326 D228 003A                  		add.b	$3A(a0),d1
0089332A B228 0039                  		cmp.b	$39(a0),d1
0089332E 6500                       		bcs.s	loc_12448
00893330 1001                       		move.b	d1,d0
00893332 7200                       		moveq	#0,d1
00893334 4A00                       		tst.b	d0
00893336 6A00                       		bpl.s	loc_12448
00893338 1228 0039                  		move.b	$39(a0),d1
0089333C 5901                       		subq.b	#4,d1
0089333E                            
0089333E                            loc_12448:
0089333E 1141 0038                  		move.b	d1,$38(a0)
00893342                            
00893342                            loc_1244C:
00893342 3172 1000 0034             		move.w	(a2,d1.w),$34(a0)
00893348 3172 1002 0036             		move.w	2(a2,d1.w),$36(a0)
0089334E 6100 0000                  		bsr.w	LCon_ChangeDir
00893352 6000 0000                  		bra.w	loc_124B2
00893356                            ; ===========================================================================
00893356                            
00893356                            loc_12460:				; XREF: LCon_Main
00893356 1140 002F                  		move.b	d0,$2F(a0)
0089335A 0240 007F                  		andi.w	#$7F,d0
0089335E 45F8 F7C1                  		lea	(v_obj63).w,a2
00893362 08F2 0000 0000             		bset	#0,(a2,d0.w)
00893368 6600 B09E                  		bne.w	DeleteObject
0089336C D040                       		add.w	d0,d0
0089336E 0240 001E                  		andi.w	#$1E,d0
00893372 0640 0070                  		addi.w	#ZoneCount*$10,d0
00893376 45F9 0000 0000             		lea	(ObjPos_Index).l,a2
0089337C D4F2 0000                  		adda.w	(a2,d0.w),a2
00893380 321A                       		move.w	(a2)+,d1
00893382 2248                       		movea.l	a0,a1
00893384 6000                       		bra.s	LCon_MakePtfms
00893386                            ; ===========================================================================
00893386                            
00893386                            LCon_Loop:
00893386 6100 B4DA                  		bsr.w	FindFreeObj
0089338A 6600                       		bne.s	loc_124AA
0089338C                            
0089338C                            LCon_MakePtfms:			; XREF: loc_12460
0089338C 137C 0063 0000             		move.b	#id_LabyrinthConvey,0(a1)
00893392 335A 0008                  		move.w	(a2)+,obX(a1)
00893396 335A 000C                  		move.w	(a2)+,obY(a1)
0089339A 301A                       		move.w	(a2)+,d0
0089339C 1340 0028                  		move.b	d0,obSubtype(a1)
008933A0                            
008933A0                            loc_124AA:
008933A0 51C9 FFE4                  		dbf	d1,LCon_Loop
008933A4                            
008933A4 588F                       		addq.l	#4,sp
008933A6 4E75                       		rts	
008933A8                            ; ===========================================================================
008933A8                            
008933A8                            loc_124B2:	; Routine 2
008933A8 7200                       		moveq	#0,d1
008933AA 1228 0019                  		move.b	obActWid(a0),d1
008933AE 4EB9 0088 8080             		jsr	(PlatformObject).l
008933B4 6000 0000                  		bra.w	sub_12502
008933B8                            ; ===========================================================================
008933B8                            
008933B8                            loc_124C2:	; Routine 4
008933B8 7200                       		moveq	#0,d1
008933BA 1228 0019                  		move.b	obActWid(a0),d1
008933BE 4EB9 0088 81F4             		jsr	(ExitPlatform).l
008933C4 3F28 0008                  		move.w	obX(a0),-(sp)
008933C8 6100 0000                  		bsr.w	sub_12502
008933CC 341F                       		move.w	(sp)+,d2
008933CE 4EF9 0088 8762             		jmp	(MvSonicOnPtfm2).l
008933D4                            ; ===========================================================================
008933D4                            
008933D4                            loc_124DE:	; Routine 6
008933D4 3038 FE04                  		move.w	(v_framecount).w,d0
008933D8 0240 0003                  		andi.w	#3,d0
008933DC 6600                       		bne.s	loc_124FC
008933DE 7201                       		moveq	#1,d1
008933E0 4A38 F7C0                  		tst.b	(f_conveyrev).w
008933E4 6700                       		beq.s	loc_124F2
008933E6 4401                       		neg.b	d1
008933E8                            
008933E8                            loc_124F2:
008933E8 D328 001A                  		add.b	d1,obFrame(a0)
008933EC 0228 0003 001A             		andi.b	#3,obFrame(a0)
008933F2                            
008933F2                            loc_124FC:
008933F2 588F                       		addq.l	#4,sp
008933F4 6000 D096                  		bra.w	RememberState
008933F8                            
008933F8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008933F8                            
008933F8                            
008933F8                            sub_12502:				; XREF: loc_124B2; loc_124C2
008933F8 4A38 F7EE                  		tst.b	(f_switch+$E).w
008933FC 6700                       		beq.s	loc_12520
008933FE 4A28 003B                  		tst.b	$3B(a0)
00893402 6600                       		bne.s	loc_12520
00893404 117C 0001 003B             		move.b	#1,$3B(a0)
0089340A 11FC 0001 F7C0             		move.b	#1,(f_conveyrev).w
00893410 4428 003A                  		neg.b	$3A(a0)
00893414 6000                       		bra.s	loc_12534
00893416                            ; ===========================================================================
00893416                            
00893416                            loc_12520:
00893416 3028 0008                  		move.w	obX(a0),d0
0089341A B068 0034                  		cmp.w	$34(a0),d0
0089341E 6600                       		bne.s	loc_1256A
00893420 3028 000C                  		move.w	obY(a0),d0
00893424 B068 0036                  		cmp.w	$36(a0),d0
00893428 6600                       		bne.s	loc_1256A
0089342A                            
0089342A                            loc_12534:
0089342A 7200                       		moveq	#0,d1
0089342C 1228 0038                  		move.b	$38(a0),d1
00893430 D228 003A                  		add.b	$3A(a0),d1
00893434 B228 0039                  		cmp.b	$39(a0),d1
00893438 6500                       		bcs.s	loc_12552
0089343A 1001                       		move.b	d1,d0
0089343C 7200                       		moveq	#0,d1
0089343E 4A00                       		tst.b	d0
00893440 6A00                       		bpl.s	loc_12552
00893442 1228 0039                  		move.b	$39(a0),d1
00893446 5901                       		subq.b	#4,d1
00893448                            
00893448                            loc_12552:
00893448 1141 0038                  		move.b	d1,$38(a0)
0089344C 2268 003C                  		movea.l	$3C(a0),a1
00893450 3171 1000 0034             		move.w	(a1,d1.w),$34(a0)
00893456 3171 1002 0036             		move.w	2(a1,d1.w),$36(a0)
0089345C 6100 0000                  		bsr.w	LCon_ChangeDir
00893460                            
00893460                            loc_1256A:
00893460 6100 AF50                  		bsr.w	ObjectMove
00893464 4E75                       		rts	
00893466                            ; End of function sub_12502
00893466                            
00893466                            
00893466                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00893466                            
00893466                            
00893466                            LCon_ChangeDir:			; XREF: loc_123E2; sub_12502
00893466 7000                       		moveq	#0,d0
00893468 343C FF00                  		move.w	#-$100,d2
0089346C 3028 0008                  		move.w	obX(a0),d0
00893470 9068 0034                  		sub.w	$34(a0),d0
00893474 6400                       		bcc.s	loc_12584
00893476 4440                       		neg.w	d0
00893478 4442                       		neg.w	d2
0089347A                            
0089347A                            loc_12584:
0089347A 7200                       		moveq	#0,d1
0089347C 363C FF00                  		move.w	#-$100,d3
00893480 3228 000C                  		move.w	obY(a0),d1
00893484 9268 0036                  		sub.w	$36(a0),d1
00893488 6400                       		bcc.s	loc_12598
0089348A 4441                       		neg.w	d1
0089348C 4443                       		neg.w	d3
0089348E                            
0089348E                            loc_12598:
0089348E B240                       		cmp.w	d0,d1
00893490 6500                       		bcs.s	loc_125C2
00893492 3028 0008                  		move.w	obX(a0),d0
00893496 9068 0034                  		sub.w	$34(a0),d0
0089349A 6700                       		beq.s	loc_125AE
0089349C 48C0                       		ext.l	d0
0089349E E180                       		asl.l	#8,d0
008934A0 81C1                       		divs.w	d1,d0
008934A2 4440                       		neg.w	d0
008934A4                            
008934A4                            loc_125AE:
008934A4 3140 0010                  		move.w	d0,obVelX(a0)
008934A8 3143 0012                  		move.w	d3,obVelY(a0)
008934AC 4840                       		swap	d0
008934AE 3140 000A                  		move.w	d0,obX+2(a0)
008934B2 4268 000E                  		clr.w	obY+2(a0)
008934B6 4E75                       		rts	
008934B8                            ; ===========================================================================
008934B8                            
008934B8                            loc_125C2:				; XREF: LCon_ChangeDir
008934B8 3228 000C                  		move.w	obY(a0),d1
008934BC 9268 0036                  		sub.w	$36(a0),d1
008934C0 6700                       		beq.s	loc_125D4
008934C2 48C1                       		ext.l	d1
008934C4 E181                       		asl.l	#8,d1
008934C6 83C0                       		divs.w	d0,d1
008934C8 4441                       		neg.w	d1
008934CA                            
008934CA                            loc_125D4:
008934CA 3141 0012                  		move.w	d1,obVelY(a0)
008934CE 3142 0010                  		move.w	d2,obVelX(a0)
008934D2 4841                       		swap	d1
008934D4 3141 000E                  		move.w	d1,obY+2(a0)
008934D8 4268 000A                  		clr.w	obX+2(a0)
008934DC 4E75                       		rts	
008934DE                            ; End of function LCon_ChangeDir
008934DE                            
008934DE                            ; ===========================================================================
008934DE 0000                       LCon_Data:	dc.w word_125F4-LCon_Data
008934E0 0000                       		dc.w word_12610-LCon_Data
008934E2 0000                       		dc.w word_12628-LCon_Data
008934E4 0000                       		dc.w word_1263C-LCon_Data
008934E6 0000                       		dc.w word_12650-LCon_Data
008934E8 0000                       		dc.w word_12668-LCon_Data
008934EA 0018 1070 1078 021A 10BE+  word_125F4:	dc.w $18, $1070, $1078,	$21A, $10BE, $260, $10BE, $393
008934FA 108C 03C5 1022 0390 1022+  		dc.w $108C, $3C5, $1022, $390, $1022, $244
00893506 0014 1280 127E 0280 12CE+  word_12610:	dc.w $14, $1280, $127E,	$280, $12CE, $2D0, $12CE, $46E
00893516 1232 0420 1232 02CC        		dc.w $1232, $420, $1232, $2CC
0089351E 0010 0D68 0D22 0482 0D22+  word_12628:	dc.w $10, $D68,	$D22, $482, $D22, $5DE,	$DAE, $5DE, $DAE, $482
00893532 0010 0DA0 0D62 03A2 0DEE+  word_1263C:	dc.w $10, $DA0,	$D62, $3A2, $DEE, $3A2,	$DEE, $4DE, $D62, $4DE
00893546 0014 0D00 0CAC 0242 0DDE+  word_12650:	dc.w $14, $D00,	$CAC, $242, $DDE, $242,	$DDE, $3DE, $C52, $3DE,	$C52, $29C
0089355E 0010 1300 1252 020A 13DE+  word_12668:	dc.w $10, $1300, $1252,	$20A, $13DE, $20A, $13DE, $2BE,	$1252, $2BE
0089355E 0010 1300 1252 020A 13DE+  word_12668:	dc.w $10, $1300, $1252,	$20A, $13DE, $20A, $13DE, $2BE,	$1252, $2BE
00893572                            		include	"_maps\LZ Conveyor.asm"
00893572                            ; ---------------------------------------------------------------------------
00893572                            ; Sprite mappings - platforms on a conveyor belt (LZ)
00893572                            ; ---------------------------------------------------------------------------
00893572 0000 0000                  Map_LConv:	dc.w @wheel1-Map_LConv, @wheel2-Map_LConv
00893576 0000 0000                  		dc.w @wheel3-Map_LConv, @wheel4-Map_LConv
0089357A 0000                       		dc.w @platform-Map_LConv
0089357C 01                         @wheel1:	dc.b 1
0089357D F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00893582 01                         @wheel2:	dc.b 1
00893583 F00F 0010 F0               		dc.b $F0, $F, 0, $10, $F0
00893588 01                         @wheel3:	dc.b 1
00893589 F00F 0020 F0               		dc.b $F0, $F, 0, $20, $F0
0089358E 01                         @wheel4:	dc.b 1
0089358F F00F 0030 F0               		dc.b $F0, $F, 0, $30, $F0
00893594 01                         @platform:	dc.b 1
00893595 F80D 0040 F0               		dc.b $F8, $D, 0, $40, $F0
0089359A                            		even
0089359A                            		even
0089359A                            		include	"_incObj\64 Bubbles.asm"
0089359A                            ; ---------------------------------------------------------------------------
0089359A                            ; Object 64 - bubbles (LZ)
0089359A                            ; ---------------------------------------------------------------------------
0089359A                            
0089359A                            Bubble:					; XREF: Obj_Index
0089359A 7000                       		moveq	#0,d0
0089359C 1028 0024                  		move.b	obRoutine(a0),d0
008935A0 323B 0000                  		move.w	Bub_Index(pc,d0.w),d1
008935A4 4EFB 1000                  		jmp	Bub_Index(pc,d1.w)
008935A8                            ; ===========================================================================
008935A8 0000                       Bub_Index:	dc.w Bub_Main-Bub_Index
008935AA 0000                       		dc.w Bub_Animate-Bub_Index
008935AC 0000                       		dc.w Bub_ChkWater-Bub_Index
008935AE 0000                       		dc.w Bub_Display-Bub_Index
008935B0 0000                       		dc.w Bub_Delete-Bub_Index
008935B2 0000                       		dc.w Bub_BblMaker-Bub_Index
008935B4                            
008935B4 =0000002E                  bub_inhalable:	= $2E		; flag set when bubble is collectable
008935B4 =00000030                  bub_origX:	= $30		; original x-axis position
008935B4 =00000032                  bub_time:	= $32		; time until next bubble spawn
008935B4 =00000033                  bub_freq:	= $33		; frequency of bubble spawn
008935B4                            ; ===========================================================================
008935B4                            
008935B4                            Bub_Main:	; Routine 0
008935B4 5428 0024                  		addq.b	#2,obRoutine(a0)
008935B8 217C 0000 0000 0004        		move.l	#Map_Bub,obMap(a0)
008935C0 317C 8348 0002             		move.w	#$8348,obGfx(a0)
008935C6 117C 0084 0001             		move.b	#$84,obRender(a0)
008935CC 117C 0010 0019             		move.b	#$10,obActWid(a0)
008935D2 117C 0001 0018             		move.b	#1,obPriority(a0)
008935D8 1028 0028                  		move.b	obSubtype(a0),d0 ; get bubble type
008935DC 6A00                       		bpl.s	@bubble		; if type is $0-$7F, branch
008935DE                            
008935DE 5028 0024                  		addq.b	#8,obRoutine(a0) ; goto Bub_BblMaker next
008935E2 0240 007F                  		andi.w	#$7F,d0		; read only last 7 bits	(deduct	$80)
008935E6 1140 0032                  		move.b	d0,bub_time(a0)
008935EA 1140 0033                  		move.b	d0,bub_freq(a0)	; set bubble frequency
008935EE 117C 0006 001C             		move.b	#6,obAnim(a0)
008935F4 6000 0000                  		bra.w	Bub_BblMaker
008935F8                            ; ===========================================================================
008935F8                            
008935F8                            @bubble:
008935F8 1140 001C                  		move.b	d0,obAnim(a0)
008935FC 3168 0008 0030             		move.w	obX(a0),bub_origX(a0)
00893602 317C FF78 0012             		move.w	#-$88,obVelY(a0) ; float bubble upwards
00893608 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089360E 1140 0026                  		move.b	d0,obAngle(a0)
00893612                            
00893612                            Bub_Animate:	; Routine 2
00893612 43F9 0000 0000             		lea	(Ani_Bub).l,a1
00893618 4EB9 0088 B4B0             		jsr	AnimateSprite
0089361E 0C28 0006 001A             		cmpi.b	#6,obFrame(a0)	; is bubble full-size?
00893624 6600                       		bne.s	Bub_ChkWater	; if not, branch
00893626                            
00893626 117C 0001 002E             		move.b	#1,bub_inhalable(a0) ; set "inhalable" flag
0089362C                            
0089362C                            Bub_ChkWater:	; Routine 4
0089362C 3038 F646                  		move.w	(v_waterpos1).w,d0
00893630 B068 000C                  		cmp.w	obY(a0),d0	; is bubble underwater?
00893634 6500                       		bcs.s	@wobble		; if yes, branch
00893636                            
00893636                            @burst:
00893636 117C 0006 0024             		move.b	#6,obRoutine(a0) ; goto Bub_Display next
0089363C 5628 001C                  		addq.b	#3,obAnim(a0)	; run "bursting" animation
00893640 6000 0000                  		bra.w	Bub_Display
00893644                            ; ===========================================================================
00893644                            
00893644                            @wobble:
00893644 1028 0026                  		move.b	obAngle(a0),d0
00893648 5228 0026                  		addq.b	#1,obAngle(a0)
0089364C 0240 007F                  		andi.w	#$7F,d0
00893650 43F9 0000 0000             		lea	(Drown_WobbleData).l,a1
00893656 1031 0000                  		move.b	(a1,d0.w),d0
0089365A 4880                       		ext.w	d0
0089365C D068 0030                  		add.w	bub_origX(a0),d0
00893660 3140 0008                  		move.w	d0,obX(a0)	; change bubble's x-axis position
00893664 4A28 002E                  		tst.b	bub_inhalable(a0)
00893668 6700                       		beq.s	@display
0089366A 6100 0000                  		bsr.w	Bub_ChkSonic	; has Sonic touched the	bubble?
0089366E 6700                       		beq.s	@display	; if not, branch
00893670                            		
00893670 0C29 0000 001C             		cmpi.b	#id_Spindash,obAnim(a1)
00893676 6700                       		beq.s	@display
00893678                            
00893678 6100 0000                  		bsr.w	ResumeMusic	; cancel countdown music
00893686 43F8 D000                  		lea	(v_player).w,a1
0089368A 4269 0010                  		clr.w	obVelX(a1)
0089368E 4269 0012                  		clr.w	obVelY(a1)
00893692 4269 0014                  		clr.w	obInertia(a1)	; stop Sonic
00893696 137C 0000 001C             		move.b	#id_GetAir,obAnim(a1) ; use bubble-collecting animation
0089369C 337C 0023 003E             		move.w	#$23,$3E(a1)
008936A2 137C 0000 003C             		move.b	#0,$3C(a1)
008936A8 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
008936AE                            	
008936AE                            	
008936AE 0829 0002 0022             		btst	#2,obStatus(a1)
008936B4 6700 FF80                  		beq.w	@burst
008936B8 08A9 0002 0022             		bclr	#2,obStatus(a1)
008936BE 137C 0013 0016             		move.b	#$13,obHeight(a1)
008936C4 137C 0009 0017             		move.b	#9,obWidth(a1)
008936CA 5B69 000C                  		subq.w	#5,obY(a1)
008936CE 6000 FF66                  		bra.w	@burst
008936D2                            ; ===========================================================================
008936D2                            
008936D2                            @display:
008936D2 6100 ACDE                  		bsr.w	ObjectMove
008936D6 4A28 0001                  		tst.b	obRender(a0)
008936DA 6A00                       		bpl.s	@delete
008936DC 4EF9 0088 E3CC             		jmp	DisplaySprite
008936E2                            
008936E2                            	@delete:
008936E2 4EF9 0088 E408             		jmp	DeleteObject
008936E8                            ; ===========================================================================
008936E8                            
008936E8                            Bub_Display:	; Routine 6
008936E8 43F9 0000 0000             		lea	(Ani_Bub).l,a1
008936EE 4EB9 0088 B4B0             		jsr	AnimateSprite
008936F4 4A28 0001                  		tst.b	obRender(a0)
008936F8 6A00                       		bpl.s	@delete
008936FA 4EF9 0088 E3CC             		jmp	DisplaySprite
00893700                            
00893700                            	@delete:
00893700 4EF9 0088 E408             		jmp	DeleteObject
00893706                            ; ===========================================================================
00893706                            
00893706                            Bub_Delete:	; Routine 8
00893706 6000 AD00                  		bra.w	DeleteObject
0089370A                            ; ===========================================================================
0089370A                            
0089370A                            Bub_BblMaker:	; Routine $A
0089370A 4A68 0036                  		tst.w	$36(a0)
0089370E 6600                       		bne.s	@loc_12874
00893710 3038 F646                  		move.w	(v_waterpos1).w,d0
00893714 B068 000C                  		cmp.w	obY(a0),d0	; is bubble maker underwater?
00893718 6400 0000                  		bcc.w	@chkdel		; if not, branch
0089371C 4A28 0001                  		tst.b	obRender(a0)
00893720 6A00 0000                  		bpl.w	@chkdel
00893724 5368 0038                  		subq.w	#1,$38(a0)
00893728 6A00 0000                  		bpl.w	@loc_12914
0089372C 317C 0001 0036             		move.w	#1,$36(a0)
00893732                            
00893732                            	@tryagain:
00893732 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00893738 3200                       		move.w	d0,d1
0089373A 0240 0007                  		andi.w	#7,d0
0089373E 0C40 0006                  		cmpi.w	#6,d0		; random number over 6?
00893742 64EE                       		bcc.s	@tryagain	; if yes, branch
00893744                            
00893744 1140 0034                  		move.b	d0,$34(a0)
00893748 0241 000C                  		andi.w	#$C,d1
0089374C 43F9 0000 0000             		lea	(Bub_BblTypes).l,a1
00893752 D2C1                       		adda.w	d1,a1
00893754 2149 003C                  		move.l	a1,$3C(a0)
00893758 5328 0032                  		subq.b	#1,bub_time(a0)
0089375C 6A00                       		bpl.s	@loc_12872
0089375E 1168 0033 0032             		move.b	bub_freq(a0),bub_time(a0)
00893764 08E8 0007 0036             		bset	#7,$36(a0)
0089376A                            
0089376A                            @loc_12872:
0089376A 6000                       		bra.s	@loc_1287C
0089376C                            ; ===========================================================================
0089376C                            
0089376C                            @loc_12874:
0089376C 5368 0038                  		subq.w	#1,$38(a0)
00893770 6A00 0000                  		bpl.w	@loc_12914
00893774                            
00893774                            @loc_1287C:
00893774 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089377A 0240 001F                  		andi.w	#$1F,d0
0089377E 3140 0038                  		move.w	d0,$38(a0)
00893782 6100 B0DE                  		bsr.w	FindFreeObj
00893786 6600                       		bne.s	@fail
00893788 137C 0064 0000             		move.b	#id_Bubble,0(a1) ; load bubble object
0089378E 3368 0008 0008             		move.w	obX(a0),obX(a1)
00893794 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089379A 0240 000F                  		andi.w	#$F,d0
0089379E 5140                       		subq.w	#8,d0
008937A0 D169 0008                  		add.w	d0,obX(a1)
008937A4 3368 000C 000C             		move.w	obY(a0),obY(a1)
008937AA 7000                       		moveq	#0,d0
008937AC 1028 0034                  		move.b	$34(a0),d0
008937B0 2468 003C                  		movea.l	$3C(a0),a2
008937B4 1372 0000 0028             		move.b	(a2,d0.w),obSubtype(a1)
008937BA 0828 0007 0036             		btst	#7,$36(a0)
008937C0 6700                       		beq.s	@fail
008937C2 4EB9 0088 2FF6             		jsr	(RandomNumber).l
008937C8 0240 0003                  		andi.w	#3,d0
008937CC 6600                       		bne.s	@loc_buh
008937CE 08E8 0006 0036             		bset	#6,$36(a0)
008937D4 6600                       		bne.s	@fail
008937D6 137C 0002 0028             		move.b	#2,obSubtype(a1)
008937DC                            
008937DC                            @loc_buh:
008937DC 4A28 0034                  		tst.b	$34(a0)
008937E0 6600                       		bne.s	@fail
008937E2 08E8 0006 0036             		bset	#6,$36(a0)
008937E8 6600                       		bne.s	@fail
008937EA 137C 0002 0028             		move.b	#2,obSubtype(a1)
008937F0                            
008937F0                            	@fail:
008937F0 5328 0034                  		subq.b	#1,$34(a0)
008937F4 6A00                       		bpl.s	@loc_12914
008937F6 4EB9 0088 2FF6             		jsr	(RandomNumber).l
008937FC 0240 007F                  		andi.w	#$7F,d0
00893800 0640 0080                  		addi.w	#$80,d0
00893804 D168 0038                  		add.w	d0,$38(a0)
00893808 4268 0036                  		clr.w	$36(a0)
0089380C                            
0089380C                            @loc_12914:
0089380C 43F9 0000 0000             		lea	(Ani_Bub).l,a1
00893812 4EB9 0088 B4B0             		jsr	AnimateSprite
00893818                            
00893818                            @chkdel:
00893836 3038 F646                  		move.w	(v_waterpos1).w,d0
0089383A B068 000C                  		cmp.w	obY(a0),d0
0089383E 6500 AB8C                  		bcs.w	DisplaySprite
00893842 4E75                       		rts	
00893844                            ; ===========================================================================
00893844                            ; bubble production sequence
00893844                            
00893844                            ; 0 = small bubble, 1 =	large bubble
00893844                            
00893844 0001 0000 0000 0100 0000+  Bub_BblTypes:	dc.b 0,	1, 0, 0, 0, 0, 1, 0, 0,	0, 0, 1, 0, 1, 0, 0, 1,	0
00893856                            
00893856                            ; ===========================================================================
00893856                            
00893856                            Bub_ChkSonic:				; XREF: @wobble
00893856 4A38 F7C8                  		tst.b	(f_lockmulti).w
0089385A 6B00                       		bmi.s	@loc_12998
0089385C 43F8 D000                  		lea	(v_player).w,a1
00893860 3029 0008                  		move.w	obX(a1),d0
00893864 3228 0008                  		move.w	obX(a0),d1
00893868 0441 0010                  		subi.w	#$10,d1
0089386C B240                       		cmp.w	d0,d1
0089386E 6400                       		bcc.s	@loc_12998
00893870 0641 0020                  		addi.w	#$20,d1
00893874 B240                       		cmp.w	d0,d1
00893876 6500                       		bcs.s	@loc_12998
00893878 3029 000C                  		move.w	obY(a1),d0
0089387C 3228 000C                  		move.w	obY(a0),d1
00893880 B240                       		cmp.w	d0,d1
00893882 6400                       		bcc.s	@loc_12998
00893884 0641 0010                  		addi.w	#$10,d1
00893888 B240                       		cmp.w	d0,d1
0089388A 6500                       		bcs.s	@loc_12998
0089388C 7001                       		moveq	#1,d0
0089388E 4E75                       		rts	
00893890                            ; ===========================================================================
00893890                            
00893890                            @loc_12998:
00893890 7000                       		moveq	#0,d0
00893892 4E75                       		rts	
00893892 4E75                       		rts	
00893894                            		include	"_anim\Bubbles.asm"
00893894                            ; ---------------------------------------------------------------------------
00893894                            ; Animation script - bubbles (LZ)
00893894                            ; ---------------------------------------------------------------------------
00893894 0000                       Ani_Bub:	dc.w @small-Ani_Bub
00893896 0000                       		dc.w @medium-Ani_Bub
00893898 0000                       		dc.w @large-Ani_Bub
0089389A 0000                       		dc.w @incroutine-Ani_Bub
0089389C 0000                       		dc.w @incroutine-Ani_Bub
0089389E 0000                       		dc.w @burst-Ani_Bub
008938A0 0000                       		dc.w @bubmaker-Ani_Bub
008938A2 0E00 0102 FC               @small:		dc.b $E, 0, 1, 2, afRoutine ; small bubble forming
008938A8 00                         		even
008938A8 0E01 0203 04FC             @medium:	dc.b $E, 1, 2, 3, 4, afRoutine ; medium bubble forming
008938AE 0E02 0304 0506 FC          @large:		dc.b $E, 2, 3, 4, 5, 6,	afRoutine ; full size bubble forming
008938B6 00                         		even
008938B6 04FC                       @incroutine:	dc.b 4,	afRoutine	; increment routine counter (no animation)
008938B8 0406 0708 FC               @burst:		dc.b 4,	6, 7, 8, afRoutine ; large bubble bursts
008938BE 00                         		even
008938BE 0F13 1415 FF               @bubmaker:	dc.b $F, $13, $14, $15,	afEnd ; bubble maker on the floor
008938C4 00                         		even
008938C4 00                         		even
008938C4                            		include	"_maps\Bubbles.asm"
008938C4                            ; ---------------------------------------------------------------------------
008938C4                            ; Sprite mappings - bubbles (LZ)
008938C4                            ; ---------------------------------------------------------------------------
008938C4 0000 0000                  Map_Bub:	dc.w @bubble1-Map_Bub, @bubble2-Map_Bub
008938C8 0000 0000                  		dc.w @bubble3-Map_Bub, @bubble4-Map_Bub
008938CC 0000 0000                  		dc.w @bubble5-Map_Bub, @bubble6-Map_Bub
008938D0 0000 0000                  		dc.w @bubblefull-Map_Bub, @burst1-Map_Bub
008938D4 0000 0000                  		dc.w @burst2-Map_Bub, @zero_sm-Map_Bub
008938D8 0000 0000                  		dc.w @five_sm-Map_Bub, @three_sm-Map_Bub
008938DC 0000 0000                  		dc.w @one_sm-Map_Bub, @zero-Map_Bub
008938E0 0000 0000                  		dc.w @five-Map_Bub, @four-Map_Bub
008938E4 0000 0000                  		dc.w @three-Map_Bub, @two-Map_Bub
008938E8 0000 0000                  		dc.w @one-Map_Bub, @bubmaker1-Map_Bub
008938EC 0000 0000                  		dc.w @bubmaker2-Map_Bub, @bubmaker3-Map_Bub
008938F0 0000                       		dc.w @blank-Map_Bub
008938F2 01                         @bubble1:	dc.b 1
008938F3 FC00 0000 FC               		dc.b $FC, 0, 0,	0, $FC	; bubbles, increasing in size
008938F8 01                         @bubble2:	dc.b 1
008938F9 FC00 0001 FC               		dc.b $FC, 0, 0,	1, $FC
008938FE 01                         @bubble3:	dc.b 1
008938FF FC00 0002 FC               		dc.b $FC, 0, 0,	2, $FC
00893904 01                         @bubble4:	dc.b 1
00893905 F805 0003 F8               		dc.b $F8, 5, 0,	3, $F8
0089390A 01                         @bubble5:	dc.b 1
0089390B F805 0007 F8               		dc.b $F8, 5, 0,	7, $F8
00893910 01                         @bubble6:	dc.b 1
00893911 F40A 000B F4               		dc.b $F4, $A, 0, $B, $F4
00893916 01                         @bubblefull:	dc.b 1
00893917 F00F 0014 F0               		dc.b $F0, $F, 0, $14, $F0
0089391C 04                         @burst1:	dc.b 4
0089391D F005 0024 F0               		dc.b $F0, 5, 0,	$24, $F0 ; large bubble bursting
00893922 F005 0824 00               		dc.b $F0, 5, 8,	$24, 0
00893927 0005 1024 F0               		dc.b 0,	5, $10,	$24, $F0
0089392C 0005 1824 00               		dc.b 0,	5, $18,	$24, 0
00893931 04                         @burst2:	dc.b 4
00893932 F005 0028 F0               		dc.b $F0, 5, 0,	$28, $F0
00893937 F005 0828 00               		dc.b $F0, 5, 8,	$28, 0
0089393C 0005 1028 F0               		dc.b 0,	5, $10,	$28, $F0
00893941 0005 1828 00               		dc.b 0,	5, $18,	$28, 0
00893946 01                         @zero_sm:	dc.b 1
00893947 F406 002C F8               		dc.b $F4, 6, 0,	$2C, $F8 ; small, partially-formed countdown numbers
0089394C 01                         @five_sm:	dc.b 1
0089394D F406 0032 F8               		dc.b $F4, 6, 0,	$32, $F8
00893952 01                         @three_sm:	dc.b 1
00893953 F406 0038 F8               		dc.b $F4, 6, 0,	$38, $F8
00893958 01                         @one_sm:	dc.b 1
00893959 F406 003E F8               		dc.b $F4, 6, 0,	$3E, $F8
0089395E 01                         @zero:		dc.b 1
0089395F F406 2044 F8               		dc.b $F4, 6, $20, $44, $F8 ; fully-formed countdown numbers
00893964 01                         @five:		dc.b 1
00893965 F406 204A F8               		dc.b $F4, 6, $20, $4A, $F8
0089396A 01                         @four:		dc.b 1
0089396B F406 2050 F8               		dc.b $F4, 6, $20, $50, $F8
00893970 01                         @three:		dc.b 1
00893971 F406 2056 F8               		dc.b $F4, 6, $20, $56, $F8
00893976 01                         @two:		dc.b 1
00893977 F406 205C F8               		dc.b $F4, 6, $20, $5C, $F8
0089397C 01                         @one:		dc.b 1
0089397D F406 2062 F8               		dc.b $F4, 6, $20, $62, $F8
00893982 01                         @bubmaker1:	dc.b 1
00893983 F805 0068 F8               		dc.b $F8, 5, 0,	$68, $F8
00893988 01                         @bubmaker2:	dc.b 1
00893989 F805 006C F8               		dc.b $F8, 5, 0,	$6C, $F8
0089398E 01                         @bubmaker3:	dc.b 1
0089398F F805 0070 F8               		dc.b $F8, 5, 0,	$70, $F8
00893994 00                         @blank:		dc.b 0
00893996 00                         		even
00893996 00                         		even
00893996                            		include	"_incObj\65 Waterfalls.asm"
00893996                            ; ---------------------------------------------------------------------------
00893996                            ; Object 65 - waterfalls (LZ)
00893996                            ; ---------------------------------------------------------------------------
00893996                            
00893996                            Waterfall:				; XREF: Obj_Index
00893996 7000                       		moveq	#0,d0
00893998 1028 0024                  		move.b	obRoutine(a0),d0
0089399C 323B 0000                  		move.w	WFall_Index(pc,d0.w),d1
008939A0 4EFB 1000                  		jmp	WFall_Index(pc,d1.w)
008939A4                            ; ===========================================================================
008939A4 0000                       WFall_Index:	dc.w WFall_Main-WFall_Index
008939A6 0000                       		dc.w WFall_Animate-WFall_Index
008939A8 0000                       		dc.w WFall_ChkDel-WFall_Index
008939AA 0000                       		dc.w WFall_OnWater-WFall_Index
008939AC 0000                       		dc.w loc_12B36-WFall_Index
008939AE                            ; ===========================================================================
008939AE                            
008939AE                            WFall_Main:	; Routine 0
008939AE 5828 0024                  		addq.b	#4,obRoutine(a0)
008939B2 217C 0000 0000 0004        		move.l	#Map_WFall,obMap(a0)
008939BA 317C 4259 0002             		move.w	#$4259,obGfx(a0)
008939C0 0028 0004 0001             		ori.b	#4,obRender(a0)
008939C6 117C 0018 0019             		move.b	#$18,obActWid(a0)
008939CC 117C 0001 0018             		move.b	#1,obPriority(a0)
008939D2 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
008939D6 6A00                       		bpl.s	@under80	; branch if $00-$7F
008939D8 08E8 0007 0002             		bset	#7,obGfx(a0)
008939DE                            
008939DE                            	@under80:
008939DE 0200 000F                  		andi.b	#$F,d0		; read only the	2nd digit
008939E2 1140 001A                  		move.b	d0,obFrame(a0)	; set frame number
008939E6 0C00 0009                  		cmpi.b	#9,d0		; is object type $x9 ?
008939EA 6600                       		bne.s	WFall_ChkDel	; if not, branch
008939EC                            
008939EC 4228 0018                  		clr.b	obPriority(a0)	; object is in front of Sonic
008939F0 5528 0024                  		subq.b	#2,obRoutine(a0) ; goto WFall_Animate next
008939F4 0828 0006 0028             		btst	#6,obSubtype(a0) ; is object type $49 ?
008939FA 6700                       		beq.s	@not49		; if not, branch
008939FC                            
008939FC 117C 0006 0024             		move.b	#6,obRoutine(a0) ; goto WFall_OnWater next
00893A02                            
00893A02                            	@not49:
00893A02 0828 0005 0028             		btst	#5,obSubtype(a0) ; is object type $A9 ?
00893A08 6700                       		beq.s	WFall_Animate	; if not, branch
00893A0A 117C 0008 0024             		move.b	#8,obRoutine(a0) ; goto loc_12B36 next
00893A10                            
00893A10                            WFall_Animate:	; Routine 2
00893A10 43F9 0000 0000             		lea	(Ani_WFall).l,a1
00893A16 4EB9 0088 B4B0             		jsr	AnimateSprite
00893A1C                            
00893A1C                            WFall_ChkDel:	; Routine 4
00893A1C 6000 CA6E                  		bra.w	RememberState
00893A20                            ; ===========================================================================
00893A20                            
00893A20                            WFall_OnWater:	; Routine 6
00893A20 3038 F646                  		move.w	(v_waterpos1).w,d0
00893A24 0440 0010                  		subi.w	#$10,d0
00893A28 3140 000C                  		move.w	d0,obY(a0)	; match	object position	to water height
00893A2C 60E2                       		bra.s	WFall_Animate
00893A2E                            ; ===========================================================================
00893A2E                            
00893A2E                            loc_12B36:	; Routine 8
00893A2E 08A8 0007 0002             		bclr	#7,obGfx(a0)
00893A34 0C38 0007 A506             		cmpi.b	#7,(v_lvllayout+$106).w
00893A3A 6600                       		bne.s	@animate
00893A3C 08E8 0007 0002             		bset	#7,obGfx(a0)
00893A42                            
00893A42                            	@animate:
00893A42 60CC                       		bra.s	WFall_Animate
00893A42 60CC                       		bra.s	WFall_Animate
00893A44                            		include	"_anim\Waterfalls.asm"
00893A44                            ; ---------------------------------------------------------------------------
00893A44                            ; Animation script - waterfall (LZ)
00893A44                            ; ---------------------------------------------------------------------------
00893A44 0000                       Ani_WFall:	dc.w @splash-Ani_WFall
00893A46 0509 0A0B FF               @splash:	dc.b 5,	9, $A, $B, afEnd
00893A4C 00                         		even
00893A4C 00                         		even
00893A4C                            		include	"_maps\Waterfalls.asm"
00893A4C                            ; ---------------------------------------------------------------------------
00893A4C                            ; Sprite mappings - waterfalls (LZ)
00893A4C                            ; ---------------------------------------------------------------------------
00893A4C 0000 0000                  Map_WFall:	dc.w @vertnarrow-Map_WFall, @cornerwide-Map_WFall
00893A50 0000 0000                  		dc.w @cornermedium-Map_WFall, @cornernarrow-Map_WFall
00893A54 0000 0000                  		dc.w @cornermedium2-Map_WFall, @cornernarrow2-Map_WFall
00893A58 0000 0000                  		dc.w @cornernarrow3-Map_WFall, @vertwide-Map_WFall
00893A5C 0000 0000                  		dc.w @diagonal-Map_WFall, @splash1-Map_WFall
00893A60 0000 0000                  		dc.w @splash2-Map_WFall, @splash3-Map_WFall
00893A64 01                         @vertnarrow:	dc.b 1
00893A65 F007 0000 F8               		dc.b $F0, 7, 0,	0, $F8
00893A6A 02                         @cornerwide:	dc.b 2
00893A6B F804 0008 FC               		dc.b $F8, 4, 0,	8, $FC
00893A70 0008 000A F4               		dc.b 0,	8, 0, $A, $F4
00893A75 02                         @cornermedium:	dc.b 2
00893A76 F800 0008 00               		dc.b $F8, 0, 0,	8, 0
00893A7B 0004 000D F8               		dc.b 0,	4, 0, $D, $F8
00893A80 01                         @cornernarrow:	dc.b 1
00893A81 F801 000F 00               		dc.b $F8, 1, 0,	$F, 0
00893A86 02                         @cornermedium2:	dc.b 2
00893A87 F800 0008 00               		dc.b $F8, 0, 0,	8, 0
00893A8C 0004 000D F8               		dc.b 0,	4, 0, $D, $F8
00893A91 01                         @cornernarrow2:	dc.b 1
00893A92 F801 0011 00               		dc.b $F8, 1, 0,	$11, 0
00893A97 01                         @cornernarrow3:	dc.b 1
00893A98 F801 0013 00               		dc.b $F8, 1, 0,	$13, 0
00893A9D 01                         @vertwide:	dc.b 1
00893A9E F007 0015 F8               		dc.b $F0, 7, 0,	$15, $F8
00893AA3 02                         @diagonal:	dc.b 2
00893AA4 F80C 001D F6               		dc.b $F8, $C, 0, $1D, $F6
00893AA9 000C 0021 E8               		dc.b 0,	$C, 0, $21, $E8
00893AAE 02                         @splash1:	dc.b 2
00893AAF F00B 0025 E8               		dc.b $F0, $B, 0, $25, $E8
00893AB4 F00B 0031 00               		dc.b $F0, $B, 0, $31, 0
00893AB9 02                         @splash2:	dc.b 2
00893ABA F00B 003D E8               		dc.b $F0, $B, 0, $3D, $E8
00893ABF F00B 0049 00               		dc.b $F0, $B, 0, $49, 0
00893AC4 02                         @splash3:	dc.b 2
00893AC5 F00B 0055 E8               		dc.b $F0, $B, 0, $55, $E8
00893ACA F00B 0061 00               		dc.b $F0, $B, 0, $61, 0
00893AD0 00                         		even
00893AD0 00                         		even
00893AD0                            		
00893AD0                            		include "_incObj\(Mercury) Sonic Effects.asm"
00893AD0                            ; ----------------------------------------------------------------------------
00893AD0                            ; Object 05 - Sonic Effects (Spin Dash Dust, Insta-Shield, etc.)
00893AD0                            ; ----------------------------------------------------------------------------
00893AD0                            SonicEffects:
00893AD0 7000                       		moveq	#0,d0
00893AD2 1028 0024                  		move.b	obRoutine(a0),d0 
00893AD6 323B 0000                  		move.w	Dust_Index(pc,d0.w),d1
00893ADA 4EFB 1000                  		jmp	Dust_Index(pc,d1.w)
00893ADE                            ; ===========================================================================
00893ADE                            Dust_Index:
00893ADE 0000                       		dc.w Dust_Init-Dust_Index
00893AE0 0000                       		dc.w Dust_Main-Dust_Index
00893AE2                            ; ===========================================================================
00893AE2                            Dust_Init:
00893AE2 5428 0024                  		addq.b	#2,obRoutine(a0)
00893AE6 217C 0000 0000 0004        		move.l	#Map_Dust,obMap(a0)
00893AEE 0028 0004 0001             		ori.b	#4,obRender(a0)
00893AF4 117C 0001 0018             		move.b	#1,obPriority(a0)
00893AFA 117C 0010 0019             		move.b	#$10,obActWid(a0)
00893B00 117C 0000 001C             		move.b	#0,obAnim(a0)
00893B06 317C 07A0 0002             		move.w	#$7A0,obGfx(a0)
00893B0C 317C F400 003C             		move.w	#$F400,$3C(a0)
00893B12                            ; ===========================================================================
00893B12                            Dust_Main:
00893B12 0838 0000 D039             		btst	#staSpinDash,(v_player+obStatus2).w		; is Player Spin Dashing?	;Mercury Constants
00893B18                            
00893B18                            	
00893B18 6700                       		beq.s	@return
00893B1A                            	
00893B1A                            	@active:
00893B1A 45F9 FFFF D000             		lea	(v_player).l,a2
00893B20 316A 0008 0008             		move.w	obX(a2),obX(a0)		; match Player's position
00893B26 316A 000C 000C             		move.w	obY(a2),obY(a0)
00893B2C 116A 0022 0022             		move.b	obStatus(a2),obStatus(a0)	; match Player's x orientation
00893B32 08A8 0000 0001             		bclr	#staFacing,obRender(a0)	;Mercury Constants
00893B38 0228 0001 0022             		andi.b	#1,obStatus(a0)
00893B3E 6700                       		beq.s	@display
00893B40 08E8 0000 0001             		bset	#staFacing,obRender(a0)	;Mercury Constants
00893B46                            
00893B46                            	@display:
00893B46 43F9 0000 0000             		lea	(Ani_Dust).l,a1
00893B4C 4EB9 0088 B4B0             		jsr	AnimateSprite
00893B52 6100                       		bsr.s	Dust_LoadArt
00893B54 4EF9 0088 E3CC             		jmp	DisplaySprite
00893B5A                            
00893B5A                            	@return:
00893B5A 4E75                       		rts
00893B5C                            ; ===========================================================================
00893B5C                            Dust_LoadArt:
00893B5C 7000                       		moveq	#0,d0
00893B5E 1028 001A                  		move.b	obFrame(a0),d0
00893B62 B028 0030                  		cmp.b	$30(a0),d0
00893B66 6700                       		beq.s	return_1DF36
00893B68 1140 0030                  		move.b	d0,$30(a0)
00893B6C 45F9 0000 0000             		lea	(DynPLC_Dust).l,a2
00893B72 D040                       		add.w	d0,d0
00893B74 D4F2 0000                  		adda.w	(a2,d0.w),a2
00893B78 3A1A                       		move.w	(a2)+,d5
00893B7A 5345                       		subq.w	#1,d5
00893B7C 6B00                       		bmi.s	return_1DF36
00893B7E 3828 003C                  		move.w	$3C(a0),d4
00893B82                            
00893B82                            	@loop:
00893B82 7200                       		moveq	#0,d1
00893B84 321A                       		move.w	(a2)+,d1
00893B86 3601                       		move.w	d1,d3
00893B88 E04B                       		lsr.w	#8,d3
00893B8A 0243 00F0                  		andi.w	#$F0,d3
00893B8E 0643 0010                  		addi.w	#$10,d3
00893B92 0241 0FFF                  		andi.w	#$FFF,d1
00893B96 EB89                       		lsl.l	#5,d1
00893B98 0681 0000 0000             		addi.l	#Art_Dust-$800000,d1
00893B9E 3404                       		move.w	d4,d2
00893BA0 D843                       		add.w	d3,d4
00893BA2 D843                       		add.w	d3,d4
00893BA4 4EB9 0088 199A             		jsr	(QueueDMATransfer).l
00893BAA 51CD FFD6                  		dbf	d5,@loop
00893BAE                            
00893BAE                            	return_1DF36:
00893BAE 4E75                       		rts
00893BB0                            ; ===========================================================================
00893BB0                            Ani_Dust:
00893BB0 0000                       		dc.w Ani_DustNull-Ani_Dust
00893BB2 0000                       		dc.w Ani_Dust1-Ani_Dust
00893BB4                            		
00893BB4                            		
00893BB4 1F00 FF                    Ani_DustNull:	dc.b	$1F, 0, afEnd
00893BB7 0101 0203 0405 0607 FF     Ani_Dust1:	dc.b	1, 1, 2, 3, 4, 5, 6, 7, afEnd
00893BC0                            
00893BC0                            
00893BC0                            		even
00893BC0                            ; ===========================================================================
00893BC0                            Map_Dust:
00893BC0 0000                       		dc.w Map_DustNull-Map_Dust
00893BC2 0000                       		dc.w Map_Dust1-Map_Dust
00893BC4 0000                       		dc.w Map_Dust1-Map_Dust
00893BC6 0000                       		dc.w Map_Dust1-Map_Dust
00893BC8 0000                       		dc.w Map_Dust2-Map_Dust
00893BCA 0000                       		dc.w Map_Dust3-Map_Dust
00893BCC 0000                       		dc.w Map_Dust4-Map_Dust
00893BCE 0000                       		dc.w Map_Dust4-Map_Dust
00893BD0                            	
00893BD0                            	
00893BD0 00                         Map_DustNull:	dc.b 0
00893BD1 01                         Map_Dust1:	dc.b 1
00893BD2 040D 0000 E0               		dc.b $4, $0D, $0, 0,$E0
00893BD7 02                         Map_Dust2:	dc.b 2
00893BD8 F401 0000 E8               		dc.b $F4, $01, $0, 0,$E8
00893BDD 040D 0002 E0               		dc.b $4, $0D, $0, 2,$E0
00893BE2 02                         Map_Dust3:	dc.b 2
00893BE3 F405 0000 E8               		dc.b $F4, $05, $0, 0,$E8
00893BE8 040D 0004 E0               		dc.b $4, $0D, $0, 4,$E0
00893BED 02                         Map_Dust4:	dc.b 2
00893BEE F409 0000 E0               		dc.b $F4, $09, $0, 0,$E0
00893BF3 040D 0006 E0               		dc.b $4, $0D, $0, 6,$E0
00893BF8                            ; ===========================================================================
00893BF8                            
00893BF8                            
00893BF8                            		even
00893BF8                            ; ===========================================================================
00893BF8                            DynPLC_Dust:	
00893BF8 0000                       		dc.w DynPLC_DustNull-DynPLC_Dust
00893BFA 0000                       		dc.w DynPLC_Dust1-DynPLC_Dust
00893BFC 0000                       		dc.w DynPLC_Dust2-DynPLC_Dust
00893BFE 0000                       		dc.w DynPLC_Dust3-DynPLC_Dust
00893C00 0000                       		dc.w DynPLC_Dust4-DynPLC_Dust
00893C02 0000                       		dc.w DynPLC_Dust5-DynPLC_Dust
00893C04 0000                       		dc.w DynPLC_Dust6-DynPLC_Dust
00893C06 0000                       		dc.w DynPLC_Dust7-DynPLC_Dust
00893C08                            		
00893C08                            		
00893C08 0000                       DynPLC_DustNull:	dc 0
00893C0A 0001                       DynPLC_Dust1:	dc 1
00893C0C 7000                       		dc.w $7000
00893C0E 0001                       DynPLC_Dust2:	dc 1
00893C10 7008                       		dc.w $7008
00893C12 0001                       DynPLC_Dust3:	dc 1
00893C14 7010                       		dc.w $7010
00893C16 0002                       DynPLC_Dust4:	dc 2
00893C18 1018                       		dc.w $1018
00893C1A 701A                       		dc.w $701A
00893C1C 0002                       DynPLC_Dust5:	dc 2
00893C1E 3022                       		dc.w $3022
00893C20 7026                       		dc.w $7026
00893C22 0002                       DynPLC_Dust6:	dc 2
00893C24 502E                       		dc.w $502E
00893C26 7034                       		dc.w $7034
00893C28 0002                       DynPLC_Dust7:	dc 2
00893C2A 503C                       		dc.w $503C
00893C2C 7042                       		dc.w $7042
00893C2E                            ; ===========================================================================
00893C2E                            
00893C2E                            
00893C2E                            		even
00893C2E                            		even
00893C2E                            
00893C2E                            ; ===========================================================================
00893C2E                            ; ---------------------------------------------------------------------------
00893C2E                            ; Object 01 - Sonic
00893C2E                            ; ---------------------------------------------------------------------------
00893C2E                            
00893C2E                            SonicPlayer:				; XREF: Obj_Index
00893C2E 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	being used?
00893C32 6700                       		beq.s	Sonic_Normal	; if not, branch
00893C34 4EF9 0000 0000             		jmp	DebugMode
00893C3A                            ; ===========================================================================
00893C3A                            
00893C3A                            Sonic_Normal:
00893C3A 13FC 0000 00A1 5126        		move.b	#0, MARS_SYS_COMM6			; Clear 32X Angle Register
00893C42 0C28 0000 0022             		cmp.b	#0, obStatus(a0)			; Is Sonic is in his normal (ground) routine
00893C48 6600 0000                  		bne		@Continue					; If not, branch
00893C4C 13E8 0026 00A1 5126        		move.b	obAngle(a0), MARS_SYS_COMM6	; Update Sonic's Angle
00893C54                            @Continue:
00893C54 7000                       		moveq	#0,d0		
00893C56 1028 0024                  		move.b	obRoutine(a0),d0	
00893C5A 323B 0000                  		move.w	Sonic_Index(pc,d0.w),d1
00893C5E 4EFB 1000                  		jmp	Sonic_Index(pc,d1.w)
00893C62                            ; ===========================================================================
00893C62                            Sonic_Index:	
00893C62 0000                       		dc.w Sonic_Main-Sonic_Index
00893C64 0000                       		dc.w Sonic_Control-Sonic_Index
00893C66 0000                       		dc.w Sonic_Hurt-Sonic_Index
00893C68 0000                       		dc.w Sonic_Death-Sonic_Index
00893C6A 0000                       		dc.w Sonic_ResetLevel-Sonic_Index
00893C6C                            ; ===========================================================================
00893C6C                            
00893C6C                            Sonic_Main:	; Routine 0
00893C6C 5428 0024                  		addq.b	#2,obRoutine(a0)
00893C70 117C 0013 0016             		move.b	#$13,obHeight(a0)
00893C76 117C 0009 0017             		move.b	#9,obWidth(a0)
00893C7C 217C 0000 0000 0004        		move.l	#Map_Sonic,obMap(a0)
00893C84 317C 0780 0002             		move.w	#$780,obGfx(a0)
00893C8A 117C 0002 0018             		move.b	#2,obPriority(a0)
00893C90 117C 0018 0019             		move.b	#$18,obActWid(a0)
00893C96 117C 0004 0001             		move.b	#4,obRender(a0)
00893C9C 31FC 0600 F760             		move.w	#$600,(v_sonspeedmax).w ; Sonic's top speed
00893CA2 31FC 000C F762             		move.w	#$C,(v_sonspeedacc).w ; Sonic's acceleration
00893CA8 31FC 0080 F764             		move.w	#$80,(v_sonspeeddec).w ; Sonic's deceleration
00893CAE                            
00893CAE 11FC 0005 D1C0             		move.b	#id_SonicEffects,(v_objspace+$1C0).w
00893CB4                            
00893CB4                            Sonic_Control:	; Routine 2
00893CB4                            
00893CB4 4A28 002C                  		tst.b	obWallJump(a0)
00893CB8 6700                       		beq.s	@nodec
00893CBA 5328 002C                  		subq.b	#1,obWallJump(a0)
00893CBE 6600                       		bne.s	@chkLR
00893CC0 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "jumping" animation
00893CC6                            		
00893CC6                            	@chkLR:
00893CC6 1038 F602                  		move.b	(v_jpadhold2).w,d0	; get jpad
00893CCA C028 002D                  		and.b	(obWallJump+1)(a0),d0	; compare jpad to stored L,R button states
00893CCE 6600                       		bne.s	@skip		; if still held, branch
00893CD0 317C 0000 002C             		move.w	#0,obWallJump(a0)	; clear wall jump flag and button states
00893CD6 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "jumping" animation
00893CDC                            	
00893CDC                            	@skip:
00893CDC                            		;Mercury Wall Jump Smoke Puff
00893CDC                            		;USES Smoke Puff
00893CDC                            	;	move.b	(v_framebyte).w,d0
00893CDC                            	;	andi.b	#7,d0
00893CDC                            	;	cmpi.b	#7,d0
00893CDC                            	;	bne.s	@nodec
00893CDC                            	;create puff
00893CDC                            	;	bsr.w	FindFreeObj
00893CDC                            	;	bne.s	@nodec
00893CDC                            	;	move.b	#id_SmokePuff,0(a1) ; load missile object
00893CDC                            	;	move.w	obX(a0),obX(a1)
00893CDC                            	;	move.w	obY(a0),obY(a1)
00893CDC                            	;	addi.w	#$1C,obY(a1)
00893CDC                            	;	move.b	#1,obSubtype(a1)
00893CDC                            		;end Wall Jump Smoke Puff
00893CDC                            		
00893CDC                            	@nodec:
00893CDC                            	
00893CDC 4A78 FFFA                  		tst.w	(f_debugmode).w	; is debug cheat enabled?
00893CE0 6700                       		beq.s	loc_12C58	; if not, branch
00893CE2 0838 0004 F605             		btst	#bitB,(v_jpadpress1).w ; is button B pressed?
00893CE8 6700                       		beq.s	loc_12C58	; if not, branch
00893CEA 31FC 0001 FE08             		move.w	#1,(v_debuguse).w ; change Sonic into a ring/item
00893CF0 4238 F7CC                  		clr.b	(f_lockctrl).w
00893CF4 4E75                       		rts	
00893CF6                            ; ===========================================================================
00893CF6                            
00893CF6                            loc_12C58:
00893CF6 4A38 F7CC                  		tst.b	(f_lockctrl).w	; are controls locked?
00893CFA 6600                       		bne.s	loc_12C64	; if yes, branch
00893CFC 31F8 F604 F602             		move.w	(v_jpadhold1).w,(v_jpadhold2).w ; enable joypad control
00893D02                            
00893D02                            loc_12C64:
00893D02 0838 0000 F7C8             		btst	#0,(f_lockmulti).w ; are controls locked?
00893D08 6600                       		bne.s	loc_12C7E	; if yes, branch
00893D0A 7000                       		moveq	#0,d0
00893D0C 1028 0022                  		move.b	obStatus(a0),d0
00893D10 0240 0006                  		andi.w	#6,d0
00893D14                            		
00893D14 323B 0000                  		move.w	Sonic_Modes(pc,d0.w),d1
00893D18 4EBB 1000                  		jsr	Sonic_Modes(pc,d1.w)
00893D1C                            
00893D1C                            loc_12C7E:
00893D1C 6100                       		bsr.s	Sonic_Display
00893D1E 6100 0000                  		bsr.w	Sonic_RecordPosition
00893D22 6100 0000                  		bsr.w	Sonic_Water
00893D26 1178 F768 0036             		move.b	(v_anglebuffer).w,$36(a0)
00893D2C 1178 F76A 0037             		move.b	($FFFFF76A).w,$37(a0)
00893D32 4A38 F7C7                  		tst.b	(f_wtunnelmode).w
00893D36 6700                       		beq.s	loc_12CA6
00893D38 4A28 001C                  		tst.b	obAnim(a0)
00893D3C 6600                       		bne.s	loc_12CA6
00893D3E 1168 001D 001C             		move.b	obNextAni(a0),obAnim(a0)
00893D44                            
00893D44                            loc_12CA6:
00893D44 6100 0000                  		bsr.w	Sonic_Animate
00893D48 4A38 F7C8                  		tst.b	(f_lockmulti).w
00893D4C 6B00                       		bmi.s	loc_12CB6
00893D4E 4EB9 0000 0000             		jsr	ReactToItem
00893D54                            
00893D54                            loc_12CB6:
00893D54 6100 0000                  		bsr.w	Sonic_Loops
00893D58 6100 0000                  		bsr.w	Sonic_LoadGfx
00893D5C 4E75                       		rts	
00893D5E                            ; ===========================================================================
00893D5E                            Sonic_Modes:	
00893D5E 0000                       		dc.w Sonic_MdNormal-Sonic_Modes
00893D60 0000                       		dc.w Sonic_MdJump-Sonic_Modes
00893D62 0000                       		dc.w Sonic_MdRoll-Sonic_Modes
00893D64 0000                       		dc.w Sonic_MdJump2-Sonic_Modes
00893D66                            ; ---------------------------------------------------------------------------
00893D66                            ; Music	to play	after invincibility wears off
00893D66                            ; ---------------------------------------------------------------------------
00893D66 0102 0304 0506             MusicList2:	dc.b bgm_GHZ, bgm_LZ, bgm_MZ, bgm_SLZ, bgm_SYZ, bgm_SBZ
00893D6C                            		even
00893D6C                            
00893D6C                            		include	"_incObj\Sonic Display.asm"
00893D6C                            ; ---------------------------------------------------------------------------
00893D6C                            ; Subroutine to display Sonic and set music
00893D6C                            ; ---------------------------------------------------------------------------
00893D6C =00000030                  flashtime:	= $30		; time between flashes after getting hit
00893D6C =00000032                  invtime:	= $32		; time left for invincibility
00893D6C =00000034                  shoetime:	= $34		; time left for speed shoes
00893D6C                            
00893D6C                            Sonic_Display:
00893D6C 3028 0030                  		move.w	flashtime(a0),d0
00893D70 6700                       		beq.s	@display
00893D72 5368 0030                  		subq.w	#1,flashtime(a0)
00893D76 E648                       		lsr.w	#3,d0
00893D78 6400                       		bcc.s	@chkinvincible
00893D7A                            
00893D7A                            	@display:
00893D7A 4EB9 0088 E3CC             		jsr	DisplaySprite
00893D80                            
00893D80                            	@chkinvincible:
00893D80 4A38 FE2D                  		tst.b	(v_invinc).w	; does Sonic have invincibility?
00893D84 6700                       		beq.s	@chkshoes	; if not, branch
00893D86 4A68 0032                  		tst.w	invtime(a0)	; check	time remaining for invinciblity
00893D8A 6700                       		beq.s	@chkshoes	; if no	time remains, branch
00893D8C 5368 0032                  		subq.w	#1,invtime(a0)	; subtract 1 from time
00893D90 6600                       		bne.s	@chkshoes
00893D92 4A38 F7AA                  		tst.b	(f_lockscreen).w
00893D96 6600                       		bne.s	@removeinvincible
00893D98 0C78 000C FE14             		cmpi.w	#$C,(v_air).w
00893D9E 6500                       		bcs.s	@removeinvincible
00893DA0 7000                       		moveq	#0,d0
00893DA2 1038 FE10                  		move.b	(v_zone).w,d0
00893DA6 0C78 0103 FE10             		cmpi.w	#(id_LZ<<8)+3,(v_zone).w ; check if level is SBZ3
00893DAC 6600                       		bne.s	@music
00893DAE 7005                       		moveq	#5,d0		; play SBZ music
00893DB0                            
00893DB0                            	@music:
00893DB0 43F9 0089 3D66             		lea	(MusicList2).l,a1
00893DB6 1031 0000                  		move.b	(a1,d0.w),d0
00893DBA 4EB9 0088 183C             		jsr	(PlaySound).l	; play normal music
00893DC0                            
00893DC0                            	@removeinvincible:
00893DC0 11FC 0000 FE2D             		move.b	#0,(v_invinc).w ; cancel invincibility
00893DC6                            
00893DC6                            	@chkshoes:
00893DC6 4A38 FE2E                  		tst.b	(v_shoes).w	; does Sonic have speed	shoes?
00893DCA 6700                       		beq.s	@exit		; if not, branch
00893DCC 4A68 0034                  		tst.w	shoetime(a0)	; check	time remaining
00893DD0 6700                       		beq.s	@exit
00893DD2 5368 0034                  		subq.w	#1,shoetime(a0)	; subtract 1 from time
00893DD6 6600                       		bne.s	@exit
00893DD8 31FC 0600 F760             		move.w	#$600,(v_sonspeedmax).w ; restore Sonic's speed
00893DDE 31FC 000C F762             		move.w	#$C,(v_sonspeedacc).w ; restore Sonic's acceleration
00893DE4 31FC 0080 F764             		move.w	#$80,(v_sonspeeddec).w ; restore Sonic's deceleration
00893DEA                            		
00893DEA                            	;Mercury Speed Shoes Work Underwater
00893DEA 0828 0006 0022             		btst	#staWater,obStatus(a0)	; is Sonic underwater?	;Mercury Constants
00893DF0 6700                       		beq.s	@isdry		; if not, branch
00893DF2 31FC 0300 F760             		move.w	#$300,(v_sonspeedmax).w ; change Sonic's top speed
00893DF8 31FC 0006 F762             		move.w	#$6,(v_sonspeedacc).w	; change Sonic's acceleration
00893DFE 31FC 0040 F764             		move.w	#$40,(v_sonspeeddec).w	; change Sonic's deceleration
00893E04                            	@isdry:
00893E04                            	;end Speed Shoes Work Underwater
00893E04                            		
00893E04 11FC 0000 FE2E             		move.b	#0,(v_shoes).w	; cancel speed shoes
00893E0A 303C 0000                  		move.w	#$0,d0
00893E0E 4EF9 0088 18B4             		jmp	(SetTempo).l	; run music at normal speed
00893E14                             
00893E14                            
00893E14                            	@exit:
00893E14 4E75                       		rts	
00893E14 4E75                       		rts	
00893E16                            		include	"_incObj\Sonic RecordPosition.asm"
00893E16                            ; ---------------------------------------------------------------------------
00893E16                            ; Subroutine to	record Sonic's previous positions for invincibility stars
00893E16                            ; ---------------------------------------------------------------------------
00893E16                            
00893E16                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00893E16                            
00893E16                            
00893E16                            Sonic_RecordPosition:			; XREF: loc_12C7E; Obj01_Hurt; Obj01_Death
00893E16 3038 F7A8                  		move.w	(v_trackpos).w,d0
00893E1A 43F8 CB00                  		lea	(v_tracksonic).w,a1
00893E1E 43F1 0000                  		lea	(a1,d0.w),a1
00893E22 32E8 0008                  		move.w	obX(a0),(a1)+
00893E26 32E8 000C                  		move.w	obY(a0),(a1)+
00893E2A 5838 F7A9                  		addq.b	#4,(v_trackbyte).w
00893E2E 4E75                       		rts	
00893E30                            ; End of function Sonic_RecordPosition
00893E30                            ; End of function Sonic_RecordPosition
00893E30                            		include	"_incObj\Sonic Water.asm"
00893E30                            ; ---------------------------------------------------------------------------
00893E30                            ; Subroutine for Sonic when he's underwater
00893E30                            ; ---------------------------------------------------------------------------
00893E30                            
00893E30                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00893E30                            
00893E30                            
00893E30                            Sonic_Water:				; XREF: loc_12C7E
00893E30 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w	; is level LZ?
00893E36 6700                       		beq.s	@islabyrinth	; if yes, branch
00893E38                            
00893E38                            	@exit:
00893E38 4E75                       		rts	
00893E3A                            ; ===========================================================================
00893E3A                            
00893E3A                            	@islabyrinth:
00893E3A 3038 F646                  		move.w	(v_waterpos1).w,d0
00893E3E B068 000C                  		cmp.w	obY(a0),d0	; is Sonic above the water?
00893E42 6C00                       		bge.s	@abovewater	; if yes, branch
00893E44 08E8 0006 0022             		bset	#staWater,obStatus(a0)	;Mercury Constants
00893E4A 66EC                       		bne.s	@exit
00893E4C 6100 0000                  		bsr.w	ResumeMusic
00893E50 11FC 000A D340             		move.b	#$A,(v_objspace+$340).w ; load bubbles object from Sonic's mouth
00893E56 11FC 0081 D368             		move.b	#$81,(v_objspace+$340+obSubtype).w
00893E5C 31FC 0300 F760             		move.w	#$300,(v_sonspeedmax).w ; change Sonic's top speed
00893E62 31FC 0006 F762             		move.w	#6,(v_sonspeedacc).w ; change Sonic's acceleration
00893E68 31FC 0040 F764             		move.w	#$40,(v_sonspeeddec).w ; change Sonic's deceleration
00893E6E                            		
00893E6E                            	;Mercury Speed Shoes Work Underwater
00893E6E 4A38 FE2E                  		tst.b	(v_shoes).w	; does Sonic have Speed Shoes?
00893E72 6700                       		beq.s	@noshoesbelow	; if not, branch
00893E74 31FC 0600 F760             		move.w	#$600,(v_sonspeedmax).w ; change Sonic's top speed
00893E7A 31FC 000C F762             		move.w	#$C,(v_sonspeedacc).w ; change Sonic's acceleration
00893E80                            	@noshoesbelow:
00893E80                            	;end Speed Shoes Work Underwater
00893E80                            		
00893E80 E0E8 0010                  		asr	obVelX(a0)
00893E84 E0E8 0012                  		asr	obVelY(a0)
00893E88 E0E8 0012                  		asr	obVelY(a0)	; slow Sonic
00893E8C 67AA                       		beq.s	@exit		; branch if Sonic stops moving
00893E8E 11FC 0008 D300             		move.b	#id_Splash,(v_objspace+$300).w ; load splash object
00893E9E                            ; ===========================================================================
00893E9E                            
00893E9E                            @abovewater:
00893E9E 08A8 0006 0022             		bclr	#staWater,obStatus(a0)	;Mercury Constants
00893EA4 6792                       		beq.s	@exit
00893EA6 6100 0000                  		bsr.w	ResumeMusic
00893EAA 31FC 0600 F760             		move.w	#$600,(v_sonspeedmax).w ; restore Sonic's speed
00893EB0 31FC 000C F762             		move.w	#$C,(v_sonspeedacc).w ; restore Sonic's acceleration
00893EB6 31FC 0080 F764             		move.w	#$80,(v_sonspeeddec).w ; restore Sonic's deceleration
00893EBC                            		
00893EBC                            	;Mercury Speed Shoes Work Underwater
00893EBC 4A38 FE2E                  		tst.b	(v_shoes).w	; does Sonic have Speed Shoes?
00893EC0 6700                       		beq.s	@noshoesabove	; if not, branch
00893EC2 31FC 0C00 F760             		move.w	#$C00,(v_sonspeedmax).w ; change Sonic's top speed
00893EC8 31FC 0018 F762             		move.w	#$18,(v_sonspeedacc).w ; change Sonic's acceleration
00893ECE                            	@noshoesabove:
00893ECE                            	;end Speed Shoes Work Underwater
00893ECE                            		
00893ECE E1E8 0012                  		asl	obVelY(a0)
00893ED2 6700 FF64                  		beq.w	@exit
00893ED6 11FC 0008 D300             		move.b	#id_Splash,(v_objspace+$300).w ; load splash object
00893EDC 0C68 F000 0012             		cmpi.w	#-$1000,obVelY(a0)
00893EE2 6E00                       		bgt.s	@belowmaxspeed
00893EE4 317C F000 0012             		move.w	#-$1000,obVelY(a0) ; set maximum speed on leaving water
00893EEA                            
00893EEA                            	@belowmaxspeed:
00893EF4                            ; End of function Sonic_Water
00893EF4                            ; End of function Sonic_Water
00893EF4                            
00893EF4                            ; ===========================================================================
00893EF4                            ; ---------------------------------------------------------------------------
00893EF4                            ; Modes	for controlling	Sonic
00893EF4                            ; ---------------------------------------------------------------------------
00893EF4                            
00893EF4                            Sonic_MdNormal:				; XREF: Sonic_Modes
00893EF4                            
00893EF4 6100 0000                  		bsr.w	Sonic_Dash
00893EF8                            
00893EF8 6100 0000                  		bsr.w	Sonic_SpinDash
00893EFC                            	
00893EFC 6100 0000                  		bsr.w	Sonic_Jump
00893F00 6100 0000                  		bsr.w	Sonic_SlopeResist
00893F04 6100 0000                  		bsr.w	Sonic_Move
00893F08 6100 0000                  		bsr.w	Sonic_Roll
00893F0C 6100 0000                  		bsr.w	Sonic_LevelBound
00893F10 4EB9 0088 E3B2             		jsr	ObjectMove
00893F16 6100 0000                  		bsr.w	Sonic_AnglePos
00893F1A 6100 0000                  		bsr.w	Sonic_SlopeRepel
00893F1E 4E75                       		rts	
00893F20                            ; ===========================================================================
00893F20                            
00893F20                            Sonic_MdJump:				; XREF: Sonic_Modes
00893F20                            
00893F20 08A8 0001 0039             		bclr	#staDash,obStatus2(a0)	; clear Dash flag
00893F26                            
00893F26 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)	; clear Spin Dash flag
00893F2C                            
00893F2C 6100 0000                  		bsr.w	Sonic_JumpHeight
00893F30 6100 0000                  		bsr.w	Sonic_JumpDirection
00893F34 6100 0000                  		bsr.w	Sonic_LevelBound
00893F38 4EB9 0088 E392             		jsr	ObjectMoveAndFall
00893F3E                            		
00893F3E 4A28 002C                  		tst.b	obWallJump(a0)
00893F42 6700                       		beq.s	@nowalljump
00893F44 0468 0030 0012             		subi.w	#$30,obVelY(a0)
00893F4A 6000                       		bra.s	@done
00893F4C                            		
00893F4C                            	@nowalljump:
00893F4C 0828 0006 0022             		btst	#6,obStatus(a0)
00893F52 6700                       		beq.s	@done
00893F54 0468 0028 0012             		subi.w	#$28,obVelY(a0)	
00893F5A                            
00893F5A                            	@done:
00893F5A                            	
00893F5A 6100 0000                  		bsr.w	Sonic_JumpAngle
00893F5E 6100 0000                  		bsr.w	Sonic_Floor
00893F62 4E75                       		rts	
00893F64                            ; ===========================================================================
00893F64                            
00893F64                            Sonic_MdRoll:				; XREF: Sonic_Modes
00893F64 6100 0000                  		bsr.w	Sonic_Jump
00893F68 6100 0000                  		bsr.w	Sonic_RollRepel
00893F6C 6100 0000                  		bsr.w	Sonic_RollSpeed
00893F70 6100 0000                  		bsr.w	Sonic_LevelBound
00893F74 4EB9 0088 E3B2             		jsr	ObjectMove
00893F7A 6100 0000                  		bsr.w	Sonic_AnglePos
00893F7E 6100 0000                  		bsr.w	Sonic_SlopeRepel
00893F82 4E75                       		rts	
00893F84                            ; ===========================================================================
00893F84                            
00893F84                            Sonic_MdJump2:				; XREF: Sonic_Modes
00893F84                            
00893F84 08A8 0001 0039             		bclr	#staDash,obStatus2(a0)	; clear Dash flag
00893F8A                            
00893F8A 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)	; clear Spin Dash flag
00893F90                            
00893F90 6100 0000                  		bsr.w	Sonic_JumpHeight
00893F94 6100 0000                  		bsr.w	Sonic_JumpDirection
00893F98 6100 0000                  		bsr.w	Sonic_LevelBound
00893F9C 4EB9 0088 E392             		jsr	ObjectMoveAndFall
00893FA2                            		
00893FA2 4A28 002C                  		tst.b	obWallJump(a0)
00893FA6 6700                       		beq.s	@nowalljump
00893FA8 0468 0030 0012             		subi.w	#$30,obVelY(a0)
00893FAE 6000                       		bra.s	@done
00893FB0                            		
00893FB0                            	@nowalljump:
00893FB0 0828 0006 0022             		btst	#6,obStatus(a0)
00893FB6 6700                       		beq.s	@done
00893FB8 0468 0028 0012             		subi.w	#$28,obVelY(a0)	
00893FBE                            
00893FBE                            	@done:
00893FBE                            	
00893FBE 6100 0000                  		bsr.w	Sonic_JumpAngle
00893FC2 6100 0000                  		bsr.w	Sonic_Floor
00893FC6 4E75                       		rts	
00893FC8                            
00893FC8                            		include	"_incObj\Sonic Move.asm"
00893FC8                            ; ---------------------------------------------------------------------------
00893FC8                            ; Subroutine to	make Sonic walk/run
00893FC8                            ; ---------------------------------------------------------------------------
00893FC8                            
00893FC8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00893FC8                            
00893FC8                            
00893FC8                            Sonic_Move:				; XREF: Obj01_MdNormal
00893FC8 3C38 F760                  		move.w	(v_sonspeedmax).w,d6
00893FCC 3A38 F762                  		move.w	(v_sonspeedacc).w,d5
00893FD0 3838 F764                  		move.w	(v_sonspeeddec).w,d4
00893FD4 4A38 F7CA                  		tst.b	(f_jumponly).w
00893FD8 6600 0000                  		bne.w	loc_12FEE
00893FDC 4A68 003E                  		tst.w	obLRLock(a0)	;Mercury Constants
00893FE0 6600 0000                  		bne.w	Sonic_ResetScr
00893FE4 0838 0002 F602             		btst	#bitL,(v_jpadhold2).w ; is left being pressed?
00893FEA 6700                       		beq.s	@notleft	; if not, branch
00893FEC 6100 0000                  		bsr.w	Sonic_MoveLeft
00893FF0                            
00893FF0                            	@notleft:
00893FF0 0838 0003 F602             		btst	#bitR,(v_jpadhold2).w ; is right being pressed?
00893FF6 6700                       		beq.s	@notright	; if not, branch
00893FF8 6100 0000                  		bsr.w	Sonic_MoveRight
00893FFC                            
00893FFC                            	@notright:
00893FFC 1028 0026                  		move.b	obAngle(a0),d0
00894000 0600 0020                  		addi.b	#$20,d0
00894004 0200 00C0                  		andi.b	#$C0,d0		; is Sonic on a	slope?
00894008 6600 0000                  		bne.w	Sonic_ResetScr	; if yes, branch
0089400C 4A68 0014                  		tst.w	obInertia(a0)	; is Sonic moving?
00894010 6600 0000                  		bne.w	Sonic_ResetScr	; if yes, branch
00894014 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
0089401A 117C 0000 001C             		move.b	#id_Wait,obAnim(a0) ; use "standing" animation
00894020 0828 0003 0022             		btst	#staOnObj,obStatus(a0)	;Mercury Constants
00894026 6700                       		beq.s	Sonic_Balance
00894028 7000                       		moveq	#0,d0
0089402A 1028 003D                  		move.b	obPlatformID(a0),d0	;Mercury Constants
0089402E ED48                       		lsl.w	#6,d0
00894030 43F8 D000                  		lea	(v_objspace).w,a1
00894034 43F1 0000                  		lea	(a1,d0.w),a1
00894038 4A29 0022                  		tst.b	obStatus(a1)
0089403C 6B00                       		bmi.s	Sonic_LookUp
0089403E 7200                       		moveq	#0,d1
00894040 1229 0019                  		move.b	obActWid(a1),d1
00894044 3401                       		move.w	d1,d2
00894046 D442                       		add.w	d2,d2
00894048 5942                       		subq.w	#4,d2
0089404A D268 0008                  		add.w	obX(a0),d1
0089404E 9269 0008                  		sub.w	obX(a1),d1
00894052 0C41 0004                  		cmpi.w	#4,d1
00894056                            		
00894056 6D00                       		blt.s	Sonic_BalanceLeft
00894058 B242                       		cmp.w	d2,d1
0089405A 6C00                       		bge.s	Sonic_BalanceRight
0089405C 6000                       		bra.s	Sonic_LookUp
0089405E                            
0089405E                            Sonic_Balance:
0089405E 4EB9 0000 0000             		jsr	ObjFloorDist
00894064 0C41 000C                  		cmpi.w	#$C,d1
00894068 6D00                       		blt.s	Sonic_LookUp
0089406A 0C28 0003 0036             		cmpi.b	#3,obFrontAngle(a0)	;Mercury Constants
00894070 6700                       		beq.s	Sonic_BalanceRight
00894072 0C28 0003 0037             		cmpi.b	#3,obRearAngle(a0)	;Mercury Constants
00894078 6600                       		bne.s	Sonic_LookUp
0089407A                            
0089407A                            Sonic_BalanceLeft:
0089407A 0828 0000 0022             		btst	#staFacing,obStatus(a0)	; is Sonic facing left?	;Mercury Constants
00894080 6700                       		beq.s	Sonic_BalanceBackward	; if not, balance backward
00894082 117C 0000 001C             		move.b	#id_BalanceForward,obAnim(a0) ; use forward balancing animation
00894088 6000 0000                  		bra.w	Sonic_ResetScr	; branch
0089408C                            
0089408C                            Sonic_BalanceRight:
0089408C 0828 0000 0022             		btst	#staFacing,obStatus(a0)	; is Sonic facing left?	;Mercury Constants
00894092 6600                       		bne.s	Sonic_BalanceBackward	; if so, balance backward
00894094 117C 0000 001C             		move.b	#id_BalanceForward,obAnim(a0) ; use forward balancing animation
0089409A 6000 0000                  		bra.w	Sonic_ResetScr	; branch
0089409E                            
0089409E                            Sonic_BalanceBackward:
0089409E 117C 0000 001C             		move.b	#id_BalanceBack,obAnim(a0) ; use backward balancing animation
008940A4 6000 0000                  		bra.w	Sonic_ResetScr
008940A8                            	
008940A8                            ; ===========================================================================
008940A8                            
008940A8                            Sonic_LookUp:
008940A8 0838 0000 F602             		btst	#bitUp,(v_jpadhold2).w ; is up being pressed?
008940AE 6700                       		beq.s	Sonic_Duck	; if not, branch
008940B0 117C 0000 001C             		move.b	#id_LookUp,obAnim(a0) ; use "looking up" animation
008940B6                            		
008940B6 5238 FEBE                  		addq.b	#1,(v_scrolldelay).w			; add 1 to the scroll timer
008940BA 0C38 0078 FEBE             		cmpi.b	#ScrollDelayTime,(v_scrolldelay).w	; is it equal to or greater than the scroll delay?
008940C0 6500                       		bcs.s	Sonic_LookReset				; if not, skip ahead without looking up
008940C2 11FC 0078 FEBE             		move.b	#ScrollDelayTime,(v_scrolldelay).w 	; move the scroll delay value into the scroll timer so it won't continue to count higher
008940C8                            		
008940C8 3038 F704                  		move.w	(v_screenposy).w,d0	; get camera top coordinate
008940CC 9078 F72C                  		sub.w	(v_limittop2).w,d0	; subtract zone's top bound from it
008940D0 D078 F73E                  		add.w	(v_lookshift).w,d0	; add default offset
008940D4 0C40 00C8                  		cmpi.w	#$C8,d0			; is offset <= $C8?
008940D8 6F00                       		ble.s	@skip			; if so, branch
008940DA 303C 00C8                  		move.w	#$C8,d0			; set offset to $C8
008940DE                            		
008940DE                            	@skip:
008940DE B078 F73E                  		cmp.w	(v_lookshift).w,d0
008940E2 6F00                       		ble.s	loc_12FC2
008940E4                            	
008940E4 5478 F73E                  		addq.w	#2,(v_lookshift).w
008940E8 6000                       		bra.s	loc_12FC2
008940EA                            ; ===========================================================================
008940EA                            
008940EA                            Sonic_Duck:
008940EA 0838 0001 F602             		btst	#bitDn,(v_jpadhold2).w ; is down being pressed?
008940F0 6700                       		beq.s	Sonic_ResetScr	; if not, branch
008940F2 117C 0000 001C             		move.b	#id_Duck,obAnim(a0) ; use "ducking" animation
008940F8                            		
008940F8 5238 FEBE                  		addq.b	#1,(v_scrolldelay).w			; add 1 to the scroll timer
008940FC 0C38 0078 FEBE             		cmpi.b	#ScrollDelayTime,(v_scrolldelay).w	; is it equal to or greater than the scroll delay?
00894102 6500                       		bcs.s	Sonic_LookReset				; if not, skip ahead without looking up
00894104 11FC 0078 FEBE             		move.b	#ScrollDelayTime,(v_scrolldelay).w 	; move the scroll delay value into the scroll timer so it won't continue to count higher
0089410A                            		
0089410A 3038 F704                  		move.w	(v_screenposy).w,d0	; get camera top coordinate
0089410E 9078 F72E                  		sub.w	(v_limitbtm2).w,d0	; subtract zone's bottom bound from it (creating a negative number)
00894112 D078 F73E                  		add.w	(v_lookshift).w,d0	; add default offset
00894116 0C40 0008                  		cmpi.w	#8,d0			; is offset < 8?
0089411A 6D00                       		blt.s	@set			; if so, branch
0089411C 6E00                       		bgt.s	@skip			; if greater than 8, branch
0089411E                            		
0089411E                            	@set:
0089411E 303C 0008                  		move.w	#8,d0	; set offset to 8
00894122                            		
00894122                            	@skip:
00894122 B078 F73E                  		cmp.w	(v_lookshift).w,d0
00894126 6C00                       		bge.s	loc_12FC2
00894128                            		
00894128 5578 F73E                  		subq.w	#2,(v_lookshift).w
0089412C 6000                       		bra.s	loc_12FC2
0089412E                            ; ===========================================================================
0089412E                            
0089412E                            Sonic_ResetScr:
0089412E                            
0089412E 11FC 0000 FEBE             		move.b	#0,(v_scrolldelay).w	; clear the scroll timer, because up/down are not being held
00894134                            
00894134                            Sonic_LookReset:	; added branch point that the new scroll delay code skips ahead to
00894134                            
00894134 0C78 0060 F73E             		cmpi.w	#$60,(v_lookshift).w ; is screen in its default position?
0089413A 6700                       		beq.s	loc_12FC2	; if yes, branch
0089413C 6400                       		bcc.s	loc_12FBE
0089413E 5878 F73E                  		addq.w	#4,(v_lookshift).w ; move screen back to default
00894142                            
00894142                            loc_12FBE:
00894142 5578 F73E                  		subq.w	#2,(v_lookshift).w ; move screen back to default
00894146                            
00894146                            loc_12FC2:
00894146 1038 F602                  		move.b	(v_jpadhold2).w,d0
0089414A 0200 000C                  		andi.b	#btnL+btnR,d0	; is left/right	pressed?
0089414E 6600                       		bne.s	loc_12FEE	; if yes, branch
00894150 3028 0014                  		move.w	obInertia(a0),d0
00894154 6700                       		beq.s	loc_12FEE
00894156 6B00                       		bmi.s	loc_12FE2
00894158 9045                       		sub.w	d5,d0
0089415A 6400                       		bcc.s	loc_12FDC
0089415C 303C 0000                  		move.w	#0,d0
00894160                            
00894160                            loc_12FDC:
00894160 3140 0014                  		move.w	d0,obInertia(a0)
00894164 6000                       		bra.s	loc_12FEE
00894166                            ; ===========================================================================
00894166                            
00894166                            loc_12FE2:
00894166 D045                       		add.w	d5,d0
00894168 6400                       		bcc.s	loc_12FEA
0089416A 303C 0000                  		move.w	#0,d0
0089416E                            
0089416E                            loc_12FEA:
0089416E 3140 0014                  		move.w	d0,obInertia(a0)
00894172                            
00894172                            loc_12FEE:
00894172 1028 0026                  		move.b	obAngle(a0),d0
00894176 4EB9 0088 301C             		jsr	(CalcSine).l
0089417C C3E8 0014                  		muls.w	obInertia(a0),d1
00894180 E081                       		asr.l	#8,d1
00894182 3141 0010                  		move.w	d1,obVelX(a0)
00894186 C1E8 0014                  		muls.w	obInertia(a0),d0
0089418A E080                       		asr.l	#8,d0
0089418C 3140 0012                  		move.w	d0,obVelY(a0)
00894190                            
00894190                            loc_1300C:
00894190 1028 0026                  		move.b	obAngle(a0),d0
00894194 0600 0040                  		addi.b	#$40,d0
00894198 6B00                       		bmi.s	locret_1307C
0089419A 123C 0040                  		move.b	#$40,d1
0089419E 4A68 0014                  		tst.w	obInertia(a0)
008941A2 6700                       		beq.s	locret_1307C
008941A4 6B00                       		bmi.s	loc_13024
008941A6 4441                       		neg.w	d1
008941A8                            
008941A8                            loc_13024:
008941A8 1028 0026                  		move.b	obAngle(a0),d0
008941AC D001                       		add.b	d1,d0
008941AE 3F00                       		move.w	d0,-(sp)
008941B0 6100 0000                  		bsr.w	Sonic_WalkSpeed
008941B4 301F                       		move.w	(sp)+,d0
008941B6 4A41                       		tst.w	d1
008941B8 6A00                       		bpl.s	locret_1307C
008941BA E141                       		asl.w	#8,d1
008941BC 0600 0020                  		addi.b	#$20,d0
008941C0 0200 00C0                  		andi.b	#$C0,d0
008941C4 6700                       		beq.s	loc_13078
008941C6 0C00 0040                  		cmpi.b	#$40,d0
008941CA 6700                       		beq.s	loc_13066
008941CC 0C00 0080                  		cmpi.b	#$80,d0
008941D0 6700                       		beq.s	loc_13060
008941D2 D368 0010                  		add.w	d1,obVelX(a0)
008941D6 08E8 0005 0022             		bset	#staPush,obStatus(a0)	;Mercury Constants
008941DC 317C 0000 0014             		move.w	#0,obInertia(a0)
008941E2 4E75                       		rts	
008941E4                            ; ===========================================================================
008941E4                            
008941E4                            loc_13060:
008941E4 9368 0012                  		sub.w	d1,obVelY(a0)
008941E8 4E75                       		rts	
008941EA                            ; ===========================================================================
008941EA                            
008941EA                            loc_13066:
008941EA 9368 0010                  		sub.w	d1,obVelX(a0)
008941EE 08E8 0005 0022             		bset	#staPush,obStatus(a0)	;Mercury Constants
008941F4 317C 0000 0014             		move.w	#0,obInertia(a0)
008941FA 4E75                       		rts	
008941FC                            ; ===========================================================================
008941FC                            
008941FC                            loc_13078:
008941FC D368 0012                  		add.w	d1,obVelY(a0)
00894200                            
00894200                            locret_1307C:
00894200 4E75                       		rts	
00894202                            ; End of function Sonic_Move
00894202                            
00894202                            
00894202                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894202                            
00894202                            
00894202                            Sonic_MoveLeft:				; XREF: Sonic_Move
00894202 3028 0014                  		move.w	obInertia(a0),d0
00894206 6700                       		beq.s	loc_13086
00894208 6A00                       		bpl.s	loc_130B2
0089420A                            
0089420A                            loc_13086:
0089420A 08E8 0000 0022             		bset	#staFacing,obStatus(a0)	;Mercury Constants
00894210 6600                       		bne.s	loc_1309A
00894212 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00894218 117C 0000 001D             		move.b	#id_Run,obNextAni(a0)
0089421E                            
0089421E                            loc_1309A:
0089421E 9045                       		sub.w	d5,d0
00894220 3206                       		move.w	d6,d1
00894222 4441                       		neg.w	d1
00894224 B041                       		cmp.w	d1,d0
00894226 6E00                       		bgt.s	loc_130A6
00894228                            		
00894228 D045                       		add.w	d5,d0
0089422A B041                       		cmp.w	d1,d0
0089422C 6F00                       		ble.s	loc_130A6
0089422E                            		
0089422E 3001                       		move.w	d1,d0
00894230                            
00894230                            loc_130A6:
00894230 3140 0014                  		move.w	d0,obInertia(a0)
00894234 117C 0000 001C             		move.b	#id_Walk,obAnim(a0) ; use walking animation
0089423A 4E75                       		rts	
0089423C                            ; ===========================================================================
0089423C                            
0089423C                            loc_130B2:				; XREF: Sonic_MoveLeft
0089423C 9044                       		sub.w	d4,d0
0089423E 6400                       		bcc.s	loc_130BA
00894240 303C FF80                  		move.w	#-$80,d0
00894244                            
00894244                            loc_130BA:
00894244 3140 0014                  		move.w	d0,obInertia(a0)
00894248 1028 0026                  		move.b	obAngle(a0),d0
0089424C 0600 0020                  		addi.b	#$20,d0
00894250 0200 00C0                  		andi.b	#$C0,d0
00894254 6600                       		bne.s	locret_130E8
00894256 0C40 0400                  		cmpi.w	#$400,d0
0089425A 6D00                       		blt.s	locret_130E8
0089425C 117C 0000 001C             		move.b	#id_Stop,obAnim(a0) ; use "stopping" animation
00894262 08A8 0000 0022             		bclr	#staFacing,obStatus(a0)	;Mercury Constants
00894272                            
00894272                            locret_130E8:
00894272 4E75                       		rts	
00894274                            ; End of function Sonic_MoveLeft
00894274                            
00894274                            
00894274                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894274                            
00894274                            
00894274                            Sonic_MoveRight:			; XREF: Sonic_Move
00894274 3028 0014                  		move.w	obInertia(a0),d0
00894278 6B00                       		bmi.s	loc_13118
0089427A 08A8 0000 0022             		bclr	#staFacing,obStatus(a0)	;Mercury Constants
00894280 6700                       		beq.s	loc_13104
00894282 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00894288 117C 0000 001D             		move.b	#id_Run,obNextAni(a0)
0089428E                            
0089428E                            loc_13104:
0089428E D045                       		add.w	d5,d0
00894290 B046                       		cmp.w	d6,d0
00894292 6D00                       		blt.s	loc_1310C
00894294                            		
00894294 9045                       		sub.w	d5,d0
00894296 B046                       		cmp.w	d6,d0
00894298 6C00                       		bge.s	loc_1310C
0089429A                            		
0089429A 3006                       		move.w	d6,d0
0089429C                            
0089429C                            loc_1310C:
0089429C 3140 0014                  		move.w	d0,obInertia(a0)
008942A0 117C 0000 001C             		move.b	#id_Walk,obAnim(a0) ; use walking animation
008942A6 4E75                       		rts	
008942A8                            ; ===========================================================================
008942A8                            
008942A8                            loc_13118:				; XREF: Sonic_MoveRight
008942A8 D044                       		add.w	d4,d0
008942AA 6400                       		bcc.s	loc_13120
008942AC 303C 0080                  		move.w	#$80,d0
008942B0                            
008942B0                            loc_13120:
008942B0 3140 0014                  		move.w	d0,obInertia(a0)
008942B4 1028 0026                  		move.b	obAngle(a0),d0
008942B8 0600 0020                  		addi.b	#$20,d0
008942BC 0200 00C0                  		andi.b	#$C0,d0
008942C0 6600                       		bne.s	locret_1314E
008942C2 0C40 FC00                  		cmpi.w	#-$400,d0
008942C6 6E00                       		bgt.s	locret_1314E
008942C8 117C 0000 001C             		move.b	#id_Stop,obAnim(a0) ; use "stopping" animation
008942CE 08E8 0000 0022             		bset	#staFacing,obStatus(a0)	;Mercury Constants
008942DE                            
008942DE                            locret_1314E:
008942DE 4E75                       		rts	
008942E0                            ; End of function Sonic_MoveRight
008942E0                            ; End of function Sonic_MoveRight
008942E0                            		include	"_incObj\Sonic RollSpeed.asm"
008942E0                            ; ---------------------------------------------------------------------------
008942E0                            ; Subroutine to	change Sonic's speed as he rolls
008942E0                            ; ---------------------------------------------------------------------------
008942E0                            
008942E0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008942E0                            
008942E0                            
008942E0                            Sonic_RollSpeed:			; XREF: Obj01_MdRoll
008942E0 3C38 F760                  		move.w	(v_sonspeedmax).w,d6
008942E4 E346                       		asl.w	#1,d6
008942E6 3A38 F762                  		move.w	(v_sonspeedacc).w,d5
008942EA E245                       		asr.w	#1,d5
008942EC 3838 F764                  		move.w	(v_sonspeeddec).w,d4
008942F0 E444                       		asr.w	#2,d4
008942F2 4A38 F7CA                  		tst.b	(f_jumponly).w
008942F6 6600 0000                  		bne.w	loc_131CC
008942FA 4A68 003E                  		tst.w	obLRLock(a0)	;Mercury Constants
008942FE 6600                       		bne.s	@notright
00894300 0838 0002 F602             		btst	#bitL,(v_jpadhold2).w ; is left being pressed?
00894306 6700                       		beq.s	@notleft	; if not, branch
00894308 6100 0000                  		bsr.w	Sonic_RollLeft
0089430C                            
0089430C                            	@notleft:
0089430C 0838 0003 F602             		btst	#bitR,(v_jpadhold2).w ; is right being pressed?
00894312 6700                       		beq.s	@notright	; if not, branch
00894314 6100 0000                  		bsr.w	Sonic_RollRight
00894318                            
00894318                            	@notright:
00894318 3028 0014                  		move.w	obInertia(a0),d0
0089431C 6700                       		beq.s	loc_131AA
0089431E 6B00                       		bmi.s	loc_1319E
00894320 9045                       		sub.w	d5,d0
00894322 6400                       		bcc.s	loc_13198
00894324 303C 0000                  		move.w	#0,d0
00894328                            
00894328                            loc_13198:
00894328 3140 0014                  		move.w	d0,obInertia(a0)
0089432C 6000                       		bra.s	loc_131AA
0089432E                            ; ===========================================================================
0089432E                            
0089432E                            loc_1319E:				; XREF: Sonic_RollSpeed
0089432E D045                       		add.w	d5,d0
00894330 6400                       		bcc.s	loc_131A6
00894332 303C 0000                  		move.w	#0,d0
00894336                            
00894336                            loc_131A6:
00894336 3140 0014                  		move.w	d0,obInertia(a0)
0089433A                            
0089433A                            loc_131AA:
0089433A 4A68 0014                  		tst.w	obInertia(a0)	; is Sonic moving?
0089433E 6600                       		bne.s	loc_131CC	; if yes, branch
00894340 08A8 0002 0022             		bclr	#staSpin,obStatus(a0)	;Mercury Constants
00894346 117C 0013 0016             		move.b	#$13,obHeight(a0)
0089434C 117C 0009 0017             		move.b	#9,obWidth(a0)
00894352 117C 0000 001C             		move.b	#id_Wait,obAnim(a0) ; use "standing" animation
00894358 5B68 000C                  		subq.w	#5,obY(a0)
0089435C                            
0089435C                            loc_131CC:
0089435C                            
0089435C                            	;Mercury Screen Scroll While Rolling Fix
0089435C 0C78 0060 F73E             		cmp.w	#$60,(v_lookshift).w
00894362 6700                       		beq.s	@cont2
00894364 6400                       		bcc.s	@cont1
00894366 5878 F73E                  		addq.w	#4,(v_lookshift).w
0089436A                            
0089436A                            	@cont1:
0089436A 5578 F73E                  		subq.w	#2,(v_lookshift).w
0089436E                            
0089436E                            	@cont2:
0089436E                            	;end Screen Scroll While Rolling Fix
0089436E                            
0089436E 1028 0026                  		move.b	obAngle(a0),d0
00894372 4EB9 0088 301C             		jsr	(CalcSine).l
00894378 C1E8 0014                  		muls.w	obInertia(a0),d0
0089437C E080                       		asr.l	#8,d0
0089437E 3140 0012                  		move.w	d0,obVelY(a0)
00894382 C3E8 0014                  		muls.w	obInertia(a0),d1
00894386 E081                       		asr.l	#8,d1
00894388 0C41 1000                  		cmpi.w	#$1000,d1
0089438C 6F00                       		ble.s	loc_131F0
0089438E 323C 1000                  		move.w	#$1000,d1
00894392                            
00894392                            loc_131F0:
00894392 0C41 F000                  		cmpi.w	#-$1000,d1
00894396 6C00                       		bge.s	loc_131FA
00894398 323C F000                  		move.w	#-$1000,d1
0089439C                            
0089439C                            loc_131FA:
0089439C 3141 0010                  		move.w	d1,obVelX(a0)
008943A0 6000 FDEE                  		bra.w	loc_1300C
008943A4                            ; End of function Sonic_RollSpeed
008943A4                            
008943A4                            
008943A4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008943A4                            
008943A4                            
008943A4                            Sonic_RollLeft:				; XREF: Sonic_RollSpeed
008943A4 3028 0014                  		move.w	obInertia(a0),d0
008943A8 6700                       		beq.s	loc_1320A
008943AA 6A00                       		bpl.s	loc_13218
008943AC                            
008943AC                            loc_1320A:
008943AC 08E8 0000 0022             		bset	#staFacing,obStatus(a0)	;Mercury Constants
008943B2 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "rolling" animation
008943B8 4E75                       		rts	
008943BA                            ; ===========================================================================
008943BA                            
008943BA                            loc_13218:
008943BA 9044                       		sub.w	d4,d0
008943BC 6400                       		bcc.s	loc_13220
008943BE                            		
008943BE 303C 0000                  		move.w	#0,d0
008943C2                            
008943C2                            loc_13220:
008943C2 3140 0014                  		move.w	d0,obInertia(a0)
008943C6 4E75                       		rts	
008943C8                            ; End of function Sonic_RollLeft
008943C8                            
008943C8                            
008943C8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008943C8                            
008943C8                            
008943C8                            Sonic_RollRight:			; XREF: Sonic_RollSpeed
008943C8 3028 0014                  		move.w	obInertia(a0),d0
008943CC 6B00                       		bmi.s	loc_1323A
008943CE 08A8 0000 0022             		bclr	#staFacing,obStatus(a0)	;Mercury Constants
008943D4 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "rolling" animation
008943DA 4E75                       		rts	
008943DC                            ; ===========================================================================
008943DC                            
008943DC                            loc_1323A:
008943DC D044                       		add.w	d4,d0
008943DE 6400                       		bcc.s	loc_13242
008943E0                            		
008943E0 303C 0000                  		move.w	#0,d0
008943E4                            		
008943E4                            
008943E4                            loc_13242:
008943E4 3140 0014                  		move.w	d0,obInertia(a0)
008943E8 4E75                       		rts	
008943EA                            ; End of function Sonic_RollRight
008943EA                            ; End of function Sonic_RollRight
008943EA                            		include	"_incObj\Sonic JumpDirection.asm"
008943EA                            ; ---------------------------------------------------------------------------
008943EA                            ; Subroutine to	change Sonic's direction while jumping
008943EA                            ; ---------------------------------------------------------------------------
008943EA                            
008943EA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008943EA                            
008943EA                            
008943EA                            Sonic_JumpDirection:			; XREF: Obj01_MdJump; Obj01_MdJump2
008943EA 3C38 F760                  		move.w	(v_sonspeedmax).w,d6
008943EE 3A38 F762                  		move.w	(v_sonspeedacc).w,d5
008943F2 E345                       		asl.w	#1,d5
008943F4                            		
008943F4                            		
008943F4 3028 0010                  		move.w	obVelX(a0),d0
008943F8 0838 0002 F602             		btst	#bitL,(v_jpadhold2).w ; is left being pressed?
008943FE 6700                       		beq.s	loc_13278	; if not, branch
00894400 08E8 0000 0022             		bset	#0,obStatus(a0)
00894406 9045                       		sub.w	d5,d0
00894408 3206                       		move.w	d6,d1
0089440A 4441                       		neg.w	d1
0089440C B041                       		cmp.w	d1,d0
0089440E 6E00                       		bgt.s	loc_13278
00894410                            		
00894410 D045                       		add.w d5,d0
00894412 B041                       		cmp.w d1,d0
00894414 6F00                       		ble.s loc_13278
00894416                            		
00894416 3001                       		move.w	d1,d0
00894418                            
00894418                            loc_13278:
00894418 0838 0003 F602             		btst	#bitR,(v_jpadhold2).w ; is right being pressed?
0089441E 6700                       		beq.s	Obj01_JumpMove	; if not, branch
00894420 08A8 0000 0022             		bclr	#0,obStatus(a0)
00894426 D045                       		add.w	d5,d0
00894428 B046                       		cmp.w	d6,d0
0089442A 6D00                       		blt.s	Obj01_JumpMove
0089442C                            		
0089442C 9045                       		sub.w d5,d0
0089442E B046                       		cmp.w d6,d0
00894430 6C00                       		bge.s Obj01_JumpMove
00894432                            		
00894432 3006                       		move.w	d6,d0
00894434                            
00894434                            Obj01_JumpMove:
00894434 3140 0010                  		move.w	d0,obVelX(a0)	; change Sonic's horizontal speed
00894438                            
00894438                            Obj01_ResetScr2:
00894438 0C78 0060 F73E             		cmpi.w	#$60,(v_lookshift).w ; is the screen in its default position?
0089443E 6700                       		beq.s	loc_132A4	; if yes, branch
00894440 6400                       		bcc.s	loc_132A0
00894442 5878 F73E                  		addq.w	#4,(v_lookshift).w
00894446                            
00894446                            loc_132A0:
00894446 5578 F73E                  		subq.w	#2,(v_lookshift).w
0089444A                            
0089444A                            loc_132A4:
0089444A 0C68 FC00 0012             		cmpi.w	#-$400,obVelY(a0) ; is Sonic moving faster than -$400 upwards?
00894450 6500                       		bcs.s	locret_132D2	; if yes, branch
00894452 3028 0010                  		move.w	obVelX(a0),d0
00894456 3200                       		move.w	d0,d1
00894458 EA41                       		asr.w	#5,d1
0089445A 6700                       		beq.s	locret_132D2
0089445C 6B00                       		bmi.s	loc_132C6
0089445E 9041                       		sub.w	d1,d0
00894460 6400                       		bcc.s	loc_132C0
00894462 303C 0000                  		move.w	#0,d0
00894466                            
00894466                            loc_132C0:
00894466 3140 0010                  		move.w	d0,obVelX(a0)
0089446A 4E75                       		rts	
0089446C                            ; ===========================================================================
0089446C                            
0089446C                            loc_132C6:
0089446C 9041                       		sub.w	d1,d0
0089446E 6500                       		bcs.s	loc_132CE
00894470 303C 0000                  		move.w	#0,d0
00894474                            
00894474                            loc_132CE:
00894474 3140 0010                  		move.w	d0,obVelX(a0)
00894478                            
00894478                            locret_132D2:
00894478 4E75                       		rts	
0089447A                            ; End of function Sonic_JumpDirection
0089447A                            ; End of function Sonic_JumpDirection
0089447A                            		include	"_incObj\Sonic LevelBound.asm"
0089447A                            ; ---------------------------------------------------------------------------
0089447A                            ; Subroutine to	prevent	Sonic leaving the boundaries of	a level
0089447A                            ; ---------------------------------------------------------------------------
0089447A                            
0089447A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089447A                            
0089447A                            
0089447A                            Sonic_LevelBound:			; XREF: Obj01_MdNormal; et al
0089447A 2228 0008                  		move.l	obX(a0),d1
0089447E 3028 0010                  		move.w	obVelX(a0),d0
00894482 48C0                       		ext.l	d0
00894484 E180                       		asl.l	#8,d0
00894486 D280                       		add.l	d0,d1
00894488 4841                       		swap	d1
0089448A 3038 F728                  		move.w	(v_limitleft2).w,d0
0089448E 0640 0010                  		addi.w	#$10,d0
00894492 B041                       		cmp.w	d1,d0		; has Sonic touched the	side boundary?
00894494 6200                       		bhi.s	@sides		; if yes, branch
00894496 3038 F72A                  		move.w	(v_limitright2).w,d0
0089449A 0640 0128                  		addi.w	#$128,d0
0089449E 4A38 F7AA                  		tst.b	(f_lockscreen).w
008944A2 6600                       		bne.s	@screenlocked
008944A4 0640 0040                  		addi.w	#$40,d0
008944A8                            
008944A8                            	@screenlocked:
008944A8 B041                       		cmp.w	d1,d0		; has Sonic touched the	side boundary?
008944AA 6300                       		bls.s	@sides		; if yes, branch
008944AC                            
008944AC                            	@chkbottom:
008944AC                            	
008944AC                            	;Mercury High Speed Camera Fix
008944AC                            		;move.w	(v_limitbtm2).w,d0
008944AC 3038 F726                  		move.w	(v_limitbtm1).w,d0
008944B0                            	;end High Speed Camera Fix
008944B0                            	
008944B0 0640 00E0                  		addi.w	#$E0,d0
008944B4 B068 000C                  		cmp.w	obY(a0),d0	; has Sonic touched the	bottom boundary?
008944B8 6D00                       		blt.s	@bottom		; if yes, branch
008944BA 4E75                       		rts	
008944BC                            ; ===========================================================================
008944BC                            
008944BC                            @bottom:
008944BC 0C78 0501 FE10             		cmpi.w	#(id_SBZ<<8)+1,(v_zone).w ; is level SBZ2 ?
008944C2 6600                       		bne.s	@killsonic	; if not, kill Sonic	;Mercury Spin Dash (KillSonic -> @killsonic)
008944C4 0C78 2000 D008             		cmpi.w	#$2000,(v_player+obX).w
008944CA 6500                       		bcs.s	@killsonic			;Mercury Spin Dash (KillSonic -> @killsonic)
008944CC 4238 FE30                  		clr.b	(v_lastlamp).w	; clear	lamppost counter
008944D0 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart the level
008944D6 31FC 0103 FE10             		move.w	#(id_LZ<<8)+3,(v_zone).w ; set level to SBZ3 (LZ4)
008944DC 4E75                       		rts	
008944DE                            	
008944DE                            	;Mercury Spin Dash
008944DE                            @killsonic:
008944DE 4EF9 0000 0000             		jmp		KillSonic
008944E4                            	;end Spin Dash
008944E4                            	
008944E4                            ; ===========================================================================
008944E4                            
008944E4                            @sides:
008944E4 3140 0008                  		move.w	d0,obX(a0)
008944E8 317C 0000 000A             		move.w	#0,obX+2(a0)
008944EE 317C 0000 0010             		move.w	#0,obVelX(a0)	; stop Sonic moving
008944F4 317C 0000 0014             		move.w	#0,obInertia(a0)
008944FA 60B0                       		bra.s	@chkbottom
008944FC                            ; End of function Sonic_LevelBound
008944FC                            ; End of function Sonic_LevelBound
008944FC                            		include	"_incObj\Sonic Roll.asm"
008944FC                            ; ---------------------------------------------------------------------------
008944FC                            ; Subroutine allowing Sonic to roll when he's moving
008944FC                            ; ---------------------------------------------------------------------------
008944FC                            
008944FC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008944FC                            
008944FC                            
008944FC                            Sonic_Roll:				; XREF: Obj01_MdNormal
008944FC 4A38 F7CA                  		tst.b	(f_jumponly).w
00894500 6600                       		bne.s	@noroll
00894502 3028 0014                  		move.w	obInertia(a0),d0
00894506 6A00                       		bpl.s	@ispositive
00894508 4440                       		neg.w	d0
0089450A                            
0089450A                            	@ispositive:
0089450A                            	
0089450A 0C40 0100                  		cmpi.w	#$100,d0	; is Sonic moving at $100 speed or faster?
0089450E                            	
0089450E 6500                       		bcs.s	@noroll		; if not, branch
00894510 1038 F602                  		move.b	(v_jpadhold2).w,d0
00894514 0200 000C                  		andi.b	#btnL+btnR,d0	; is left/right	being pressed?
00894518 6600                       		bne.s	@noroll		; if yes, branch
0089451A 0838 0001 F602             		btst	#bitDn,(v_jpadhold2).w ; is down being pressed?
00894520 6600                       		bne.s	Sonic_ChkRoll	; if yes, branch
00894522                            
00894522                            	@noroll:
00894522 4E75                       		rts	
00894524                            ; ===========================================================================
00894524                            
00894524                            Sonic_ChkRoll:
00894524 0828 0002 0022             		btst	#2,obStatus(a0)	; is Sonic already rolling?
0089452A 6700                       		beq.s	@roll		; if not, branch
0089452C 4E75                       		rts	
0089452E                            ; ===========================================================================
0089452E                            
0089452E                            @roll:
0089452E 08E8 0002 0022             		bset	#2,obStatus(a0)
00894534 117C 000E 0016             		move.b	#$E,obHeight(a0)
0089453A 117C 0007 0017             		move.b	#7,obWidth(a0)
00894540 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "rolling" animation
00894546 117C 0000 001A             		move.b	#fr_Roll1,obFrame(a0)	; hard sets frame so no flicker when roll in tunnels	;Mercury Roll Frame Fix
0089454C 5A68 000C                  		addq.w	#5,obY(a0)
0089455A 4A68 0014                  		tst.w	obInertia(a0)
0089455E 6600                       		bne.s	@ismoving
00894560 317C 0200 0014             		move.w	#$200,obInertia(a0) ; set inertia if 0
00894566                            
00894566                            	@ismoving:
00894566 4E75                       		rts	
00894568                            ; End of function Sonic_Roll
00894568                            ; End of function Sonic_Roll
00894568                            		include	"_incObj\Sonic Jump.asm"
00894568                            ; ---------------------------------------------------------------------------
00894568                            ; Subroutine allowing Sonic to jump
00894568                            ; ---------------------------------------------------------------------------
00894568                            
00894568                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894568                            
00894568                            
00894568                            Sonic_Jump:				; XREF: Obj01_MdNormal; Obj01_MdRoll
00894568 1038 F603                  		move.b	(v_jpadpress2).w,d0
0089456C 0200 0070                  		andi.b	#btnABC,d0	; is A, B or C pressed?
00894570 6700 0000                  		beq.w	locret_1348E	; if not, branch
00894574 7000                       		moveq	#0,d0
00894576 1028 0026                  		move.b	obAngle(a0),d0
0089457A 0600 0080                  		addi.b	#$80,d0
0089457E 6100 0000                  		bsr.w	sub_14D48
00894582 0C41 0006                  		cmpi.w	#6,d1
00894586 6D00 0000                  		blt.w	locret_1348E
0089458A 343C 0680                  		move.w	#$680,d2
0089458E 0828 0006 0022             		btst	#staWater,obStatus(a0)	;Mercury Constants
00894594 6700                       		beq.s	loc_1341C
00894596 343C 0380                  		move.w	#$380,d2
0089459A                            
0089459A                            loc_1341C:
0089459A 7000                       		moveq	#0,d0
0089459C 1028 0026                  		move.b	obAngle(a0),d0
008945A0 0400 0040                  		subi.b	#$40,d0
008945A4 4EB9 0088 301C             		jsr	(CalcSine).l
008945AA C3C2                       		muls.w	d2,d1
008945AC E081                       		asr.l	#8,d1
008945AE D368 0010                  		add.w	d1,obVelX(a0)	; make Sonic jump
008945B2 C1C2                       		muls.w	d2,d0
008945B4 E080                       		asr.l	#8,d0
008945B6 D168 0012                  		add.w	d0,obVelY(a0)	; make Sonic jump
008945BA 08E8 0001 0022             		bset	#staAir,obStatus(a0)	;Mercury Constants
008945C0 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
008945C6 588F                       		addq.l	#4,sp
008945C8 117C 0001 003C             		move.b	#1,obJumping(a0)	;Mercury Constants
008945CE 4228 0038                  		clr.b	obOnWheel(a0)	;Mercury Constants
008945D2                            		
008945D2                            	;Mercury Clear Control Lock When Jump
008945D2 4268 003E                  		clr.w	obLRLock(a0)	;clear horiz control lock	;Mercury Constants
008945D6                            	;end Clear Control Lock When Jump
008945D6                            
008945E0 117C 0013 0016             		move.b	#$13,obHeight(a0)
008945E6 117C 0009 0017             		move.b	#9,obWidth(a0)
008945EC 0828 0002 0022             		btst	#2,obStatus(a0)
008945F2 6600                       		bne.s	loc_13490
008945F4 117C 000E 0016             		move.b	#$E,obHeight(a0)
008945FA 117C 0007 0017             		move.b	#7,obWidth(a0)
00894600 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "jumping" animation
00894606 08E8 0002 0022             		bset	#staSpin,obStatus(a0)	;Mercury Constants
0089460C 5A68 000C                  		addq.w	#5,obY(a0)
00894610                            
00894610                            locret_1348E:
00894610 4E75                       		rts	
00894612                            ; ===========================================================================
00894612                            
00894612                            loc_13490:
00894612                            	
00894612                            		
00894612 4E75                       		rts	
00894614                            ; End of function Sonic_Jump
00894614                            ; End of function Sonic_Jump
00894614                            		include	"_incObj\Sonic JumpHeight.asm"
00894614                            ; ---------------------------------------------------------------------------
00894614                            ; Subroutine controlling Sonic's jump height/duration
00894614                            ; ---------------------------------------------------------------------------
00894614                            
00894614                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894614                            
00894614                            
00894614                            Sonic_JumpHeight:			; XREF: Obj01_MdJump; Obj01_MdJump2
00894614                            
00894614 4A28 002C                  		tst.b	obWallJump(a0)	; on wall?
00894618 6700                       		beq.s	@skip
0089461A 1038 F603                  		move.b	(v_jpadpress2).w,d0
0089461E 0200 0070                  		andi.b	#btnABC,d0	; is A, B or C pressed?
00894622 6700                       		beq.s	@skip	; if yes, branch
00894624 317C 0000 002C             		move.w	#0,obWallJump(a0)	; clear Wall Jump data
0089462A 117C 0001 003C             		move.b	#1,obJumping(a0)	;Mercury Constants
00894630 117C 0000 001C             		move.b	#id_Roll,obAnim(a0) ; use "jumping" animation
00894636 303C FA00                  		move.w	#-$600,d0
0089463A 0838 0000 F602             		btst	#bitUp,(v_jpadhold2).w
00894640 6600                       		bne.s	@uponly
00894642 303C FA80                  		move.w	#-$580,d0
00894646 317C FC00 0010             		move.w	#-$400,obVelX(a0)
0089464C 0828 0000 0022             		btst	#staFacing,obStatus(a0)	;Mercury Constants
00894652 6700                       		beq.s	@uponly
00894654 4468 0010                  		neg.w	obVelX(a0)
00894658                            		
00894658                            	@uponly:
00894658 0828 0006 0022             		btst	#staWater,obStatus(a0)	;Mercury Constants
0089465E 6700                       		beq.s	@nowtr
00894660 0640 0280                  		addi.w	#$280,d0
00894664                            		
00894664                            	@nowtr:
00894664 3140 0012                  		move.w	d0,obVelY(a0)
00894672                            		
00894672                            	@skip:
00894672                            
00894672 4A28 003C                  		tst.b	obJumping(a0)	;Mercury Constants
00894676 6700                       		beq.s	loc_134C4
00894678 323C FC00                  		move.w	#-$400,d1
0089467C 0828 0006 0022             		btst	#staWater,obStatus(a0)	;Mercury Constants
00894682 6700                       		beq.s	loc_134AE
00894684 323C FE00                  		move.w	#-$200,d1
00894688                            
00894688                            loc_134AE:
00894688 B268 0012                  		cmp.w	obVelY(a0),d1
0089468C 6F00                       		ble.s	locret_134C2
0089468E 1038 F602                  		move.b	(v_jpadhold2).w,d0
00894692 0200 0070                  		andi.b	#btnABC,d0	; is A, B or C pressed?
00894696 6600                       		bne.s	locret_134C2	; if yes, branch
00894698 3141 0012                  		move.w	d1,obVelY(a0)
0089469C                            
0089469C                            locret_134C2:
0089469C 4E75                       		rts	
0089469E                            ; ===========================================================================
0089469E                            
0089469E                            loc_134C4:
0089469E 0C68 F040 0012             		cmpi.w	#-$FC0,obVelY(a0)
008946A4 6C00                       		bge.s	locret_134D2
008946A6 317C F040 0012             		move.w	#-$FC0,obVelY(a0)
008946AC                            
008946AC                            locret_134D2:
008946AC 4E75                       		rts	
008946AE                            ; End of function Sonic_JumpHeight
008946AE                            ; End of function Sonic_JumpHeight
008946AE                            		
008946AE                            		include	"_incObj\(Mercury) Sonic Dash.asm"
008946AE                            Sonic_Dash:
008946AE 0828 0001 0039             		btst	#staDash,obStatus2(a0)
008946B4 6600                       		bne.s	Sonic_DashLaunch
008946B6 0C28 0000 001C             		cmpi.b	#id_LookUp,obAnim(a0)
008946BC 6600                       		bne.s	@return
008946BE 1038 F603                  		move.b	(v_jpadpress2).w,d0
008946C2 0200 0070                  		andi.b	#btnABC,d0
008946C6 6700 0000                  		beq.w	@return
008946CA 117C 0000 001C             		move.b	#id_Run,obAnim(a0)
008946D0 317C 0000 003A             		move.w	#0,$3A(a0)
008946D6 303C 00AB                  		move.w	#sfx_SpinDash,d0
008946DA 4EB9 0088 187C             		jsr		(PlaySound_Special).l
008946E0 588F                       		addq.l	#4,sp
008946E2 08E8 0001 0039             		bset	#staDash,obStatus2(a0)
008946E8                             
008946E8 6100 FD90                  		bsr.w	Sonic_LevelBound
008946EC 6100 0000                  		bsr.w	Sonic_AnglePos
008946F0                             
008946F0                            	@return:
008946F0 4E75                       		rts	
008946F2                            ; ---------------------------------------------------------------------------
008946F2                             
008946F2                            Sonic_DashLaunch:
008946F2 117C 0000 001C             		move.b	#id_DashCharge,obAnim(a0)
008946F8 1038 F602                  		move.b	(v_jpadhold2).w,d0
008946FC 0800 0000                  		btst	#bitUp,d0
00894700 6600 0000                  		bne.w	Sonic_DashCharge
00894704 08A8 0001 0039             		bclr	#staDash,obStatus2(a0)	; stop Dashing
0089470A 0C28 001E 003A             		cmpi.b	#$1E,$3A(a0)	; have we been charging long enough?
00894710 6600                       		bne.s	Sonic_DashResetScr
00894712 117C 0000 001C             		move.b	#id_Dash,obAnim(a0)	; launches here
00894718 317C 0001 0010             		move.w	#1,obVelX(a0)	; force X speed to nonzero for camera lag's benefit
0089471E 317C 0C00 0014             		move.w	#$0C00,obInertia(a0)
00894724 3028 0014                  		move.w	obInertia(a0),d0
00894728 0440 0800                  		subi.w	#$800,d0
0089472C D040                       		add.w	d0,d0
0089472E 0240 1F00                  		andi.w	#$1F00,d0
00894732 4440                       		neg.w	d0
00894734 0640 2000                  		addi.w	#$2000,d0
00894738                            		;move.w	d0,(v_cameralag).w
00894738 0828 0000 0022             		btst	#0,obStatus(a0)
0089473E 6700                       		beq.s	@dontflip
00894740 4468 0014                  		neg.w	obInertia(a0)
00894744                             
00894744                            @dontflip:
00894744                            		;bset	#2,obStatus(a0)
00894744 08A8 0007 0022             		bclr	#7,obStatus(a0)
0089474A 303C 00B6                  		move.w	#sfx_SpinRelease,d0
0089474E 4EB9 0088 187C             		jsr		(PlaySound_Special).l
00894754 6000 0000                  		bra.w	Sonic_DashResetScr
00894758                            ; ---------------------------------------------------------------------------
00894758                             
00894758                            Sonic_DashCharge:				; If still charging the dash...
00894758 0C28 001E 003A             		cmpi.b	#$1E,$3A(a0)
0089475E 6700                       		beq.s	Sonic_DashResetScr
00894760 0628 0001 003A             		addi.b	#1,$3A(a0)
00894766                            		
00894766                             
00894766                            Sonic_DashResetScr:
00894766 588F                       		addq.l	#4,sp			; increase stack ptr
00894768 0C78 0060 F73E             		cmpi.w	#$60,(v_lookshift).w
0089476E 6700                       		beq.s	@finish
00894770 6400                       		bcc.s	@skip
00894772 5878 F73E                  		addq.w	#4,(v_lookshift).w
00894776                             
00894776                            	@skip:
00894776 5578 F73E                  		subq.w	#2,(v_lookshift).w
0089477A                             
0089477A                            	@finish:
0089477A 6100 FCFE                  		bsr.w	Sonic_LevelBound
0089477E 6100 0000                  		bsr.w	Sonic_AnglePos
00894782 4E75                       		rts
00894784                            		
00894784                            		
00894784                            		
00894784                            		include	"_incObj\(Mercury) Sonic SpinDash.asm"
00894784                            Sonic_SpinDash:
00894784 0828 0000 0039             		btst	#staSpinDash,obStatus2(a0)
0089478A 6600                       		bne.s	loc_1AC8E
0089478C 0C28 0000 001C             		cmpi.b	#id_Duck,obAnim(a0)
00894792 6600                       		bne.s	locret_1AC8C
00894794 1038 F603                  		move.b	(v_jpadpress2).w,d0
00894798 0200 0070                  		andi.b	#btnABC,d0
0089479C 6700 0000                  		beq.w	locret_1AC8C
008947A0 117C 0000 001C             		move.b	#id_SpinDash,obAnim(a0)
008947A6                            		
008947A6 11FC 0001 D1DC             		move.b	#1,(v_objspace+$1C0+obAnim).w
008947AC 11FC 0000 D1DE             		move.b	#0,(v_objspace+$1C0+obTimeFrame).w
008947B2                            	
008947B2 317C 0080 003A             		move.w	#$80,(obRevSpeed)(a0)
008947B8                            	
008947B8 303C 00AB                  		move.w	#sfx_SpinDash,d0
008947BC 4EB9 0088 187C             		jsr	(PlaySound_Special).l
008947C2 588F                       		addq.l	#4,sp
008947C4 08E8 0000 0039             		bset	#staSpinDash,obStatus2(a0)
008947CA                             
008947CA                            loc_1AC84:
008947CA 6100 FCAE                  		bsr.w	Sonic_LevelBound
008947CE 6100 0000                  		bsr.w	Sonic_AnglePos
008947D2                             
008947D2                            locret_1AC8C:
008947D2 4E75                       		rts	
008947D4                            ; ---------------------------------------------------------------------------
008947D4                             
008947D4                            loc_1AC8E:
008947D4 117C 0000 001C             		move.b	#id_SpinDash,obAnim(a0)
008947DA 1038 F602                  		move.b	(v_jpadhold2).w,d0
008947DE 0800 0001                  		btst	#bitDn,d0
008947E2 6600 0000                  		bne.w	loc_1AD30
008947E6 117C 000E 0016             		move.b	#$E,obHeight(a0)
008947EC 117C 0007 0017             		move.b	#7,obWidth(a0)
008947F2 117C 0000 001C             		move.b	#id_Roll,obAnim(a0)
008947F8 5A68 000C                  		addq.w	#5,obY(a0)
008947FC 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)
00894802 7000                       		moveq	#0,d0
00894804 1028 003A                  		move.b	(obRevSpeed)(a0),d0
00894808 D040                       		add.w	d0,d0
0089480A 317C 0001 0010             		move.w	#1,obVelX(a0)	; force X speed to nonzero for camera lag's benefit
00894810 317B 0000 0014             		move.w	SpinDashSpeeds(pc,d0.w),obInertia(a0)
00894816                            		
00894816 1028 0014                  		move.b	obInertia(a0),d0
0089481A 0400 0008                  		subi.b	#$8,d0
0089481E D000                       		add.b	d0,d0
00894820 0200 001F                  		andi.b	#$1F,d0
00894824 4400                       		neg.b	d0
00894826 0600 0020                  		addi.b	#$20,d0
0089482A 11C0 FEB3                  		move.b	d0,(v_cameralag).w
0089482E                            		
0089482E 0828 0000 0022             		btst	#staFacing,obStatus(a0)	;Mercury Constants
00894834 6700                       		beq.s	@dontflip
00894836 4468 0014                  		neg.w	obInertia(a0)
0089483A                             
0089483A                            @dontflip:
0089483A 08E8 0002 0022             		bset	#staSpin,obStatus(a0)	;Mercury Constants
00894840 08A8 0007 0022             		bclr	#7,obStatus(a0)
00894846 303C 00B6                  		move.w	#sfx_SpinRelease,d0
0089484A 4EB9 0088 187C             		jsr	(PlaySound_Special).l
00894850 6000 0000                  		bra.w	loc_1AD78
00894854                            ; ---------------------------------------------------------------------------
00894854 0800                       SpinDashSpeeds:	dc.w  $800		; 0
00894856 0880                       		dc.w  $880		; 1
00894858 0900                       		dc.w  $900		; 2
0089485A 0980                       		dc.w  $980		; 3
0089485C 0A00                       		dc.w  $A00		; 4
0089485E 0A80                       		dc.w  $A80		; 5
00894860 0B00                       		dc.w  $B00		; 6
00894862 0B80                       		dc.w  $B80		; 7
00894864 0C00                       		dc.w  $C00		; 8
00894866                            ; ---------------------------------------------------------------------------
00894866                             
00894866                            loc_1AD30:				; If still charging the dash...
00894866 4A68 003A                  		tst.w	(obRevSpeed)(a0)
0089486A 6700                       		beq.s	loc_1AD48
0089486C                            		
0089486C 1038 F602                  		move.b	(v_jpadhold2).w,d0
00894870 0200 0070                  		andi.b	#btnABC,d0
00894874 6600                       		bne.s	loc_1AD48	
00894876                            		
00894876 3028 003A                  		move.w	(obRevSpeed)(a0),d0
0089487A EA48                       		lsr.w	#5,d0
0089487C 9168 003A                  		sub.w	d0,(obRevSpeed)(a0)
00894880                            		
00894880 0C68 001F 003A             		cmpi.w	#$1F,(obRevSpeed)(a0)
00894886 6600                       		bne.s	@skip
00894888 317C 0000 003A             		move.w	#0,(obRevSpeed)(a0)	; clear SpinDash Counter
0089488E 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)	; cancel SpinDash
00894894 6000                       		bra.s	loc_1AD78	; branch
00894896                            		
00894896                            	@skip:
00894896                            		
00894896 6400                       		bcc.s	loc_1AD48
00894898 317C 0000 003A             		move.w	#0,(obRevSpeed)(a0)
0089489E                             
0089489E                            loc_1AD48:
0089489E 1038 F603                  		move.b	(v_jpadpress2).w,d0
008948A2 0200 0070                  		andi.b	#btnABC,d0
008948A6 6700 0000                  		beq.w	loc_1AD78
008948AA 317C 0000 001C             		move.w	#(id_SpinDash<<8),obAnim(a0)
008948B0 0668 0200 003A             		addi.w	#$200,(obRevSpeed)(a0)
008948B6 0C68 0800 003A             		cmpi.w	#$800,(obRevSpeed)(a0)
008948BC 6500                       		bcs.s	@sound
008948BE 317C 0800 003A             		move.w	#$800,(obRevSpeed)(a0)
008948C4                            	@sound:
008948C4 303C 00AB                  		move.w	#sfx_SpinDash,d0
008948C8 4EB9 0088 187C             		jsr	(PlaySound_Special).l
008948CE                             
008948CE                            loc_1AD78:
008948CE 588F                       		addq.l	#4,sp			; increase stack ptr
008948D0 0C78 0060 F73E             		cmpi.w	#$60,(v_lookshift).w
008948D6 6700                       		beq.s	loc_1AD8C
008948D8 6400                       		bcc.s	loc_1AD88
008948DA 5878 F73E                  		addq.w	#4,(v_lookshift).w
008948DE                             
008948DE                            loc_1AD88:
008948DE 5578 F73E                  		subq.w	#2,(v_lookshift).w
008948E2                             
008948E2                            loc_1AD8C:
008948E2 6100 FB96                  		bsr.w	Sonic_LevelBound
008948E6 6100 0000                  		bsr.w	Sonic_AnglePos
008948EA 4E75                       		rts
008948EC                            		
008948EC                            		
008948EC                            		
008948EC                            		include	"_incObj\Sonic SlopeResist.asm"
008948EC                            ; ---------------------------------------------------------------------------
008948EC                            ; Subroutine to	slow Sonic walking up a	slope
008948EC                            ; ---------------------------------------------------------------------------
008948EC                            
008948EC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008948EC                            
008948EC                            
008948EC                            Sonic_SlopeResist:			; XREF: Obj01_MdNormal
008948EC 1028 0026                  		move.b	obAngle(a0),d0
008948F0 0600 0060                  		addi.b	#$60,d0
008948F4 0C00 00C0                  		cmpi.b	#$C0,d0
008948F8 6400                       		bcc.s	locret_13508
008948FA 1028 0026                  		move.b	obAngle(a0),d0
008948FE 4EB9 0088 301C             		jsr	(CalcSine).l
00894904 C1FC 0020                  		muls.w	#$20,d0
00894908 E080                       		asr.l	#8,d0
0089490A 4A68 0014                  		tst.w	obInertia(a0)
0089490E 6700                       		beq.s	locret_13508
00894910 6B00                       		bmi.s	loc_13504
00894912 4A40                       		tst.w	d0
00894914 6700                       		beq.s	locret_13502
00894916 D168 0014                  		add.w	d0,obInertia(a0) ; change Sonic's inertia
0089491A                            
0089491A                            locret_13502:
0089491A 4E75                       		rts	
0089491C                            ; ===========================================================================
0089491C                            
0089491C                            loc_13504:
0089491C D168 0014                  		add.w	d0,obInertia(a0)
00894920                            
00894920                            locret_13508:
00894920 4E75                       		rts	
00894922                            ; End of function Sonic_SlopeResist
00894922                            ; End of function Sonic_SlopeResist
00894922                            		include	"_incObj\Sonic RollRepel.asm"
00894922                            ; ---------------------------------------------------------------------------
00894922                            ; Subroutine to	push Sonic down	a slope	while he's rolling
00894922                            ; ---------------------------------------------------------------------------
00894922                            
00894922                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894922                            
00894922                            
00894922                            Sonic_RollRepel:			; XREF: Obj01_MdRoll
00894922 1028 0026                  		move.b	obAngle(a0),d0
00894926 0600 0060                  		addi.b	#$60,d0
0089492A 0C00 00C0                  		cmpi.b	#-$40,d0
0089492E 6400                       		bcc.s	locret_13544
00894930 1028 0026                  		move.b	obAngle(a0),d0
00894934 4EB9 0088 301C             		jsr	(CalcSine).l
0089493A C1FC 0050                  		muls.w	#$50,d0
0089493E E080                       		asr.l	#8,d0
00894940 4A68 0014                  		tst.w	obInertia(a0)
00894944 6B00                       		bmi.s	loc_1353A
00894946 4A40                       		tst.w	d0
00894948 6A00                       		bpl.s	loc_13534
0089494A E480                       		asr.l	#2,d0
0089494C                            
0089494C                            loc_13534:
0089494C D168 0014                  		add.w	d0,obInertia(a0)
00894950 4E75                       		rts	
00894952                            ; ===========================================================================
00894952                            
00894952                            loc_1353A:
00894952 4A40                       		tst.w	d0
00894954 6B00                       		bmi.s	loc_13540
00894956 E480                       		asr.l	#2,d0
00894958                            
00894958                            loc_13540:
00894958 D168 0014                  		add.w	d0,obInertia(a0)
0089495C                            
0089495C                            locret_13544:
0089495C 4E75                       		rts	
0089495E                            ; End of function Sonic_RollRepel
0089495E                            ; End of function Sonic_RollRepel
0089495E                            		include	"_incObj\Sonic SlopeRepel.asm"
0089495E                            ; ---------------------------------------------------------------------------
0089495E                            ; Subroutine to	push Sonic down	a slope
0089495E                            ; ---------------------------------------------------------------------------
0089495E                            
0089495E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089495E                            
0089495E                            
0089495E                            Sonic_SlopeRepel:			; XREF: Obj01_MdNormal; Obj01_MdRoll
0089495E 4E71                       		nop	
00894960 4A28 0038                  		tst.b	$38(a0)
00894964 6600                       		bne.s	locret_13580
00894966 4A68 003E                  		tst.w	$3E(a0)
0089496A 6600                       		bne.s	loc_13582
0089496C 1028 0026                  		move.b	obAngle(a0),d0
00894970 0600 0020                  		addi.b	#$20,d0
00894974 0200 00C0                  		andi.b	#$C0,d0
00894978 6700                       		beq.s	locret_13580
0089497A 3028 0014                  		move.w	obInertia(a0),d0
0089497E 6A00                       		bpl.s	loc_1356A
00894980 4440                       		neg.w	d0
00894982                            
00894982                            loc_1356A:
00894982 0C40 0280                  		cmpi.w	#$280,d0
00894986 6400                       		bcc.s	locret_13580
00894988 4268 0014                  		clr.w	obInertia(a0)
0089498C 08E8 0001 0022             		bset	#1,obStatus(a0)
00894992 317C 001E 003E             		move.w	#$1E,$3E(a0)
00894998                            
00894998                            locret_13580:
00894998 4E75                       		rts	
0089499A                            ; ===========================================================================
0089499A                            
0089499A                            loc_13582:
0089499A 5368 003E                  		subq.w	#1,$3E(a0)
0089499E 4E75                       		rts	
008949A0                            ; End of function Sonic_SlopeRepel
008949A0                            ; End of function Sonic_SlopeRepel
008949A0                            		include	"_incObj\Sonic JumpAngle.asm"
008949A0                            ; ---------------------------------------------------------------------------
008949A0                            ; Subroutine to	return Sonic's angle to 0 as he jumps
008949A0                            ; ---------------------------------------------------------------------------
008949A0                            
008949A0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008949A0                            
008949A0                            
008949A0                            Sonic_JumpAngle:			; XREF: Obj01_MdJump; Obj01_MdJump2
008949A0 1028 0026                  		move.b	obAngle(a0),d0	; get Sonic's angle
008949A4 6700                       		beq.s	locret_135A2	; if already 0,	branch
008949A6 6A00                       		bpl.s	loc_13598	; if higher than 0, branch
008949A8                            
008949A8 5400                       		addq.b	#2,d0		; increase angle
008949AA 6400                       		bcc.s	loc_13596
008949AC 7000                       		moveq	#0,d0
008949AE                            
008949AE                            loc_13596:
008949AE 6000                       		bra.s	loc_1359E
008949B0                            ; ===========================================================================
008949B0                            
008949B0                            loc_13598:
008949B0 5500                       		subq.b	#2,d0		; decrease angle
008949B2 6400                       		bcc.s	loc_1359E
008949B4 7000                       		moveq	#0,d0
008949B6                            
008949B6                            loc_1359E:
008949B6 1140 0026                  		move.b	d0,obAngle(a0)
008949BA                            
008949BA                            locret_135A2:
008949BA 4E75                       		rts	
008949BC                            ; End of function Sonic_JumpAngle
008949BC                            ; End of function Sonic_JumpAngle
008949BC                            		include	"_incObj\Sonic Floor.asm"
008949BC                            ; ---------------------------------------------------------------------------
008949BC                            ; Subroutine for Sonic to interact with	the floor after	jumping/falling
008949BC                            ; ---------------------------------------------------------------------------
008949BC                            
008949BC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008949BC                            
008949BC                            
008949BC                            Sonic_Floor:				; XREF: Obj01_MdJump; Obj01_MdJump2
008949BC 3228 0010                  		move.w	obVelX(a0),d1
008949C0 3428 0012                  		move.w	obVelY(a0),d2
008949C4 4EB9 0088 32B4             		jsr	(CalcAngle).l
008949CA 11C0 FFEC                  		move.b	d0,($FFFFFFEC).w
008949CE 0400 0020                  		subi.b	#$20,d0
008949D2 11C0 FFED                  		move.b	d0,($FFFFFFED).w
008949D6 0200 00C0                  		andi.b	#$C0,d0
008949DA 11C0 FFEE                  		move.b	d0,($FFFFFFEE).w
008949DE 0C00 0040                  		cmpi.b	#$40,d0
008949E2 6700 0000                  		beq.w	loc_13680
008949E6 0C00 0080                  		cmpi.b	#$80,d0
008949EA 6700 0000                  		beq.w	loc_136E2
008949EE 0C00 00C0                  		cmpi.b	#$C0,d0
008949F2 6700 0000                  		beq.w	loc_1373E
008949F6 6100 0000                  		bsr.w	Sonic_HitWall
008949FA 4A41                       		tst.w	d1
008949FC 6A00                       		bpl.s	loc_135F0
008949FE 9368 0008                  		sub.w	d1,obX(a0)
00894A02 317C 0000 0010             		move.w	#0,obVelX(a0)
00894A08                            
00894A08 123C 0004                  		move.b	#btnL,d1
00894A0C 6100 0000                  		bsr.w	WallJump
00894A10                            		
00894A10                            loc_135F0:
00894A10 6100 0000                  		bsr.w	sub_14EB4
00894A14 4A41                       		tst.w	d1
00894A16 6A00                       		bpl.s	loc_13602
00894A18 D368 0008                  		add.w	d1,obX(a0)
00894A1C 317C 0000 0010             		move.w	#0,obVelX(a0)
00894A22                            
00894A22 123C 0008                  		move.b	#btnR,d1
00894A26 6100 0000                  		bsr.w	WallJump
00894A2A                            		
00894A2A                            loc_13602:
00894A2A 6100 0000                  		bsr.w	Sonic_HitFloor
00894A2E 11C1 FFEF                  		move.b	d1,($FFFFFFEF).w
00894A32 4A41                       		tst.w	d1
00894A34 6A00                       		bpl.s	locret_1367E
00894A36 1428 0012                  		move.b	obVelY(a0),d2
00894A3A 5002                       		addq.b	#8,d2
00894A3C 4402                       		neg.b	d2
00894A3E B202                       		cmp.b	d2,d1
00894A40 6C00                       		bge.s	loc_1361E
00894A42 B002                       		cmp.b	d2,d0
00894A44 6D00                       		blt.s	locret_1367E
00894A46                            
00894A46                            loc_1361E:
00894A46 D368 000C                  		add.w	d1,obY(a0)
00894A4A 1143 0026                  		move.b	d3,obAngle(a0)
00894A4E                            
00894A4E 6100 0000                  		bsr.w	Sonic_ResetOnFloor
00894A52 117C 0000 001C             		move.b	#id_Walk,obAnim(a0)
00894A58 1003                       		move.b	d3,d0
00894A5A 0600 0020                  		addi.b	#$20,d0
00894A5E 0200 0040                  		andi.b	#$40,d0
00894A62 6600                       		bne.s	loc_1365C
00894A64 1003                       		move.b	d3,d0
00894A66 0600 0010                  		addi.b	#$10,d0
00894A6A 0200 0020                  		andi.b	#$20,d0
00894A6E 6700                       		beq.s	loc_1364E
00894A70 E0E8 0012                  		asr	obVelY(a0)
00894A74 6000                       		bra.s	loc_13670
00894A76                            ; ===========================================================================
00894A76                            
00894A76                            loc_1364E:
00894A76 317C 0000 0012             		move.w	#0,obVelY(a0)
00894A7C 3168 0010 0014             		move.w	obVelX(a0),obInertia(a0)
00894A82 4E75                       		rts	
00894A84                            ; ===========================================================================
00894A84                            
00894A84                            loc_1365C:
00894A84 317C 0000 0010             		move.w	#0,obVelX(a0)
00894A8A 0C68 0FC0 0012             		cmpi.w	#$FC0,obVelY(a0)
00894A90 6F00                       		ble.s	loc_13670
00894A92 317C 0FC0 0012             		move.w	#$FC0,obVelY(a0)
00894A98                            
00894A98                            loc_13670:
00894A98 3168 0012 0014             		move.w	obVelY(a0),obInertia(a0)
00894A9E 4A03                       		tst.b	d3
00894AA0 6A00                       		bpl.s	locret_1367E
00894AA2 4468 0014                  		neg.w	obInertia(a0)
00894AA6                            
00894AA6                            locret_1367E:
00894AA6 4E75                       		rts	
00894AA8                            ; ===========================================================================
00894AA8                            
00894AA8                            loc_13680:
00894AA8 6100 0000                  		bsr.w	Sonic_HitWall
00894AAC 4A41                       		tst.w	d1
00894AAE 6A00                       		bpl.s	loc_1369A
00894AB0 9368 0008                  		sub.w	d1,obX(a0)
00894AB4 317C 0000 0010             		move.w	#0,obVelX(a0)
00894ABA 3168 0012 0014             		move.w	obVelY(a0),obInertia(a0)
00894AC0 4E75                       		rts	
00894AC2                            ; ===========================================================================
00894AC2                            
00894AC2                            loc_1369A:
00894AC2 6100 0000                  		bsr.w	Sonic_DontRunOnWalls
00894AC6 4A41                       		tst.w	d1
00894AC8 6A00                       		bpl.s	loc_136B4
00894ACA 9368 000C                  		sub.w	d1,obY(a0)
00894ACE 4A68 0012                  		tst.w	obVelY(a0)
00894AD2 6A00                       		bpl.s	locret_136B2
00894AD4 317C 0000 0012             		move.w	#0,obVelY(a0)
00894ADA                            
00894ADA                            locret_136B2:
00894ADA 4E75                       		rts	
00894ADC                            ; ===========================================================================
00894ADC                            
00894ADC                            loc_136B4:
00894ADC 4A68 0012                  		tst.w	obVelY(a0)
00894AE0 6B00                       		bmi.s	locret_136E0
00894AE2 6100 0000                  		bsr.w	Sonic_HitFloor
00894AE6 4A41                       		tst.w	d1
00894AE8 6A00                       		bpl.s	locret_136E0
00894AEA D368 000C                  		add.w	d1,obY(a0)
00894AEE 1143 0026                  		move.b	d3,obAngle(a0)
00894AF2 6100 0000                  		bsr.w	Sonic_ResetOnFloor
00894AF6 117C 0000 001C             		move.b	#id_Walk,obAnim(a0)
00894AFC 317C 0000 0012             		move.w	#0,obVelY(a0)
00894B02 3168 0010 0014             		move.w	obVelX(a0),obInertia(a0)
00894B08                            
00894B08                            locret_136E0:
00894B08 4E75                       		rts	
00894B0A                            ; ===========================================================================
00894B0A                            
00894B0A                            loc_136E2:
00894B0A 6100 0000                  		bsr.w	Sonic_HitWall
00894B0E 4A41                       		tst.w	d1
00894B10 6A00                       		bpl.s	loc_136F4
00894B12 9368 0008                  		sub.w	d1,obX(a0)
00894B16 317C 0000 0010             		move.w	#0,obVelX(a0)
00894B1C                            
00894B1C 123C 0004                  		move.b	#btnL,d1
00894B20 6100 0000                  		bsr.w	WallJump
00894B24                            
00894B24                            loc_136F4:
00894B24 6100 0000                  		bsr.w	sub_14EB4
00894B28 4A41                       		tst.w	d1
00894B2A 6A00                       		bpl.s	loc_13706
00894B2C D368 0008                  		add.w	d1,obX(a0)
00894B30 317C 0000 0010             		move.w	#0,obVelX(a0)
00894B36                            
00894B36 123C 0008                  		move.b	#btnR,d1
00894B3A 6100 0000                  		bsr.w	WallJump
00894B3E                            
00894B3E                            loc_13706:
00894B3E 6100 0000                  		bsr.w	Sonic_DontRunOnWalls
00894B42 4A41                       		tst.w	d1
00894B44 6A00                       		bpl.s	locret_1373C
00894B46 9368 000C                  		sub.w	d1,obY(a0)
00894B4A 1003                       		move.b	d3,d0
00894B4C 0600 0020                  		addi.b	#$20,d0
00894B50 0200 0040                  		andi.b	#$40,d0
00894B54 6600                       		bne.s	loc_13726
00894B56 317C 0000 0012             		move.w	#0,obVelY(a0)
00894B5C 4E75                       		rts	
00894B5E                            ; ===========================================================================
00894B5E                            
00894B5E                            loc_13726:
00894B5E 1143 0026                  		move.b	d3,obAngle(a0)
00894B62 6100 0000                  		bsr.w	Sonic_ResetOnFloor
00894B66 3168 0012 0014             		move.w	obVelY(a0),obInertia(a0)
00894B6C 4A03                       		tst.b	d3
00894B6E 6A00                       		bpl.s	locret_1373C
00894B70 4468 0014                  		neg.w	obInertia(a0)
00894B74                            
00894B74                            locret_1373C:
00894B74 4E75                       		rts	
00894B76                            ; ===========================================================================
00894B76                            
00894B76                            loc_1373E:
00894B76 6100 0000                  		bsr.w	sub_14EB4
00894B7A 4A41                       		tst.w	d1
00894B7C 6A00                       		bpl.s	loc_13758
00894B7E D368 0008                  		add.w	d1,obX(a0)
00894B82 317C 0000 0010             		move.w	#0,obVelX(a0)
00894B88 3168 0012 0014             		move.w	obVelY(a0),obInertia(a0)
00894B8E 4E75                       		rts	
00894B90                            ; ===========================================================================
00894B90                            
00894B90                            loc_13758:
00894B90 6100 0000                  		bsr.w	Sonic_DontRunOnWalls
00894B94 4A41                       		tst.w	d1
00894B96 6A00                       		bpl.s	loc_13772
00894B98 9368 000C                  		sub.w	d1,obY(a0)
00894B9C 4A68 0012                  		tst.w	obVelY(a0)
00894BA0 6A00                       		bpl.s	locret_13770
00894BA2 317C 0000 0012             		move.w	#0,obVelY(a0)
00894BA8                            
00894BA8                            locret_13770:
00894BA8 4E75                       		rts	
00894BAA                            ; ===========================================================================
00894BAA                            
00894BAA                            loc_13772:
00894BAA 4A68 0012                  		tst.w	obVelY(a0)
00894BAE 6B00                       		bmi.s	locret_1379E
00894BB0 6100 0000                  		bsr.w	Sonic_HitFloor
00894BB4 4A41                       		tst.w	d1
00894BB6 6A00                       		bpl.s	locret_1379E
00894BB8 D368 000C                  		add.w	d1,obY(a0)
00894BBC 1143 0026                  		move.b	d3,obAngle(a0)
00894BC0 6100 0000                  		bsr.w	Sonic_ResetOnFloor
00894BC4 117C 0000 001C             		move.b	#id_Walk,obAnim(a0)
00894BCA 317C 0000 0012             		move.w	#0,obVelY(a0)
00894BD0 3168 0010 0014             		move.w	obVelX(a0),obInertia(a0)
00894BD6                            
00894BD6                            locret_1379E:
00894BD6 4E75                       		rts	
00894BD8                            ; End of function Sonic_Floor
00894BD8                            
00894BD8                            
00894BD8                            WallJump:
00894BD8 4A28 003C                  		tst.b	obJumping(a0)	;Mercury Constants
00894BDC 6700                       		beq.s	@return
00894BDE 4A28 0012                  		tst.b	obVelY(a0)
00894BE2 6B00                       		bmi.s	@return
00894BE4 1038 F602                  		move.b	(v_jpadhold2).w,d0	; get jpad
00894BE8 0200 000C                  		andi.b	#(btnL|btnR),d0	; keep just L and R state
00894BEC 6700                       		beq.s	@return			; fail if neither are pressed
00894BEE 0C00 000C                  		cmpi.b	#(btnL|btnR),d0	; fail if both are pressed
00894BF2 6700                       		beq.s	@return
00894BF4 C001                       		and.b	d1,d0			; keep only L or R depending on d1
00894BF6 6700                       		beq.s	@return			; fail if not pressed
00894BF8 1140 002D                  		move.b	d0,(obWallJump+1)(a0)	; remember them
00894BFC 317C 0000 0012             		move.w	#0,obVelY(a0)
00894C02 117C 0018 002C             		move.b	#$18,obWallJump(a0)	;Mercury Constants
00894C08 4228 003C                  		clr.b	obJumping(a0)
00894C0C 117C 0000 001C             		move.b	#id_WallJump,obAnim(a0)
00894C12                            		
00894C12                            	@return:
00894C12 4E75                       		rts
00894C14                            
00894C14                            
00894C14                            		include	"_incObj\Sonic ResetOnFloor.asm"
00894C14                            ; ---------------------------------------------------------------------------
00894C14                            ; Subroutine to	reset Sonic's mode when he lands on the floor
00894C14                            ; ---------------------------------------------------------------------------
00894C14                            
00894C14                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894C14                            
00894C14                            
00894C14                            Sonic_ResetOnFloor:			; XREF: PlatformObject; et al
00894C14                            
00894C14                            	
00894C14 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00894C1A 08A8 0001 0022             		bclr	#1,obStatus(a0)
00894C20                            		
00894C20                            		
00894C20 0828 0002 0022             		btst	#2,obStatus(a0)
00894C26 6700                       		beq.s	loc_137E4
00894C28 08A8 0002 0022             		bclr	#2,obStatus(a0)
00894C2E 117C 0013 0016             		move.b	#$13,obHeight(a0)
00894C34 117C 0009 0017             		move.b	#9,obWidth(a0)
00894C3A 117C 0000 001C             		move.b	#id_Walk,obAnim(a0) ; use running/walking animation
00894C40 5B68 000C                  		subq.w	#5,obY(a0)
00894C44                            
00894C44                            loc_137E4:
00894C44 117C 0000 003C             		move.b	#0,obJumping(a0)	;Mercury Constants
00894C4A                            
00894C4A 117C 0000 002C             		move.b	#0,obWallJump(a0)
00894C50                            
00894C50 31FC 0000 F7D0             		move.w	#0,(v_itembonus).w
00894C56 4E75                       		rts	
00894C58                            ; End of function Sonic_ResetOnFloor
00894C58                            ; End of function Sonic_ResetOnFloor
00894C58                            		include	"_incObj\Sonic (part 2).asm"
00894C58                            ; ---------------------------------------------------------------------------
00894C58                            ; Sonic	when he	gets hurt
00894C58                            ; ---------------------------------------------------------------------------
00894C58                            
00894C58                            Sonic_Hurt:	; Routine 4
00894C58                            
00894C58 4238 FEB3                  		clr.b	(v_cameralag).w
00894C5C                            
00894C5C 4228 002C                  		clr.b	obWallJump(a0)
00894C60                            
00894C60 4EB9 0088 E3B2             		jsr	ObjectMove
00894C66 0668 0030 0012             		addi.w	#$30,obVelY(a0)
00894C6C 0828 0006 0022             		btst	#staWater,obStatus(a0)	;Mercury Constants
00894C72 6700                       		beq.s	loc_1380C
00894C74 0468 0020 0012             		subi.w	#$20,obVelY(a0)
00894C7A                            
00894C7A                            loc_1380C:
00894C7A 6100 0000                  		bsr.w	Sonic_HurtStop
00894C7E 6100 F7FA                  		bsr.w	Sonic_LevelBound
00894C82 6100 F192                  		bsr.w	Sonic_RecordPosition
00894C86 6100 F1A8                  		bsr.w	Sonic_Water	;Mercury Hurt Splash Fix
00894C8A 6100 0000                  		bsr.w	Sonic_Animate
00894C8E 6100 0000                  		bsr.w	Sonic_LoadGfx
00894C92 4EF9 0088 E3CC             		jmp	DisplaySprite
00894C98                            
00894C98                            ; ---------------------------------------------------------------------------
00894C98                            ; Subroutine to	stop Sonic falling after he's been hurt
00894C98                            ; ---------------------------------------------------------------------------
00894C98                            
00894C98                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894C98                            
00894C98                            
00894C98                            Sonic_HurtStop:				; XREF: Sonic_Hurt
00894C98                            
00894C98                            	;Mercury Top Boundary Fix
00894C98                            		;move.w	(v_limitbtm2).w,d0
00894C98                            		;addi.w	#$E0,d0
00894C98                            		;cmp.w	obY(a0),d0
00894C98                            		;bcs.w	KillSonic
00894C98                            	;end Top Boundary Fix
00894C98                            	
00894C98 6100 FD22                  		bsr.w	Sonic_Floor
00894C9C 0828 0001 0022             		btst	#staAir,obStatus(a0)	;Mercury Constants
00894CA2 6600                       		bne.s	locret_13860
00894CA4 7000                       		moveq	#0,d0
00894CA6 3140 0012                  		move.w	d0,obVelY(a0)
00894CAA 3140 0010                  		move.w	d0,obVelX(a0)
00894CAE 3140 0014                  		move.w	d0,obInertia(a0)
00894CB2 117C 0000 001C             		move.b	#id_Walk,obAnim(a0)
00894CB8 5528 0024                  		subq.b	#2,obRoutine(a0)
00894CBC 317C 0078 0030             		move.w	#$78,obInvuln(a0)	;Mercury Constants
00894CC2                            
00894CC2                            locret_13860:
00894CC2 4E75                       		rts	
00894CC4                            ; End of function Sonic_HurtStop
00894CC4                            
00894CC4                            ; ---------------------------------------------------------------------------
00894CC4                            ; Sonic	when he	dies
00894CC4                            ; ---------------------------------------------------------------------------
00894CC4                            
00894CC4                            Sonic_Death:	; Routine 6
00894CC4                            
00894CC4 4238 FEB3                  		clr.b	(v_cameralag).w
00894CC8                            	
00894CC8 6100 0000                  		bsr.w	GameOver
00894CCC 4EB9 0088 E392             		jsr	ObjectMoveAndFall
00894CD2 6100 F142                  		bsr.w	Sonic_RecordPosition
00894CD6 6100 0000                  		bsr.w	Sonic_Animate
00894CDA 6100 0000                  		bsr.w	Sonic_LoadGfx
00894CDE 4EF9 0088 E3CC             		jmp	DisplaySprite
00894CE4                            
00894CE4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894CE4                            
00894CE4                            
00894CE4                            GameOver:				; XREF: Sonic_Death
00894CE4                            		
00894CE4                            	;Mercury Game/Time Over Timing Fix
00894CE4 3038 F704                  		move.w	(v_screenposy).w,d0	;move.w	(v_limitbtm2).w,d0
00894CE8 0640 0100                  		addi.w	#$100,d0
00894CEC B068 000C                  		cmp.w	obY(a0),d0
00894CF0 6C00 0000                  		bge.w	locret_13900	;bcc.w	locret_13900
00894CF4                            	;end Game/Time Over Timing Fix
00894CF4                            		
00894CF4 317C FFC8 0012             		move.w	#-$38,obVelY(a0)
00894CFA 5428 0024                  		addq.b	#2,obRoutine(a0)
00894CFE 4238 FE1E                  		clr.b	(f_timecount).w	; stop time counter
00894D02                            		
00894D02                            	;Mercury Lives Over/Underflow Fix
00894D02 0C38 0000 FE12             		cmpi.b	#0,(v_lives).w	; are lives at min?
00894D08 6700                       		beq.s	@skip
00894D0A 5238 FE1C                  		addq.b	#1,(f_lifecount).w ; update lives counter
00894D0E 5338 FE12                  		subq.b	#1,(v_lives).w	; subtract 1 from number of lives
00894D12 6600                       		bne.s	loc_138D4
00894D14                            	@skip:
00894D14                            	;end Lives Over/Underflow Fix
00894D14                            		
00894D14 317C 0000 003A             		move.w	#0,obRestartTimer(a0)	;Mercury Constants
00894D1A 11FC 0039 D080             		move.b	#id_GameOverCard,(v_objspace+$80).w ; load GAME object
00894D20 11FC 0039 D0C0             		move.b	#id_GameOverCard,(v_objspace+$C0).w ; load OVER object
00894D26 11FC 0001 D0DA             		move.b	#1,(v_objspace+$C0+obFrame).w ; set OVER object to correct frame
00894D2C 4238 FE1A                  		clr.b	(f_timeover).w
00894D30                            
00894D30                            loc_138C2:
00894D3A 7003                       		moveq	#3,d0
00894D3C 4EF9 0088 1BA2             		jmp	(AddPLC).l	; load game over patterns
00894D42                            ; ===========================================================================
00894D42                            
00894D42                            loc_138D4:
00894D42 317C 003C 003A             		move.w	#60,obRestartTimer(a0)	; set time delay to 1 second	;Mercury Constants
00894D48 4A38 FE1A                  		tst.b	(f_timeover).w	; is TIME OVER tag set?
00894D4C 6700                       		beq.s	locret_13900	; if not, branch
00894D4E 317C 0000 003A             		move.w	#0,obRestartTimer(a0)	;Mercury Constants
00894D54 11FC 0039 D080             		move.b	#id_GameOverCard,(v_objspace+$80).w ; load TIME object
00894D5A 11FC 0039 D0C0             		move.b	#id_GameOverCard,(v_objspace+$C0).w ; load OVER object
00894D60 11FC 0002 D09A             		move.b	#2,(v_objspace+$80+obFrame).w
00894D66 11FC 0003 D0DA             		move.b	#3,(v_objspace+$C0+obFrame).w
00894D6C 60C2                       		bra.s	loc_138C2
00894D6E                            ; ===========================================================================
00894D6E                            
00894D6E                            locret_13900:
00894D6E 4E75                       		rts	
00894D70                            ; End of function GameOver
00894D70                            
00894D70                            ; ---------------------------------------------------------------------------
00894D70                            ; Sonic	when the level is restarted
00894D70                            ; ---------------------------------------------------------------------------
00894D70                            
00894D70                            Sonic_ResetLevel:; Routine 8
00894D70 4A68 003A                  		tst.w	obRestartTimer(a0)	;Mercury Constants
00894D74 6700                       		beq.s	locret_13914
00894D76 5368 003A                  		subq.w	#1,obRestartTimer(a0)	; subtract 1 from time delay	;Mercury Constants
00894D7A 6600                       		bne.s	locret_13914
00894D7C 31FC 0001 FE02             		move.w	#1,(f_restart).w ; restart the level
00894D82                            
00894D82                            	locret_13914:
00894D82 4E75                       		rts	
00894D82 4E75                       		rts	
00894D84                            		include	"_incObj\Sonic Loops.asm"
00894D84                            ; ---------------------------------------------------------------------------
00894D84                            ; Subroutine to	make Sonic run around loops (GHZ/SLZ)
00894D84                            ; ---------------------------------------------------------------------------
00894D84                            
00894D84                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894D84                            
00894D84                            
00894D84                            Sonic_Loops:				; XREF: Obj01_Control
00894D84 0C38 0003 FE10             		cmpi.b	#id_SLZ,(v_zone).w ; is level SLZ ?
00894D8A 6700                       		beq.s	@isstarlight	; if yes, branch
00894D8C 4A38 FE10                  		tst.b	(v_zone).w	; is level GHZ ?
00894D90 6600 0000                  		bne.w	@noloops	; if not, branch
00894D94                            
00894D94                            	@isstarlight:
00894D94 3028 000C                  		move.w	obY(a0),d0
00894D98 E248                       		lsr.w	#1,d0
00894D9A 0240 0380                  		andi.w	#$380,d0
00894D9E 1228 0008                  		move.b	obX(a0),d1
00894DA2 0241 007F                  		andi.w	#$7F,d1
00894DA6 D041                       		add.w	d1,d0
00894DA8 43F8 A400                  		lea	(v_lvllayout).w,a1
00894DAC 1231 0000                  		move.b	(a1,d0.w),d1	; d1 is	the 256x256 tile Sonic is currently on
00894DB0                            
00894DB0 B238 F7AE                  		cmp.b	(v_256roll1).w,d1 ; is Sonic on a "roll tunnel" tile?
00894DB4 6700 F76E                  		beq.w	Sonic_ChkRoll	; if yes, branch
00894DB8 B238 F7AF                  		cmp.b	(v_256roll2).w,d1
00894DBC 6700 F766                  		beq.w	Sonic_ChkRoll
00894DC0                            
00894DC0 B238 F7AC                  		cmp.b	(v_256loop1).w,d1 ; is Sonic on a loop tile?
00894DC4 6700                       		beq.s	@chkifleft	; if yes, branch
00894DC6 B238 F7AD                  		cmp.b	(v_256loop2).w,d1
00894DCA 6700                       		beq.s	@chkifinair
00894DCC 08A8 0006 0001             		bclr	#6,obRender(a0) ; return Sonic to high plane
00894DD2 4E75                       		rts	
00894DD4                            ; ===========================================================================
00894DD4                            
00894DD4                            @chkifinair:
00894DD4 0828 0001 0022             		btst	#1,obStatus(a0)	; is Sonic in the air?
00894DDA 6700                       		beq.s	@chkifleft	; if not, branch
00894DDC                            
00894DDC 08A8 0006 0001             		bclr	#6,obRender(a0)	; return Sonic to high plane
00894DE2 4E75                       		rts	
00894DE4                            ; ===========================================================================
00894DE4                            
00894DE4                            @chkifleft:
00894DE4 3428 0008                  		move.w	obX(a0),d2
00894DE8 0C02 002C                  		cmpi.b	#$2C,d2
00894DEC 6400                       		bcc.s	@chkifright
00894DEE                            
00894DEE 08A8 0006 0001             		bclr	#6,obRender(a0)	; return Sonic to high plane
00894DF4 4E75                       		rts	
00894DF6                            ; ===========================================================================
00894DF6                            
00894DF6                            @chkifright:
00894DF6 0C02 00E0                  		cmpi.b	#$E0,d2
00894DFA 6500                       		bcs.s	@chkangle1
00894DFC                            
00894DFC 08E8 0006 0001             		bset	#6,obRender(a0)	; send Sonic to	low plane
00894E02 4E75                       		rts	
00894E04                            ; ===========================================================================
00894E04                            
00894E04                            @chkangle1:
00894E04 0828 0006 0001             		btst	#6,obRender(a0) ; is Sonic on low plane?
00894E0A 6600                       		bne.s	@chkangle2	; if yes, branch
00894E0C                            
00894E0C 1228 0026                  		move.b	obAngle(a0),d1
00894E10 6700                       		beq.s	@done
00894E12 0C01 0080                  		cmpi.b	#$80,d1		; is Sonic upside-down?
00894E16 6200                       		bhi.s	@done		; if yes, branch
00894E18 08E8 0006 0001             		bset	#6,obRender(a0)	; send Sonic to	low plane
00894E1E 4E75                       		rts	
00894E20                            ; ===========================================================================
00894E20                            
00894E20                            @chkangle2:
00894E20 1228 0026                  		move.b	obAngle(a0),d1
00894E24 0C01 0080                  		cmpi.b	#$80,d1		; is Sonic upright?
00894E28 6300                       		bls.s	@done		; if yes, branch
00894E2A 08A8 0006 0001             		bclr	#6,obRender(a0)	; send Sonic to	high plane
00894E30                            
00894E30                            @noloops:
00894E30                            @done:
00894E30 4E75                       		rts	
00894E32                            ; End of function Sonic_Loops
00894E32                            ; End of function Sonic_Loops
00894E32                            		include	"_incObj\Sonic Animate.asm"
00894E32                            ; ---------------------------------------------------------------------------
00894E32                            ; Subroutine to	animate	Sonic's sprites
00894E32                            ; ---------------------------------------------------------------------------
00894E32                            
00894E32                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00894E32                            
00894E32                            
00894E32                            Sonic_Animate:				; XREF: Obj01_Control; et al
00894E32 43F9 0000 0000             		lea	(Ani_Sonic).l,a1
00894E38 7000                       		moveq	#0,d0
00894E3A 1028 001C                  		move.b	obAnim(a0),d0
00894E3E B028 001D                  		cmp.b	obNextAni(a0),d0 ; is animation set to restart?
00894E42 6700                       		beq.s	@do		; if not, branch
00894E44 1140 001D                  		move.b	d0,obNextAni(a0) ; set to "no restart"
00894E48 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; reset animation
00894E4E 117C 0000 001E             		move.b	#0,obTimeFrame(a0) ; reset frame duration
00894E54                            		
00894E54 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	; clear pushing flag	;Mercury Pushing While Walking Fix	;Mercury Constants
00894E5A                            
00894E5A                            	@do:
00894E5A D040                       		add.w	d0,d0
00894E5C D2F1 0000                  		adda.w	(a1,d0.w),a1	; jump to appropriate animation	script
00894E60 1011                       		move.b	(a1),d0
00894E62 6B00                       		bmi.s	@walkrunroll	; if animation is walk/run/roll/jump, branch
00894E64 1228 0022                  		move.b	obStatus(a0),d1
00894E68 0201 0001                  		andi.b	#1,d1
00894E6C 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00894E72 8328 0001                  		or.b	d1,obRender(a0)
00894E76 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
00894E7A 6A00                       		bpl.s	@delay		; if time remains, branch
00894E7C 1140 001E                  		move.b	d0,obTimeFrame(a0) ; load frame duration
00894E80                            
00894E80                            @loadframe:
00894E80 7200                       		moveq	#0,d1
00894E82 1228 001B                  		move.b	obAniFrame(a0),d1 ; load current frame number
00894E86 1031 1001                  		move.b	1(a1,d1.w),d0	; read sprite number from script
00894E8A 6B00                       		bmi.s	@end_FF		; if animation is complete, branch
00894E8C                            
00894E8C                            	@next:
00894E8C 1140 001A                  		move.b	d0,obFrame(a0)	; load sprite number
00894E90 5228 001B                  		addq.b	#1,obAniFrame(a0) ; next frame number
00894E94                            
00894E94                            	@delay:
00894E94 4E75                       		rts	
00894E96                            ; ===========================================================================
00894E96                            
00894E96                            @end_FF:
00894E96 5200                       		addq.b	#1,d0		; is the end flag = $FF	?
00894E98 6600                       		bne.s	@end_FE		; if not, branch
00894E9A 117C 0000 001B             		move.b	#0,obAniFrame(a0) ; restart the animation
00894EA0 1029 0001                  		move.b	1(a1),d0	; read sprite number
00894EA4 60E6                       		bra.s	@next
00894EA6                            ; ===========================================================================
00894EA6                            
00894EA6                            @end_FE:
00894EA6 5200                       		addq.b	#1,d0		; is the end flag = $FE	?
00894EA8 6600                       		bne.s	@end_FD		; if not, branch
00894EAA 1031 1002                  		move.b	2(a1,d1.w),d0	; read the next	byte in	the script
00894EAE 9128 001B                  		sub.b	d0,obAniFrame(a0) ; jump back d0 bytes in the script
00894EB2 9200                       		sub.b	d0,d1
00894EB4 1031 1001                  		move.b	1(a1,d1.w),d0	; read sprite number
00894EB8 60D2                       		bra.s	@next
00894EBA                            ; ===========================================================================
00894EBA                            
00894EBA                            @end_FD:
00894EBA 5200                       		addq.b	#1,d0		; is the end flag = $FD	?
00894EBC 6600                       		bne.s	@end		; if not, branch
00894EBE 1171 1002 001C             		move.b	2(a1,d1.w),obAnim(a0) ; read next byte, run that animation
00894EC4                            
00894EC4                            	@end:
00894EC4 4E75                       		rts	
00894EC6                            ; ===========================================================================
00894EC6                            
00894EC6                            @walkrunroll:
00894EC6 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; subtract 1 from frame duration
00894ECA 6AC8                       		bpl.s	@delay		; if time remains, branch
00894ECC 5200                       		addq.b	#1,d0		; is animation walking/running?
00894ECE 6600 0000                  		bne.w	@rolljump	; if not, branch
00894ED2 7200                       		moveq	#0,d1
00894ED4 1028 0026                  		move.b	obAngle(a0),d0	; get Sonic's angle
00894ED8 1428 0022                  		move.b	obStatus(a0),d2
00894EDC 0202 0001                  		andi.b	#1,d2		; is Sonic mirrored horizontally?
00894EE0 6600                       		bne.s	@flip		; if yes, branch
00894EE2 4600                       		not.b	d0		; reverse angle
00894EE4                            
00894EE4                            	@flip:
00894EE4 0600 0010                  		addi.b	#$10,d0		; add $10 to angle
00894EE8 6A00                       		bpl.s	@noinvert	; if angle is $0-$7F, branch
00894EEA 7203                       		moveq	#3,d1
00894EEC                            
00894EEC                            	@noinvert:
00894EEC 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00894EF2 B302                       		eor.b	d1,d2
00894EF4 8528 0001                  		or.b	d2,obRender(a0)
00894EF8 0828 0005 0022             		btst	#staPush,obStatus(a0)	; is Sonic pushing something?	;Mercury Constants
00894EFE 6600 0000                  		bne.w	@push		; if yes, branch
00894F02                            
00894F02 E808                       		lsr.b	#4,d0		; divide angle by $10
00894F04 0200 0006                  		andi.b	#6,d0		; angle	must be	0, 2, 4	or 6
00894F08 3428 0014                  		move.w	obInertia(a0),d2 ; get Sonic's speed
00894F0C 6A00                       		bpl.s	@nomodspeed
00894F0E 4442                       		neg.w	d2		; modulus speed
00894F10                            
00894F10                            	@nomodspeed:
00894F10                            	
00894F10 43F9 0000 0000             		lea	(SonAni_Dash).l,a1 ; use	Dashing	animation
00894F16 0C42 0A00                  		cmpi.w	#$A00,d2	; is Sonic at Dashing speed?
00894F1A 6400                       		bcc.s	@running	; if yes, branch
00894F1C                            	
00894F1C 43F9 0000 0000             		lea	(SonAni_Run).l,a1 ; use	running	animation
00894F22 0C42 0600                  		cmpi.w	#$600,d2	; is Sonic at running speed?
00894F26 6400                       		bcc.s	@running	; if yes, branch
00894F28                            
00894F28 43F9 0000 0000             		lea	(SonAni_Walk).l,a1 ; use walking animation
00894F2E 1200                       		move.b	d0,d1
00894F30 E209                       		lsr.b	#1,d1
00894F32 D001                       		add.b	d1,d0
00894F34                            
00894F34                            	@running:
00894F34 D000                       		add.b	d0,d0
00894F36 1600                       		move.b	d0,d3
00894F38 4442                       		neg.w	d2
00894F3A 0642 0800                  		addi.w	#$800,d2
00894F3E 6A00                       		bpl.s	@belowmax
00894F40 7400                       		moveq	#0,d2		; max animation speed
00894F42                            
00894F42                            	@belowmax:
00894F42 E04A                       		lsr.w	#8,d2
00894F44 1142 001E                  		move.b	d2,obTimeFrame(a0) ; modify frame duration
00894F48 6100 FF36                  		bsr.w	@loadframe
00894F4C D728 001A                  		add.b	d3,obFrame(a0)	; modify frame number
00894F50 4E75                       		rts	
00894F52                            ; ===========================================================================
00894F52                            
00894F52                            @rolljump:
00894F52 5200                       		addq.b	#1,d0		; is animation rolling/jumping?
00894F54 6600                       		bne.s	@push		; if not, branch
00894F56 3428 0014                  		move.w	obInertia(a0),d2 ; get Sonic's speed
00894F5A 6A00                       		bpl.s	@nomodspeed2
00894F5C 4442                       		neg.w	d2
00894F5E                            
00894F5E                            	@nomodspeed2:
00894F5E 43F9 0000 0000             		lea	(SonAni_Roll2).l,a1 ; use fast animation
00894F64 0C42 0600                  		cmpi.w	#$600,d2	; is Sonic moving fast?
00894F68 6400                       		bcc.s	@rollfast	; if yes, branch
00894F6A 43F9 0000 0000             		lea	(SonAni_Roll).l,a1 ; use slower	animation
00894F70                            
00894F70                            	@rollfast:
00894F70 4442                       		neg.w	d2
00894F72 0642 0400                  		addi.w	#$400,d2
00894F76 6A00                       		bpl.s	@belowmax2
00894F78 7400                       		moveq	#0,d2
00894F7A                            
00894F7A                            	@belowmax2:
00894F7A E04A                       		lsr.w	#8,d2
00894F7C 1142 001E                  		move.b	d2,obTimeFrame(a0) ; modify frame duration
00894F80 1228 0022                  		move.b	obStatus(a0),d1
00894F84 0201 0001                  		andi.b	#1,d1
00894F88 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00894F8E 8328 0001                  		or.b	d1,obRender(a0)
00894F92 6000 FEEC                  		bra.w	@loadframe
00894F96                            ; ===========================================================================
00894F96                            
00894F96                            @push:
00894F96 3428 0014                  		move.w	obInertia(a0),d2 ; get Sonic's speed
00894F9A 6B00                       		bmi.s	@negspeed
00894F9C 4442                       		neg.w	d2
00894F9E                            
00894F9E                            	@negspeed:
00894F9E 0642 0800                  		addi.w	#$800,d2
00894FA2 6A00                       		bpl.s	@belowmax3	
00894FA4 7400                       		moveq	#0,d2
00894FA6                            
00894FA6                            	@belowmax3:
00894FA6 EC4A                       		lsr.w	#6,d2
00894FA8 1142 001E                  		move.b	d2,obTimeFrame(a0) ; modify frame duration
00894FAC 43F9 0000 0000             		lea	(SonAni_Push).l,a1
00894FB2 1228 0022                  		move.b	obStatus(a0),d1
00894FB6 0201 0001                  		andi.b	#1,d1
00894FBA 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00894FC0 8328 0001                  		or.b	d1,obRender(a0)
00894FC4 6000 FEBA                  		bra.w	@loadframe
00894FC8                            
00894FC8                            ; End of function Sonic_Animate
00894FC8                            ; End of function Sonic_Animate
00894FC8                            		include	"_anim\Sonic.asm"
00894FC8                            ; ---------------------------------------------------------------------------
00894FC8                            ; Animation script - Sonic
00894FC8                            ; ---------------------------------------------------------------------------
00894FC8                            Ani_Sonic:
00894FC8                            
00894FC8 0000                       ptr_Walk:	dc.w SonAni_Walk-Ani_Sonic
00894FCA 0000                       ptr_Run:	dc.w SonAni_Run-Ani_Sonic
00894FCC 0000                       ptr_Roll:	dc.w SonAni_Roll-Ani_Sonic
00894FCE 0000                       ptr_Roll2:	dc.w SonAni_Roll2-Ani_Sonic
00894FD0 0000                       ptr_Push:	dc.w SonAni_Push-Ani_Sonic
00894FD2 0000                       ptr_Wait:	dc.w SonAni_Wait-Ani_Sonic
00894FD4 0000                       ptr_Balance:	dc.w SonAni_Balance-Ani_Sonic
00894FD6 0000                       ptr_LookUp:	dc.w SonAni_LookUp-Ani_Sonic
00894FD8 0000                       ptr_Duck:	dc.w SonAni_Duck-Ani_Sonic
00894FDA 0000                       ptr_Warp1:	dc.w SonAni_Warp1-Ani_Sonic
00894FDC 0000                       ptr_Warp2:	dc.w SonAni_Warp2-Ani_Sonic
00894FDE 0000                       ptr_Warp3:	dc.w SonAni_Warp3-Ani_Sonic
00894FE0 0000                       ptr_Warp4:	dc.w SonAni_Warp4-Ani_Sonic
00894FE2 0000                       ptr_Stop:	dc.w SonAni_Stop-Ani_Sonic
00894FE4 0000                       ptr_Float1:	dc.w SonAni_Float1-Ani_Sonic
00894FE6 0000                       ptr_Float2:	dc.w SonAni_Float2-Ani_Sonic
00894FE8 0000                       ptr_Spring:	dc.w SonAni_Spring-Ani_Sonic
00894FEA 0000                       ptr_Hang:	dc.w SonAni_Hang-Ani_Sonic
00894FEC 0000                       ptr_Leap1:	dc.w SonAni_Leap1-Ani_Sonic
00894FEE 0000                       ptr_Leap2:	dc.w SonAni_Leap2-Ani_Sonic
00894FF0 0000                       ptr_Surf:	dc.w SonAni_Surf-Ani_Sonic
00894FF2 0000                       ptr_GetAir:	dc.w SonAni_GetAir-Ani_Sonic
00894FF4 0000                       ptr_Burnt:	dc.w SonAni_Burnt-Ani_Sonic
00894FF6 0000                       ptr_Drown:	dc.w SonAni_Drown-Ani_Sonic
00894FF8 0000                       ptr_Death:	dc.w SonAni_Death-Ani_Sonic
00894FFA 0000                       ptr_Shrink:	dc.w SonAni_Shrink-Ani_Sonic
00894FFC 0000                       ptr_Hurt:	dc.w SonAni_Hurt-Ani_Sonic
00894FFE 0000                       ptr_WaterSlide:	dc.w SonAni_WaterSlide-Ani_Sonic
00895000 0000                       ptr_Null:	dc.w SonAni_Null-Ani_Sonic
00895002 0000                       ptr_Float3:	dc.w SonAni_Float3-Ani_Sonic
00895004 0000                       ptr_Float4:	dc.w SonAni_Float4-Ani_Sonic
00895006                            
00895006 0000                       ptr_WallJump:	dc.w SonAni_WallJump-Ani_Sonic
00895008 =0000001F                  	id_WallJump:	equ (ptr_WallJump-Ani_Sonic)/2
00895008                            	
00895008 0000                       ptr_SpinDash: dc.w SonAni_SpinDash-Ani_Sonic
0089500A =00000020                  	id_SpinDash:	equ (ptr_SpinDash-Ani_Sonic)/2
0089500A                            	
0089500A 0000                       ptr_Dash:	dc.w SonAni_Dash-Ani_Sonic
0089500C 0000                       ptr_DashCharge:	dc.w SonAni_DashCharge-Ani_Sonic
0089500E =00000021                  	id_Dash:	equ (ptr_Dash-Ani_Sonic)/2
0089500E =00000022                  	id_DashCharge:	equ (ptr_DashCharge-Ani_Sonic)/2
0089500E                            	
0089500E 0000                       ptr_BalanceForward: dc.w SonAni_BalanceForward-Ani_Sonic
00895010 0000                       ptr_BalanceBack:	dc.w SonAni_BalanceBack-Ani_Sonic
00895012 =00000023                  	id_BalanceForward:	equ (ptr_BalanceForward-Ani_Sonic)/2
00895012 =00000024                  	id_BalanceBack:	equ (ptr_BalanceBack-Ani_Sonic)/2
00895012                            
00895012 FF00 0000 0000 00FF        SonAni_Walk:	dc.b $FF, fr_walk13, fr_walk14,	fr_walk15, fr_walk16, fr_walk11, fr_walk12, afEnd
0089501A                            		even
0089501A FF00 0000 00FF FFFF        SonAni_Run:	dc.b $FF,  fr_run11,  fr_run12,  fr_run13,  fr_run14,     afEnd,     afEnd, afEnd
00895022                            		even
00895022 FE00 0000 0000 FFFF        SonAni_Roll:	dc.b $FE,  fr_Roll1,  fr_Roll2,  fr_Roll3,  fr_Roll4,  fr_Roll5,     afEnd, afEnd
0089502A                            		even
0089502A FE00 0000 0000 00FF        SonAni_Roll2:	dc.b $FE,  fr_Roll1,  fr_Roll2,  fr_Roll5,  fr_Roll3,  fr_Roll4,  fr_Roll5, afEnd
00895032                            		even
00895032 FD00 0000 00FF FFFF        SonAni_Push:	dc.b $FD,  fr_push1,  fr_push2,  fr_push3,  fr_push4,     afEnd,     afEnd, afEnd
0089503A                            		even
0089503A 1700 0000 0000 0000 0000   SonAni_Wait:	dc.b $17, fr_stand, fr_stand, fr_stand, fr_stand, fr_stand, fr_stand, fr_stand, fr_stand, fr_stand
00895044 0000 0000 0000 0000 00FE+  		dc.b fr_stand, fr_stand, fr_stand, fr_wait2, fr_wait1, fr_wait1, fr_wait1, fr_wait2, fr_wait3, afBack, 2
00895050 00                         		even
00895050 1F00 00FF                  SonAni_Balance:	dc.b $1F, fr_balance1, fr_balance2, afEnd
00895054                            		even
00895054 3F00 FF                    SonAni_LookUp:	dc.b $3F, fr_lookup, afEnd
00895058 00                         		even
00895058 3F00 FF                    SonAni_Duck:	dc.b $3F, fr_duck, afEnd
0089505C 00                         		even
0089505C 3F00 FF                    SonAni_Warp1:	dc.b $3F, fr_warp1, afEnd
00895060 00                         		even
00895060 3F00 FF                    SonAni_Warp2:	dc.b $3F, fr_warp2, afEnd
00895064 00                         		even
00895064 3F00 FF                    SonAni_Warp3:	dc.b $3F, fr_warp3, afEnd
00895068 00                         		even
00895068 3F00 FF                    SonAni_Warp4:	dc.b $3F, fr_warp4, afEnd
0089506C 00                         		even
0089506C 0700 00FF                  SonAni_Stop:	dc.b 7,	fr_stop1, fr_stop2, afEnd
00895070                            		even
00895070 0700 00FF                  SonAni_Float1:	dc.b 7,	fr_float1, fr_float4, afEnd
00895074                            		even
00895074 0700 0000 0000 FF          SonAni_Float2:	dc.b 7,	fr_float1, fr_float2, fr_float5, fr_float3, fr_float6, afEnd
0089507C 00                         		even
0089507C 2F00 FD00                  SonAni_Spring:	dc.b $2F, fr_spring, afChange, id_Walk
00895080                            		even
00895080 0400 00FF                  SonAni_Hang:	dc.b 4,	fr_hang1, fr_hang2, afEnd
00895084                            		even
00895084 0F00 0000 FE01             SonAni_Leap1:	dc.b $F, fr_leap1, fr_leap1, fr_leap1,	afBack, 1
0089508A                            		even
0089508A 0F00 00FE 01               SonAni_Leap2:	dc.b $F, fr_leap1, fr_leap2, afBack, 1
00895090 00                         		even
00895090 3F00 FF                    SonAni_Surf:	dc.b $3F, fr_surf, afEnd
00895094 00                         		even
00895094 0B00 0000 00FD 00          SonAni_GetAir:	dc.b $B, fr_getair, fr_getair, fr_walk15, fr_walk16, afChange, id_Walk
0089509C 00                         		even
0089509C 2000 FF                    SonAni_Burnt:	dc.b $20, fr_burnt, afEnd
008950A0 00                         		even
008950A0 2F00 FF                    SonAni_Drown:	dc.b $2F, fr_drown, afEnd
008950A4 00                         		even
008950A4 0300 FF                    SonAni_Death:	dc.b 3,	fr_death, afEnd
008950A8 00                         		even
008950A8                            		
008950A8 0300 0000 0000 00FE 01     SonAni_Shrink:	dc.b 3,	fr_shrink1, fr_shrink2, fr_shrink3, fr_shrink4, fr_shrink5, fr_null, afBack, 1
008950B2 00                         		even
008950B2                            		
008950B2 0300 FF                    SonAni_Hurt:	dc.b 3,	fr_injury, afEnd
008950B6 00                         		even
008950B6                            SonAni_WaterSlide:
008950B6 0700 00FF                  		dc.b 7, fr_injury, fr_waterslide, afEnd
008950BA                            		even
008950BA 7700 FD00                  SonAni_Null:	dc.b $77, fr_null, afChange, id_Walk
008950BE                            		even
008950BE 0300 0000 0000 FF          SonAni_Float3:	dc.b 3,	fr_float1, fr_float2, fr_float5, fr_float3, fr_float6, afEnd
008950C6 00                         		even
008950C6 0300 FD00                  SonAni_Float4:	dc.b 3,	fr_float1, afChange, id_Walk
008950CA                            		even
008950CA                            
008950CA 0300 FF                    SonAni_WallJump:	dc.b 3,	fr_WallJump, afEnd
008950CE 00                         		even
008950CE                            	
008950CE 0000 0000 0000 0000 0000+  SonAni_SpinDash:	dc.b 0, fr_SpinDash1, fr_SpinDash2, fr_SpinDash1, fr_SpinDash3, fr_SpinDash1, fr_SpinDash4, fr_SpinDash1, fr_SpinDash5, fr_SpinDash1, fr_SpinDash6, afEnd
008950DA                            		even
008950DA                            	
008950DA FF00 0000 00FF FFFF        SonAni_Dash:	dc.b $FF,  fr_dash11,  fr_dash12,  fr_dash13,  fr_dash14,     afEnd,     afEnd, afEnd
008950E2                            		even
008950E2 0000 0000 0000 0000 00     SonAni_DashCharge:	dc.b 0,  fr_walk13, fr_walk13, fr_walk13, fr_walk13, fr_walk13, fr_walk13, fr_walk13, fr_walk13
008950EB 0000 0000 0000 0000        		dc.b	fr_walk14, fr_walk14, fr_walk14, fr_walk14, fr_walk15, fr_walk15, fr_run14, fr_run14
008950F3 0000 0000 0000 0000        		dc.b	fr_Run11,  fr_Run12,  fr_Run13,  fr_Run14, fr_Run11,  fr_Run12,  fr_Run13,  fr_Run14
008950FB 0000 0000 FE04             		dc.b	fr_dash11,  fr_dash12,  fr_dash13,  fr_dash14, afBack, 4
00895102 00                         		even
00895102                            	
00895102 0F00 0000 00FF             SonAni_BalanceForward:	dc.b $F, fr_BalanceForward1, fr_BalanceForward2, fr_BalanceForward3, fr_BalanceForward4, afEnd
00895108                            		even
00895108 0F00 0000 00FF             SonAni_BalanceBack:	dc.b $F, fr_BalanceBack1, fr_BalanceBack2, fr_BalanceBack3,fr_BalanceBack4, afEnd
0089510E                            		even
0089510E                            
0089510E =00000000                  id_Walk:	equ (ptr_Walk-Ani_Sonic)/2	; 0
0089510E =00000001                  id_Run:		equ (ptr_Run-Ani_Sonic)/2	; 1
0089510E =00000002                  id_Roll:	equ (ptr_Roll-Ani_Sonic)/2	; 2
0089510E =00000003                  id_Roll2:	equ (ptr_Roll2-Ani_Sonic)/2	; 3
0089510E =00000004                  id_Push:	equ (ptr_Push-Ani_Sonic)/2	; 4
0089510E =00000005                  id_Wait:	equ (ptr_Wait-Ani_Sonic)/2	; 5
0089510E =00000006                  id_Balance:	equ (ptr_Balance-Ani_Sonic)/2	; 6
0089510E =00000007                  id_LookUp:	equ (ptr_LookUp-Ani_Sonic)/2	; 7
0089510E =00000008                  id_Duck:	equ (ptr_Duck-Ani_Sonic)/2	; 8
0089510E =00000009                  id_Warp1:	equ (ptr_Warp1-Ani_Sonic)/2	; 9
0089510E =0000000A                  id_Warp2:	equ (ptr_Warp2-Ani_Sonic)/2	; $A
0089510E =0000000B                  id_Warp3:	equ (ptr_Warp3-Ani_Sonic)/2	; $B
0089510E =0000000C                  id_Warp4:	equ (ptr_Warp4-Ani_Sonic)/2	; $C
0089510E =0000000D                  id_Stop:	equ (ptr_Stop-Ani_Sonic)/2	; $D
0089510E =0000000E                  id_Float1:	equ (ptr_Float1-Ani_Sonic)/2	; $E
0089510E =0000000F                  id_Float2:	equ (ptr_Float2-Ani_Sonic)/2	; $F
0089510E =00000010                  id_Spring:	equ (ptr_Spring-Ani_Sonic)/2	; $10
0089510E =00000011                  id_Hang:	equ (ptr_Hang-Ani_Sonic)/2	; $11
0089510E =00000012                  id_Leap1:	equ (ptr_Leap1-Ani_Sonic)/2	; $12
0089510E =00000013                  id_Leap2:	equ (ptr_Leap2-Ani_Sonic)/2	; $13
0089510E =00000014                  id_Surf:	equ (ptr_Surf-Ani_Sonic)/2	; $14
0089510E =00000015                  id_GetAir:	equ (ptr_GetAir-Ani_Sonic)/2	; $15
0089510E =00000016                  id_Burnt:	equ (ptr_Burnt-Ani_Sonic)/2	; $16
0089510E =00000017                  id_Drown:	equ (ptr_Drown-Ani_Sonic)/2	; $17
0089510E =00000018                  id_Death:	equ (ptr_Death-Ani_Sonic)/2	; $18
0089510E =00000019                  id_Shrink:	equ (ptr_Shrink-Ani_Sonic)/2	; $19
0089510E =0000001A                  id_Hurt:	equ (ptr_Hurt-Ani_Sonic)/2	; $1A
0089510E =0000001B                  id_WaterSlide:	equ (ptr_WaterSlide-Ani_Sonic)/2 ; $1B
0089510E =0000001C                  id_Null:	equ (ptr_Null-Ani_Sonic)/2	; $1C
0089510E =0000001D                  id_Float3:	equ (ptr_Float3-Ani_Sonic)/2	; $1D
0089510E =0000001E                  id_Float4:	equ (ptr_Float4-Ani_Sonic)/2	; $1E
0089510E =0000001E                  id_Float4:	equ (ptr_Float4-Ani_Sonic)/2	; $1E
0089510E                            		
0089510E                            		include	"_incObj\(Mercury) Sonic LoadGfx (dma).asm"
0089510E                            ; ---------------------------------------------------------------------------
0089510E                            ; Sonic	graphics loading subroutine
0089510E                            ; ---------------------------------------------------------------------------
0089510E                            
0089510E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089510E                            
0089510E                            
0089510E                            Sonic_LoadGfx:				; XREF: Obj01_Control; et al
0089510E 7000                       	moveq	#0,d0
00895110 1028 001A                  	move.b	obFrame(a0),d0	; load frame number
00895114 B038 F766                  	cmp.b	(v_sonframenum).w,d0 ; has frame changed?
00895118 6700                       	beq.s	@nochange	; if not, branch
0089511A                            
0089511A 11C0 F766                  	move.b	d0,(v_sonframenum).w
0089511E 45F9 0000 0000             	lea	(SonicDynPLC).l,a2 ; load PLC script
00895124 D040                       	add.w	d0,d0
00895126 D4F2 0000                  	adda.w	(a2,d0.w),a2
0089512A 7A00                       	moveq	#0,d5
0089512C 1A1A                       	move.b	(a2)+,d5	; read "number of entries" value
0089512E 5345                       	subq.w	#1,d5
00895130 6B00                       	bmi.s	@nochange	; if zero, branch
00895132 383C F000                  	move.w	#$F000,d4
00895136 2C3C 0000 0000             	move.l	#Art_Sonic-$800000,d6
0089513C                            
0089513C                            @readentry:
0089513C 7200                       	moveq	#0,d1
0089513E 121A                       	move.b	(a2)+,d1
00895140 E149                       	lsl.w	#8,d1
00895142 121A                       	move.b	(a2)+,d1
00895144 3601                       	move.w	d1,d3
00895146 E04B                       	lsr.w	#8,d3
00895148 0243 00F0                  	andi.w	#$F0,d3
0089514C 0643 0010                  	addi.w	#$10,d3
00895150 0241 0FFF                  	andi.w	#$FFF,d1
00895154 EB89                       	lsl.l	#5,d1
00895156 D286                       	add.l	d6,d1
00895158 3404                       	move.w	d4,d2
0089515A D843                       	add.w	d3,d4
0089515C D843                       	add.w	d3,d4
0089515E 4EB9 0088 199A             	jsr	(QueueDMATransfer).l
00895164 51CD FFD6                  	dbf	d5,@readentry	; repeat for number of entries
00895168                            
00895168                            @nochange:
00895168 4E75                       	rts	
0089516A                            
0089516A                            ; End of function Sonic_LoadGfx
0089516A                            
0089516A                            
0089516A                            
0089516A                            		include	"_incObj\0A Drowning Countdown.asm"
0089516A                            ; ---------------------------------------------------------------------------
0089516A                            ; Object 0A - drowning countdown numbers and small bubbles that float out of
0089516A                            ; Sonic's mouth (LZ)
0089516A                            ; ---------------------------------------------------------------------------
0089516A                            
0089516A                            DrownCount:				; XREF: Obj_Index
0089516A 7000                       		moveq	#0,d0
0089516C 1028 0024                  		move.b	obRoutine(a0),d0
00895170 323B 0000                  		move.w	Drown_Index(pc,d0.w),d1
00895174 4EFB 1000                  		jmp	Drown_Index(pc,d1.w)
00895178                            ; ===========================================================================
00895178                            Drown_Index:
00895178 0000                       ptr_Drown_Main:		dc.w Drown_Main-Drown_Index
0089517A 0000                       ptr_Drown_Animate:	dc.w Drown_Animate-Drown_Index
0089517C 0000                       ptr_Drown_ChkWater:	dc.w Drown_ChkWater-Drown_Index
0089517E 0000                       ptr_Drown_Display:	dc.w Drown_Display-Drown_Index
00895180 0000                       ptr_Drown_Delete:	dc.w Drown_Delete-Drown_Index
00895182 0000                       ptr_Drown_Countdown:	dc.w Drown_Countdown-Drown_Index
00895184 0000                       ptr_Drown_AirLeft:	dc.w Drown_AirLeft-Drown_Index
00895186 0000                       			dc.w Drown_Display-Drown_Index
00895188 0000                       			dc.w Drown_Delete-Drown_Index
0089518A                            
0089518A =00000030                  origX:		= $30		; original x-axis position
0089518A =00000038                  time:		= $38		; time between each number changes
0089518A                            
0089518A =00000000                  id_Drown_Main:		= ptr_Drown_Main-Drown_Index		; 0
0089518A =00000002                  id_Drown_Animate:	= ptr_Drown_Animate-Drown_Index		; 2
0089518A =00000004                  id_Drown_ChkWater:	= ptr_Drown_ChkWater-Drown_Index	; 4
0089518A =00000006                  id_Drown_Display:	= ptr_Drown_Display-Drown_Index		; 6
0089518A =00000008                  id_Drown_Delete:	= ptr_Drown_Delete-Drown_Index		; 8
0089518A =0000000A                  id_Drown_Countdown:	= ptr_Drown_Countdown-Drown_Index	; $A
0089518A =0000000C                  id_Drown_AirLeft:	= ptr_Drown_AirLeft-Drown_Index		; $C
0089518A                            ; ===========================================================================
0089518A                            
0089518A                            Drown_Main:	; Routine 0
0089518A 5428 0024                  		addq.b	#2,obRoutine(a0)
0089518E 217C 0089 38C4 0004        		move.l	#Map_Bub,obMap(a0)
00895196 317C 8348 0002             		move.w	#$8348,obGfx(a0)
0089519C 117C 0084 0001             		move.b	#$84,obRender(a0)
008951A2 117C 0010 0019             		move.b	#$10,obActWid(a0)
008951A8 117C 0001 0018             		move.b	#1,obPriority(a0)
008951AE 1028 0028                  		move.b	obSubtype(a0),d0 ; get bubble type
008951B2 6A00                       		bpl.s	@smallbubble	; branch if $00-$7F
008951B4                            
008951B4 5028 0024                  		addq.b	#8,obRoutine(a0) ; goto Drown_Countdown next
008951B8 217C 0000 0000 0004        		move.l	#Map_Drown,obMap(a0)
008951C0 317C 0440 0002             		move.w	#$440,obGfx(a0)
008951C6 0240 007F                  		andi.w	#$7F,d0
008951CA 1140 0033                  		move.b	d0,$33(a0)
008951CE 6000 0000                  		bra.w	Drown_Countdown
008951D2                            ; ===========================================================================
008951D2                            
008951D2                            @smallbubble:
008951D2 1140 001C                  		move.b	d0,obAnim(a0)
008951D6 3168 0008 0030             		move.w	obX(a0),origX(a0)
008951DC 317C FF78 0012             		move.w	#-$88,obVelY(a0)
008951E2                            
008951E2                            Drown_Animate:	; Routine 2
008951E2 43F9 0000 0000             		lea	(Ani_Drown).l,a1
008951E8 4EB9 0088 B4B0             		jsr	AnimateSprite
008951EE                            
008951EE                            Drown_ChkWater:	; Routine 4
008951EE 3038 F646                  		move.w	(v_waterpos1).w,d0
008951F2 B068 000C                  		cmp.w	obY(a0),d0	; has bubble reached the water surface?
008951F6 6500                       		bcs.s	@wobble		; if not, branch
008951F8                            
008951F8 117C 0006 0024             		move.b	#id_Drown_Display,obRoutine(a0) ; goto Drown_Display next
008951FE 5E28 001C                  		addq.b	#7,obAnim(a0)
00895202 0C28 000D 001C             		cmpi.b	#$D,obAnim(a0)
00895208 6700                       		beq.s	Drown_Display
0089520A 6000                       		bra.s	Drown_Display
0089520C                            ; ===========================================================================
0089520C                            
0089520C                            @wobble:
0089520C 4A38 F7C7                  		tst.b	(f_wtunnelmode).w ; is Sonic in a water tunnel?
00895210 6700                       		beq.s	@notunnel	; if not, branch
00895212 5868 0030                  		addq.w	#4,origX(a0)
00895216                            
00895216                            	@notunnel:
00895216 1028 0026                  		move.b	obAngle(a0),d0
0089521A 5228 0026                  		addq.b	#1,obAngle(a0)
0089521E 0240 007F                  		andi.w	#$7F,d0
00895222 43F9 0000 0000             		lea	(Drown_WobbleData).l,a1
00895228 1031 0000                  		move.b	(a1,d0.w),d0
0089522C 4880                       		ext.w	d0
0089522E D068 0030                  		add.w	origX(a0),d0
00895232 3140 0008                  		move.w	d0,obX(a0)
00895236 6100                       		bsr.s	Drown_ShowNumber
00895238 4EB9 0088 E3B2             		jsr	ObjectMove
0089523E 4A28 0001                  		tst.b	obRender(a0)
00895242 6A00                       		bpl.s	@delete
00895244 4EF9 0088 E3CC             		jmp	DisplaySprite
0089524A                            
0089524A                            	@delete:
0089524A 4EF9 0088 E408             		jmp	DeleteObject
00895250                            ; ===========================================================================
00895250                            
00895250                            Drown_Display:	; Routine 6, Routine $E
00895250 6100                       		bsr.s	Drown_ShowNumber
00895252 43F9 0000 0000             		lea	(Ani_Drown).l,a1
00895258 4EB9 0088 B4B0             		jsr	AnimateSprite
0089525E 4EF9 0088 E3CC             		jmp	DisplaySprite
00895264                            ; ===========================================================================
00895264                            
00895264                            Drown_Delete:	; Routine 8, Routine $10
00895264 4EF9 0088 E408             		jmp	DeleteObject
0089526A                            ; ===========================================================================
0089526A                            
0089526A                            Drown_AirLeft:	; Routine $C
0089526A 0C78 000C FE14             		cmpi.w	#$C,(v_air).w	; check air remaining
00895270 6200                       		bhi.s	Drown_AirLeft_Delete		; if higher than $C, branch
00895272 5368 0038                  		subq.w	#1,time(a0)
00895276 6600                       		bne.s	@display
00895278 117C 000E 0024             		move.b	#id_Drown_Display+8,obRoutine(a0) ; goto Drown_Display next
0089527E 5E28 001C                  		addq.b	#7,obAnim(a0)
00895282 60CC                       		bra.s	Drown_Display
00895284                            ; ===========================================================================
00895284                            
00895284                            	@display:
00895284 43F9 0000 0000             		lea	(Ani_Drown).l,a1
0089528A 4EB9 0088 B4B0             		jsr	AnimateSprite
00895290 4A28 0001                  		tst.b	obRender(a0)
00895294 6A00                       		bpl.s	Drown_AirLeft_Delete
00895296 4EF9 0088 E3CC             		jmp	DisplaySprite
0089529C                            
0089529C                            Drown_AirLeft_Delete:	
0089529C 4EF9 0088 E408             		jmp	DeleteObject
008952A2                            ; ===========================================================================
008952A2                            
008952A2                            Drown_ShowNumber:			; XREF: @wobble; Drown_Display
008952A2 4A68 0038                  		tst.w	time(a0)
008952A6 6700                       		beq.s	@nonumber
008952A8 5368 0038                  		subq.w	#1,time(a0)	; decrement timer
008952AC 6600                       		bne.s	@nonumber	; if time remains, branch
008952AE 0C28 0007 001C             		cmpi.b	#7,obAnim(a0)
008952B4 6400                       		bcc.s	@nonumber
008952B6                            
008952B6 317C 000F 0038             		move.w	#15,time(a0)
008952BC 4268 0012                  		clr.w	obVelY(a0)
008952C0 117C 0080 0001             		move.b	#$80,obRender(a0)
008952C6 3028 0008                  		move.w	obX(a0),d0
008952CA 9078 F700                  		sub.w	(v_screenposx).w,d0
008952CE 0640 0080                  		addi.w	#$80,d0
008952D2 3140 0008                  		move.w	d0,obX(a0)
008952D6 3028 000C                  		move.w	obY(a0),d0
008952DA 9078 F704                  		sub.w	(v_screenposy).w,d0
008952DE 0640 0080                  		addi.w	#$80,d0
008952E2 3140 000A                  		move.w	d0,obScreenY(a0)
008952E6 117C 000C 0024             		move.b	#id_Drown_AirLeft,obRoutine(a0) ; goto Drown_AirLeft next
008952EC                            
008952EC                            	@nonumber:
008952EC 4E75                       		rts	
008952EE                            ; ===========================================================================
008952EE                            Drown_WobbleData:
008952EE 0000 0000 0000 0101 0101+  		dc.b 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2
008952FE 0202 0303 0303 0303 0303+  		dc.b 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3
0089530E 0303 0303 0303 0303 0303+  		dc.b 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2
0089531E 0202 0202 0202 0101 0101+  		dc.b 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0
0089532E 00FF FFFF FFFF FEFE FEFE+  		dc.b 0, -1, -1, -1, -1, -1, -2, -2, -2, -2, -2, -3, -3, -3, -3, -3
0089533E FDFD FCFC FCFC FCFC FCFC+  		dc.b -3, -3, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4
0089534E FCFC FCFC FCFC FCFC FCFC+  		dc.b -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -3
0089535E FDFD FDFD FDFD FEFE FEFE+  		dc.b -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -1, -1, -1, -1, -1
0089536E 0000 0000 0000 0101 0101+  		dc.b 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 2, 2, 2, 2, 2
0089537E 0202 0303 0303 0303 0303+  		dc.b 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3
0089538E 0303 0303 0303 0303 0303+  		dc.b 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 2
0089539E 0202 0202 0202 0101 0101+  		dc.b 2, 2, 2, 2, 2, 2, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0
008953AE 00FF FFFF FFFF FEFE FEFE+  		dc.b 0, -1, -1, -1, -1, -1, -2, -2, -2, -2, -2, -3, -3, -3, -3, -3
008953BE FDFD FCFC FCFC FCFC FCFC+  		dc.b -3, -3, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4
008953CE FCFC FCFC FCFC FCFC FCFC+  		dc.b -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -4, -3
008953DE FDFD FDFD FDFD FEFE FEFE+  		dc.b -3, -3, -3, -3, -3, -3, -2, -2, -2, -2, -2, -1, -1, -1, -1, -1
008953EE                            ; ===========================================================================
008953EE                            
008953EE                            Drown_Countdown:; Routine $A
008953EE 4A68 002C                  		tst.w	$2C(a0)
008953F2 6600 0000                  		bne.w	@loc_13F86
008953F6 0C38 0006 D024             		cmpi.b	#6,(v_player+obRoutine).w
008953FC 6400 0000                  		bcc.w	@nocountdown
00895400 0838 0006 D022             		btst	#6,(v_player+obStatus).w ; is Sonic underwater?
00895406 6700 0000                  		beq.w	@nocountdown	; if not, branch
0089540A                            
0089540A 5368 0038                  		subq.w	#1,time(a0)	; decrement timer
0089540E 6A00 0000                  		bpl.w	@nochange	; branch if time remains
00895412 317C 003B 0038             		move.w	#59,time(a0)
00895418 317C 0001 0036             		move.w	#1,$36(a0)
0089541E 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00895424 0240 0001                  		andi.w	#1,d0
00895428 1140 0034                  		move.b	d0,$34(a0)
0089542C 3038 FE14                  		move.w	(v_air).w,d0	; check air remaining
00895430 0C40 0019                  		cmpi.w	#25,d0
00895434 6700                       		beq.s	@warnsound	; play sound if	air is 25
00895436 0C40 0014                  		cmpi.w	#20,d0
0089543A 6700                       		beq.s	@warnsound
0089543C 0C40 000F                  		cmpi.w	#15,d0
00895440 6700                       		beq.s	@warnsound
00895442 0C40 000C                  		cmpi.w	#12,d0
00895446 6200                       		bhi.s	@reduceair	; if air is above 12, branch
00895448                            
00895448 6600                       		bne.s	@skipmusic	; if air is less than 12, branch
00895454                            
00895454                            	@skipmusic:
00895454 5328 0032                  		subq.b	#1,$32(a0)
00895458 6A00                       		bpl.s	@reduceair
0089545A 1168 0033 0032             		move.b	$33(a0),$32(a0)
00895460 08E8 0007 0036             		bset	#7,$36(a0)
00895466 6000                       		bra.s	@reduceair
00895468                            ; ===========================================================================
00895468                            
00895468                            @warnsound:
00895472                            
00895472                            @reduceair:
00895472 5378 FE14                  		subq.w	#1,(v_air).w	; subtract 1 from air remaining
00895476 6400 0000                  		bcc.w	@gotomakenum	; if air is above 0, branch
0089547A                            
0089547A                            		; Sonic drowns here
0089547A 6100 0000                  		bsr.w	ResumeMusic
0089547E 11FC 0081 F7C8             		move.b	#$81,(f_lockmulti).w ; lock controls
0089548E 117C 000A 0034             		move.b	#$A,$34(a0)
00895494 317C 0001 0036             		move.w	#1,$36(a0)
0089549A 317C 0078 002C             		move.w	#$78,$2C(a0)
008954A0 2F08                       		move.l	a0,-(sp)
008954A2 41F8 D000                  		lea	(v_player).w,a0
008954A6 6100 F76C                  		bsr.w	Sonic_ResetOnFloor
008954AA 117C 0017 001C             		move.b	#id_Drown,obAnim(a0)	; use Sonic's drowning animation
008954B0                            		
008954B0 08A8 0001 0039             		bclr	#staDash,obStatus2(a0)	; clear Dash flag
008954B6                            		
008954B6 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)	; clear Spin Dash flag
008954BC                            		
008954BC 08E8 0001 0022             		bset	#staAir,obStatus(a0)	;Mercury Constants
008954C2 08E8 0007 0002             		bset	#7,obGfx(a0)
008954C8 317C 0000 0012             		move.w	#0,obVelY(a0)
008954CE 317C 0000 0010             		move.w	#0,obVelX(a0)
008954D4 317C 0000 0014             		move.w	#0,obInertia(a0)
008954DA 11FC 0001 F744             		move.b	#1,(f_nobgscroll).w
008954E0 205F                       		movea.l	(sp)+,a0
008954E2 4E75                       		rts	
008954E4                            ; ===========================================================================
008954E4                            
008954E4                            @loc_13F86:
008954E4 5368 002C                  		subq.w	#1,$2C(a0)
008954E8 6600                       		bne.s	@loc_13F94
008954EA 11FC 0006 D024             		move.b	#6,(v_player+obRoutine).w
008954F0 4E75                       		rts	
008954F2                            ; ===========================================================================
008954F2                            
008954F2                            	@loc_13F94:
008954F2 2F08                       		move.l	a0,-(sp)
008954F4 41F8 D000                  		lea	(v_player).w,a0
008954F8 4EB9 0088 E3B2             		jsr	ObjectMove
008954FE 0668 0010 0012             		addi.w	#$10,obVelY(a0)
00895504 205F                       		movea.l	(sp)+,a0
00895506 6000                       		bra.s	@nochange
00895508                            ; ===========================================================================
00895508                            
00895508                            @gotomakenum:
00895508 6000                       		bra.s	@makenum
0089550A                            ; ===========================================================================
0089550A                            
0089550A                            @nochange:
0089550A 4A68 0036                  		tst.w	$36(a0)
0089550E 6700 0000                  		beq.w	@nocountdown
00895512 5368 003A                  		subq.w	#1,$3A(a0)
00895516 6A00 0000                  		bpl.w	@nocountdown
0089551A                            
0089551A                            @makenum:
0089551A 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00895520 0240 000F                  		andi.w	#$F,d0
00895524 3140 003A                  		move.w	d0,$3A(a0)
00895528 4EB9 0088 E862             		jsr	FindFreeObj
0089552E 6600 0000                  		bne.w	@nocountdown
00895532 137C 000A 0000             		move.b	#id_DrownCount,0(a1) ; load object
00895538 3378 D008 0008             		move.w	(v_player+obX).w,obX(a1) ; match X position to Sonic
0089553E 7006                       		moveq	#6,d0
00895540 0838 0000 D022             		btst	#0,(v_player+obStatus).w
00895546 6700                       		beq.s	@noflip
00895548 4440                       		neg.w	d0
0089554A 137C 0040 0026             		move.b	#$40,obAngle(a1)
00895550                            
00895550                            	@noflip:
00895550 D169 0008                  		add.w	d0,obX(a1)
00895554 3378 D00C 000C             		move.w	(v_player+obY).w,obY(a1)
0089555A 137C 0006 0028             		move.b	#6,obSubtype(a1)
00895560 4A68 002C                  		tst.w	$2C(a0)
00895564 6700 0000                  		beq.w	@loc_1403E
00895568 0268 0007 003A             		andi.w	#7,$3A(a0)
0089556E 0668 0000 003A             		addi.w	#0,$3A(a0)
00895574 3038 D00C                  		move.w	(v_player+obY).w,d0
00895578 0440 000C                  		subi.w	#$C,d0
0089557C 3340 000C                  		move.w	d0,obY(a1)
00895580 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00895586 1340 0026                  		move.b	d0,obAngle(a1)
0089558A 3038 FE04                  		move.w	(v_framecount).w,d0
0089558E 0200 0003                  		andi.b	#3,d0
00895592 6600                       		bne.s	@loc_14082
00895594 137C 000E 0028             		move.b	#$E,obSubtype(a1)
0089559A 6000                       		bra.s	@loc_14082
0089559C                            ; ===========================================================================
0089559C                            
0089559C                            @loc_1403E:
0089559C 0828 0007 0036             		btst	#7,$36(a0)
008955A2 6700                       		beq.s	@loc_14082
008955A4 3438 FE14                  		move.w	(v_air).w,d2
008955A8 E24A                       		lsr.w	#1,d2
008955AA 4EB9 0088 2FF6             		jsr	(RandomNumber).l
008955B0 0240 0003                  		andi.w	#3,d0
008955B4 6600                       		bne.s	@loc_1406A
008955B6 08E8 0006 0036             		bset	#6,$36(a0)
008955BC 6600                       		bne.s	@loc_14082
008955BE 1342 0028                  		move.b	d2,obSubtype(a1)
008955C2 337C 001C 0038             		move.w	#$1C,time(a1)
008955C8                            
008955C8                            	@loc_1406A:
008955C8 4A28 0034                  		tst.b	$34(a0)
008955CC 6600                       		bne.s	@loc_14082
008955CE 08E8 0006 0036             		bset	#6,$36(a0)
008955D4 6600                       		bne.s	@loc_14082
008955D6 1342 0028                  		move.b	d2,obSubtype(a1)
008955DA 337C 001C 0038             		move.w	#$1C,time(a1)
008955E0                            
008955E0                            @loc_14082:
008955E0 5328 0034                  		subq.b	#1,$34(a0)
008955E4 6A00                       		bpl.s	@nocountdown
008955E6 4268 0036                  		clr.w	$36(a0)
008955EA                            
008955EA                            @nocountdown:
008955EA 4E75                       		rts	
008955EA 4E75                       		rts	
008955EC                            
008955EC                            
008955EC                            ; ---------------------------------------------------------------------------
008955EC                            ; Subroutine to	play music for LZ/SBZ3 after a countdown
008955EC                            ; ---------------------------------------------------------------------------
008955EC                            
008955EC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008955EC                            
008955EC                            
008955EC                            ResumeMusic:				; XREF: Obj64_Wobble; Sonic_Water; Obj0A_ReduceAir
008955EC 0C78 000C FE14             		cmpi.w	#12,(v_air).w	; more than 12 seconds of air left?
008955F2 6200                       		bhi.s	@over12		; if yes, branch
008955F4 303C 0002                  		move.w	#bgm_LZ,d0	; play LZ music
008955F8 0C78 0103 FE10             		cmpi.w	#(id_LZ<<8)+3,(v_zone).w ; check if level is 0103 (SBZ3)
008955FE 6600                       		bne.s	@notsbz
00895600 303C 0006                  		move.w	#bgm_SBZ,d0	; play SBZ music
00895604                            
00895604                            	@notsbz:
00895604                            
00895604 4A38 FE2D                  		tst.b	(v_invinc).w ; is Sonic invincible?
00895608 6700                       		beq.s	@notinvinc ; if not, branch
0089560A 303C 0007                  		move.w	#bgm_Invincible,d0
0089560E                            	@notinvinc:
0089560E 4A38 F7AA                  		tst.b	(f_lockscreen).w ; is Sonic at a boss?
00895612 6700                       		beq.s	@playselected ; if not, branch
00895614 303C 000C                  		move.w	#bgm_Boss,d0
00895618                            	@playselected:
00895618 4EB9 0088 183C             		jsr	(PlaySound).l
0089561E                            
0089561E                            	@over12:
0089561E 31FC 001E FE14             		move.w	#30,(v_air).w	; reset air to 30 seconds
00895624 4238 D372                  		clr.b	(v_objspace+$340+$32).w
00895628 4E75                       		rts	
0089562A                            ; End of function ResumeMusic
0089562A                            
0089562A                            ; ===========================================================================
0089562A                            
0089562A                            		include	"_anim\Drowning Countdown.asm"
0089562A                            ; ---------------------------------------------------------------------------
0089562A                            ; Animation script - countdown numbers and bubbles (LZ)
0089562A                            ; ---------------------------------------------------------------------------
0089562A 0000                       Ani_Drown:	dc.w @zeroappear-Ani_Drown
0089562C 0000                       		dc.w @oneappear-Ani_Drown
0089562E 0000                       		dc.w @twoappear-Ani_Drown
00895630 0000                       		dc.w @threeappear-Ani_Drown
00895632 0000                       		dc.w @fourappear-Ani_Drown
00895634 0000                       		dc.w @fiveappear-Ani_Drown
00895636 0000                       		dc.w @smallbubble-Ani_Drown
00895638 0000                       		dc.w @zeroflash-Ani_Drown
0089563A 0000                       		dc.w @oneflash-Ani_Drown
0089563C 0000                       		dc.w @twoflash-Ani_Drown
0089563E 0000                       		dc.w @threeflash-Ani_Drown
00895640 0000                       		dc.w @fourflash-Ani_Drown
00895642 0000                       		dc.w @fiveflash-Ani_Drown
00895644 0000                       		dc.w @blank-Ani_Drown
00895646 0000                       		dc.w @mediumbubble-Ani_Drown
00895648 0500 0102 0304 090D FC     @zeroappear:	dc.b 5,	0, 1, 2, 3, 4, 9, $D, afRoutine
00895652 00                         		even
00895652 0500 0102 0304 0C12 FC     @oneappear:	dc.b 5,	0, 1, 2, 3, 4, $C, $12,	afRoutine
0089565C 00                         		even
0089565C 0500 0102 0304 0C11 FC     @twoappear:	dc.b 5,	0, 1, 2, 3, 4, $C, $11,	afRoutine
00895666 00                         		even
00895666 0500 0102 0304 0B10 FC     @threeappear:	dc.b 5,	0, 1, 2, 3, 4, $B, $10,	afRoutine
00895670 00                         		even
00895670 0500 0102 0304 090F FC     @fourappear:	dc.b 5,	0, 1, 2, 3, 4, 9, $F, afRoutine
0089567A 00                         		even
0089567A 0500 0102 0304 0A0E FC     @fiveappear:	dc.b 5,	0, 1, 2, 3, 4, $A, $E, afRoutine
00895684 00                         		even
00895684 0E00 0102 FC               @smallbubble:	dc.b $E, 0, 1, 2, afRoutine
0089568A 00                         		even
0089568A 0716 0D16 0D16 0DFC        @zeroflash:	dc.b 7,	$16, $D, $16, $D, $16, $D, afRoutine
00895692 0716 1216 1216 12FC        @oneflash:	dc.b 7,	$16, $12, $16, $12, $16, $12, afRoutine
0089569A 0716 1116 1116 11FC        @twoflash:	dc.b 7,	$16, $11, $16, $11, $16, $11, afRoutine
008956A2 0716 1016 1016 10FC        @threeflash:	dc.b 7,	$16, $10, $16, $10, $16, $10, afRoutine
008956AA 0716 0F16 0F16 0FFC        @fourflash:	dc.b 7,	$16, $F, $16, $F, $16, $F, afRoutine
008956B2 0716 0E16 0E16 0EFC        @fiveflash:	dc.b 7,	$16, $E, $16, $E, $16, $E, afRoutine
008956BA 0EFC                       @blank:		dc.b $E, afRoutine
008956BC 0E01 0203 04FC             @mediumbubble:	dc.b $E, 1, 2, 3, 4, afRoutine
008956C2                            		even
008956C2                            		even
008956C2                            		include	"_maps\Drowning Countdown.asm"
008956C2                            ; ---------------------------------------------------------------------------
008956C2                            ; Sprite mappings - drowning countdown numbers (LZ)
008956C2                            ; ---------------------------------------------------------------------------
008956C2 0000                       Map_Drown:	dc.w @num-Map_Drown
008956C4 01                         @num:		dc.b 1
008956C5 E80E 0000 F2               		dc.b $E8, $E, 0, 0, $F2
008956CA                            		even
008956CA                            		even
008956CA                            
008956CA                            		include	"_incObj\38 Shield and Invincibility.asm"
008956CA                            ; ---------------------------------------------------------------------------
008956CA                            ; Object 38 - shield and invincibility stars
008956CA                            ; ---------------------------------------------------------------------------
008956CA                            
008956CA                            ShieldItem:				; XREF: Obj_Index
008956CA 7000                       		moveq	#0,d0
008956CC 1028 0024                  		move.b	obRoutine(a0),d0
008956D0 323B 0000                  		move.w	Shi_Index(pc,d0.w),d1
008956D4 4EFB 1000                  		jmp	Shi_Index(pc,d1.w)
008956D8                            ; ===========================================================================
008956D8 0000                       Shi_Index:	dc.w Shi_Main-Shi_Index
008956DA 0000                       		dc.w Shi_Shield-Shi_Index
008956DC 0000                       		dc.w Shi_Stars-Shi_Index
008956DE                            ; ===========================================================================
008956DE                            
008956DE                            Shi_Main:	; Routine 0
008956DE 5428 0024                  		addq.b	#2,obRoutine(a0)
008956E2 217C 0000 0000 0004        		move.l	#Map_Shield,obMap(a0)
008956EA 117C 0004 0001             		move.b	#4,obRender(a0)
008956F0 117C 0001 0018             		move.b	#1,obPriority(a0)
008956F6 117C 0010 0019             		move.b	#$10,obActWid(a0)
008956FC 4A28 001C                  		tst.b	obAnim(a0)	; is object a shield?
00895700 6600                       		bne.s	@stars		; if not, branch
00895702 317C 0541 0002             		move.w	#$541,obGfx(a0)	; shield specific code
00895708 4E75                       		rts	
0089570A                            ; ===========================================================================
0089570A                            
0089570A                            @stars:
0089570A 5428 0024                  		addq.b	#2,obRoutine(a0) ; goto Shi_Stars next
0089570E 317C 055C 0002             		move.w	#$55C,obGfx(a0)
00895714 4E75                       		rts	
00895716                            ; ===========================================================================
00895716                            
00895716                            Shi_Shield:	; Routine 2
00895716 4A38 FE2D                  		tst.b	(v_invinc).w	; does Sonic have invincibility?
0089571A 6600                       		bne.s	@remove		; if yes, branch
0089571C 4A38 FE2C                  		tst.b	(v_shield).w	; does Sonic have shield?
00895720 6700                       		beq.s	@delete		; if not, branch
00895722 3178 D008 0008             		move.w	(v_player+obX).w,obX(a0)
00895728 3178 D00C 000C             		move.w	(v_player+obY).w,obY(a0)
0089572E 1178 D022 0022             		move.b	(v_player+obStatus).w,obStatus(a0)
00895734                            	
00895734                            	;Mercury Shield/Invincibility Positioning Fix
00895734 1028 0022                  		move.b	obStatus(a0),d0
00895738 323C 000A                  		move.w	#$A,d1
0089573C                            		
0089573C 0C38 0023 D01C             		cmpi.b	#id_BalanceForward,(v_player+obAnim).w
00895742 6700                       		beq.s	@shift
00895744 0C38 0024 D01C             		cmpi.b	#id_BalanceBack,(v_player+obAnim).w
0089574A 6600                       		bne.s	@noshift
0089574C 0840 0000                  		bchg	#staFacing,d0	;Mercury Constants
00895750 323C 0004                  		move.w	#4,d1
00895754                            		
00895754                            	@shift:
00895754 9368 0008                  		sub.w	d1,obX(a0)
00895758 0800 0000                  		btst	#staFacing,d0	;Mercury Constants
0089575C 6700                       		beq.s	@noshift
0089575E D241                       		add.w	d1,d1
00895760 D368 0008                  		add.w	d1,obX(a0)
00895764                            	@noshift:
00895764                            	;end Shield/Invincibility Positioning Fix
00895764                            		
00895764 43F9 0000 0000             		lea	(Ani_Shield).l,a1
0089576A 4EB9 0088 B4B0             		jsr	AnimateSprite
00895770 4EF9 0088 E3CC             		jmp	DisplaySprite
00895776                            
00895776                            	@remove:
00895776 4E75                       		rts	
00895778                            
00895778                            	@delete:
00895778 4EF9 0088 E408             		jmp	DeleteObject
0089577E                            ; ===========================================================================
0089577E                            
0089577E                            Shi_Stars:	; Routine 4
0089577E 4A38 FE2D                  		tst.b	(v_invinc).w	; does Sonic have invincibility?
00895782 6700 0000                  		beq.w	Shi_Start_Delete		; if not, branch
00895786 3038 F7A8                  		move.w	(v_trackpos).w,d0 ; get index value for tracking data
0089578A 1228 001C                  		move.b	obAnim(a0),d1
0089578E 5301                       		subq.b	#1,d1
00895790 6000                       		bra.s	@trail
00895792                            ; ===========================================================================
00895792 E909                       		lsl.b	#4,d1
00895794 5801                       		addq.b	#4,d1
00895796 9001                       		sub.b	d1,d0
00895798 1228 0030                  		move.b	$30(a0),d1
0089579C 9001                       		sub.b	d1,d0
0089579E 5801                       		addq.b	#4,d1
008957A0 0201 000F                  		andi.b	#$F,d1
008957A4 1141 0030                  		move.b	d1,$30(a0)
008957A8 6000                       		bra.s	@b
008957AA                            ; ===========================================================================
008957AA                            
008957AA                            @trail:
008957AA E709                       		lsl.b	#3,d1		; multiply animation number by 8
008957AC 1401                       		move.b	d1,d2
008957AE D201                       		add.b	d1,d1
008957B0 D202                       		add.b	d2,d1		; multiply by 3
008957B2 5801                       		addq.b	#4,d1
008957B4 9001                       		sub.b	d1,d0
008957B6 1228 0030                  		move.b	$30(a0),d1
008957BA 9001                       		sub.b	d1,d0		; use earlier tracking data to create trail
008957BC 5801                       		addq.b	#4,d1
008957BE 0C01 0018                  		cmpi.b	#$18,d1
008957C2 6500                       		bcs.s	@a
008957C4 7200                       		moveq	#0,d1
008957C6                            
008957C6                            	@a:
008957C6 1141 0030                  		move.b	d1,$30(a0)
008957CA                            
008957CA                            	@b:
008957CA 43F8 CB00                  		lea	(v_tracksonic).w,a1
008957CE 43F1 0000                  		lea	(a1,d0.w),a1
008957D2 3159 0008                  		move.w	(a1)+,obX(a0)
008957D6 3159 000C                  		move.w	(a1)+,obY(a0)
008957DA 1178 D022 0022             		move.b	(v_player+obStatus).w,obStatus(a0)
008957E0                            		
008957E0                            	;Mercury Shield/Invincibility Positioning Fix
008957E0 1028 0022                  		move.b	obStatus(a0),d0
008957E4 323C 000A                  		move.w	#$A,d1
008957E8                            		
008957E8 0C38 0023 D01C             		cmpi.b	#id_BalanceForward,(v_player+obAnim).w
008957EE 6700                       		beq.s	@shift
008957F0 0C38 0024 D01C             		cmpi.b	#id_BalanceBack,(v_player+obAnim).w
008957F6 6600                       		bne.s	@noshift
008957F8 0840 0000                  		bchg	#staFacing,d0	;Mercury Constants
008957FC 323C 0004                  		move.w	#4,d1
00895800                            		
00895800                            	@shift:
00895800 9368 0008                  		sub.w	d1,obX(a0)
00895804 0800 0000                  		btst	#staFacing,d0	;Mercury Constants
00895808 6700                       		beq.s	@noshift
0089580A D241                       		add.w	d1,d1
0089580C D368 0008                  		add.w	d1,obX(a0)
00895810                            	@noshift:
00895810                            	;end Shield/Invincibility Positioning Fix
00895810                            		
00895810 43F9 0000 0000             		lea	(Ani_Shield).l,a1
00895816 4EB9 0088 B4B0             		jsr	AnimateSprite
0089581C 4EF9 0088 E3CC             		jmp	DisplaySprite
00895822                            ; ===========================================================================
00895822                            
00895822                            Shi_Start_Delete:	
00895822 4EF9 0088 E408             		jmp	DeleteObject
00895822 4EF9 0088 E408             		jmp	DeleteObject
00895828                            		include	"_incObj\4A Special Stage Entry (Unused).asm"
00895828                            ; ---------------------------------------------------------------------------
00895828                            ; Object 4A - special stage entry from beta
00895828                            ; ---------------------------------------------------------------------------
00895828                            
00895828                            VanishSonic:				; XREF: Obj_Index
00895828 7000                       		moveq	#0,d0
0089582A 1028 0024                  		move.b	obRoutine(a0),d0
0089582E 323B 0000                  		move.w	Van_Index(pc,d0.w),d1
00895832 4EFB 1000                  		jmp	Van_Index(pc,d1.w)
00895836                            ; ===========================================================================
00895836 0000                       Van_Index:	dc.w Van_Main-Van_Index
00895838 0000                       		dc.w Van_RmvSonic-Van_Index
0089583A 0000                       		dc.w Van_LoadSonic-Van_Index
0089583C                            
0089583C =00000030                  van_time:	= $30		; time for Sonic to disappear
0089583C                            ; ===========================================================================
0089583C                            
0089583C                            Van_Main:	; Routine 0
0089583C 4AB8 F680                  		tst.l	(v_plc_buffer).w ; are pattern load cues empty?
00895840 6700                       		beq.s	@isempty	; if yes, branch
00895842 4E75                       		rts	
00895844                            
00895844                            	@isempty:
00895844 5428 0024                  		addq.b	#2,obRoutine(a0)
00895848 217C 0000 0000 0004        		move.l	#Map_Vanish,obMap(a0)
00895850 117C 0004 0001             		move.b	#4,obRender(a0)
00895856 117C 0001 0018             		move.b	#1,obPriority(a0)
0089585C 117C 0038 0019             		move.b	#$38,obActWid(a0)
00895862 317C 0541 0002             		move.w	#$541,obGfx(a0)
00895868 317C 0078 0030             		move.w	#120,van_time(a0) ; set time for Sonic's disappearance to 2 seconds
0089586E                            
0089586E                            Van_RmvSonic:	; Routine 2
0089586E 3178 D008 0008             		move.w	(v_player+obX).w,obX(a0)
00895874 3178 D00C 000C             		move.w	(v_player+obY).w,obY(a0)
0089587A 1178 D022 0022             		move.b	(v_player+obStatus).w,obStatus(a0)
00895880 43F9 0000 0000             		lea	(Ani_Vanish).l,a1
00895886 4EB9 0088 B4B0             		jsr	AnimateSprite
0089588C 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
00895892 6600                       		bne.s	@display
00895894 4A38 D000                  		tst.b	(v_player).w
00895898 6700                       		beq.s	@display
0089589A 11FC 0000 D000             		move.b	#0,(v_player).w	; remove Sonic
008958AA                            
008958AA                            	@display:
008958AA 4EF9 0088 E3CC             		jmp	DisplaySprite
008958B0                            ; ===========================================================================
008958B0                            
008958B0                            Van_LoadSonic:	; Routine 4
008958B0 5368 0030                  		subq.w	#1,van_time(a0)	; subtract 1 from time
008958B4 6600                       		bne.s	@wait		; if time remains, branch
008958B6 11FC 0001 D000             		move.b	#id_SonicPlayer,(v_player).w ; load Sonic object
008958BC 4EF9 0088 E408             		jmp	DeleteObject
008958C2                            
008958C2                            	@wait:
008958C2 4E75                       		rts	
008958C2 4E75                       		rts	
008958C4                            		include	"_incObj\08 Water Splash.asm"
008958C4                            ; ---------------------------------------------------------------------------
008958C4                            ; Object 08 - water splash (LZ)
008958C4                            ; ---------------------------------------------------------------------------
008958C4                            
008958C4                            Splash:					; XREF: Obj_Index
008958C4 7000                       		moveq	#0,d0
008958C6 1028 0024                  		move.b	obRoutine(a0),d0
008958CA 323B 0000                  		move.w	Spla_Index(pc,d0.w),d1
008958CE 4EFB 1000                  		jmp	Spla_Index(pc,d1.w)
008958D2                            ; ===========================================================================
008958D2 0000                       Spla_Index:	dc.w Spla_Main-Spla_Index
008958D4 0000                       		dc.w Spla_Display-Spla_Index
008958D6 0000                       		dc.w Spla_Delete-Spla_Index
008958D8                            ; ===========================================================================
008958D8                            
008958D8                            Spla_Main:	; Routine 0
008958D8 5428 0024                  		addq.b	#2,obRoutine(a0)
008958DC 217C 0000 0000 0004        		move.l	#Map_Splash,obMap(a0)
008958E4 0028 0004 0001             		ori.b	#4,obRender(a0)
008958EA 117C 0001 0018             		move.b	#1,obPriority(a0)
008958F0 117C 0010 0019             		move.b	#$10,obActWid(a0)
008958F6 317C 4259 0002             		move.w	#$4259,obGfx(a0)
008958FC 3178 D008 0008             		move.w	(v_player+obX).w,obX(a0) ; copy x-position from Sonic
00895902                            
00895902                            Spla_Display:	; Routine 2
00895902 3178 F646 000C             		move.w	(v_waterpos1).w,obY(a0) ; copy y-position from water height
00895908 43F9 0000 0000             		lea	(Ani_Splash).l,a1
0089590E 4EB9 0088 B4B0             		jsr	AnimateSprite
00895914 4EF9 0088 E3CC             		jmp	DisplaySprite
0089591A                            ; ===========================================================================
0089591A                            
0089591A                            Spla_Delete:	; Routine 4
0089591A 4EF9 0088 E408             		jmp	DeleteObject	; delete when animation	is complete
0089591A 4EF9 0088 E408             		jmp	DeleteObject	; delete when animation	is complete
00895920                            		include	"_anim\Shield and Invincibility.asm"
00895920                            ; ---------------------------------------------------------------------------
00895920                            ; Animation script - shield and invincibility stars
00895920                            ; ---------------------------------------------------------------------------
00895920 0000                       Ani_Shield:	dc.w @shield-Ani_Shield
00895922 0000                       		dc.w @stars1-Ani_Shield
00895924 0000                       		dc.w @stars2-Ani_Shield
00895926 0000                       		dc.w @stars3-Ani_Shield
00895928 0000                       		dc.w @stars4-Ani_Shield
0089592A                            		
0089592A 0101 0002 0003 00FF        @shield:	dc.b 1,	1, 0, 2, 0, 3, 0, afEnd
00895932                            
00895932 0504 0506 07FF             @stars1:	dc.b 5,	4, 5, 6, 7, afEnd
00895938 0004 0400 0404 0005 0500+  @stars2:	dc.b 0,	4, 4, 0, 4, 4, 0, 5, 5,	0, 5, 5, 0, 6, 6, 0, 6
00895949 0600 0707 0007 0700 FF     		dc.b 6,	0, 7, 7, 0, 7, 7, 0, afEnd
00895952 0004 0400 0400 0005 0500+  @stars3:	dc.b 0,	4, 4, 0, 4, 0, 0, 5, 5,	0, 5, 0, 0, 6, 6, 0, 6
00895963 0000 0707 0007 0000 FF     		dc.b 0,	0, 7, 7, 0, 7, 0, 0, afEnd
0089596C 0004 0000 0400 0005 0000+  @stars4:	dc.b 0,	4, 0, 0, 4, 0, 0, 5, 0,	0, 5, 0, 0, 6, 0, 0, 6
0089597D 0000 0700 0007 0000 FF     		dc.b 0,	0, 7, 0, 0, 7, 0, 0, afEnd
00895986                            		even
00895986                            		even
00895986                            		include	"_maps\Shield and Invincibility.asm"
00895986                            ; ---------------------------------------------------------------------------
00895986                            ; Sprite mappings - shield and invincibility stars
00895986                            ; ---------------------------------------------------------------------------
00895986 0000 0000                  Map_Shield:	dc.w @shield1-Map_Shield, @shield2-Map_Shield
0089598A 0000 0000                  		dc.w @shield3-Map_Shield, @shield4-Map_Shield
0089598E 0000 0000                  		dc.w @stars1-Map_Shield, @stars2-Map_Shield
00895992 0000 0000                  		dc.w @stars3-Map_Shield, @stars4-Map_Shield
00895996                            		
00895996 04                         @shield2:	dc.b 4
00895997 E90A 0000 E8               		dc.b $E9, $A, 0, 0, $E8
0089599C E90A 0009 00               		dc.b $E9, $A, 0, 9, 0
008959A1 000A 1000 E8               @shield1:	dc.b 0,	$A, $10, 0, $E8
008959A6 000A 1009 00               		dc.b 0,	$A, $10, 9, 0
008959AB 04                         @shield3:	dc.b 4
008959AC E90A 0812 E9               		dc.b $E9, $A, 8, $12, $E9
008959B1 E90A 0012 00               		dc.b $E9, $A, 0, $12, 0
008959B6 000A 1812 E9               		dc.b 0,	$A, $18, $12, $E9
008959BB 000A 1012 00               		dc.b 0,	$A, $10, $12, 0
008959C0 04                         @shield4:	dc.b 4
008959C1 E90A 0809 E8               		dc.b $E9, $A, 8, 9, $E8
008959C6 E90A 0800 00               		dc.b $E9, $A, 8, 0, 0
008959CB 000A 1809 E8               		dc.b 0,	$A, $18, 9, $E8
008959D0 000A 1800 00               		dc.b 0,	$A, $18, 0, 0
008959D5                            		
008959D5 04                         @stars1:	dc.b 4
008959D6 E80A 0000 E8               		dc.b $E8, $A, 0, 0, $E8
008959DB E80A 0009 00               		dc.b $E8, $A, 0, 9, 0
008959E0 000A 1809 E8               		dc.b 0,	$A, $18, 9, $E8
008959E5 000A 1800 00               		dc.b 0,	$A, $18, 0, 0
008959EA 04                         @stars2:	dc.b 4
008959EB E80A 0809 E8               		dc.b $E8, $A, 8, 9, $E8
008959F0 E80A 0800 00               		dc.b $E8, $A, 8, 0, 0
008959F5 000A 1000 E8               		dc.b 0,	$A, $10, 0, $E8
008959FA 000A 1009 00               		dc.b 0,	$A, $10, 9, 0
008959FF 04                         @stars3:	dc.b 4
00895A00 E80A 0012 E8               		dc.b $E8, $A, 0, $12, $E8
00895A05 E80A 001B 00               		dc.b $E8, $A, 0, $1B, 0
00895A0A 000A 181B E8               		dc.b 0,	$A, $18, $1B, $E8
00895A0F 000A 1812 00               		dc.b 0,	$A, $18, $12, 0
00895A14 04                         @stars4:	dc.b 4
00895A15 E80A 081B E8               		dc.b $E8, $A, 8, $1B, $E8
00895A1A E80A 0812 00               		dc.b $E8, $A, 8, $12, 0
00895A1F 000A 1012 E8               		dc.b 0,	$A, $10, $12, $E8
00895A24 000A 101B 00               		dc.b 0,	$A, $10, $1B, 0
00895A2A 00                         		even
00895A2A 00                         		even
00895A2A                            		include	"_anim\Special Stage Entry (Unused).asm"
00895A2A                            ; ---------------------------------------------------------------------------
00895A2A                            ; Animation script - special stage entry effect from beta
00895A2A                            ; ---------------------------------------------------------------------------
00895A2A 0000                       Ani_Vanish:	dc.w @vanish-Ani_Vanish
00895A2C 0500 0100 0100 0701 0702+  @vanish:	dc.b 5,	0, 1, 0, 1, 0, 7, 1, 7,	2, 7, 3, 7, 4, 7, 5, 7, 6, 7, afRoutine
00895A40                            		even
00895A40                            		even
00895A40                            		include	"_maps\Special Stage Entry (Unused).asm"
00895A40                            ; ---------------------------------------------------------------------------
00895A40                            ; Sprite mappings - special stage entry	from beta
00895A40                            ; ---------------------------------------------------------------------------
00895A40 0000 0000                  Map_Vanish:	dc.w @flash1-Map_Vanish, @flash2-Map_Vanish
00895A44 0000 0000                  		dc.w @flash3-Map_Vanish, @sparkle1-Map_Vanish
00895A48 0000 0000                  		dc.w @sparkle2-Map_Vanish, @sparkle3-Map_Vanish
00895A4C 0000 0000                  		dc.w @sparkle4-Map_Vanish, @blank-Map_Vanish
00895A50 03                         @flash1:	dc.b 3
00895A51 F800 0000 08               		dc.b $F8, 0, 0,	0, 8
00895A56 0004 0001 00               		dc.b 0,	4, 0, 1, 0
00895A5B 0800 1000 08               		dc.b 8,	0, $10,	0, 8
00895A60 03                         @flash2:	dc.b 3
00895A61 F00D 0003 F0               		dc.b $F0, $D, 0, 3, $F0
00895A66 000C 000B F0               		dc.b 0,	$C, 0, $B, $F0
00895A6B 080D 1003 F0               		dc.b 8,	$D, $10, 3, $F0
00895A70 05                         @flash3:	dc.b 5
00895A71 E40E 000F F4               		dc.b $E4, $E, 0, $F, $F4
00895A76 EC02 001B EC               		dc.b $EC, 2, 0,	$1B, $EC
00895A7B FC0C 001E F4               		dc.b $FC, $C, 0, $1E, $F4
00895A80 040E 100F F4               		dc.b 4,	$E, $10, $F, $F4
00895A85 0401 101B EC               		dc.b 4,	1, $10,	$1B, $EC
00895A8A 09                         @sparkle1:	dc.b 9
00895A8B F008 0022 F8               		dc.b $F0, 8, 0,	$22, $F8
00895A90 F80E 0025 F0               		dc.b $F8, $E, 0, $25, $F0
00895A95 1008 0031 F0               		dc.b $10, 8, 0,	$31, $F0
00895A9A 0005 0034 10               		dc.b 0,	5, 0, $34, $10
00895A9F F800 0825 10               		dc.b $F8, 0, 8,	$25, $10
00895AA4 F000 1836 18               		dc.b $F0, 0, $18, $36, $18
00895AA9 F800 1825 20               		dc.b $F8, 0, $18, $25, $20
00895AAE 0000 0825 28               		dc.b 0,	0, 8, $25, $28
00895AB3 F800 0025 30               		dc.b $F8, 0, 0,	$25, $30
00895AB8 12                         @sparkle2:	dc.b $12
00895AB9 0000 1825 F0               		dc.b 0,	0, $18,	$25, $F0
00895ABE F804 0038 F8               		dc.b $F8, 4, 0,	$38, $F8
00895AC3 F000 0026 08               		dc.b $F0, 0, 0,	$26, 8
00895AC8 0000 0025 00               		dc.b 0,	0, 0, $25, 0
00895ACD 0800 1825 F8               		dc.b 8,	0, $18,	$25, $F8
00895AD2 1000 1026 00               		dc.b $10, 0, $10, $26, 0
00895AD7 0800 1038 08               		dc.b 8,	0, $10,	$38, 8
00895ADC F800 0029 10               		dc.b $F8, 0, 0,	$29, $10
00895AE1 0000 0026 10               		dc.b 0,	0, 0, $26, $10
00895AE6 0000 002D 18               		dc.b 0,	0, 0, $2D, $18
00895AEB 0800 0826 18               		dc.b 8,	0, 8, $26, $18
00895AF0 0800 0029 20               		dc.b 8,	0, 0, $29, $20
00895AF5 F800 0026 20               		dc.b $F8, 0, 0,	$26, $20
00895AFA F800 002D 28               		dc.b $F8, 0, 0,	$2D, $28
00895AFF 0000 003A 28               		dc.b 0,	0, 0, $3A, $28
00895B04 F800 1826 30               		dc.b $F8, 0, $18, $26, $30
00895B09 0000 1025 38               		dc.b 0,	0, $10,	$25, $38
00895B0E F800 1025 40               		dc.b $F8, 0, $10, $25, $40
00895B13 11                         @sparkle3:	dc.b $11
00895B14 F800 0825 00               		dc.b $F8, 0, 8,	$25, 0
00895B19 F000 0038 10               		dc.b $F0, 0, 0,	$38, $10
00895B1E 1000 0825 00               		dc.b $10, 0, 8,	$25, 0
00895B23 0000 1825 10               		dc.b 0,	0, $18,	$25, $10
00895B28 0800 1025 18               		dc.b 8,	0, $10,	$25, $18
00895B2D F800 1825 20               		dc.b $F8, 0, $18, $25, $20
00895B32 0000 1026 28               		dc.b 0,	0, $10,	$26, $28
00895B37 F800 1025 30               		dc.b $F8, 0, $10, $25, $30
00895B3C 0000 0025 30               		dc.b 0,	0, 0, $25, $30
00895B41 0800 0825 30               		dc.b 8,	0, 8, $25, $30
00895B46 0000 0826 38               		dc.b 0,	0, 8, $26, $38
00895B4B 0800 0029 38               		dc.b 8,	0, 0, $29, $38
00895B50 F800 0826 40               		dc.b $F8, 0, 8,	$26, $40
00895B55 0000 002D 40               		dc.b 0,	0, 0, $2D, $40
00895B5A F800 0825 48               		dc.b $F8, 0, 8,	$25, $48
00895B5F 0000 0025 48               		dc.b 0,	0, 0, $25, $48
00895B64 0000 1025 50               		dc.b 0,	0, $10,	$25, $50
00895B69 09                         @sparkle4:	dc.b 9
00895B6A FC00 0826 30               		dc.b $FC, 0, 8,	$26, $30
00895B6F 0400 0825 28               		dc.b 4,	0, 8, $25, $28
00895B74 0400 1027 38               		dc.b 4,	0, $10,	$27, $38
00895B79 0400 0826 40               		dc.b 4,	0, 8, $26, $40
00895B7E FC00 1025 40               		dc.b $FC, 0, $10, $25, $40
00895B83 FC00 1026 48               		dc.b $FC, 0, $10, $26, $48
00895B88 0C00 0827 48               		dc.b $C, 0, 8, $27, $48
00895B8D 0400 1826 50               		dc.b 4,	0, $18,	$26, $50
00895B92 04                         		dc.b 4
00895B93 0008 2758 00               @blank:		dc.b 0,	8, $27,	$58, 0
00895B98                            		even
00895B98                            		even
00895B98                            		include	"_anim\Water Splash.asm"
00895B98                            ; ---------------------------------------------------------------------------
00895B98                            ; Animation script - water splash (LZ)
00895B98                            ; ---------------------------------------------------------------------------
00895B98 0000                       Ani_Splash:	dc.w @splash-Ani_Splash
00895B9A 0400 0102 FC               @splash:	dc.b 4,	0, 1, 2, afRoutine
00895BA0 00                         		even
00895BA0 00                         		even
00895BA0                            		include	"_maps\Water Splash.asm"
00895BA0                            ; ---------------------------------------------------------------------------
00895BA0                            ; Sprite mappings - water splash (LZ)
00895BA0                            ; ---------------------------------------------------------------------------
00895BA0 0000                       Map_Splash:	dc.w @splash1-Map_Splash
00895BA2 0000                       		dc.w @splash2-Map_Splash
00895BA4 0000                       		dc.w @splash3-Map_Splash
00895BA6 02                         @splash1:	dc.b 2
00895BA7 F204 006D F8               		dc.b $F2, 4, 0,	$6D, $F8
00895BAC FA0C 006F F0               		dc.b $FA, $C, 0, $6F, $F0
00895BB1 02                         @splash2:	dc.b 2
00895BB2 E200 0073 F8               		dc.b $E2, 0, 0,	$73, $F8
00895BB7 EA0E 0074 F0               		dc.b $EA, $E, 0, $74, $F0
00895BBC 01                         @splash3:	dc.b 1
00895BBD E20F 0080 F0               		dc.b $E2, $F, 0, $80, $F0
00895BC2                            		even
00895BC2                            		even
00895BC2                            
00895BC2                            		include	"_incObj\Sonic AnglePos.asm"
00895BC2                            ; ---------------------------------------------------------------------------
00895BC2                            ; Subroutine to	change Sonic's angle & position as he walks along the floor
00895BC2                            ; ---------------------------------------------------------------------------
00895BC2                            
00895BC2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895BC2                            
00895BC2                            
00895BC2                            Sonic_AnglePos:				; XREF: Obj01_MdNormal; Obj01_MdRoll
00895BC2 0828 0003 0022             		btst	#3,obStatus(a0)
00895BC8 6700                       		beq.s	loc_14602
00895BCA 7000                       		moveq	#0,d0
00895BCC 11C0 F768                  		move.b	d0,($FFFFF768).w
00895BD0 11C0 F76A                  		move.b	d0,($FFFFF76A).w
00895BD4 4E75                       		rts	
00895BD6                            ; ===========================================================================
00895BD6                            
00895BD6                            loc_14602:
00895BD6 7003                       		moveq	#3,d0
00895BD8 11C0 F768                  		move.b	d0,($FFFFF768).w
00895BDC 11C0 F76A                  		move.b	d0,($FFFFF76A).w
00895BE0 1028 0026                  		move.b	obAngle(a0),d0
00895BE4 0600 0020                  		addi.b	#$20,d0
00895BE8 6A00                       		bpl.s	loc_14624
00895BEA 1028 0026                  		move.b	obAngle(a0),d0
00895BEE 6A00                       		bpl.s	loc_1461E
00895BF0 5300                       		subq.b	#1,d0
00895BF2                            
00895BF2                            loc_1461E:
00895BF2 0600 0020                  		addi.b	#$20,d0
00895BF6 6000                       		bra.s	loc_14630
00895BF8                            ; ===========================================================================
00895BF8                            
00895BF8                            loc_14624:
00895BF8 1028 0026                  		move.b	obAngle(a0),d0
00895BFC 6A00                       		bpl.s	loc_1462C
00895BFE 5200                       		addq.b	#1,d0
00895C00                            
00895C00                            loc_1462C:
00895C00 0600 001F                  		addi.b	#$1F,d0
00895C04                            
00895C04                            loc_14630:
00895C04 0200 00C0                  		andi.b	#$C0,d0
00895C08 0C00 0040                  		cmpi.b	#$40,d0
00895C0C 6700 0000                  		beq.w	Sonic_WalkVertL
00895C10 0C00 0080                  		cmpi.b	#$80,d0
00895C14 6700 0000                  		beq.w	Sonic_WalkCeiling
00895C18 0C00 00C0                  		cmpi.b	#$C0,d0
00895C1C 6700 0000                  		beq.w	Sonic_WalkVertR
00895C20 3428 000C                  		move.w	obY(a0),d2
00895C24 3628 0008                  		move.w	obX(a0),d3
00895C28 7000                       		moveq	#0,d0
00895C2A 1028 0016                  		move.b	obHeight(a0),d0
00895C2E 4880                       		ext.w	d0
00895C30 D440                       		add.w	d0,d2
00895C32 1028 0017                  		move.b	obWidth(a0),d0
00895C36 4880                       		ext.w	d0
00895C38 D640                       		add.w	d0,d3
00895C3A 49F8 F768                  		lea	($FFFFF768).w,a4
00895C3E 367C 0010                  		movea.w	#$10,a3
00895C42 3C3C 0000                  		move.w	#0,d6
00895C46 7A0D                       		moveq	#$D,d5
00895C48 6100 0000                  		bsr.w	FindFloor
00895C4C 3F01                       		move.w	d1,-(sp)
00895C4E 3428 000C                  		move.w	obY(a0),d2
00895C52 3628 0008                  		move.w	obX(a0),d3
00895C56 7000                       		moveq	#0,d0
00895C58 1028 0016                  		move.b	obHeight(a0),d0
00895C5C 4880                       		ext.w	d0
00895C5E D440                       		add.w	d0,d2
00895C60 1028 0017                  		move.b	obWidth(a0),d0
00895C64 4880                       		ext.w	d0
00895C66 4440                       		neg.w	d0
00895C68 D640                       		add.w	d0,d3
00895C6A 49F8 F76A                  		lea	($FFFFF76A).w,a4
00895C6E 367C 0010                  		movea.w	#$10,a3
00895C72 3C3C 0000                  		move.w	#0,d6
00895C76 7A0D                       		moveq	#$D,d5
00895C78 6100 0000                  		bsr.w	FindFloor
00895C7C 301F                       		move.w	(sp)+,d0
00895C7E 6100 0000                  		bsr.w	Sonic_Angle
00895C82 4A41                       		tst.w	d1
00895C84 6700                       		beq.s	locret_146BE
00895C86 6A00                       		bpl.s	loc_146C0
00895C88 0C41 FFF2                  		cmpi.w	#-$E,d1
00895C8C 6D00                       		blt.s	locret_146E6
00895C8E D368 000C                  		add.w	d1,obY(a0)
00895C92                            
00895C92                            locret_146BE:
00895C92 4E75                       		rts	
00895C94                            ; ===========================================================================
00895C94                            
00895C94                            loc_146C0:
00895C94                            
00895C94 1028 0010                  		move.b	obVelX(a0),d0
00895C98 6A00                       		bpl.s	@next1
00895C9A 4400                       		neg.b	d0
00895C9C                            	@next1:
00895C9C 5800                       		addq.b	#4,d0
00895C9E 0C00 000E                  		cmpi.b	#$E,d0
00895CA2 6500                       		bcs.s	@next2
00895CA4 103C 000E                  		move.b	#$E,d0
00895CA8                            	@next2:
00895CA8 B200                       		cmp.b	d0,d1
00895CAA                            	
00895CAA 6E00                       		bgt.s	loc_146CC
00895CAC                            
00895CAC                            loc_146C6:
00895CAC D368 000C                  		add.w	d1,obY(a0)
00895CB0 4E75                       		rts	
00895CB2                            ; ===========================================================================
00895CB2                            
00895CB2                            loc_146CC:
00895CB2 4A28 0038                  		tst.b	$38(a0)
00895CB6 66F4                       		bne.s	loc_146C6
00895CB8 08E8 0001 0022             		bset	#1,obStatus(a0)
00895CBE 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00895CC4 117C 0001 001D             		move.b	#1,obNextAni(a0)
00895CCA 4E75                       		rts	
00895CCC                            ; ===========================================================================
00895CCC                            
00895CCC                            locret_146E6:
00895CCC 4E75                       		rts	
00895CCE                            ; End of function Sonic_AnglePos
00895CCE                            
00895CCE                            ; ===========================================================================
00895CCE 2428 0008                  		move.l	obX(a0),d2
00895CD2 3028 0010                  		move.w	obVelX(a0),d0
00895CD6 48C0                       		ext.l	d0
00895CD8 E180                       		asl.l	#8,d0
00895CDA 9480                       		sub.l	d0,d2
00895CDC 2142 0008                  		move.l	d2,obX(a0)
00895CE0 303C 0038                  		move.w	#$38,d0
00895CE4 48C0                       		ext.l	d0
00895CE6 E180                       		asl.l	#8,d0
00895CE8 9680                       		sub.l	d0,d3
00895CEA 2143 000C                  		move.l	d3,obY(a0)
00895CEE 4E75                       		rts	
00895CF0                            ; ===========================================================================
00895CF0                            
00895CF0                            locret_1470A:
00895CF0 4E75                       		rts	
00895CF2                            ; ===========================================================================
00895CF2 2628 000C                  		move.l	obY(a0),d3
00895CF6 3028 0012                  		move.w	obVelY(a0),d0
00895CFA 0440 0038                  		subi.w	#$38,d0
00895CFE 3140 0012                  		move.w	d0,obVelY(a0)
00895D02 48C0                       		ext.l	d0
00895D04 E180                       		asl.l	#8,d0
00895D06 9680                       		sub.l	d0,d3
00895D08 2143 000C                  		move.l	d3,obY(a0)
00895D0C 4E75                       		rts	
00895D0E 4E75                       		rts	
00895D10                            ; ===========================================================================
00895D10 2428 0008                  		move.l	obX(a0),d2
00895D14 2628 000C                  		move.l	obY(a0),d3
00895D18 3028 0010                  		move.w	obVelX(a0),d0
00895D1C 48C0                       		ext.l	d0
00895D1E E180                       		asl.l	#8,d0
00895D20 9480                       		sub.l	d0,d2
00895D22 3028 0012                  		move.w	obVelY(a0),d0
00895D26 48C0                       		ext.l	d0
00895D28 E180                       		asl.l	#8,d0
00895D2A 9680                       		sub.l	d0,d3
00895D2C 2142 0008                  		move.l	d2,obX(a0)
00895D30 2143 000C                  		move.l	d3,obY(a0)
00895D34 4E75                       		rts	
00895D36                            
00895D36                            ; ---------------------------------------------------------------------------
00895D36                            ; Subroutine to	change Sonic's angle as he walks along the floor
00895D36                            ; ---------------------------------------------------------------------------
00895D36                            
00895D36                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895D36                            
00895D36                            
00895D36                            Sonic_Angle:				; XREF: Sonic_AnglePos; et al
00895D36 1438 F76A                  		move.b	($FFFFF76A).w,d2
00895D3A B240                       		cmp.w	d0,d1
00895D3C 6F00                       		ble.s	loc_1475E
00895D3E 1438 F768                  		move.b	($FFFFF768).w,d2
00895D42 3200                       		move.w	d0,d1
00895D44                            
00895D44                            loc_1475E:
00895D44 0802 0000                  		btst	#0,d2
00895D48 6600                       		bne.s	loc_1476A
00895D4A                            		
00895D4A 4A28 0038                  		tst.b	obOnWheel(a0)
00895D4E 6600                       		bne.s	@onwheel
00895D50 1002                       		move.b	d2,d0
00895D52 9028 0026                  		sub.b	obAngle(a0),d0
00895D56 6A00                       		bpl.s	@next
00895D58 4400                       		neg.b	d0
00895D5A                            	@next:
00895D5A 0C00 0020                  		cmpi.b	#$20,d0
00895D5E 6400                       		bcc.s	loc_1476A
00895D60                            	@onwheel:
00895D60                            	
00895D60 1142 0026                  		move.b	d2,obAngle(a0)
00895D64 4E75                       		rts	
00895D66                            ; ===========================================================================
00895D66                            
00895D66                            loc_1476A:
00895D66 1428 0026                  		move.b	obAngle(a0),d2
00895D6A 0602 0020                  		addi.b	#$20,d2
00895D6E 0202 00C0                  		andi.b	#$C0,d2
00895D72 1142 0026                  		move.b	d2,obAngle(a0)
00895D76 4E75                       		rts	
00895D78                            ; End of function Sonic_Angle
00895D78                            
00895D78                            ; ---------------------------------------------------------------------------
00895D78                            ; Subroutine allowing Sonic to walk up a vertical slope/wall to	his right
00895D78                            ; ---------------------------------------------------------------------------
00895D78                            
00895D78                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895D78                            
00895D78                            
00895D78                            Sonic_WalkVertR:			; XREF: Sonic_AnglePos
00895D78 3428 000C                  		move.w	obY(a0),d2
00895D7C 3628 0008                  		move.w	obX(a0),d3
00895D80 7000                       		moveq	#0,d0
00895D82 1028 0017                  		move.b	obWidth(a0),d0
00895D86 4880                       		ext.w	d0
00895D88 4440                       		neg.w	d0
00895D8A D440                       		add.w	d0,d2
00895D8C 1028 0016                  		move.b	obHeight(a0),d0
00895D90 4880                       		ext.w	d0
00895D92 D640                       		add.w	d0,d3
00895D94 49F8 F768                  		lea	($FFFFF768).w,a4
00895D98 367C 0010                  		movea.w	#$10,a3
00895D9C 3C3C 0000                  		move.w	#0,d6
00895DA0 7A0D                       		moveq	#$D,d5
00895DA2 6100 0000                  		bsr.w	FindWall
00895DA6 3F01                       		move.w	d1,-(sp)
00895DA8 3428 000C                  		move.w	obY(a0),d2
00895DAC 3628 0008                  		move.w	obX(a0),d3
00895DB0 7000                       		moveq	#0,d0
00895DB2 1028 0017                  		move.b	obWidth(a0),d0
00895DB6 4880                       		ext.w	d0
00895DB8 D440                       		add.w	d0,d2
00895DBA 1028 0016                  		move.b	obHeight(a0),d0
00895DBE 4880                       		ext.w	d0
00895DC0 D640                       		add.w	d0,d3
00895DC2 49F8 F76A                  		lea	($FFFFF76A).w,a4
00895DC6 367C 0010                  		movea.w	#$10,a3
00895DCA 3C3C 0000                  		move.w	#0,d6
00895DCE 7A0D                       		moveq	#$D,d5
00895DD0 6100 0000                  		bsr.w	FindWall
00895DD4 301F                       		move.w	(sp)+,d0
00895DD6 6100 FF5E                  		bsr.w	Sonic_Angle
00895DDA 4A41                       		tst.w	d1
00895DDC 6700                       		beq.s	locret_147F0
00895DDE 6A00                       		bpl.s	loc_147F2
00895DE0 0C41 FFF2                  		cmpi.w	#-$E,d1
00895DE4 6D00 FF0A                  		blt.w	locret_1470A
00895DE8 D368 0008                  		add.w	d1,obX(a0)
00895DEC                            
00895DEC                            locret_147F0:
00895DEC 4E75                       		rts	
00895DEE                            ; ===========================================================================
00895DEE                            
00895DEE                            loc_147F2:
00895DEE                            
00895DEE 1028 0012                  		move.b	obVelY(a0),d0
00895DF2 6A00                       		bpl.s	@next1
00895DF4 4400                       		neg.b	d0
00895DF6                            	@next1:
00895DF6 5800                       		addq.b	#4,d0
00895DF8 0C00 000E                  		cmpi.b	#$E,d0
00895DFC 6500                       		bcs.s	@next2
00895DFE 103C 000E                  		move.b	#$E,d0
00895E02                            	@next2:
00895E02 B200                       		cmp.b	d0,d1
00895E04                            	
00895E04 6E00                       		bgt.s	loc_147FE
00895E06                            
00895E06                            loc_147F8:
00895E06 D368 0008                  		add.w	d1,obX(a0)
00895E0A 4E75                       		rts	
00895E0C                            ; ===========================================================================
00895E0C                            
00895E0C                            loc_147FE:
00895E0C 4A28 0038                  		tst.b	$38(a0)
00895E10 66F4                       		bne.s	loc_147F8
00895E12 08E8 0001 0022             		bset	#1,obStatus(a0)
00895E18 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00895E1E 117C 0001 001D             		move.b	#1,obNextAni(a0)
00895E24 4E75                       		rts	
00895E26                            ; End of function Sonic_WalkVertR
00895E26                            
00895E26                            ; ---------------------------------------------------------------------------
00895E26                            ; Subroutine allowing Sonic to walk upside-down
00895E26                            ; ---------------------------------------------------------------------------
00895E26                            
00895E26                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895E26                            
00895E26                            
00895E26                            Sonic_WalkCeiling:			; XREF: Sonic_AnglePos
00895E26 3428 000C                  		move.w	obY(a0),d2
00895E2A 3628 0008                  		move.w	obX(a0),d3
00895E2E 7000                       		moveq	#0,d0
00895E30 1028 0016                  		move.b	obHeight(a0),d0
00895E34 4880                       		ext.w	d0
00895E36 9440                       		sub.w	d0,d2
00895E38 0A42 000F                  		eori.w	#$F,d2
00895E3C 1028 0017                  		move.b	obWidth(a0),d0
00895E40 4880                       		ext.w	d0
00895E42 D640                       		add.w	d0,d3
00895E44 49F8 F768                  		lea	($FFFFF768).w,a4
00895E48 367C FFF0                  		movea.w	#-$10,a3
00895E4C 3C3C 1000                  		move.w	#$1000,d6
00895E50 7A0D                       		moveq	#$D,d5
00895E52 6100 0000                  		bsr.w	FindFloor
00895E56 3F01                       		move.w	d1,-(sp)
00895E58 3428 000C                  		move.w	obY(a0),d2
00895E5C 3628 0008                  		move.w	obX(a0),d3
00895E60 7000                       		moveq	#0,d0
00895E62 1028 0016                  		move.b	obHeight(a0),d0
00895E66 4880                       		ext.w	d0
00895E68 9440                       		sub.w	d0,d2
00895E6A 0A42 000F                  		eori.w	#$F,d2
00895E6E 1028 0017                  		move.b	obWidth(a0),d0
00895E72 4880                       		ext.w	d0
00895E74 9640                       		sub.w	d0,d3
00895E76 49F8 F76A                  		lea	($FFFFF76A).w,a4
00895E7A 367C FFF0                  		movea.w	#-$10,a3
00895E7E 3C3C 1000                  		move.w	#$1000,d6
00895E82 7A0D                       		moveq	#$D,d5
00895E84 6100 0000                  		bsr.w	FindFloor
00895E88 301F                       		move.w	(sp)+,d0
00895E8A 6100 FEAA                  		bsr.w	Sonic_Angle
00895E8E 4A41                       		tst.w	d1
00895E90 6700                       		beq.s	locret_14892
00895E92 6A00                       		bpl.s	loc_14894
00895E94 0C41 FFF2                  		cmpi.w	#-$E,d1
00895E98 6D00 FE32                  		blt.w	locret_146E6
00895E9C 9368 000C                  		sub.w	d1,obY(a0)
00895EA0                            
00895EA0                            locret_14892:
00895EA0 4E75                       		rts	
00895EA2                            ; ===========================================================================
00895EA2                            
00895EA2                            loc_14894:
00895EA2                            
00895EA2 1028 0010                  		move.b	obVelX(a0),d0
00895EA6 6A00                       		bpl.s	@next1
00895EA8 4400                       		neg.b	d0
00895EAA                            	@next1:	
00895EAA 5800                       		addq.b	#4,d0
00895EAC 0C00 000E                  		cmpi.b	#$E,d0
00895EB0 6500                       		bcs.s	@next2
00895EB2 103C 000E                  		move.b	#$E,d0
00895EB6                            	@next2:
00895EB6 B200                       		cmp.b	d0,d1
00895EB8                            	
00895EB8 6E00                       		bgt.s	loc_148A0
00895EBA                            
00895EBA                            loc_1489A:
00895EBA 9368 000C                  		sub.w	d1,obY(a0)
00895EBE 4E75                       		rts	
00895EC0                            ; ===========================================================================
00895EC0                            
00895EC0                            loc_148A0:
00895EC0 4A28 0038                  		tst.b	$38(a0)
00895EC4 66F4                       		bne.s	loc_1489A
00895EC6 08E8 0001 0022             		bset	#1,obStatus(a0)
00895ECC 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00895ED2 117C 0001 001D             		move.b	#1,obNextAni(a0)
00895ED8 4E75                       		rts	
00895EDA                            ; End of function Sonic_WalkCeiling
00895EDA                            
00895EDA                            ; ---------------------------------------------------------------------------
00895EDA                            ; Subroutine allowing Sonic to walk up a vertical slope/wall to	his left
00895EDA                            ; ---------------------------------------------------------------------------
00895EDA                            
00895EDA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895EDA                            
00895EDA                            
00895EDA                            Sonic_WalkVertL:			; XREF: Sonic_AnglePos
00895EDA 3428 000C                  		move.w	obY(a0),d2
00895EDE 3628 0008                  		move.w	obX(a0),d3
00895EE2 7000                       		moveq	#0,d0
00895EE4 1028 0017                  		move.b	obWidth(a0),d0
00895EE8 4880                       		ext.w	d0
00895EEA 9440                       		sub.w	d0,d2
00895EEC 1028 0016                  		move.b	obHeight(a0),d0
00895EF0 4880                       		ext.w	d0
00895EF2 9640                       		sub.w	d0,d3
00895EF4 0A43 000F                  		eori.w	#$F,d3
00895EF8 49F8 F768                  		lea	($FFFFF768).w,a4
00895EFC 367C FFF0                  		movea.w	#-$10,a3
00895F00 3C3C 0800                  		move.w	#$800,d6
00895F04 7A0D                       		moveq	#$D,d5
00895F06 6100 0000                  		bsr.w	FindWall
00895F0A 3F01                       		move.w	d1,-(sp)
00895F0C 3428 000C                  		move.w	obY(a0),d2
00895F10 3628 0008                  		move.w	obX(a0),d3
00895F14 7000                       		moveq	#0,d0
00895F16 1028 0017                  		move.b	obWidth(a0),d0
00895F1A 4880                       		ext.w	d0
00895F1C D440                       		add.w	d0,d2
00895F1E 1028 0016                  		move.b	obHeight(a0),d0
00895F22 4880                       		ext.w	d0
00895F24 9640                       		sub.w	d0,d3
00895F26 0A43 000F                  		eori.w	#$F,d3
00895F2A 49F8 F76A                  		lea	($FFFFF76A).w,a4
00895F2E 367C FFF0                  		movea.w	#-$10,a3
00895F32 3C3C 0800                  		move.w	#$800,d6
00895F36 7A0D                       		moveq	#$D,d5
00895F38 6100 0000                  		bsr.w	FindWall
00895F3C 301F                       		move.w	(sp)+,d0
00895F3E 6100 FDF6                  		bsr.w	Sonic_Angle
00895F42 4A41                       		tst.w	d1
00895F44 6700                       		beq.s	locret_14934
00895F46 6A00                       		bpl.s	loc_14936
00895F48 0C41 FFF2                  		cmpi.w	#-$E,d1
00895F4C 6D00 FDA2                  		blt.w	locret_1470A
00895F50 9368 0008                  		sub.w	d1,obX(a0)
00895F54                            
00895F54                            locret_14934:
00895F54 4E75                       		rts	
00895F56                            ; ===========================================================================
00895F56                            
00895F56                            loc_14936:
00895F56                            
00895F56 1028 0012                  		move.b	obVelY(a0),d0
00895F5A 6A00                       		bpl.s	@next1
00895F5C 4400                       		neg.b	d0
00895F5E                            	@next1:
00895F5E 5800                       		addq.b	#4,d0
00895F60 0C00 000E                  		cmpi.b	#$E,d0
00895F64 6500                       		bcs.s	@next2
00895F66 103C 000E                  		move.b	#$E,d0
00895F6A                            	@next2:
00895F6A B200                       		cmp.b	d0,d1
00895F6C                            	
00895F6C 6E00                       		bgt.s	loc_14942
00895F6E                            
00895F6E                            loc_1493C:
00895F6E 9368 0008                  		sub.w	d1,obX(a0)
00895F72 4E75                       		rts	
00895F74                            ; ===========================================================================
00895F74                            
00895F74                            loc_14942:
00895F74 4A28 0038                  		tst.b	$38(a0)
00895F78 66F4                       		bne.s	loc_1493C
00895F7A 08E8 0001 0022             		bset	#1,obStatus(a0)
00895F80 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00895F86 117C 0001 001D             		move.b	#1,obNextAni(a0)
00895F8C 4E75                       		rts	
00895F8E                            ; End of function Sonic_WalkVertL
00895F8E                            ; End of function Sonic_WalkVertL
00895F8E                            
00895F8E                            		include	"_incObj\sub FindNearestTile.asm"
00895F8E                            ; ---------------------------------------------------------------------------
00895F8E                            ; Subroutine to	find which tile	the object is standing on
00895F8E                            
00895F8E                            ; input:
00895F8E                            ;	d2 = y-position of object's bottom edge
00895F8E                            ;	d3 = x-position of object
00895F8E                            
00895F8E                            ; output:
00895F8E                            ;	a1 = address within 256x256 mappings where object is standing
00895F8E                            ;	     (refers to a 16x16 tile number)
00895F8E                            ; ---------------------------------------------------------------------------
00895F8E                            
00895F8E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00895F8E                            
00895F8E                            
00895F8E                            FindNearestTile:			; XREF: FindFloor; et al
00895F8E 3002                       		move.w	d2,d0		; get y-pos. of bottom edge of object
00895F90 E248                       		lsr.w	#1,d0
00895F92 0240 0380                  		andi.w	#$380,d0
00895F96 3203                       		move.w	d3,d1		; get x-pos. of object
00895F98 E049                       		lsr.w	#8,d1
00895F9A 0241 007F                  		andi.w	#$7F,d1
00895F9E D041                       		add.w	d1,d0		; combine
00895FA0                            
00895FA0                            
00895FA0 7200                       		moveq	#0,d1
00895FA2                            
00895FA2 43F8 A400                  		lea	(v_lvllayout).w,a1
00895FA6 1231 0000                  		move.b	(a1,d0.w),d1	; get 256x256 tile number
00895FAA 6700                       		beq.s	@blanktile	; branch if 0
00895FAC 6B00                       		bmi.s	@specialtile	; branch if >$7F
00895FAE 5301                       		subq.b	#1,d1
00895FB0 4881                       		ext.w	d1
00895FB2 EE59                       		ror.w	#7,d1
00895FB4 3002                       		move.w	d2,d0
00895FB6 D040                       		add.w	d0,d0
00895FB8 0240 01E0                  		andi.w	#$1E0,d0
00895FBC D240                       		add.w	d0,d1
00895FBE 3003                       		move.w	d3,d0
00895FC0 E648                       		lsr.w	#3,d0
00895FC2 0240 001E                  		andi.w	#$1E,d0
00895FC6 D240                       		add.w	d0,d1
00895FC8                            
00895FC8                            @blanktile:
00895FC8                            
00895FC8 D2B9 00FF 0000             		add.l	(v_256x256).l,d1
00895FCE                            
00895FCE 2241                       		movea.l	d1,a1
00895FD0 4E75                       		rts	
00895FD2                            ; ===========================================================================
00895FD2                            
00895FD2                            @specialtile:
00895FD2 0241 007F                  		andi.w	#$7F,d1
00895FD6 0828 0006 0001             		btst	#6,obRender(a0) ; is object "behind a loop"?
00895FDC 6700                       		beq.s	@treatasnormal	; if not, branch
00895FDE 5241                       		addq.w	#1,d1
00895FE0 0C41 0029                  		cmpi.w	#$29,d1
00895FE4 6600                       		bne.s	@treatasnormal
00895FE6 323C 0051                  		move.w	#$51,d1
00895FEA                            
00895FEA                            	@treatasnormal:
00895FEA 5301                       		subq.b	#1,d1
00895FEC EE59                       		ror.w	#7,d1
00895FEE 3002                       		move.w	d2,d0
00895FF0 D040                       		add.w	d0,d0
00895FF2 0240 01E0                  		andi.w	#$1E0,d0
00895FF6 D240                       		add.w	d0,d1
00895FF8 3003                       		move.w	d3,d0
00895FFA E648                       		lsr.w	#3,d0
00895FFC 0240 001E                  		andi.w	#$1E,d0
00896000 D240                       		add.w	d0,d1
00896002                            		
00896002 D2B9 00FF 0000             		add.l	(v_256x256).l,d1
00896008                            
00896008 2241                       		movea.l	d1,a1
0089600A 4E75                       		rts	
0089600C                            ; End of function FindNearestTile
0089600C                            ; End of function FindNearestTile
0089600C                            		include	"_incObj\sub FindFloor.asm"
0089600C                            ; ---------------------------------------------------------------------------
0089600C                            ; Subroutine to	find the floor
0089600C                            
0089600C                            ; input:
0089600C                            ;	d2 = y-position of object's bottom edge
0089600C                            ;	d3 = x-position of object
0089600C                            ;	d5 = bit to test for solidness
0089600C                            
0089600C                            ; output:
0089600C                            ;	d1 = distance to the floor
0089600C                            ;	a1 = address within 256x256 mappings where object is standing
0089600C                            ;	     (refers to a 16x16 tile number)
0089600C                            ;	(a4) = floor angle
0089600C                            ; ---------------------------------------------------------------------------
0089600C                            
0089600C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089600C                            
0089600C                            
0089600C                            FindFloor:				; XREF: Sonic_AnglePos; et al
0089600C 6180                       		bsr.s	FindNearestTile
0089600E 3011                       		move.w	(a1),d0		; get value for solidness, orientation and 16x16 tile number
00896010 3800                       		move.w	d0,d4
00896012 0240 07FF                  		andi.w	#$7FF,d0
00896016 6700                       		beq.s	@isblank	; branch if tile is blank
00896018 0B04                       		btst	d5,d4		; is the tile solid?
0089601A 6600                       		bne.s	@issolid	; if yes, branch
0089601C                            
0089601C                            @isblank:
0089601C D44B                       		add.w	a3,d2
0089601E 6100 0000                  		bsr.w	FindFloor2	; try tile below the nearest
00896022 944B                       		sub.w	a3,d2
00896024 0641 0010                  		addi.w	#$10,d1		; return distance to floor
00896028 4E75                       		rts	
0089602A                            ; ===========================================================================
0089602A                            
0089602A                            @issolid:
0089602A 2478 F796                  		movea.l	(v_collindex).w,a2
0089602E 1032 0000                  		move.b	(a2,d0.w),d0	; get collision block number
00896032 0240 00FF                  		andi.w	#$FF,d0
00896036 67E4                       		beq.s	@isblank	; branch if 0
00896038 45F9 0000 0000             		lea	(AngleMap).l,a2
0089603E 18B2 0000                  		move.b	(a2,d0.w),(a4)	; get collision angle value
00896042 E948                       		lsl.w	#4,d0
00896044 3203                       		move.w	d3,d1		; get x-pos. of object
00896046 0804 000B                  		btst	#$B,d4		; is block flipped horizontally?
0089604A 6700                       		beq.s	@noflip		; if not, branch
0089604C 4641                       		not.w	d1
0089604E 4414                       		neg.b	(a4)
00896050                            
00896050                            	@noflip:
00896050 0804 000C                  		btst	#$C,d4		; is block flipped vertically?
00896054 6700                       		beq.s	@noflip2	; if not, branch
00896056 0614 0040                  		addi.b	#$40,(a4)
0089605A 4414                       		neg.b	(a4)
0089605C 0414 0040                  		subi.b	#$40,(a4)
00896060                            
00896060                            	@noflip2:
00896060 0241 000F                  		andi.w	#$F,d1
00896064 D240                       		add.w	d0,d1		; (block num. * $10) + x-pos. = place in array
00896066 45F9 0000 0000             		lea	(CollArray1).l,a2
0089606C 1032 1000                  		move.b	(a2,d1.w),d0	; get collision height
00896070 4880                       		ext.w	d0
00896072 BD44                       		eor.w	d6,d4
00896074 0804 000C                  		btst	#$C,d4		; is block flipped vertically?
00896078 6700                       		beq.s	@noflip3	; if not, branch
0089607A 4440                       		neg.w	d0
0089607C                            
0089607C                            	@noflip3:
0089607C 4A40                       		tst.w	d0
0089607E 679C                       		beq.s	@isblank	; branch if height is 0
00896080 6B00                       		bmi.s	@negfloor	; branch if height is negative
00896082 0C00 0010                  		cmpi.b	#$10,d0
00896086 6700                       		beq.s	@maxfloor	; branch if height is $10 (max)
00896088 3202                       		move.w	d2,d1		; get y-pos. of object
0089608A 0241 000F                  		andi.w	#$F,d1
0089608E D041                       		add.w	d1,d0
00896090 323C 000F                  		move.w	#$F,d1
00896094 9240                       		sub.w	d0,d1		; return distance to floor
00896096 4E75                       		rts	
00896098                            ; ===========================================================================
00896098                            
00896098                            @negfloor:
00896098 3202                       		move.w	d2,d1
0089609A 0241 000F                  		andi.w	#$F,d1
0089609E D041                       		add.w	d1,d0
008960A0 6A00 FF7A                  		bpl.w	@isblank
008960A4                            
008960A4                            @maxfloor:
008960A4 944B                       		sub.w	a3,d2
008960A6 6100 0000                  		bsr.w	FindFloor2	; try tile above the nearest
008960AA D44B                       		add.w	a3,d2
008960AC 0441 0010                  		subi.w	#$10,d1		; return distance to floor
008960B0 4E75                       		rts	
008960B2                            ; End of function FindFloor
008960B2                            
008960B2                            
008960B2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008960B2                            
008960B2                            
008960B2                            FindFloor2:				; XREF: FindFloor
008960B2 6100 FEDA                  		bsr.w	FindNearestTile
008960B6 3011                       		move.w	(a1),d0
008960B8 3800                       		move.w	d0,d4
008960BA 0240 07FF                  		andi.w	#$7FF,d0
008960BE 6700                       		beq.s	@isblank2
008960C0 0B04                       		btst	d5,d4
008960C2 6600                       		bne.s	@issolid
008960C4                            
008960C4                            @isblank2:
008960C4 323C 000F                  		move.w	#$F,d1
008960C8 3002                       		move.w	d2,d0
008960CA 0240 000F                  		andi.w	#$F,d0
008960CE 9240                       		sub.w	d0,d1
008960D0 4E75                       		rts	
008960D2                            ; ===========================================================================
008960D2                            
008960D2                            @issolid:
008960D2 2478 F796                  		movea.l	(v_collindex).w,a2
008960D6 1032 0000                  		move.b	(a2,d0.w),d0
008960DA 0240 00FF                  		andi.w	#$FF,d0
008960DE 67E4                       		beq.s	@isblank2
008960E0 45F9 0000 0000             		lea	(AngleMap).l,a2
008960E6 18B2 0000                  		move.b	(a2,d0.w),(a4)
008960EA E948                       		lsl.w	#4,d0
008960EC 3203                       		move.w	d3,d1
008960EE 0804 000B                  		btst	#$B,d4
008960F2 6700                       		beq.s	@noflip
008960F4 4641                       		not.w	d1
008960F6 4414                       		neg.b	(a4)
008960F8                            
008960F8                            	@noflip:
008960F8 0804 000C                  		btst	#$C,d4
008960FC 6700                       		beq.s	@noflip2
008960FE 0614 0040                  		addi.b	#$40,(a4)
00896102 4414                       		neg.b	(a4)
00896104 0414 0040                  		subi.b	#$40,(a4)
00896108                            
00896108                            	@noflip2:
00896108 0241 000F                  		andi.w	#$F,d1
0089610C D240                       		add.w	d0,d1
0089610E 45F9 0000 0000             		lea	(CollArray1).l,a2
00896114 1032 1000                  		move.b	(a2,d1.w),d0
00896118 4880                       		ext.w	d0
0089611A BD44                       		eor.w	d6,d4
0089611C 0804 000C                  		btst	#$C,d4
00896120 6700                       		beq.s	@noflip3
00896122 4440                       		neg.w	d0
00896124                            
00896124                            	@noflip3:
00896124 4A40                       		tst.w	d0
00896126 679C                       		beq.s	@isblank2
00896128 6B00                       		bmi.s	@negfloor
0089612A 3202                       		move.w	d2,d1
0089612C 0241 000F                  		andi.w	#$F,d1
00896130 D041                       		add.w	d1,d0
00896132 323C 000F                  		move.w	#$F,d1
00896136 9240                       		sub.w	d0,d1
00896138 4E75                       		rts	
0089613A                            ; ===========================================================================
0089613A                            
0089613A                            @negfloor:
0089613A 3202                       		move.w	d2,d1
0089613C 0241 000F                  		andi.w	#$F,d1
00896140 D041                       		add.w	d1,d0
00896142 6A00 FF80                  		bpl.w	@isblank2
00896146 4641                       		not.w	d1
00896148 4E75                       		rts	
0089614A                            ; End of function FindFloor2
0089614A                            ; End of function FindFloor2
0089614A                            		include	"_incObj\sub FindWall.asm"
0089614A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089614A                            
0089614A                            
0089614A                            FindWall:				; XREF: Sonic_WalkVertR; et al
0089614A 6100 FE42                  		bsr.w	FindNearestTile
0089614E 3011                       		move.w	(a1),d0
00896150 3800                       		move.w	d0,d4
00896152 0240 07FF                  		andi.w	#$7FF,d0
00896156 6700                       		beq.s	loc_14B1E
00896158 0B04                       		btst	d5,d4
0089615A 6600                       		bne.s	loc_14B2C
0089615C                            
0089615C                            loc_14B1E:
0089615C D64B                       		add.w	a3,d3
0089615E 6100 0000                  		bsr.w	FindWall2
00896162 964B                       		sub.w	a3,d3
00896164 0641 0010                  		addi.w	#$10,d1
00896168 4E75                       		rts	
0089616A                            ; ===========================================================================
0089616A                            
0089616A                            loc_14B2C:
0089616A 2478 F796                  		movea.l	(v_collindex).w,a2
0089616E 1032 0000                  		move.b	(a2,d0.w),d0
00896172 0240 00FF                  		andi.w	#$FF,d0
00896176 67E4                       		beq.s	loc_14B1E
00896178 45F9 0000 0000             		lea	(AngleMap).l,a2
0089617E 18B2 0000                  		move.b	(a2,d0.w),(a4)
00896182 E948                       		lsl.w	#4,d0
00896184 3202                       		move.w	d2,d1
00896186 0804 000C                  		btst	#$C,d4
0089618A 6700                       		beq.s	loc_14B5A
0089618C 4641                       		not.w	d1
0089618E 0614 0040                  		addi.b	#$40,(a4)
00896192 4414                       		neg.b	(a4)
00896194 0414 0040                  		subi.b	#$40,(a4)
00896198                            
00896198                            loc_14B5A:
00896198 0804 000B                  		btst	#$B,d4
0089619C 6700                       		beq.s	loc_14B62
0089619E 4414                       		neg.b	(a4)
008961A0                            
008961A0                            loc_14B62:
008961A0 0241 000F                  		andi.w	#$F,d1
008961A4 D240                       		add.w	d0,d1
008961A6 45F9 0000 0000             		lea	(CollArray2).l,a2
008961AC 1032 1000                  		move.b	(a2,d1.w),d0
008961B0 4880                       		ext.w	d0
008961B2 BD44                       		eor.w	d6,d4
008961B4 0804 000B                  		btst	#$B,d4
008961B8 6700                       		beq.s	loc_14B7E
008961BA 4440                       		neg.w	d0
008961BC                            
008961BC                            loc_14B7E:
008961BC 4A40                       		tst.w	d0
008961BE 679C                       		beq.s	loc_14B1E
008961C0 6B00                       		bmi.s	loc_14B9A
008961C2 0C00 0010                  		cmpi.b	#$10,d0
008961C6 6700                       		beq.s	loc_14BA6
008961C8 3203                       		move.w	d3,d1
008961CA 0241 000F                  		andi.w	#$F,d1
008961CE D041                       		add.w	d1,d0
008961D0 323C 000F                  		move.w	#$F,d1
008961D4 9240                       		sub.w	d0,d1
008961D6 4E75                       		rts	
008961D8                            ; ===========================================================================
008961D8                            
008961D8                            loc_14B9A:
008961D8 3203                       		move.w	d3,d1
008961DA 0241 000F                  		andi.w	#$F,d1
008961DE D041                       		add.w	d1,d0
008961E0 6A00 FF7A                  		bpl.w	loc_14B1E
008961E4                            
008961E4                            loc_14BA6:
008961E4 964B                       		sub.w	a3,d3
008961E6 6100 0000                  		bsr.w	FindWall2
008961EA D64B                       		add.w	a3,d3
008961EC 0441 0010                  		subi.w	#$10,d1
008961F0 4E75                       		rts	
008961F2                            ; End of function FindWall
008961F2                            
008961F2                            
008961F2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008961F2                            
008961F2                            
008961F2                            FindWall2:				; XREF: FindWall
008961F2 6100 FD9A                  		bsr.w	FindNearestTile
008961F6 3011                       		move.w	(a1),d0
008961F8 3800                       		move.w	d0,d4
008961FA 0240 07FF                  		andi.w	#$7FF,d0
008961FE 6700                       		beq.s	loc_14BC6
00896200 0B04                       		btst	d5,d4
00896202 6600                       		bne.s	loc_14BD4
00896204                            
00896204                            loc_14BC6:
00896204 323C 000F                  		move.w	#$F,d1
00896208 3003                       		move.w	d3,d0
0089620A 0240 000F                  		andi.w	#$F,d0
0089620E 9240                       		sub.w	d0,d1
00896210 4E75                       		rts	
00896212                            ; ===========================================================================
00896212                            
00896212                            loc_14BD4:
00896212 2478 F796                  		movea.l	(v_collindex).w,a2
00896216 1032 0000                  		move.b	(a2,d0.w),d0
0089621A 0240 00FF                  		andi.w	#$FF,d0
0089621E 67E4                       		beq.s	loc_14BC6
00896220 45F9 0000 0000             		lea	(AngleMap).l,a2
00896226 18B2 0000                  		move.b	(a2,d0.w),(a4)
0089622A E948                       		lsl.w	#4,d0
0089622C 3202                       		move.w	d2,d1
0089622E 0804 000C                  		btst	#$C,d4
00896232 6700                       		beq.s	loc_14C02
00896234 4641                       		not.w	d1
00896236 0614 0040                  		addi.b	#$40,(a4)
0089623A 4414                       		neg.b	(a4)
0089623C 0414 0040                  		subi.b	#$40,(a4)
00896240                            
00896240                            loc_14C02:
00896240 0804 000B                  		btst	#$B,d4
00896244 6700                       		beq.s	loc_14C0A
00896246 4414                       		neg.b	(a4)
00896248                            
00896248                            loc_14C0A:
00896248 0241 000F                  		andi.w	#$F,d1
0089624C D240                       		add.w	d0,d1
0089624E 45F9 0000 0000             		lea	(CollArray2).l,a2
00896254 1032 1000                  		move.b	(a2,d1.w),d0
00896258 4880                       		ext.w	d0
0089625A BD44                       		eor.w	d6,d4
0089625C 0804 000B                  		btst	#$B,d4
00896260 6700                       		beq.s	loc_14C26
00896262 4440                       		neg.w	d0
00896264                            
00896264                            loc_14C26:
00896264 4A40                       		tst.w	d0
00896266 679C                       		beq.s	loc_14BC6
00896268 6B00                       		bmi.s	loc_14C3C
0089626A 3203                       		move.w	d3,d1
0089626C 0241 000F                  		andi.w	#$F,d1
00896270 D041                       		add.w	d1,d0
00896272 323C 000F                  		move.w	#$F,d1
00896276 9240                       		sub.w	d0,d1
00896278 4E75                       		rts	
0089627A                            ; ===========================================================================
0089627A                            
0089627A                            loc_14C3C:
0089627A 3203                       		move.w	d3,d1
0089627C 0241 000F                  		andi.w	#$F,d1
00896280 D041                       		add.w	d1,d0
00896282 6A00 FF80                  		bpl.w	loc_14BC6
00896286 4641                       		not.w	d1
00896288 4E75                       		rts	
0089628A                            ; End of function FindWall2
0089628A                            ; End of function FindWall2
0089628A                            
0089628A                            ; ---------------------------------------------------------------------------
0089628A                            ; Unused floor/wall subroutine - logs something	to do with collision
0089628A                            ; ---------------------------------------------------------------------------
0089628A                            
0089628A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089628A                            
0089628A                            
0089628A                            FloorLog_Unk:				; XREF: GM_Level
0089628A 4E75                       		rts	
0089628C                            
0089628C 43F9 0000 0000             		lea	(CollArray1).l,a1
00896292 45F9 0000 0000             		lea	(CollArray1).l,a2
00896298 363C 00FF                  		move.w	#$FF,d3
0089629C                            
0089629C                            loc_14C5E:
0089629C 7A10                       		moveq	#$10,d5
0089629E 343C 000F                  		move.w	#$F,d2
008962A2                            
008962A2                            loc_14C64:
008962A2 7800                       		moveq	#0,d4
008962A4 323C 000F                  		move.w	#$F,d1
008962A8                            
008962A8                            loc_14C6A:
008962A8 3019                       		move.w	(a1)+,d0
008962AA EAA8                       		lsr.l	d5,d0
008962AC D944                       		addx.w	d4,d4
008962AE 51C9 FFF8                  		dbf	d1,loc_14C6A
008962B2                            
008962B2 34C4                       		move.w	d4,(a2)+
008962B4 92FC 0020                  		suba.w	#$20,a1
008962B8 5345                       		subq.w	#1,d5
008962BA 51CA FFE6                  		dbf	d2,loc_14C64
008962BE                            
008962BE D2FC 0020                  		adda.w	#$20,a1
008962C2 51CB FFD8                  		dbf	d3,loc_14C5E
008962C6                            
008962C6 43F9 0000 0000             		lea	(CollArray1).l,a1
008962CC 45F9 0000 0000             		lea	(CollArray2).l,a2
008962D2 6100                       		bsr.s	FloorLog_Unk2
008962D4 43F9 0000 0000             		lea	(CollArray1).l,a1
008962DA 45F9 0000 0000             		lea	(CollArray1).l,a2
008962E0                            
008962E0                            ; End of function FloorLog_Unk
008962E0                            
008962E0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008962E0                            
008962E0                            
008962E0                            FloorLog_Unk2:				; XREF: FloorLog_Unk
008962E0 363C 0FFF                  		move.w	#$FFF,d3
008962E4                            
008962E4                            loc_14CA6:
008962E4 7400                       		moveq	#0,d2
008962E6 323C 000F                  		move.w	#$F,d1
008962EA 3019                       		move.w	(a1)+,d0
008962EC 6700                       		beq.s	loc_14CD4
008962EE 6B00                       		bmi.s	loc_14CBE
008962F0                            
008962F0                            loc_14CB2:
008962F0 E248                       		lsr.w	#1,d0
008962F2 6400                       		bcc.s	loc_14CB8
008962F4 5202                       		addq.b	#1,d2
008962F6                            
008962F6                            loc_14CB8:
008962F6 51C9 FFF8                  		dbf	d1,loc_14CB2
008962FA                            
008962FA 6000                       		bra.s	loc_14CD6
008962FC                            ; ===========================================================================
008962FC                            
008962FC                            loc_14CBE:
008962FC 0C40 FFFF                  		cmpi.w	#-1,d0
00896300 6700                       		beq.s	loc_14CD0
00896302                            
00896302                            loc_14CC4:
00896302 E348                       		lsl.w	#1,d0
00896304 6400                       		bcc.s	loc_14CCA
00896306 5302                       		subq.b	#1,d2
00896308                            
00896308                            loc_14CCA:
00896308 51C9 FFF8                  		dbf	d1,loc_14CC4
0089630C                            
0089630C 6000                       		bra.s	loc_14CD6
0089630E                            ; ===========================================================================
0089630E                            
0089630E                            loc_14CD0:
0089630E 303C 0010                  		move.w	#$10,d0
00896312                            
00896312                            loc_14CD4:
00896312 3400                       		move.w	d0,d2
00896314                            
00896314                            loc_14CD6:
00896314 14C2                       		move.b	d2,(a2)+
00896316 51CB FFCC                  		dbf	d3,loc_14CA6
0089631A                            
0089631A 4E75                       		rts	
0089631C                            
0089631C                            ; End of function FloorLog_Unk2
0089631C                            
0089631C                            
0089631C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089631C                            
0089631C                            
0089631C                            Sonic_WalkSpeed:			; XREF: Sonic_Move
0089631C 2628 0008                  		move.l	obX(a0),d3
00896320 2428 000C                  		move.l	obY(a0),d2
00896324 3228 0010                  		move.w	obVelX(a0),d1
00896328 48C1                       		ext.l	d1
0089632A E181                       		asl.l	#8,d1
0089632C D681                       		add.l	d1,d3
0089632E 3228 0012                  		move.w	obVelY(a0),d1
00896332 48C1                       		ext.l	d1
00896334 E181                       		asl.l	#8,d1
00896336 D481                       		add.l	d1,d2
00896338 4842                       		swap	d2
0089633A 4843                       		swap	d3
0089633C 11C0 F768                  		move.b	d0,(v_anglebuffer).w
00896340 11C0 F76A                  		move.b	d0,($FFFFF76A).w
00896344 1200                       		move.b	d0,d1
00896346 0600 0020                  		addi.b	#$20,d0
0089634A 6A00                       		bpl.s	loc_14D1A
0089634C 1001                       		move.b	d1,d0
0089634E 6A00                       		bpl.s	loc_14D14
00896350 5300                       		subq.b	#1,d0
00896352                            
00896352                            loc_14D14:
00896352 0600 0020                  		addi.b	#$20,d0
00896356 6000                       		bra.s	loc_14D24
00896358                            ; ===========================================================================
00896358                            
00896358                            loc_14D1A:
00896358 1001                       		move.b	d1,d0
0089635A 6A00                       		bpl.s	loc_14D20
0089635C 5200                       		addq.b	#1,d0
0089635E                            
0089635E                            loc_14D20:
0089635E 0600 001F                  		addi.b	#$1F,d0
00896362                            
00896362                            loc_14D24:
00896362 0200 00C0                  		andi.b	#$C0,d0
00896366 6700 0000                  		beq.w	loc_14DF0
0089636A 0C00 0080                  		cmpi.b	#$80,d0
0089636E 6700 0000                  		beq.w	loc_14F7C
00896372 0201 0038                  		andi.b	#$38,d1
00896376 6600                       		bne.s	loc_14D3C
00896378 5042                       		addq.w	#8,d2
0089637A                            
0089637A                            loc_14D3C:
0089637A 0C00 0040                  		cmpi.b	#$40,d0
0089637E 6700 0000                  		beq.w	loc_1504A
00896382 6000 0000                  		bra.w	loc_14EBC
00896386                            
00896386                            ; End of function Sonic_WalkSpeed
00896386                            
00896386                            
00896386                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896386                            
00896386                            
00896386                            sub_14D48:				; XREF: Sonic_Jump
00896386 11C0 F768                  		move.b	d0,(v_anglebuffer).w
0089638A 11C0 F76A                  		move.b	d0,($FFFFF76A).w
0089638E 0600 0020                  		addi.b	#$20,d0
00896392 0200 00C0                  		andi.b	#$C0,d0
00896396 0C00 0040                  		cmpi.b	#$40,d0
0089639A 6700 0000                  		beq.w	loc_14FD6
0089639E 0C00 0080                  		cmpi.b	#$80,d0
008963A2 6700 0000                  		beq.w	Sonic_DontRunOnWalls
008963A6 0C00 00C0                  		cmpi.b	#$C0,d0
008963AA 6700 0000                  		beq.w	sub_14E50
008963AE                            
008963AE                            ; End of function sub_14D48
008963AE                            
008963AE                            ; ---------------------------------------------------------------------------
008963AE                            ; Subroutine to	make Sonic land	on the floor after jumping
008963AE                            ; ---------------------------------------------------------------------------
008963AE                            
008963AE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008963AE                            
008963AE                            
008963AE                            Sonic_HitFloor:				; XREF: Sonic_Floor
008963AE 3428 000C                  		move.w	obY(a0),d2
008963B2 3628 0008                  		move.w	obX(a0),d3
008963B6 7000                       		moveq	#0,d0
008963B8 1028 0016                  		move.b	obHeight(a0),d0
008963BC 4880                       		ext.w	d0
008963BE D440                       		add.w	d0,d2
008963C0 1028 0017                  		move.b	obWidth(a0),d0
008963C4 4880                       		ext.w	d0
008963C6 D640                       		add.w	d0,d3
008963C8 49F8 F768                  		lea	(v_anglebuffer).w,a4
008963CC 367C 0010                  		movea.w	#$10,a3
008963D0 3C3C 0000                  		move.w	#0,d6
008963D4 7A0D                       		moveq	#$D,d5
008963D6 6100 FC34                  		bsr.w	FindFloor
008963DA 3F01                       		move.w	d1,-(sp)
008963DC 3428 000C                  		move.w	obY(a0),d2
008963E0 3628 0008                  		move.w	obX(a0),d3
008963E4 7000                       		moveq	#0,d0
008963E6 1028 0016                  		move.b	obHeight(a0),d0
008963EA 4880                       		ext.w	d0
008963EC D440                       		add.w	d0,d2
008963EE 1028 0017                  		move.b	obWidth(a0),d0
008963F2 4880                       		ext.w	d0
008963F4 9640                       		sub.w	d0,d3
008963F6 49F8 F76A                  		lea	($FFFFF76A).w,a4
008963FA 367C 0010                  		movea.w	#$10,a3
008963FE 3C3C 0000                  		move.w	#0,d6
00896402 7A0D                       		moveq	#$D,d5
00896404 6100 FC06                  		bsr.w	FindFloor
00896408 301F                       		move.w	(sp)+,d0
0089640A 143C 0000                  		move.b	#0,d2
0089640E                            
0089640E                            loc_14DD0:
0089640E 1638 F76A                  		move.b	($FFFFF76A).w,d3
00896412 B240                       		cmp.w	d0,d1
00896414 6F00                       		ble.s	loc_14DDE
00896416 1638 F768                  		move.b	(v_anglebuffer).w,d3
0089641A C141                       		exg	d0,d1
0089641C                            
0089641C                            loc_14DDE:
0089641C 0803 0000                  		btst	#0,d3
00896420 6700                       		beq.s	locret_14DE6
00896422 1602                       		move.b	d2,d3
00896424                            
00896424                            locret_14DE6:
00896424 4E75                       		rts	
00896426                            
00896426                            ; End of function Sonic_HitFloor
00896426                            
00896426                            ; ===========================================================================
00896426 3428 000C                  		move.w	obY(a0),d2
0089642A 3628 0008                  		move.w	obX(a0),d3
0089642E                            
0089642E                            loc_14DF0:				; XREF: Sonic_WalkSpeed
0089642E 0642 000A                  		addi.w	#$A,d2
00896432 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896436 367C 0010                  		movea.w	#$10,a3
0089643A 3C3C 0000                  		move.w	#0,d6
0089643E 7A0E                       		moveq	#$E,d5
00896440 6100 FBCA                  		bsr.w	FindFloor
00896444 143C 0000                  		move.b	#0,d2
00896448                            
00896448                            loc_14E0A:				; XREF: sub_14EB4
00896448 1638 F768                  		move.b	(v_anglebuffer).w,d3
0089644C 0803 0000                  		btst	#0,d3
00896450 6700                       		beq.s	locret_14E16
00896452 1602                       		move.b	d2,d3
00896454                            
00896454                            locret_14E16:
00896454 4E75                       		rts	
00896456                            
00896456                            		include	"_incObj\sub ObjFloorDist.asm"
00896456                            ; ---------------------------------------------------------------------------
00896456                            ; Subroutine to find the distance of an object to the floor
00896456                            
00896456                            ; input:
00896456                            ;	d3 = x-pos. of object (ObjFloorDist2 only)
00896456                            
00896456                            ; output:
00896456                            ;	d1 = distance to the floor
00896456                            ;	d3 = floor angle
00896456                            ;	a1 = address within 256x256 mappings where object is standing
00896456                            ;	     (refers to a 16x16 tile number)
00896456                            ;	(a4) = floor angle
00896456                            ; ---------------------------------------------------------------------------
00896456                            
00896456                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896456                            
00896456                            
00896456                            ObjFloorDist:
00896456 3628 0008                  		move.w	obX(a0),d3
0089645A                            
0089645A                            
0089645A                            ObjFloorDist2:
0089645A 3428 000C                  		move.w	obY(a0),d2
0089645E 7000                       		moveq	#0,d0
00896460 1028 0016                  		move.b	obHeight(a0),d0
00896464 4880                       		ext.w	d0
00896466 D440                       		add.w	d0,d2
00896468 49F8 F768                  		lea	(v_anglebuffer).w,a4
0089646C 18BC 0000                  		move.b	#0,(a4)
00896470 367C 0010                  		movea.w	#$10,a3		; height of a 16x16 tile
00896474 3C3C 0000                  		move.w	#0,d6
00896478 7A0D                       		moveq	#$D,d5		; bit to test for solidness
0089647A 6100 FB90                  		bsr.w	FindFloor
0089647E 1638 F768                  		move.b	(v_anglebuffer).w,d3
00896482 0803 0000                  		btst	#0,d3
00896486 6700                       		beq.s	locret_14E4E
00896488 163C 0000                  		move.b	#0,d3
0089648C                            
0089648C                            	locret_14E4E:
0089648C 4E75                       		rts	
0089648E                            
0089648E                            ; End of function ObjFloorDist2
0089648E                            ; End of function ObjFloorDist2
0089648E                            
0089648E                            
0089648E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089648E                            
0089648E                            
0089648E                            sub_14E50:				; XREF: sub_14D48
0089648E 3428 000C                  		move.w	obY(a0),d2
00896492 3628 0008                  		move.w	obX(a0),d3
00896496 7000                       		moveq	#0,d0
00896498 1028 0017                  		move.b	obWidth(a0),d0
0089649C 4880                       		ext.w	d0
0089649E 9440                       		sub.w	d0,d2
008964A0 1028 0016                  		move.b	obHeight(a0),d0
008964A4 4880                       		ext.w	d0
008964A6 D640                       		add.w	d0,d3
008964A8 49F8 F768                  		lea	(v_anglebuffer).w,a4
008964AC 367C 0010                  		movea.w	#$10,a3
008964B0 3C3C 0000                  		move.w	#0,d6
008964B4 7A0E                       		moveq	#$E,d5
008964B6 6100 FC92                  		bsr.w	FindWall
008964BA 3F01                       		move.w	d1,-(sp)
008964BC 3428 000C                  		move.w	obY(a0),d2
008964C0 3628 0008                  		move.w	obX(a0),d3
008964C4 7000                       		moveq	#0,d0
008964C6 1028 0017                  		move.b	obWidth(a0),d0
008964CA 4880                       		ext.w	d0
008964CC D440                       		add.w	d0,d2
008964CE 1028 0016                  		move.b	obHeight(a0),d0
008964D2 4880                       		ext.w	d0
008964D4 D640                       		add.w	d0,d3
008964D6 49F8 F76A                  		lea	($FFFFF76A).w,a4
008964DA 367C 0010                  		movea.w	#$10,a3
008964DE 3C3C 0000                  		move.w	#0,d6
008964E2 7A0E                       		moveq	#$E,d5
008964E4 6100 FC64                  		bsr.w	FindWall
008964E8 301F                       		move.w	(sp)+,d0
008964EA 143C 00C0                  		move.b	#-$40,d2
008964EE 6000 FF1E                  		bra.w	loc_14DD0
008964F2                            
008964F2                            ; End of function sub_14E50
008964F2                            
008964F2                            
008964F2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008964F2                            
008964F2                            
008964F2                            sub_14EB4:				; XREF: Sonic_Floor
008964F2 3428 000C                  		move.w	obY(a0),d2
008964F6 3628 0008                  		move.w	obX(a0),d3
008964FA                            
008964FA                            loc_14EBC:
008964FA 0643 000A                  		addi.w	#$A,d3
008964FE 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896502 367C 0010                  		movea.w	#$10,a3
00896506 3C3C 0000                  		move.w	#0,d6
0089650A 7A0E                       		moveq	#$E,d5
0089650C 6100 FC3C                  		bsr.w	FindWall
00896510 143C 00C0                  		move.b	#-$40,d2
00896514 6000 FF32                  		bra.w	loc_14E0A
00896518                            
00896518                            ; End of function sub_14EB4
00896518                            
00896518                            ; ---------------------------------------------------------------------------
00896518                            ; Subroutine to	detect when an object hits a wall to its right
00896518                            ; ---------------------------------------------------------------------------
00896518                            
00896518                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896518                            
00896518                            
00896518                            ObjHitWallRight:
00896518 D668 0008                  		add.w	obX(a0),d3
0089651C 3428 000C                  		move.w	obY(a0),d2
00896520 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896524 18BC 0000                  		move.b	#0,(a4)
00896528 367C 0010                  		movea.w	#$10,a3
0089652C 3C3C 0000                  		move.w	#0,d6
00896530 7A0E                       		moveq	#$E,d5
00896532 6100 FC16                  		bsr.w	FindWall
00896536 1638 F768                  		move.b	(v_anglebuffer).w,d3
0089653A 0803 0000                  		btst	#0,d3
0089653E 6700                       		beq.s	locret_14F06
00896540 163C 00C0                  		move.b	#-$40,d3
00896544                            
00896544                            locret_14F06:
00896544 4E75                       		rts	
00896546                            
00896546                            ; End of function ObjHitWallRight
00896546                            
00896546                            ; ---------------------------------------------------------------------------
00896546                            ; Subroutine preventing	Sonic from running on walls and	ceilings when he
00896546                            ; touches them
00896546                            ; ---------------------------------------------------------------------------
00896546                            
00896546                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896546                            
00896546                            
00896546                            Sonic_DontRunOnWalls:			; XREF: Sonic_Floor; et al
00896546 3428 000C                  		move.w	obY(a0),d2
0089654A 3628 0008                  		move.w	obX(a0),d3
0089654E 7000                       		moveq	#0,d0
00896550 1028 0016                  		move.b	obHeight(a0),d0
00896554 4880                       		ext.w	d0
00896556 9440                       		sub.w	d0,d2
00896558 0A42 000F                  		eori.w	#$F,d2
0089655C 1028 0017                  		move.b	obWidth(a0),d0
00896560 4880                       		ext.w	d0
00896562 D640                       		add.w	d0,d3
00896564 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896568 367C FFF0                  		movea.w	#-$10,a3
0089656C 3C3C 1000                  		move.w	#$1000,d6
00896570 7A0E                       		moveq	#$E,d5
00896572 6100 FA98                  		bsr.w	FindFloor
00896576 3F01                       		move.w	d1,-(sp)
00896578 3428 000C                  		move.w	obY(a0),d2
0089657C 3628 0008                  		move.w	obX(a0),d3
00896580 7000                       		moveq	#0,d0
00896582 1028 0016                  		move.b	obHeight(a0),d0
00896586 4880                       		ext.w	d0
00896588 9440                       		sub.w	d0,d2
0089658A 0A42 000F                  		eori.w	#$F,d2
0089658E 1028 0017                  		move.b	obWidth(a0),d0
00896592 4880                       		ext.w	d0
00896594 9640                       		sub.w	d0,d3
00896596 49F8 F76A                  		lea	($FFFFF76A).w,a4
0089659A 367C FFF0                  		movea.w	#-$10,a3
0089659E 3C3C 1000                  		move.w	#$1000,d6
008965A2 7A0E                       		moveq	#$E,d5
008965A4 6100 FA66                  		bsr.w	FindFloor
008965A8 301F                       		move.w	(sp)+,d0
008965AA 143C 0080                  		move.b	#-$80,d2
008965AE 6000 FE5E                  		bra.w	loc_14DD0
008965B2                            ; End of function Sonic_DontRunOnWalls
008965B2                            
008965B2                            ; ===========================================================================
008965B2 3428 000C                  		move.w	obY(a0),d2
008965B6 3628 0008                  		move.w	obX(a0),d3
008965BA                            
008965BA                            loc_14F7C:
008965BA 0442 000A                  		subi.w	#$A,d2
008965BE 0A42 000F                  		eori.w	#$F,d2
008965C2 49F8 F768                  		lea	(v_anglebuffer).w,a4
008965C6 367C FFF0                  		movea.w	#-$10,a3
008965CA 3C3C 1000                  		move.w	#$1000,d6
008965CE 7A0E                       		moveq	#$E,d5
008965D0 6100 FA3A                  		bsr.w	FindFloor
008965D4 143C 0080                  		move.b	#-$80,d2
008965D8 6000 FE6E                  		bra.w	loc_14E0A
008965DC                            
008965DC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008965DC                            
008965DC                            
008965DC                            ObjHitCeiling:
008965DC 3428 000C                  		move.w	obY(a0),d2
008965E0 3628 0008                  		move.w	obX(a0),d3
008965E4 7000                       		moveq	#0,d0
008965E6 1028 0016                  		move.b	obHeight(a0),d0
008965EA 4880                       		ext.w	d0
008965EC 9440                       		sub.w	d0,d2
008965EE 0A42 000F                  		eori.w	#$F,d2
008965F2 49F8 F768                  		lea	(v_anglebuffer).w,a4
008965F6 367C FFF0                  		movea.w	#-$10,a3
008965FA 3C3C 1000                  		move.w	#$1000,d6
008965FE 7A0E                       		moveq	#$E,d5
00896600 6100 FA0A                  		bsr.w	FindFloor
00896604 1638 F768                  		move.b	(v_anglebuffer).w,d3
00896608 0803 0000                  		btst	#0,d3
0089660C 6700                       		beq.s	locret_14FD4
0089660E 163C 0080                  		move.b	#-$80,d3
00896612                            
00896612                            locret_14FD4:
00896612 4E75                       		rts	
00896614                            ; End of function ObjHitCeiling
00896614                            
00896614                            ; ===========================================================================
00896614                            
00896614                            loc_14FD6:				; XREF: sub_14D48
00896614 3428 000C                  		move.w	obY(a0),d2
00896618 3628 0008                  		move.w	obX(a0),d3
0089661C 7000                       		moveq	#0,d0
0089661E 1028 0017                  		move.b	obWidth(a0),d0
00896622 4880                       		ext.w	d0
00896624 9440                       		sub.w	d0,d2
00896626 1028 0016                  		move.b	obHeight(a0),d0
0089662A 4880                       		ext.w	d0
0089662C 9640                       		sub.w	d0,d3
0089662E 0A43 000F                  		eori.w	#$F,d3
00896632 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896636 367C FFF0                  		movea.w	#-$10,a3
0089663A 3C3C 0800                  		move.w	#$800,d6
0089663E 7A0E                       		moveq	#$E,d5
00896640 6100 FB08                  		bsr.w	FindWall
00896644 3F01                       		move.w	d1,-(sp)
00896646 3428 000C                  		move.w	obY(a0),d2
0089664A 3628 0008                  		move.w	obX(a0),d3
0089664E 7000                       		moveq	#0,d0
00896650 1028 0017                  		move.b	obWidth(a0),d0
00896654 4880                       		ext.w	d0
00896656 D440                       		add.w	d0,d2
00896658 1028 0016                  		move.b	obHeight(a0),d0
0089665C 4880                       		ext.w	d0
0089665E 9640                       		sub.w	d0,d3
00896660 0A43 000F                  		eori.w	#$F,d3
00896664 49F8 F76A                  		lea	($FFFFF76A).w,a4
00896668 367C FFF0                  		movea.w	#-$10,a3
0089666C 3C3C 0800                  		move.w	#$800,d6
00896670 7A0E                       		moveq	#$E,d5
00896672 6100 FAD6                  		bsr.w	FindWall
00896676 301F                       		move.w	(sp)+,d0
00896678 143C 0040                  		move.b	#$40,d2
0089667C 6000 FD90                  		bra.w	loc_14DD0
00896680                            
00896680                            ; ---------------------------------------------------------------------------
00896680                            ; Subroutine to	stop Sonic when	he jumps at a wall
00896680                            ; ---------------------------------------------------------------------------
00896680                            
00896680                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896680                            
00896680                            
00896680                            Sonic_HitWall:				; XREF: Sonic_Floor
00896680 3428 000C                  		move.w	obY(a0),d2
00896684 3628 0008                  		move.w	obX(a0),d3
00896688                            
00896688                            loc_1504A:
00896688 0443 000A                  		subi.w	#$A,d3
0089668C 0A43 000F                  		eori.w	#$F,d3
00896690 49F8 F768                  		lea	(v_anglebuffer).w,a4
00896694 367C FFF0                  		movea.w	#-$10,a3
00896698 3C3C 0800                  		move.w	#$800,d6
0089669C 7A0E                       		moveq	#$E,d5
0089669E 6100 FAAA                  		bsr.w	FindWall
008966A2 143C 0040                  		move.b	#$40,d2
008966A6 6000 FDA0                  		bra.w	loc_14E0A
008966AA                            ; End of function Sonic_HitWall
008966AA                            
008966AA                            ; ---------------------------------------------------------------------------
008966AA                            ; Subroutine to	detect when an object hits a wall to its left
008966AA                            ; ---------------------------------------------------------------------------
008966AA                            
008966AA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008966AA                            
008966AA                            
008966AA                            ObjHitWallLeft:
008966AA D668 0008                  		add.w	obX(a0),d3
008966AE 3428 000C                  		move.w	obY(a0),d2
008966B2 49F8 F768                  		lea	(v_anglebuffer).w,a4
008966B6 18BC 0000                  		move.b	#0,(a4)
008966BA 367C FFF0                  		movea.w	#-$10,a3
008966BE 3C3C 0800                  		move.w	#$800,d6
008966C2 7A0E                       		moveq	#$E,d5
008966C4 6100 FA84                  		bsr.w	FindWall
008966C8 1638 F768                  		move.b	(v_anglebuffer).w,d3
008966CC 0803 0000                  		btst	#0,d3
008966D0 6700                       		beq.s	locret_15098
008966D2 163C 0040                  		move.b	#$40,d3
008966D6                            
008966D6                            locret_15098:
008966D6 4E75                       		rts	
008966D8                            ; End of function ObjHitWallLeft
008966D8                            
008966D8                            ; ===========================================================================
008966D8                            
008966D8                            		include	"_incObj\66 Rotating Junction.asm"
008966D8                            ; ---------------------------------------------------------------------------
008966D8                            ; Object 66 - rotating disc junction that grabs Sonic (SBZ)
008966D8                            ; ---------------------------------------------------------------------------
008966D8                            
008966D8                            Junction:				; XREF: Obj_Index
008966D8 7000                       		moveq	#0,d0
008966DA 1028 0024                  		move.b	obRoutine(a0),d0
008966DE 323B 0000                  		move.w	Jun_Index(pc,d0.w),d1
008966E2 4EFB 1000                  		jmp	Jun_Index(pc,d1.w)
008966E6                            ; ===========================================================================
008966E6 0000                       Jun_Index:	dc.w Jun_Main-Jun_Index
008966E8 0000                       		dc.w Jun_Action-Jun_Index
008966EA 0000                       		dc.w Jun_Display-Jun_Index
008966EC 0000                       		dc.w Jun_Release-Jun_Index
008966EE                            
008966EE =00000034                  jun_frame:	= $34		; current frame
008966EE =00000036                  jun_reverse:	= $36		; flag set when switch is pressed
008966EE =00000038                  jun_switch:	= $38		; which switch will reverse the disc
008966EE                            ; ===========================================================================
008966EE                            
008966EE                            Jun_Main:	; Routine 0
008966EE 5428 0024                  		addq.b	#2,obRoutine(a0)
008966F2 323C 0001                  		move.w	#1,d1
008966F6 2248                       		movea.l	a0,a1
008966F8 6000                       		bra.s	@makeitem
008966FA                            ; ===========================================================================
008966FA                            
008966FA                            	@repeat:
008966FA 6100 8166                  		bsr.w	FindFreeObj
008966FE 6600                       		bne.s	@fail
00896700 137C 0066 0000             		move.b	#id_Junction,0(a1)
00896706 5829 0024                  		addq.b	#4,obRoutine(a1) ; goto Jun_Display next
0089670A 3368 0008 0008             		move.w	obX(a0),obX(a1)
00896710 3368 000C 000C             		move.w	obY(a0),obY(a1)
00896716 137C 0003 0018             		move.b	#3,obPriority(a1)
0089671C 137C 0010 001A             		move.b	#$10,obFrame(a1) ; use large circular sprite
00896722                            
00896722                            @makeitem:
00896722 237C 0000 0000 0004        		move.l	#Map_Jun,obMap(a1)
0089672A 337C 4348 0002             		move.w	#$4348,obGfx(a1)
00896730 0029 0004 0001             		ori.b	#4,obRender(a1)
00896736 137C 0038 0019             		move.b	#$38,obActWid(a1)
0089673C                            
0089673C                            	@fail:
0089673C 51C9 FFBC                  		dbf	d1,@repeat
00896740                            
00896740 117C 0030 0019             		move.b	#$30,obActWid(a0)
00896746 117C 0004 0018             		move.b	#4,obPriority(a0)
0089674C 317C 003C 0030             		move.w	#$3C,$30(a0)
00896752 117C 0001 0034             		move.b	#1,jun_frame(a0)
00896758 1168 0028 0038             		move.b	obSubtype(a0),jun_switch(a0)
0089675E                            
0089675E                            Jun_Action:	; Routine 2
0089675E 6100 0000                  		bsr.w	Jun_ChkSwitch
00896762 4A28 0001                  		tst.b	obRender(a0)
00896766 6A00 0000                  		bpl.w	Jun_Display
0089676A 323C 0030                  		move.w	#$30,d1
0089676E 3401                       		move.w	d1,d2
00896770 3602                       		move.w	d2,d3
00896772 5243                       		addq.w	#1,d3
00896774 3828 0008                  		move.w	obX(a0),d4
00896778 6100 A03C                  		bsr.w	SolidObject
0089677C 0828 0005 0022             		btst	#staPush,obStatus(a0)	; is Sonic pushing the disc?	;Mercury Constants
00896782 6700 0000                  		beq.w	Jun_Display	; if not, branch
00896786                            
00896786 43F8 D000                  		lea	(v_player).w,a1
0089678A 720E                       		moveq	#$E,d1
0089678C 3029 0008                  		move.w	obX(a1),d0
00896790 B068 0008                  		cmp.w	obX(a0),d0	; is Sonic to the left of the disc?
00896794 6500                       		bcs.s	@isleft		; if yes, branch
00896796 7207                       		moveq	#7,d1		
00896798                            
00896798                            	@isleft:
00896798 B228 001A                  		cmp.b	obFrame(a0),d1	; is the gap next to Sonic?
0089679C 6600                       		bne.s	Jun_Display	; if not, branch
0089679E                            
0089679E 1141 0032                  		move.b	d1,$32(a0)
008967A2 5828 0024                  		addq.b	#4,obRoutine(a0) ; goto Jun_Release next
008967A6 11FC 0001 F7C8             		move.b	#1,(f_lockmulti).w ; lock controls
008967AC 137C 0002 001C             		move.b	#id_Roll,obAnim(a1) ; make Sonic use "rolling" animation
008967B2 337C 0800 0014             		move.w	#$800,obInertia(a1)
008967B8 337C 0000 0010             		move.w	#0,obVelX(a1)
008967BE 337C 0000 0012             		move.w	#0,obVelY(a1)
008967C4 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
008967CA 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
008967D0 08E9 0001 0022             		bset	#1,obStatus(a1)
008967D6 3429 0008                  		move.w	obX(a1),d2
008967DA 3629 000C                  		move.w	obY(a1),d3
008967DE 6100 0000                  		bsr.w	Jun_ChgPos
008967E2 D569 0008                  		add.w	d2,obX(a1)
008967E6 D769 000C                  		add.w	d3,obY(a1)
008967EA E0E9 0008                  		asr	obX(a1)
008967EE E0E9 000C                  		asr	obY(a1)
008967F2                            
008967F2                            Jun_Display:	; Routine 4
008967F2 6000 9C98                  		bra.w	RememberState
008967F6                            ; ===========================================================================
008967F6                            
008967F6                            Jun_Release:	; Routine 6
008967F6 1028 001A                  		move.b	obFrame(a0),d0
008967FA 0C00 0004                  		cmpi.b	#4,d0		; is gap pointing down?
008967FE 6700                       		beq.s	@release	; if yes, branch
00896800 0C00 0007                  		cmpi.b	#7,d0		; is gap pointing right?
00896804 6600                       		bne.s	@dontrelease	; if not, branch
00896806                            
00896806                            	@release:
00896806 B028 0032                  		cmp.b	$32(a0),d0
0089680A 6700                       		beq.s	@dontrelease
0089680C 43F8 D000                  		lea	(v_player).w,a1
00896810 337C 0000 0010             		move.w	#0,obVelX(a1)
00896816 337C 0800 0012             		move.w	#$800,obVelY(a1)
0089681C 0C00 0004                  		cmpi.b	#4,d0
00896820 6700                       		beq.s	@isdown
00896822 337C 0800 0010             		move.w	#$800,obVelX(a1)
00896828 337C 0800 0012             		move.w	#$800,obVelY(a1)
0089682E                            
0089682E                            	@isdown:
0089682E 4238 F7C8                  		clr.b	(f_lockmulti).w	; unlock controls
00896832 5928 0024                  		subq.b	#4,obRoutine(a0)
00896836                            
00896836                            	@dontrelease:
00896836 6100                       		bsr.s	Jun_ChkSwitch
00896838 6100                       		bsr.s	Jun_ChgPos
0089683A 6000 9C50                  		bra.w	RememberState
0089683E                            
0089683E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089683E                            
0089683E                            
0089683E                            Jun_ChkSwitch:
0089683E 45F8 F7E0                  		lea	(f_switch).w,a2
00896842 7000                       		moveq	#0,d0
00896844 1028 0038                  		move.b	jun_switch(a0),d0
00896848 0832 0000 0000             		btst	#0,(a2,d0.w)	; is switch pressed?
0089684E 6700                       		beq.s	@unpressed	; if not, branch
00896850                            
00896850 4A28 0036                  		tst.b	jun_reverse(a0)	; has switch previously	been pressed?
00896854 6600                       		bne.s	@animate	; if yes, branch
00896856 4428 0034                  		neg.b	jun_frame(a0)
0089685A 117C 0001 0036             		move.b	#1,jun_reverse(a0) ; set to "previously pressed"
00896860 6000                       		bra.s	@animate
00896862                            ; ===========================================================================
00896862                            
00896862                            @unpressed:
00896862 4228 0036                  		clr.b	jun_reverse(a0)	; set to "not yet pressed"
00896866                            
00896866                            @animate:
00896866 5328 001E                  		subq.b	#1,obTimeFrame(a0) ; decrement frame timer
0089686A 6A00                       		bpl.s	@nochange	; if time remains, branch
0089686C 117C 0007 001E             		move.b	#7,obTimeFrame(a0)
00896872 1228 0034                  		move.b	jun_frame(a0),d1
00896876 1028 001A                  		move.b	obFrame(a0),d0
0089687A D001                       		add.b	d1,d0
0089687C 0200 000F                  		andi.b	#$F,d0
00896880 1140 001A                  		move.b	d0,obFrame(a0)	; update frame
00896884                            
00896884                            	@nochange:
00896884 4E75                       		rts	
00896886                            ; End of function Jun_ChkSwitch
00896886                            
00896886                            
00896886                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00896886                            
00896886                            
00896886                            Jun_ChgPos:
00896886 43F8 D000                  		lea	(v_player).w,a1
0089688A 7000                       		moveq	#0,d0
0089688C 1028 001A                  		move.b	obFrame(a0),d0
00896890 D040                       		add.w	d0,d0
00896892 45FB 0000                  		lea	@data(pc,d0.w),a2
00896896 101A                       		move.b	(a2)+,d0
00896898 4880                       		ext.w	d0
0089689A D068 0008                  		add.w	obX(a0),d0
0089689E 3340 0008                  		move.w	d0,obX(a1)
008968A2 101A                       		move.b	(a2)+,d0
008968A4 4880                       		ext.w	d0
008968A6 D068 000C                  		add.w	obY(a0),d0
008968AA 3340 000C                  		move.w	d0,obY(a1)
008968AE 4E75                       		rts	
008968B0                            
008968B0                            
008968B0 E000 E20E                  @data:		dc.b -$20,    0, -$1E,   $E ; disc x-pos, Sonic x-pos, disc y-pos, Sonic y-pos
008968B4 E818 F21E                  		dc.b -$18,  $18,  -$E,  $1E
008968B8 0020 0E1E                  		dc.b    0,  $20,   $E,  $1E
008968BC 1818 1E0E                  		dc.b  $18,  $18,  $1E,   $E
008968C0 2000 1EF2                  		dc.b  $20,    0,  $1E,  -$E
008968C4 18E8 0EE2                  		dc.b  $18, -$18,   $E, -$1E
008968C8 00E0 F2E2                  		dc.b    0, -$20,  -$E, -$1E
008968CC E8E8 E2F2                  		dc.b -$18, -$18, -$1E,  -$E
008968CC E8E8 E2F2                  		dc.b -$18, -$18, -$1E,  -$E
008968D0                            		include	"_maps\Rotating Junction.asm"
008968D0                            ; ---------------------------------------------------------------------------
008968D0                            ; Sprite mappings - rotating disc that grabs Sonic (SBZ)
008968D0                            ; ---------------------------------------------------------------------------
008968D0 0000 0000                  Map_Jun:	dc.w @gap0-Map_Jun, @gap1-Map_Jun
008968D4 0000 0000                  		dc.w @gap2-Map_Jun, @gap3-Map_Jun
008968D8 0000 0000                  		dc.w @gap4-Map_Jun, @gap5-Map_Jun
008968DC 0000 0000                  		dc.w @gap6-Map_Jun, @gap7-Map_Jun
008968E0 0000 0000                  		dc.w @gap8-Map_Jun, @gap9-Map_Jun
008968E4 0000 0000                  		dc.w @gapA-Map_Jun, @gapB-Map_Jun
008968E8 0000 0000                  		dc.w @gapC-Map_Jun, @gapD-Map_Jun
008968EC 0000 0000                  		dc.w @gapE-Map_Jun, @gapF-Map_Jun
008968F0 0000                       		dc.w @circle-Map_Jun
008968F2 06                         @gap0:		dc.b 6
008968F3 E805 0022 D0               		dc.b $E8, 5, 0,	$22, $D0
008968F8 0805 1022 D0               		dc.b 8,	5, $10,	$22, $D0
008968FD E80A 0000 C8               		dc.b $E8, $A, 0, 0, $C8
00896902 E80A 0800 E0               		dc.b $E8, $A, 8, 0, $E0
00896907 000A 1000 C8               		dc.b 0,	$A, $10, 0, $C8
0089690C 000A 1800 E0               		dc.b 0,	$A, $18, 0, $E0
00896911 06                         @gap1:		dc.b 6
00896912 F803 0026 D0               		dc.b $F8, 3, 0,	$26, $D0
00896917 1805 002A D8               		dc.b $18, 5, 0,	$2A, $D8
0089691C F60A 0000 CA               		dc.b $F6, $A, 0, 0, $CA
00896921 F60A 0800 E2               		dc.b $F6, $A, 8, 0, $E2
00896926 0E0A 1000 CA               		dc.b $E, $A, $10, 0, $CA
0089692B 0E0A 1800 E2               		dc.b $E, $A, $18, 0, $E2
00896930 06                         @gap2:		dc.b 6
00896931 0006 002E D0               		dc.b 0,	6, 0, $2E, $D0
00896936 2009 0034 E8               		dc.b $20, 9, 0,	$34, $E8
0089693B 000A 0000 D0               		dc.b 0,	$A, 0, 0, $D0
00896940 000A 0800 E8               		dc.b 0,	$A, 8, 0, $E8
00896945 180A 1000 D0               		dc.b $18, $A, $10, 0, $D0
0089694A 180A 1800 E8               		dc.b $18, $A, $18, 0, $E8
0089694F 06                         @gap3:		dc.b 6
00896950 0807 003A D8               		dc.b 8,	7, 0, $3A, $D8
00896955 2808 0042 F0               		dc.b $28, 8, 0,	$42, $F0
0089695A 060A 0000 DA               		dc.b 6,	$A, 0, 0, $DA
0089695F 060A 0800 F2               		dc.b 6,	$A, 8, 0, $F2
00896964 1E0A 1000 DA               		dc.b $1E, $A, $10, 0, $DA
00896969 1E0A 1800 F2               		dc.b $1E, $A, $18, 0, $F2
0089696E 06                         @gap4:		dc.b 6
0089696F 2005 0045 E8               		dc.b $20, 5, 0,	$45, $E8
00896974 2005 0845 08               		dc.b $20, 5, 8,	$45, 8
00896979 080A 0000 E8               		dc.b 8,	$A, 0, 0, $E8
0089697E 080A 0800 00               		dc.b 8,	$A, 8, 0, 0
00896983 200A 1000 E8               		dc.b $20, $A, $10, 0, $E8
00896988 200A 1800 00               		dc.b $20, $A, $18, 0, 0
0089698D 06                         @gap5:		dc.b 6
0089698E 2808 0842 F8               		dc.b $28, 8, 8,	$42, $F8
00896993 0807 083A 18               		dc.b 8,	7, 8, $3A, $18
00896998 060A 0000 F6               		dc.b 6,	$A, 0, 0, $F6
0089699D 060A 0800 0E               		dc.b 6,	$A, 8, 0, $E
008969A2 1E0A 1000 F6               		dc.b $1E, $A, $10, 0, $F6
008969A7 1E0A 1800 0E               		dc.b $1E, $A, $18, 0, $E
008969AC 06                         @gap6:		dc.b 6
008969AD 2009 0834 00               		dc.b $20, 9, 8,	$34, 0
008969B2 0006 082E 20               		dc.b 0,	6, 8, $2E, $20
008969B7 000A 0000 00               		dc.b 0,	$A, 0, 0, 0
008969BC 000A 0800 18               		dc.b 0,	$A, 8, 0, $18
008969C1 180A 1000 00               		dc.b $18, $A, $10, 0, 0
008969C6 180A 1800 18               		dc.b $18, $A, $18, 0, $18
008969CB 06                         @gap7:		dc.b 6
008969CC 1805 082A 18               		dc.b $18, 5, 8,	$2A, $18
008969D1 F803 0826 28               		dc.b $F8, 3, 8,	$26, $28
008969D6 F60A 0000 06               		dc.b $F6, $A, 0, 0, 6
008969DB F60A 0800 1E               		dc.b $F6, $A, 8, 0, $1E
008969E0 0E0A 1000 06               		dc.b $E, $A, $10, 0, 6
008969E5 0E0A 1800 1E               		dc.b $E, $A, $18, 0, $1E
008969EA 06                         @gap8:		dc.b 6
008969EB E805 0822 20               		dc.b $E8, 5, 8,	$22, $20
008969F0 0805 1822 20               		dc.b 8,	5, $18,	$22, $20
008969F5 E80A 0000 08               		dc.b $E8, $A, 0, 0, 8
008969FA E80A 0800 20               		dc.b $E8, $A, 8, 0, $20
008969FF 000A 1000 08               		dc.b 0,	$A, $10, 0, 8
00896A04 000A 1800 20               		dc.b 0,	$A, $18, 0, $20
00896A09 06                         @gap9:		dc.b 6
00896A0A D805 182A 18               		dc.b $D8, 5, $18, $2A, $18
00896A0F E803 1826 28               		dc.b $E8, 3, $18, $26, $28
00896A14 DA0A 0000 06               		dc.b $DA, $A, 0, 0, 6
00896A19 DA0A 0800 1E               		dc.b $DA, $A, 8, 0, $1E
00896A1E F20A 1000 06               		dc.b $F2, $A, $10, 0, 6
00896A23 F20A 1800 1E               		dc.b $F2, $A, $18, 0, $1E
00896A28 06                         @gapA:		dc.b 6
00896A29 D009 1834 00               		dc.b $D0, 9, $18, $34, 0
00896A2E E806 182E 20               		dc.b $E8, 6, $18, $2E, $20
00896A33 D00A 0000 00               		dc.b $D0, $A, 0, 0, 0
00896A38 D00A 0800 18               		dc.b $D0, $A, 8, 0, $18
00896A3D E80A 1000 00               		dc.b $E8, $A, $10, 0, 0
00896A42 E80A 1800 18               		dc.b $E8, $A, $18, 0, $18
00896A47 06                         @gapB:		dc.b 6
00896A48 D008 1842 F8               		dc.b $D0, 8, $18, $42, $F8
00896A4D D807 183A 18               		dc.b $D8, 7, $18, $3A, $18
00896A52 CA0A 0000 F6               		dc.b $CA, $A, 0, 0, $F6
00896A57 CA0A 0800 0E               		dc.b $CA, $A, 8, 0, $E
00896A5C E20A 1000 F6               		dc.b $E2, $A, $10, 0, $F6
00896A61 E20A 1800 0E               		dc.b $E2, $A, $18, 0, $E
00896A66 06                         @gapC:		dc.b 6
00896A67 D005 1045 E8               		dc.b $D0, 5, $10, $45, $E8
00896A6C D005 1845 08               		dc.b $D0, 5, $18, $45, 8
00896A71 C80A 0000 E8               		dc.b $C8, $A, 0, 0, $E8
00896A76 C80A 0800 00               		dc.b $C8, $A, 8, 0, 0
00896A7B E00A 1000 E8               		dc.b $E0, $A, $10, 0, $E8
00896A80 E00A 1800 00               		dc.b $E0, $A, $18, 0, 0
00896A85 06                         @gapD:		dc.b 6
00896A86 D807 103A D8               		dc.b $D8, 7, $10, $3A, $D8
00896A8B D008 1042 F0               		dc.b $D0, 8, $10, $42, $F0
00896A90 CA0A 0000 DA               		dc.b $CA, $A, 0, 0, $DA
00896A95 CA0A 0800 F2               		dc.b $CA, $A, 8, 0, $F2
00896A9A E20A 1000 DA               		dc.b $E2, $A, $10, 0, $DA
00896A9F E20A 1800 F2               		dc.b $E2, $A, $18, 0, $F2
00896AA4 06                         @gapE:		dc.b 6
00896AA5 E806 102E D0               		dc.b $E8, 6, $10, $2E, $D0
00896AAA D009 1034 E8               		dc.b $D0, 9, $10, $34, $E8
00896AAF D00A 0000 D0               		dc.b $D0, $A, 0, 0, $D0
00896AB4 D00A 0800 E8               		dc.b $D0, $A, 8, 0, $E8
00896AB9 E80A 1000 D0               		dc.b $E8, $A, $10, 0, $D0
00896ABE E80A 1800 E8               		dc.b $E8, $A, $18, 0, $E8
00896AC3 06                         @gapF:		dc.b 6
00896AC4 E803 1026 D0               		dc.b $E8, 3, $10, $26, $D0
00896AC9 D805 102A D8               		dc.b $D8, 5, $10, $2A, $D8
00896ACE DA0A 0000 CA               		dc.b $DA, $A, 0, 0, $CA
00896AD3 DA0A 0800 E2               		dc.b $DA, $A, 8, 0, $E2
00896AD8 F20A 1000 CA               		dc.b $F2, $A, $10, 0, $CA
00896ADD F20A 1800 E2               		dc.b $F2, $A, $18, 0, $E2
00896AE2 0C                         @circle:	dc.b $C
00896AE3 C80D 0009 E0               		dc.b $C8, $D, 0, 9, $E0
00896AE8 D00A 0011 D0               		dc.b $D0, $A, 0, $11, $D0
00896AED E007 001A C8               		dc.b $E0, 7, 0,	$1A, $C8
00896AF2 C80D 0809 00               		dc.b $C8, $D, 8, 9, 0
00896AF7 D00A 0811 18               		dc.b $D0, $A, 8, $11, $18
00896AFC E007 081A 28               		dc.b $E0, 7, 8,	$1A, $28
00896B01 0007 101A C8               		dc.b 0,	7, $10,	$1A, $C8
00896B06 180A 1011 D0               		dc.b $18, $A, $10, $11,	$D0
00896B0B 280D 1009 E0               		dc.b $28, $D, $10, 9, $E0
00896B10 280D 1809 00               		dc.b $28, $D, $18, 9, 0
00896B15 180A 1811 18               		dc.b $18, $A, $18, $11,	$18
00896B1A 0007 181A 28               		dc.b 0,	7, $18,	$1A, $28
00896B20 00                         		even
00896B20 00                         		even
00896B20                            		include	"_incObj\67 Running Disc.asm"
00896B20                            ; ---------------------------------------------------------------------------
00896B20                            ; Object 67 - disc that	you run	around (SBZ)
00896B20                            ; ---------------------------------------------------------------------------
00896B20                            
00896B20                            RunningDisc:				; XREF: Obj_Index
00896B20 7000                       		moveq	#0,d0
00896B22 1028 0024                  		move.b	obRoutine(a0),d0
00896B26 323B 0000                  		move.w	Disc_Index(pc,d0.w),d1
00896B2A 4EFB 1000                  		jmp	Disc_Index(pc,d1.w)
00896B2E                            ; ===========================================================================
00896B2E 0000                       Disc_Index:	dc.w Disc_Main-Disc_Index
00896B30 0000                       		dc.w Disc_Action-Disc_Index
00896B32                            
00896B32 =00000032                  disc_origX:	= $32		; original x-axis position
00896B32 =00000030                  disc_origY:	= $30		; original y-axis position
00896B32                            ; ===========================================================================
00896B32                            
00896B32                            Disc_Main:	; Routine 0
00896B32 5428 0024                  		addq.b	#2,obRoutine(a0)
00896B36 217C 0000 0000 0004        		move.l	#Map_Disc,obMap(a0)
00896B3E 317C C344 0002             		move.w	#$C344,obGfx(a0)
00896B44 117C 0004 0001             		move.b	#4,obRender(a0)
00896B4A 117C 0004 0018             		move.b	#4,obPriority(a0)
00896B50 117C 0008 0019             		move.b	#8,obActWid(a0)
00896B56 3168 0008 0032             		move.w	obX(a0),disc_origX(a0)
00896B5C 3168 000C 0030             		move.w	obY(a0),disc_origY(a0)
00896B62 117C 0018 0034             		move.b	#$18,$34(a0)
00896B68 117C 0048 0038             		move.b	#$48,$38(a0)
00896B6E 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00896B72 0201 000F                  		andi.b	#$F,d1		; read only the	2nd digit
00896B76 6700                       		beq.s	@typeis0	; branch if 0
00896B78 117C 0010 0034             		move.b	#$10,$34(a0)
00896B7E 117C 0038 0038             		move.b	#$38,$38(a0)
00896B84                            
00896B84                            	@typeis0:
00896B84 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00896B88 0201 00F0                  		andi.b	#$F0,d1		; read only the	1st digit
00896B8C 4881                       		ext.w	d1
00896B8E E741                       		asl.w	#3,d1
00896B90 3141 0036                  		move.w	d1,$36(a0)
00896B94 1028 0022                  		move.b	obStatus(a0),d0
00896B98 E418                       		ror.b	#2,d0
00896B9A 0200 00C0                  		andi.b	#$C0,d0
00896B9E 1140 0026                  		move.b	d0,obAngle(a0)
00896BA2                            
00896BA2                            Disc_Action:	; Routine 2
00896BA2 6100 0000                  		bsr.w	Disc_MoveSonic
00896BA6 6100 0000                  		bsr.w	Disc_MoveSpot
00896BAA 6000 0000                  		bra.w	Disc_ChkDel
00896BAE                            ; ===========================================================================
00896BAE                            
00896BAE                            Disc_MoveSonic:
00896BAE 7400                       		moveq	#0,d2
00896BB0 1428 0038                  		move.b	$38(a0),d2
00896BB4 3602                       		move.w	d2,d3
00896BB6 D643                       		add.w	d3,d3
00896BB8 43F8 D000                  		lea	(v_player).w,a1
00896BBC 3029 0008                  		move.w	obX(a1),d0
00896BC0 9068 0032                  		sub.w	disc_origX(a0),d0
00896BC4 D042                       		add.w	d2,d0
00896BC6 B043                       		cmp.w	d3,d0
00896BC8 6400                       		bcc.s	loc_155A8
00896BCA 3229 000C                  		move.w	obY(a1),d1
00896BCE 9268 0030                  		sub.w	disc_origY(a0),d1
00896BD2 D242                       		add.w	d2,d1
00896BD4 B243                       		cmp.w	d3,d1
00896BD6 6400                       		bcc.s	loc_155A8
00896BD8 0829 0001 0022             		btst	#1,obStatus(a1)
00896BDE 6700                       		beq.s	loc_155B8
00896BE0 4228 003A                  		clr.b	$3A(a0)
00896BE4 4E75                       		rts	
00896BE6                            ; ===========================================================================
00896BE6                            
00896BE6                            loc_155A8:
00896BE6 4A28 003A                  		tst.b	$3A(a0)
00896BEA 6700                       		beq.s	locret_155B6
00896BEC 4229 0038                  		clr.b	$38(a1)
00896BF0 4228 003A                  		clr.b	$3A(a0)
00896BF4                            
00896BF4                            locret_155B6:
00896BF4 4E75                       		rts	
00896BF6                            ; ===========================================================================
00896BF6                            
00896BF6                            loc_155B8:
00896BF6 4A28 003A                  		tst.b	$3A(a0)
00896BFA 6600                       		bne.s	loc_155E2
00896BFC 117C 0001 003A             		move.b	#1,$3A(a0)
00896C02 0829 0002 0022             		btst	#2,obStatus(a1)
00896C08 6600                       		bne.s	loc_155D0
00896C0A 4229 001C                  		clr.b	obAnim(a1)
00896C0E                            
00896C0E                            loc_155D0:
00896C0E 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
00896C14 137C 0001 001D             		move.b	#1,obNextAni(a1)
00896C1A 137C 0001 0038             		move.b	#1,$38(a1)
00896C20                            
00896C20                            loc_155E2:
00896C20 3029 0014                  		move.w	obInertia(a1),d0
00896C24 4A68 0036                  		tst.w	$36(a0)
00896C28 6A00                       		bpl.s	loc_15608
00896C2A 0C40 FC00                  		cmpi.w	#-$400,d0
00896C2E 6F00                       		ble.s	loc_155FA
00896C30 337C FC00 0014             		move.w	#-$400,obInertia(a1)
00896C36 4E75                       		rts	
00896C38                            ; ===========================================================================
00896C38                            
00896C38                            loc_155FA:
00896C38 0C40 F100                  		cmpi.w	#-$F00,d0
00896C3C 6C00                       		bge.s	locret_15606
00896C3E 337C F100 0014             		move.w	#-$F00,obInertia(a1)
00896C44                            
00896C44                            locret_15606:
00896C44 4E75                       		rts	
00896C46                            ; ===========================================================================
00896C46                            
00896C46                            loc_15608:
00896C46 0C40 0400                  		cmpi.w	#$400,d0
00896C4A 6C00                       		bge.s	loc_15616
00896C4C 337C 0400 0014             		move.w	#$400,obInertia(a1)
00896C52 4E75                       		rts	
00896C54                            ; ===========================================================================
00896C54                            
00896C54                            loc_15616:
00896C54 0C40 0F00                  		cmpi.w	#$F00,d0
00896C58 6F00                       		ble.s	locret_15622
00896C5A 337C 0F00 0014             		move.w	#$F00,obInertia(a1)
00896C60                            
00896C60                            locret_15622:
00896C60 4E75                       		rts	
00896C62                            ; ===========================================================================
00896C62                            
00896C62                            Disc_MoveSpot:				; XREF: Disc_Action
00896C62 3028 0036                  		move.w	$36(a0),d0
00896C66 D168 0026                  		add.w	d0,obAngle(a0)
00896C6A 1028 0026                  		move.b	obAngle(a0),d0
00896C6E 4EB9 0088 301C             		jsr	(CalcSine).l
00896C74 3428 0030                  		move.w	disc_origY(a0),d2
00896C78 3628 0032                  		move.w	disc_origX(a0),d3
00896C7C 7800                       		moveq	#0,d4
00896C7E 1828 0034                  		move.b	$34(a0),d4
00896C82 E14C                       		lsl.w	#8,d4
00896C84 2A04                       		move.l	d4,d5
00896C86 C9C0                       		muls.w	d0,d4
00896C88 4844                       		swap	d4
00896C8A CBC1                       		muls.w	d1,d5
00896C8C 4845                       		swap	d5
00896C8E D842                       		add.w	d2,d4
00896C90 DA43                       		add.w	d3,d5
00896C92 3144 000C                  		move.w	d4,obY(a0)
00896C96 3145 0008                  		move.w	d5,obX(a0)
00896C9A 4E75                       		rts	
00896C9C                            ; ===========================================================================
00896C9C                            
00896C9C                            Disc_ChkDel:				; XREF: Disc_Action
00896CB8 4EF9 0088 E3CC             		jmp	DisplaySprite
00896CBE                            
00896CBE                            	@delete:
00896CBE 4EF9 0088 E408             		jmp	DeleteObject
00896CBE 4EF9 0088 E408             		jmp	DeleteObject
00896CC4                            		include	"_maps\Running Disc.asm"
00896CC4                            ; ---------------------------------------------------------------------------
00896CC4                            ; Sprite mappings - disc that you run around (SBZ)
00896CC4                            ; (It's just a small blob that moves around in a circle. The disc itself is
00896CC4                            ; part of the level tiles.)
00896CC4                            ; ---------------------------------------------------------------------------
00896CC4 0000                       Map_Disc:	dc.w @spot-Map_Disc
00896CC6 01                         @spot:		dc.b 1
00896CC7 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
00896CCC                            		even
00896CCC                            		even
00896CCC                            		include	"_incObj\68 Conveyor Belt.asm"
00896CCC                            ; ---------------------------------------------------------------------------
00896CCC                            ; Object 68 - conveyor belts (SBZ)
00896CCC                            ; ---------------------------------------------------------------------------
00896CCC                            
00896CCC                            Conveyor:				; XREF: Obj_Index
00896CCC 7000                       		moveq	#0,d0
00896CCE 1028 0024                  		move.b	obRoutine(a0),d0
00896CD2 323B 0000                  		move.w	Conv_Index(pc,d0.w),d1
00896CD6 4EFB 1000                  		jmp	Conv_Index(pc,d1.w)
00896CDA                            ; ===========================================================================
00896CDA 0000                       Conv_Index:	dc.w Conv_Main-Conv_Index
00896CDC 0000                       		dc.w Conv_Action-Conv_Index
00896CDE                            
00896CDE =00000036                  conv_speed:	= $36
00896CDE =00000038                  conv_width:	= $38
00896CDE                            ; ===========================================================================
00896CDE                            
00896CDE                            Conv_Main:	; Routine 0
00896CDE 5428 0024                  		addq.b	#2,obRoutine(a0)
00896CE2 117C 0080 0038             		move.b	#128,conv_width(a0) ; set width to 128 pixels
00896CE8 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00896CEC 0201 000F                  		andi.b	#$F,d1		; read only the	2nd digit
00896CF0 6700                       		beq.s	@typeis0	; if zero, branch
00896CF2 117C 0038 0038             		move.b	#56,conv_width(a0) ; set width to 56 pixels
00896CF8                            
00896CF8                            	@typeis0:
00896CF8 1228 0028                  		move.b	obSubtype(a0),d1 ; get object type
00896CFC 0201 00F0                  		andi.b	#$F0,d1		; read only the	1st digit
00896D00 4881                       		ext.w	d1
00896D02 E841                       		asr.w	#4,d1
00896D04 3141 0036                  		move.w	d1,conv_speed(a0) ; set belt speed
00896D08                            
00896D08                            Conv_Action:	; Routine 2
00896D08 6100                       		bsr.s	@movesonic
00896D26 4E75                       		rts	
00896D28                            
00896D28                            	@delete:
00896D28 4EF9 0088 E408             		jmp	DeleteObject
00896D2E                            ; ===========================================================================
00896D2E                            
00896D2E                            @movesonic:
00896D2E 7400                       		moveq	#0,d2
00896D30 1428 0038                  		move.b	conv_width(a0),d2
00896D34 3602                       		move.w	d2,d3
00896D36 D643                       		add.w	d3,d3
00896D38 43F8 D000                  		lea	(v_player).w,a1
00896D3C 3029 0008                  		move.w	obX(a1),d0
00896D40 9068 0008                  		sub.w	obX(a0),d0
00896D44 D042                       		add.w	d2,d0
00896D46 B043                       		cmp.w	d3,d0
00896D48 6400                       		bcc.s	@notonconveyor
00896D4A 3229 000C                  		move.w	obY(a1),d1
00896D4E 9268 000C                  		sub.w	obY(a0),d1
00896D52 0641 0030                  		addi.w	#$30,d1
00896D56 0C41 0030                  		cmpi.w	#$30,d1
00896D5A 6400                       		bcc.s	@notonconveyor
00896D5C 0829 0001 0022             		btst	#1,obStatus(a1)
00896D62 6600                       		bne.s	@notonconveyor
00896D64 3028 0036                  		move.w	conv_speed(a0),d0
00896D68 D169 0008                  		add.w	d0,obX(a1)
00896D6C                            
00896D6C                            	@notonconveyor:
00896D6C 4E75                       		rts	
00896D6C 4E75                       		rts	
00896D6E                            		include	"_incObj\69 SBZ Spinning Platforms.asm"
00896D6E                            ; ---------------------------------------------------------------------------
00896D6E                            ; Object 69 - spinning platforms and trapdoors (SBZ)
00896D6E                            ; ---------------------------------------------------------------------------
00896D6E                            
00896D6E                            SpinPlatform:				; XREF: Obj_Index
00896D6E 7000                       		moveq	#0,d0
00896D70 1028 0024                  		move.b	obRoutine(a0),d0
00896D74 323B 0000                  		move.w	Spin_Index(pc,d0.w),d1
00896D78 4EFB 1000                  		jmp	Spin_Index(pc,d1.w)
00896D7C                            ; ===========================================================================
00896D7C 0000                       Spin_Index:	dc.w Spin_Main-Spin_Index
00896D7E 0000                       		dc.w Spin_Trapdoor-Spin_Index
00896D80 0000                       		dc.w Spin_Spinner-Spin_Index
00896D82                            
00896D82 =00000030                  spin_timer:	= $30		; time counter until change
00896D82 =00000032                  spin_timelen:	= $32		; time between changes (general)
00896D82                            ; ===========================================================================
00896D82                            
00896D82                            Spin_Main:	; Routine 0
00896D82 5428 0024                  		addq.b	#2,obRoutine(a0)
00896D86 217C 0000 0000 0004        		move.l	#Map_Trap,obMap(a0)
00896D8E 317C 4492 0002             		move.w	#$4492,obGfx(a0)
00896D94 0028 0004 0001             		ori.b	#4,obRender(a0)
00896D9A 117C 0080 0019             		move.b	#$80,obActWid(a0)
00896DA0 7000                       		moveq	#0,d0
00896DA2 1028 0028                  		move.b	obSubtype(a0),d0
00896DA6 0240 000F                  		andi.w	#$F,d0
00896DAA C0FC 003C                  		mulu.w	#$3C,d0
00896DAE 3140 0032                  		move.w	d0,spin_timelen(a0)
00896DB2 4A28 0028                  		tst.b	obSubtype(a0)	; is subtype $8x?
00896DB6 6A00                       		bpl.s	Spin_Trapdoor	; if not, branch
00896DB8                            
00896DB8 5428 0024                  		addq.b	#2,obRoutine(a0) ; goto Spin_Spinner next
00896DBC 217C 0000 0000 0004        		move.l	#Map_Spin,obMap(a0)
00896DC4 317C 04DF 0002             		move.w	#$4DF,obGfx(a0)
00896DCA 117C 0010 0019             		move.b	#$10,obActWid(a0)
00896DD0 117C 0002 001C             		move.b	#2,obAnim(a0)
00896DD6 7000                       		moveq	#0,d0
00896DD8 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
00896DDC 3200                       		move.w	d0,d1
00896DDE 0240 000F                  		andi.w	#$F,d0		; read only the	2nd digit
00896DE2 C0FC 0006                  		mulu.w	#6,d0		; multiply by 6
00896DE6 3140 0030                  		move.w	d0,spin_timer(a0)
00896DEA 3140 0032                  		move.w	d0,spin_timelen(a0) ; set time delay
00896DEE 0241 0070                  		andi.w	#$70,d1
00896DF2 0641 0010                  		addi.w	#$10,d1
00896DF6 E549                       		lsl.w	#2,d1
00896DF8 5341                       		subq.w	#1,d1
00896DFA 3141 0036                  		move.w	d1,$36(a0)
00896DFE 6000                       		bra.s	Spin_Spinner
00896E00                            ; ===========================================================================
00896E00                            
00896E00                            Spin_Trapdoor:	; Routine 2
00896E00 5368 0030                  		subq.w	#1,spin_timer(a0) ; decrement timer
00896E04 6A00                       		bpl.s	@animate	; if time remains, branch
00896E06                            
00896E06 3168 0032 0030             		move.w	spin_timelen(a0),spin_timer(a0)
00896E0C 0868 0000 001C             		bchg	#0,obAnim(a0)
00896E12 4A28 0001                  		tst.b	obRender(a0)
00896E16 6A00                       		bpl.s	@animate
00896E22                            
00896E22                            	@animate:
00896E22 43F9 0000 0000             		lea	(Ani_Spin).l,a1
00896E28 4EB9 0088 B4B0             		jsr	AnimateSprite
00896E2E 4A28 001A                  		tst.b	obFrame(a0)	; is frame number 0 displayed?
00896E32 6600                       		bne.s	@notsolid	; if not, branch
00896E34 323C 004B                  		move.w	#$4B,d1
00896E38 343C 000C                  		move.w	#$C,d2
00896E3C 3602                       		move.w	d2,d3
00896E3E 5243                       		addq.w	#1,d3
00896E40 3828 0008                  		move.w	obX(a0),d4
00896E44 6100 9970                  		bsr.w	SolidObject
00896E48 6000 9642                  		bra.w	RememberState
00896E4C                            ; ===========================================================================
00896E4C                            
00896E4C                            @notsolid:
00896E4C 0828 0003 0022             		btst	#3,obStatus(a0) ; is Sonic standing on the trapdoor?
00896E52 6700                       		beq.s	@display	; if not, branch
00896E54 43F8 D000                  		lea	(v_player).w,a1
00896E58 08A9 0003 0022             		bclr	#3,obStatus(a1)
00896E5E 08A8 0003 0022             		bclr	#3,obStatus(a0)
00896E64 4228 0025                  		clr.b	obSolid(a0)
00896E68                            
00896E68                            	@display:
00896E68 6000 9622                  		bra.w	RememberState
00896E6C                            ; ===========================================================================
00896E6C                            
00896E6C                            Spin_Spinner:	; Routine 4
00896E6C 3038 FE04                  		move.w	(v_framecount).w,d0
00896E70 C068 0036                  		and.w	$36(a0),d0
00896E74 6600                       		bne.s	@delay
00896E76 117C 0001 0034             		move.b	#1,$34(a0)
00896E7C                            
00896E7C                            	@delay:
00896E7C 4A28 0034                  		tst.b	$34(a0)
00896E80 6700                       		beq.s	@animate
00896E82 5368 0030                  		subq.w	#1,spin_timer(a0)
00896E86 6A00                       		bpl.s	@animate
00896E88 3168 0032 0030             		move.w	spin_timelen(a0),spin_timer(a0)
00896E8E 4228 0034                  		clr.b	$34(a0)
00896E92 0868 0000 001C             		bchg	#0,obAnim(a0)
00896E98                            
00896E98                            	@animate:
00896E98 43F9 0000 0000             		lea	(Ani_Spin).l,a1
00896E9E 4EB9 0088 B4B0             		jsr	AnimateSprite
00896EA4 4A28 001A                  		tst.b	obFrame(a0)	; check	if frame number	0 is displayed
00896EA8 6600                       		bne.s	@notsolid2	; if not, branch
00896EAA 323C 001B                  		move.w	#$1B,d1
00896EAE 343C 0007                  		move.w	#7,d2
00896EB2 3602                       		move.w	d2,d3
00896EB4 5243                       		addq.w	#1,d3
00896EB6 3828 0008                  		move.w	obX(a0),d4
00896EBA 6100 98FA                  		bsr.w	SolidObject
00896EBE 6000 95CC                  		bra.w	RememberState
00896EC2                            ; ===========================================================================
00896EC2                            
00896EC2                            @notsolid2:
00896EC2 0828 0003 0022             		btst	#3,obStatus(a0)
00896EC8 6700                       		beq.s	@display
00896ECA 43F8 D000                  		lea	(v_player).w,a1
00896ECE 08A9 0003 0022             		bclr	#3,obStatus(a1)
00896ED4 08A8 0003 0022             		bclr	#3,obStatus(a0)
00896EDA 4228 0025                  		clr.b	obSolid(a0)
00896EDE                            
00896EDE                            	@display:
00896EDE 6000 95AC                  		bra.w	RememberState
00896EDE 6000 95AC                  		bra.w	RememberState
00896EE2                            		include	"_anim\SBZ Spinning Platforms.asm"
00896EE2                            ; ---------------------------------------------------------------------------
00896EE2                            ; Animation script - trapdoor (SBZ)
00896EE2                            ; ---------------------------------------------------------------------------
00896EE2 0000                       Ani_Spin:	dc.w @trapopen-Ani_Spin
00896EE4 0000                       		dc.w @trapclose-Ani_Spin
00896EE6 0000                       		dc.w @spin1-Ani_Spin
00896EE8 0000                       		dc.w @spin2-Ani_Spin
00896EEA 0300 0102 FE01             @trapopen:	dc.b 3,	0, 1, 2, afBack, 1
00896EF0 0302 0100 FE01             @trapclose:	dc.b 3,	2, 1, 0, afBack, 1
00896EF6 0100 0102 0304 4342 4140+  @spin1:		dc.b 1,	0, 1, 2, 3, 4, $43, $42, $41, $40, $61,	$62, $63, $64, $23, $22, $21, 0, afBack, 1
00896F0A 0100 0102 0304 4342 4140+  @spin2:		dc.b 1,	0, 1, 2, 3, 4, $43, $42, $41, $40, $61,	$62, $63, $64, $23, $22, $21, 0, afBack, 1
00896F1E                            		even
00896F1E                            		even
00896F1E                            		include	"_maps\Trapdoor.asm"
00896F1E                            ; ---------------------------------------------------------------------------
00896F1E                            ; Sprite mappings - trapdoor (SBZ)
00896F1E                            ; ---------------------------------------------------------------------------
00896F1E 0000                       Map_Trap:	dc.w @closed-Map_Trap
00896F20 0000                       		dc.w @half-Map_Trap
00896F22 0000                       		dc.w @open-Map_Trap
00896F24 04                         @closed:	dc.b 4
00896F25 F40E 0000 C0               		dc.b $F4, $E, 0, 0, $C0
00896F2A F40E 0800 E0               		dc.b $F4, $E, 8, 0, $E0
00896F2F F40E 0000 00               		dc.b $F4, $E, 0, 0, 0
00896F34 F40E 0800 20               		dc.b $F4, $E, 8, 0, $20
00896F39 08                         @half:		dc.b 8
00896F3A F20F 000C B6               		dc.b $F2, $F, 0, $C, $B6
00896F3F 1A0F 180C D6               		dc.b $1A, $F, $18, $C, $D6
00896F44 020A 001C D6               		dc.b 2,	$A, 0, $1C, $D6
00896F49 120A 181C BE               		dc.b $12, $A, $18, $1C,	$BE
00896F4E F20F 080C 2A               		dc.b $F2, $F, 8, $C, $2A
00896F53 1A0F 100C 0A               		dc.b $1A, $F, $10, $C, $A
00896F58 020A 081C 12               		dc.b 2,	$A, 8, $1C, $12
00896F5D 120A 101C 2A               		dc.b $12, $A, $10, $1C,	$2A
00896F62 04                         @open:		dc.b 4
00896F63 000B 0025 B4               		dc.b 0,	$B, 0, $25, $B4
00896F68 200B 1025 B4               		dc.b $20, $B, $10, $25,	$B4
00896F6D 000B 0025 34               		dc.b 0,	$B, 0, $25, $34
00896F72 200B 1025 34               		dc.b $20, $B, $10, $25,	$34
00896F78 00                         		even
00896F78 00                         		even
00896F78                            		include	"_maps\SBZ Spinning Platforms.asm"
00896F78                            ; ---------------------------------------------------------------------------
00896F78                            ; Sprite mappings - spinning platforms (SBZ)
00896F78                            ; ---------------------------------------------------------------------------
00896F78 0000 0000                  Map_Spin:	dc.w @flat-Map_Spin, @spin1-Map_Spin
00896F7C 0000 0000                  		dc.w @spin2-Map_Spin, @spin3-Map_Spin
00896F80 0000                       		dc.w @spin4-Map_Spin
00896F82 02                         @flat:		dc.b 2
00896F83 F805 0000 F0               		dc.b $F8, 5, 0,	0, $F0
00896F88 F805 0800 00               		dc.b $F8, 5, 8,	0, 0
00896F8D 02                         @spin1:		dc.b 2
00896F8E F00D 0014 F0               		dc.b $F0, $D, 0, $14, $F0
00896F93 000D 001C F0               		dc.b 0,	$D, 0, $1C, $F0
00896F98 02                         @spin2:		dc.b 2
00896F99 F009 0004 F0               		dc.b $F0, 9, 0,	4, $F0
00896F9E 0009 000A F8               		dc.b 0,	9, 0, $A, $F8
00896FA3 02                         @spin3:		dc.b 2
00896FA4 F009 0024 F0               		dc.b $F0, 9, 0,	$24, $F0
00896FA9 0009 002A F8               		dc.b 0,	9, 0, $2A, $F8
00896FAE 02                         @spin4:		dc.b 2
00896FAF F005 0010 F8               		dc.b $F0, 5, 0,	$10, $F8
00896FB4 0005 1010 F8               		dc.b 0,	5, $10,	$10, $F8
00896FBA 00                         		even
00896FBA 00                         		even
00896FBA                            		include	"_incObj\6A Saws and Pizza Cutters.asm"
00896FBA                            ; ---------------------------------------------------------------------------
00896FBA                            ; Object 6A - ground saws and pizza cutters (SBZ)
00896FBA                            ; ---------------------------------------------------------------------------
00896FBA                            
00896FBA                            Saws:					; XREF: Obj_Index
00896FBA 7000                       		moveq	#0,d0
00896FBC 1028 0024                  		move.b	obRoutine(a0),d0
00896FC0 323B 0000                  		move.w	Saw_Index(pc,d0.w),d1
00896FC4 4EFB 1000                  		jmp	Saw_Index(pc,d1.w)
00896FC8                            ; ===========================================================================
00896FC8 0000                       Saw_Index:	dc.w Saw_Main-Saw_Index
00896FCA 0000                       		dc.w Saw_Action-Saw_Index
00896FCC                            
00896FCC =0000003A                  saw_origX:	= $3A		; original x-axis position
00896FCC =00000038                  saw_origY:	= $38		; original y-axis position
00896FCC =0000003D                  saw_here:	= $3D		; flag set when the ground saw appears
00896FCC                            ; ===========================================================================
00896FCC                            
00896FCC                            Saw_Main:	; Routine 0
00896FCC 5428 0024                  		addq.b	#2,obRoutine(a0)
00896FD0 217C 0000 0000 0004        		move.l	#Map_Saw,obMap(a0)
00896FD8 317C 43B5 0002             		move.w	#$43B5,obGfx(a0)
00896FDE 117C 0004 0001             		move.b	#4,obRender(a0)
00896FE4 117C 0004 0018             		move.b	#4,obPriority(a0)
00896FEA 117C 0020 0019             		move.b	#$20,obActWid(a0)
00896FF0 3168 0008 003A             		move.w	obX(a0),saw_origX(a0)
00896FF6 3168 000C 0038             		move.w	obY(a0),saw_origY(a0)
00896FFC 0C28 0003 0028             		cmpi.b	#3,obSubtype(a0) ; is object a ground saw?
00897002 6400                       		bcc.s	Saw_Action	; if yes, branch
00897004 117C 00A2 0020             		move.b	#$A2,obColType(a0)
0089700A                            
0089700A                            Saw_Action:	; Routine 2
0089700A 7000                       		moveq	#0,d0
0089700C 1028 0028                  		move.b	obSubtype(a0),d0
00897010 0240 0007                  		andi.w	#7,d0
00897014 D040                       		add.w	d0,d0
00897016 323B 0000                  		move.w	@index(pc,d0.w),d1
0089701A 4EBB 1000                  		jsr	@index(pc,d1.w)
0089703A 4EF9 0088 E3CC             		jmp	DisplaySprite
00897040                            
00897040                            	@delete:
00897040 4EF9 0088 E408             		jmp	DeleteObject
00897046                            ; ===========================================================================
00897046 0000 0000 0000             @index:		dc.w @type00-@index, @type01-@index, @type02-@index ; pizza cutters
0089704C 0000 0000                  		dc.w @type03-@index, @type04-@index ; ground saws
00897050                            ; ===========================================================================
00897050                            
00897050                            @type00:				; XREF: @index
00897050 4E75                       		rts			; doesn't move
00897052                            ; ===========================================================================
00897052                            
00897052                            @type01:				; XREF: @index
00897052 323C 0060                  		move.w	#$60,d1
00897056 7000                       		moveq	#0,d0
00897058 1038 FE6C                  		move.b	(v_oscillate+$E).w,d0
0089705C 0828 0000 0022             		btst	#0,obStatus(a0)
00897062 6700                       		beq.s	@noflip01
00897064 4440                       		neg.w	d0
00897066 D041                       		add.w	d1,d0
00897068                            
00897068                            	@noflip01:
00897068 3228 003A                  		move.w	saw_origX(a0),d1
0089706C 9240                       		sub.w	d0,d1
0089706E 3141 0008                  		move.w	d1,obX(a0)	; move saw sideways
00897072                            
00897072 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00897076 6A00                       		bpl.s	@sameframe01
00897078 117C 0002 001E             		move.b	#2,obTimeFrame(a0) ; time between frame changes
0089707E 0868 0000 001A             		bchg	#0,obFrame(a0)	; change frame
00897084                            
00897084                            	@sameframe01:
00897084 4A28 0001                  		tst.b	obRender(a0)
00897088 6A00                       		bpl.s	@nosound01
0089708A 3038 FE04                  		move.w	(v_framecount).w,d0
0089708E 0240 000F                  		andi.w	#$F,d0
00897092 6600                       		bne.s	@nosound01
0089709E                            
0089709E                            	@nosound01:
0089709E 4E75                       		rts	
008970A0                            ; ===========================================================================
008970A0                            
008970A0                            @type02:				; XREF: @index
008970A0 323C 0030                  		move.w	#$30,d1
008970A4 7000                       		moveq	#0,d0
008970A6 1038 FE64                  		move.b	(v_oscillate+6).w,d0
008970AA 0828 0000 0022             		btst	#0,obStatus(a0)
008970B0 6700                       		beq.s	@noflip02
008970B2 4440                       		neg.w	d0
008970B4 0640 0080                  		addi.w	#$80,d0
008970B8                            
008970B8                            	@noflip02:
008970B8 3228 0038                  		move.w	saw_origY(a0),d1
008970BC 9240                       		sub.w	d0,d1
008970BE 3141 000C                  		move.w	d1,obY(a0)	; move saw vertically
008970C2 5328 001E                  		subq.b	#1,obTimeFrame(a0)
008970C6 6A00                       		bpl.s	@sameframe02
008970C8 117C 0002 001E             		move.b	#2,obTimeFrame(a0)
008970CE 0868 0000 001A             		bchg	#0,obFrame(a0)
008970D4                            
008970D4                            	@sameframe02:
008970D4 4A28 0001                  		tst.b	obRender(a0)
008970D8 6A00                       		bpl.s	@nosound02
008970DA 1038 FE64                  		move.b	(v_oscillate+6).w,d0
008970DE 0C00 0018                  		cmpi.b	#$18,d0
008970E2 6600                       		bne.s	@nosound02
008970EE                            
008970EE                            	@nosound02:
008970EE 4E75                       		rts	
008970F0                            ; ===========================================================================
008970F0                            
008970F0                            @type03:				; XREF: @index
008970F0 4A28 003D                  		tst.b	saw_here(a0)	; has the saw appeared already?
008970F4 6600                       		bne.s	@here03		; if yes, branch
008970F6                            
008970F6 3038 D008                  		move.w	(v_player+obX).w,d0
008970FA 0440 00C0                  		subi.w	#$C0,d0
008970FE 6500                       		bcs.s	@nosaw03x
00897100 9068 0008                  		sub.w	obX(a0),d0
00897104 6500                       		bcs.s	@nosaw03x
00897106 3038 D00C                  		move.w	(v_player+obY).w,d0
0089710A 0440 0080                  		subi.w	#$80,d0
0089710E B068 000C                  		cmp.w	obY(a0),d0
00897112 6400                       		bcc.s	@nosaw03y
00897114 0640 0100                  		addi.w	#$100,d0
00897118 B068 000C                  		cmp.w	obY(a0),d0
0089711C 6500                       		bcs.s	@nosaw03y
0089711E 117C 0001 003D             		move.b	#1,saw_here(a0)
00897124 317C 0600 0010             		move.w	#$600,obVelX(a0) ; move object to the right
0089712A 117C 00A2 0020             		move.b	#$A2,obColType(a0)
00897130 117C 0002 001A             		move.b	#2,obFrame(a0)
00897140                            
00897140                            	@nosaw03x:
00897140 588F                       		addq.l	#4,sp
00897142                            
00897142                            	@nosaw03y:
00897142 4E75                       		rts	
00897144                            ; ===========================================================================
00897144                            
00897144                            @here03:
00897144 4EB9 0088 E3B2             		jsr	ObjectMove
0089714A 3168 0008 003A             		move.w	obX(a0),saw_origX(a0)
00897150 5328 001E                  		subq.b	#1,obTimeFrame(a0)
00897154 6A00                       		bpl.s	@sameframe03
00897156 117C 0002 001E             		move.b	#2,obTimeFrame(a0)
0089715C 0868 0000 001A             		bchg	#0,obFrame(a0)
00897162                            
00897162                            	@sameframe03:
00897162 4E75                       		rts	
00897164                            ; ===========================================================================
00897164                            
00897164                            @type04:				; XREF: @index
00897164 4A28 003D                  		tst.b	saw_here(a0)
00897168 6600                       		bne.s	@here04
0089716A 3038 D008                  		move.w	(v_player+obX).w,d0
0089716E 0640 00E0                  		addi.w	#$E0,d0
00897172 9068 0008                  		sub.w	obX(a0),d0
00897176 6400                       		bcc.s	@nosaw04x
00897178 3038 D00C                  		move.w	(v_player+obY).w,d0
0089717C 0440 0080                  		subi.w	#$80,d0
00897180 B068 000C                  		cmp.w	obY(a0),d0
00897184 6400                       		bcc.s	@nosaw04y
00897186 0640 0100                  		addi.w	#$100,d0
0089718A B068 000C                  		cmp.w	obY(a0),d0
0089718E 6500                       		bcs.s	@nosaw04y
00897190 117C 0001 003D             		move.b	#1,saw_here(a0)
00897196 317C FA00 0010             		move.w	#-$600,obVelX(a0) ; move object to the left
0089719C 117C 00A2 0020             		move.b	#$A2,obColType(a0)
008971A2 117C 0002 001A             		move.b	#2,obFrame(a0)
008971B2                            
008971B2                            	@nosaw04x:
008971B2 588F                       		addq.l	#4,sp
008971B4                            
008971B4                            	@nosaw04y:
008971B4 4E75                       		rts	
008971B6                            ; ===========================================================================
008971B6                            
008971B6                            @here04:
008971B6 4EB9 0088 E3B2             		jsr	ObjectMove
008971BC 3168 0008 003A             		move.w	obX(a0),saw_origX(a0)
008971C2 5328 001E                  		subq.b	#1,obTimeFrame(a0)
008971C6 6A00                       		bpl.s	@sameframe04
008971C8 117C 0002 001E             		move.b	#2,obTimeFrame(a0)
008971CE 0868 0000 001A             		bchg	#0,obFrame(a0)
008971D4                            
008971D4                            	@sameframe04:
008971D4 4E75                       		rts	
008971D4 4E75                       		rts	
008971D6                            		include	"_maps\Saws and Pizza Cutters.asm"
008971D6                            ; ---------------------------------------------------------------------------
008971D6                            ; Sprite mappings - ground saws	and pizza cutters (SBZ)
008971D6                            ; ---------------------------------------------------------------------------
008971D6 0000 0000                  Map_Saw:	dc.w @pizzacutter1-Map_Saw, @pizzacutter2-Map_Saw
008971DA 0000 0000                  		dc.w @groundsaw1-Map_Saw, @groundsaw2-Map_Saw
008971DE 07                         @pizzacutter1:	dc.b 7
008971DF C401 0020 FC               		dc.b $C4, 1, 0,	$20, $FC
008971E4 D401 0020 FC               		dc.b $D4, 1, 0,	$20, $FC
008971E9 E403 0020 FC               		dc.b $E4, 3, 0,	$20, $FC
008971EE E00F 0000 E0               		dc.b $E0, $F, 0, 0, $E0
008971F3 E00F 0800 00               		dc.b $E0, $F, 8, 0, 0
008971F8 000F 1000 E0               		dc.b 0,	$F, $10, 0, $E0
008971FD 000F 1800 00               		dc.b 0,	$F, $18, 0, 0
00897202 07                         @pizzacutter2:	dc.b 7
00897203 C401 0020 FC               		dc.b $C4, 1, 0,	$20, $FC
00897208 D401 0020 FC               		dc.b $D4, 1, 0,	$20, $FC
0089720D E403 0020 FC               		dc.b $E4, 3, 0,	$20, $FC
00897212 E00F 0010 E0               		dc.b $E0, $F, 0, $10, $E0
00897217 E00F 0810 00               		dc.b $E0, $F, 8, $10, 0
0089721C 000F 1010 E0               		dc.b 0,	$F, $10, $10, $E0
00897221 000F 1810 00               		dc.b 0,	$F, $18, $10, 0
00897226 04                         @groundsaw1:	dc.b 4
00897227 E00F 0000 E0               		dc.b $E0, $F, 0, 0, $E0
0089722C E00F 0800 00               		dc.b $E0, $F, 8, 0, 0
00897231 000F 1000 E0               		dc.b 0,	$F, $10, 0, $E0
00897236 000F 1800 00               		dc.b 0,	$F, $18, 0, 0
0089723B 04                         @groundsaw2:	dc.b 4
0089723C E00F 0010 E0               		dc.b $E0, $F, 0, $10, $E0
00897241 E00F 0810 00               		dc.b $E0, $F, 8, $10, 0
00897246 000F 1010 E0               		dc.b 0,	$F, $10, $10, $E0
0089724B 000F 1810 00               		dc.b 0,	$F, $18, $10, 0
00897250                            		even
00897250                            		even
00897250                            		include	"_incObj\6B SBZ Stomper and Door.asm"
00897250                            ; ---------------------------------------------------------------------------
00897250                            ; Object 6B - stomper and sliding door (SBZ)
00897250                            ; ---------------------------------------------------------------------------
00897250                            
00897250                            ScrapStomp:				; XREF: Obj_Index
00897250 7000                       		moveq	#0,d0
00897252 1028 0024                  		move.b	obRoutine(a0),d0
00897256 323B 0000                  		move.w	Sto_Index(pc,d0.w),d1
0089725A 4EFB 1000                  		jmp	Sto_Index(pc,d1.w)
0089725E                            ; ===========================================================================
0089725E 0000                       Sto_Index:	dc.w Sto_Main-Sto_Index
00897260 0000                       		dc.w Sto_Action-Sto_Index
00897262                            
00897262 =00000016                  sto_height:	= $16
00897262 =00000034                  sto_origX:	= $34		; original x-axis position
00897262 =00000030                  sto_origY:	= $30		; original y-axis position
00897262 =00000038                  sto_active:	= $38		; flag set when a switch is pressed
00897262                            
00897262 400C 8001                  Sto_Var:	dc.b  $40,  $C,	$80,   1 ; width, height, ????,	type number
00897266 1C20 3803                  		dc.b  $1C, $20,	$38,   3
0089726A 1C20 4004                  		dc.b  $1C, $20,	$40,   4
0089726E 1C20 6004                  		dc.b  $1C, $20,	$60,   4
00897272 8040 0005                  		dc.b  $80, $40,	  0,   5
00897276                            ; ===========================================================================
00897276                            
00897276                            Sto_Main:	; Routine 0
00897276 5428 0024                  		addq.b	#2,obRoutine(a0)
0089727A 7000                       		moveq	#0,d0
0089727C 1028 0028                  		move.b	obSubtype(a0),d0
00897280 E448                       		lsr.w	#2,d0
00897282 0240 001C                  		andi.w	#$1C,d0
00897286 47FB 00DA                  		lea	Sto_Var(pc,d0.w),a3
0089728A 115B 0019                  		move.b	(a3)+,obActWid(a0)
0089728E 115B 0016                  		move.b	(a3)+,sto_height(a0)
00897292 E448                       		lsr.w	#2,d0
00897294 1140 001A                  		move.b	d0,obFrame(a0)
00897298 217C 0000 0000 0004        		move.l	#Map_Stomp,obMap(a0)
008972A0 317C 22C0 0002             		move.w	#$22C0,obGfx(a0)
008972A6 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w ; check if level is LZ/SBZ3
008972AC 6600                       		bne.s	@isSBZ12	; if not, branch
008972AE 08F8 0000 F7CB             		bset	#0,(v_obj6B).w
008972B4 6700                       		beq.s	@isSBZ3
008972B6                            
008972B6                            @chkdel:
008972B6 45F8 FC00                  		lea	(v_objstate).w,a2
008972BA 7000                       		moveq	#0,d0
008972BC 1028 0023                  		move.b	obRespawnNo(a0),d0
008972C0 6700                       		beq.s	@delete
008972C2 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
008972C8                            
008972C8                            	@delete:
008972C8 4EF9 0088 E408             		jmp	DeleteObject
008972CE                            ; ===========================================================================
008972CE                            
008972CE                            @isSBZ3:
008972CE 317C 41F0 0002             		move.w	#$41F0,obGfx(a0)
008972D4 0C68 0A80 0008             		cmpi.w	#$A80,obX(a0)
008972DA 6600                       		bne.s	@isSBZ12
008972DC 45F8 FC00                  		lea	(v_objstate).w,a2
008972E0 7000                       		moveq	#0,d0
008972E2 1028 0023                  		move.b	obRespawnNo(a0),d0
008972E6 6700                       		beq.s	@isSBZ12
008972E8 0832 0000 0002             		btst	#0,2(a2,d0.w)
008972EE 6700                       		beq.s	@isSBZ12
008972F0 4238 F7CB                  		clr.b	(v_obj6B).w
008972F4 60C0                       		bra.s	@chkdel
008972F6                            ; ===========================================================================
008972F6                            
008972F6                            @isSBZ12:
008972F6 0028 0004 0001             		ori.b	#4,obRender(a0)
008972FC 117C 0004 0018             		move.b	#4,obPriority(a0)
00897302 3168 0008 0034             		move.w	obX(a0),sto_origX(a0)
00897308 3168 000C 0030             		move.w	obY(a0),sto_origY(a0)
0089730E 7000                       		moveq	#0,d0
00897310 101B                       		move.b	(a3)+,d0
00897312 3140 003C                  		move.w	d0,$3C(a0)
00897316 7000                       		moveq	#0,d0
00897318 1028 0028                  		move.b	obSubtype(a0),d0
0089731C 6A00                       		bpl.s	Sto_Action
0089731E 0200 000F                  		andi.b	#$F,d0
00897322 1140 003E                  		move.b	d0,$3E(a0)
00897326 1153 0028                  		move.b	(a3),obSubtype(a0)
0089732A 0C13 0005                  		cmpi.b	#5,(a3)
0089732E 6600                       		bne.s	@chkgone
00897330 08E8 0004 0001             		bset	#4,obRender(a0)
00897336                            
00897336                            	@chkgone:
00897336 45F8 FC00                  		lea	(v_objstate).w,a2
0089733A 7000                       		moveq	#0,d0
0089733C 1028 0023                  		move.b	obRespawnNo(a0),d0
00897340 6700                       		beq.s	Sto_Action
00897342 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
00897348                            
00897348                            Sto_Action:	; Routine 2
00897348 3F28 0008                  		move.w	obX(a0),-(sp)
0089734C 7000                       		moveq	#0,d0
0089734E 1028 0028                  		move.b	obSubtype(a0),d0
00897352 0240 000F                  		andi.w	#$F,d0
00897356 D040                       		add.w	d0,d0
00897358 323B 0000                  		move.w	@index(pc,d0.w),d1
0089735C 4EBB 1000                  		jsr	@index(pc,d1.w)
00897360 381F                       		move.w	(sp)+,d4
00897362 4A28 0001                  		tst.b	obRender(a0)
00897366 6A00                       		bpl.s	@chkdel
00897368 7200                       		moveq	#0,d1
0089736A 1228 0019                  		move.b	obActWid(a0),d1
0089736E 0641 000B                  		addi.w	#$B,d1
00897372 7400                       		moveq	#0,d2
00897374 1428 0016                  		move.b	sto_height(a0),d2
00897378 3602                       		move.w	d2,d3
0089737A 5243                       		addq.w	#1,d3
0089737C 6100 9438                  		bsr.w	SolidObject
00897380                            
00897380                            	@chkdel:
0089739C 4EF9 0088 E3CC             		jmp	DisplaySprite
008973A2                            
008973A2                            	@chkgone:
008973A2 0C38 0001 FE10             		cmpi.b	#id_LZ,(v_zone).w
008973A8 6600                       		bne.s	@delete
008973AA 4238 F7CB                  		clr.b	(v_obj6B).w
008973AE 45F8 FC00                  		lea	(v_objstate).w,a2
008973B2 7000                       		moveq	#0,d0
008973B4 1028 0023                  		move.b	obRespawnNo(a0),d0
008973B8 6700                       		beq.s	@delete
008973BA 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
008973C0                            
008973C0                            	@delete:
008973C0 4EF9 0088 E408             		jmp	DeleteObject
008973C6                            ; ===========================================================================
008973C6 0000 0000                  @index:		dc.w @type00-@index, @type01-@index
008973CA 0000 0000                  		dc.w @type02-@index, @type03-@index
008973CE 0000 0000                  		dc.w @type04-@index, @type05-@index
008973D2                            ; ===========================================================================
008973D2                            
008973D2                            @type00:				; XREF: @index
008973D2 4E75                       		rts
008973D4                            ; ===========================================================================
008973D4                            
008973D4                            @type01:				; XREF: @index
008973D4 4A28 0038                  		tst.b	sto_active(a0)
008973D8 6600                       		bne.s	@isactive01
008973DA 45F8 F7E0                  		lea	(f_switch).w,a2
008973DE 7000                       		moveq	#0,d0
008973E0 1028 003E                  		move.b	$3E(a0),d0
008973E4 0832 0000 0000             		btst	#0,(a2,d0.w)
008973EA 6700                       		beq.s	@loc_15DC2
008973EC 117C 0001 0038             		move.b	#1,sto_active(a0)
008973F2                            
008973F2                            	@isactive01:
008973F2 3028 003C                  		move.w	$3C(a0),d0
008973F6 B068 003A                  		cmp.w	$3A(a0),d0
008973FA 6700                       		beq.s	@loc_15DE0
008973FC 5468 003A                  		addq.w	#2,$3A(a0)
00897400                            
00897400                            	@loc_15DC2:
00897400 3028 003A                  		move.w	$3A(a0),d0
00897404 0828 0000 0022             		btst	#0,obStatus(a0)
0089740A 6700                       		beq.s	@noflip01
0089740C 4440                       		neg.w	d0
0089740E 0640 0080                  		addi.w	#$80,d0
00897412                            
00897412                            	@noflip01:
00897412 3228 0034                  		move.w	sto_origX(a0),d1
00897416 9240                       		sub.w	d0,d1
00897418 3141 0008                  		move.w	d1,obX(a0)
0089741C 4E75                       		rts	
0089741E                            ; ===========================================================================
0089741E                            
0089741E                            @loc_15DE0:
0089741E 5228 0028                  		addq.b	#1,obSubtype(a0)
00897422 317C 00B4 0036             		move.w	#$B4,$36(a0)
00897428 4228 0038                  		clr.b	sto_active(a0)
0089742C 45F8 FC00                  		lea	(v_objstate).w,a2
00897430 7000                       		moveq	#0,d0
00897432 1028 0023                  		move.b	obRespawnNo(a0),d0
00897436 67C8                       		beq.s	@loc_15DC2
00897438 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0089743E 60C0                       		bra.s	@loc_15DC2
00897440                            ; ===========================================================================
00897440                            
00897440                            @type02:				; XREF: @index
00897440 4A28 0038                  		tst.b	sto_active(a0)
00897444 6600                       		bne.s	@isactive02
00897446 5368 0036                  		subq.w	#1,$36(a0)
0089744A 6600                       		bne.s	@loc_15E1E
0089744C 117C 0001 0038             		move.b	#1,sto_active(a0)
00897452                            
00897452                            	@isactive02:
00897452 4A68 003A                  		tst.w	$3A(a0)
00897456 6700                       		beq.s	@loc_15E3C
00897458 5568 003A                  		subq.w	#2,$3A(a0)
0089745C                            
0089745C                            	@loc_15E1E:
0089745C 3028 003A                  		move.w	$3A(a0),d0
00897460 0828 0000 0022             		btst	#0,obStatus(a0)
00897466 6700                       		beq.s	@noflip02
00897468 4440                       		neg.w	d0
0089746A 0640 0080                  		addi.w	#$80,d0
0089746E                            
0089746E                            	@noflip02:
0089746E 3228 0034                  		move.w	sto_origX(a0),d1
00897472 9240                       		sub.w	d0,d1
00897474 3141 0008                  		move.w	d1,obX(a0)
00897478 4E75                       		rts	
0089747A                            ; ===========================================================================
0089747A                            
0089747A                            @loc_15E3C:
0089747A 5328 0028                  		subq.b	#1,obSubtype(a0)
0089747E 4228 0038                  		clr.b	sto_active(a0)
00897482 45F8 FC00                  		lea	(v_objstate).w,a2
00897486 7000                       		moveq	#0,d0
00897488 1028 0023                  		move.b	obRespawnNo(a0),d0
0089748C 67CE                       		beq.s	@loc_15E1E
0089748E 08B2 0000 0002             		bclr	#0,2(a2,d0.w)
00897494 60C6                       		bra.s	@loc_15E1E
00897496                            ; ===========================================================================
00897496                            
00897496                            @type03:				; XREF: @index
00897496 4A28 0038                  		tst.b	sto_active(a0)
0089749A 6600                       		bne.s	@isactive03
0089749C 4A68 003A                  		tst.w	$3A(a0)
008974A0 6700                       		beq.s	@loc_15E6A
008974A2 5368 003A                  		subq.w	#1,$3A(a0)
008974A6 6000                       		bra.s	@loc_15E8E
008974A8                            ; ===========================================================================
008974A8                            
008974A8                            @loc_15E6A:
008974A8 5368 0036                  		subq.w	#1,$36(a0)
008974AC 6A00                       		bpl.s	@loc_15E8E
008974AE 317C 003C 0036             		move.w	#$3C,$36(a0)
008974B4 117C 0001 0038             		move.b	#1,sto_active(a0)
008974BA                            
008974BA                            @isactive03:
008974BA 5068 003A                  		addq.w	#8,$3A(a0)
008974BE 3028 003A                  		move.w	$3A(a0),d0
008974C2 B068 003C                  		cmp.w	$3C(a0),d0
008974C6 6600                       		bne.s	@loc_15E8E
008974C8 4228 0038                  		clr.b	sto_active(a0)
008974CC                            
008974CC                            @loc_15E8E:
008974CC 3028 003A                  		move.w	$3A(a0),d0
008974D0 0828 0000 0022             		btst	#0,obStatus(a0)
008974D6 6700                       		beq.s	@noflip03
008974D8 4440                       		neg.w	d0
008974DA 0640 0038                  		addi.w	#$38,d0
008974DE                            
008974DE                            	@noflip03:
008974DE 3228 0030                  		move.w	sto_origY(a0),d1
008974E2 D240                       		add.w	d0,d1
008974E4 3141 000C                  		move.w	d1,obY(a0)
008974E8 4E75                       		rts	
008974EA                            ; ===========================================================================
008974EA                            
008974EA                            @type04:				; XREF: @index
008974EA 4A28 0038                  		tst.b	sto_active(a0)
008974EE 6600                       		bne.s	@isactive04
008974F0 4A68 003A                  		tst.w	$3A(a0)
008974F4 6700                       		beq.s	@loc_15EBE
008974F6 5168 003A                  		subq.w	#8,$3A(a0)
008974FA 6000                       		bra.s	@loc_15EF0
008974FC                            ; ===========================================================================
008974FC                            
008974FC                            @loc_15EBE:
008974FC 5368 0036                  		subq.w	#1,$36(a0)
00897500 6A00                       		bpl.s	@loc_15EF0
00897502 317C 003C 0036             		move.w	#$3C,$36(a0)
00897508 117C 0001 0038             		move.b	#1,sto_active(a0)
0089750E                            
0089750E                            @isactive04:
0089750E 3028 003A                  		move.w	$3A(a0),d0
00897512 B068 003C                  		cmp.w	$3C(a0),d0
00897516 6700                       		beq.s	@loc_15EE0
00897518 5068 003A                  		addq.w	#8,$3A(a0)
0089751C 6000                       		bra.s	@loc_15EF0
0089751E                            ; ===========================================================================
0089751E                            
0089751E                            @loc_15EE0:
0089751E 5368 0036                  		subq.w	#1,$36(a0)
00897522 6A00                       		bpl.s	@loc_15EF0
00897524 317C 003C 0036             		move.w	#$3C,$36(a0)
0089752A 4228 0038                  		clr.b	sto_active(a0)
0089752E                            
0089752E                            @loc_15EF0:
0089752E 3028 003A                  		move.w	$3A(a0),d0
00897532 0828 0000 0022             		btst	#0,obStatus(a0)
00897538 6700                       		beq.s	@noflip04
0089753A 4440                       		neg.w	d0
0089753C 0640 0038                  		addi.w	#$38,d0
00897540                            
00897540                            	@noflip04:
00897540 3228 0030                  		move.w	sto_origY(a0),d1
00897544 D240                       		add.w	d0,d1
00897546 3141 000C                  		move.w	d1,obY(a0)
0089754A 4E75                       		rts	
0089754C                            ; ===========================================================================
0089754C                            
0089754C                            @type05:				; XREF: @index
0089754C 4A28 0038                  		tst.b	sto_active(a0)
00897550 6600                       		bne.s	@loc_15F3E
00897552 45F8 F7E0                  		lea	(f_switch).w,a2
00897556 7000                       		moveq	#0,d0
00897558 1028 003E                  		move.b	$3E(a0),d0
0089755C 0832 0000 0000             		btst	#0,(a2,d0.w)
00897562 6700                       		beq.s	@locret_15F5C
00897564 117C 0001 0038             		move.b	#1,sto_active(a0)
0089756A 45F8 FC00                  		lea	(v_objstate).w,a2
0089756E 7000                       		moveq	#0,d0
00897570 1028 0023                  		move.b	obRespawnNo(a0),d0
00897574 6700                       		beq.s	@loc_15F3E
00897576 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0089757C                            
0089757C                            @loc_15F3E:
0089757C 04A8 0001 0000 0008        		subi.l	#$10000,obX(a0)
00897584 06A8 0000 8000 000C        		addi.l	#$8000,obY(a0)
0089758C 3168 0008 0034             		move.w	obX(a0),sto_origX(a0)
00897592 0C68 0980 0008             		cmpi.w	#$980,obX(a0)
00897598 6700                       		beq.s	@loc_15F5E
0089759A                            
0089759A                            @locret_15F5C:
0089759A 4E75                       		rts	
0089759C                            ; ===========================================================================
0089759C                            
0089759C                            @loc_15F5E:
0089759C 4228 0028                  		clr.b	obSubtype(a0)
008975A0 4228 0038                  		clr.b	sto_active(a0)
008975A4 4E75                       		rts	
008975A4 4E75                       		rts	
008975A6                            		include	"_maps\SBZ Stomper and Door.asm"
008975A6                            ; ---------------------------------------------------------------------------
008975A6                            ; Sprite mappings - stomper and	platforms (SBZ)
008975A6                            ; ---------------------------------------------------------------------------
008975A6 0000 0000                  Map_Stomp:	dc.w @door-Map_Stomp, @stomper-Map_Stomp
008975AA 0000 0000                  		dc.w @stomper-Map_Stomp, @stomper-Map_Stomp
008975AE 0000                       		dc.w @bigdoor-Map_Stomp
008975B0 04                         @door:		dc.b 4
008975B1 F40E 21AF C0               		dc.b $F4, $E, $21, $AF,	$C0 ; horizontal sliding door
008975B6 F40E 21B2 E0               		dc.b $F4, $E, $21, $B2,	$E0
008975BB F40E 21B2 00               		dc.b $F4, $E, $21, $B2,	0
008975C0 F40E 29AF 20               		dc.b $F4, $E, $29, $AF,	$20
008975C5 08                         @stomper:	dc.b 8
008975C6 E00C 000C E4               		dc.b $E0, $C, 0, $C, $E4 ; stomper block with yellow/black stripes
008975CB E008 0010 04               		dc.b $E0, 8, 0,	$10, 4
008975D0 E80E 2013 E4               		dc.b $E8, $E, $20, $13,	$E4
008975D5 E80A 201F 04               		dc.b $E8, $A, $20, $1F,	4
008975DA 000E 2013 E4               		dc.b 0,	$E, $20, $13, $E4
008975DF 000A 201F 04               		dc.b 0,	$A, $20, $1F, 4
008975E4 180C 000C E4               		dc.b $18, $C, 0, $C, $E4
008975E9 1808 0010 04               		dc.b $18, 8, 0,	$10, 4
008975EE 0E                         @bigdoor:	dc.b $E
008975EF C00F 0000 80               		dc.b $C0, $F, 0, 0, $80	; huge diagonal sliding door from SBZ3
008975F4 C00F 0010 A0               		dc.b $C0, $F, 0, $10, $A0
008975F9 C00F 0020 C0               		dc.b $C0, $F, 0, $20, $C0
008975FE C00F 0010 E0               		dc.b $C0, $F, 0, $10, $E0
00897603 C00F 0020 00               		dc.b $C0, $F, 0, $20, 0
00897608 C00F 0010 20               		dc.b $C0, $F, 0, $10, $20
0089760D C00F 0030 40               		dc.b $C0, $F, 0, $30, $40
00897612 C00D 0040 60               		dc.b $C0, $D, 0, $40, $60
00897617 E00F 0048 80               		dc.b $E0, $F, 0, $48, $80
0089761C E00F 0048 C0               		dc.b $E0, $F, 0, $48, $C0
00897621 E00F 0058 00               		dc.b $E0, $F, 0, $58, 0
00897626 000F 0048 80               		dc.b 0,	$F, 0, $48, $80
0089762B 000F 0058 C0               		dc.b 0,	$F, 0, $58, $C0
00897630 200F 0058 80               		dc.b $20, $F, 0, $58, $80
00897636 00                         		even
00897636 00                         		even
00897636                            		include	"_incObj\6C SBZ Vanishing Platforms.asm"
00897636                            ; ---------------------------------------------------------------------------
00897636                            ; Object 6C - vanishing	platforms (SBZ)
00897636                            ; ---------------------------------------------------------------------------
00897636                            
00897636                            VanishPlatform:				; XREF: Obj_Index
00897636 7000                       		moveq	#0,d0
00897638 1028 0024                  		move.b	obRoutine(a0),d0
0089763C 323B 0000                  		move.w	VanP_Index(pc,d0.w),d1
00897640 4EFB 1000                  		jmp	VanP_Index(pc,d1.w)
00897644                            ; ===========================================================================
00897644 0000                       VanP_Index:	dc.w VanP_Main-VanP_Index
00897646 0000                       		dc.w VanP_Vanish-VanP_Index
00897648 0000                       		dc.w VanP_Appear-VanP_Index
0089764A 0000                       		dc.w loc_16068-VanP_Index
0089764C                            
0089764C =00000030                  vanp_timer:	= $30		; counter for time until event
0089764C =00000032                  vanp_timelen:	= $32		; time between events (general)
0089764C                            ; ===========================================================================
0089764C                            
0089764C                            VanP_Main:	; Routine 0
0089764C 5C28 0024                  		addq.b	#6,obRoutine(a0)
00897650 217C 0000 0000 0004        		move.l	#Map_VanP,obMap(a0)
00897658 317C 44C3 0002             		move.w	#$44C3,obGfx(a0)
0089765E 0028 0004 0001             		ori.b	#4,obRender(a0)
00897664 117C 0010 0019             		move.b	#$10,obActWid(a0)
0089766A 117C 0004 0018             		move.b	#4,obPriority(a0)
00897670 7000                       		moveq	#0,d0
00897672 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
00897676 0240 000F                  		andi.w	#$F,d0		; read only the	2nd digit
0089767A 5240                       		addq.w	#1,d0		; add 1
0089767C EF48                       		lsl.w	#7,d0		; multiply by $80
0089767E 3200                       		move.w	d0,d1
00897680 5340                       		subq.w	#1,d0
00897682 3140 0030                  		move.w	d0,vanp_timer(a0)
00897686 3140 0032                  		move.w	d0,vanp_timelen(a0)
0089768A 7000                       		moveq	#0,d0
0089768C 1028 0028                  		move.b	obSubtype(a0),d0 ; get object type
00897690 0240 00F0                  		andi.w	#$F0,d0		; read only the	1st digit
00897694 0641 0080                  		addi.w	#$80,d1
00897698 C0C1                       		mulu.w	d1,d0
0089769A E088                       		lsr.l	#8,d0
0089769C 3140 0036                  		move.w	d0,$36(a0)
008976A0 5341                       		subq.w	#1,d1
008976A2 3141 0038                  		move.w	d1,$38(a0)
008976A6                            
008976A6                            loc_16068:	; Routine 6
008976A6 3038 FE04                  		move.w	(v_framecount).w,d0
008976AA 9068 0036                  		sub.w	$36(a0),d0
008976AE C068 0038                  		and.w	$38(a0),d0
008976B2 6600                       		bne.s	@animate
008976B4 5928 0024                  		subq.b	#4,obRoutine(a0) ; goto VanP_Vanish next
008976B8 6000                       		bra.s	VanP_Vanish
008976BA                            ; ===========================================================================
008976BA                            
008976BA                            @animate:
008976BA 43F9 0000 0000             		lea	(Ani_Van).l,a1
008976C0 4EB9 0088 B4B0             		jsr	AnimateSprite
008976C6 6000 8DC4                  		bra.w	RememberState
008976CA                            ; ===========================================================================
008976CA                            
008976CA                            VanP_Vanish:	; Routine 2
008976CA                            VanP_Appear:	; Routine 4
008976CA 5368 0030                  		subq.w	#1,vanp_timer(a0)
008976CE 6A00                       		bpl.s	@wait
008976D0 317C 007F 0030             		move.w	#127,vanp_timer(a0)
008976D6 4A28 001C                  		tst.b	obAnim(a0)	; is platform vanishing?
008976DA 6700                       		beq.s	@isvanishing	; if yes, branch
008976DC 3168 0032 0030             		move.w	vanp_timelen(a0),vanp_timer(a0)
008976E2                            
008976E2                            	@isvanishing:
008976E2 0868 0000 001C             		bchg	#0,obAnim(a0)
008976E8                            
008976E8                            	@wait:
008976E8 43F9 0000 0000             		lea	(Ani_Van).l,a1
008976EE 4EB9 0088 B4B0             		jsr	AnimateSprite
008976F4 0828 0001 001A             		btst	#1,obFrame(a0)	; has platform vanished?
008976FA 6600                       		bne.s	@notsolid	; if yes, branch
008976FC 0C28 0002 0024             		cmpi.b	#2,obRoutine(a0)
00897702 6600                       		bne.s	@loc_160D6
00897704 7200                       		moveq	#0,d1
00897706 1228 0019                  		move.b	obActWid(a0),d1
0089770A 4EB9 0088 8080             		jsr	(PlatformObject).l
00897710 6000 8D7A                  		bra.w	RememberState
00897714                            ; ===========================================================================
00897714                            
00897714                            @loc_160D6:
00897714 7200                       		moveq	#0,d1
00897716 1228 0019                  		move.b	obActWid(a0),d1
0089771A 4EB9 0088 81F4             		jsr	(ExitPlatform).l
00897720 3428 0008                  		move.w	obX(a0),d2
00897724 4EB9 0088 8762             		jsr	(MvSonicOnPtfm2).l
0089772A 6000 8D60                  		bra.w	RememberState
0089772E                            ; ===========================================================================
0089772E                            
0089772E                            @notsolid:
0089772E 0828 0003 0022             		btst	#3,obStatus(a0)
00897734 6700                       		beq.s	@display
00897736 43F8 D000                  		lea	(v_player).w,a1
0089773A 08A9 0003 0022             		bclr	#3,obStatus(a1)
00897740 08A8 0003 0022             		bclr	#3,obStatus(a0)
00897746 117C 0002 0024             		move.b	#2,obRoutine(a0)
0089774C 4228 0025                  		clr.b	obSolid(a0)
00897750                            
00897750                            	@display:
00897750 6000 8D3A                  		bra.w	RememberState
00897750 6000 8D3A                  		bra.w	RememberState
00897754                            		include	"_anim\SBZ Vanishing Platforms.asm"
00897754                            ; ---------------------------------------------------------------------------
00897754                            ; Animation script - vanishing platforms (SBZ)
00897754                            ; ---------------------------------------------------------------------------
00897754 0000                       Ani_Van:	dc.w @vanish-Ani_Van
00897756 0000                       		dc.w @appear-Ani_Van
00897758 0700 0102 03FE 01          @vanish:	dc.b 7,	0, 1, 2, 3, afBack, 1
00897760 00                         		even
00897760 0703 0201 00FE 01          @appear:	dc.b 7,	3, 2, 1, 0, afBack, 1
00897768 00                         		even
00897768 00                         		even
00897768                            		include	"_maps\SBZ Vanishing Platforms.asm"
00897768                            ; ---------------------------------------------------------------------------
00897768                            ; Sprite mappings - vanishing platforms	(SBZ)
00897768                            ; ---------------------------------------------------------------------------
00897768 0000 0000                  Map_VanP:	dc.w @whole-Map_VanP, @half-Map_VanP
0089776C 0000 0000                  		dc.w @quarter-Map_VanP, @gone-Map_VanP
00897770 01                         @whole:		dc.b 1
00897771 F80F 0000 F0               		dc.b $F8, $F, 0, 0, $F0
00897776 01                         @half:		dc.b 1
00897777 F807 0010 F8               		dc.b $F8, 7, 0,	$10, $F8
0089777C 01                         @quarter:	dc.b 1
0089777D F803 0018 FC               		dc.b $F8, 3, 0,	$18, $FC
00897782 00                         @gone:		dc.b 0
00897784 00                         		even
00897784 00                         		even
00897784                            		include	"_incObj\6E Electrocuter.asm"
00897784                            ; ---------------------------------------------------------------------------
00897784                            ; Object 6E - electrocution orbs (SBZ)
00897784                            ; ---------------------------------------------------------------------------
00897784                            
00897784                            Electro:				; XREF: Obj_Index
00897784 7000                       		moveq	#0,d0
00897786 1028 0024                  		move.b	obRoutine(a0),d0
0089778A 323B 0000                  		move.w	Elec_Index(pc,d0.w),d1
0089778E 4EFB 1000                  		jmp	Elec_Index(pc,d1.w)
00897792                            ; ===========================================================================
00897792 0000                       Elec_Index:	dc.w Elec_Main-Elec_Index
00897794 0000                       		dc.w Elec_Shock-Elec_Index
00897796                            
00897796 =00000034                  elec_freq:	= $34		; frequency
00897796                            ; ===========================================================================
00897796                            
00897796                            Elec_Main:	; Routine 0
00897796 5428 0024                  		addq.b	#2,obRoutine(a0)
0089779A 217C 0000 0000 0004        		move.l	#Map_Elec,obMap(a0)
008977A2 317C 047E 0002             		move.w	#$47E,obGfx(a0)
008977A8 0028 0004 0001             		ori.b	#4,obRender(a0)
008977AE 117C 0028 0019             		move.b	#$28,obActWid(a0)
008977B4 7000                       		moveq	#0,d0
008977B6 1028 0028                  		move.b	obSubtype(a0),d0 ; read object type
008977BA E948                       		lsl.w	#4,d0		; multiply by $10
008977BC 5340                       		subq.w	#1,d0
008977BE 3140 0034                  		move.w	d0,elec_freq(a0)
008977C2                            
008977C2                            Elec_Shock:	; Routine 2
008977C2 3038 FE04                  		move.w	(v_framecount).w,d0
008977C6 C068 0034                  		and.w	elec_freq(a0),d0 ; is it time to zap?
008977CA 6600                       		bne.s	@animate	; if not, branch
008977CC                            
008977CC 117C 0001 001C             		move.b	#1,obAnim(a0)	; run "zap" animation
008977D2 4A28 0001                  		tst.b	obRender(a0)
008977D6 6A00                       		bpl.s	@animate
008977E2                            
008977E2                            	@animate:
008977E2 43F9 0000 0000             		lea	(Ani_Elec).l,a1
008977E8 4EB9 0088 B4B0             		jsr	AnimateSprite
008977EE 117C 0000 0020             		move.b	#0,obColType(a0)
008977F4 0C28 0004 001A             		cmpi.b	#4,obFrame(a0)	; is 4th frame displayed?
008977FA 6600                       		bne.s	@display	; if not, branch
008977FC 117C 00A4 0020             		move.b	#$A4,obColType(a0) ; if yes, make object hurt Sonic
00897802                            
00897802                            	@display:
00897802 6000 8C88                  		bra.w	RememberState
00897802 6000 8C88                  		bra.w	RememberState
00897806                            		include	"_anim\Electrocuter.asm"
00897806                            ; ---------------------------------------------------------------------------
00897806                            ; Animation script - electrocution orbs (SBZ)
00897806                            ; ---------------------------------------------------------------------------
00897806 0000                       Ani_Elec:	dc.w byte_161CC-Ani_Elec
00897808 0000                       		dc.w byte_161D0-Ani_Elec
0089780A 0700 FF                    byte_161CC:	dc.b 7,	0, afEnd
0089780E 00                         		even
0089780E 0001 0101 0203 0304 0404+  byte_161D0:	dc.b 0,	1, 1, 1, 2, 3, 3, 4, 4,	4, 5, 5, 5, 0, afChange, 0
0089781E                            		even
0089781E                            		even
0089781E                            		include	"_maps\Electrocuter.asm"
0089781E                            ; ---------------------------------------------------------------------------
0089781E                            ; Sprite mappings - electrocution orbs (SBZ)
0089781E                            ; ---------------------------------------------------------------------------
0089781E 0000 0000                  Map_Elec:	dc.w @normal-Map_Elec, @zap1-Map_Elec
00897822 0000 0000                  		dc.w @zap2-Map_Elec, @zap3-Map_Elec
00897826 0000 0000                  		dc.w @zap4-Map_Elec, @zap5-Map_Elec
0089782A 02                         @normal:	dc.b 2
0089782B F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
00897830 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
00897835 03                         @zap1:		dc.b 3
00897836 F805 0008 F8               		dc.b $F8, 5, 0,	8, $F8
0089783B F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
00897840 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
00897845 05                         @zap2:		dc.b 5
00897846 F805 0008 F8               		dc.b $F8, 5, 0,	8, $F8
0089784B F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
00897850 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
00897855 F60D 000C 08               		dc.b $F6, $D, 0, $C, 8
0089785A F60D 080C DC               		dc.b $F6, $D, 8, $C, $DC
0089785F 04                         @zap3:		dc.b 4
00897860 F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
00897865 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
0089786A F60D 000C 08               		dc.b $F6, $D, 0, $C, 8
0089786F F60D 080C DC               		dc.b $F6, $D, 8, $C, $DC
00897874 06                         @zap4:		dc.b 6
00897875 F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
0089787A 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
0089787F F60D 100C 08               		dc.b $F6, $D, $10, $C, 8
00897884 F60D 180C DC               		dc.b $F6, $D, $18, $C, $DC
00897889 F60D 000C 24               		dc.b $F6, $D, 0, $C, $24
0089788E F60D 080C C0               		dc.b $F6, $D, 8, $C, $C0
00897893 04                         @zap5:		dc.b 4
00897894 F804 6000 F8               		dc.b $F8, 4, $60, 0, $F8
00897899 0006 4002 F8               		dc.b 0,	6, $40,	2, $F8
0089789E F60D 100C 24               		dc.b $F6, $D, $10, $C, $24
008978A3 F60D 180C C0               		dc.b $F6, $D, $18, $C, $C0
008978A8                            		even
008978A8                            		even
008978A8                            		include	"_incObj\6F SBZ Spin Platform Conveyor.asm"
008978A8                            ; ---------------------------------------------------------------------------
008978A8                            ; Object 6F - spinning platforms that move around a conveyor belt (SBZ)
008978A8                            ; ---------------------------------------------------------------------------
008978A8                            
008978A8                            SpinConvey:				; XREF: Obj_Index
008978A8 7000                       		moveq	#0,d0
008978AA 1028 0024                  		move.b	obRoutine(a0),d0
008978AE 323B 0000                  		move.w	SpinC_Index(pc,d0.w),d1
008978B2 4EBB 1000                  		jsr	SpinC_Index(pc,d1.w)
008978D2                            
008978D2                            SpinC_Display:
008978D2 4EF9 0088 E3CC             		jmp	DisplaySprite
008978D8                            ; ===========================================================================
008978D8                            
008978D8                            loc_1629A:
008978D8 0C38 0002 FE11             		cmpi.b	#2,(v_act).w	; check if act is 3
008978DE 6600                       		bne.s	SpinC_Act1or2	; if not, branch
008978E0 0C40 FF80                  		cmpi.w	#-$80,d0
008978E4 64EC                       		bcc.s	SpinC_Display
008978E6                            
008978E6                            SpinC_Act1or2:
008978E6 1028 002F                  		move.b	$2F(a0),d0
008978EA 6A00                       		bpl.s	SpinC_Delete
008978EC 0240 007F                  		andi.w	#$7F,d0
008978F0 45F8 F7C1                  		lea	(v_obj63).w,a2
008978F4 08B2 0000 0000             		bclr	#0,(a2,d0.w)
008978FA                            
008978FA                            SpinC_Delete:
008978FA 4EF9 0088 E408             		jmp	DeleteObject
00897900                            ; ===========================================================================
00897900 0000                       SpinC_Index:	dc.w SpinC_Main-SpinC_Index
00897902 0000                       		dc.w loc_163D8-SpinC_Index
00897904                            ; ===========================================================================
00897904                            
00897904                            SpinC_Main:	; Routine 0
00897904 1028 0028                  		move.b	obSubtype(a0),d0
00897908 6B00 0000                  		bmi.w	loc_16380
0089790C 5428 0024                  		addq.b	#2,obRoutine(a0)
00897910 217C 0089 6F78 0004        		move.l	#Map_Spin,obMap(a0)
00897918 317C 04DF 0002             		move.w	#$4DF,obGfx(a0)
0089791E 117C 0010 0019             		move.b	#$10,obActWid(a0)
00897924 0028 0004 0001             		ori.b	#4,obRender(a0)
0089792A 117C 0004 0018             		move.b	#4,obPriority(a0)
00897930 7000                       		moveq	#0,d0
00897932 1028 0028                  		move.b	obSubtype(a0),d0
00897936 3200                       		move.w	d0,d1
00897938 E648                       		lsr.w	#3,d0
0089793A 0240 001E                  		andi.w	#$1E,d0
0089793E 45FA 0000                  		lea	off_164A6(pc),a2
00897942 D4F2 0000                  		adda.w	(a2,d0.w),a2
00897946 315A 0038                  		move.w	(a2)+,$38(a0)
0089794A 315A 0030                  		move.w	(a2)+,$30(a0)
0089794E 214A 003C                  		move.l	a2,$3C(a0)
00897952 0241 000F                  		andi.w	#$F,d1
00897956 E549                       		lsl.w	#2,d1
00897958 1141 0038                  		move.b	d1,$38(a0)
0089795C 117C 0004 003A             		move.b	#4,$3A(a0)
00897962 4A38 F7C0                  		tst.b	(f_conveyrev).w
00897966 6700                       		beq.s	loc_16356
00897968 117C 0001 003B             		move.b	#1,$3B(a0)
0089796E 4428 003A                  		neg.b	$3A(a0)
00897972 7200                       		moveq	#0,d1
00897974 1228 0038                  		move.b	$38(a0),d1
00897978 D228 003A                  		add.b	$3A(a0),d1
0089797C B228 0039                  		cmp.b	$39(a0),d1
00897980 6500                       		bcs.s	loc_16352
00897982 1001                       		move.b	d1,d0
00897984 7200                       		moveq	#0,d1
00897986 4A00                       		tst.b	d0
00897988 6A00                       		bpl.s	loc_16352
0089798A 1228 0039                  		move.b	$39(a0),d1
0089798E 5901                       		subq.b	#4,d1
00897990                            
00897990                            loc_16352:
00897990 1141 0038                  		move.b	d1,$38(a0)
00897994                            
00897994                            loc_16356:
00897994 3172 1000 0034             		move.w	(a2,d1.w),$34(a0)
0089799A 3172 1002 0036             		move.w	2(a2,d1.w),$36(a0)
008979A0 4A41                       		tst.w	d1
008979A2 6600                       		bne.s	loc_1636C
008979A4 117C 0001 001C             		move.b	#1,obAnim(a0)
008979AA                            
008979AA                            loc_1636C:
008979AA 0C41 0008                  		cmpi.w	#8,d1
008979AE 6600                       		bne.s	loc_16378
008979B0 117C 0000 001C             		move.b	#0,obAnim(a0)
008979B6                            
008979B6                            loc_16378:
008979B6 6100 BAAE                  		bsr.w	LCon_ChangeDir
008979BA 6000 0000                  		bra.w	loc_163D8
008979BE                            ; ===========================================================================
008979BE                            
008979BE                            loc_16380:				; XREF: SpinC_Main
008979BE 1140 002F                  		move.b	d0,$2F(a0)
008979C2 0240 007F                  		andi.w	#$7F,d0
008979C6 45F8 F7C1                  		lea	(v_obj63).w,a2
008979CA 08F2 0000 0000             		bset	#0,(a2,d0.w)
008979D0 6700                       		beq.s	loc_1639A
008979D2 4EF9 0088 E408             		jmp	DeleteObject
008979D8                            ; ===========================================================================
008979D8                            
008979D8                            loc_1639A:
008979D8 D040                       		add.w	d0,d0
008979DA 0240 001E                  		andi.w	#$1E,d0
008979DE 0640 0080                  		addi.w	#(ZoneCount*$10)+$10,d0
008979E2 45F9 0000 0000             		lea	(ObjPos_Index).l,a2
008979E8 D4F2 0000                  		adda.w	(a2,d0.w),a2
008979EC 321A                       		move.w	(a2)+,d1
008979EE 2248                       		movea.l	a0,a1
008979F0 6000                       		bra.s	SpinC_LoadPform
008979F2                            ; ===========================================================================
008979F2                            
008979F2                            SpinC_Loop:
008979F2 4EB9 0088 E862             		jsr	FindFreeObj
008979F8 6600                       		bne.s	loc_163D0
008979FA                            
008979FA                            SpinC_LoadPform:			; XREF: loc_1639A
008979FA 137C 006F 0000             		move.b	#id_SpinConvey,0(a1)
00897A00 335A 0008                  		move.w	(a2)+,obX(a1)
00897A04 335A 000C                  		move.w	(a2)+,obY(a1)
00897A08 301A                       		move.w	(a2)+,d0
00897A0A 1340 0028                  		move.b	d0,obSubtype(a1)
00897A0E                            
00897A0E                            loc_163D0:
00897A0E 51C9 FFE2                  		dbf	d1,SpinC_Loop
00897A12                            
00897A12 588F                       		addq.l	#4,sp
00897A14 4E75                       		rts	
00897A16                            ; ===========================================================================
00897A16                            
00897A16                            loc_163D8:	; Routine 2
00897A16 43F9 0000 0000             		lea	(Ani_SpinConvey).l,a1
00897A1C 4EB9 0088 B4B0             		jsr	AnimateSprite
00897A22 4A28 001A                  		tst.b	obFrame(a0)
00897A26 6600                       		bne.s	loc_16404
00897A28 3F28 0008                  		move.w	obX(a0),-(sp)
00897A2C 6100 0000                  		bsr.w	loc_16424
00897A30 323C 001B                  		move.w	#$1B,d1
00897A34 343C 0007                  		move.w	#7,d2
00897A38 3602                       		move.w	d2,d3
00897A3A 5243                       		addq.w	#1,d3
00897A3C 381F                       		move.w	(sp)+,d4
00897A3E 6000 8D76                  		bra.w	SolidObject
00897A42                            ; ===========================================================================
00897A42                            
00897A42                            loc_16404:
00897A42 0828 0003 0022             		btst	#3,obStatus(a0)
00897A48 6700                       		beq.s	loc_16420
00897A4A 43F8 D000                  		lea	(v_objspace).w,a1
00897A4E 08A9 0003 0022             		bclr	#3,obStatus(a1)
00897A54 08A8 0003 0022             		bclr	#3,obStatus(a0)
00897A5A 4228 0025                  		clr.b	obSolid(a0)
00897A5E                            
00897A5E                            loc_16420:
00897A5E 6000 0002                  		bra.w	*+4
00897A62                            
00897A62                            loc_16424:
00897A62 3028 0008                  		move.w	obX(a0),d0
00897A66 B068 0034                  		cmp.w	$34(a0),d0
00897A6A 6600                       		bne.s	loc_16484
00897A6C 3028 000C                  		move.w	obY(a0),d0
00897A70 B068 0036                  		cmp.w	$36(a0),d0
00897A74 6600                       		bne.s	loc_16484
00897A76 7200                       		moveq	#0,d1
00897A78 1228 0038                  		move.b	$38(a0),d1
00897A7C D228 003A                  		add.b	$3A(a0),d1
00897A80 B228 0039                  		cmp.b	$39(a0),d1
00897A84 6500                       		bcs.s	loc_16456
00897A86 1001                       		move.b	d1,d0
00897A88 7200                       		moveq	#0,d1
00897A8A 4A00                       		tst.b	d0
00897A8C 6A00                       		bpl.s	loc_16456
00897A8E 1228 0039                  		move.b	$39(a0),d1
00897A92 5901                       		subq.b	#4,d1
00897A94                            
00897A94                            loc_16456:
00897A94 1141 0038                  		move.b	d1,$38(a0)
00897A98 2268 003C                  		movea.l	$3C(a0),a1
00897A9C 3171 1000 0034             		move.w	(a1,d1.w),$34(a0)
00897AA2 3171 1002 0036             		move.w	2(a1,d1.w),$36(a0)
00897AA8 4A41                       		tst.w	d1
00897AAA 6600                       		bne.s	loc_16474
00897AAC 117C 0001 001C             		move.b	#1,obAnim(a0)
00897AB2                            
00897AB2                            loc_16474:
00897AB2 0C41 0008                  		cmpi.w	#8,d1
00897AB6 6600                       		bne.s	loc_16480
00897AB8 117C 0000 001C             		move.b	#0,obAnim(a0)
00897ABE                            
00897ABE                            loc_16480:
00897ABE 6100 B9A6                  		bsr.w	LCon_ChangeDir
00897AC2                            
00897AC2                            loc_16484:
00897AC2 4EF9 0088 E3B2             		jmp	ObjectMove
00897AC2 4EF9 0088 E3B2             		jmp	ObjectMove
00897AC8                            		include	"_anim\SBZ Spin Platform Conveyor.asm"
00897AC8                            ; ---------------------------------------------------------------------------
00897AC8                            ; Animation script - platform on conveyor belt (SBZ)
00897AC8                            ; ---------------------------------------------------------------------------
00897AC8 0000                       Ani_SpinConvey:	dc.w @spin-Ani_SpinConvey
00897ACA 0000                       		dc.w @still-Ani_SpinConvey
00897ACC 0000 0102 0304 4342 4140+  @spin:		dc.b 0,	0, 1, 2, 3, 4, $43, $42, $41, $40, $61,	$62, $63
00897AD9 6423 2221 00FF             		dc.b $64, $23, $22, $21, 0, afEnd
00897AE0 00                         		even
00897AE0 0F00 FF                    @still:		dc.b $F, 0, afEnd
00897AE4 00                         		even
00897AE4 00                         		even
00897AE4                            
00897AE4 0000 0000 0000             off_164A6:	dc.w word_164B2-off_164A6, word_164C6-off_164A6, word_164DA-off_164A6
00897AEA 0000 0000 0000             		dc.w word_164EE-off_164A6, word_16502-off_164A6, word_16516-off_164A6
00897AF0 0010 0E80 0E14 0370 0EEF+  word_164B2:	dc.w $10, $E80,	$E14, $370, $EEF, $302,	$EEF, $340, $E14, $3AE
00897B04 0010 0F80 0F14 02E0 0FEF+  word_164C6:	dc.w $10, $F80,	$F14, $2E0, $FEF, $272,	$FEF, $2B0, $F14, $31E
00897B18 0010 1080 1014 0270 10EF+  word_164DA:	dc.w $10, $1080, $1014,	$270, $10EF, $202, $10EF, $240,	$1014, $2AE
00897B2C 0010 0F80 0F14 0570 0FEF+  word_164EE:	dc.w $10, $F80,	$F14, $570, $FEF, $502,	$FEF, $540, $F14, $5AE
00897B40 0010 1B80 1B14 0670 1BEF+  word_16502:	dc.w $10, $1B80, $1B14,	$670, $1BEF, $602, $1BEF, $640,	$1B14, $6AE
00897B54 0010 1C80 1C14 05E0 1CEF+  word_16516:	dc.w $10, $1C80, $1C14,	$5E0, $1CEF, $572, $1CEF, $5B0,	$1C14, $61E
00897B68                            ; ===========================================================================
00897B68                            
00897B68                            		include	"_incObj\70 Girder Block.asm"
00897B68                            ; ---------------------------------------------------------------------------
00897B68                            ; Object 70 - large girder block (SBZ)
00897B68                            ; ---------------------------------------------------------------------------
00897B68                            
00897B68                            Girder:					; XREF: Obj_Index
00897B68 7000                       		moveq	#0,d0
00897B6A 1028 0024                  		move.b	obRoutine(a0),d0
00897B6E 323B 0000                  		move.w	Gird_Index(pc,d0.w),d1
00897B72 4EFB 1000                  		jmp	Gird_Index(pc,d1.w)
00897B76                            ; ===========================================================================
00897B76 0000                       Gird_Index:	dc.w Gird_Main-Gird_Index
00897B78 0000                       		dc.w Gird_Action-Gird_Index
00897B7A                            
00897B7A =00000016                  gird_height:	= $16
00897B7A =00000032                  gird_origX:	= $32		; original x-axis position
00897B7A =00000030                  gird_origY:	= $30		; original y-axis position
00897B7A =00000034                  gird_time:	= $34		; duration for movement in a direction
00897B7A =00000038                  gird_set:	= $38		; which movement settings to use (0/8/16/24)
00897B7A =0000003A                  gird_delay:	= $3A		; delay for movement
00897B7A                            ; ===========================================================================
00897B7A                            
00897B7A                            Gird_Main:	; Routine 0
00897B7A 5428 0024                  		addq.b	#2,obRoutine(a0)
00897B7E 217C 0000 0000 0004        		move.l	#Map_Gird,obMap(a0)
00897B86 317C 42F0 0002             		move.w	#$42F0,obGfx(a0)
00897B8C 0028 0004 0001             		ori.b	#4,obRender(a0)
00897B92 117C 0004 0018             		move.b	#4,obPriority(a0)
00897B98 117C 0060 0019             		move.b	#$60,obActWid(a0)
00897B9E 117C 0018 0016             		move.b	#$18,gird_height(a0)
00897BA4 3168 0008 0032             		move.w	obX(a0),gird_origX(a0)
00897BAA 3168 000C 0030             		move.w	obY(a0),gird_origY(a0)
00897BB0 6100 0000                  		bsr.w	Gird_ChgMove
00897BB4                            
00897BB4                            Gird_Action:	; Routine 2
00897BB4 3F28 0008                  		move.w	obX(a0),-(sp)
00897BB8 4A68 003A                  		tst.w	gird_delay(a0)
00897BBC 6700                       		beq.s	@beginmove
00897BBE 5368 003A                  		subq.w	#1,gird_delay(a0)
00897BC2 6600                       		bne.s	@solid
00897BC4                            
00897BC4                            	@beginmove:
00897BC4 4EB9 0088 E3B2             		jsr	ObjectMove
00897BCA 5368 0034                  		subq.w	#1,gird_time(a0) ; decrement movement duration
00897BCE 6600                       		bne.s	@solid		; if time remains, branch
00897BD0 6100 0000                  		bsr.w	Gird_ChgMove	; if time is zero, branch
00897BD4                            
00897BD4                            	@solid:
00897BD4 381F                       		move.w	(sp)+,d4
00897BD6 4A28 0001                  		tst.b	obRender(a0)
00897BDA 6A00                       		bpl.s	@chkdel
00897BDC 7200                       		moveq	#0,d1
00897BDE 1228 0019                  		move.b	obActWid(a0),d1
00897BE2 0641 000B                  		addi.w	#$B,d1
00897BE6 7400                       		moveq	#0,d2
00897BE8 1428 0016                  		move.b	gird_height(a0),d2
00897BEC 3602                       		move.w	d2,d3
00897BEE 5243                       		addq.w	#1,d3
00897BF0 6100 8BC4                  		bsr.w	SolidObject
00897BF4                            
00897BF4                            	@chkdel:
00897C10 4EF9 0088 E3CC             		jmp	DisplaySprite
00897C16                            
00897C16                            	@delete:
00897C16 4EF9 0088 E408             		jmp	DeleteObject
00897C1C                            ; ===========================================================================
00897C1C                            
00897C1C                            Gird_ChgMove:
00897C1C 1028 0038                  		move.b	gird_set(a0),d0
00897C20 0240 0018                  		andi.w	#$18,d0
00897C24 43F9 0000 0000             		lea	(@settings).l,a1
00897C2A 43F1 0000                  		lea	(a1,d0.w),a1
00897C2E 3159 0010                  		move.w	(a1)+,obVelX(a0)
00897C32 3159 0012                  		move.w	(a1)+,obVelY(a0)
00897C36 3159 0034                  		move.w	(a1)+,gird_time(a0)
00897C3A 5028 0038                  		addq.b	#8,gird_set(a0)	; use next settings
00897C3E 317C 0007 003A             		move.w	#7,gird_delay(a0)
00897C44 4E75                       		rts	
00897C46                            ; ===========================================================================
00897C46                            @settings:	;   x-speed, y-speed, duration
00897C46 0100 0000 0060 0000        		dc.w   $100,	 0,   $60,     0 ; right
00897C4E 0000 0100 0030 0000        		dc.w	  0,  $100,   $30,     0 ; down
00897C56 FF00 FFC0 0060 0000        		dc.w  -$100,  -$40,   $60,     0 ; up/left
00897C5E 0000 FF00 0018 0000        		dc.w	  0, -$100,   $18,     0 ; up
00897C5E 0000 FF00 0018 0000        		dc.w	  0, -$100,   $18,     0 ; up
00897C66                            		include	"_maps\Girder Block.asm"
00897C66                            ; ---------------------------------------------------------------------------
00897C66                            ; Sprite mappings - large girder block (SBZ)
00897C66                            ; ---------------------------------------------------------------------------
00897C66 0000                       Map_Gird:	dc.w @girder-Map_Gird
00897C68 0C                         @girder:	dc.b $C
00897C69 E80E 0000 A0               		dc.b $E8, $E, 0, 0, $A0
00897C6E 000E 1000 A0               		dc.b 0,	$E, $10, 0, $A0
00897C73 E80E 0006 C0               		dc.b $E8, $E, 0, 6, $C0
00897C78 000E 1006 C0               		dc.b 0,	$E, $10, 6, $C0
00897C7D E80E 0006 E0               		dc.b $E8, $E, 0, 6, $E0
00897C82 000E 1006 E0               		dc.b 0,	$E, $10, 6, $E0
00897C87 E80E 0006 00               		dc.b $E8, $E, 0, 6, 0
00897C8C 000E 1006 00               		dc.b 0,	$E, $10, 6, 0
00897C91 E80E 0006 20               		dc.b $E8, $E, 0, 6, $20
00897C96 000E 1006 20               		dc.b 0,	$E, $10, 6, $20
00897C9B E80E 0006 40               		dc.b $E8, $E, 0, 6, $40
00897CA0 000E 1006 40               		dc.b 0,	$E, $10, 6, $40
00897CA6 00                         		even
00897CA6 00                         		even
00897CA6                            		include	"_incObj\72 Teleporter.asm"
00897CA6                            ; ---------------------------------------------------------------------------
00897CA6                            ; Object 72 - teleporter (SBZ)
00897CA6                            ; ---------------------------------------------------------------------------
00897CA6                            
00897CA6                            Teleport:				; XREF: Obj_Index
00897CA6 7000                       		moveq	#0,d0
00897CA8 1028 0024                  		move.b	obRoutine(a0),d0
00897CAC 323B 0000                  		move.w	Tele_Index(pc,d0.w),d1
00897CB0 4EBB 1000                  		jsr	Tele_Index(pc,d1.w)
00897CD0 4E75                       		rts	
00897CD2                            
00897CD2                            	@delete:
00897CD2 4EF9 0088 E408             		jmp	DeleteObject
00897CD8                            ; ===========================================================================
00897CD8 0000                       Tele_Index:	dc.w Tele_Main-Tele_Index
00897CDA 0000                       		dc.w loc_166C8-Tele_Index
00897CDC 0000                       		dc.w loc_1675E-Tele_Index
00897CDE 0000                       		dc.w loc_16798-Tele_Index
00897CE0                            ; ===========================================================================
00897CE0                            
00897CE0                            Tele_Main:	; Routine 0
00897CE0 5428 0024                  		addq.b	#2,obRoutine(a0)
00897CE4 1028 0028                  		move.b	obSubtype(a0),d0
00897CE8 D040                       		add.w	d0,d0
00897CEA 0240 001E                  		andi.w	#$1E,d0
00897CEE 45FA 0000                  		lea	Tele_Data(pc),a2
00897CF2 D4F2 0000                  		adda.w	(a2,d0.w),a2
00897CF6 315A 003A                  		move.w	(a2)+,$3A(a0)
00897CFA 214A 003C                  		move.l	a2,$3C(a0)
00897CFE 315A 0036                  		move.w	(a2)+,$36(a0)
00897D02 315A 0038                  		move.w	(a2)+,$38(a0)
00897D06                            
00897D06                            loc_166C8:	; Routine 2
00897D06 43F8 D000                  		lea	(v_player).w,a1
00897D0A 3029 0008                  		move.w	obX(a1),d0
00897D0E 9068 0008                  		sub.w	obX(a0),d0
00897D12 0828 0000 0022             		btst	#0,obStatus(a0)
00897D18 6700                       		beq.s	loc_166E0
00897D1A 0640 000F                  		addi.w	#$F,d0
00897D1E                            
00897D1E                            loc_166E0:
00897D1E 0C40 0010                  		cmpi.w	#$10,d0
00897D22 6400                       		bcc.s	locret_1675C
00897D24 3229 000C                  		move.w	obY(a1),d1
00897D28 9268 000C                  		sub.w	obY(a0),d1
00897D2C 0641 0020                  		addi.w	#$20,d1
00897D30 0C41 0040                  		cmpi.w	#$40,d1
00897D34 6400                       		bcc.s	locret_1675C
00897D36 4A38 F7C8                  		tst.b	(f_lockmulti).w
00897D3A 6600                       		bne.s	locret_1675C
00897D3C 0C28 0007 0028             		cmpi.b	#7,obSubtype(a0)
00897D42 6600                       		bne.s	loc_1670E
00897D44 0C78 0032 FE20             		cmpi.w	#50,(v_rings).w
00897D4A 6500                       		bcs.s	locret_1675C
00897D4C                            
00897D4C                            loc_1670E:
00897D4C 5428 0024                  		addq.b	#2,obRoutine(a0)
00897D50 11FC 0081 F7C8             		move.b	#$81,(f_lockmulti).w ; lock controls
00897D56 137C 0002 001C             		move.b	#id_Roll,obAnim(a1) ; use Sonic's rolling animation
00897D5C 337C 0800 0014             		move.w	#$800,obInertia(a1)
00897D62 337C 0000 0010             		move.w	#0,obVelX(a1)
00897D68 337C 0000 0012             		move.w	#0,obVelY(a1)
00897D6E 08A8 0005 0022             		bclr	#staPush,obStatus(a0)	;Mercury Constants
00897D74 08A9 0005 0022             		bclr	#staPush,obStatus(a1)	;Mercury Constants
00897D7A 08E9 0001 0022             		bset	#1,obStatus(a1)
00897D80 3368 0008 0008             		move.w	obX(a0),obX(a1)
00897D86 3368 000C 000C             		move.w	obY(a0),obY(a1)
00897D8C 4228 0032                  		clr.b	$32(a0)
00897D9A                            
00897D9A                            locret_1675C:
00897D9A 4E75                       		rts	
00897D9C                            ; ===========================================================================
00897D9C                            
00897D9C                            loc_1675E:	; Routine 4
00897D9C 43F8 D000                  		lea	(v_player).w,a1
00897DA0 1028 0032                  		move.b	$32(a0),d0
00897DA4 5428 0032                  		addq.b	#2,$32(a0)
00897DA8 4EB9 0088 301C             		jsr	(CalcSine).l
00897DAE EA40                       		asr.w	#5,d0
00897DB0 3428 000C                  		move.w	obY(a0),d2
00897DB4 9440                       		sub.w	d0,d2
00897DB6 3342 000C                  		move.w	d2,obY(a1)
00897DBA 0C28 0080 0032             		cmpi.b	#$80,$32(a0)
00897DC0 6600                       		bne.s	locret_16796
00897DC2 6100 0000                  		bsr.w	sub_1681C
00897DC6 5428 0024                  		addq.b	#2,obRoutine(a0)
00897DD4                            
00897DD4                            locret_16796:
00897DD4 4E75                       		rts	
00897DD6                            ; ===========================================================================
00897DD6                            
00897DD6                            loc_16798:	; Routine 6
00897DD6 588F                       		addq.l	#4,sp
00897DD8 43F8 D000                  		lea	(v_player).w,a1
00897DDC 5328 002E                  		subq.b	#1,$2E(a0)
00897DE0 6A00                       		bpl.s	loc_167DA
00897DE2 3368 0036 0008             		move.w	$36(a0),obX(a1)
00897DE8 3368 0038 000C             		move.w	$38(a0),obY(a1)
00897DEE 7200                       		moveq	#0,d1
00897DF0 1228 003A                  		move.b	$3A(a0),d1
00897DF4 5801                       		addq.b	#4,d1
00897DF6 B228 003B                  		cmp.b	$3B(a0),d1
00897DFA 6500                       		bcs.s	loc_167C2
00897DFC 7200                       		moveq	#0,d1
00897DFE 6000                       		bra.s	loc_16800
00897E00                            ; ===========================================================================
00897E00                            
00897E00                            loc_167C2:
00897E00 1141 003A                  		move.b	d1,$3A(a0)
00897E04 2468 003C                  		movea.l	$3C(a0),a2
00897E08 3172 1000 0036             		move.w	(a2,d1.w),$36(a0)
00897E0E 3172 1002 0038             		move.w	2(a2,d1.w),$38(a0)
00897E14 6000 0000                  		bra.w	sub_1681C
00897E18                            ; ===========================================================================
00897E18                            
00897E18                            loc_167DA:
00897E18 2429 0008                  		move.l	obX(a1),d2
00897E1C 2629 000C                  		move.l	obY(a1),d3
00897E20 3029 0010                  		move.w	obVelX(a1),d0
00897E24 48C0                       		ext.l	d0
00897E26 E180                       		asl.l	#8,d0
00897E28 D480                       		add.l	d0,d2
00897E2A 3029 0012                  		move.w	obVelY(a1),d0
00897E2E 48C0                       		ext.l	d0
00897E30 E180                       		asl.l	#8,d0
00897E32 D680                       		add.l	d0,d3
00897E34 2342 0008                  		move.l	d2,obX(a1)
00897E38 2343 000C                  		move.l	d3,obY(a1)
00897E3C 4E75                       		rts	
00897E3E                            ; ===========================================================================
00897E3E                            
00897E3E                            loc_16800:
00897E3E 0269 07FF 000C             		andi.w	#$7FF,obY(a1)
00897E44 4228 0024                  		clr.b	obRoutine(a0)
00897E48 4238 F7C8                  		clr.b	(f_lockmulti).w
00897E4C 337C 0000 0010             		move.w	#0,obVelX(a1)
00897E52 337C 0200 0012             		move.w	#$200,obVelY(a1)
00897E58 4E75                       		rts	
00897E5A                            
00897E5A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00897E5A                            
00897E5A                            
00897E5A                            sub_1681C:
00897E5A 7000                       		moveq	#0,d0
00897E5C 343C 1000                  		move.w	#$1000,d2
00897E60 3028 0036                  		move.w	$36(a0),d0
00897E64 9069 0008                  		sub.w	obX(a1),d0
00897E68 6C00                       		bge.s	loc_16830
00897E6A 4440                       		neg.w	d0
00897E6C 4442                       		neg.w	d2
00897E6E                            
00897E6E                            loc_16830:
00897E6E 7200                       		moveq	#0,d1
00897E70 363C 1000                  		move.w	#$1000,d3
00897E74 3228 0038                  		move.w	$38(a0),d1
00897E78 9269 000C                  		sub.w	obY(a1),d1
00897E7C 6C00                       		bge.s	loc_16844
00897E7E 4441                       		neg.w	d1
00897E80 4443                       		neg.w	d3
00897E82                            
00897E82                            loc_16844:
00897E82 B240                       		cmp.w	d0,d1
00897E84 6500                       		bcs.s	loc_1687A
00897E86 7200                       		moveq	#0,d1
00897E88 3228 0038                  		move.w	$38(a0),d1
00897E8C 9269 000C                  		sub.w	obY(a1),d1
00897E90 4841                       		swap	d1
00897E92 83C3                       		divs.w	d3,d1
00897E94 7000                       		moveq	#0,d0
00897E96 3028 0036                  		move.w	$36(a0),d0
00897E9A 9069 0008                  		sub.w	obX(a1),d0
00897E9E 6700                       		beq.s	loc_16866
00897EA0 4840                       		swap	d0
00897EA2 81C1                       		divs.w	d1,d0
00897EA4                            
00897EA4                            loc_16866:
00897EA4 3340 0010                  		move.w	d0,obVelX(a1)
00897EA8 3343 0012                  		move.w	d3,obVelY(a1)
00897EAC 4A41                       		tst.w	d1
00897EAE 6A00                       		bpl.s	loc_16874
00897EB0 4441                       		neg.w	d1
00897EB2                            
00897EB2                            loc_16874:
00897EB2 3141 002E                  		move.w	d1,$2E(a0)
00897EB6 4E75                       		rts	
00897EB8                            ; ===========================================================================
00897EB8                            
00897EB8                            loc_1687A:
00897EB8 7000                       		moveq	#0,d0
00897EBA 3028 0036                  		move.w	$36(a0),d0
00897EBE 9069 0008                  		sub.w	obX(a1),d0
00897EC2 4840                       		swap	d0
00897EC4 81C2                       		divs.w	d2,d0
00897EC6 7200                       		moveq	#0,d1
00897EC8 3228 0038                  		move.w	$38(a0),d1
00897ECC 9269 000C                  		sub.w	obY(a1),d1
00897ED0 6700                       		beq.s	loc_16898
00897ED2 4841                       		swap	d1
00897ED4 83C0                       		divs.w	d0,d1
00897ED6                            
00897ED6                            loc_16898:
00897ED6 3341 0012                  		move.w	d1,obVelY(a1)
00897EDA 3342 0010                  		move.w	d2,obVelX(a1)
00897EDE 4A40                       		tst.w	d0
00897EE0 6A00                       		bpl.s	loc_168A6
00897EE2 4440                       		neg.w	d0
00897EE4                            
00897EE4                            loc_168A6:
00897EE4 3140 002E                  		move.w	d0,$2E(a0)
00897EE8 4E75                       		rts	
00897EEA                            ; End of function sub_1681C
00897EEA                            
00897EEA                            ; ===========================================================================
00897EEA 0000 0000 0000             Tele_Data:	dc.w @type00-Tele_Data, @type01-Tele_Data, @type02-Tele_Data
00897EF0 0000 0000 0000             		dc.w @type03-Tele_Data, @type04-Tele_Data, @type05-Tele_Data
00897EF6 0000 0000                  		dc.w @type06-Tele_Data, @type07-Tele_Data
00897EFA 0004 0794 098C             @type00:	dc.w 4,	$794, $98C
00897F00 0004 0094 038C             @type01:	dc.w 4,	$94, $38C
00897F06 001C 0794 02E8             @type02:	dc.w $1C, $794,	$2E8
00897F0C 07A4 02C0 07D0             		dc.w $7A4, $2C0, $7D0
00897F12 02AC 0858 02AC             		dc.w $2AC, $858, $2AC
00897F18 0884 0298 0894             		dc.w $884, $298, $894
00897F1E 0270 0894 0190             		dc.w $270, $894, $190
00897F24 0004 0894 0690             @type03:	dc.w 4,	$894, $690
00897F2A 001C 1194 0470             @type04:	dc.w $1C, $1194, $470
00897F30 1184 0498 1158             		dc.w $1184, $498, $1158
00897F36 04AC 0FD0 04AC             		dc.w $4AC, $FD0, $4AC
00897F3C 0FA4 04C0 0F94             		dc.w $FA4, $4C0, $F94
00897F42 04E8 0F94 0590             		dc.w $4E8, $F94, $590
00897F48 0004 1294 0490             @type05:	dc.w 4,	$1294, $490
00897F4E 001C 1594 FFE8             @type06:	dc.w $1C, $1594, $FFE8
00897F54 1584 FFC0 1560             		dc.w $1584, $FFC0, $1560
00897F5A FFAC 14D0 FFAC             		dc.w $FFAC, $14D0, $FFAC
00897F60 14A4 FF98 1494             		dc.w $14A4, $FF98, $1494
00897F66 FF70 1494 FD90             		dc.w $FF70, $1494, $FD90
00897F6C 0004 0894 0090             @type07:	dc.w 4,	$894, $90
00897F6C 0004 0894 0090             @type07:	dc.w 4,	$894, $90
00897F72                            
00897F72                            		include	"_incObj\78 Caterkiller.asm"
00897F72                            ; ---------------------------------------------------------------------------
00897F72                            ; Object 78 - Caterkiller enemy	(MZ, SBZ)
00897F72                            ; ---------------------------------------------------------------------------
00897F72                            
00897F72                            Caterkiller:				; XREF: Obj_Index
00897F72 7000                       		moveq	#0,d0
00897F74 1028 0024                  		move.b	obRoutine(a0),d0
00897F78 323B 0000                  		move.w	Cat_Index(pc,d0.w),d1
00897F7C 4EFB 1000                  		jmp	Cat_Index(pc,d1.w)
00897F80                            ; ===========================================================================
00897F80 0000                       Cat_Index:	dc.w Cat_Main-Cat_Index
00897F82 0000                       		dc.w Cat_Head-Cat_Index
00897F84 0000                       		dc.w Cat_BodySeg1-Cat_Index
00897F86 0000                       		dc.w Cat_BodySeg2-Cat_Index
00897F88 0000                       		dc.w Cat_BodySeg1-Cat_Index
00897F8A 0000                       		dc.w Cat_Delete-Cat_Index
00897F8C 0000                       		dc.w loc_16CC0-Cat_Index
00897F8E                            
00897F8E =0000003C                  cat_parent:	= $3C		; address of parent object
00897F8E                            ; ===========================================================================
00897F8E                            
00897F8E                            locret_16950:
00897F8E 4E75                       		rts	
00897F90                            ; ===========================================================================
00897F90                            
00897F90                            Cat_Main:	; Routine 0
00897F90 117C 0007 0016             		move.b	#7,obHeight(a0)
00897F96 117C 0008 0017             		move.b	#8,obWidth(a0)
00897F9C 4EB9 0088 E392             		jsr	ObjectMoveAndFall
00897FA2 4EB9 0089 6456             		jsr	ObjFloorDist
00897FA8 4A41                       		tst.w	d1
00897FAA 6AE2                       		bpl.s	locret_16950
00897FAC D368 000C                  		add.w	d1,obY(a0)
00897FB0 4268 0012                  		clr.w	obVelY(a0)
00897FB4 5428 0024                  		addq.b	#2,obRoutine(a0)
00897FB8 217C 0000 0000 0004        		move.l	#Map_Cat,obMap(a0)
00897FC0 317C 22B0 0002             		move.w	#$22B0,obGfx(a0)
00897FC6 0C38 0005 FE10             		cmpi.b	#id_SBZ,(v_zone).w ; if level is SBZ, branch
00897FCC 6700                       		beq.s	@isscrapbrain
00897FCE 317C 24FF 0002             		move.w	#$24FF,obGfx(a0) ; MZ specific code
00897FD4                            
00897FD4                            	@isscrapbrain:
00897FD4 0228 0003 0001             		andi.b	#3,obRender(a0)
00897FDA 0028 0004 0001             		ori.b	#4,obRender(a0)
00897FE0 1168 0001 0022             		move.b	obRender(a0),obStatus(a0)
00897FE6 117C 0004 0018             		move.b	#4,obPriority(a0)
00897FEC 117C 0008 0019             		move.b	#8,obActWid(a0)
00897FF2 117C 000B 0020             		move.b	#$B,obColType(a0)
00897FF8 3428 0008                  		move.w	obX(a0),d2
00897FFC 7A0C                       		moveq	#$C,d5
00897FFE 0828 0000 0022             		btst	#0,obStatus(a0)
00898004 6700                       		beq.s	@noflip
00898006 4445                       		neg.w	d5
00898008                            
00898008                            	@noflip:
00898008 1C3C 0004                  		move.b	#4,d6
0089800C 7600                       		moveq	#0,d3
0089800E 7804                       		moveq	#4,d4
00898010 2448                       		movea.l	a0,a2
00898012 7202                       		moveq	#2,d1
00898014                            
00898014                            Cat_Loop:
00898014 4EB9 0088 E878             		jsr	FindNextFreeObj
0089801A                            
0089801A 6600 0000                  		bne.w	Cat_ChkGone
0089801E                            
0089801E 137C 0078 0000             		move.b	#id_Caterkiller,0(a1) ; load body segment object
00898024 1346 0024                  		move.b	d6,obRoutine(a1) ; goto Cat_BodySeg1 or Cat_BodySeg2 next
00898028 5406                       		addq.b	#2,d6		; alternate between the two
0089802A 2368 0004 0004             		move.l	obMap(a0),obMap(a1)
00898030 3368 0002 0002             		move.w	obGfx(a0),obGfx(a1)
00898036 137C 0005 0018             		move.b	#5,obPriority(a1)
0089803C 137C 0008 0019             		move.b	#8,obActWid(a1)
00898042 137C 00CB 0020             		move.b	#$CB,obColType(a1)
00898048 D445                       		add.w	d5,d2
0089804A 3342 0008                  		move.w	d2,obX(a1)
0089804E 3368 000C 000C             		move.w	obY(a0),obY(a1)
00898054 1368 0022 0022             		move.b	obStatus(a0),obStatus(a1)
0089805A 1368 0022 0001             		move.b	obStatus(a0),obRender(a1)
00898060 137C 0008 001A             		move.b	#8,obFrame(a1)
00898066 234A 003C                  		move.l	a2,cat_parent(a1)
0089806A 1344 003C                  		move.b	d4,cat_parent(a1)
0089806E 5804                       		addq.b	#4,d4
00898070 2449                       		movea.l	a1,a2
00898072                            
00898072                            	@fail:
00898072 51C9 FFA0                  		dbf	d1,Cat_Loop	; repeat sequence 2 more times
00898076                            
00898076 117C 0007 002A             		move.b	#7,$2A(a0)
0089807C 4228 003C                  		clr.b	cat_parent(a0)
00898080                            
00898080                            Cat_Head:	; Routine 2
00898080 4A28 0022                  		tst.b	obStatus(a0)
00898084 6B00 0000                  		bmi.w	loc_16C96
00898088 7000                       		moveq	#0,d0
0089808A 1028 0025                  		move.b	ob2ndRout(a0),d0
0089808E 323B 0000                  		move.w	Cat_Index2(pc,d0.w),d1
00898092 4EBB 1000                  		jsr	Cat_Index2(pc,d1.w)
00898096 1228 002B                  		move.b	$2B(a0),d1
0089809A 6A00                       		bpl.s	@display
0089809C 43F9 0000 0000             		lea	(Ani_Cat).l,a1
008980A2 1028 0026                  		move.b	obAngle(a0),d0
008980A6 0240 007F                  		andi.w	#$7F,d0
008980AA 5828 0026                  		addq.b	#4,obAngle(a0)
008980AE 1031 0000                  		move.b	(a1,d0.w),d0
008980B2 6A00                       		bpl.s	@animate
008980B4 08A8 0007 002B             		bclr	#7,$2B(a0)
008980BA 6000                       		bra.s	@display
008980BC                            
008980BC                            	@animate:
008980BC 0201 0010                  		andi.b	#$10,d1
008980C0 D001                       		add.b	d1,d0
008980C2 1140 001A                  		move.b	d0,obFrame(a0)
008980C6                            
008980C6                            	@display:
008980E4 4EF9 0088 E3CC             		jmp	DisplaySprite
008980EA                            
008980EA                            	Cat_ChkGone:
008980EA 45F8 FC00                  		lea	(v_objstate).w,a2
008980EE 7000                       		moveq	#0,d0
008980F0 1028 0023                  		move.b	obRespawnNo(a0),d0
008980F4 6700                       		beq.s	@delete
008980F6 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
008980FC                            
008980FC                            	@delete:
008980FC 117C 000A 0024             		move.b	#$A,obRoutine(a0)	; goto Cat_Delete next
00898102 4E75                       		rts	
00898104                            ; ===========================================================================
00898104                            
00898104                            Cat_Delete:	; Routine $A
00898104 4EF9 0088 E408             		jmp	DeleteObject
0089810A                            ; ===========================================================================
0089810A 0000                       Cat_Index2:	dc.w @wait-Cat_Index2
0089810C 0000                       		dc.w loc_16B02-Cat_Index2
0089810E                            ; ===========================================================================
0089810E                            
0089810E                            @wait:
0089810E 5328 002A                  		subq.b	#1,$2A(a0)
00898112 6B00                       		bmi.s	@move
00898114 4E75                       		rts	
00898116                            ; ===========================================================================
00898116                            
00898116                            @move:
00898116 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089811A 117C 0010 002A             		move.b	#$10,$2A(a0)
00898120 317C FF40 0010             		move.w	#-$C0,obVelX(a0)
00898126 317C 0040 0014             		move.w	#$40,obInertia(a0)
0089812C 0868 0004 002B             		bchg	#4,$2B(a0)
00898132 6600                       		bne.s	loc_16AFC
00898134 4268 0010                  		clr.w	obVelX(a0)
00898138 4468 0014                  		neg.w	obInertia(a0)
0089813C                            
0089813C                            loc_16AFC:
0089813C 08E8 0007 002B             		bset	#7,$2B(a0)
00898142                            
00898142                            loc_16B02:				; XREF: Cat_Index2
00898142 5328 002A                  		subq.b	#1,$2A(a0)
00898146 6B00                       		bmi.s	@loc_16B5E
00898148                            	
00898148 4A68 0010                  		tst.w	obVelX(a0)
0089814C 6700                       		beq.s	@notmoving
0089814E 2428 0008                  		move.l	obX(a0),d2
00898152 2602                       		move.l	d2,d3
00898154                            
00898154 3028 0010                  		move.w	obVelX(a0),d0
00898158 0828 0000 0022             		btst	#0,obStatus(a0)
0089815E 6700                       		beq.s	@noflip
00898160 4440                       		neg.w	d0
00898162                            
00898162                            	@noflip:
00898162 48C0                       		ext.l	d0
00898164 E180                       		asl.l	#8,d0
00898166 D480                       		add.l	d0,d2
00898168 2142 0008                  		move.l	d2,obX(a0)
0089816C                            
0089816C 4843                       		swap.w	d3
0089816E B668 0008                  		cmp.w	obX(a0),d3
00898172 6700                       		beq.s	@notmoving
00898174 4EB9 0089 6456             		jsr	ObjFloorDist
0089817A 0C41 FFF8                  		cmpi.w	#$FFF8,d1
0089817E 6D00                       		blt.s	@loc_16B70
00898180 0C41 000C                  		cmpi.w	#$C,d1
00898184 6C00                       		bge.s	@loc_16B70
00898186 D368 000C                  		add.w	d1,obY(a0)
0089818A                            
0089818A 7000                       		moveq	#0,d0
0089818C 1028 003C                  		move.b	cat_parent(a0),d0
00898190 5228 003C                  		addq.b	#1,cat_parent(a0)
00898194 0228 000F 003C             		andi.b	#$F,cat_parent(a0)
0089819A 1181 002C                  		move.b	d1,$2C(a0,d0.w)
0089819E                            
0089819E                            	@notmoving:
0089819E 4E75                       		rts	
008981A0                            ; ===========================================================================
008981A0                            
008981A0                            @loc_16B5E:
008981A0 5528 0025                  		subq.b	#2,ob2ndRout(a0)
008981A4 117C 0007 002A             		move.b	#7,$2A(a0)
008981AA                            
008981AA 4268 0010                  		clr.w	obVelX(a0)
008981AE 4268 0014                  		clr.w	obInertia(a0)
008981B2                            
008981B2 4E75                       		rts	
008981B4                            ; ===========================================================================
008981B4                            
008981B4                            @loc_16B70:
008981B4 7000                       		moveq	#0,d0
008981B6 1028 003C                  		move.b	cat_parent(a0),d0
008981BA 11BC 0080 002C             		move.b	#$80,$2C(a0,d0)
008981C0 4468 000A                  		neg.w	obX+2(a0)
008981C4 6700                       		beq.s	@loc_1730A
008981C6 0828 0000 0022             		btst	#0,obStatus(a0)
008981CC 6700                       		beq.s	@loc_1730A
008981CE 5368 0008                  		subq.w	#1,obX(a0)
008981D2 5228 003C                  		addq.b	#1,cat_parent(a0)
008981D6 7000                       		moveq	#0,d0
008981D8 1028 003C                  		move.b	cat_parent(a0),d0
008981DC 4230 002C                  		clr.b	$2C(a0,d0)
008981E0                            @loc_1730A:
008981E0 0868 0000 0022             		bchg	#0,obStatus(a0)
008981E6 1168 0022 0001             		move.b	obStatus(a0),obRender(a0)
008981EC                            
008981EC 5228 003C                  		addq.b	#1,cat_parent(a0)
008981F0 0228 000F 003C             		andi.b	#$F,cat_parent(a0)
008981F6 4E75                       		rts	
008981F8                            ; ===========================================================================
008981F8                            
008981F8                            Cat_BodySeg2:	; Routine 6
008981F8 2268 003C                  		movea.l	cat_parent(a0),a1
008981FC 1169 002B 002B             		move.b	$2B(a1),$2B(a0)
00898202 6A00                       		bpl.s	Cat_BodySeg1
00898204 43F9 0000 0000             		lea	(Ani_Cat).l,a1
0089820A 1028 0026                  		move.b	obAngle(a0),d0
0089820E 0240 007F                  		andi.w	#$7F,d0
00898212 5828 0026                  		addq.b	#4,obAngle(a0)
00898216 4A31 0004                  		tst.b	4(a1,d0.w)
0089821A 6A00                       		bpl.s	Cat_AniBody
0089821C 5828 0026                  		addq.b	#4,obAngle(a0)
00898220                            
00898220                            Cat_AniBody:
00898220 1031 0000                  		move.b	(a1,d0.w),d0
00898224 5000                       		addq.b	#8,d0
00898226 1140 001A                  		move.b	d0,obFrame(a0)
0089822A                            
0089822A                            Cat_BodySeg1:	; Routine 4, 8
0089822A 2268 003C                  		movea.l	cat_parent(a0),a1
0089822E 4A28 0022                  		tst.b	obStatus(a0)
00898232 6B00 0000                  		bmi.w	loc_16C90
00898236 1169 002B 002B             		move.b	$2B(a1),$2B(a0)
0089823C 1169 0025 0025             		move.b	ob2ndRout(a1),ob2ndRout(a0)
00898242 6700 0000                  		beq.w	loc_16C64
00898246 3169 0014 0014             		move.w	obInertia(a1),obInertia(a0)
0089824C 3029 0010                  		move.w	obVelX(a1),d0
00898250                            
00898250 D068 0014                  		add.w	obInertia(a0),d0
00898254                            
00898254 3140 0010                  		move.w	d0,obVelX(a0)
00898258 2428 0008                  		move.l	obX(a0),d2
0089825C 2602                       		move.l	d2,d3
0089825E 3028 0010                  		move.w	obVelX(a0),d0
00898262 0828 0000 0022             		btst	#0,obStatus(a0)
00898268 6700                       		beq.s	loc_16C0C
0089826A 4440                       		neg.w	d0
0089826C                            
0089826C                            loc_16C0C:
0089826C 48C0                       		ext.l	d0
0089826E E180                       		asl.l	#8,d0
00898270 D480                       		add.l	d0,d2
00898272 2142 0008                  		move.l	d2,obX(a0)
00898276 4843                       		swap	d3
00898278 B668 0008                  		cmp.w	obX(a0),d3
0089827C 6700                       		beq.s	loc_16C64
0089827E 7000                       		moveq	#0,d0
00898280 1028 003C                  		move.b	cat_parent(a0),d0
00898284 1231 002C                  		move.b	$2C(a1,d0.w),d1
00898288 0C01 0080                  		cmpi.b	#$80,d1
0089828C 6600                       		bne.s	loc_16C50
0089828E                            
0089828E 1181 002C                  		move.b	d1,$2C(a0,d0)
00898292 4468 000A                  		neg.w	obX+2(a0)
00898296 6700                       		beq.s	locj_173E4
00898298 0828 0000 0022             		btst	#0,obStatus(a0)
0089829E 6700                       		beq.s	locj_173E4
008982A0 0C68 FF40 0010             		cmpi.w	#-$C0,obVelX(a0)
008982A6 6600                       		bne.s	locj_173E4
008982A8 5368 0008                  		subq.w	#1,obX(a0)
008982AC 5228 003C                  		addq.b	#1,cat_parent(a0)
008982B0 7000                       		moveq	#0,d0
008982B2 1028 003C                  		move.b	cat_parent(a0),d0
008982B6 4230 002C                  		clr.b	$2C(a0,d0)
008982BA                            locj_173E4:
008982BA 0868 0000 0022             		bchg	#0,obStatus(a0)
008982C0 1168 0022 0001             		move.b	obStatus(a0),1(a0)
008982C6 5228 003C                  		addq.b	#1,cat_parent(a0)
008982CA 0228 000F 003C             		andi.b	#$F,cat_parent(a0)
008982D0 6000                       		bra.s	loc_16C64
008982D2                            ; ===========================================================================
008982D2                            
008982D2                            loc_16C50:
008982D2 4881                       		ext.w	d1
008982D4 D368 000C                  		add.w	d1,obY(a0)
008982D8 5228 003C                  		addq.b	#1,cat_parent(a0)
008982DC 0228 000F 003C             		andi.b	#$F,cat_parent(a0)
008982E2 1181 002C                  		move.b	d1,$2C(a0,d0.w)
008982E6                            
008982E6                            loc_16C64:
008982E6 0C29 000C 0024             		cmpi.b	#$C,obRoutine(a1)
008982EC 6700                       		beq.s	loc_16C90
008982EE 0C29 0027 0000             		cmpi.b	#id_ExplosionItem,0(a1)
008982F4 6700                       		beq.s	loc_16C7C
008982F6 0C29 000A 0024             		cmpi.b	#$A,obRoutine(a1)
008982FC 6600                       		bne.s	loc_16C82
008982FE                            
008982FE                            loc_16C7C:
008982FE 117C 000A 0024             		move.b	#$A,obRoutine(a0)
00898304                            
00898304                            loc_16C82:
00898304 4EF9 0088 E3CC             		jmp	DisplaySprite
0089830A                            
0089830A                            ; ===========================================================================
0089830A FE00 FE80 0180 0200        Cat_FragSpeed:	dc.w -$200, -$180, $180, $200
00898312                            ; ===========================================================================
00898312                            
00898312                            loc_16C90:
00898312 08E9 0007 0022             		bset	#7,obStatus(a1)
00898318                            
00898318                            loc_16C96:
00898318 7000                       		moveq	#0,d0
0089831A 1028 0024                  		move.b	obRoutine(a0),d0
0089831E 303B 00E8                  		move.w	Cat_FragSpeed-2(pc,d0.w),d0
00898322 0828 0000 0022             		btst	#0,obStatus(a0)
00898328 6700                       		beq.s	loc_16CAA
0089832A 4440                       		neg.w	d0
0089832C                            
0089832C                            loc_16CAA:
0089832C 3140 0010                  		move.w	d0,obVelX(a0)
00898330 317C FC00 0012             		move.w	#-$400,obVelY(a0)
00898336 117C 000C 0024             		move.b	#$C,obRoutine(a0)
0089833C                            		
0089833C 117C 0098 0020             		move.b	#$98,obColType(a0)
00898342                            		
00898342 0228 00F8 001A             		andi.b	#$F8,obFrame(a0)
00898348                            
00898348                            loc_16CC0:	; Routine $C
00898348 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089834E 4A68 0012                  		tst.w	obVelY(a0)
00898352 6B00                       		bmi.s	loc_16CE0
00898354 4EB9 0089 6456             		jsr	ObjFloorDist
0089835A 4A41                       		tst.w	d1
0089835C 6A00                       		bpl.s	loc_16CE0
0089835E D368 000C                  		add.w	d1,obY(a0)
00898362 317C FC00 0012             		move.w	#-$400,obVelY(a0)
00898368                            
00898368                            loc_16CE0:
00898368 4A28 0001                  		tst.b	obRender(a0)
0089836C 6A00 FD7C                  		bpl.w	Cat_ChkGone
00898370 4EF9 0088 E3CC             		jmp	DisplaySprite
00898370 4EF9 0088 E3CC             		jmp	DisplaySprite
00898376                            		include	"_anim\Caterkiller.asm"
00898376                            ; ---------------------------------------------------------------------------
00898376                            ; Animation script - Caterkiller enemy (uses non-standard format)
00898376                            ; ---------------------------------------------------------------------------
00898376 0000 0000 0000 0000 0000+  Ani_Cat:	dc.b 0,	0, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, 0, 0, 0, 1
00898386 0101 0101 0101 0202 0202+  		dc.b 1,	1, 1, 1, 1, 1, 2, 2, 2,	2, 2, 3, 3, 3, 3, 3
00898396 0404 0404 0404 0505 0505+  		dc.b 4,	4, 4, 4, 4, 4, 5, 5, 5,	5, 5, 6, 6, 6, 6, 6
008983A6 0606 0707 0707 0707 0707+  		dc.b 6,	6, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, $FF, 7, 7, $FF
008983B6 0707 0707 0707 0707 0707+  		dc.b 7,	7, 7, 7, 7, 7, 7, 7, 7,	7, 7, 7, 7, 7, 7, 6
008983C6 0606 0606 0606 0505 0505+  		dc.b 6,	6, 6, 6, 6, 6, 5, 5, 5,	5, 5, 4, 4, 4, 4, 4
008983D6 0403 0303 0303 0202 0202+  		dc.b 4,	3, 3, 3, 3, 3, 2, 2, 2,	2, 2, 1, 1, 1, 1, 1
008983E6 0101 0000 0000 0000 0000+  		dc.b 1,	1, 0, 0, 0, 0, 0, 0, 0,	0, 0, 0, $FF, 0, 0, $FF
008983F6                            		even
008983F6                            		even
008983F6                            		include	"_maps\Caterkiller.asm"
008983F6                            ; ---------------------------------------------------------------------------
008983F6                            ; Sprite mappings - Caterkiller	enemy (MZ, SBZ)
008983F6                            ; ---------------------------------------------------------------------------
008983F6 0000 0000                  Map_Cat:	dc.w byte_16D9E-Map_Cat, byte_16DA4-Map_Cat
008983FA 0000 0000                  		dc.w byte_16DAA-Map_Cat, byte_16DB0-Map_Cat
008983FE 0000 0000                  		dc.w byte_16DB6-Map_Cat, byte_16DBC-Map_Cat
00898402 0000 0000                  		dc.w byte_16DC2-Map_Cat, byte_16DC8-Map_Cat
00898406 0000 0000                  		dc.w byte_16DCE-Map_Cat, byte_16DD4-Map_Cat
0089840A 0000 0000                  		dc.w byte_16DDA-Map_Cat, byte_16DE0-Map_Cat
0089840E 0000 0000                  		dc.w byte_16DE6-Map_Cat, byte_16DEC-Map_Cat
00898412 0000 0000                  		dc.w byte_16DF2-Map_Cat, byte_16DF8-Map_Cat
00898416 0000 0000                  		dc.w byte_16DFE-Map_Cat, byte_16E04-Map_Cat
0089841A 0000 0000                  		dc.w byte_16E0A-Map_Cat, byte_16E10-Map_Cat
0089841E 0000 0000                  		dc.w byte_16E16-Map_Cat, byte_16E1C-Map_Cat
00898422 0000 0000                  		dc.w byte_16E22-Map_Cat, byte_16E28-Map_Cat
00898426 01                         byte_16D9E:	dc.b 1
00898427 F206 0000 F8               		dc.b $F2, 6, 0,	0, $F8
0089842C 01                         byte_16DA4:	dc.b 1
0089842D F106 0000 F8               		dc.b $F1, 6, 0,	0, $F8
00898432 01                         byte_16DAA:	dc.b 1
00898433 F006 0000 F8               		dc.b $F0, 6, 0,	0, $F8
00898438 01                         byte_16DB0:	dc.b 1
00898439 EF06 0000 F8               		dc.b $EF, 6, 0,	0, $F8
0089843E 01                         byte_16DB6:	dc.b 1
0089843F EE06 0000 F8               		dc.b $EE, 6, 0,	0, $F8
00898444 01                         byte_16DBC:	dc.b 1
00898445 ED06 0000 F8               		dc.b $ED, 6, 0,	0, $F8
0089844A 01                         byte_16DC2:	dc.b 1
0089844B EC06 0000 F8               		dc.b $EC, 6, 0,	0, $F8
00898450 01                         byte_16DC8:	dc.b 1
00898451 EB06 0000 F8               		dc.b $EB, 6, 0,	0, $F8
00898456 01                         byte_16DCE:	dc.b 1
00898457 F805 000C F8               		dc.b $F8, 5, 0,	$C, $F8
0089845C 01                         byte_16DD4:	dc.b 1
0089845D F705 000C F8               		dc.b $F7, 5, 0,	$C, $F8
00898462 01                         byte_16DDA:	dc.b 1
00898463 F605 000C F8               		dc.b $F6, 5, 0,	$C, $F8
00898468 01                         byte_16DE0:	dc.b 1
00898469 F505 000C F8               		dc.b $F5, 5, 0,	$C, $F8
0089846E 01                         byte_16DE6:	dc.b 1
0089846F F405 000C F8               		dc.b $F4, 5, 0,	$C, $F8
00898474 01                         byte_16DEC:	dc.b 1
00898475 F305 000C F8               		dc.b $F3, 5, 0,	$C, $F8
0089847A 01                         byte_16DF2:	dc.b 1
0089847B F205 000C F8               		dc.b $F2, 5, 0,	$C, $F8
00898480 01                         byte_16DF8:	dc.b 1
00898481 F105 000C F8               		dc.b $F1, 5, 0,	$C, $F8
00898486 01                         byte_16DFE:	dc.b 1
00898487 F206 0006 F8               		dc.b $F2, 6, 0,	6, $F8
0089848C 01                         byte_16E04:	dc.b 1
0089848D F106 0006 F8               		dc.b $F1, 6, 0,	6, $F8
00898492 01                         byte_16E0A:	dc.b 1
00898493 F006 0006 F8               		dc.b $F0, 6, 0,	6, $F8
00898498 01                         byte_16E10:	dc.b 1
00898499 EF06 0006 F8               		dc.b $EF, 6, 0,	6, $F8
0089849E 01                         byte_16E16:	dc.b 1
0089849F EE06 0006 F8               		dc.b $EE, 6, 0,	6, $F8
008984A4 01                         byte_16E1C:	dc.b 1
008984A5 ED06 0006 F8               		dc.b $ED, 6, 0,	6, $F8
008984AA 01                         byte_16E22:	dc.b 1
008984AB EC06 0006 F8               		dc.b $EC, 6, 0,	6, $F8
008984B0 01                         byte_16E28:	dc.b 1
008984B1 EB06 0006 F8               		dc.b $EB, 6, 0,	6, $F8
008984B6                            		even
008984B6                            		even
008984B6                            
008984B6                            		include	"_incObj\79 Lamppost.asm"
008984B6                            ; ---------------------------------------------------------------------------
008984B6                            ; Object 79 - lamppost
008984B6                            ; ---------------------------------------------------------------------------
008984B6                            
008984B6                            Lamppost:				; XREF: Obj_Index
008984B6 7000                       		moveq	#0,d0
008984B8 1028 0024                  		move.b	obRoutine(a0),d0
008984BC 323B 0000                  		move.w	Lamp_Index(pc,d0.w),d1
008984C0 4EBB 1000                  		jsr	Lamp_Index(pc,d1.w)
008984C4 4EF9 0089 048C             		jmp	RememberState
008984CA                            ; ===========================================================================
008984CA 0000                       Lamp_Index:	dc.w Lamp_Main-Lamp_Index
008984CC 0000                       		dc.w Lamp_Blue-Lamp_Index
008984CE 0000                       		dc.w Lamp_Finish-Lamp_Index
008984D0 0000                       		dc.w Lamp_Twirl-Lamp_Index
008984D2                            
008984D2 =00000030                  lamp_origX:	= $30		; original x-axis position
008984D2 =00000032                  lamp_origY:	= $32		; original y-axis position
008984D2 =00000036                  lamp_time:	= $36		; length of time to twirl the lamp
008984D2                            ; ===========================================================================
008984D2                            
008984D2                            Lamp_Main:	; Routine 0
008984D2 5428 0024                  		addq.b	#2,obRoutine(a0)
008984D6 217C 0000 0000 0004        		move.l	#Map_Lamp,obMap(a0)
008984DE                            		
008984DE 317C 06C0 0002             		move.w	#($D800/$20),obGfx(a0)
008984E4                            		
008984E4 117C 0004 0001             		move.b	#4,obRender(a0)
008984EA 117C 0008 0019             		move.b	#8,obActWid(a0)
008984F0 117C 0005 0018             		move.b	#5,obPriority(a0)
008984F6 45F8 FC00                  		lea	(v_objstate).w,a2
008984FA 7000                       		moveq	#0,d0
008984FC 1028 0023                  		move.b	obRespawnNo(a0),d0
00898500 08B2 0007 0002             		bclr	#7,2(a2,d0.w)
00898506 0832 0000 0002             		btst	#0,2(a2,d0.w)
0089850C 6600                       		bne.s	@red
0089850E 1238 FE30                  		move.b	(v_lastlamp).w,d1
00898512 0201 007F                  		andi.b	#$7F,d1
00898516 1428 0028                  		move.b	obSubtype(a0),d2 ; get lamppost number
0089851A 0202 007F                  		andi.b	#$7F,d2
0089851E B202                       		cmp.b	d2,d1		; is this a "new" lamppost?
00898520 6500                       		bcs.s	Lamp_Blue	; if yes, branch
00898522                            
00898522                            @red:
00898522 08F2 0000 0002             		bset	#0,2(a2,d0.w)
00898528 117C 0004 0024             		move.b	#4,obRoutine(a0) ; goto Lamp_Finish next
0089852E 117C 0003 001A             		move.b	#3,obFrame(a0)	; use red lamppost frame
00898534 4E75                       		rts	
00898536                            ; ===========================================================================
00898536                            
00898536                            Lamp_Blue:	; Routine 2
00898536 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	being used?
0089853A 6600 0000                  		bne.w	@donothing	; if yes, branch
0089853E 4A38 F7C8                  		tst.b	(f_lockmulti).w
00898542 6B00 0000                  		bmi.w	@donothing
00898546 1238 FE30                  		move.b	(v_lastlamp).w,d1
0089854A 0201 007F                  		andi.b	#$7F,d1
0089854E 1428 0028                  		move.b	obSubtype(a0),d2
00898552 0202 007F                  		andi.b	#$7F,d2
00898556 B202                       		cmp.b	d2,d1		; is this a "new" lamppost?
00898558 6500                       		bcs.s	@chkhit		; if yes, branch
0089855A 45F8 FC00                  		lea	(v_objstate).w,a2
0089855E 7000                       		moveq	#0,d0
00898560 1028 0023                  		move.b	obRespawnNo(a0),d0
00898564 08F2 0000 0002             		bset	#0,2(a2,d0.w)
0089856A 117C 0004 0024             		move.b	#4,obRoutine(a0)
00898570 117C 0003 001A             		move.b	#3,obFrame(a0)
00898576 6000 0000                  		bra.w	@donothing
0089857A                            ; ===========================================================================
0089857A                            
0089857A                            @chkhit:
0089857A 3038 D008                  		move.w	(v_player+obX).w,d0
0089857E 9068 0008                  		sub.w	obX(a0),d0
00898582 5040                       		addq.w	#8,d0
00898584 0C40 0010                  		cmpi.w	#$10,d0
00898588 6400 0000                  		bcc.w	@donothing
0089858C 3038 D00C                  		move.w	(v_player+obY).w,d0
00898590 9068 000C                  		sub.w	obY(a0),d0
00898594 0640 0040                  		addi.w	#$40,d0
00898598 0C40 0068                  		cmpi.w	#$68,d0
0089859C 6400                       		bcc.s	@donothing
0089859E                            
008985A8 5428 0024                  		addq.b	#2,obRoutine(a0)
008985AC 4EB9 0088 E862             		jsr	FindFreeObj
008985B2 6600                       		bne.s	@fail
008985B4 137C 0079 0000             		move.b	#$79,0(a1)	; load twirling	lamp object
008985BA 137C 0006 0024             		move.b	#6,obRoutine(a1) ; goto Lamp_Twirl next
008985C0 3368 0008 0030             		move.w	obX(a0),lamp_origX(a1)
008985C6 3368 000C 0032             		move.w	obY(a0),lamp_origY(a1)
008985CC 0469 0018 0032             		subi.w	#$18,lamp_origY(a1)
008985D2 237C 0000 0000 0004        		move.l	#Map_Lamp,obMap(a1)
008985DA                            
008985DA 337C 06C0 0002             		move.w	#($D800/$20),obGfx(a1)
008985E0                            		
008985E0 137C 0004 0001             		move.b	#4,obRender(a1)
008985E6 137C 0008 0019             		move.b	#8,obActWid(a1)
008985EC 137C 0004 0018             		move.b	#4,obPriority(a1)
008985F2 137C 0002 001A             		move.b	#2,obFrame(a1)	; use "ball only" frame
008985F8 337C 0020 0036             		move.w	#$20,lamp_time(a1)
008985FE                            
008985FE                            	@fail:
008985FE 117C 0001 001A             		move.b	#1,obFrame(a0)	; use "post only" frame
00898604 6100 0000                  		bsr.w	Lamp_StoreInfo
00898608 45F8 FC00                  		lea	(v_objstate).w,a2
0089860C 7000                       		moveq	#0,d0
0089860E 1028 0023                  		move.b	obRespawnNo(a0),d0
00898612 08F2 0000 0002             		bset	#0,2(a2,d0.w)
00898618                            
00898618                            	@donothing:
00898618 4E75                       		rts	
0089861A                            ; ===========================================================================
0089861A                            
0089861A                            Lamp_Finish:	; Routine 4
0089861A 4E75                       		rts	
0089861C                            ; ===========================================================================
0089861C                            
0089861C                            Lamp_Twirl:	; Routine 6
0089861C 5368 0036                  		subq.w	#1,lamp_time(a0) ; decrement timer
00898620 6A00                       		bpl.s	@continue	; if time remains, keep twirling
00898622 117C 0004 0024             		move.b	#4,obRoutine(a0) ; goto Lamp_Finish next
00898628                            
00898628                            	@continue:
00898628 1028 0026                  		move.b	obAngle(a0),d0
0089862C 0428 0010 0026             		subi.b	#$10,obAngle(a0)
00898632 0400 0040                  		subi.b	#$40,d0
00898636 4EB9 0088 301C             		jsr	(CalcSine).l
0089863C C3FC 0C00                  		muls.w	#$C00,d1
00898640 4841                       		swap	d1
00898642 D268 0030                  		add.w	lamp_origX(a0),d1
00898646 3141 0008                  		move.w	d1,obX(a0)
0089864A C1FC 0C00                  		muls.w	#$C00,d0
0089864E 4840                       		swap	d0
00898650 D068 0032                  		add.w	lamp_origY(a0),d0
00898654 3140 000C                  		move.w	d0,obY(a0)
00898658 4E75                       		rts	
0089865A                            ; ===========================================================================
0089865A                            ; ---------------------------------------------------------------------------
0089865A                            ; Subroutine to	store information when you hit a lamppost
0089865A                            ; ---------------------------------------------------------------------------
0089865A                            
0089865A                            Lamp_StoreInfo:
0089865A 11E8 0028 FE30             		move.b	obSubtype(a0),(v_lastlamp).w 	; lamppost number
00898660 11F8 FE30 FE31             		move.b	(v_lastlamp).w,($FFFFFE31).w
00898666 31E8 0008 FE32             		move.w	obX(a0),($FFFFFE32).w		; x-position
0089866C 31E8 000C FE34             		move.w	obY(a0),($FFFFFE34).w		; y-position
00898672 31F8 FE20 FE36             		move.w	(v_rings).w,($FFFFFE36).w 	; rings
00898678 11F8 FE1B FE54             		move.b	(v_lifecount).w,($FFFFFE54).w 	; lives
0089867E 21F8 FE22 FE38             		move.l	(v_time).w,($FFFFFE38).w 	; time
00898684 11F8 F742 FE3C             		move.b	(v_dle_routine).w,($FFFFFE3C).w ; routine counter for dynamic level mod
0089868A 31F8 F72E FE3E             		move.w	(v_limitbtm2).w,($FFFFFE3E).w 	; lower y-boundary of level
00898690 31F8 F700 FE40             		move.w	(v_screenposx).w,($FFFFFE40).w 	; screen x-position
00898696 31F8 F704 FE42             		move.w	(v_screenposy).w,($FFFFFE42).w 	; screen y-position
0089869C 31F8 F708 FE44             		move.w	($FFFFF708).w,($FFFFFE44).w 	; bg position
008986A2 31F8 F70C FE46             		move.w	($FFFFF70C).w,($FFFFFE46).w 	; bg position
008986A8 31F8 F710 FE48             		move.w	($FFFFF710).w,($FFFFFE48).w 	; bg position
008986AE 31F8 F714 FE4A             		move.w	($FFFFF714).w,($FFFFFE4A).w 	; bg position
008986B4 31F8 F718 FE4C             		move.w	($FFFFF718).w,($FFFFFE4C).w 	; bg position
008986BA 31F8 F71C FE4E             		move.w	($FFFFF71C).w,($FFFFFE4E).w 	; bg position
008986C0 31F8 F648 FE50             		move.w	(v_waterpos2).w,($FFFFFE50).w 	; water height
008986C6 11F8 F64D FE52             		move.b	(v_wtr_routine).w,($FFFFFE52).w ; rountine counter for water
008986CC 11F8 F64E FE53             		move.b	(f_wtr_state).w,($FFFFFE53).w 	; water direction
008986D2 4E75                       		rts	
008986D4                            
008986D4                            ; ---------------------------------------------------------------------------
008986D4                            ; Subroutine to	load stored info when you start	a level	from a lamppost
008986D4                            ; ---------------------------------------------------------------------------
008986D4                            
008986D4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008986D4                            
008986D4                            
008986D4                            Lamp_LoadInfo:				; XREF: LevelSizeLoad
008986D4 11F8 FE31 FE30             		move.b	($FFFFFE31).w,(v_lastlamp).w
008986DA 31F8 FE32 D008             		move.w	($FFFFFE32).w,(v_player+obX).w
008986E0 31F8 FE34 D00C             		move.w	($FFFFFE34).w,(v_player+obY).w
008986E6 31F8 FE36 FE20             		move.w	($FFFFFE36).w,(v_rings).w
008986EC 11F8 FE54 FE1B             		move.b	($FFFFFE54).w,(v_lifecount).w
008986F2 4278 FE20                  		clr.w	(v_rings).w
008986F6 4238 FE1B                  		clr.b	(v_lifecount).w
008986FA 21F8 FE38 FE22             		move.l	($FFFFFE38).w,(v_time).w
00898700 11FC 003B FE25             		move.b	#59,(v_timecent).w
00898706 5338 FE24                  		subq.b	#1,(v_timesec).w
0089870A 11F8 FE3C F742             		move.b	($FFFFFE3C).w,(v_dle_routine).w
00898710 11F8 FE52 F64D             		move.b	($FFFFFE52).w,(v_wtr_routine).w
00898716 31F8 FE3E F72E             		move.w	($FFFFFE3E).w,(v_limitbtm2).w
0089871C 31F8 FE3E F726             		move.w	($FFFFFE3E).w,(v_limitbtm1).w
00898722 31F8 FE40 F700             		move.w	($FFFFFE40).w,(v_screenposx).w
00898728 31F8 FE42 F704             		move.w	($FFFFFE42).w,(v_screenposy).w
0089872E 31F8 FE44 F708             		move.w	($FFFFFE44).w,($FFFFF708).w
00898734 31F8 FE46 F70C             		move.w	($FFFFFE46).w,($FFFFF70C).w
0089873A 31F8 FE48 F710             		move.w	($FFFFFE48).w,($FFFFF710).w
00898740 31F8 FE4A F714             		move.w	($FFFFFE4A).w,($FFFFF714).w
00898746 31F8 FE4C F718             		move.w	($FFFFFE4C).w,($FFFFF718).w
0089874C 31F8 FE4E F71C             		move.w	($FFFFFE4E).w,($FFFFF71C).w
00898752 0C38 0001 FE10             		cmpi.b	#1,(v_zone).w	; is this Labyrinth Zone?
00898758 6600                       		bne.s	@notlabyrinth	; if not, branch
0089875A                            
0089875A 31F8 FE50 F648             		move.w	($FFFFFE50).w,(v_waterpos2).w
00898760 11F8 FE52 F64D             		move.b	($FFFFFE52).w,(v_wtr_routine).w
00898766 11F8 FE53 F64E             		move.b	($FFFFFE53).w,(f_wtr_state).w
0089876C                            
0089876C                            	@notlabyrinth:
0089876C 4A38 FE30                  		tst.b	(v_lastlamp).w
00898770 6A00                       		bpl.s	locret_170F6
00898772 3038 FE32                  		move.w	($FFFFFE32).w,d0
00898776 0440 00A0                  		subi.w	#$A0,d0
0089877A 31C0 F728                  		move.w	d0,(v_limitleft2).w
0089877E                            
0089877E                            locret_170F6:
0089877E 4E75                       		rts	
0089877E 4E75                       		rts	
00898780                            		include	"_maps\Lamppost.asm"
00898780                            ; ---------------------------------------------------------------------------
00898780                            ; Sprite mappings - lamppost
00898780                            ; ---------------------------------------------------------------------------
00898780 0000 0000                  Map_Lamp:	dc.w @blue-Map_Lamp, @poleonly-Map_Lamp
00898784 0000 0000                  		dc.w @redballonly-Map_Lamp, @red-Map_Lamp
00898788 06                         @blue:		dc.b 6
00898789 E401 0000 F8               		dc.b $E4, 1, 0,	0, $F8
0089878E E401 0800 00               		dc.b $E4, 1, 8,	0, 0
00898793 F403 2002 F8               		dc.b $F4, 3, $20, 2, $F8
00898798 F403 2802 00               		dc.b $F4, 3, $28, 2, 0
0089879D D401 0006 F8               		dc.b $D4, 1, 0,	6, $F8
008987A2 D401 0806 00               		dc.b $D4, 1, 8,	6, 0
008987A7 04                         @poleonly:	dc.b 4
008987A8 E401 0000 F8               		dc.b $E4, 1, 0,	0, $F8
008987AD E401 0800 00               		dc.b $E4, 1, 8,	0, 0
008987B2 F403 2002 F8               		dc.b $F4, 3, $20, 2, $F8
008987B7 F403 2802 00               		dc.b $F4, 3, $28, 2, 0
008987BC 02                         @redballonly:	dc.b 2
008987BD F801 0008 F8               		dc.b $F8, 1, 0,	8, $F8
008987C2 F801 0808 00               		dc.b $F8, 1, 8,	8, 0
008987C7 06                         @red:		dc.b 6
008987C8 E401 0000 F8               		dc.b $E4, 1, 0,	0, $F8
008987CD E401 0800 00               		dc.b $E4, 1, 8,	0, 0
008987D2 F403 2002 F8               		dc.b $F4, 3, $20, 2, $F8
008987D7 F403 2802 00               		dc.b $F4, 3, $28, 2, 0
008987DC D401 0008 F8               		dc.b $D4, 1, 0,	8, $F8
008987E1 D401 0808 00               		dc.b $D4, 1, 8,	8, 0
008987E6                            		even
008987E6                            		even
008987E6                            		include	"_incObj\7D Hidden Bonuses.asm"
008987E6                            ; ---------------------------------------------------------------------------
008987E6                            ; Object 7D - hidden points at the end of a level
008987E6                            ; ---------------------------------------------------------------------------
008987E6                            
008987E6                            HiddenBonus:				; XREF: Obj_Index
008987E6 7000                       		moveq	#0,d0
008987E8 1028 0024                  		move.b	obRoutine(a0),d0
008987EC 323B 0000                  		move.w	Bonus_Index(pc,d0.w),d1
008987F0 4EFB 1000                  		jmp	Bonus_Index(pc,d1.w)
008987F4                            ; ===========================================================================
008987F4 0000                       Bonus_Index:	dc.w Bonus_Main-Bonus_Index
008987F6 0000                       		dc.w Bonus_Display-Bonus_Index
008987F8                            
008987F8 =00000030                  bonus_timelen:	= $30		; length of time to display bonus sprites
008987F8                            ; ===========================================================================
008987F8                            
008987F8                            Bonus_Main:	; Routine 0
008987F8 7410                       		moveq	#$10,d2
008987FA 3602                       		move.w	d2,d3
008987FC D643                       		add.w	d3,d3
008987FE 43F8 D000                  		lea	(v_player).w,a1
00898802 3029 0008                  		move.w	obX(a1),d0
00898806 9068 0008                  		sub.w	obX(a0),d0
0089880A D042                       		add.w	d2,d0
0089880C B043                       		cmp.w	d3,d0
0089880E 6400                       		bcc.s	@chkdel
00898810 3229 000C                  		move.w	obY(a1),d1
00898814 9268 000C                  		sub.w	obY(a0),d1
00898818 D242                       		add.w	d2,d1
0089881A B243                       		cmp.w	d3,d1
0089881C 6400                       		bcc.s	@chkdel
0089881E 4A78 FE08                  		tst.w	(v_debuguse).w
00898822 6600                       		bne.s	@chkdel
00898824 4A38 F7CD                  		tst.b	(f_bigring).w
00898828 6600                       		bne.s	@chkdel
0089882A 5428 0024                  		addq.b	#2,obRoutine(a0)
0089882E 217C 0000 0000 0004        		move.l	#Map_Bonus,obMap(a0)
00898836 317C 84B6 0002             		move.w	#$84B6,obGfx(a0)
0089883C 0028 0004 0001             		ori.b	#4,obRender(a0)
00898842 117C 0000 0018             		move.b	#0,obPriority(a0)
00898848 117C 0010 0019             		move.b	#$10,obActWid(a0)
0089884E 1168 0028 001A             		move.b	obSubtype(a0),obFrame(a0)
00898854 317C 0077 0030             		move.w	#119,bonus_timelen(a0) ; set display time to 2 seconds
00898864 7000                       		moveq	#0,d0
00898866 1028 0028                  		move.b	obSubtype(a0),d0
0089886A D040                       		add.w	d0,d0
0089886C 303B 0000                  		move.w	@points(pc,d0.w),d0 ; load bonus points array
00898870 4EB9 0000 0000             		jsr	AddPoints
00898876                            
00898876                            	@chkdel:
00898892 4E75                       		rts	
00898894                            
00898894                            	@delete:
00898894 4EF9 0088 E408             		jmp	DeleteObject
0089889A                            
0089889A                            ; ===========================================================================
0089889A 0000                       @points:	dc.w 0			; Bonus	points array
0089889C 03E8                       		dc.w 1000
0089889E 0064                       		dc.w 100
008988A0 000A                       		dc.w 10
008988A2                            ; ===========================================================================
008988A2                            
008988A2                            Bonus_Display:	; Routine 2
008988A2 5368 0030                  		subq.w	#1,bonus_timelen(a0) ; decrement display time
008988A6 6B00                       		bmi.s	Bonus_Display_Delete		; if time is zero, branch
008988C4 4EF9 0088 E3CC             		jmp	DisplaySprite
008988CA                            
008988CA                            Bonus_Display_Delete:	
008988CA 4EF9 0088 E408             		jmp	DeleteObject
008988CA 4EF9 0088 E408             		jmp	DeleteObject
008988D0                            		include	"_maps\Hidden Bonuses.asm"
008988D0                            ; ---------------------------------------------------------------------------
008988D0                            ; Sprite mappings - hidden points at the end of	a level
008988D0                            ; ---------------------------------------------------------------------------
008988D0 0000 0000                  Map_Bonus:	dc.w @blank-Map_Bonus, @10000-Map_Bonus
008988D4 0000 0000                  		dc.w @1000-Map_Bonus, @100-Map_Bonus
008988D8 00                         @blank:		dc.b 0
008988D9 01                         @10000:		dc.b 1
008988DA F40E 0000 F0               		dc.b $F4, $E, 0, 0, $F0
008988DF 01                         @1000:		dc.b 1
008988E0 F40E 000C F0               		dc.b $F4, $E, 0, $C, $F0
008988E5 01                         @100:		dc.b 1
008988E6 F40E 0018 F0               		dc.b $F4, $E, 0, $18, $F0
008988EC 00                         		even
008988EC 00                         		even
008988EC                            
008988EC                            		include	"_incObj\8A Credits.asm"
008988EC                            ; ---------------------------------------------------------------------------
008988EC                            ; Object 8A - "SONIC TEAM PRESENTS" and	credits
008988EC                            ; ---------------------------------------------------------------------------
008988EC                            
008988EC                            CreditsText:				; XREF: Obj_Index
008988EC 7000                       		moveq	#0,d0
008988EE 1028 0024                  		move.b	obRoutine(a0),d0
008988F2 323B 0000                  		move.w	Cred_Index(pc,d0.w),d1
008988F6 4EFB 1000                  		jmp	Cred_Index(pc,d1.w)
008988FA                            ; ===========================================================================
008988FA 0000                       Cred_Index:	dc.w Cred_Main-Cred_Index
008988FC 0000                       		dc.w Cred_Display-Cred_Index
008988FE                            ; ===========================================================================
008988FE                            
008988FE                            Cred_Main:	; Routine 0
008988FE 5428 0024                  		addq.b	#2,obRoutine(a0)
00898902 317C 0120 0008             		move.w	#$120,obX(a0)
00898908 317C 00F0 000A             		move.w	#$F0,obScreenY(a0)
0089890E 217C 0000 0000 0004        		move.l	#Map_Cred,obMap(a0)
00898916 317C 05A0 0002             		move.w	#$5A0,obGfx(a0)
0089891C 3038 FFF4                  		move.w	(v_creditsnum).w,d0 ; load credits index number
00898920 1140 001A                  		move.b	d0,obFrame(a0)	; display appropriate sprite
00898924 117C 0000 0001             		move.b	#0,obRender(a0)
0089892A 117C 0000 0018             		move.b	#0,obPriority(a0)
00898930                            
00898930 0C38 0000 F600             		cmpi.b	#id_Title,(v_gamemode).w ; is the mode #4 (title screen)?
00898936 6600                       		bne.s	Cred_Display	; if not, branch
00898938                            
00898938 317C 00A6 0002             		move.w	#$A6,obGfx(a0)
0089893E 117C 000A 001A             		move.b	#$A,obFrame(a0)	; display "SONIC TEAM PRESENTS"
00898944 4A38 FFE3                  		tst.b	(f_creditscheat).w ; is hidden credits cheat on?
00898948 6700                       		beq.s	Cred_Display	; if not, branch
0089894A 0C38 0072 F604             		cmpi.b	#btnABC+btnDn,(v_jpadhold1).w ; is A+B+C+Down being pressed? ($72)
00898950 6600                       		bne.s	Cred_Display	; if not, branch
00898952 31FC 0EEE FBC0             		move.w	#cWhite,(v_pal_dry_dup+$40).w ; 3rd palette, 1st entry = white
00898958 31FC 0880 FBC2             		move.w	#$880,(v_pal_dry_dup+$42).w ; 3rd palette, 2nd entry = cyan
0089895E 4EF9 0088 E408             		jmp	DeleteObject
00898964                            ; ===========================================================================
00898964                            
00898964                            Cred_Display:	; Routine 2
00898964 4EF9 0088 E3CC             		jmp	DisplaySprite
00898964 4EF9 0088 E3CC             		jmp	DisplaySprite
0089896A                            		include	"_maps\Credits.asm"
0089896A                            ; ---------------------------------------------------------------------------
0089896A                            ; Sprite mappings - "SONIC TEAM	PRESENTS" and credits
0089896A                            ; ---------------------------------------------------------------------------
0089896A 0000 0000                  Map_Cred:	dc.w @staff-Map_Cred, @gameplan-Map_Cred
0089896E 0000 0000                  		dc.w @program-Map_Cred, @character-Map_Cred
00898972 0000 0000                  		dc.w @design-Map_Cred, @soundproduce-Map_Cred
00898976 0000 0000                  		dc.w @soundprogram-Map_Cred, @thanks-Map_Cred
0089897A 0000 0000                  		dc.w @presentedby-Map_Cred, @tryagain-Map_Cred
0089897E 0000                       		dc.w @sonicteam-Map_Cred
00898980 0E                         @staff:		dc.b $E			 ; SONIC TEAM STAFF
00898981 F805 002E 88               		dc.b $F8, 5, 0,	$2E, $88
00898986 F805 0026 98               		dc.b $F8, 5, 0,	$26, $98
0089898B F805 001A A8               		dc.b $F8, 5, 0,	$1A, $A8
00898990 F801 0046 B8               		dc.b $F8, 1, 0,	$46, $B8
00898995 F805 001E C0               		dc.b $F8, 5, 0,	$1E, $C0
0089899A F805 003E D8               		dc.b $F8, 5, 0,	$3E, $D8
0089899F F805 000E E8               		dc.b $F8, 5, 0,	$E, $E8
008989A4 F805 0004 F8               		dc.b $F8, 5, 0,	4, $F8
008989A9 F809 0008 08               		dc.b $F8, 9, 0,	8, 8
008989AE F805 002E 28               		dc.b $F8, 5, 0,	$2E, $28
008989B3 F805 003E 38               		dc.b $F8, 5, 0,	$3E, $38
008989B8 F805 0004 48               		dc.b $F8, 5, 0,	4, $48
008989BD F805 005C 58               		dc.b $F8, 5, 0,	$5C, $58
008989C2 F805 005C 68               		dc.b $F8, 5, 0,	$5C, $68
008989C7 10                         @gameplan:	dc.b $10		; GAME PLAN CAROL YAS
008989C8 D805 0000 80               		dc.b $D8, 5, 0,	0, $80
008989CD D805 0004 90               		dc.b $D8, 5, 0,	4, $90
008989D2 D809 0008 A0               		dc.b $D8, 9, 0,	8, $A0
008989D7 D805 000E B4               		dc.b $D8, 5, 0,	$E, $B4
008989DC D805 0012 D0               		dc.b $D8, 5, 0,	$12, $D0
008989E1 D805 0016 E0               		dc.b $D8, 5, 0,	$16, $E0
008989E6 D805 0004 F0               		dc.b $D8, 5, 0,	4, $F0
008989EB D805 001A 00               		dc.b $D8, 5, 0,	$1A, 0
008989F0 0805 001E C8               		dc.b 8,	5, 0, $1E, $C8
008989F5 0805 0004 D8               		dc.b 8,	5, 0, 4, $D8
008989FA 0805 0022 E8               		dc.b 8,	5, 0, $22, $E8
008989FF 0805 0026 F8               		dc.b 8,	5, 0, $26, $F8
00898A04 0805 0016 08               		dc.b 8,	5, 0, $16, 8
00898A09 0805 002A 20               		dc.b 8,	5, 0, $2A, $20
00898A0E 0805 0004 30               		dc.b 8,	5, 0, 4, $30
00898A13 0805 002E 44               		dc.b 8,	5, 0, $2E, $44
00898A18 0A                         @program:	dc.b $A			 ; PROGRAM YU 2
00898A19 D805 0012 80               		dc.b $D8, 5, 0,	$12, $80
00898A1E D805 0022 90               		dc.b $D8, 5, 0,	$22, $90
00898A23 D805 0026 A0               		dc.b $D8, 5, 0,	$26, $A0
00898A28 D805 0000 B0               		dc.b $D8, 5, 0,	0, $B0
00898A2D D805 0022 C0               		dc.b $D8, 5, 0,	$22, $C0
00898A32 D805 0004 D0               		dc.b $D8, 5, 0,	4, $D0
00898A37 D809 0008 E0               		dc.b $D8, 9, 0,	8, $E0
00898A3C 0805 002A E8               		dc.b 8,	5, 0, $2A, $E8
00898A41 0805 0032 F8               		dc.b 8,	5, 0, $32, $F8
00898A46 0805 0036 08               		dc.b 8,	5, 0, $36, 8
00898A4B 18                         @character:	dc.b $18		 ; CHARACTER DESIGN BIGISLAND
00898A4C D805 001E 88               		dc.b $D8, 5, 0,	$1E, $88
00898A51 D805 003A 98               		dc.b $D8, 5, 0,	$3A, $98
00898A56 D805 0004 A8               		dc.b $D8, 5, 0,	4, $A8
00898A5B D805 0022 B8               		dc.b $D8, 5, 0,	$22, $B8
00898A60 D805 0004 C8               		dc.b $D8, 5, 0,	4, $C8
00898A65 D805 001E D8               		dc.b $D8, 5, 0,	$1E, $D8
00898A6A D805 003E E8               		dc.b $D8, 5, 0,	$3E, $E8
00898A6F D805 000E F8               		dc.b $D8, 5, 0,	$E, $F8
00898A74 D805 0022 08               		dc.b $D8, 5, 0,	$22, 8
00898A79 D805 0042 20               		dc.b $D8, 5, 0,	$42, $20
00898A7E D805 000E 30               		dc.b $D8, 5, 0,	$E, $30
00898A83 D805 002E 40               		dc.b $D8, 5, 0,	$2E, $40
00898A88 D801 0046 50               		dc.b $D8, 1, 0,	$46, $50
00898A8D D805 0000 58               		dc.b $D8, 5, 0,	0, $58
00898A92 D805 001A 68               		dc.b $D8, 5, 0,	$1A, $68
00898A97 0805 0048 C0               		dc.b 8,	5, 0, $48, $C0
00898A9C 0801 0046 D0               		dc.b 8,	1, 0, $46, $D0
00898AA1 0805 0000 D8               		dc.b 8,	5, 0, 0, $D8
00898AA6 0801 0046 E8               		dc.b 8,	1, 0, $46, $E8
00898AAB 0805 002E F0               		dc.b 8,	5, 0, $2E, $F0
00898AB0 0805 0016 00               		dc.b 8,	5, 0, $16, 0
00898AB5 0805 0004 10               		dc.b 8,	5, 0, 4, $10
00898ABA 0805 001A 20               		dc.b 8,	5, 0, $1A, $20
00898ABF 0805 0042 30               		dc.b 8,	5, 0, $42, $30
00898AC4 14                         @design:	dc.b $14		 ; DESIGN JINYA	PHENIX RIE
00898AC5 D005 0042 A0               		dc.b $D0, 5, 0,	$42, $A0
00898ACA D005 000E B0               		dc.b $D0, 5, 0,	$E, $B0
00898ACF D005 002E C0               		dc.b $D0, 5, 0,	$2E, $C0
00898AD4 D001 0046 D0               		dc.b $D0, 1, 0,	$46, $D0
00898AD9 D005 0000 D8               		dc.b $D0, 5, 0,	0, $D8
00898ADE D005 001A E8               		dc.b $D0, 5, 0,	$1A, $E8
00898AE3 0005 004C E8               		dc.b 0,	5, 0, $4C, $E8
00898AE8 0001 0046 F8               		dc.b 0,	1, 0, $46, $F8
00898AED 0005 001A 04               		dc.b 0,	5, 0, $1A, 4
00898AF2 0005 002A 14               		dc.b 0,	5, 0, $2A, $14
00898AF7 0005 0004 24               		dc.b 0,	5, 0, 4, $24
00898AFC 2005 0012 D0               		dc.b $20, 5, 0,	$12, $D0
00898B01 2005 003A E0               		dc.b $20, 5, 0,	$3A, $E0
00898B06 2005 000E F0               		dc.b $20, 5, 0,	$E, $F0
00898B0B 2005 001A 00               		dc.b $20, 5, 0,	$1A, 0
00898B10 2001 0046 10               		dc.b $20, 1, 0,	$46, $10
00898B15 2005 0050 18               		dc.b $20, 5, 0,	$50, $18
00898B1A 2005 0022 30               		dc.b $20, 5, 0,	$22, $30
00898B1F 2001 0046 40               		dc.b $20, 1, 0,	$46, $40
00898B24 2005 000E 48               		dc.b $20, 5, 0,	$E, $48
00898B29 1A                         @soundproduce:	dc.b $1A		 ; SOUND PRODUCE MASATO	NAKAMURA
00898B2A D805 002E 98               		dc.b $D8, 5, 0,	$2E, $98
00898B2F D805 0026 A8               		dc.b $D8, 5, 0,	$26, $A8
00898B34 D805 0032 B8               		dc.b $D8, 5, 0,	$32, $B8
00898B39 D805 001A C8               		dc.b $D8, 5, 0,	$1A, $C8
00898B3E D805 0054 D8               		dc.b $D8, 5, 0,	$54, $D8
00898B43 D805 0012 F8               		dc.b $D8, 5, 0,	$12, $F8
00898B48 D805 0022 08               		dc.b $D8, 5, 0,	$22, 8
00898B4D D805 0026 18               		dc.b $D8, 5, 0,	$26, $18
00898B52 D805 0042 28               		dc.b $D8, 5, 0,	$42, $28
00898B57 D805 0032 38               		dc.b $D8, 5, 0,	$32, $38
00898B5C D805 001E 48               		dc.b $D8, 5, 0,	$1E, $48
00898B61 D805 000E 58               		dc.b $D8, 5, 0,	$E, $58
00898B66 0809 0008 88               		dc.b 8,	9, 0, 8, $88
00898B6B 0805 0004 9C               		dc.b 8,	5, 0, 4, $9C
00898B70 0805 002E AC               		dc.b 8,	5, 0, $2E, $AC
00898B75 0805 0004 BC               		dc.b 8,	5, 0, 4, $BC
00898B7A 0805 003E CC               		dc.b 8,	5, 0, $3E, $CC
00898B7F 0805 0026 DC               		dc.b 8,	5, 0, $26, $DC
00898B84 0805 001A F8               		dc.b 8,	5, 0, $1A, $F8
00898B89 0805 0004 08               		dc.b 8,	5, 0, 4, 8
00898B8E 0805 0058 18               		dc.b 8,	5, 0, $58, $18
00898B93 0805 0004 28               		dc.b 8,	5, 0, 4, $28
00898B98 0809 0008 38               		dc.b 8,	9, 0, 8, $38
00898B9D 0805 0032 4C               		dc.b 8,	5, 0, $32, $4C
00898BA2 0805 0022 5C               		dc.b 8,	5, 0, $22, $5C
00898BA7 0805 0004 6C               		dc.b 8,	5, 0, 4, $6C
00898BAC 17                         @soundprogram:	dc.b $17		 ; SOUND PROGRAM JIMITA	MACKY
00898BAD D005 002E 98               		dc.b $D0, 5, 0,	$2E, $98
00898BB2 D005 0026 A8               		dc.b $D0, 5, 0,	$26, $A8
00898BB7 D005 0032 B8               		dc.b $D0, 5, 0,	$32, $B8
00898BBC D005 001A C8               		dc.b $D0, 5, 0,	$1A, $C8
00898BC1 D005 0054 D8               		dc.b $D0, 5, 0,	$54, $D8
00898BC6 D005 0012 F8               		dc.b $D0, 5, 0,	$12, $F8
00898BCB D005 0022 08               		dc.b $D0, 5, 0,	$22, 8
00898BD0 D005 0026 18               		dc.b $D0, 5, 0,	$26, $18
00898BD5 D005 0000 28               		dc.b $D0, 5, 0,	0, $28
00898BDA D005 0022 38               		dc.b $D0, 5, 0,	$22, $38
00898BDF D005 0004 48               		dc.b $D0, 5, 0,	4, $48
00898BE4 D009 0008 58               		dc.b $D0, 9, 0,	8, $58
00898BE9 0005 004C D0               		dc.b 0,	5, 0, $4C, $D0
00898BEE 0001 0046 E0               		dc.b 0,	1, 0, $46, $E0
00898BF3 0009 0008 E8               		dc.b 0,	9, 0, 8, $E8
00898BF8 0001 0046 FC               		dc.b 0,	1, 0, $46, $FC
00898BFD 0005 003E 04               		dc.b 0,	5, 0, $3E, 4
00898C02 0005 0004 14               		dc.b 0,	5, 0, 4, $14
00898C07 2009 0008 D0               		dc.b $20, 9, 0,	8, $D0
00898C0C 2005 0004 E4               		dc.b $20, 5, 0,	4, $E4
00898C11 2005 001E F4               		dc.b $20, 5, 0,	$1E, $F4
00898C16 2005 0058 04               		dc.b $20, 5, 0,	$58, 4
00898C1B 2005 002A 14               		dc.b $20, 5, 0,	$2A, $14
00898C20 1F                         @thanks:	dc.b $1F		 ; SPECIAL THANKS FUJIO	MINEGISHI PAPA
00898C21 D805 002E 80               		dc.b $D8, 5, 0,	$2E, $80
00898C26 D805 0012 90               		dc.b $D8, 5, 0,	$12, $90
00898C2B D805 000E A0               		dc.b $D8, 5, 0,	$E, $A0
00898C30 D805 001E B0               		dc.b $D8, 5, 0,	$1E, $B0
00898C35 D801 0046 C0               		dc.b $D8, 1, 0,	$46, $C0
00898C3A D805 0004 C8               		dc.b $D8, 5, 0,	4, $C8
00898C3F D805 0016 D8               		dc.b $D8, 5, 0,	$16, $D8
00898C44 D805 003E F8               		dc.b $D8, 5, 0,	$3E, $F8
00898C49 D805 003A 08               		dc.b $D8, 5, 0,	$3A, 8
00898C4E D805 0004 18               		dc.b $D8, 5, 0,	4, $18
00898C53 D805 001A 28               		dc.b $D8, 5, 0,	$1A, $28
00898C58 D805 0058 38               		dc.b $D8, 5, 0,	$58, $38
00898C5D D805 002E 48               		dc.b $D8, 5, 0,	$2E, $48
00898C62 0005 005C B0               		dc.b 0,	5, 0, $5C, $B0
00898C67 0005 0032 C0               		dc.b 0,	5, 0, $32, $C0
00898C6C 0005 004C D0               		dc.b 0,	5, 0, $4C, $D0
00898C71 0001 0046 E0               		dc.b 0,	1, 0, $46, $E0
00898C76 0005 0026 E8               		dc.b 0,	5, 0, $26, $E8
00898C7B 0009 0008 00               		dc.b 0,	9, 0, 8, 0
00898C80 0001 0046 14               		dc.b 0,	1, 0, $46, $14
00898C85 0005 001A 1C               		dc.b 0,	5, 0, $1A, $1C
00898C8A 0005 000E 2C               		dc.b 0,	5, 0, $E, $2C
00898C8F 0005 0000 3C               		dc.b 0,	5, 0, 0, $3C
00898C94 0001 0046 4C               		dc.b 0,	1, 0, $46, $4C
00898C99 0005 002E 54               		dc.b 0,	5, 0, $2E, $54
00898C9E 0005 003A 64               		dc.b 0,	5, 0, $3A, $64
00898CA3 0001 0046 74               		dc.b 0,	1, 0, $46, $74
00898CA8 2005 0012 F8               		dc.b $20, 5, 0,	$12, $F8
00898CAD 2005 0004 08               		dc.b $20, 5, 0,	4, 8
00898CB2 2005 0012 18               		dc.b $20, 5, 0,	$12, $18
00898CB7 2005 0004 28               		dc.b $20, 5, 0,	4, $28
00898CBC 0F                         @presentedby:	dc.b $F			 ; PRESENTED BY	SEGA
00898CBD F805 0012 80               		dc.b $F8, 5, 0,	$12, $80
00898CC2 F805 0022 90               		dc.b $F8, 5, 0,	$22, $90
00898CC7 F805 000E A0               		dc.b $F8, 5, 0,	$E, $A0
00898CCC F805 002E B0               		dc.b $F8, 5, 0,	$2E, $B0
00898CD1 F805 000E C0               		dc.b $F8, 5, 0,	$E, $C0
00898CD6 F805 001A D0               		dc.b $F8, 5, 0,	$1A, $D0
00898CDB F805 003E E0               		dc.b $F8, 5, 0,	$3E, $E0
00898CE0 F805 000E F0               		dc.b $F8, 5, 0,	$E, $F0
00898CE5 F805 0042 00               		dc.b $F8, 5, 0,	$42, 0
00898CEA F805 0048 18               		dc.b $F8, 5, 0,	$48, $18
00898CEF F805 002A 28               		dc.b $F8, 5, 0,	$2A, $28
00898CF4 F805 002E 40               		dc.b $F8, 5, 0,	$2E, $40
00898CF9 F805 000E 50               		dc.b $F8, 5, 0,	$E, $50
00898CFE F805 0000 60               		dc.b $F8, 5, 0,	0, $60
00898D03 F805 0004 70               		dc.b $F8, 5, 0,	4, $70
00898D08 08                         @tryagain:	dc.b 8			 ; TRY AGAIN
00898D09 3005 003E C0               		dc.b $30, 5, 0,	$3E, $C0
00898D0E 3005 0022 D0               		dc.b $30, 5, 0,	$22, $D0
00898D13 3005 002A E0               		dc.b $30, 5, 0,	$2A, $E0
00898D18 3005 0004 F8               		dc.b $30, 5, 0,	4, $F8
00898D1D 3005 0000 08               		dc.b $30, 5, 0,	0, 8
00898D22 3005 0004 18               		dc.b $30, 5, 0,	4, $18
00898D27 3001 0046 28               		dc.b $30, 1, 0,	$46, $28
00898D2C 3005 001A 30               		dc.b $30, 5, 0,	$1A, $30
00898D31 11                         @sonicteam:	dc.b $11		 ; SONIC TEAM PRESENTS
00898D32 E805 002E B4               		dc.b $E8, 5, 0,	$2E, $B4
00898D37 E805 0026 C4               		dc.b $E8, 5, 0,	$26, $C4
00898D3C E805 001A D4               		dc.b $E8, 5, 0,	$1A, $D4
00898D41 E801 0046 E4               		dc.b $E8, 1, 0,	$46, $E4
00898D46 E805 001E EC               		dc.b $E8, 5, 0,	$1E, $EC
00898D4B E805 003E 04               		dc.b $E8, 5, 0,	$3E, 4
00898D50 E805 000E 14               		dc.b $E8, 5, 0,	$E, $14
00898D55 E805 0004 24               		dc.b $E8, 5, 0,	4, $24
00898D5A E809 0008 34               		dc.b $E8, 9, 0,	8, $34
00898D5F 0005 0012 C0               		dc.b 0,	5, 0, $12, $C0
00898D64 0005 0022 D0               		dc.b 0,	5, 0, $22, $D0
00898D69 0005 000E E0               		dc.b 0,	5, 0, $E, $E0
00898D6E 0005 002E F0               		dc.b 0,	5, 0, $2E, $F0
00898D73 0005 000E 00               		dc.b 0,	5, 0, $E, 0
00898D78 0005 001A 10               		dc.b 0,	5, 0, $1A, $10
00898D7D 0005 003E 20               		dc.b 0,	5, 0, $3E, $20
00898D82 0005 002E 30               		dc.b 0,	5, 0, $2E, $30
00898D88 00                         		even
00898D88 00                         		even
00898D88                            
00898D88                            		include	"_incObj\3D Boss - Green Hill (part 1).asm"
00898D88                            ; ---------------------------------------------------------------------------
00898D88                            ; Object 3D - Eggman (GHZ)
00898D88                            ; ---------------------------------------------------------------------------
00898D88                            
00898D88                            BossGreenHill:				; XREF: Obj_Index
00898D88 7000                       		moveq	#0,d0
00898D8A 1028 0024                  		move.b	obRoutine(a0),d0
00898D8E 323B 0000                  		move.w	BGHZ_Index(pc,d0.w),d1
00898D92 4EFB 1000                  		jmp	BGHZ_Index(pc,d1.w)
00898D96                            ; ===========================================================================
00898D96 0000                       BGHZ_Index:	dc.w BGHZ_Main-BGHZ_Index
00898D98 0000                       		dc.w BGHZ_ShipMain-BGHZ_Index
00898D9A 0000                       		dc.w BGHZ_FaceMain-BGHZ_Index
00898D9C 0000                       		dc.w BGHZ_FlameMain-BGHZ_Index
00898D9E                            
00898D9E 0200                       BGHZ_ObjData:	dc.b 2,	0		; routine counter, animation
00898DA0 0401                       		dc.b 4,	1
00898DA2 0607                       		dc.b 6,	7
00898DA4                            ; ===========================================================================
00898DA4                            
00898DA4                            BGHZ_Main:	; Routine 0
00898DA4 45F9 0089 8D9E             		lea	(BGHZ_ObjData).l,a2
00898DAA 2248                       		movea.l	a0,a1
00898DAC 7202                       		moveq	#2,d1
00898DAE 6000                       		bra.s	BGHZ_LoadBoss
00898DB0                            ; ===========================================================================
00898DB0                            
00898DB0                            BGHZ_Loop:
00898DB0 4EB9 0088 E878             		jsr	FindNextFreeObj
00898DB6 6600                       		bne.s	loc_17772
00898DB8                            
00898DB8                            BGHZ_LoadBoss:				; XREF: BGHZ_Main
00898DB8 135A 0024                  		move.b	(a2)+,obRoutine(a1)
00898DBC 137C 003D 0000             		move.b	#id_BossGreenHill,0(a1)
00898DC2 3368 0008 0008             		move.w	obX(a0),obX(a1)
00898DC8 3368 000C 000C             		move.w	obY(a0),obY(a1)
00898DCE 237C 0000 0000 0004        		move.l	#Map_Eggman,obMap(a1)
00898DD6 337C 0400 0002             		move.w	#$400,obGfx(a1)
00898DDC 137C 0004 0001             		move.b	#4,obRender(a1)
00898DE2 137C 0020 0019             		move.b	#$20,obActWid(a1)
00898DE8 137C 0003 0018             		move.b	#3,obPriority(a1)
00898DEE 135A 001C                  		move.b	(a2)+,obAnim(a1)
00898DF2 2348 0034                  		move.l	a0,$34(a1)
00898DF6 51C9 FFB8                  		dbf	d1,BGHZ_Loop	; repeat sequence 2 more times
00898DFA                            
00898DFA                            loc_17772:
00898DFA 3168 0008 0030             		move.w	obX(a0),$30(a0)
00898E00 3168 000C 0038             		move.w	obY(a0),$38(a0)
00898E06 117C 000F 0020             		move.b	#$F,obColType(a0)
00898E0C 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
00898E12                            
00898E12                            BGHZ_ShipMain:	; Routine 2
00898E12 7000                       		moveq	#0,d0
00898E14 1028 0025                  		move.b	ob2ndRout(a0),d0
00898E18 323B 0000                  		move.w	BGHZ_ShipIndex(pc,d0.w),d1
00898E1C 4EBB 1000                  		jsr	BGHZ_ShipIndex(pc,d1.w)
00898E20 43F9 0000 0000             		lea	(Ani_Eggman).l,a1
00898E26 4EB9 0088 B4B0             		jsr	AnimateSprite
00898E2C 1028 0022                  		move.b	obStatus(a0),d0
00898E30 0200 0003                  		andi.b	#3,d0
00898E34 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00898E3A 8128 0001                  		or.b	d0,obRender(a0)
00898E3E 4EF9 0088 E3CC             		jmp	DisplaySprite
00898E44                            ; ===========================================================================
00898E44 0000                       BGHZ_ShipIndex:	dc.w BGHZ_ShipStart-BGHZ_ShipIndex
00898E46 0000                       		dc.w BGHZ_MakeBall-BGHZ_ShipIndex
00898E48 0000                       		dc.w BGHZ_ShipMove-BGHZ_ShipIndex
00898E4A 0000                       		dc.w loc_17954-BGHZ_ShipIndex
00898E4C 0000                       		dc.w loc_1797A-BGHZ_ShipIndex
00898E4E 0000                       		dc.w loc_179AC-BGHZ_ShipIndex
00898E50 0000                       		dc.w loc_179F6-BGHZ_ShipIndex
00898E52                            ; ===========================================================================
00898E52                            
00898E52                            BGHZ_ShipStart:			; XREF: BGHZ_ShipIndex
00898E52 317C 0100 0012             		move.w	#$100,obVelY(a0) ; move ship down
00898E58 6100 0000                  		bsr.w	BossMove
00898E5C 0C68 0338 0038             		cmpi.w	#$338,$38(a0)
00898E62 6600                       		bne.s	loc_177E6
00898E64 317C 0000 0012             		move.w	#0,obVelY(a0)	; stop ship
00898E6A 5428 0025                  		addq.b	#2,ob2ndRout(a0) ; goto next routine
00898E6E                            
00898E6E                            loc_177E6:
00898E6E 1028 003F                  		move.b	$3F(a0),d0
00898E72 4EB9 0088 301C             		jsr	(CalcSine).l
00898E78 EC40                       		asr.w	#6,d0
00898E7A D068 0038                  		add.w	$38(a0),d0
00898E7E 3140 000C                  		move.w	d0,obY(a0)
00898E82 3168 0030 0008             		move.w	$30(a0),obX(a0)
00898E88 5428 003F                  		addq.b	#2,$3F(a0)
00898E8C 0C28 0008 0025             		cmpi.b	#8,ob2ndRout(a0)
00898E92 6400                       		bcc.s	locret_1784A
00898E94 4A28 0022                  		tst.b	obStatus(a0)
00898E98 6B00                       		bmi.s	loc_1784C
00898E9A 4A28 0020                  		tst.b	obColType(a0)
00898E9E 6600                       		bne.s	locret_1784A
00898EA0 4A28 003E                  		tst.b	$3E(a0)
00898EA4 6600                       		bne.s	BGHZ_ShipFlash
00898EA6 117C 0020 003E             		move.b	#$20,$3E(a0)	; set number of	times for ship to flash
00898EB6                            
00898EB6                            BGHZ_ShipFlash:
00898EB6 43F8 FB22                  		lea	(v_pal_dry+$22).w,a1 ; load 2nd pallet, 2nd entry
00898EBA 7000                       		moveq	#0,d0		; move 0 (black) to d0
00898EBC 4A51                       		tst.w	(a1)
00898EBE 6600                       		bne.s	loc_1783C
00898EC0 303C 0EEE                  		move.w	#cWhite,d0	; move 0EEE (white) to d0
00898EC4                            
00898EC4                            loc_1783C:
00898EC4 3280                       		move.w	d0,(a1)		; load colour stored in	d0
00898EC6 5328 003E                  		subq.b	#1,$3E(a0)
00898ECA 6600                       		bne.s	locret_1784A
00898ECC 117C 000F 0020             		move.b	#$F,obColType(a0)
00898ED2                            
00898ED2                            locret_1784A:
00898ED2 4E75                       		rts	
00898ED4                            ; ===========================================================================
00898ED4                            
00898ED4                            loc_1784C:				; XREF: loc_177E6
00898ED4 7064                       		moveq	#100,d0
00898ED6 6100 0000                  		bsr.w	AddPoints
00898EDA 117C 0008 0025             		move.b	#8,ob2ndRout(a0)
00898EE0 317C 00B3 003C             		move.w	#$B3,$3C(a0)
00898EE6 4E75                       		rts	
00898EE6 4E75                       		rts	
00898EE8                            
00898EE8                            ; ---------------------------------------------------------------------------
00898EE8                            ; Defeated boss	subroutine
00898EE8                            ; ---------------------------------------------------------------------------
00898EE8                            
00898EE8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00898EE8                            
00898EE8                            
00898EE8                            BossDefeated:
00898EE8 1038 FE0F                  		move.b	(v_vbla_byte).w,d0
00898EEC 0200 0007                  		andi.b	#7,d0
00898EF0 6600                       		bne.s	locret_178A2
00898EF2 4EB9 0088 E862             		jsr	FindFreeObj
00898EF8 6600                       		bne.s	locret_178A2
00898EFA 137C 003F 0000             		move.b	#id_ExplosionBomb,0(a1)	; load explosion object
00898F00 3368 0008 0008             		move.w	obX(a0),obX(a1)
00898F06 3368 000C 000C             		move.w	obY(a0),obY(a1)
00898F0C 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00898F12 3200                       		move.w	d0,d1
00898F14 7200                       		moveq	#0,d1
00898F16 1200                       		move.b	d0,d1
00898F18 E409                       		lsr.b	#2,d1
00898F1A 0441 0020                  		subi.w	#$20,d1
00898F1E D369 0008                  		add.w	d1,obX(a1)
00898F22 E048                       		lsr.w	#8,d0
00898F24 E608                       		lsr.b	#3,d0
00898F26 D169 000C                  		add.w	d0,obY(a1)
00898F2A                            
00898F2A                            locret_178A2:
00898F2A 4E75                       		rts	
00898F2C                            ; End of function BossDefeated
00898F2C                            
00898F2C                            ; ---------------------------------------------------------------------------
00898F2C                            ; Subroutine to	move a boss
00898F2C                            ; ---------------------------------------------------------------------------
00898F2C                            
00898F2C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00898F2C                            
00898F2C                            
00898F2C                            BossMove:
00898F2C 2428 0030                  		move.l	$30(a0),d2
00898F30 2628 0038                  		move.l	$38(a0),d3
00898F34 3028 0010                  		move.w	obVelX(a0),d0
00898F38 48C0                       		ext.l	d0
00898F3A E180                       		asl.l	#8,d0
00898F3C D480                       		add.l	d0,d2
00898F3E 3028 0012                  		move.w	obVelY(a0),d0
00898F42 48C0                       		ext.l	d0
00898F44 E180                       		asl.l	#8,d0
00898F46 D680                       		add.l	d0,d3
00898F48 2142 0030                  		move.l	d2,$30(a0)
00898F4C 2143 0038                  		move.l	d3,$38(a0)
00898F50 4E75                       		rts	
00898F52                            ; End of function BossMove
00898F52                            
00898F52                            ; ===========================================================================
00898F52                            
00898F52                            		include	"_incObj\3D Boss - Green Hill (part 2).asm"
00898F52                            
00898F52                            BGHZ_MakeBall:				; XREF: BGHZ_ShipIndex
00898F52 317C FF00 0010             		move.w	#-$100,obVelX(a0)
00898F58 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
00898F5E 6100 FFCC                  		bsr.w	BossMove
00898F62 0C68 2A00 0030             		cmpi.w	#$2A00,$30(a0)
00898F68 6600                       		bne.s	loc_17916
00898F6A 317C 0000 0010             		move.w	#0,obVelX(a0)
00898F70 317C 0000 0012             		move.w	#0,obVelY(a0)
00898F76 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00898F7A 4EB9 0088 E878             		jsr	FindNextFreeObj
00898F80 6600                       		bne.s	loc_17910
00898F82 137C 0048 0000             		move.b	#id_BossBall,0(a1) ; load swinging ball object
00898F88 3368 0030 0008             		move.w	$30(a0),obX(a1)
00898F8E 3368 0038 000C             		move.w	$38(a0),obY(a1)
00898F94 2348 0034                  		move.l	a0,$34(a1)
00898F98                            
00898F98                            loc_17910:
00898F98 317C 0077 003C             		move.w	#$77,$3C(a0)
00898F9E                            
00898F9E                            loc_17916:
00898F9E 6000 FECE                  		bra.w	loc_177E6
00898FA2                            ; ===========================================================================
00898FA2                            
00898FA2                            BGHZ_ShipMove:				; XREF: BGHZ_ShipIndex
00898FA2 5368 003C                  		subq.w	#1,$3C(a0)
00898FA6 6A00                       		bpl.s	BGHZ_Reverse
00898FA8 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00898FAC 317C 003F 003C             		move.w	#$3F,$3C(a0)
00898FB2 317C 0100 0010             		move.w	#$100,obVelX(a0) ; move the ship sideways
00898FB8 0C68 2A00 0030             		cmpi.w	#$2A00,$30(a0)
00898FBE 6600                       		bne.s	BGHZ_Reverse
00898FC0 317C 007F 003C             		move.w	#$7F,$3C(a0)
00898FC6 317C 0040 0010             		move.w	#$40,obVelX(a0)
00898FCC                            
00898FCC                            BGHZ_Reverse:
00898FCC 0828 0000 0022             		btst	#0,obStatus(a0)
00898FD2 6600                       		bne.s	loc_17950
00898FD4 4468 0010                  		neg.w	obVelX(a0)	; reverse direction of the ship
00898FD8                            
00898FD8                            loc_17950:
00898FD8 6000 FE94                  		bra.w	loc_177E6
00898FDC                            ; ===========================================================================
00898FDC                            
00898FDC                            loc_17954:				; XREF: BGHZ_ShipIndex
00898FDC 5368 003C                  		subq.w	#1,$3C(a0)
00898FE0 6B00                       		bmi.s	loc_17960
00898FE2 6100 FF48                  		bsr.w	BossMove
00898FE6 6000                       		bra.s	loc_17976
00898FE8                            ; ===========================================================================
00898FE8                            
00898FE8                            loc_17960:
00898FE8 0868 0000 0022             		bchg	#0,obStatus(a0)
00898FEE 317C 003F 003C             		move.w	#$3F,$3C(a0)
00898FF4 5528 0025                  		subq.b	#2,ob2ndRout(a0)
00898FF8 317C 0000 0010             		move.w	#0,obVelX(a0)
00898FFE                            
00898FFE                            loc_17976:
00898FFE 6000 FE6E                  		bra.w	loc_177E6
00899002                            ; ===========================================================================
00899002                            
00899002                            loc_1797A:				; XREF: BGHZ_ShipIndex
00899002 5368 003C                  		subq.w	#1,$3C(a0)
00899006 6B00                       		bmi.s	loc_17984
00899008 6000 FEDE                  		bra.w	BossDefeated
0089900C                            ; ===========================================================================
0089900C                            
0089900C                            loc_17984:
0089900C 08E8 0000 0022             		bset	#0,obStatus(a0)
00899012 08A8 0007 0022             		bclr	#7,obStatus(a0)
00899018 4268 0010                  		clr.w	obVelX(a0)
0089901C 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899020 317C FFDA 003C             		move.w	#-$26,$3C(a0)
00899026 4A38 F7A7                  		tst.b	(v_bossstatus).w
0089902A 6600                       		bne.s	locret_179AA
0089902C 11FC 0001 F7A7             		move.b	#1,(v_bossstatus).w
00899032                            
00899032                            locret_179AA:
00899032 4E75                       		rts	
00899034                            ; ===========================================================================
00899034                            
00899034                            loc_179AC:				; XREF: BGHZ_ShipIndex
00899034 5268 003C                  		addq.w	#1,$3C(a0)
00899038 6700                       		beq.s	loc_179BC
0089903A 6A00                       		bpl.s	loc_179C2
0089903C 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00899042 6000                       		bra.s	loc_179EE
00899044                            ; ===========================================================================
00899044                            
00899044                            loc_179BC:
00899044 4268 0012                  		clr.w	obVelY(a0)
00899048 6000                       		bra.s	loc_179EE
0089904A                            ; ===========================================================================
0089904A                            
0089904A                            loc_179C2:
0089904A 0C68 0030 003C             		cmpi.w	#$30,$3C(a0)
00899050 6500                       		bcs.s	loc_179DA
00899052 6700                       		beq.s	loc_179E0
00899054 0C68 0038 003C             		cmpi.w	#$38,$3C(a0)
0089905A 6500                       		bcs.s	loc_179EE
0089905C 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899060 6000                       		bra.s	loc_179EE
00899062                            ; ===========================================================================
00899062                            
00899062                            loc_179DA:
00899062 5168 0012                  		subq.w	#8,obVelY(a0)
00899066 6000                       		bra.s	loc_179EE
00899068                            ; ===========================================================================
00899068                            
00899068                            loc_179E0:
00899068 4268 0012                  		clr.w	obVelY(a0)
00899076                            
00899076                            loc_179EE:
00899076 6100 FEB4                  		bsr.w	BossMove
0089907A 6000 FDF2                  		bra.w	loc_177E6
0089907E                            ; ===========================================================================
0089907E                            
0089907E                            loc_179F6:				; XREF: BGHZ_ShipIndex
0089907E 317C 0400 0010             		move.w	#$400,obVelX(a0)
00899084 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
0089908A 0C78 2AC0 F72A             		cmpi.w	#$2AC0,(v_limitright2).w
00899090 6700                       		beq.s	loc_17A10
00899092 5478 F72A                  		addq.w	#2,(v_limitright2).w
00899096 6000                       		bra.s	loc_17A16
00899098                            ; ===========================================================================
00899098                            
00899098                            loc_17A10:
00899098 4A28 0001                  		tst.b	obRender(a0)
0089909C 6A00                       		bpl.s	BGHZ_ShipDel
0089909E                            
0089909E                            loc_17A16:
0089909E 6100 FE8C                  		bsr.w	BossMove
008990A2 6000 FDCA                  		bra.w	loc_177E6
008990A6                            ; ===========================================================================
008990A6                            
008990A6                            BGHZ_ShipDel:
008990A6 4EF9 0088 E408             		jmp	DeleteObject
008990AC                            ; ===========================================================================
008990AC                            
008990AC                            BGHZ_FaceMain:	; Routine 4
008990AC 7000                       		moveq	#0,d0
008990AE 7201                       		moveq	#1,d1
008990B0 2268 0034                  		movea.l	$34(a0),a1
008990B4 1029 0025                  		move.b	ob2ndRout(a1),d0
008990B8 5900                       		subq.b	#4,d0
008990BA 6600                       		bne.s	loc_17A3E
008990BC 0C69 2A00 0030             		cmpi.w	#$2A00,$30(a1)
008990C2 6600                       		bne.s	loc_17A46
008990C4 7204                       		moveq	#4,d1
008990C6                            
008990C6                            loc_17A3E:
008990C6 5D00                       		subq.b	#6,d0
008990C8 6B00                       		bmi.s	loc_17A46
008990CA 720A                       		moveq	#$A,d1
008990CC 6000                       		bra.s	loc_17A5A
008990CE                            ; ===========================================================================
008990CE                            
008990CE                            loc_17A46:
008990CE 4A29 0020                  		tst.b	obColType(a1)
008990D2 6600                       		bne.s	loc_17A50
008990D4 7205                       		moveq	#5,d1
008990D6 6000                       		bra.s	loc_17A5A
008990D8                            ; ===========================================================================
008990D8                            
008990D8                            loc_17A50:
008990D8 0C38 0004 D024             		cmpi.b	#4,(v_player+obRoutine).w
008990DE 6500                       		bcs.s	loc_17A5A
008990E0 7204                       		moveq	#4,d1
008990E2                            
008990E2                            loc_17A5A:
008990E2 1141 001C                  		move.b	d1,obAnim(a0)
008990E6 5500                       		subq.b	#2,d0
008990E8 6600                       		bne.s	BGHZ_FaceDisp
008990EA 117C 0006 001C             		move.b	#6,obAnim(a0)
008990F0 4A28 0001                  		tst.b	obRender(a0)
008990F4 6A00                       		bpl.s	BGHZ_FaceDel
008990F6                            
008990F6                            BGHZ_FaceDisp:
008990F6 6000                       		bra.s	BGHZ_Display
008990F8                            ; ===========================================================================
008990F8                            
008990F8                            BGHZ_FaceDel:
008990F8 4EF9 0088 E408             		jmp	DeleteObject
008990FE                            ; ===========================================================================
008990FE                            
008990FE                            BGHZ_FlameMain:	; Routine 6
008990FE 117C 0007 001C             		move.b	#7,obAnim(a0)
00899104 2268 0034                  		movea.l	$34(a0),a1
00899108 0C29 000C 0025             		cmpi.b	#$C,ob2ndRout(a1)
0089910E 6600                       		bne.s	loc_17A96
00899110 117C 000B 001C             		move.b	#$B,obAnim(a0)
00899116 4A28 0001                  		tst.b	obRender(a0)
0089911A 6A00                       		bpl.s	BGHZ_FlameDel
0089911C 6000                       		bra.s	BGHZ_FlameDisp
0089911E                            ; ===========================================================================
0089911E                            
0089911E                            loc_17A96:
0089911E 3029 0010                  		move.w	obVelX(a1),d0
00899122 6700                       		beq.s	BGHZ_FlameDisp
00899124 117C 0008 001C             		move.b	#8,obAnim(a0)
0089912A                            
0089912A                            BGHZ_FlameDisp:
0089912A 6000                       		bra.s	BGHZ_Display
0089912C                            ; ===========================================================================
0089912C                            
0089912C                            BGHZ_FlameDel:
0089912C 4EF9 0088 E408             		jmp	DeleteObject
00899132                            ; ===========================================================================
00899132                            
00899132                            BGHZ_Display:				; XREF: BGHZ_FaceDisp; BGHZ_FlameDisp
00899132 2268 0034                  		movea.l	$34(a0),a1
00899136 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089913C 3169 000C 000C             		move.w	obY(a1),obY(a0)
00899142 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
00899148 43F9 0000 0000             		lea	(Ani_Eggman).l,a1
0089914E 4EB9 0088 B4B0             		jsr	AnimateSprite
00899154 1028 0022                  		move.b	obStatus(a0),d0
00899158 0200 0003                  		andi.b	#3,d0
0089915C 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00899162 8128 0001                  		or.b	d0,obRender(a0)
00899166 4EF9 0088 E3CC             		jmp	DisplaySprite
00899166 4EF9 0088 E3CC             		jmp	DisplaySprite
0089916C                            		include	"_incObj\48 Eggman's Swinging Ball.asm"
0089916C                            ; ---------------------------------------------------------------------------
0089916C                            ; Object 48 - ball on a	chain that Eggman swings (GHZ)
0089916C                            ; ---------------------------------------------------------------------------
0089916C                            
0089916C                            BossBall:				; XREF: Obj_Index
0089916C 7000                       		moveq	#0,d0
0089916E 1028 0024                  		move.b	obRoutine(a0),d0
00899172 323B 0000                  		move.w	GBall_Index(pc,d0.w),d1
00899176 4EFB 1000                  		jmp	GBall_Index(pc,d1.w)
0089917A                            ; ===========================================================================
0089917A 0000                       GBall_Index:	dc.w GBall_Main-GBall_Index
0089917C 0000                       		dc.w GBall_Base-GBall_Index
0089917E 0000                       		dc.w GBall_Display2-GBall_Index
00899180 0000                       		dc.w loc_17C68-GBall_Index
00899182 0000                       		dc.w GBall_ChkVanish-GBall_Index
00899184                            ; ===========================================================================
00899184                            
00899184                            GBall_Main:	; Routine 0
00899184 5428 0024                  		addq.b	#2,obRoutine(a0)
00899188 317C 4080 0026             		move.w	#$4080,obAngle(a0)
0089918E 317C FE00 003E             		move.w	#-$200,$3E(a0)
00899194 217C 0000 0000 0004        		move.l	#Map_BossItems,obMap(a0)
0089919C 317C 046C 0002             		move.w	#$46C,obGfx(a0)
008991A2 45E8 0028                  		lea	obSubtype(a0),a2
008991A6 14FC 0000                  		move.b	#0,(a2)+
008991AA 7205                       		moveq	#5,d1
008991AC 2248                       		movea.l	a0,a1
008991AE 6000                       		bra.s	loc_17B60
008991B0                            ; ===========================================================================
008991B0                            
008991B0                            GBall_MakeLinks:
008991B0 4EB9 0088 E878             		jsr	FindNextFreeObj
008991B6 6600                       		bne.s	GBall_MakeBall
008991B8 3368 0008 0008             		move.w	obX(a0),obX(a1)
008991BE 3368 000C 000C             		move.w	obY(a0),obY(a1)
008991C4 137C 0048 0000             		move.b	#id_BossBall,0(a1) ; load chain link object
008991CA 137C 0006 0024             		move.b	#6,obRoutine(a1)
008991D0 237C 0088 887C 0004        		move.l	#Map_Swing_GHZ,obMap(a1)
008991D8 337C 0380 0002             		move.w	#$380,obGfx(a1)
008991DE 137C 0001 001A             		move.b	#1,obFrame(a1)
008991E4 5228 0028                  		addq.b	#1,obSubtype(a0)
008991E8                            
008991E8                            loc_17B60:				; XREF: GBall_Main
008991E8 3A09                       		move.w	a1,d5
008991EA 0445 D000                  		subi.w	#$D000,d5
008991EE EC4D                       		lsr.w	#6,d5
008991F0 0245 007F                  		andi.w	#$7F,d5
008991F4 14C5                       		move.b	d5,(a2)+
008991F6 137C 0004 0001             		move.b	#4,obRender(a1)
008991FC 137C 0008 0019             		move.b	#8,obActWid(a1)
00899202 137C 0006 0018             		move.b	#6,obPriority(a1)
00899208 2368 0034 0034             		move.l	$34(a0),$34(a1)
0089920E 51C9 FFA0                  		dbf	d1,GBall_MakeLinks ; repeat sequence 5 more times
00899212                            
00899212                            GBall_MakeBall:
00899212 137C 0008 0024             		move.b	#8,obRoutine(a1)
00899218 237C 0088 8DDE 0004        		move.l	#Map_GBall,obMap(a1) ; load different mappings for final link
00899220 337C 43AA 0002             		move.w	#$43AA,obGfx(a1) ; use different graphics
00899226 137C 0001 001A             		move.b	#1,obFrame(a1)
0089922C 137C 0005 0018             		move.b	#5,obPriority(a1)
00899232 137C 0081 0020             		move.b	#$81,obColType(a1) ; make object hurt Sonic
00899238 4E75                       		rts	
0089923A                            ; ===========================================================================
0089923A                            
0089923A 0010 2030 4060             GBall_PosData:	dc.b 0,	$10, $20, $30, $40, $60	; y-position data for links and	giant ball
00899240                            
00899240                            ; ===========================================================================
00899240                            
00899240                            GBall_Base:	; Routine 2
00899240 47F9 0089 923A             		lea	(GBall_PosData).l,a3
00899246 45E8 0028                  		lea	obSubtype(a0),a2
0089924A 7C00                       		moveq	#0,d6
0089924C 1C1A                       		move.b	(a2)+,d6
0089924E                            
0089924E                            loc_17BC6:
0089924E 7800                       		moveq	#0,d4
00899250 181A                       		move.b	(a2)+,d4
00899252 ED4C                       		lsl.w	#6,d4
00899254 0684 00FF D000             		addi.l	#v_objspace&$FFFFFF,d4
0089925A 2244                       		movea.l	d4,a1
0089925C 101B                       		move.b	(a3)+,d0
0089925E B029 003C                  		cmp.b	$3C(a1),d0
00899262 6700                       		beq.s	loc_17BE0
00899264 5229 003C                  		addq.b	#1,$3C(a1)
00899268                            
00899268                            loc_17BE0:
00899268 51CE FFE4                  		dbf	d6,loc_17BC6
0089926C                            
0089926C B029 003C                  		cmp.b	$3C(a1),d0
00899270 6600                       		bne.s	loc_17BFA
00899272 2268 0034                  		movea.l	$34(a0),a1
00899276 0C29 0006 0025             		cmpi.b	#6,ob2ndRout(a1)
0089927C 6600                       		bne.s	loc_17BFA
0089927E 5428 0024                  		addq.b	#2,obRoutine(a0)
00899282                            
00899282                            loc_17BFA:
00899282 0C68 0020 0032             		cmpi.w	#$20,$32(a0)
00899288 6700                       		beq.s	GBall_Display
0089928A 5268 0032                  		addq.w	#1,$32(a0)
0089928E                            
0089928E                            GBall_Display:
0089928E 6100 0000                  		bsr.w	sub_17C2A
00899292 1028 0026                  		move.b	obAngle(a0),d0
00899296 4EB9 0088 87EE             		jsr	(Swing_Move2).l
0089929C 4EF9 0088 E3CC             		jmp	DisplaySprite
008992A2                            ; ===========================================================================
008992A2                            
008992A2                            GBall_Display2:	; Routine 4
008992A2 6100 0000                  		bsr.w	sub_17C2A
008992A6 4EB9 0088 87AE             		jsr	(Obj48_Move).l
008992AC 4EF9 0088 E3CC             		jmp	DisplaySprite
008992B2                            
008992B2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
008992B2                            
008992B2                            
008992B2                            sub_17C2A:				; XREF: GBall_Display; GBall_Display2
008992B2 2268 0034                  		movea.l	$34(a0),a1
008992B6 0628 0020 001B             		addi.b	#$20,obAniFrame(a0)
008992BC 6400                       		bcc.s	loc_17C3C
008992BE 0868 0000 001A             		bchg	#0,obFrame(a0)
008992C4                            
008992C4                            loc_17C3C:
008992C4 3169 0008 003A             		move.w	obX(a1),$3A(a0)
008992CA 3029 000C                  		move.w	obY(a1),d0
008992CE D068 0032                  		add.w	$32(a0),d0
008992D2 3140 0038                  		move.w	d0,$38(a0)
008992D6 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
008992DC 4A29 0022                  		tst.b	obStatus(a1)
008992E0 6A00                       		bpl.s	locret_17C66
008992E2 117C 003F 0000             		move.b	#$3F,0(a0)
008992E8 117C 0000 0024             		move.b	#0,obRoutine(a0)
008992EE                            
008992EE                            locret_17C66:
008992EE 4E75                       		rts	
008992F0                            ; End of function sub_17C2A
008992F0                            
008992F0                            ; ===========================================================================
008992F0                            
008992F0                            loc_17C68:	; Routine 6
008992F0 2268 0034                  		movea.l	$34(a0),a1
008992F4 4A29 0022                  		tst.b	obStatus(a1)
008992F8 6A00                       		bpl.s	GBall_Display3
008992FA 117C 003F 0000             		move.b	#$3F,0(a0)
00899300 117C 0000 0024             		move.b	#0,obRoutine(a0)
00899306                            
00899306                            GBall_Display3:
00899306 4EF9 0088 E3CC             		jmp	DisplaySprite
0089930C                            ; ===========================================================================
0089930C                            
0089930C                            GBall_ChkVanish:; Routine 8
0089930C 7000                       		moveq	#0,d0
0089930E 4A28 001A                  		tst.b	obFrame(a0)
00899312 6600                       		bne.s	GBall_Vanish
00899314 5200                       		addq.b	#1,d0
00899316                            
00899316                            GBall_Vanish:
00899316 1140 001A                  		move.b	d0,obFrame(a0)
0089931A 2268 0034                  		movea.l	$34(a0),a1
0089931E 4A29 0022                  		tst.b	obStatus(a1)
00899322 6A00                       		bpl.s	GBall_Display4
00899324 117C 0000 0020             		move.b	#0,obColType(a0)
0089932A 6100 FBBC                  		bsr.w	BossDefeated
0089932E 5328 003C                  		subq.b	#1,$3C(a0)
00899332 6A00                       		bpl.s	GBall_Display4
00899334 10BC 003F                  		move.b	#$3F,(a0)
00899338 117C 0000 0024             		move.b	#0,obRoutine(a0)
0089933E                            
0089933E                            GBall_Display4:
0089933E 4EF9 0088 E3CC             		jmp	DisplaySprite
0089933E 4EF9 0088 E3CC             		jmp	DisplaySprite
00899344                            		include	"_anim\Eggman.asm"
00899344                            ; ---------------------------------------------------------------------------
00899344                            ; Animation script - Eggman (bosses)
00899344                            ; ---------------------------------------------------------------------------
00899344 0000                       Ani_Eggman:	dc.w @ship-Ani_Eggman
00899346 0000                       		dc.w @facenormal1-Ani_Eggman
00899348 0000                       		dc.w @facenormal2-Ani_Eggman
0089934A 0000                       		dc.w @facenormal3-Ani_Eggman
0089934C 0000                       		dc.w @facelaugh-Ani_Eggman
0089934E 0000                       		dc.w @facehit-Ani_Eggman
00899350 0000                       		dc.w @facepanic-Ani_Eggman
00899352 0000                       		dc.w @blank-Ani_Eggman
00899354 0000                       		dc.w @flame1-Ani_Eggman
00899356 0000                       		dc.w @flame2-Ani_Eggman
00899358 0000                       		dc.w @facedefeat-Ani_Eggman
0089935A 0000                       		dc.w @escapeflame-Ani_Eggman
0089935C 0F00 FF                    @ship:		dc.b $F, 0, afEnd
00899360 00                         		even
00899360 0501 02FF                  @facenormal1:	dc.b 5,	1, 2, afEnd
00899364                            		even
00899364 0301 02FF                  @facenormal2:	dc.b 3,	1, 2, afEnd
00899368                            		even
00899368 0101 02FF                  @facenormal3:	dc.b 1,	1, 2, afEnd
0089936C                            		even
0089936C 0403 04FF                  @facelaugh:	dc.b 4,	3, 4, afEnd
00899370                            		even
00899370 1F05 01FF                  @facehit:	dc.b $1F, 5, 1,	afEnd
00899374                            		even
00899374 0306 01FF                  @facepanic:	dc.b 3,	6, 1, afEnd
00899378                            		even
00899378 0F0A FF                    @blank:		dc.b $F, $A, afEnd
0089937C 00                         		even
0089937C 0308 09FF                  @flame1:	dc.b 3,	8, 9, afEnd
00899380                            		even
00899380 0108 09FF                  @flame2:	dc.b 1,	8, 9, afEnd
00899384                            		even
00899384 0F07 FF                    @facedefeat:	dc.b $F, 7, afEnd
00899388 00                         		even
00899388 0209 080B 0C0B 0C09 08FE+  @escapeflame:	dc.b 2,	9, 8, $B, $C, $B, $C, 9, 8, afBack, 2
00899394 00                         		even
00899394 00                         		even
00899394                            		include	"_maps\Eggman.asm"
00899394                            ; ---------------------------------------------------------------------------
00899394                            ; Sprite mappings - Eggman (boss levels)
00899394                            ; ---------------------------------------------------------------------------
00899394 0000 0000                  Map_Eggman:	dc.w @ship-Map_Eggman, @facenormal1-Map_Eggman
00899398 0000 0000                  		dc.w @facenormal2-Map_Eggman, @facelaugh1-Map_Eggman
0089939C 0000 0000                  		dc.w @facelaugh2-Map_Eggman, @facehit-Map_Eggman
008993A0 0000 0000                  		dc.w @facepanic-Map_Eggman, @facedefeat-Map_Eggman
008993A4 0000 0000                  		dc.w @flame1-Map_Eggman, @flame2-Map_Eggman
008993A8 0000 0000                  		dc.w @blank-Map_Eggman, @escapeflame1-Map_Eggman
008993AC 0000                       		dc.w @escapeflame2-Map_Eggman
008993AE                            		
008993AE                            	;Mercury Eggman Art Fix
008993AE 06                         @ship:		dc.b 6
008993AF EC01 000A E4               		dc.b $EC, 1, 0,	$A, $E4
008993B4 EC01 000E 14               		dc.b $EC, 1, 0,	$E, $14
008993B9 FC0E 2010 E4               		dc.b $FC, $E, $20, $10,	$E4
008993BE FC0E 201C 04               		dc.b $FC, $E, $20, $1C,	4
008993C3 140C 2028 EC               		dc.b $14, $C, $20, $28,	$EC
008993C8 1400 202C 0C               		dc.b $14, 0, $20, $2C, $C
008993CD 03                         @facenormal1:	dc.b 3
008993CE EC01 000C 0C               		dc.b $EC, 1, 0,	$C, $C
008993D3 E404 0000 F4               		dc.b $E4, 4, 0,	0, $F4
008993D8 EC0D 0002 EC               		dc.b $EC, $D, 0, 2, $EC
008993DD 03                         @facenormal2:	dc.b 3
008993DE EC01 000C 0C               		dc.b $EC, 1, 0,	$C, $C
008993E3 E404 0000 F4               		dc.b $E4, 4, 0,	0, $F4
008993E8 EC0D 0035 EC               		dc.b $EC, $D, 0, $35, $EC
008993ED 03                         @facelaugh1:	dc.b 3
008993EE E408 003D F4               		dc.b $E4, 8, 0,	$3D, $F4
008993F3 EC09 0040 EC               		dc.b $EC, 9, 0,	$40, $EC
008993F8 EC05 0046 04               		dc.b $EC, 5, 0,	$46, 4
008993FD 03                         @facelaugh2:	dc.b 3
008993FE E408 004A F4               		dc.b $E4, 8, 0,	$4A, $F4
00899403 EC09 004D EC               		dc.b $EC, 9, 0,	$4D, $EC
00899408 EC05 0053 04               		dc.b $EC, 5, 0,	$53, 4
0089940D 03                         @facehit:	dc.b 3
0089940E E408 0057 F4               		dc.b $E4, 8, 0,	$57, $F4
00899413 EC09 005A EC               		dc.b $EC, 9, 0,	$5A, $EC
00899418 EC05 0060 04               		dc.b $EC, 5, 0,	$60, 4
0089941D 04                         @facepanic:	dc.b 4
0089941E EC01 000C 0C               		dc.b $EC, 1, 0,	$C, $C
00899423 E404 0064 04               		dc.b $E4, 4, 0,	$64, 4
00899428 E404 0000 F4               		dc.b $E4, 4, 0,	0, $F4
0089942D EC0D 0035 EC               		dc.b $EC, $D, 0, $35, $EC
00899432 04                         @facedefeat:	dc.b 4
00899433 E409 0066 F4               		dc.b $E4, 9, 0,	$66, $F4
00899438 E408 0057 F4               		dc.b $E4, 8, 0,	$57, $F4
0089943D EC09 005A EC               		dc.b $EC, 9, 0,	$5A, $EC
00899442 EC05 0060 04               		dc.b $EC, 5, 0,	$60, 4
00899447 01                         @flame1:	dc.b 1
00899448 0405 002D 22               		dc.b 4,	5, 0, $2D, $22
0089944D 01                         @flame2:	dc.b 1
0089944E 0405 0031 22               		dc.b 4,	5, 0, $31, $22
00899453 00                         @blank:		dc.b 0
00899454 02                         @escapeflame1:	dc.b 2
00899455 0008 012A 22               		dc.b 0,	8, 1, $2A, $22
0089945A 0808 112A 22               		dc.b 8,	8, $11,	$2A, $22
0089945F 02                         @escapeflame2:	dc.b 2
00899460 F80B 012D 22               		dc.b $F8, $B, 1, $2D, $22
00899465 0001 0139 3A               		dc.b 0,	1, 1, $39, $3A
0089946A                            	;end Eggman Art Fix
0089946A                            	
0089946A                            		even
0089946A                            		
0089946A                            		
0089946A                            		include	"_maps\Boss Items.asm"
0089946A                            ; ---------------------------------------------------------------------------
0089946A                            ; Sprite mappings - extra boss items (e.g. swinging ball on a chain in GHZ)
0089946A                            ; ---------------------------------------------------------------------------
0089946A 0000 0000                  Map_BossItems:	dc.w @chainanchor1-Map_BossItems, @chainanchor2-Map_BossItems
0089946E 0000 0000                  		dc.w @cross-Map_BossItems, @widepipe-Map_BossItems
00899472 0000 0000                  		dc.w @pipe-Map_BossItems, @spike-Map_BossItems
00899476 0000 0000                  		dc.w @legmask-Map_BossItems, @legs-Map_BossItems
0089947A 01                         @chainanchor1:	dc.b 1
0089947B F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8	; GHZ boss
00899480 02                         @chainanchor2:	dc.b 2
00899481 FC04 0004 F8               		dc.b $FC, 4, 0,	4, $F8	; GHZ boss
00899486 F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
0089948C 00                         		even
0089948C 01                         @cross:		dc.b 1
0089948D FC00 0006 FC               		dc.b $FC, 0, 0,	6, $FC	; unknown
00899492 01                         @widepipe:	dc.b 1
00899493 1409 0007 F4               		dc.b $14, 9, 0,	7, $F4	; SLZ boss
00899498 01                         @pipe:		dc.b 1
00899499 1405 000D F8               		dc.b $14, 5, 0,	$D, $F8	; MZ boss
0089949E 04                         @spike:		dc.b 4
0089949F F004 0011 F8               		dc.b $F0, 4, 0,	$11, $F8 ; SYZ boss
008994A4 F801 0013 F8               		dc.b $F8, 1, 0,	$13, $F8
008994A9 F801 0813 00               		dc.b $F8, 1, 8,	$13, 0
008994AE 0804 0015 F8               		dc.b 8,	4, 0, $15, $F8
008994B4 00                         		even
008994B4 02                         @legmask:	dc.b 2
008994B5 0005 0017 00               		dc.b 0,	5, 0, $17, 0	; FZ post-boss: sprite covering part of legs
008994BA 0000 001B 10               		dc.b 0,	0, 0, $1B, $10
008994C0 00                         		even
008994C0 02                         @legs:		dc.b 2
008994C1 1804 001C 00               		dc.b $18, 4, 0,	$1C, 0	; FZ post-boss
008994C6 000B 001E 10               		dc.b 0,	$B, 0, $1E, $10
008994CC 00                         		even
008994CC 00                         		even
008994CC                            		include	"_incObj\77 Boss - Labyrinth.asm"
008994CC                            ; ---------------------------------------------------------------------------
008994CC                            ; Object 77 - Eggman (LZ)
008994CC                            ; ---------------------------------------------------------------------------
008994CC                            
008994CC                            BossLabyrinth:				; XREF: Obj_Index
008994CC 7000                       		moveq	#0,d0
008994CE 1028 0024                  		move.b	obRoutine(a0),d0
008994D2 323B 0000                  		move.w	Obj77_Index(pc,d0.w),d1
008994D6 4EFB 1000                  		jmp	Obj77_Index(pc,d1.w)
008994DA                            ; ===========================================================================
008994DA 0000                       Obj77_Index:	dc.w Obj77_Main-Obj77_Index
008994DC 0000                       		dc.w Obj77_ShipMain-Obj77_Index
008994DE 0000                       		dc.w Obj77_FaceMain-Obj77_Index
008994E0 0000                       		dc.w Obj77_FlameMain-Obj77_Index
008994E2                            
008994E2 0200                       Obj77_ObjData:	dc.b 2,	0		; routine number, animation
008994E4 0401                       		dc.b 4,	1
008994E6 0607                       		dc.b 6,	7
008994E8                            ; ===========================================================================
008994E8                            
008994E8                            Obj77_Main:	; Routine 0
008994E8 317C 1E10 0008             		move.w	#$1E10,obX(a0)
008994EE 317C 05C0 000C             		move.w	#$5C0,obY(a0)
008994F4 3168 0008 0030             		move.w	obX(a0),$30(a0)
008994FA 3168 000C 0038             		move.w	obY(a0),$38(a0)
00899500 117C 000F 0020             		move.b	#$F,obColType(a0)
00899506 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
0089950C 117C 0004 0018             		move.b	#4,obPriority(a0)
00899512 45FA FFCE                  		lea	Obj77_ObjData(pc),a2
00899516 2248                       		movea.l	a0,a1
00899518 7202                       		moveq	#2,d1
0089951A 6000                       		bra.s	Obj77_LoadBoss
0089951C                            ; ===========================================================================
0089951C                            
0089951C                            Obj77_Loop:
0089951C 4EB9 0088 E878             		jsr	FindNextFreeObj
00899522 6600                       		bne.s	Obj77_ShipMain
00899524 137C 0077 0000             		move.b	#id_BossLabyrinth,0(a1)
0089952A 3368 0008 0008             		move.w	obX(a0),obX(a1)
00899530 3368 000C 000C             		move.w	obY(a0),obY(a1)
00899536                            
00899536                            Obj77_LoadBoss:				; XREF: Obj77_Main
00899536 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089953C 4229 0025                  		clr.b	ob2ndRout(a1)
00899540 135A 0024                  		move.b	(a2)+,obRoutine(a1)
00899544 135A 001C                  		move.b	(a2)+,obAnim(a1)
00899548 1368 0018 0018             		move.b	obPriority(a0),obPriority(a1)
0089954E 237C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a1)
00899556 337C 0400 0002             		move.w	#$400,obGfx(a1)
0089955C 137C 0004 0001             		move.b	#4,obRender(a1)
00899562 137C 0020 0019             		move.b	#$20,obActWid(a1)
00899568 2348 0034                  		move.l	a0,$34(a1)
0089956C 51C9 FFAE                  		dbf	d1,Obj77_Loop
00899570                            
00899570                            Obj77_ShipMain:	; Routine 2
00899570 43F8 D000                  		lea	(v_player).w,a1
00899574 7000                       		moveq	#0,d0
00899576 1028 0025                  		move.b	ob2ndRout(a0),d0
0089957A 323B 0000                  		move.w	Obj77_ShipIndex(pc,d0.w),d1
0089957E 4EBB 1000                  		jsr	Obj77_ShipIndex(pc,d1.w)
00899582 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
00899588 4EB9 0088 B4B0             		jsr	AnimateSprite
0089958E 7003                       		moveq	#3,d0
00899590 C028 0022                  		and.b	obStatus(a0),d0
00899594 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089959A 8128 0001                  		or.b	d0,obRender(a0)
0089959E 4EF9 0088 E3CC             		jmp	DisplaySprite
008995A4                            ; ===========================================================================
008995A4 0000 0000                  Obj77_ShipIndex:dc.w loc_17F1E-Obj77_ShipIndex,	loc_17FA0-Obj77_ShipIndex
008995A8 0000 0000                  		dc.w loc_17FE0-Obj77_ShipIndex,	loc_1801E-Obj77_ShipIndex
008995AC 0000 0000                  		dc.w loc_180BC-Obj77_ShipIndex,	loc_180F6-Obj77_ShipIndex
008995B0 0000 0000                  		dc.w loc_1812A-Obj77_ShipIndex,	loc_18152-Obj77_ShipIndex
008995B4                            ; ===========================================================================
008995B4                            
008995B4                            loc_17F1E:				; XREF: Obj77_ShipIndex
008995B4 3029 0008                  		move.w	obX(a1),d0
008995B8 0C40 1DA0                  		cmpi.w	#$1DA0,d0
008995BC 6500                       		bcs.s	loc_17F38
008995BE 317C FE80 0012             		move.w	#-$180,obVelY(a0)
008995C4 317C 0060 0010             		move.w	#$60,obVelX(a0)
008995CA 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008995CE                            
008995CE                            loc_17F38:
008995CE 6100 F95C                  		bsr.w	BossMove
008995D2 3168 0038 000C             		move.w	$38(a0),obY(a0)
008995D8 3168 0030 0008             		move.w	$30(a0),obX(a0)
008995DE                            
008995DE                            loc_17F48:
008995DE 4A28 003D                  		tst.b	$3D(a0)
008995E2 6600                       		bne.s	loc_17F8E
008995E4 4A28 0022                  		tst.b	obStatus(a0)
008995E8 6B00                       		bmi.s	loc_17F92
008995EA 4A28 0020                  		tst.b	obColType(a0)
008995EE 6600                       		bne.s	locret_17F8C
008995F0 4A28 003E                  		tst.b	$3E(a0)
008995F4 6600                       		bne.s	loc_17F70
008995F6 117C 0020 003E             		move.b	#$20,$3E(a0)
00899606                            
00899606                            loc_17F70:
00899606 43F8 FB22                  		lea	(v_pal_dry+$22).w,a1
0089960A 7000                       		moveq	#0,d0
0089960C 4A51                       		tst.w	(a1)
0089960E 6600                       		bne.s	loc_17F7E
00899610 303C 0EEE                  		move.w	#cWhite,d0
00899614                            
00899614                            loc_17F7E:
00899614 3280                       		move.w	d0,(a1)
00899616 5328 003E                  		subq.b	#1,$3E(a0)
0089961A 6600                       		bne.s	locret_17F8C
0089961C 117C 000F 0020             		move.b	#$F,obColType(a0)
00899622                            
00899622                            locret_17F8C:
00899622 4E75                       		rts	
00899624                            ; ===========================================================================
00899624                            
00899624                            loc_17F8E:				; XREF: loc_17F48
00899624 6000 F8C2                  		bra.w	BossDefeated
00899628                            ; ===========================================================================
00899628                            
00899628                            loc_17F92:				; XREF: loc_17F48
00899628 7064                       		moveq	#100,d0
0089962A 6100 0000                  		bsr.w	AddPoints
0089962E 117C 00FF 003D             		move.b	#-1,$3D(a0)
00899634 4E75                       		rts	
00899636                            ; ===========================================================================
00899636                            
00899636                            loc_17FA0:				; XREF: Obj77_ShipIndex
00899636 70FE                       		moveq	#-2,d0
00899638 0C68 1E48 0030             		cmpi.w	#$1E48,$30(a0)
0089963E 6500                       		bcs.s	loc_17FB6
00899640 317C 1E48 0030             		move.w	#$1E48,$30(a0)
00899646 4268 0010                  		clr.w	obVelX(a0)
0089964A 5240                       		addq.w	#1,d0
0089964C                            
0089964C                            loc_17FB6:
0089964C 0C68 0500 0038             		cmpi.w	#$500,$38(a0)
00899652 6E00                       		bgt.s	loc_17FCA
00899654 317C 0500 0038             		move.w	#$500,$38(a0)
0089965A 4268 0012                  		clr.w	obVelY(a0)
0089965E 5240                       		addq.w	#1,d0
00899660                            
00899660                            loc_17FCA:
00899660 6600                       		bne.s	loc_17FDC
00899662 317C 0140 0010             		move.w	#$140,obVelX(a0)
00899668 317C FE00 0012             		move.w	#-$200,obVelY(a0)
0089966E 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899672                            
00899672                            loc_17FDC:
00899672 6000 FF5A                  		bra.w	loc_17F38
00899676                            ; ===========================================================================
00899676                            
00899676                            loc_17FE0:				; XREF: Obj77_ShipIndex
00899676 70FE                       		moveq	#-2,d0
00899678 0C68 1E70 0030             		cmpi.w	#$1E70,$30(a0)
0089967E 6500                       		bcs.s	loc_17FF6
00899680 317C 1E70 0030             		move.w	#$1E70,$30(a0)
00899686 4268 0010                  		clr.w	obVelX(a0)
0089968A 5240                       		addq.w	#1,d0
0089968C                            
0089968C                            loc_17FF6:
0089968C 0C68 04C0 0038             		cmpi.w	#$4C0,$38(a0)
00899692 6E00                       		bgt.s	loc_1800A
00899694 317C 04C0 0038             		move.w	#$4C0,$38(a0)
0089969A 4268 0012                  		clr.w	obVelY(a0)
0089969E 5240                       		addq.w	#1,d0
008996A0                            
008996A0                            loc_1800A:
008996A0 6600                       		bne.s	loc_1801A
008996A2 317C FE80 0012             		move.w	#-$180,obVelY(a0)
008996A8 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008996AC 4228 003F                  		clr.b	$3F(a0)
008996B0                            
008996B0                            loc_1801A:
008996B0 6000 FF1C                  		bra.w	loc_17F38
008996B4                            ; ===========================================================================
008996B4                            
008996B4                            loc_1801E:				; XREF: Obj77_ShipIndex
008996B4 0C68 0100 0038             		cmpi.w	#$100,$38(a0)
008996BA 6E00                       		bgt.s	loc_1804E
008996BC 317C 0100 0038             		move.w	#$100,$38(a0)
008996C2 317C 0140 0010             		move.w	#$140,obVelX(a0)
008996C8 317C FF80 0012             		move.w	#-$80,obVelY(a0)
008996CE 4A28 003D                  		tst.b	$3D(a0)
008996D2 6700                       		beq.s	loc_18046
008996D4 E1E8 0010                  		asl	obVelX(a0)
008996D8 E1E8 0012                  		asl	obVelY(a0)
008996DC                            
008996DC                            loc_18046:
008996DC 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008996E0 6000 FEEC                  		bra.w	loc_17F38
008996E4                            ; ===========================================================================
008996E4                            
008996E4                            loc_1804E:
008996E4 08E8 0000 0022             		bset	#0,obStatus(a0)
008996EA 5428 003F                  		addq.b	#2,$3F(a0)
008996EE 1028 003F                  		move.b	$3F(a0),d0
008996F2 4EB9 0088 301C             		jsr	(CalcSine).l
008996F8 4A41                       		tst.w	d1
008996FA 6A00                       		bpl.s	loc_1806C
008996FC 08A8 0000 0022             		bclr	#0,obStatus(a0)
00899702                            
00899702                            loc_1806C:
00899702 E840                       		asr.w	#4,d0
00899704 4840                       		swap	d0
00899706 4240                       		clr.w	d0
00899708 D0A8 0030                  		add.l	$30(a0),d0
0089970C 4840                       		swap	d0
0089970E 3140 0008                  		move.w	d0,obX(a0)
00899712 3028 0012                  		move.w	obVelY(a0),d0
00899716 3238 D00C                  		move.w	(v_player+obY).w,d1
0089971A 9268 000C                  		sub.w	obY(a0),d1
0089971E 6500                       		bcs.s	loc_180A2
00899720 0441 0048                  		subi.w	#$48,d1
00899724 6500                       		bcs.s	loc_180A2
00899726 E240                       		asr.w	#1,d0
00899728 0441 0028                  		subi.w	#$28,d1
0089972C 6500                       		bcs.s	loc_180A2
0089972E E240                       		asr.w	#1,d0
00899730 0441 0028                  		subi.w	#$28,d1
00899734 6500                       		bcs.s	loc_180A2
00899736 7000                       		moveq	#0,d0
00899738                            
00899738                            loc_180A2:
00899738 48C0                       		ext.l	d0
0089973A E180                       		asl.l	#8,d0
0089973C 4A28 003D                  		tst.b	$3D(a0)
00899740 6700                       		beq.s	loc_180AE
00899742 D080                       		add.l	d0,d0
00899744                            
00899744                            loc_180AE:
00899744 D1A8 0038                  		add.l	d0,$38(a0)
00899748 3168 0038 000C             		move.w	$38(a0),obY(a0)
0089974E 6000 FE8E                  		bra.w	loc_17F48
00899752                            ; ===========================================================================
00899752                            
00899752                            loc_180BC:				; XREF: Obj77_ShipIndex
00899752 70FE                       		moveq	#-2,d0
00899754 0C68 1F4C 0030             		cmpi.w	#$1F4C,$30(a0)
0089975A 6500                       		bcs.s	loc_180D2
0089975C 317C 1F4C 0030             		move.w	#$1F4C,$30(a0)
00899762 4268 0010                  		clr.w	obVelX(a0)
00899766 5240                       		addq.w	#1,d0
00899768                            
00899768                            loc_180D2:
00899768 0C68 00C0 0038             		cmpi.w	#$C0,$38(a0)
0089976E 6E00                       		bgt.s	loc_180E6
00899770 317C 00C0 0038             		move.w	#$C0,$38(a0)
00899776 4268 0012                  		clr.w	obVelY(a0)
0089977A 5240                       		addq.w	#1,d0
0089977C                            
0089977C                            loc_180E6:
0089977C 6600                       		bne.s	loc_180F2
0089977E 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899782 08A8 0000 0022             		bclr	#0,obStatus(a0)
00899788                            
00899788                            loc_180F2:
00899788 6000 FE44                  		bra.w	loc_17F38
0089978C                            ; ===========================================================================
0089978C                            
0089978C                            loc_180F6:				; XREF: Obj77_ShipIndex
0089978C 4A28 003D                  		tst.b	$3D(a0)
00899790 6600                       		bne.s	loc_18112
00899792 0C69 1EC8 0008             		cmpi.w	#$1EC8,obX(a1)
00899798 6D00                       		blt.s	loc_18126
0089979A 0C69 00F0 000C             		cmpi.w	#$F0,obY(a1)
008997A0 6E00                       		bgt.s	loc_18126
008997A2 117C 0032 003C             		move.b	#$32,$3C(a0)
008997A8                            
008997A8                            loc_18112:
008997B2                            
008997B2 4238 F7AA                  		clr.b	(f_lockscreen).w
008997B6                            
008997B6 08E8 0000 0022             		bset	#0,obStatus(a0)
008997BC 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008997C0                            
008997C0                            loc_18126:
008997C0 6000 FE0C                  		bra.w	loc_17F38
008997C4                            ; ===========================================================================
008997C4                            
008997C4                            loc_1812A:				; XREF: Obj77_ShipIndex
008997C4 4A28 003D                  		tst.b	$3D(a0)
008997C8 6600                       		bne.s	loc_18136
008997CA 5328 003C                  		subq.b	#1,$3C(a0)
008997CE 6600                       		bne.s	loc_1814E
008997D0                            
008997D0                            loc_18136:
008997D0 4228 003C                  		clr.b	$3C(a0)
008997D4 317C 0400 0010             		move.w	#$400,obVelX(a0)
008997DA 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
008997E0 4228 003D                  		clr.b	$3D(a0)
008997E4 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008997E8                            
008997E8                            loc_1814E:
008997E8 6000 FDE4                  		bra.w	loc_17F38
008997EC                            ; ===========================================================================
008997EC                            
008997EC                            loc_18152:				; XREF: Obj77_ShipIndex
008997EC 0C78 2030 F72A             		cmpi.w	#$2030,(v_limitright2).w
008997F2 6400                       		bcc.s	loc_18160
008997F4 5478 F72A                  		addq.w	#2,(v_limitright2).w
008997F8 6000                       		bra.s	loc_18166
008997FA                            ; ===========================================================================
008997FA                            
008997FA                            loc_18160:
008997FA 4A28 0001                  		tst.b	obRender(a0)
008997FE 6A00                       		bpl.s	Obj77_ShipDel
00899800                            
00899800                            loc_18166:
00899800 6000 FDCC                  		bra.w	loc_17F38
00899804                            ; ===========================================================================
00899804                            
00899804                            Obj77_ShipDel:
00899804 4EF9 0088 E408             		jmp	DeleteObject
0089980A                            ; ===========================================================================
0089980A                            
0089980A                            Obj77_FaceMain:	; Routine 4
0089980A 2268 0034                  		movea.l	$34(a0),a1
0089980E 1011                       		move.b	(a1),d0
00899810 B010                       		cmp.b	(a0),d0
00899812 6600                       		bne.s	Obj77_FaceDel
00899814 7000                       		moveq	#0,d0
00899816 1029 0025                  		move.b	ob2ndRout(a1),d0
0089981A 7201                       		moveq	#1,d1
0089981C 4A28 003D                  		tst.b	$3D(a0)
00899820 6700                       		beq.s	loc_1818C
00899822 720A                       		moveq	#$A,d1
00899824 6000                       		bra.s	loc_181A0
00899826                            ; ===========================================================================
00899826                            
00899826                            loc_1818C:
00899826 4A29 0020                  		tst.b	obColType(a1)
0089982A 6600                       		bne.s	loc_18196
0089982C 7205                       		moveq	#5,d1
0089982E 6000                       		bra.s	loc_181A0
00899830                            ; ===========================================================================
00899830                            
00899830                            loc_18196:
00899830 0C38 0004 D024             		cmpi.b	#4,(v_player+obRoutine).w
00899836 6500                       		bcs.s	loc_181A0
00899838 7204                       		moveq	#4,d1
0089983A                            
0089983A                            loc_181A0:
0089983A 1141 001C                  		move.b	d1,obAnim(a0)
0089983E 0C00 000E                  		cmpi.b	#$E,d0
00899842 6600                       		bne.s	loc_181B6
00899844 117C 0006 001C             		move.b	#6,obAnim(a0)
0089984A 4A28 0001                  		tst.b	obRender(a0)
0089984E 6A00                       		bpl.s	Obj77_FaceDel
00899850                            
00899850                            loc_181B6:
00899850 6000                       		bra.s	Obj77_Display
00899852                            ; ===========================================================================
00899852                            
00899852                            Obj77_FaceDel:
00899852 4EF9 0088 E408             		jmp	DeleteObject
00899858                            ; ===========================================================================
00899858                            
00899858                            Obj77_FlameMain:; Routine 6
00899858 117C 0007 001C             		move.b	#7,obAnim(a0)
0089985E 2268 0034                  		movea.l	$34(a0),a1
00899862 1011                       		move.b	(a1),d0
00899864 B010                       		cmp.b	(a0),d0
00899866 6600                       		bne.s	Obj77_FlameDel
00899868 0C29 000E 0025             		cmpi.b	#$E,ob2ndRout(a1)
0089986E 6600                       		bne.s	loc_181F0
00899870 117C 000B 001C             		move.b	#$B,obAnim(a0)
00899876 4A28 0001                  		tst.b	1(a0)
0089987A 6A00                       		bpl.s	Obj77_FlameDel
0089987C 6000                       		bra.s	loc_181F0
0089987E                            ; ===========================================================================
0089987E 4A69 0010                  		tst.w	obVelX(a1)
00899882 6700                       		beq.s	loc_181F0
00899884 117C 0008 001C             		move.b	#8,obAnim(a0)
0089988A                            
0089988A                            loc_181F0:
0089988A 6000                       		bra.s	Obj77_Display
0089988C                            ; ===========================================================================
0089988C                            
0089988C                            Obj77_FlameDel:				; XREF: Obj77_FlameMain
0089988C 4EF9 0088 E408             		jmp	DeleteObject
00899892                            ; ===========================================================================
00899892                            
00899892                            Obj77_Display:
00899892 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
00899898 4EB9 0088 B4B0             		jsr	AnimateSprite
0089989E 2268 0034                  		movea.l	$34(a0),a1
008998A2 3169 0008 0008             		move.w	obX(a1),obX(a0)
008998A8 3169 000C 000C             		move.w	obY(a1),obY(a0)
008998AE 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
008998B4 7003                       		moveq	#3,d0
008998B6 C028 0022                  		and.b	obStatus(a0),d0
008998BA 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
008998C0 8128 0001                  		or.b	d0,obRender(a0)
008998C4 4EF9 0088 E3CC             		jmp	DisplaySprite
008998C4 4EF9 0088 E3CC             		jmp	DisplaySprite
008998CA                            		include	"_incObj\73 Boss - Marble.asm"
008998CA                            ; ---------------------------------------------------------------------------
008998CA                            ; Object 73 - Eggman (MZ)
008998CA                            ; ---------------------------------------------------------------------------
008998CA                            
008998CA                            BossMarble:				; XREF: Obj_Index
008998CA 7000                       		moveq	#0,d0
008998CC 1028 0024                  		move.b	obRoutine(a0),d0
008998D0 323B 0000                  		move.w	Obj73_Index(pc,d0.w),d1
008998D4 4EFB 1000                  		jmp	Obj73_Index(pc,d1.w)
008998D8                            ; ===========================================================================
008998D8 0000                       Obj73_Index:	dc.w Obj73_Main-Obj73_Index
008998DA 0000                       		dc.w Obj73_ShipMain-Obj73_Index
008998DC 0000                       		dc.w Obj73_FaceMain-Obj73_Index
008998DE 0000                       		dc.w Obj73_FlameMain-Obj73_Index
008998E0 0000                       		dc.w Obj73_TubeMain-Obj73_Index
008998E2                            
008998E2 0200 04                    Obj73_ObjData:	dc.b 2,	0, 4		; routine number, animation, priority
008998E5 0401 04                    		dc.b 4,	1, 4
008998E8 0607 04                    		dc.b 6,	7, 4
008998EB 0800 03                    		dc.b 8,	0, 3
008998EE                            ; ===========================================================================
008998EE                            
008998EE                            Obj73_Main:	; Routine 0
008998EE 3168 0008 0030             		move.w	obX(a0),$30(a0)
008998F4 3168 000C 0038             		move.w	obY(a0),$38(a0)
008998FA 117C 000F 0020             		move.b	#$F,obColType(a0)
00899900 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
00899906 45FA FFDA                  		lea	Obj73_ObjData(pc),a2
0089990A 2248                       		movea.l	a0,a1
0089990C 7203                       		moveq	#3,d1
0089990E 6000                       		bra.s	Obj73_LoadBoss
00899910                            ; ===========================================================================
00899910                            
00899910                            Obj73_Loop:
00899910 4EB9 0088 E878             		jsr	FindNextFreeObj
00899916 6600                       		bne.s	Obj73_ShipMain
00899918 137C 0073 0000             		move.b	#id_BossMarble,0(a1)
0089991E 3368 0008 0008             		move.w	obX(a0),obX(a1)
00899924 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089992A                            
0089992A                            Obj73_LoadBoss:				; XREF: Obj73_Main
0089992A 08A8 0000 0022             		bclr	#0,obStatus(a0)
00899930 4229 0025                  		clr.b	ob2ndRout(a1)
00899934 135A 0024                  		move.b	(a2)+,obRoutine(a1)
00899938 135A 001C                  		move.b	(a2)+,obAnim(a1)
0089993C 135A 0018                  		move.b	(a2)+,obPriority(a1)
00899940 237C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a1)
00899948 337C 0400 0002             		move.w	#$400,obGfx(a1)
0089994E 137C 0004 0001             		move.b	#4,obRender(a1)
00899954 137C 0020 0019             		move.b	#$20,obActWid(a1)
0089995A 2348 0034                  		move.l	a0,$34(a1)
0089995E 51C9 FFB0                  		dbf	d1,Obj73_Loop	; repeat sequence 3 more times
00899962                            
00899962                            Obj73_ShipMain:	; Routine 2
00899962 7000                       		moveq	#0,d0
00899964 1028 0025                  		move.b	ob2ndRout(a0),d0
00899968 323B 0000                  		move.w	Obj73_ShipIndex(pc,d0.w),d1
0089996C 4EBB 1000                  		jsr	Obj73_ShipIndex(pc,d1.w)
00899970 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
00899976 4EB9 0088 B4B0             		jsr	AnimateSprite
0089997C 7003                       		moveq	#3,d0
0089997E C028 0022                  		and.b	obStatus(a0),d0
00899982 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00899988 8128 0001                  		or.b	d0,obRender(a0)
0089998C 4EF9 0088 E3CC             		jmp	DisplaySprite
00899992                            ; ===========================================================================
00899992 0000                       Obj73_ShipIndex:dc.w loc_18302-Obj73_ShipIndex
00899994 0000                       		dc.w loc_183AA-Obj73_ShipIndex
00899996 0000                       		dc.w loc_184F6-Obj73_ShipIndex
00899998 0000                       		dc.w loc_1852C-Obj73_ShipIndex
0089999A 0000                       		dc.w loc_18582-Obj73_ShipIndex
0089999C                            ; ===========================================================================
0089999C                            
0089999C                            loc_18302:				; XREF: Obj73_ShipIndex
0089999C 1028 003F                  		move.b	$3F(a0),d0
008999A0 5428 003F                  		addq.b	#2,$3F(a0)
008999A4 4EB9 0088 301C             		jsr	(CalcSine).l
008999AA E440                       		asr.w	#2,d0
008999AC 3140 0012                  		move.w	d0,obVelY(a0)
008999B0 317C FF00 0010             		move.w	#-$100,obVelX(a0)
008999B6 6100 F574                  		bsr.w	BossMove
008999BA 0C68 1910 0030             		cmpi.w	#$1910,$30(a0)
008999C0 6600                       		bne.s	loc_18334
008999C2 5428 0025                  		addq.b	#2,ob2ndRout(a0)
008999C6 4228 0028                  		clr.b	obSubtype(a0)
008999CA 42A8 0010                  		clr.l	obVelX(a0)
008999CE                            
008999CE                            loc_18334:
008999CE 4EB9 0088 2FF6             		jsr	(RandomNumber).l
008999D4 1140 0034                  		move.b	d0,$34(a0)
008999D8                            
008999D8                            loc_1833E:
008999D8 3168 0038 000C             		move.w	$38(a0),obY(a0)
008999DE 3168 0030 0008             		move.w	$30(a0),obX(a0)
008999E4 0C28 0004 0025             		cmpi.b	#4,ob2ndRout(a0)
008999EA 6400                       		bcc.s	locret_18390
008999EC 4A28 0022                  		tst.b	obStatus(a0)
008999F0 6B00                       		bmi.s	loc_18392
008999F2 4A28 0020                  		tst.b	obColType(a0)
008999F6 6600                       		bne.s	locret_18390
008999F8 4A28 003E                  		tst.b	$3E(a0)
008999FC 6600                       		bne.s	loc_18374
008999FE 117C 0028 003E             		move.b	#$28,$3E(a0)
00899A0E                            
00899A0E                            loc_18374:
00899A0E 43F8 FB22                  		lea	(v_pal_dry+$22).w,a1
00899A12 7000                       		moveq	#0,d0
00899A14 4A51                       		tst.w	(a1)
00899A16 6600                       		bne.s	loc_18382
00899A18 303C 0EEE                  		move.w	#cWhite,d0
00899A1C                            
00899A1C                            loc_18382:
00899A1C 3280                       		move.w	d0,(a1)
00899A1E 5328 003E                  		subq.b	#1,$3E(a0)
00899A22 6600                       		bne.s	locret_18390
00899A24 117C 000F 0020             		move.b	#$F,obColType(a0)
00899A2A                            
00899A2A                            locret_18390:
00899A2A 4E75                       		rts	
00899A2C                            ; ===========================================================================
00899A2C                            
00899A2C                            loc_18392:				; XREF: loc_1833E
00899A2C 7064                       		moveq	#100,d0
00899A2E 6100 0000                  		bsr.w	AddPoints
00899A32 117C 0004 0025             		move.b	#4,ob2ndRout(a0)
00899A38 317C 00B4 003C             		move.w	#$B4,$3C(a0)
00899A3E 4268 0010                  		clr.w	obVelX(a0)
00899A42 4E75                       		rts	
00899A44                            ; ===========================================================================
00899A44                            
00899A44                            loc_183AA:				; XREF: Obj73_ShipIndex
00899A44 7000                       		moveq	#0,d0
00899A46 1028 0028                  		move.b	obSubtype(a0),d0
00899A4A 303B 0000                  		move.w	off_183C2(pc,d0.w),d0
00899A4E 4EBB 0000                  		jsr	off_183C2(pc,d0.w)
00899A52 0228 0006 0028             		andi.b	#6,obSubtype(a0)
00899A58 6000 FF7E                  		bra.w	loc_1833E
00899A5C                            ; ===========================================================================
00899A5C 0000                       off_183C2:	dc.w loc_183CA-off_183C2
00899A5E 0000                       		dc.w Obj73_MakeLava2-off_183C2
00899A60 0000                       		dc.w loc_183CA-off_183C2
00899A62 0000                       		dc.w Obj73_MakeLava2-off_183C2
00899A64                            ; ===========================================================================
00899A64                            
00899A64                            loc_183CA:				; XREF: off_183C2
00899A64 4A68 0010                  		tst.w	obVelX(a0)
00899A68 6600                       		bne.s	loc_183FE
00899A6A 7040                       		moveq	#$40,d0
00899A6C 0C68 022C 0038             		cmpi.w	#$22C,$38(a0)
00899A72 6700                       		beq.s	loc_183E6
00899A74 6500                       		bcs.s	loc_183DE
00899A76 4440                       		neg.w	d0
00899A78                            
00899A78                            loc_183DE:
00899A78 3140 0012                  		move.w	d0,obVelY(a0)
00899A7C 6000 F4AE                  		bra.w	BossMove
00899A80                            ; ===========================================================================
00899A80                            
00899A80                            loc_183E6:
00899A80 317C 0200 0010             		move.w	#$200,obVelX(a0)
00899A86 317C 0100 0012             		move.w	#$100,obVelY(a0)
00899A8C 0828 0000 0022             		btst	#0,obStatus(a0)
00899A92 6600                       		bne.s	loc_183FE
00899A94 4468 0010                  		neg.w	obVelX(a0)
00899A98                            
00899A98                            loc_183FE:
00899A98 0C28 0018 003E             		cmpi.b	#$18,$3E(a0)
00899A9E 6400                       		bcc.s	Obj73_MakeLava
00899AA0 6100 F48A                  		bsr.w	BossMove
00899AA4 5968 0012                  		subq.w	#4,obVelY(a0)
00899AA8                            
00899AA8                            Obj73_MakeLava:
00899AA8 5328 0034                  		subq.b	#1,$34(a0)
00899AAC 6400                       		bcc.s	loc_1845C
00899AAE 4EB9 0088 E862             		jsr	FindFreeObj
00899AB4 6600                       		bne.s	loc_1844A
00899AB6 137C 0014 0000             		move.b	#id_LavaBall,0(a1) ; load lava ball object
00899ABC 337C 02E8 000C             		move.w	#$2E8,obY(a1)	; set Y	position
00899AC2 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00899AC8 0280 0000 FFFF             		andi.l	#$FFFF,d0
00899ACE 80FC 0050                  		divu.w	#$50,d0
00899AD2 4840                       		swap	d0
00899AD4 0640 1878                  		addi.w	#$1878,d0
00899AD8 3340 0008                  		move.w	d0,obX(a1)
00899ADC EE09                       		lsr.b	#7,d1
00899ADE 337C 00FF 0028             		move.w	#$FF,obSubtype(a1)
00899AE4                            
00899AE4                            loc_1844A:
00899AE4 4EB9 0088 2FF6             		jsr	(RandomNumber).l
00899AEA 0200 001F                  		andi.b	#$1F,d0
00899AEE 0600 0040                  		addi.b	#$40,d0
00899AF2 1140 0034                  		move.b	d0,$34(a0)
00899AF6                            
00899AF6                            loc_1845C:
00899AF6 0828 0000 0022             		btst	#0,obStatus(a0)
00899AFC 6700                       		beq.s	loc_18474
00899AFE 0C68 1910 0030             		cmpi.w	#$1910,$30(a0)
00899B04 6D00                       		blt.s	locret_1849C
00899B06 317C 1910 0030             		move.w	#$1910,$30(a0)
00899B0C 6000                       		bra.s	loc_18482
00899B0E                            ; ===========================================================================
00899B0E                            
00899B0E                            loc_18474:
00899B0E 0C68 1830 0030             		cmpi.w	#$1830,$30(a0)
00899B14 6E00                       		bgt.s	locret_1849C
00899B16 317C 1830 0030             		move.w	#$1830,$30(a0)
00899B1C                            
00899B1C                            loc_18482:
00899B1C 4268 0010                  		clr.w	obVelX(a0)
00899B20 317C FE80 0012             		move.w	#-$180,obVelY(a0)
00899B26 0C68 022C 0038             		cmpi.w	#$22C,$38(a0)
00899B2C 6400                       		bcc.s	loc_18498
00899B2E 4468 0012                  		neg.w	obVelY(a0)
00899B32                            
00899B32                            loc_18498:
00899B32 5428 0028                  		addq.b	#2,obSubtype(a0)
00899B36                            
00899B36                            locret_1849C:
00899B36 4E75                       		rts	
00899B38                            ; ===========================================================================
00899B38                            
00899B38                            Obj73_MakeLava2:			; XREF: off_183C2
00899B38 6100 F3F2                  		bsr.w	BossMove
00899B3C 3028 0038                  		move.w	$38(a0),d0
00899B40 0440 022C                  		subi.w	#$22C,d0
00899B44 6E00                       		bgt.s	locret_184F4
00899B46 303C 022C                  		move.w	#$22C,d0
00899B4A 4A68 0012                  		tst.w	obVelY(a0)
00899B4E 6700                       		beq.s	loc_184EA
00899B50 4268 0012                  		clr.w	obVelY(a0)
00899B54 317C 0050 003C             		move.w	#$50,$3C(a0)
00899B5A 0868 0000 0022             		bchg	#0,obStatus(a0)
00899B60 4EB9 0088 E862             		jsr	FindFreeObj
00899B66 6600                       		bne.s	loc_184EA
00899B68 3368 0030 0008             		move.w	$30(a0),obX(a1)
00899B6E 3368 0038 000C             		move.w	$38(a0),obY(a1)
00899B74 0669 0018 000C             		addi.w	#$18,obY(a1)
00899B7A 12BC 0074                  		move.b	#$74,(a1)	; load lava ball object
00899B7E 137C 0001 0028             		move.b	#1,obSubtype(a1)
00899B84                            
00899B84                            loc_184EA:
00899B84 5368 003C                  		subq.w	#1,$3C(a0)
00899B88 6600                       		bne.s	locret_184F4
00899B8A 5428 0028                  		addq.b	#2,obSubtype(a0)
00899B8E                            
00899B8E                            locret_184F4:
00899B8E 4E75                       		rts	
00899B90                            ; ===========================================================================
00899B90                            
00899B90                            loc_184F6:				; XREF: Obj73_ShipIndex
00899B90 5368 003C                  		subq.w	#1,$3C(a0)
00899B94 6B00                       		bmi.s	loc_18500
00899B96 6000 F350                  		bra.w	BossDefeated
00899B9A                            ; ===========================================================================
00899B9A                            
00899B9A                            loc_18500:
00899B9A 08E8 0000 0022             		bset	#0,obStatus(a0)
00899BA0 08A8 0007 0022             		bclr	#7,obStatus(a0)
00899BA6 4268 0010                  		clr.w	obVelX(a0)
00899BAA 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899BAE 317C FFDA 003C             		move.w	#-$26,$3C(a0)
00899BB4 4A38 F7A7                  		tst.b	(v_bossstatus).w
00899BB8 6600                       		bne.s	locret_1852A
00899BBA 11FC 0001 F7A7             		move.b	#1,(v_bossstatus).w
00899BC0 4268 0012                  		clr.w	obVelY(a0)
00899BC4                            
00899BC4                            locret_1852A:
00899BC4 4E75                       		rts	
00899BC6                            ; ===========================================================================
00899BC6                            
00899BC6                            loc_1852C:				; XREF: Obj73_ShipIndex
00899BC6 5268 003C                  		addq.w	#1,$3C(a0)
00899BCA 6700                       		beq.s	loc_18544
00899BCC 6A00                       		bpl.s	loc_1854E
00899BCE 0C68 0270 0038             		cmpi.w	#$270,$38(a0)
00899BD4 6400                       		bcc.s	loc_18544
00899BD6 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00899BDC 6000                       		bra.s	loc_1857A
00899BDE                            ; ===========================================================================
00899BDE                            
00899BDE                            loc_18544:
00899BDE 4268 0012                  		clr.w	obVelY(a0)
00899BE2 4268 003C                  		clr.w	$3C(a0)
00899BE6 6000                       		bra.s	loc_1857A
00899BE8                            ; ===========================================================================
00899BE8                            
00899BE8                            loc_1854E:
00899BE8 0C68 0030 003C             		cmpi.w	#$30,$3C(a0)
00899BEE 6500                       		bcs.s	loc_18566
00899BF0 6700                       		beq.s	loc_1856C
00899BF2 0C68 0038 003C             		cmpi.w	#$38,$3C(a0)
00899BF8 6500                       		bcs.s	loc_1857A
00899BFA 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899BFE 6000                       		bra.s	loc_1857A
00899C00                            ; ===========================================================================
00899C00                            
00899C00                            loc_18566:
00899C00 5168 0012                  		subq.w	#8,obVelY(a0)
00899C04 6000                       		bra.s	loc_1857A
00899C06                            ; ===========================================================================
00899C06                            
00899C06                            loc_1856C:
00899C06 4268 0012                  		clr.w	obVelY(a0)
00899C14                            
00899C14                            loc_1857A:
00899C14 6100 F316                  		bsr.w	BossMove
00899C18 6000 FDBE                  		bra.w	loc_1833E
00899C1C                            ; ===========================================================================
00899C1C                            
00899C1C                            loc_18582:				; XREF: Obj73_ShipIndex
00899C1C 317C 0500 0010             		move.w	#$500,obVelX(a0)
00899C22 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
00899C28 0C78 1960 F72A             		cmpi.w	#$1960,(v_limitright2).w
00899C2E 6400                       		bcc.s	loc_1859C
00899C30 5478 F72A                  		addq.w	#2,(v_limitright2).w
00899C34 6000                       		bra.s	loc_185A2
00899C36                            ; ===========================================================================
00899C36                            
00899C36                            loc_1859C:
00899C36 4A28 0001                  		tst.b	obRender(a0)
00899C3A 6A00                       		bpl.s	Obj73_ShipDel
00899C3C                            
00899C3C                            loc_185A2:
00899C3C 6100 F2EE                  		bsr.w	BossMove
00899C40 6000 FD96                  		bra.w	loc_1833E
00899C44                            ; ===========================================================================
00899C44                            
00899C44                            Obj73_ShipDel:
00899C44 4EF9 0088 E408             		jmp	DeleteObject
00899C4A                            ; ===========================================================================
00899C4A                            
00899C4A                            Obj73_FaceMain:	; Routine 4
00899C4A 7000                       		moveq	#0,d0
00899C4C 7201                       		moveq	#1,d1
00899C4E 2268 0034                  		movea.l	$34(a0),a1
00899C52 1029 0025                  		move.b	ob2ndRout(a1),d0
00899C56 5540                       		subq.w	#2,d0
00899C58 6600                       		bne.s	loc_185D2
00899C5A 0829 0001 0028             		btst	#1,obSubtype(a1)
00899C60 6700                       		beq.s	loc_185DA
00899C62 4A69 0012                  		tst.w	obVelY(a1)
00899C66 6600                       		bne.s	loc_185DA
00899C68 7204                       		moveq	#4,d1
00899C6A 6000                       		bra.s	loc_185EE
00899C6C                            ; ===========================================================================
00899C6C                            
00899C6C                            loc_185D2:
00899C6C 5500                       		subq.b	#2,d0
00899C6E 6B00                       		bmi.s	loc_185DA
00899C70 720A                       		moveq	#$A,d1
00899C72 6000                       		bra.s	loc_185EE
00899C74                            ; ===========================================================================
00899C74                            
00899C74                            loc_185DA:
00899C74 4A29 0020                  		tst.b	obColType(a1)
00899C78 6600                       		bne.s	loc_185E4
00899C7A 7205                       		moveq	#5,d1
00899C7C 6000                       		bra.s	loc_185EE
00899C7E                            ; ===========================================================================
00899C7E                            
00899C7E                            loc_185E4:
00899C7E 0C38 0004 D024             		cmpi.b	#4,(v_player+obRoutine).w
00899C84 6500                       		bcs.s	loc_185EE
00899C86 7204                       		moveq	#4,d1
00899C88                            
00899C88                            loc_185EE:
00899C88 1141 001C                  		move.b	d1,obAnim(a0)
00899C8C 5900                       		subq.b	#4,d0
00899C8E 6600                       		bne.s	loc_18602
00899C90 117C 0006 001C             		move.b	#6,obAnim(a0)
00899C96 4A28 0001                  		tst.b	obRender(a0)
00899C9A 6A00                       		bpl.s	Obj73_FaceDel
00899C9C                            
00899C9C                            loc_18602:
00899C9C 6000                       		bra.s	Obj73_Display
00899C9E                            ; ===========================================================================
00899C9E                            
00899C9E                            Obj73_FaceDel:
00899C9E 4EF9 0088 E408             		jmp	DeleteObject
00899CA4                            ; ===========================================================================
00899CA4                            
00899CA4                            Obj73_FlameMain:; Routine 6
00899CA4 117C 0007 001C             		move.b	#7,obAnim(a0)
00899CAA 2268 0034                  		movea.l	$34(a0),a1
00899CAE 0C29 0008 0025             		cmpi.b	#8,ob2ndRout(a1)
00899CB4 6D00                       		blt.s	loc_1862A
00899CB6 117C 000B 001C             		move.b	#$B,obAnim(a0)
00899CBC 4A28 0001                  		tst.b	obRender(a0)
00899CC0 6A00                       		bpl.s	Obj73_FlameDel
00899CC2 6000                       		bra.s	loc_18636
00899CC4                            ; ===========================================================================
00899CC4                            
00899CC4                            loc_1862A:
00899CC4 4A69 0010                  		tst.w	obVelX(a1)
00899CC8 6700                       		beq.s	loc_18636
00899CCA 117C 0008 001C             		move.b	#8,obAnim(a0)
00899CD0                            
00899CD0                            loc_18636:
00899CD0 6000                       		bra.s	Obj73_Display
00899CD2                            ; ===========================================================================
00899CD2                            
00899CD2                            Obj73_FlameDel:				; XREF: Obj73_FlameMain
00899CD2 4EF9 0088 E408             		jmp	DeleteObject
00899CD8                            ; ===========================================================================
00899CD8                            
00899CD8                            Obj73_Display:
00899CD8 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
00899CDE 4EB9 0088 B4B0             		jsr	AnimateSprite
00899CE4                            
00899CE4                            loc_1864A:
00899CE4 2268 0034                  		movea.l	$34(a0),a1
00899CE8 3169 0008 0008             		move.w	obX(a1),obX(a0)
00899CEE 3169 000C 000C             		move.w	obY(a1),obY(a0)
00899CF4 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
00899CFA 7003                       		moveq	#3,d0
00899CFC C028 0022                  		and.b	obStatus(a0),d0
00899D00 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
00899D06 8128 0001                  		or.b	d0,obRender(a0)
00899D0A 4EF9 0088 E3CC             		jmp	DisplaySprite
00899D10                            ; ===========================================================================
00899D10                            
00899D10                            Obj73_TubeMain:	; Routine 8
00899D10 2268 0034                  		movea.l	$34(a0),a1
00899D14 0C29 0008 0025             		cmpi.b	#8,ob2ndRout(a1)
00899D1A 6600                       		bne.s	loc_18688
00899D1C 4A28 0001                  		tst.b	obRender(a0)
00899D20 6A00                       		bpl.s	Obj73_TubeDel
00899D22                            
00899D22                            loc_18688:
00899D22 217C 0089 946A 0004        		move.l	#Map_BossItems,obMap(a0)
00899D2A 317C 246C 0002             		move.w	#$246C,obGfx(a0)
00899D30 117C 0004 001A             		move.b	#4,obFrame(a0)
00899D36 60AC                       		bra.s	loc_1864A
00899D38                            ; ===========================================================================
00899D38                            
00899D38                            Obj73_TubeDel:
00899D38 4EF9 0088 E408             		jmp	DeleteObject
00899D38 4EF9 0088 E408             		jmp	DeleteObject
00899D3E                            		include	"_incObj\74 MZ Boss Fire.asm"
00899D3E                            ; ---------------------------------------------------------------------------
00899D3E                            ; Object 74 - lava that	Eggman drops (MZ)
00899D3E                            ; ---------------------------------------------------------------------------
00899D3E                            
00899D3E                            BossFire:				; XREF: Obj_Index
00899D3E 7000                       		moveq	#0,d0
00899D40 1028 0024                  		move.b	obRoutine(a0),d0
00899D44 303B 0000                  		move.w	Obj74_Index(pc,d0.w),d0
00899D48 4EBB 0000                  		jsr	Obj74_Index(pc,d0.w)
00899D4C 4EF9 0088 E3CC             		jmp	DisplaySprite
00899D52                            ; ===========================================================================
00899D52 0000                       Obj74_Index:	dc.w Obj74_Main-Obj74_Index
00899D54 0000                       		dc.w Obj74_Action-Obj74_Index
00899D56 0000                       		dc.w loc_18886-Obj74_Index
00899D58 0000                       		dc.w Obj74_Delete3-Obj74_Index
00899D5A                            ; ===========================================================================
00899D5A                            
00899D5A                            Obj74_Main:	; Routine 0
00899D5A 117C 0008 0016             		move.b	#8,obHeight(a0)
00899D60 117C 0008 0017             		move.b	#8,obWidth(a0)
00899D66 217C 0088 C106 0004        		move.l	#Map_Fire,obMap(a0)
00899D6E 317C 0345 0002             		move.w	#$345,obGfx(a0)
00899D74 117C 0004 0001             		move.b	#4,obRender(a0)
00899D7A 117C 0005 0018             		move.b	#5,obPriority(a0)
00899D80 3168 000C 0038             		move.w	obY(a0),$38(a0)
00899D86 117C 0008 0019             		move.b	#8,obActWid(a0)
00899D8C 5428 0024                  		addq.b	#2,obRoutine(a0)
00899D90 4A28 0028                  		tst.b	obSubtype(a0)
00899D94 6600                       		bne.s	loc_1870A
00899D96 117C 008B 0020             		move.b	#$8B,obColType(a0)
00899D9C 5428 0024                  		addq.b	#2,obRoutine(a0)
00899DA0 6000 0000                  		bra.w	loc_18886
00899DA4                            ; ===========================================================================
00899DA4                            
00899DA4                            loc_1870A:
00899DA4 117C 001E 0029             		move.b	#$1E,$29(a0)
00899DB4                            
00899DB4                            Obj74_Action:	; Routine 2
00899DB4 7000                       		moveq	#0,d0
00899DB6 1028 0025                  		move.b	ob2ndRout(a0),d0
00899DBA 303B 0000                  		move.w	Obj74_Index2(pc,d0.w),d0
00899DBE 4EBB 0000                  		jsr	Obj74_Index2(pc,d0.w)
00899DC2 4EB9 0088 E3B2             		jsr	ObjectMove
00899DC8 43F9 0088 F2AC             		lea	(Ani_Fire).l,a1
00899DCE 4EB9 0088 B4B0             		jsr	AnimateSprite
00899DD4 0C68 02E8 000C             		cmpi.w	#$2E8,obY(a0)
00899DDA 6200                       		bhi.s	Obj74_Delete
00899DDC 4E75                       		rts	
00899DDE                            ; ===========================================================================
00899DDE                            
00899DDE                            Obj74_Delete:
00899DDE 4EF9 0088 E408             		jmp	DeleteObject
00899DE4                            ; ===========================================================================
00899DE4 0000                       Obj74_Index2:	dc.w Obj74_Drop-Obj74_Index2
00899DE6 0000                       		dc.w Obj74_MakeFlame-Obj74_Index2
00899DE8 0000                       		dc.w Obj74_Duplicate-Obj74_Index2
00899DEA 0000                       		dc.w Obj74_FallEdge-Obj74_Index2
00899DEC                            ; ===========================================================================
00899DEC                            
00899DEC                            Obj74_Drop:				; XREF: Obj74_Index2
00899DEC 08E8 0001 0022             		bset	#1,obStatus(a0)
00899DF2 5328 0029                  		subq.b	#1,$29(a0)
00899DF6 6A00                       		bpl.s	locret_18780
00899DF8 117C 008B 0020             		move.b	#$8B,obColType(a0)
00899DFE 4228 0028                  		clr.b	obSubtype(a0)
00899E02 0668 0018 0012             		addi.w	#$18,obVelY(a0)
00899E08 08A8 0001 0022             		bclr	#1,obStatus(a0)
00899E0E 6100 C646                  		bsr.w	ObjFloorDist
00899E12 4A41                       		tst.w	d1
00899E14 6A00                       		bpl.s	locret_18780
00899E16 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899E1A                            
00899E1A                            locret_18780:
00899E1A 4E75                       		rts	
00899E1C                            ; ===========================================================================
00899E1C                            
00899E1C                            Obj74_MakeFlame:			; XREF: Obj74_Index2
00899E1C 5568 000C                  		subq.w	#2,obY(a0)
00899E20 08E8 0007 0002             		bset	#7,obGfx(a0)
00899E26 317C 00A0 0010             		move.w	#$A0,obVelX(a0)
00899E2C 4268 0012                  		clr.w	obVelY(a0)
00899E30 3168 0008 0030             		move.w	obX(a0),$30(a0)
00899E36 3168 000C 0038             		move.w	obY(a0),$38(a0)
00899E3C 117C 0003 0029             		move.b	#3,$29(a0)
00899E42 4EB9 0088 E878             		jsr	FindNextFreeObj
00899E48 6600                       		bne.s	loc_187CA
00899E4A 47D1                       		lea	(a1),a3
00899E4C 45D0                       		lea	(a0),a2
00899E4E 7003                       		moveq	#3,d0
00899E50                            
00899E50                            Obj74_Loop:
00899E50 26DA                       		move.l	(a2)+,(a3)+
00899E52 26DA                       		move.l	(a2)+,(a3)+
00899E54 26DA                       		move.l	(a2)+,(a3)+
00899E56 26DA                       		move.l	(a2)+,(a3)+
00899E58 51C8 FFF6                  		dbf	d0,Obj74_Loop
00899E5C                            
00899E5C 4469 0010                  		neg.w	obVelX(a1)
00899E60 5429 0025                  		addq.b	#2,ob2ndRout(a1)
00899E64                            
00899E64                            loc_187CA:
00899E64 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899E68 4E75                       		rts	
00899E6A                            
00899E6A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
00899E6A                            
00899E6A                            
00899E6A                            Obj74_Duplicate2:			; XREF: Obj74_Duplicate
00899E6A 4EB9 0088 E878             		jsr	FindNextFreeObj
00899E70 6600                       		bne.s	locret_187EE
00899E72 3368 0008 0008             		move.w	obX(a0),obX(a1)
00899E78 3368 000C 000C             		move.w	obY(a0),obY(a1)
00899E7E 12BC 0074                  		move.b	#id_BossFire,(a1)
00899E82 337C 0067 0028             		move.w	#$67,obSubtype(a1)
00899E88                            
00899E88                            locret_187EE:
00899E88 4E75                       		rts	
00899E8A                            ; End of function Obj74_Duplicate2
00899E8A                            
00899E8A                            ; ===========================================================================
00899E8A                            
00899E8A                            Obj74_Duplicate:			; XREF: Obj74_Index2
00899E8A 6100 C5CA                  		bsr.w	ObjFloorDist
00899E8E 4A41                       		tst.w	d1
00899E90 6A00                       		bpl.s	loc_18826
00899E92 3028 0008                  		move.w	obX(a0),d0
00899E96 0C40 1940                  		cmpi.w	#$1940,d0
00899E9A 6E00                       		bgt.s	loc_1882C
00899E9C 3228 0030                  		move.w	$30(a0),d1
00899EA0 B240                       		cmp.w	d0,d1
00899EA2 6700                       		beq.s	loc_1881E
00899EA4 0240 0010                  		andi.w	#$10,d0
00899EA8 0241 0010                  		andi.w	#$10,d1
00899EAC B240                       		cmp.w	d0,d1
00899EAE 6700                       		beq.s	loc_1881E
00899EB0 61B8                       		bsr.s	Obj74_Duplicate2
00899EB2 3168 0008 0032             		move.w	obX(a0),$32(a0)
00899EB8                            
00899EB8                            loc_1881E:
00899EB8 3168 0008 0030             		move.w	obX(a0),$30(a0)
00899EBE 4E75                       		rts	
00899EC0                            ; ===========================================================================
00899EC0                            
00899EC0                            loc_18826:
00899EC0 5428 0025                  		addq.b	#2,ob2ndRout(a0)
00899EC4 4E75                       		rts	
00899EC6                            ; ===========================================================================
00899EC6                            
00899EC6                            loc_1882C:
00899EC6 5428 0024                  		addq.b	#2,obRoutine(a0)
00899ECA 4E75                       		rts	
00899ECC                            ; ===========================================================================
00899ECC                            
00899ECC                            Obj74_FallEdge:				; XREF: Obj74_Index2
00899ECC 08A8 0001 0022             		bclr	#1,obStatus(a0)
00899ED2 0668 0024 0012             		addi.w	#$24,obVelY(a0)	; make flame fall
00899ED8 3028 0008                  		move.w	obX(a0),d0
00899EDC 9068 0032                  		sub.w	$32(a0),d0
00899EE0 6A00                       		bpl.s	loc_1884A
00899EE2 4440                       		neg.w	d0
00899EE4                            
00899EE4                            loc_1884A:
00899EE4 0C40 0012                  		cmpi.w	#$12,d0
00899EE8 6600                       		bne.s	loc_18856
00899EEA 08A8 0007 0002             		bclr	#7,obGfx(a0)
00899EF0                            
00899EF0                            loc_18856:
00899EF0 6100 C564                  		bsr.w	ObjFloorDist
00899EF4 4A41                       		tst.w	d1
00899EF6 6A00                       		bpl.s	locret_1887E
00899EF8 5328 0029                  		subq.b	#1,$29(a0)
00899EFC 6700                       		beq.s	Obj74_Delete2
00899EFE 4268 0012                  		clr.w	obVelY(a0)
00899F02 3168 0032 0008             		move.w	$32(a0),obX(a0)
00899F08 3168 0038 000C             		move.w	$38(a0),obY(a0)
00899F0E 08E8 0007 0002             		bset	#7,obGfx(a0)
00899F14 5528 0025                  		subq.b	#2,ob2ndRout(a0)
00899F18                            
00899F18                            locret_1887E:
00899F18 4E75                       		rts	
00899F1A                            ; ===========================================================================
00899F1A                            
00899F1A                            Obj74_Delete2:
00899F1A 4EF9 0088 E408             		jmp	DeleteObject
00899F20                            ; ===========================================================================
00899F20                            
00899F20                            loc_18886:	; Routine 4
00899F20 08E8 0007 0002             		bset	#7,obGfx(a0)
00899F26 5328 0029                  		subq.b	#1,$29(a0)
00899F2A 6600                       		bne.s	Obj74_Animate
00899F2C 117C 0001 001C             		move.b	#1,obAnim(a0)
00899F32 5968 000C                  		subq.w	#4,obY(a0)
00899F36 4228 0020                  		clr.b	obColType(a0)
00899F3A                            
00899F3A                            Obj74_Animate:
00899F3A 43F9 0088 F2AC             		lea	(Ani_Fire).l,a1
00899F40 4EF9 0088 B4B0             		jmp	AnimateSprite
00899F46                            ; ===========================================================================
00899F46                            
00899F46                            Obj74_Delete3:	; Routine 6
00899F46 4EF9 0088 E408             		jmp	DeleteObject
00899F46 4EF9 0088 E408             		jmp	DeleteObject
00899F4C                            
00899F4C                            	Obj7A_Delete:
00899F4C 4EF9 0088 E408             		jmp	DeleteObject
00899F52                            
00899F52                            		include	"_incObj\7A Boss - Star Light.asm"
00899F52                            ; ---------------------------------------------------------------------------
00899F52                            ; Object 7A - Eggman (SLZ)
00899F52                            ; ---------------------------------------------------------------------------
00899F52                            
00899F52                            BossStarLight:				; XREF: Obj_Index
00899F52 7000                       		moveq	#0,d0
00899F54 1028 0024                  		move.b	obRoutine(a0),d0
00899F58 323B 0000                  		move.w	Obj7A_Index(pc,d0.w),d1
00899F5C 4EFB 1000                  		jmp	Obj7A_Index(pc,d1.w)
00899F60                            ; ===========================================================================
00899F60 0000                       Obj7A_Index:	dc.w Obj7A_Main-Obj7A_Index
00899F62 0000                       		dc.w Obj7A_ShipMain-Obj7A_Index
00899F64 0000                       		dc.w Obj7A_FaceMain-Obj7A_Index
00899F66 0000                       		dc.w Obj7A_FlameMain-Obj7A_Index
00899F68 0000                       		dc.w Obj7A_TubeMain-Obj7A_Index
00899F6A                            
00899F6A 0200 04                    Obj7A_ObjData:	dc.b 2,	0, 4		; routine number, animation, priority
00899F6D 0401 04                    		dc.b 4,	1, 4
00899F70 0607 04                    		dc.b 6,	7, 4
00899F73 0800 03                    		dc.b 8,	0, 3
00899F76                            ; ===========================================================================
00899F76                            
00899F76                            Obj7A_Main:				; XREF: Obj7A_Index
00899F76 317C 2188 0008             		move.w	#$2188,obX(a0)
00899F7C 317C 0228 000C             		move.w	#$228,obY(a0)
00899F82 3168 0008 0030             		move.w	obX(a0),$30(a0)
00899F88 3168 000C 0038             		move.w	obY(a0),$38(a0)
00899F8E 117C 000F 0020             		move.b	#$F,obColType(a0)
00899F94 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
00899F9A 45FA FFCE                  		lea	Obj7A_ObjData(pc),a2
00899F9E 2248                       		movea.l	a0,a1
00899FA0 7203                       		moveq	#3,d1
00899FA2 6000                       		bra.s	Obj7A_LoadBoss
00899FA4                            ; ===========================================================================
00899FA4                            
00899FA4                            Obj7A_Loop:
00899FA4 4EB9 0088 E878             		jsr	FindNextFreeObj
00899FAA 6600                       		bne.s	loc_1895C
00899FAC 137C 007A 0000             		move.b	#id_BossStarLight,0(a1)
00899FB2 3368 0008 0008             		move.w	obX(a0),obX(a1)
00899FB8 3368 000C 000C             		move.w	obY(a0),obY(a1)
00899FBE                            
00899FBE                            Obj7A_LoadBoss:				; XREF: Obj7A_Main
00899FBE 08A8 0000 0022             		bclr	#0,obStatus(a0)
00899FC4 4229 0025                  		clr.b	ob2ndRout(a1)
00899FC8 135A 0024                  		move.b	(a2)+,obRoutine(a1)
00899FCC 135A 001C                  		move.b	(a2)+,obAnim(a1)
00899FD0 135A 0018                  		move.b	(a2)+,obPriority(a1)
00899FD4 237C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a1)
00899FDC 337C 0400 0002             		move.w	#$400,obGfx(a1)
00899FE2 137C 0004 0001             		move.b	#4,obRender(a1)
00899FE8 137C 0020 0019             		move.b	#$20,obActWid(a1)
00899FEE 2348 0034                  		move.l	a0,$34(a1)
00899FF2 51C9 FFB0                  		dbf	d1,Obj7A_Loop	; repeat sequence 3 more times
00899FF6                            
00899FF6                            loc_1895C:
00899FF6 43F8 D040                  		lea	(v_objspace+$40).w,a1
00899FFA 45E8 002A                  		lea	$2A(a0),a2
00899FFE 705E                       		moveq	#$5E,d0
0089A000 723E                       		moveq	#$3E,d1
0089A002                            
0089A002                            loc_18968:
0089A002 B011                       		cmp.b	(a1),d0
0089A004 6600                       		bne.s	loc_18974
0089A006 4A29 0028                  		tst.b	obSubtype(a1)
0089A00A 6700                       		beq.s	loc_18974
0089A00C 34C9                       		move.w	a1,(a2)+
0089A00E                            
0089A00E                            loc_18974:
0089A00E D2FC 0040                  		adda.w	#$40,a1
0089A012 51C9 FFEE                  		dbf	d1,loc_18968
0089A016                            
0089A016                            Obj7A_ShipMain:	; Routine 2
0089A016 7000                       		moveq	#0,d0
0089A018 1028 0025                  		move.b	ob2ndRout(a0),d0
0089A01C 303B 0000                  		move.w	Obj7A_ShipIndex(pc,d0.w),d0
0089A020 4EBB 0000                  		jsr	Obj7A_ShipIndex(pc,d0.w)
0089A024 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
0089A02A 4EB9 0088 B4B0             		jsr	AnimateSprite
0089A030 7003                       		moveq	#3,d0
0089A032 C028 0022                  		and.b	obStatus(a0),d0
0089A036 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089A03C 8128 0001                  		or.b	d0,obRender(a0)
0089A040 4EF9 0088 E3CC             		jmp	DisplaySprite
0089A046                            ; ===========================================================================
0089A046 0000                       Obj7A_ShipIndex:dc.w loc_189B8-Obj7A_ShipIndex
0089A048 0000                       		dc.w loc_18A5E-Obj7A_ShipIndex
0089A04A 0000                       		dc.w Obj7A_MakeBall-Obj7A_ShipIndex
0089A04C 0000                       		dc.w loc_18B48-Obj7A_ShipIndex
0089A04E 0000                       		dc.w loc_18B80-Obj7A_ShipIndex
0089A050 0000                       		dc.w loc_18BC6-Obj7A_ShipIndex
0089A052                            ; ===========================================================================
0089A052                            
0089A052                            loc_189B8:				; XREF: Obj7A_ShipIndex
0089A052 317C FF00 0010             		move.w	#-$100,obVelX(a0)
0089A058 0C68 2120 0030             		cmpi.w	#$2120,$30(a0)
0089A05E 6400                       		bcc.s	loc_189CA
0089A060 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A064                            
0089A064                            loc_189CA:
0089A064 6100 EEC6                  		bsr.w	BossMove
0089A068 1028 003F                  		move.b	$3F(a0),d0
0089A06C 5428 003F                  		addq.b	#2,$3F(a0)
0089A070 4EB9 0088 301C             		jsr	(CalcSine).l
0089A076 EC40                       		asr.w	#6,d0
0089A078 D068 0038                  		add.w	$38(a0),d0
0089A07C 3140 000C                  		move.w	d0,obY(a0)
0089A080 3168 0030 0008             		move.w	$30(a0),obX(a0)
0089A086 6000                       		bra.s	loc_189FE
0089A088                            ; ===========================================================================
0089A088                            
0089A088                            loc_189EE:
0089A088 6100 EEA2                  		bsr.w	BossMove
0089A08C 3168 0038 000C             		move.w	$38(a0),obY(a0)
0089A092 3168 0030 0008             		move.w	$30(a0),obX(a0)
0089A098                            
0089A098                            loc_189FE:
0089A098 0C28 0006 0025             		cmpi.b	#6,ob2ndRout(a0)
0089A09E 6400                       		bcc.s	locret_18A44
0089A0A0 4A28 0022                  		tst.b	obStatus(a0)
0089A0A4 6B00                       		bmi.s	loc_18A46
0089A0A6 4A28 0020                  		tst.b	obColType(a0)
0089A0AA 6600                       		bne.s	locret_18A44
0089A0AC 4A28 003E                  		tst.b	$3E(a0)
0089A0B0 6600                       		bne.s	loc_18A28
0089A0B2 117C 0020 003E             		move.b	#$20,$3E(a0)
0089A0C2                            
0089A0C2                            loc_18A28:
0089A0C2 43F8 FB22                  		lea	(v_pal_dry+$22).w,a1
0089A0C6 7000                       		moveq	#0,d0
0089A0C8 4A51                       		tst.w	(a1)
0089A0CA 6600                       		bne.s	loc_18A36
0089A0CC 303C 0EEE                  		move.w	#cWhite,d0
0089A0D0                            
0089A0D0                            loc_18A36:
0089A0D0 3280                       		move.w	d0,(a1)
0089A0D2 5328 003E                  		subq.b	#1,$3E(a0)
0089A0D6 6600                       		bne.s	locret_18A44
0089A0D8 117C 000F 0020             		move.b	#$F,obColType(a0)
0089A0DE                            
0089A0DE                            locret_18A44:
0089A0DE 4E75                       		rts	
0089A0E0                            ; ===========================================================================
0089A0E0                            
0089A0E0                            loc_18A46:
0089A0E0 7064                       		moveq	#100,d0
0089A0E2 6100 0000                  		bsr.w	AddPoints
0089A0E6 117C 0006 0025             		move.b	#6,ob2ndRout(a0)
0089A0EC 117C 0078 003C             		move.b	#$78,$3C(a0)
0089A0F2 4268 0010                  		clr.w	obVelX(a0)
0089A0F6 4E75                       		rts	
0089A0F8                            ; ===========================================================================
0089A0F8                            
0089A0F8                            loc_18A5E:				; XREF: Obj7A_ShipIndex
0089A0F8 3028 0030                  		move.w	$30(a0),d0
0089A0FC 317C 0200 0010             		move.w	#$200,obVelX(a0)
0089A102 0828 0000 0022             		btst	#0,obStatus(a0)
0089A108 6600                       		bne.s	loc_18A7C
0089A10A 4468 0010                  		neg.w	obVelX(a0)
0089A10E 0C40 2008                  		cmpi.w	#$2008,d0
0089A112 6E00                       		bgt.s	loc_18A88
0089A114 6000                       		bra.s	loc_18A82
0089A116                            ; ===========================================================================
0089A116                            
0089A116                            loc_18A7C:
0089A116 0C40 2138                  		cmpi.w	#$2138,d0
0089A11A 6D00                       		blt.s	loc_18A88
0089A11C                            
0089A11C                            loc_18A82:
0089A11C 0868 0000 0022             		bchg	#0,obStatus(a0)
0089A122                            
0089A122                            loc_18A88:
0089A122 3028 0008                  		move.w	8(a0),d0
0089A126 72FF                       		moveq	#-1,d1
0089A128 7402                       		moveq	#2,d2
0089A12A 45E8 002A                  		lea	$2A(a0),a2
0089A12E 7828                       		moveq	#$28,d4
0089A130 4A68 0010                  		tst.w	obVelX(a0)
0089A134 6A00                       		bpl.s	loc_18A9E
0089A136 4444                       		neg.w	d4
0089A138                            
0089A138                            loc_18A9E:
0089A138 321A                       		move.w	(a2)+,d1
0089A13A 2641                       		movea.l	d1,a3
0089A13C 082B 0003 0022             		btst	#3,obStatus(a3)
0089A142 6600                       		bne.s	loc_18AB4
0089A144 362B 0008                  		move.w	8(a3),d3
0089A148 D644                       		add.w	d4,d3
0089A14A 9640                       		sub.w	d0,d3
0089A14C 6700                       		beq.s	loc_18AC0
0089A14E                            
0089A14E                            loc_18AB4:
0089A14E 51CA FFE8                  		dbf	d2,loc_18A9E
0089A152                            
0089A152 1142 0028                  		move.b	d2,obSubtype(a0)
0089A156 6000 FF0C                  		bra.w	loc_189CA
0089A15A                            ; ===========================================================================
0089A15A                            
0089A15A                            loc_18AC0:
0089A15A 1142 0028                  		move.b	d2,obSubtype(a0)
0089A15E 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A162 117C 0028 003C             		move.b	#$28,$3C(a0)
0089A168 6000 FEFA                  		bra.w	loc_189CA
0089A16C                            ; ===========================================================================
0089A16C                            
0089A16C                            Obj7A_MakeBall:				; XREF: Obj7A_ShipIndex
0089A16C 0C28 0028 003C             		cmpi.b	#$28,$3C(a0)
0089A172 6600                       		bne.s	loc_18B36
0089A174 70FF                       		moveq	#-1,d0
0089A176 1028 0028                  		move.b	obSubtype(a0),d0
0089A17A 4880                       		ext.w	d0
0089A17C 6B00                       		bmi.s	loc_18B40
0089A17E 5540                       		subq.w	#2,d0
0089A180 4440                       		neg.w	d0
0089A182 D040                       		add.w	d0,d0
0089A184 43E8 002A                  		lea	$2A(a0),a1
0089A188 3031 0000                  		move.w	(a1,d0.w),d0
0089A18C 2440                       		movea.l	d0,a2
0089A18E 43F8 D040                  		lea	(v_objspace+$40).w,a1
0089A192 723E                       		moveq	#$3E,d1
0089A194                            
0089A194                            loc_18AFA:
0089A194 B0A9 003C                  		cmp.l	$3C(a1),d0
0089A198 6700                       		beq.s	loc_18B40
0089A19A D2FC 0040                  		adda.w	#$40,a1
0089A19E 51C9 FFF4                  		dbf	d1,loc_18AFA
0089A1A2                            
0089A1A2 2F08                       		move.l	a0,-(sp)
0089A1A4 41D2                       		lea	(a2),a0
0089A1A6 4EB9 0088 E878             		jsr	FindNextFreeObj
0089A1AC 205F                       		movea.l	(sp)+,a0
0089A1AE 6600                       		bne.s	loc_18B40
0089A1B0 12BC 007B                  		move.b	#id_BossSpikeball,(a1) ; load spiked ball object
0089A1B4 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089A1BA 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089A1C0 0669 0020 000C             		addi.w	#$20,obY(a1)
0089A1C6 136A 0022 0022             		move.b	obStatus(a2),obStatus(a1)
0089A1CC 234A 003C                  		move.l	a2,$3C(a1)
0089A1D0                            
0089A1D0                            loc_18B36:
0089A1D0 5328 003C                  		subq.b	#1,$3C(a0)
0089A1D4 6700                       		beq.s	loc_18B40
0089A1D6 6000 FEC0                  		bra.w	loc_189FE
0089A1DA                            ; ===========================================================================
0089A1DA                            
0089A1DA                            loc_18B40:
0089A1DA 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0089A1DE 6000 FE84                  		bra.w	loc_189CA
0089A1E2                            ; ===========================================================================
0089A1E2                            
0089A1E2                            loc_18B48:				; XREF: Obj7A_ShipIndex
0089A1E2 5328 003C                  		subq.b	#1,$3C(a0)
0089A1E6 6B00                       		bmi.s	loc_18B52
0089A1E8 6000 ECFE                  		bra.w	BossDefeated
0089A1EC                            ; ===========================================================================
0089A1EC                            
0089A1EC                            loc_18B52:
0089A1EC 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A1F0 4268 0012                  		clr.w	obVelY(a0)
0089A1F4 08E8 0000 0022             		bset	#0,obStatus(a0)
0089A1FA 08A8 0007 0022             		bclr	#7,obStatus(a0)
0089A200 4268 0010                  		clr.w	obVelX(a0)
0089A204 117C 00E8 003C             		move.b	#-$18,$3C(a0)
0089A20A 4A38 F7A7                  		tst.b	(v_bossstatus).w
0089A20E 6600                       		bne.s	loc_18B7C
0089A210 11FC 0001 F7A7             		move.b	#1,(v_bossstatus).w
0089A216                            
0089A216                            loc_18B7C:
0089A216 6000 FE80                  		bra.w	loc_189FE
0089A21A                            ; ===========================================================================
0089A21A                            
0089A21A                            loc_18B80:				; XREF: Obj7A_ShipIndex
0089A21A 5228 003C                  		addq.b	#1,$3C(a0)
0089A21E 6700                       		beq.s	loc_18B90
0089A220 6A00                       		bpl.s	loc_18B96
0089A222 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0089A228 6000                       		bra.s	loc_18BC2
0089A22A                            ; ===========================================================================
0089A22A                            
0089A22A                            loc_18B90:
0089A22A 4268 0012                  		clr.w	obVelY(a0)
0089A22E 6000                       		bra.s	loc_18BC2
0089A230                            ; ===========================================================================
0089A230                            
0089A230                            loc_18B96:
0089A230 0C28 0020 003C             		cmpi.b	#$20,$3C(a0)
0089A236 6500                       		bcs.s	loc_18BAE
0089A238 6700                       		beq.s	loc_18BB4
0089A23A 0C28 002A 003C             		cmpi.b	#$2A,$3C(a0)
0089A240 6500                       		bcs.s	loc_18BC2
0089A242 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A246 6000                       		bra.s	loc_18BC2
0089A248                            ; ===========================================================================
0089A248                            
0089A248                            loc_18BAE:
0089A248 5168 0012                  		subq.w	#8,obVelY(a0)
0089A24C 6000                       		bra.s	loc_18BC2
0089A24E                            ; ===========================================================================
0089A24E                            
0089A24E                            loc_18BB4:
0089A24E 4268 0012                  		clr.w	obVelY(a0)
0089A25C                            
0089A25C                            loc_18BC2:
0089A25C 6000 FE2A                  		bra.w	loc_189EE
0089A260                            ; ===========================================================================
0089A260                            
0089A260                            loc_18BC6:				; XREF: Obj7A_ShipIndex
0089A260 317C 0400 0010             		move.w	#$400,obVelX(a0)
0089A266 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
0089A26C 0C78 2160 F72A             		cmpi.w	#$2160,(v_limitright2).w
0089A272 6400                       		bcc.s	loc_18BE0
0089A274 5478 F72A                  		addq.w	#2,(v_limitright2).w
0089A278 6000                       		bra.s	loc_18BE8
0089A27A                            ; ===========================================================================
0089A27A                            
0089A27A                            loc_18BE0:
0089A27A 4A28 0001                  		tst.b	obRender(a0)
0089A27E 6A00 FCCC                  		bpl.w	Obj7A_Delete
0089A282                            
0089A282                            loc_18BE8:
0089A282 6100 ECA8                  		bsr.w	BossMove
0089A286 6000 FDDC                  		bra.w	loc_189CA
0089A28A                            ; ===========================================================================
0089A28A                            
0089A28A                            Obj7A_FaceMain:	; Routine 4
0089A28A 7000                       		moveq	#0,d0
0089A28C 7201                       		moveq	#1,d1
0089A28E 2268 0034                  		movea.l	$34(a0),a1
0089A292 1029 0025                  		move.b	ob2ndRout(a1),d0
0089A296 0C00 0006                  		cmpi.b	#6,d0
0089A29A 6B00                       		bmi.s	loc_18C06
0089A29C 720A                       		moveq	#$A,d1
0089A29E 6000                       		bra.s	loc_18C1A
0089A2A0                            ; ===========================================================================
0089A2A0                            
0089A2A0                            loc_18C06:
0089A2A0 4A29 0020                  		tst.b	obColType(a1)
0089A2A4 6600                       		bne.s	loc_18C10
0089A2A6 7205                       		moveq	#5,d1
0089A2A8 6000                       		bra.s	loc_18C1A
0089A2AA                            ; ===========================================================================
0089A2AA                            
0089A2AA                            loc_18C10:
0089A2AA 0C38 0004 D024             		cmpi.b	#4,(v_player+obRoutine).w
0089A2B0 6500                       		bcs.s	loc_18C1A
0089A2B2 7204                       		moveq	#4,d1
0089A2B4                            
0089A2B4                            loc_18C1A:
0089A2B4 1141 001C                  		move.b	d1,obAnim(a0)
0089A2B8 0C00 000A                  		cmpi.b	#$A,d0
0089A2BC 6600                       		bne.s	loc_18C32
0089A2BE 117C 0006 001C             		move.b	#6,obAnim(a0)
0089A2C4 4A28 0001                  		tst.b	obRender(a0)
0089A2C8 6A00 FC82                  		bpl.w	Obj7A_Delete
0089A2CC                            
0089A2CC                            loc_18C32:
0089A2CC 6000                       		bra.s	loc_18C6C
0089A2CE                            ; ===========================================================================
0089A2CE                            
0089A2CE                            Obj7A_FlameMain:; Routine 6
0089A2CE 117C 0008 001C             		move.b	#8,obAnim(a0)
0089A2D4 2268 0034                  		movea.l	$34(a0),a1
0089A2D8 0C29 000A 0025             		cmpi.b	#$A,ob2ndRout(a1)
0089A2DE 6600                       		bne.s	loc_18C56
0089A2E0 4A28 0001                  		tst.b	obRender(a0)
0089A2E4 6A00 FC66                  		bpl.w	Obj7A_Delete
0089A2E8 117C 000B 001C             		move.b	#$B,obAnim(a0)
0089A2EE 6000                       		bra.s	loc_18C6C
0089A2F0                            ; ===========================================================================
0089A2F0                            
0089A2F0                            loc_18C56:
0089A2F0 0C29 0008 0025             		cmpi.b	#8,ob2ndRout(a1)
0089A2F6 6E00                       		bgt.s	loc_18C6C
0089A2F8 0C29 0004 0025             		cmpi.b	#4,ob2ndRout(a1)
0089A2FE 6D00                       		blt.s	loc_18C6C
0089A300 117C 0007 001C             		move.b	#7,obAnim(a0)
0089A306                            
0089A306                            loc_18C6C:
0089A306 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
0089A30C 4EB9 0088 B4B0             		jsr	AnimateSprite
0089A312                            
0089A312                            loc_18C78:
0089A312 2268 0034                  		movea.l	$34(a0),a1
0089A316 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089A31C 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089A322 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
0089A328 7003                       		moveq	#3,d0
0089A32A C028 0022                  		and.b	obStatus(a0),d0
0089A32E 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089A334 8128 0001                  		or.b	d0,obRender(a0)
0089A338 4EF9 0088 E3CC             		jmp	DisplaySprite
0089A33E                            ; ===========================================================================
0089A33E                            
0089A33E                            Obj7A_TubeMain:	; Routine 8
0089A33E 2268 0034                  		movea.l	$34(a0),a1
0089A342 0C29 000A 0025             		cmpi.b	#$A,ob2ndRout(a1)
0089A348 6600                       		bne.s	loc_18CB8
0089A34A 4A28 0001                  		tst.b	obRender(a0)
0089A34E 6A00 FBFC                  		bpl.w	Obj7A_Delete
0089A352                            
0089A352                            loc_18CB8:
0089A352 217C 0089 946A 0004        		move.l	#Map_BossItems,obMap(a0)
0089A35A 317C 246C 0002             		move.w	#$246C,obGfx(a0)
0089A360 117C 0003 001A             		move.b	#3,obFrame(a0)
0089A366 60AA                       		bra.s	loc_18C78
0089A366 60AA                       		bra.s	loc_18C78
0089A368                            		include	"_incObj\7B SLZ Boss Spikeball.asm"
0089A368                            ; ---------------------------------------------------------------------------
0089A368                            ; Object 7B - exploding	spikeys	that Eggman drops (SLZ)
0089A368                            ; ---------------------------------------------------------------------------
0089A368                            
0089A368                            BossSpikeball:				; XREF: Obj_Index
0089A368 7000                       		moveq	#0,d0
0089A36A 1028 0024                  		move.b	obRoutine(a0),d0
0089A36E 303B 0000                  		move.w	Obj7B_Index(pc,d0.w),d0
0089A372 4EBB 0000                  		jsr	Obj7B_Index(pc,d0.w)
0089A376 3028 0030                  		move.w	$30(a0),d0
0089A37A 0240 FF80                  		andi.w	#$FF80,d0
0089A37E 3238 F700                  		move.w	(v_screenposx).w,d1
0089A382 0441 0080                  		subi.w	#$80,d1
0089A386 0241 FF80                  		andi.w	#$FF80,d1
0089A38A 9041                       		sub.w	d1,d0
0089A38C 6B00 FBBE                  		bmi.w	Obj7A_Delete
0089A390 0C40 0280                  		cmpi.w	#$280,d0
0089A394 6200 FBB6                  		bhi.w	Obj7A_Delete
0089A398 4EF9 0088 E3CC             		jmp	DisplaySprite
0089A39E                            ; ===========================================================================
0089A39E 0000                       Obj7B_Index:	dc.w Obj7B_Main-Obj7B_Index
0089A3A0 0000                       		dc.w Obj7B_Fall-Obj7B_Index
0089A3A2 0000                       		dc.w loc_18DC6-Obj7B_Index
0089A3A4 0000                       		dc.w loc_18EAA-Obj7B_Index
0089A3A6 0000                       		dc.w Obj7B_Explode-Obj7B_Index
0089A3A8 0000                       		dc.w Obj7B_MoveFrag-Obj7B_Index
0089A3AA                            ; ===========================================================================
0089A3AA                            
0089A3AA                            Obj7B_Main:	; Routine 0
0089A3AA 217C 0089 283C 0004        		move.l	#Map_SSawBall,obMap(a0)
0089A3B2 317C 0518 0002             		move.w	#$518,obGfx(a0)
0089A3B8 117C 0001 001A             		move.b	#1,obFrame(a0)
0089A3BE 0028 0004 0001             		ori.b	#4,obRender(a0)
0089A3C4 117C 0004 0018             		move.b	#4,obPriority(a0)
0089A3CA 117C 008B 0020             		move.b	#$8B,obColType(a0)
0089A3D0 117C 000C 0019             		move.b	#$C,obActWid(a0)
0089A3D6 2268 003C                  		movea.l	$3C(a0),a1
0089A3DA 3169 0008 0030             		move.w	obX(a1),$30(a0)
0089A3E0 3169 000C 0034             		move.w	obY(a1),$34(a0)
0089A3E6 08E8 0000 0022             		bset	#0,obStatus(a0)
0089A3EC 3028 0008                  		move.w	obX(a0),d0
0089A3F0 B069 0008                  		cmp.w	obX(a1),d0
0089A3F4 6E00                       		bgt.s	loc_18D68
0089A3F6 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089A3FC 117C 0002 003A             		move.b	#2,$3A(a0)
0089A402                            
0089A402                            loc_18D68:
0089A402 5428 0024                  		addq.b	#2,obRoutine(a0)
0089A406                            
0089A406                            Obj7B_Fall:	; Routine 2
0089A406 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089A40C 2268 003C                  		movea.l	$3C(a0),a1
0089A410 45F9 0000 0000             		lea	(word_19018).l,a2
0089A416 7000                       		moveq	#0,d0
0089A418 1029 001A                  		move.b	obFrame(a1),d0
0089A41C 3228 0008                  		move.w	8(a0),d1
0089A420 9268 0030                  		sub.w	$30(a0),d1
0089A424 6400                       		bcc.s	loc_18D8E
0089A426 5440                       		addq.w	#2,d0
0089A428                            
0089A428                            loc_18D8E:
0089A428 D040                       		add.w	d0,d0
0089A42A 3228 0034                  		move.w	$34(a0),d1
0089A42E D272 0000                  		add.w	(a2,d0.w),d1
0089A432 B268 000C                  		cmp.w	obY(a0),d1
0089A436 6E00                       		bgt.s	locret_18DC4
0089A438 2268 003C                  		movea.l	$3C(a0),a1
0089A43C 7202                       		moveq	#2,d1
0089A43E 0828 0000 0022             		btst	#0,obStatus(a0)
0089A444 6700                       		beq.s	loc_18DAE
0089A446 7200                       		moveq	#0,d1
0089A448                            
0089A448                            loc_18DAE:
0089A448 317C 00F0 0028             		move.w	#$F0,obSubtype(a0)
0089A44E 117C 000A 001F             		move.b	#10,obDelayAni(a0)	; set frame duration to	10 frames
0089A454 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0)
0089A45A 6000 0000                  		bra.w	loc_18FA2
0089A45E                            ; ===========================================================================
0089A45E                            
0089A45E                            locret_18DC4:
0089A45E 4E75                       		rts	
0089A460                            ; ===========================================================================
0089A460                            
0089A460                            loc_18DC6:	; Routine 4
0089A460 2268 003C                  		movea.l	$3C(a0),a1
0089A464 7000                       		moveq	#0,d0
0089A466 1028 003A                  		move.b	$3A(a0),d0
0089A46A 9029 003A                  		sub.b	$3A(a1),d0
0089A46E 6700                       		beq.s	loc_18E2A
0089A470 6400                       		bcc.s	loc_18DDA
0089A472 4400                       		neg.b	d0
0089A474                            
0089A474                            loc_18DDA:
0089A474 323C F7E8                  		move.w	#-$818,d1
0089A478 343C FEEC                  		move.w	#-$114,d2
0089A47C 0C00 0001                  		cmpi.b	#1,d0
0089A480 6700                       		beq.s	loc_18E00
0089A482 323C F6A0                  		move.w	#-$960,d1
0089A486 343C FF0C                  		move.w	#-$F4,d2
0089A48A 0C69 09C0 0038             		cmpi.w	#$9C0,$38(a1)
0089A490 6D00                       		blt.s	loc_18E00
0089A492 323C F5E0                  		move.w	#-$A20,d1
0089A496 343C FF80                  		move.w	#-$80,d2
0089A49A                            
0089A49A                            loc_18E00:
0089A49A 3141 0012                  		move.w	d1,obVelY(a0)
0089A49E 3142 0010                  		move.w	d2,obVelX(a0)
0089A4A2 3028 0008                  		move.w	obX(a0),d0
0089A4A6 9068 0030                  		sub.w	$30(a0),d0
0089A4AA 6400                       		bcc.s	loc_18E16
0089A4AC 4468 0010                  		neg.w	obVelX(a0)
0089A4B0                            
0089A4B0                            loc_18E16:
0089A4B0 117C 0001 001A             		move.b	#1,obFrame(a0)
0089A4B6 317C 0020 0028             		move.w	#$20,obSubtype(a0)
0089A4BC 5428 0024                  		addq.b	#2,obRoutine(a0)
0089A4C0 6000 0000                  		bra.w	loc_18EAA
0089A4C4                            ; ===========================================================================
0089A4C4                            
0089A4C4                            loc_18E2A:				; XREF: loc_18DC6
0089A4C4 45F9 0000 0000             		lea	(word_19018).l,a2
0089A4CA 7000                       		moveq	#0,d0
0089A4CC 1029 001A                  		move.b	obFrame(a1),d0
0089A4D0 343C 0028                  		move.w	#$28,d2
0089A4D4 3228 0008                  		move.w	obX(a0),d1
0089A4D8 9268 0030                  		sub.w	$30(a0),d1
0089A4DC 6400                       		bcc.s	loc_18E48
0089A4DE 4442                       		neg.w	d2
0089A4E0 5440                       		addq.w	#2,d0
0089A4E2                            
0089A4E2                            loc_18E48:
0089A4E2 D040                       		add.w	d0,d0
0089A4E4 3228 0034                  		move.w	$34(a0),d1
0089A4E8 D272 0000                  		add.w	(a2,d0.w),d1
0089A4EC 3141 000C                  		move.w	d1,obY(a0)
0089A4F0 D468 0030                  		add.w	$30(a0),d2
0089A4F4 3142 0008                  		move.w	d2,obX(a0)
0089A4F8 4268 000E                  		clr.w	obY+2(a0)
0089A4FC 4268 000A                  		clr.w	obX+2(a0)
0089A500 5368 0028                  		subq.w	#1,obSubtype(a0)
0089A504 6600                       		bne.s	loc_18E7A
0089A506 317C 0020 0028             		move.w	#$20,obSubtype(a0)
0089A50C 117C 0008 0024             		move.b	#8,obRoutine(a0)
0089A512 4E75                       		rts	
0089A514                            ; ===========================================================================
0089A514                            
0089A514                            loc_18E7A:
0089A514 0C68 0078 0028             		cmpi.w	#$78,obSubtype(a0)
0089A51A 6600                       		bne.s	loc_18E88
0089A51C 117C 0005 001F             		move.b	#5,obDelayAni(a0)
0089A522                            
0089A522                            loc_18E88:
0089A522 0C68 003C 0028             		cmpi.w	#$3C,obSubtype(a0)
0089A528 6600                       		bne.s	loc_18E96
0089A52A 117C 0002 001F             		move.b	#2,obDelayAni(a0)
0089A530                            
0089A530                            loc_18E96:
0089A530 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0089A534 6E00                       		bgt.s	locret_18EA8
0089A536 0868 0000 001A             		bchg	#0,obFrame(a0)
0089A53C 1168 001F 001E             		move.b	obDelayAni(a0),obTimeFrame(a0)
0089A542                            
0089A542                            locret_18EA8:
0089A542 4E75                       		rts	
0089A544                            ; ===========================================================================
0089A544                            
0089A544                            loc_18EAA:	; Routine 6
0089A544 43F8 D040                  		lea	(v_objspace+$40).w,a1
0089A548 707A                       		moveq	#id_BossStarLight,d0
0089A54A 7240                       		moveq	#$40,d1
0089A54C 743E                       		moveq	#$3E,d2
0089A54E                            
0089A54E                            loc_18EB4:
0089A54E B011                       		cmp.b	(a1),d0
0089A550 6700                       		beq.s	loc_18EC0
0089A552 D2C1                       		adda.w	d1,a1
0089A554 51CA FFF8                  		dbf	d2,loc_18EB4
0089A558                            
0089A558 6000                       		bra.s	loc_18F38
0089A55A                            ; ===========================================================================
0089A55A                            
0089A55A                            loc_18EC0:
0089A55A 3029 0008                  		move.w	obX(a1),d0
0089A55E 3229 000C                  		move.w	obY(a1),d1
0089A562 3428 0008                  		move.w	obX(a0),d2
0089A566 3628 000C                  		move.w	obY(a0),d3
0089A56A 45FA 0000                  		lea	byte_19022(pc),a2
0089A56E 47FA 0000                  		lea	byte_19026(pc),a3
0089A572 181A                       		move.b	(a2)+,d4
0089A574 4884                       		ext.w	d4
0089A576 D044                       		add.w	d4,d0
0089A578 181B                       		move.b	(a3)+,d4
0089A57A 4884                       		ext.w	d4
0089A57C D444                       		add.w	d4,d2
0089A57E B440                       		cmp.w	d0,d2
0089A580 6500                       		bcs.s	loc_18F38
0089A582 181A                       		move.b	(a2)+,d4
0089A584 4884                       		ext.w	d4
0089A586 D044                       		add.w	d4,d0
0089A588 181B                       		move.b	(a3)+,d4
0089A58A 4884                       		ext.w	d4
0089A58C D444                       		add.w	d4,d2
0089A58E B042                       		cmp.w	d2,d0
0089A590 6500                       		bcs.s	loc_18F38
0089A592 181A                       		move.b	(a2)+,d4
0089A594 4884                       		ext.w	d4
0089A596 D244                       		add.w	d4,d1
0089A598 181B                       		move.b	(a3)+,d4
0089A59A 4884                       		ext.w	d4
0089A59C D644                       		add.w	d4,d3
0089A59E B641                       		cmp.w	d1,d3
0089A5A0 6500                       		bcs.s	loc_18F38
0089A5A2 181A                       		move.b	(a2)+,d4
0089A5A4 4884                       		ext.w	d4
0089A5A6 D244                       		add.w	d4,d1
0089A5A8 181B                       		move.b	(a3)+,d4
0089A5AA 4884                       		ext.w	d4
0089A5AC D644                       		add.w	d4,d3
0089A5AE B243                       		cmp.w	d3,d1
0089A5B0 6500                       		bcs.s	loc_18F38
0089A5B2 5428 0024                  		addq.b	#2,obRoutine(a0)
0089A5B6 4268 0028                  		clr.w	obSubtype(a0)
0089A5BA 4229 0020                  		clr.b	obColType(a1)
0089A5BE 5329 0021                  		subq.b	#1,obColProp(a1)
0089A5C2 6600                       		bne.s	loc_18F38
0089A5C4 08E9 0007 0022             		bset	#7,obStatus(a1)
0089A5CA 4268 0010                  		clr.w	obVelX(a0)
0089A5CE 4268 0012                  		clr.w	obVelY(a0)
0089A5D2                            
0089A5D2                            loc_18F38:
0089A5D2 4A68 0012                  		tst.w	obVelY(a0)
0089A5D6 6A00                       		bpl.s	loc_18F5C
0089A5D8 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089A5DE 3028 0034                  		move.w	$34(a0),d0
0089A5E2 0440 002F                  		subi.w	#$2F,d0
0089A5E6 B068 000C                  		cmp.w	obY(a0),d0
0089A5EA 6E00                       		bgt.s	loc_18F58
0089A5EC 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089A5F2                            
0089A5F2                            loc_18F58:
0089A5F2 6000 FF20                  		bra.w	loc_18E7A
0089A5F6                            ; ===========================================================================
0089A5F6                            
0089A5F6                            loc_18F5C:
0089A5F6 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089A5FC 2268 003C                  		movea.l	$3C(a0),a1
0089A600 45F9 0000 0000             		lea	(word_19018).l,a2
0089A606 7000                       		moveq	#0,d0
0089A608 1029 001A                  		move.b	obFrame(a1),d0
0089A60C 3228 0008                  		move.w	obX(a0),d1
0089A610 9268 0030                  		sub.w	$30(a0),d1
0089A614 6400                       		bcc.s	loc_18F7E
0089A616 5440                       		addq.w	#2,d0
0089A618                            
0089A618                            loc_18F7E:
0089A618 D040                       		add.w	d0,d0
0089A61A 3228 0034                  		move.w	$34(a0),d1
0089A61E D272 0000                  		add.w	(a2,d0.w),d1
0089A622 B268 000C                  		cmp.w	obY(a0),d1
0089A626 6ECA                       		bgt.s	loc_18F58
0089A628 2268 003C                  		movea.l	$3C(a0),a1
0089A62C 7202                       		moveq	#2,d1
0089A62E 4A68 0010                  		tst.w	obVelX(a0)
0089A632 6B00                       		bmi.s	loc_18F9C
0089A634 7200                       		moveq	#0,d1
0089A636                            
0089A636                            loc_18F9C:
0089A636 317C 0000 0028             		move.w	#0,obSubtype(a0)
0089A63C                            
0089A63C                            loc_18FA2:
0089A63C 1341 003A                  		move.b	d1,$3A(a1)
0089A640 1141 003A                  		move.b	d1,$3A(a0)
0089A644 B229 001A                  		cmp.b	obFrame(a1),d1
0089A648 6700                       		beq.s	loc_19008
0089A64A 08A9 0003 0022             		bclr	#3,obStatus(a1)
0089A650 6700                       		beq.s	loc_19008
0089A652 4229 0025                  		clr.b	ob2ndRout(a1)
0089A656 137C 0002 0024             		move.b	#2,obRoutine(a1)
0089A65C 45F8 D000                  		lea	(v_objspace).w,a2
0089A660 3568 0012 0012             		move.w	obVelY(a0),obVelY(a2)
0089A666 446A 0012                  		neg.w	obVelY(a2)
0089A66A 0C29 0001 001A             		cmpi.b	#1,obFrame(a1)
0089A670 6600                       		bne.s	loc_18FDC
0089A672 E0EA 0012                  		asr	obVelY(a2)
0089A676                            
0089A676                            loc_18FDC:
0089A676 08EA 0001 0022             		bset	#1,obStatus(a2)
0089A67C 08AA 0003 0022             		bclr	#3,obStatus(a2)
0089A682 422A 003C                  		clr.b	$3C(a2)
0089A686 2F08                       		move.l	a0,-(sp)
0089A688 41D2                       		lea	(a2),a0
0089A68A 4EB9 0089 4524             		jsr	Sonic_ChkRoll
0089A690 205F                       		movea.l	(sp)+,a0
0089A692 157C 0002 0024             		move.b	#2,obRoutine(a2)
0089A6A2                            
0089A6A2                            loc_19008:
0089A6A2 4268 0010                  		clr.w	obVelX(a0)
0089A6A6 4268 0012                  		clr.w	obVelY(a0)
0089A6AA 5428 0024                  		addq.b	#2,obRoutine(a0)
0089A6AE 6000 FE64                  		bra.w	loc_18E7A
0089A6B2                            ; ===========================================================================
0089A6B2 FFF8 FFE4 FFD1 FFE4 FFF8   word_19018:	dc.w -8, -$1C, -$2F, -$1C, -8
0089A6BC                            		even
0089A6BC E830 E830                  byte_19022:	dc.b $E8, $30, $E8, $30
0089A6C0                            		even
0089A6C0 08F0 08F0                  byte_19026:	dc.b 8,	$F0, 8,	$F0
0089A6C4                            		even
0089A6C4                            ; ===========================================================================
0089A6C4                            
0089A6C4                            Obj7B_Explode:	; Routine 8
0089A6C4 10BC 003F                  		move.b	#$3F,(a0)
0089A6C8 4228 0024                  		clr.b	obRoutine(a0)
0089A6CC 0C68 0020 0028             		cmpi.w	#$20,obSubtype(a0)
0089A6D2 6700                       		beq.s	Obj7B_MakeFrag
0089A6D4 4E75                       		rts	
0089A6D6                            ; ===========================================================================
0089A6D6                            
0089A6D6                            Obj7B_MakeFrag:
0089A6D6 3168 0034 000C             		move.w	$34(a0),obY(a0)
0089A6DC 7203                       		moveq	#3,d1
0089A6DE 45FA 0000                  		lea	Obj7B_FragSpeed(pc),a2
0089A6E2                            
0089A6E2                            Obj7B_Loop:
0089A6E2 4EB9 0088 E862             		jsr	FindFreeObj
0089A6E8 6600                       		bne.s	loc_1909A
0089A6EA 12BC 007B                  		move.b	#id_BossSpikeball,(a1) ; load shrapnel object
0089A6EE 137C 000A 0024             		move.b	#$A,obRoutine(a1)
0089A6F4 237C 0000 0000 0004        		move.l	#Map_BSBall,obMap(a1)
0089A6FC 137C 0003 0018             		move.b	#3,obPriority(a1)
0089A702 337C 0518 0002             		move.w	#$518,obGfx(a1)
0089A708 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089A70E 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089A714 335A 0010                  		move.w	(a2)+,obVelX(a1)
0089A718 335A 0012                  		move.w	(a2)+,obVelY(a1)
0089A71C 137C 0098 0020             		move.b	#$98,obColType(a1)
0089A722 0029 0004 0001             		ori.b	#4,obRender(a1)
0089A728 08E9 0007 0001             		bset	#7,obRender(a1)
0089A72E 137C 000C 0019             		move.b	#$C,obActWid(a1)
0089A734                            
0089A734                            loc_1909A:
0089A734 51C9 FFAC                  		dbf	d1,Obj7B_Loop	; repeat sequence 3 more times
0089A738                            
0089A738 4E75                       		rts	
0089A73A                            ; ===========================================================================
0089A73A FF00 FCC0                  Obj7B_FragSpeed:dc.w -$100, -$340	; horizontal, vertical
0089A73E FF60 FDC0                  		dc.w -$A0, -$240
0089A742 0100 FCC0                  		dc.w $100, -$340
0089A746 00A0 FDC0                  		dc.w $A0, -$240
0089A74A                            ; ===========================================================================
0089A74A                            
0089A74A                            Obj7B_MoveFrag:	; Routine $A
0089A74A 4EB9 0088 E3B2             		jsr	ObjectMove
0089A750 3168 0008 0030             		move.w	obX(a0),$30(a0)
0089A756 3168 000C 0034             		move.w	obY(a0),$34(a0)
0089A75C 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0089A762 7004                       		moveq	#4,d0
0089A764 C078 FE0E                  		and.w	(v_vbla_word).w,d0
0089A768 E448                       		lsr.w	#2,d0
0089A76A 1140 001A                  		move.b	d0,obFrame(a0)
0089A76E 4A28 0001                  		tst.b	1(a0)
0089A772 6A00 F7D8                  		bpl.w	Obj7A_Delete
0089A776 4E75                       		rts	
0089A776 4E75                       		rts	
0089A778                            		include	"_maps\SLZ Boss Spikeball.asm"
0089A778                            ; ---------------------------------------------------------------------------
0089A778                            ; Sprite mappings - exploding spikeys that the SLZ boss	drops
0089A778                            ; ---------------------------------------------------------------------------
0089A778 0000                       Map_BSBall:	dc.w @fireball1-Map_BSBall
0089A77A 0000                       		dc.w @fireball2-Map_BSBall
0089A77C 01                         @fireball1:	dc.b 1
0089A77D FC00 0027 FC               		dc.b $FC, 0, 0,	$27, $FC
0089A782 01                         @fireball2:	dc.b 1
0089A783 FC00 0028 FC               		dc.b $FC, 0, 0,	$28, $FC
0089A788                            		even
0089A788                            		even
0089A788                            		include	"_incObj\75 Boss - Spring Yard.asm"
0089A788                            ; ---------------------------------------------------------------------------
0089A788                            ; Object 75 - Eggman (SYZ)
0089A788                            ; ---------------------------------------------------------------------------
0089A788                            
0089A788                            BossSpringYard:				; XREF: Obj_Index
0089A788 7000                       		moveq	#0,d0
0089A78A 1028 0024                  		move.b	obRoutine(a0),d0
0089A78E 323B 0000                  		move.w	Obj75_Index(pc,d0.w),d1
0089A792 4EFB 1000                  		jmp	Obj75_Index(pc,d1.w)
0089A796                            ; ===========================================================================
0089A796 0000                       Obj75_Index:	dc.w Obj75_Main-Obj75_Index
0089A798 0000                       		dc.w Obj75_ShipMain-Obj75_Index
0089A79A 0000                       		dc.w Obj75_FaceMain-Obj75_Index
0089A79C 0000                       		dc.w Obj75_FlameMain-Obj75_Index
0089A79E 0000                       		dc.w Obj75_SpikeMain-Obj75_Index
0089A7A0                            
0089A7A0 0200 05                    Obj75_ObjData:	dc.b 2,	0, 5		; routine number, animation, priority
0089A7A3 0401 05                    		dc.b 4,	1, 5
0089A7A6 0607 05                    		dc.b 6,	7, 5
0089A7A9 0800 05                    		dc.b 8,	0, 5
0089A7AC                            ; ===========================================================================
0089A7AC                            
0089A7AC                            Obj75_Main:	; Routine 0
0089A7AC 317C 2DB0 0008             		move.w	#$2DB0,obX(a0)
0089A7B2 317C 04DA 000C             		move.w	#$4DA,obY(a0)
0089A7B8 3168 0008 0030             		move.w	obX(a0),$30(a0)
0089A7BE 3168 000C 0038             		move.w	obY(a0),$38(a0)
0089A7C4 117C 000F 0020             		move.b	#$F,obColType(a0)
0089A7CA 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
0089A7D0 45FA FFCE                  		lea	Obj75_ObjData(pc),a2
0089A7D4 2248                       		movea.l	a0,a1
0089A7D6 7203                       		moveq	#3,d1
0089A7D8 6000                       		bra.s	Obj75_LoadBoss
0089A7DA                            ; ===========================================================================
0089A7DA                            
0089A7DA                            Obj75_Loop:
0089A7DA 4EB9 0088 E878             		jsr	FindNextFreeObj
0089A7E0 6600                       		bne.s	Obj75_ShipMain
0089A7E2 12BC 0075                  		move.b	#id_BossSpringYard,(a1)
0089A7E6 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089A7EC 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089A7F2                            
0089A7F2                            Obj75_LoadBoss:				; XREF: Obj75_Main
0089A7F2 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089A7F8 4229 0025                  		clr.b	ob2ndRout(a1)
0089A7FC 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0089A800 135A 001C                  		move.b	(a2)+,obAnim(a1)
0089A804 135A 0018                  		move.b	(a2)+,obPriority(a1)
0089A808 237C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a1)
0089A810 337C 0400 0002             		move.w	#$400,obGfx(a1)
0089A816 137C 0004 0001             		move.b	#4,obRender(a1)
0089A81C 137C 0020 0019             		move.b	#$20,obActWid(a1)
0089A822 2348 0034                  		move.l	a0,$34(a1)
0089A826 51C9 FFB2                  		dbf	d1,Obj75_Loop	; repeat sequence 3 more times
0089A82A                            
0089A82A                            Obj75_ShipMain:	; Routine 2
0089A82A 7000                       		moveq	#0,d0
0089A82C 1028 0025                  		move.b	ob2ndRout(a0),d0
0089A830 323B 0000                  		move.w	Obj75_ShipIndex(pc,d0.w),d1
0089A834 4EBB 1000                  		jsr	Obj75_ShipIndex(pc,d1.w)
0089A838 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
0089A83E 4EB9 0088 B4B0             		jsr	AnimateSprite
0089A844 7003                       		moveq	#3,d0
0089A846 C028 0022                  		and.b	obStatus(a0),d0
0089A84A 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089A850 8128 0001                  		or.b	d0,obRender(a0)
0089A854 4EF9 0088 E3CC             		jmp	DisplaySprite
0089A85A                            ; ===========================================================================
0089A85A 0000 0000                  Obj75_ShipIndex:dc.w loc_191CC-Obj75_ShipIndex,	loc_19270-Obj75_ShipIndex
0089A85E 0000 0000                  		dc.w loc_192EC-Obj75_ShipIndex,	loc_19474-Obj75_ShipIndex
0089A862 0000 0000                  		dc.w loc_194AC-Obj75_ShipIndex,	loc_194F2-Obj75_ShipIndex
0089A866                            ; ===========================================================================
0089A866                            
0089A866                            loc_191CC:				; XREF: Obj75_ShipIndex
0089A866 317C FF00 0010             		move.w	#-$100,obVelX(a0)
0089A86C 0C68 2D38 0030             		cmpi.w	#$2D38,$30(a0)
0089A872 6400                       		bcc.s	loc_191DE
0089A874 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A878                            
0089A878                            loc_191DE:
0089A878 1028 003F                  		move.b	$3F(a0),d0
0089A87C 5428 003F                  		addq.b	#2,$3F(a0)
0089A880 4EB9 0088 301C             		jsr	(CalcSine).l
0089A886 E440                       		asr.w	#2,d0
0089A888 3140 0012                  		move.w	d0,obVelY(a0)
0089A88C                            
0089A88C                            loc_191F2:
0089A88C 6100 E69E                  		bsr.w	BossMove
0089A890 3168 0038 000C             		move.w	$38(a0),obY(a0)
0089A896 3168 0030 0008             		move.w	$30(a0),obX(a0)
0089A89C                            
0089A89C                            loc_19202:
0089A89C 3028 0008                  		move.w	8(a0),d0
0089A8A0 0440 2C00                  		subi.w	#$2C00,d0
0089A8A4 EA48                       		lsr.w	#5,d0
0089A8A6 1140 0034                  		move.b	d0,$34(a0)
0089A8AA 0C28 0006 0025             		cmpi.b	#6,ob2ndRout(a0)
0089A8B0 6400                       		bcc.s	locret_19256
0089A8B2 4A28 0022                  		tst.b	obStatus(a0)
0089A8B6 6B00                       		bmi.s	loc_19258
0089A8B8 4A28 0020                  		tst.b	obColType(a0)
0089A8BC 6600                       		bne.s	locret_19256
0089A8BE 4A28 003E                  		tst.b	$3E(a0)
0089A8C2 6600                       		bne.s	loc_1923A
0089A8C4 117C 0020 003E             		move.b	#$20,$3E(a0)
0089A8D4                            
0089A8D4                            loc_1923A:
0089A8D4 43F8 FB22                  		lea	(v_pal_dry+$22).w,a1
0089A8D8 7000                       		moveq	#0,d0
0089A8DA 4A51                       		tst.w	(a1)
0089A8DC 6600                       		bne.s	loc_19248
0089A8DE 303C 0EEE                  		move.w	#cWhite,d0
0089A8E2                            
0089A8E2                            loc_19248:
0089A8E2 3280                       		move.w	d0,(a1)
0089A8E4 5328 003E                  		subq.b	#1,$3E(a0)
0089A8E8 6600                       		bne.s	locret_19256
0089A8EA 117C 000F 0020             		move.b	#$F,obColType(a0)
0089A8F0                            
0089A8F0                            locret_19256:
0089A8F0 4E75                       		rts	
0089A8F2                            ; ===========================================================================
0089A8F2                            
0089A8F2                            loc_19258:				; XREF: loc_19202
0089A8F2 7064                       		moveq	#100,d0
0089A8F4 6100 0000                  		bsr.w	AddPoints
0089A8F8 117C 0006 0025             		move.b	#6,ob2ndRout(a0)
0089A8FE 317C 00B4 003C             		move.w	#$B4,$3C(a0)
0089A904 4268 0010                  		clr.w	obVelX(a0)
0089A908 4E75                       		rts	
0089A90A                            ; ===========================================================================
0089A90A                            
0089A90A                            loc_19270:				; XREF: Obj75_ShipIndex
0089A90A 3028 0030                  		move.w	$30(a0),d0
0089A90E 317C 0140 0010             		move.w	#$140,obVelX(a0)
0089A914 0828 0000 0022             		btst	#0,obStatus(a0)
0089A91A 6600                       		bne.s	loc_1928E
0089A91C 4468 0010                  		neg.w	obVelX(a0)
0089A920 0C40 2C08                  		cmpi.w	#$2C08,d0
0089A924 6E00                       		bgt.s	loc_1929E
0089A926 6000                       		bra.s	loc_19294
0089A928                            ; ===========================================================================
0089A928                            
0089A928                            loc_1928E:
0089A928 0C40 2D38                  		cmpi.w	#$2D38,d0
0089A92C 6D00                       		blt.s	loc_1929E
0089A92E                            
0089A92E                            loc_19294:
0089A92E 0868 0000 0022             		bchg	#0,obStatus(a0)
0089A934 4228 003D                  		clr.b	$3D(a0)
0089A938                            
0089A938                            loc_1929E:
0089A938 0440 2C10                  		subi.w	#$2C10,d0
0089A93C 0240 001F                  		andi.w	#$1F,d0
0089A940 0440 001F                  		subi.w	#$1F,d0
0089A944 6A00                       		bpl.s	loc_192AE
0089A946 4440                       		neg.w	d0
0089A948                            
0089A948                            loc_192AE:
0089A948 5340                       		subq.w	#1,d0
0089A94A 6E00                       		bgt.s	loc_192E8
0089A94C 4A28 003D                  		tst.b	$3D(a0)
0089A950 6600                       		bne.s	loc_192E8
0089A952 3238 D008                  		move.w	(v_player+obX).w,d1
0089A956 0441 2C00                  		subi.w	#$2C00,d1
0089A95A EA41                       		asr.w	#5,d1
0089A95C B228 0034                  		cmp.b	$34(a0),d1
0089A960 6600                       		bne.s	loc_192E8
0089A962 7000                       		moveq	#0,d0
0089A964 1028 0034                  		move.b	$34(a0),d0
0089A968 EB40                       		asl.w	#5,d0
0089A96A 0640 2C10                  		addi.w	#$2C10,d0
0089A96E 3140 0030                  		move.w	d0,$30(a0)
0089A972 6100 0000                  		bsr.w	Obj75_FindBlocks
0089A976 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089A97A 4268 0028                  		clr.w	obSubtype(a0)
0089A97E 4268 0010                  		clr.w	obVelX(a0)
0089A982                            
0089A982                            loc_192E8:
0089A982 6000 FEF4                  		bra.w	loc_191DE
0089A986                            ; ===========================================================================
0089A986                            
0089A986                            loc_192EC:				; XREF: Obj75_ShipIndex
0089A986 7000                       		moveq	#0,d0
0089A988 1028 0028                  		move.b	obSubtype(a0),d0
0089A98C 303B 0000                  		move.w	off_192FA(pc,d0.w),d0
0089A990 4EFB 0000                  		jmp	off_192FA(pc,d0.w)
0089A994                            ; ===========================================================================
0089A994 0000                       off_192FA:	dc.w loc_19302-off_192FA
0089A996 0000                       		dc.w loc_19348-off_192FA
0089A998 0000                       		dc.w loc_1938E-off_192FA
0089A99A 0000                       		dc.w loc_193D0-off_192FA
0089A99C                            ; ===========================================================================
0089A99C                            
0089A99C                            loc_19302:				; XREF: off_192FA
0089A99C 317C 0180 0012             		move.w	#$180,obVelY(a0)
0089A9A2 3028 0038                  		move.w	$38(a0),d0
0089A9A6 0C40 0556                  		cmpi.w	#$556,d0
0089A9AA 6500                       		bcs.s	loc_19344
0089A9AC 317C 0556 0038             		move.w	#$556,$38(a0)
0089A9B2 4268 003C                  		clr.w	$3C(a0)
0089A9B6 70FF                       		moveq	#-1,d0
0089A9B8 3028 0036                  		move.w	$36(a0),d0
0089A9BC 6700                       		beq.s	loc_1933C
0089A9BE 2240                       		movea.l	d0,a1
0089A9C0 137C 00FF 0029             		move.b	#-1,$29(a1)
0089A9C6 117C 00FF 0029             		move.b	#-1,$29(a0)
0089A9CC 2348 0034                  		move.l	a0,$34(a1)
0089A9D0 317C 0032 003C             		move.w	#$32,$3C(a0)
0089A9D6                            
0089A9D6                            loc_1933C:
0089A9D6 4268 0012                  		clr.w	obVelY(a0)
0089A9DA 5428 0028                  		addq.b	#2,obSubtype(a0)
0089A9DE                            
0089A9DE                            loc_19344:
0089A9DE 6000 FEAC                  		bra.w	loc_191F2
0089A9E2                            ; ===========================================================================
0089A9E2                            
0089A9E2                            loc_19348:				; XREF: off_192FA
0089A9E2 5368 003C                  		subq.w	#1,$3C(a0)
0089A9E6 6A00                       		bpl.s	loc_19366
0089A9E8 5428 0028                  		addq.b	#2,obSubtype(a0)
0089A9EC 317C F800 0012             		move.w	#-$800,obVelY(a0)
0089A9F2 4A68 0036                  		tst.w	$36(a0)
0089A9F6 6600                       		bne.s	loc_19362
0089A9F8 E0E8 0012                  		asr	obVelY(a0)
0089A9FC                            
0089A9FC                            loc_19362:
0089A9FC 7000                       		moveq	#0,d0
0089A9FE 6000                       		bra.s	loc_1937C
0089AA00                            ; ===========================================================================
0089AA00                            
0089AA00                            loc_19366:
0089AA00 7000                       		moveq	#0,d0
0089AA02 0C68 001E 003C             		cmpi.w	#$1E,$3C(a0)
0089AA08 6E00                       		bgt.s	loc_1937C
0089AA0A 7002                       		moveq	#2,d0
0089AA0C 0828 0001 003D             		btst	#1,$3D(a0)
0089AA12 6700                       		beq.s	loc_1937C
0089AA14 4440                       		neg.w	d0
0089AA16                            
0089AA16                            loc_1937C:
0089AA16 D068 0038                  		add.w	$38(a0),d0
0089AA1A 3140 000C                  		move.w	d0,obY(a0)
0089AA1E 3168 0030 0008             		move.w	$30(a0),obX(a0)
0089AA24 6000 FE76                  		bra.w	loc_19202
0089AA28                            ; ===========================================================================
0089AA28                            
0089AA28                            loc_1938E:				; XREF: off_192FA
0089AA28 303C 04DA                  		move.w	#$4DA,d0
0089AA2C 4A68 0036                  		tst.w	$36(a0)
0089AA30 6700                       		beq.s	loc_1939C
0089AA32 0440 0018                  		subi.w	#$18,d0
0089AA36                            
0089AA36                            loc_1939C:
0089AA36 B068 0038                  		cmp.w	$38(a0),d0
0089AA3A 6D00                       		blt.s	loc_193BE
0089AA3C 317C 0008 003C             		move.w	#8,$3C(a0)
0089AA42 4A68 0036                  		tst.w	$36(a0)
0089AA46 6700                       		beq.s	loc_193B4
0089AA48 317C 002D 003C             		move.w	#$2D,$3C(a0)
0089AA4E                            
0089AA4E                            loc_193B4:
0089AA4E 5428 0028                  		addq.b	#2,obSubtype(a0)
0089AA52 4268 0012                  		clr.w	obVelY(a0)
0089AA56 6000                       		bra.s	loc_193CC
0089AA58                            ; ===========================================================================
0089AA58                            
0089AA58                            loc_193BE:
0089AA58 0C68 FFC0 0012             		cmpi.w	#-$40,obVelY(a0)
0089AA5E 6C00                       		bge.s	loc_193CC
0089AA60 0668 000C 0012             		addi.w	#$C,obVelY(a0)
0089AA66                            
0089AA66                            loc_193CC:
0089AA66 6000 FE24                  		bra.w	loc_191F2
0089AA6A                            ; ===========================================================================
0089AA6A                            
0089AA6A                            loc_193D0:				; XREF: off_192FA
0089AA6A 5368 003C                  		subq.w	#1,$3C(a0)
0089AA6E 6E00                       		bgt.s	loc_19406
0089AA70 6B00                       		bmi.s	loc_193EE
0089AA72 70FF                       		moveq	#-1,d0
0089AA74 3028 0036                  		move.w	$36(a0),d0
0089AA78 6700                       		beq.s	loc_193E8
0089AA7A 2240                       		movea.l	d0,a1
0089AA7C 137C 000A 0029             		move.b	#$A,$29(a1)
0089AA82                            
0089AA82                            loc_193E8:
0089AA82 4268 0036                  		clr.w	$36(a0)
0089AA86 6000                       		bra.s	loc_19406
0089AA88                            ; ===========================================================================
0089AA88                            
0089AA88                            loc_193EE:
0089AA88 0C68 FFE2 003C             		cmpi.w	#-$1E,$3C(a0)
0089AA8E 6600                       		bne.s	loc_19406
0089AA90 4228 0029                  		clr.b	$29(a0)
0089AA94 5528 0025                  		subq.b	#2,ob2ndRout(a0)
0089AA98 117C 00FF 003D             		move.b	#-1,$3D(a0)
0089AA9E 6000                       		bra.s	loc_19446
0089AAA0                            ; ===========================================================================
0089AAA0                            
0089AAA0                            loc_19406:
0089AAA0 7001                       		moveq	#1,d0
0089AAA2 4A68 0036                  		tst.w	$36(a0)
0089AAA6 6700                       		beq.s	loc_19410
0089AAA8 7002                       		moveq	#2,d0
0089AAAA                            
0089AAAA                            loc_19410:
0089AAAA 0C68 04DA 0038             		cmpi.w	#$4DA,$38(a0)
0089AAB0 6700                       		beq.s	loc_19424
0089AAB2 6D00                       		blt.s	loc_1941C
0089AAB4 4440                       		neg.w	d0
0089AAB6                            
0089AAB6                            loc_1941C:
0089AAB6 4A68 0036                  		tst.w	$36(a0)
0089AABA D168 0038                  		add.w	d0,$38(a0)
0089AABE                            
0089AABE                            loc_19424:
0089AABE 7000                       		moveq	#0,d0
0089AAC0 4A68 0036                  		tst.w	$36(a0)
0089AAC4 6700                       		beq.s	loc_19438
0089AAC6 7002                       		moveq	#2,d0
0089AAC8 0828 0000 003D             		btst	#0,$3D(a0)
0089AACE 6700                       		beq.s	loc_19438
0089AAD0 4440                       		neg.w	d0
0089AAD2                            
0089AAD2                            loc_19438:
0089AAD2 D068 0038                  		add.w	$38(a0),d0
0089AAD6 3140 000C                  		move.w	d0,obY(a0)
0089AADA 3168 0030 0008             		move.w	$30(a0),8(a0)
0089AAE0                            
0089AAE0                            loc_19446:
0089AAE0 6000 FDBA                  		bra.w	loc_19202
0089AAE4                            
0089AAE4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089AAE4                            
0089AAE4                            
0089AAE4                            Obj75_FindBlocks:			; XREF: loc_192AE
0089AAE4 4268 0036                  		clr.w	$36(a0)
0089AAE8 43F8 D040                  		lea	(v_objspace+$40).w,a1
0089AAEC 703E                       		moveq	#$3E,d0
0089AAEE 7276                       		moveq	#$76,d1
0089AAF0 1428 0034                  		move.b	$34(a0),d2
0089AAF4                            
0089AAF4                            Obj75_FindLoop:
0089AAF4 B211                       		cmp.b	(a1),d1		; is object a SYZ boss block?
0089AAF6 6600                       		bne.s	loc_1946A	; if not, branch
0089AAF8 B429 0028                  		cmp.b	obSubtype(a1),d2
0089AAFC 6600                       		bne.s	loc_1946A
0089AAFE 3149 0036                  		move.w	a1,$36(a0)
0089AB02 6000                       		bra.s	locret_19472
0089AB04                            ; ===========================================================================
0089AB04                            
0089AB04                            loc_1946A:
0089AB04 43E9 0040                  		lea	$40(a1),a1	; next object RAM entry
0089AB08 51C8 FFEA                  		dbf	d0,Obj75_FindLoop
0089AB0C                            
0089AB0C                            locret_19472:
0089AB0C 4E75                       		rts	
0089AB0E                            ; End of function Obj75_FindBlocks
0089AB0E                            
0089AB0E                            ; ===========================================================================
0089AB0E                            
0089AB0E                            loc_19474:				; XREF: Obj75_ShipIndex
0089AB0E 5368 003C                  		subq.w	#1,$3C(a0)
0089AB12 6B00                       		bmi.s	loc_1947E
0089AB14 6000 E3D2                  		bra.w	BossDefeated
0089AB18                            ; ===========================================================================
0089AB18                            
0089AB18                            loc_1947E:
0089AB18 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089AB1C 4268 0012                  		clr.w	obVelY(a0)
0089AB20 08E8 0000 0022             		bset	#0,obStatus(a0)
0089AB26 08A8 0007 0022             		bclr	#7,obStatus(a0)
0089AB2C 4268 0010                  		clr.w	obVelX(a0)
0089AB30 317C FFFF 003C             		move.w	#-1,$3C(a0)
0089AB36 4A38 F7A7                  		tst.b	(v_bossstatus).w
0089AB3A 6600                       		bne.s	loc_194A8
0089AB3C 11FC 0001 F7A7             		move.b	#1,(v_bossstatus).w
0089AB42                            
0089AB42                            loc_194A8:
0089AB42 6000 FD58                  		bra.w	loc_19202
0089AB46                            ; ===========================================================================
0089AB46                            
0089AB46                            loc_194AC:				; XREF: Obj75_ShipIndex
0089AB46 5268 003C                  		addq.w	#1,$3C(a0)
0089AB4A 6700                       		beq.s	loc_194BC
0089AB4C 6A00                       		bpl.s	loc_194C2
0089AB4E 0668 0018 0012             		addi.w	#$18,obVelY(a0)
0089AB54 6000                       		bra.s	loc_194EE
0089AB56                            ; ===========================================================================
0089AB56                            
0089AB56                            loc_194BC:
0089AB56 4268 0012                  		clr.w	obVelY(a0)
0089AB5A 6000                       		bra.s	loc_194EE
0089AB5C                            ; ===========================================================================
0089AB5C                            
0089AB5C                            loc_194C2:
0089AB5C 0C68 0020 003C             		cmpi.w	#$20,$3C(a0)
0089AB62 6500                       		bcs.s	loc_194DA
0089AB64 6700                       		beq.s	loc_194E0
0089AB66 0C68 002A 003C             		cmpi.w	#$2A,$3C(a0)
0089AB6C 6500                       		bcs.s	loc_194EE
0089AB6E 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089AB72 6000                       		bra.s	loc_194EE
0089AB74                            ; ===========================================================================
0089AB74                            
0089AB74                            loc_194DA:
0089AB74 5168 0012                  		subq.w	#8,obVelY(a0)
0089AB78 6000                       		bra.s	loc_194EE
0089AB7A                            ; ===========================================================================
0089AB7A                            
0089AB7A                            loc_194E0:
0089AB7A 4268 0012                  		clr.w	obVelY(a0)
0089AB88                            
0089AB88                            loc_194EE:
0089AB88 6000 FD02                  		bra.w	loc_191F2
0089AB8C                            ; ===========================================================================
0089AB8C                            
0089AB8C                            loc_194F2:				; XREF: Obj75_ShipIndex
0089AB8C 317C 0400 0010             		move.w	#$400,obVelX(a0)
0089AB92 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
0089AB98 0C78 2D40 F72A             		cmpi.w	#$2D40,(v_limitright2).w
0089AB9E 6400                       		bcc.s	loc_1950C
0089ABA0 5478 F72A                  		addq.w	#2,(v_limitright2).w
0089ABA4 6000                       		bra.s	loc_19512
0089ABA6                            ; ===========================================================================
0089ABA6                            
0089ABA6                            loc_1950C:
0089ABA6 4A28 0001                  		tst.b	obRender(a0)
0089ABAA 6A00                       		bpl.s	Obj75_ShipDelete
0089ABAC                            
0089ABAC                            loc_19512:
0089ABAC 6100 E37E                  		bsr.w	BossMove
0089ABB0 6000 FCC6                  		bra.w	loc_191DE
0089ABB4                            ; ===========================================================================
0089ABB4                            
0089ABB4                            Obj75_ShipDelete:
0089ABB4 4EF9 0088 E408             		jmp	DeleteObject
0089ABBA                            ; ===========================================================================
0089ABBA                            
0089ABBA                            Obj75_FaceMain:	; Routine 4
0089ABBA 7201                       		moveq	#1,d1
0089ABBC 2268 0034                  		movea.l	$34(a0),a1
0089ABC0 7000                       		moveq	#0,d0
0089ABC2 1029 0025                  		move.b	ob2ndRout(a1),d0
0089ABC6 303B 0000                  		move.w	off_19546(pc,d0.w),d0
0089ABCA 4EBB 0000                  		jsr	off_19546(pc,d0.w)
0089ABCE 1141 001C                  		move.b	d1,obAnim(a0)
0089ABD2 1010                       		move.b	(a0),d0
0089ABD4 B011                       		cmp.b	(a1),d0
0089ABD6 6600                       		bne.s	Obj75_FaceDelete
0089ABD8 6000                       		bra.s	loc_195BE
0089ABDA                            ; ===========================================================================
0089ABDA                            
0089ABDA                            Obj75_FaceDelete:
0089ABDA 4EF9 0088 E408             		jmp	DeleteObject
0089ABE0                            ; ===========================================================================
0089ABE0 0000 0000                  off_19546:	dc.w loc_19574-off_19546, loc_19574-off_19546
0089ABE4 0000 0000                  		dc.w loc_1955A-off_19546, loc_19552-off_19546
0089ABE8 0000 0000                  		dc.w loc_19552-off_19546, loc_19556-off_19546
0089ABEC                            ; ===========================================================================
0089ABEC                            
0089ABEC                            loc_19552:				; XREF: off_19546
0089ABEC 720A                       		moveq	#$A,d1
0089ABEE 4E75                       		rts	
0089ABF0                            ; ===========================================================================
0089ABF0                            
0089ABF0                            loc_19556:				; XREF: off_19546
0089ABF0 7206                       		moveq	#6,d1
0089ABF2 4E75                       		rts	
0089ABF4                            ; ===========================================================================
0089ABF4                            
0089ABF4                            loc_1955A:				; XREF: off_19546
0089ABF4 7000                       		moveq	#0,d0
0089ABF6 1029 0028                  		move.b	obSubtype(a1),d0
0089ABFA 303B 0000                  		move.w	off_19568(pc,d0.w),d0
0089ABFE 4EFB 0000                  		jmp	off_19568(pc,d0.w)
0089AC02                            ; ===========================================================================
0089AC02 0000 0000                  off_19568:	dc.w loc_19570-off_19568, loc_19572-off_19568
0089AC06 0000 0000                  		dc.w loc_19570-off_19568, loc_19570-off_19568
0089AC0A                            ; ===========================================================================
0089AC0A                            
0089AC0A                            loc_19570:				; XREF: off_19568
0089AC0A 6000                       		bra.s	loc_19574
0089AC0C                            ; ===========================================================================
0089AC0C                            
0089AC0C                            loc_19572:				; XREF: off_19568
0089AC0C 7206                       		moveq	#6,d1
0089AC0E                            
0089AC0E                            loc_19574:				; XREF: off_19546
0089AC0E 4A29 0020                  		tst.b	obColType(a1)
0089AC12 6600                       		bne.s	loc_1957E
0089AC14 7205                       		moveq	#5,d1
0089AC16 4E75                       		rts	
0089AC18                            ; ===========================================================================
0089AC18                            
0089AC18                            loc_1957E:
0089AC18 0C38 0004 D024             		cmpi.b	#4,($FFFFD024).w
0089AC1E 6500                       		bcs.s	locret_19588
0089AC20 7204                       		moveq	#4,d1
0089AC22                            
0089AC22                            locret_19588:
0089AC22 4E75                       		rts	
0089AC24                            ; ===========================================================================
0089AC24                            
0089AC24                            Obj75_FlameMain:; Routine 6
0089AC24 117C 0007 001C             		move.b	#7,obAnim(a0)
0089AC2A 2268 0034                  		movea.l	$34(a0),a1
0089AC2E 0C29 000A 0025             		cmpi.b	#$A,ob2ndRout(a1)
0089AC34 6600                       		bne.s	loc_195AA
0089AC36 117C 000B 001C             		move.b	#$B,obAnim(a0)
0089AC3C 4A28 0001                  		tst.b	1(a0)
0089AC40 6A00                       		bpl.s	Obj75_FlameDelete
0089AC42 6000                       		bra.s	loc_195B6
0089AC44                            ; ===========================================================================
0089AC44                            
0089AC44                            loc_195AA:
0089AC44 4A69 0010                  		tst.w	obVelX(a1)
0089AC48 6700                       		beq.s	loc_195B6
0089AC4A 117C 0008 001C             		move.b	#8,obAnim(a0)
0089AC50                            
0089AC50                            loc_195B6:
0089AC50 6000                       		bra.s	loc_195BE
0089AC52                            ; ===========================================================================
0089AC52                            
0089AC52                            Obj75_FlameDelete:
0089AC52 4EF9 0088 E408             		jmp	DeleteObject
0089AC58                            ; ===========================================================================
0089AC58                            
0089AC58                            loc_195BE:
0089AC58 43F9 0089 9344             		lea	(Ani_Eggman).l,a1
0089AC5E 4EB9 0088 B4B0             		jsr	AnimateSprite
0089AC64 2268 0034                  		movea.l	$34(a0),a1
0089AC68 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089AC6E 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089AC74                            
0089AC74                            loc_195DA:
0089AC74 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
0089AC7A 7003                       		moveq	#3,d0
0089AC7C C028 0022                  		and.b	obStatus(a0),d0
0089AC80 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089AC86 8128 0001                  		or.b	d0,obRender(a0)
0089AC8A 4EF9 0088 E3CC             		jmp	DisplaySprite
0089AC90                            ; ===========================================================================
0089AC90                            
0089AC90                            Obj75_SpikeMain:; Routine 8
0089AC90 217C 0089 946A 0004        		move.l	#Map_BossItems,obMap(a0)
0089AC98 317C 246C 0002             		move.w	#$246C,obGfx(a0)
0089AC9E 117C 0005 001A             		move.b	#5,obFrame(a0)
0089ACA4 2268 0034                  		movea.l	$34(a0),a1
0089ACA8 0C29 000A 0025             		cmpi.b	#$A,ob2ndRout(a1)
0089ACAE 6600                       		bne.s	loc_1961C
0089ACB0 4A28 0001                  		tst.b	obRender(a0)
0089ACB4 6A00                       		bpl.s	Obj75_SpikeDelete
0089ACB6                            
0089ACB6                            loc_1961C:
0089ACB6 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089ACBC 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089ACC2 3028 003C                  		move.w	$3C(a0),d0
0089ACC6 0C29 0004 0025             		cmpi.b	#4,ob2ndRout(a1)
0089ACCC 6600                       		bne.s	loc_19652
0089ACCE 0C29 0006 0028             		cmpi.b	#6,obSubtype(a1)
0089ACD4 6700                       		beq.s	loc_1964C
0089ACD6 4A29 0028                  		tst.b	obSubtype(a1)
0089ACDA 6600                       		bne.s	loc_19658
0089ACDC 0C40 0094                  		cmpi.w	#$94,d0
0089ACE0 6C00                       		bge.s	loc_19658
0089ACE2 5E40                       		addq.w	#7,d0
0089ACE4 6000                       		bra.s	loc_19658
0089ACE6                            ; ===========================================================================
0089ACE6                            
0089ACE6                            loc_1964C:
0089ACE6 4A69 003C                  		tst.w	$3C(a1)
0089ACEA 6A00                       		bpl.s	loc_19658
0089ACEC                            
0089ACEC                            loc_19652:
0089ACEC 4A40                       		tst.w	d0
0089ACEE 6F00                       		ble.s	loc_19658
0089ACF0 5B40                       		subq.w	#5,d0
0089ACF2                            
0089ACF2                            loc_19658:
0089ACF2 3140 003C                  		move.w	d0,$3C(a0)
0089ACF6 E440                       		asr.w	#2,d0
0089ACF8 D168 000C                  		add.w	d0,obY(a0)
0089ACFC 117C 0008 0019             		move.b	#8,obActWid(a0)
0089AD02 117C 000C 0016             		move.b	#$C,obHeight(a0)
0089AD08 4228 0020                  		clr.b	obColType(a0)
0089AD0C 2268 0034                  		movea.l	$34(a0),a1
0089AD10 4A29 0020                  		tst.b	obColType(a1)
0089AD14 6700                       		beq.s	loc_19688
0089AD16 4A29 0029                  		tst.b	$29(a1)
0089AD1A 6600                       		bne.s	loc_19688
0089AD1C 117C 0084 0020             		move.b	#$84,obColType(a0)
0089AD22                            
0089AD22                            loc_19688:
0089AD22 6000 FF50                  		bra.w	loc_195DA
0089AD26                            ; ===========================================================================
0089AD26                            
0089AD26                            Obj75_SpikeDelete:
0089AD26 4EF9 0088 E408             		jmp	DeleteObject
0089AD26 4EF9 0088 E408             		jmp	DeleteObject
0089AD2C                            		include	"_incObj\76 SYZ Boss Blocks.asm"
0089AD2C                            ; ---------------------------------------------------------------------------
0089AD2C                            ; Object 76 - blocks that Eggman picks up (SYZ)
0089AD2C                            ; ---------------------------------------------------------------------------
0089AD2C                            
0089AD2C                            BossBlock:					; XREF: Obj_Index
0089AD2C 7000                       		moveq	#0,d0
0089AD2E 1028 0024                  		move.b	obRoutine(a0),d0
0089AD32 323B 0000                  		move.w	Obj76_Index(pc,d0.w),d1
0089AD36 4EFB 1000                  		jmp	Obj76_Index(pc,d1.w)
0089AD3A                            ; ===========================================================================
0089AD3A 0000                       Obj76_Index:	dc.w Obj76_Main-Obj76_Index
0089AD3C 0000                       		dc.w Obj76_Action-Obj76_Index
0089AD3E 0000                       		dc.w loc_19762-Obj76_Index
0089AD40                            ; ===========================================================================
0089AD40                            
0089AD40                            Obj76_Main:	; Routine 0
0089AD40 7800                       		moveq	#0,d4
0089AD42 3A3C 2C10                  		move.w	#$2C10,d5
0089AD46 7C09                       		moveq	#9,d6
0089AD48 43D0                       		lea	(a0),a1
0089AD4A 6000                       		bra.s	Obj76_MakeBlock
0089AD4C                            ; ===========================================================================
0089AD4C                            
0089AD4C                            Obj76_Loop:
0089AD4C 4EB9 0088 E862             		jsr	FindFreeObj
0089AD52 6600                       		bne.s	Obj76_ExitLoop
0089AD54                            
0089AD54                            Obj76_MakeBlock:			; XREF: Obj76_Main
0089AD54 12BC 0076                  		move.b	#id_BossBlock,(a1)
0089AD58 237C 0000 0000 0004        		move.l	#Map_BossBlock,obMap(a1)
0089AD60 337C 4000 0002             		move.w	#$4000,obGfx(a1)
0089AD66 137C 0004 0001             		move.b	#4,obRender(a1)
0089AD6C 137C 0010 0019             		move.b	#$10,obActWid(a1)
0089AD72 137C 0010 0016             		move.b	#$10,obHeight(a1)
0089AD78 137C 0003 0018             		move.b	#3,obPriority(a1)
0089AD7E 3345 0008                  		move.w	d5,obX(a1)	; set x-position
0089AD82 337C 0582 000C             		move.w	#$582,obY(a1)
0089AD88 3344 0028                  		move.w	d4,obSubtype(a1)
0089AD8C 0644 0101                  		addi.w	#$101,d4
0089AD90 0645 0020                  		addi.w	#$20,d5		; add $20 to next x-position
0089AD94 5429 0024                  		addq.b	#2,obRoutine(a1)
0089AD98 51CE FFB2                  		dbf	d6,Obj76_Loop	; repeat sequence 9 more times
0089AD9C                            
0089AD9C                            Obj76_ExitLoop:
0089AD9C 4E75                       		rts	
0089AD9E                            ; ===========================================================================
0089AD9E                            
0089AD9E                            Obj76_Action:	; Routine 2
0089AD9E 1028 0029                  		move.b	$29(a0),d0
0089ADA2 B028 0028                  		cmp.b	obSubtype(a0),d0
0089ADA6 6700                       		beq.s	Obj76_Solid
0089ADA8 4A00                       		tst.b	d0
0089ADAA 6B00                       		bmi.s	loc_19718
0089ADAC                            
0089ADAC                            loc_19712:
0089ADAC 6100 0000                  		bsr.w	Obj76_Break
0089ADB0 6000                       		bra.s	Obj76_Display
0089ADB2                            ; ===========================================================================
0089ADB2                            
0089ADB2                            loc_19718:
0089ADB2 2268 0034                  		movea.l	$34(a0),a1
0089ADB6 4A29 0021                  		tst.b	obColProp(a1)
0089ADBA 67F0                       		beq.s	loc_19712
0089ADBC 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089ADC2 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089ADC8 0668 002C 000C             		addi.w	#$2C,obY(a0)
0089ADCE B2C8                       		cmpa.w	a0,a1
0089ADD0 6500                       		bcs.s	Obj76_Display
0089ADD2 3029 0012                  		move.w	obVelY(a1),d0
0089ADD6 48C0                       		ext.l	d0
0089ADD8 E080                       		asr.l	#8,d0
0089ADDA D168 000C                  		add.w	d0,obY(a0)
0089ADDE 6000                       		bra.s	Obj76_Display
0089ADE0                            ; ===========================================================================
0089ADE0                            
0089ADE0                            Obj76_Solid:				; XREF: Obj76_Action
0089ADE0 323C 001B                  		move.w	#$1B,d1
0089ADE4 343C 0010                  		move.w	#$10,d2
0089ADE8 363C 0011                  		move.w	#$11,d3
0089ADEC 3828 0008                  		move.w	obX(a0),d4
0089ADF0 4EB9 0089 07B6             		jsr	SolidObject
0089ADF6                            
0089ADF6                            Obj76_Display:				; XREF: Obj76_Action
0089ADF6 4EF9 0088 E3CC             		jmp	DisplaySprite
0089ADFC                            ; ===========================================================================
0089ADFC                            
0089ADFC                            loc_19762:	; Routine 4
0089ADFC 4A28 0001                  		tst.b	obRender(a0)
0089AE00 6A00                       		bpl.s	Obj76_Delete
0089AE02 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089AE08 4EF9 0088 E3CC             		jmp	DisplaySprite
0089AE0E                            ; ===========================================================================
0089AE0E                            
0089AE0E                            Obj76_Delete:
0089AE0E 4EF9 0088 E408             		jmp	DeleteObject
0089AE14                            
0089AE14                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089AE14                            
0089AE14                            
0089AE14                            Obj76_Break:				; XREF: Obj76_Action
0089AE14 49FA 0000                  		lea	Obj76_FragSpeed(pc),a4
0089AE18 4BFA 0000                  		lea	Obj76_FragPos(pc),a5
0089AE1C 7801                       		moveq	#1,d4
0089AE1E 7203                       		moveq	#3,d1
0089AE20 7438                       		moveq	#$38,d2
0089AE22 5428 0024                  		addq.b	#2,obRoutine(a0)
0089AE26 117C 0008 0019             		move.b	#8,obActWid(a0)
0089AE2C 117C 0008 0016             		move.b	#8,obHeight(a0)
0089AE32 43D0                       		lea	(a0),a1
0089AE34 6000                       		bra.s	Obj76_MakeFrag
0089AE36                            ; ===========================================================================
0089AE36                            
0089AE36                            Obj76_LoopFrag:
0089AE36 4EB9 0088 E878             		jsr	FindNextFreeObj
0089AE3C 6600                       		bne.s	loc_197D4
0089AE3E                            
0089AE3E                            Obj76_MakeFrag:
0089AE3E 45D0                       		lea	(a0),a2
0089AE40 47D1                       		lea	(a1),a3
0089AE42 7603                       		moveq	#3,d3
0089AE44                            
0089AE44                            loc_197AA:
0089AE44 26DA                       		move.l	(a2)+,(a3)+
0089AE46 26DA                       		move.l	(a2)+,(a3)+
0089AE48 26DA                       		move.l	(a2)+,(a3)+
0089AE4A 26DA                       		move.l	(a2)+,(a3)+
0089AE4C 51CB FFF6                  		dbf	d3,loc_197AA
0089AE50                            
0089AE50 335C 0010                  		move.w	(a4)+,obVelX(a1)
0089AE54 335C 0012                  		move.w	(a4)+,obVelY(a1)
0089AE58 361D                       		move.w	(a5)+,d3
0089AE5A D769 0008                  		add.w	d3,obX(a1)
0089AE5E 361D                       		move.w	(a5)+,d3
0089AE60 D769 000C                  		add.w	d3,obY(a1)
0089AE64 1344 001A                  		move.b	d4,obFrame(a1)
0089AE68 5244                       		addq.w	#1,d4
0089AE6A 51C9 FFCA                  		dbf	d1,Obj76_LoopFrag ; repeat sequence 3 more times
0089AE6E                            
0089AE6E                            loc_197D4:
0089AE78                            ; End of function Obj76_Break
0089AE78                            
0089AE78                            ; ===========================================================================
0089AE78 FE80 FE00                  Obj76_FragSpeed:dc.w -$180, -$200
0089AE7C 0180 FE00                  		dc.w $180, -$200
0089AE80 FF00 FF00                  		dc.w -$100, -$100
0089AE84 0100 FF00                  		dc.w $100, -$100
0089AE88 FFF8 FFF8                  Obj76_FragPos:	dc.w -8, -8
0089AE8C 0010 0000                  		dc.w $10, 0
0089AE90 0000 0010                  		dc.w 0,	$10
0089AE94 0010 0010                  		dc.w $10, $10
0089AE94 0010 0010                  		dc.w $10, $10
0089AE98                            		include	"_maps\SYZ Boss Blocks.asm"
0089AE98                            ; ---------------------------------------------------------------------------
0089AE98                            ; Sprite mappings - blocks that	Robotnik picks up (SYZ)
0089AE98                            ; ---------------------------------------------------------------------------
0089AE98 0000 0000                  Map_BossBlock:	dc.w @wholeblock-Map_BossBlock, @topleft-Map_BossBlock
0089AE9C 0000 0000                  		dc.w @topright-Map_BossBlock, @bottomleft-Map_BossBlock
0089AEA0 0000                       		dc.w @bottomright-Map_BossBlock
0089AEA2 02                         @wholeblock:	dc.b 2
0089AEA3 F00D 0071 F0               		dc.b $F0, $D, 0, $71, $F0
0089AEA8 000D 0079 F0               		dc.b 0,	$D, 0, $79, $F0
0089AEAD 00                         		dc.b 0
0089AEAE 01                         @topleft:	dc.b 1
0089AEAF F805 0071 F8               		dc.b $F8, 5, 0,	$71, $F8
0089AEB4 01                         @topright:	dc.b 1
0089AEB5 F805 0075 F8               		dc.b $F8, 5, 0,	$75, $F8
0089AEBA 01                         @bottomleft:	dc.b 1
0089AEBB F805 0079 F8               		dc.b $F8, 5, 0,	$79, $F8
0089AEC0 01                         @bottomright:	dc.b 1
0089AEC1 F805 007D F8               		dc.b $F8, 5, 0,	$7D, $F8
0089AEC6                            		even
0089AEC6                            		even
0089AEC6                            
0089AEC6                            loc_1982C:				; XREF: loc_19C62; loc_19C80
0089AEC6 4EF9 0088 E408             		jmp	DeleteObject
0089AECC                            
0089AECC                            		include	"_incObj\82 Eggman - Scrap Brain 2.asm"
0089AECC                            ; ---------------------------------------------------------------------------
0089AECC                            ; Object 82 - Eggman (SBZ2)
0089AECC                            ; ---------------------------------------------------------------------------
0089AECC                            
0089AECC                            ScrapEggman:				; XREF: Obj_Index
0089AECC 7000                       		moveq	#0,d0
0089AECE 1028 0024                  		move.b	obRoutine(a0),d0
0089AED2 323B 0000                  		move.w	SEgg_Index(pc,d0.w),d1
0089AED6 4EFB 1000                  		jmp	SEgg_Index(pc,d1.w)
0089AEDA                            ; ===========================================================================
0089AEDA 0000                       SEgg_Index:	dc.w SEgg_Main-SEgg_Index
0089AEDC 0000                       		dc.w SEgg_Eggman-SEgg_Index
0089AEDE 0000                       		dc.w SEgg_Switch-SEgg_Index
0089AEE0                            
0089AEE0 0200 03                    SEgg_ObjData:	dc.b 2,	0, 3		; routine number, animation, priority
0089AEE3 0400 03                    		dc.b 4,	0, 3
0089AEE6                            ; ===========================================================================
0089AEE6                            
0089AEE6                            SEgg_Main:	; Routine 0
0089AEE6 45FA FFF8                  		lea	SEgg_ObjData(pc),a2
0089AEEA 317C 2160 0008             		move.w	#$2160,obX(a0)
0089AEF0 317C 05A4 000C             		move.w	#$5A4,obY(a0)
0089AEF6 117C 000F 0020             		move.b	#$F,obColType(a0)
0089AEFC 117C 0010 0021             		move.b	#$10,obColProp(a0)
0089AF02 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089AF08 4228 0025                  		clr.b	ob2ndRout(a0)
0089AF0C 115A 0024                  		move.b	(a2)+,obRoutine(a0)
0089AF10 115A 001C                  		move.b	(a2)+,obAnim(a0)
0089AF14 115A 0018                  		move.b	(a2)+,obPriority(a0)
0089AF18 217C 0000 0000 0004        		move.l	#Map_SEgg,obMap(a0)
0089AF20 317C 0400 0002             		move.w	#$400,obGfx(a0)
0089AF26 117C 0004 0001             		move.b	#4,obRender(a0)
0089AF2C 08E8 0007 0001             		bset	#7,obRender(a0)
0089AF32 117C 0020 0019             		move.b	#$20,obActWid(a0)
0089AF38 4EB9 0088 E878             		jsr	FindNextFreeObj
0089AF3E 6600                       		bne.s	SEgg_Eggman
0089AF40 2348 0034                  		move.l	a0,$34(a1)
0089AF44 12BC 0082                  		move.b	#id_ScrapEggman,(a1) ; load switch object
0089AF48 337C 2130 0008             		move.w	#$2130,obX(a1)
0089AF4E 337C 05BC 000C             		move.w	#$5BC,obY(a1)
0089AF54 4228 0025                  		clr.b	ob2ndRout(a0)
0089AF58 135A 0024                  		move.b	(a2)+,obRoutine(a1)
0089AF5C 135A 001C                  		move.b	(a2)+,obAnim(a1)
0089AF60 135A 0018                  		move.b	(a2)+,obPriority(a1)
0089AF64 237C 0088 CC3C 0004        		move.l	#Map_But,obMap(a1)
0089AF6C 337C 04A4 0002             		move.w	#$4A4,obGfx(a1)
0089AF72 137C 0004 0001             		move.b	#4,obRender(a1)
0089AF78 08E9 0007 0001             		bset	#7,obRender(a1)
0089AF7E 137C 0010 0019             		move.b	#$10,obActWid(a1)
0089AF84 137C 0000 001A             		move.b	#0,obFrame(a1)
0089AF8A                            
0089AF8A                            SEgg_Eggman:	; Routine 2
0089AF8A 7000                       		moveq	#0,d0
0089AF8C 1028 0025                  		move.b	ob2ndRout(a0),d0
0089AF90 323B 0000                  		move.w	SEgg_EggIndex(pc,d0.w),d1
0089AF94 4EBB 1000                  		jsr	SEgg_EggIndex(pc,d1.w)
0089AF98 43FA 0000                  		lea	Ani_SEgg(pc),a1
0089AF9C 4EB9 0088 B4B0             		jsr	AnimateSprite
0089AFA2 4EF9 0088 E3CC             		jmp	DisplaySprite
0089AFA8                            ; ===========================================================================
0089AFA8 0000                       SEgg_EggIndex:	dc.w SEgg_ChkSonic-SEgg_EggIndex
0089AFAA 0000                       		dc.w SEgg_PreLeap-SEgg_EggIndex
0089AFAC 0000                       		dc.w SEgg_Leap-SEgg_EggIndex
0089AFAE 0000                       		dc.w loc_19934-SEgg_EggIndex
0089AFB0                            ; ===========================================================================
0089AFB0                            
0089AFB0                            SEgg_ChkSonic:				; XREF: SEgg_EggIndex
0089AFB0 3028 0008                  		move.w	obX(a0),d0
0089AFB4 9078 D008                  		sub.w	(v_player+obX).w,d0
0089AFB8 0C40 0080                  		cmpi.w	#128,d0		; is Sonic within 128 pixels of	Eggman?
0089AFBC 6400                       		bcc.s	loc_19934	; if not, branch
0089AFBE 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089AFC2 317C 00B4 003C             		move.w	#180,$3C(a0)	; set delay to 3 seconds
0089AFC8 117C 0001 001C             		move.b	#1,obAnim(a0)
0089AFCE                            
0089AFCE                            loc_19934:				; XREF: SEgg_EggIndex
0089AFCE 4EF9 0088 E3B2             		jmp	ObjectMove
0089AFD4                            ; ===========================================================================
0089AFD4                            
0089AFD4                            SEgg_PreLeap:				; XREF: SEgg_EggIndex
0089AFD4 5368 003C                  		subq.w	#1,$3C(a0)	; subtract 1 from time delay
0089AFD8 6600                       		bne.s	loc_19954	; if time remains, branch
0089AFDA 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089AFDE 117C 0002 001C             		move.b	#2,obAnim(a0)
0089AFE4 5868 000C                  		addq.w	#4,obY(a0)
0089AFE8 317C 000F 003C             		move.w	#15,$3C(a0)
0089AFEE                            
0089AFEE                            loc_19954:
0089AFEE 60DE                       		bra.s	loc_19934
0089AFF0                            ; ===========================================================================
0089AFF0                            
0089AFF0                            SEgg_Leap:				; XREF: SEgg_EggIndex
0089AFF0 5368 003C                  		subq.w	#1,$3C(a0)
0089AFF4 6E00                       		bgt.s	loc_199D0
0089AFF6 6600                       		bne.s	loc_1996A
0089AFF8 317C FF04 0010             		move.w	#-$FC,obVelX(a0) ; make Eggman leap
0089AFFE 317C FC40 0012             		move.w	#-$3C0,obVelY(a0)
0089B004                            
0089B004                            loc_1996A:
0089B004 0C68 2132 0008             		cmpi.w	#$2132,obX(a0)
0089B00A 6E00                       		bgt.s	loc_19976
0089B00C 4268 0010                  		clr.w	obVelX(a0)
0089B010                            
0089B010                            loc_19976:
0089B010 0668 0024 0012             		addi.w	#$24,obVelY(a0)
0089B016 4A68 0012                  		tst.w	obVelY(a0)
0089B01A 6B00                       		bmi.s	SEgg_FindBlocks
0089B01C 0C68 0595 000C             		cmpi.w	#$595,obY(a0)
0089B022 6500                       		bcs.s	SEgg_FindBlocks
0089B024 317C 5357 0028             		move.w	#$5357,obSubtype(a0)
0089B02A 0C68 059B 000C             		cmpi.w	#$59B,obY(a0)
0089B030 6500                       		bcs.s	SEgg_FindBlocks
0089B032 317C 059B 000C             		move.w	#$59B,obY(a0)
0089B038 4268 0012                  		clr.w	obVelY(a0)
0089B03C                            
0089B03C                            SEgg_FindBlocks:
0089B03C 3028 0010                  		move.w	obVelX(a0),d0
0089B040 8068 0012                  		or.w	obVelY(a0),d0
0089B044 6600                       		bne.s	loc_199D0
0089B046 43F8 D000                  		lea	(v_objspace).w,a1 ; start at the first object RAM
0089B04A 703E                       		moveq	#$3E,d0
0089B04C 7240                       		moveq	#$40,d1
0089B04E                            
0089B04E                            SEgg_FindLoop:	
0089B04E D2C1                       		adda.w	d1,a1		; jump to next object RAM
0089B050 0C11 0083                  		cmpi.b	#id_FalseFloor,(a1) ; is object a block? (object $83)
0089B054 57C8 FFF8                  		dbeq	d0,SEgg_FindLoop ; if not, repeat (max	$3E times)
0089B058                            
0089B058 6600                       		bne.s	loc_199D0
0089B05A 337C 474F 0028             		move.w	#$474F,obSubtype(a1) ; set block to disintegrate
0089B060 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089B064 117C 0001 001C             		move.b	#1,obAnim(a0)
0089B06A                            
0089B06A                            loc_199D0:
0089B06A 6000 FF62                  		bra.w	loc_19934
0089B06E                            ; ===========================================================================
0089B06E                            
0089B06E                            SEgg_Switch:	; Routine 4
0089B06E 7000                       		moveq	#0,d0
0089B070 1028 0025                  		move.b	ob2ndRout(a0),d0
0089B074 303B 0000                  		move.w	SEgg_SwIndex(pc,d0.w),d0
0089B078 4EFB 0000                  		jmp	SEgg_SwIndex(pc,d0.w)
0089B07C                            ; ===========================================================================
0089B07C 0000                       SEgg_SwIndex:	dc.w loc_199E6-SEgg_SwIndex
0089B07E 0000                       		dc.w SEgg_SwDisplay-SEgg_SwIndex
0089B080                            ; ===========================================================================
0089B080                            
0089B080                            loc_199E6:				; XREF: SEgg_SwIndex
0089B080 2268 0034                  		movea.l	$34(a0),a1
0089B084 0C69 5357 0028             		cmpi.w	#$5357,obSubtype(a1)
0089B08A 6600                       		bne.s	SEgg_SwDisplay
0089B08C 117C 0001 001A             		move.b	#1,obFrame(a0)
0089B092 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089B096                            
0089B096                            SEgg_SwDisplay:			; XREF: SEgg_SwIndex
0089B096 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B096 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B09C                            		include	"_anim\Eggman - Scrap Brain 2 & Final.asm"
0089B09C                            ; ---------------------------------------------------------------------------
0089B09C                            ; Animation script - Eggman (SBZ2)
0089B09C                            ; ---------------------------------------------------------------------------
0089B09C 0000                       Ani_SEgg:	dc.w @stand-Ani_SEgg
0089B09E 0000                       		dc.w @laugh-Ani_SEgg
0089B0A0 0000                       		dc.w @jump1-Ani_SEgg
0089B0A2 0000                       		dc.w @intube-Ani_SEgg
0089B0A4 0000                       		dc.w @running-Ani_SEgg
0089B0A6 0000                       		dc.w @jump2-Ani_SEgg
0089B0A8 0000                       		dc.w @starjump-Ani_SEgg
0089B0AA 7E00 FF                    @stand:		dc.b $7E, 0, afEnd
0089B0AE 00                         		even
0089B0AE 0601 02FF                  @laugh:		dc.b 6,	1, 2, afEnd
0089B0B2 0E03 0404 0000 00FF        @jump1:		dc.b $E, 3, 4, 4, 0, 0,	0, afEnd
0089B0BA 0005 09FF                  @intube:	dc.b 0,	5, 9, afEnd
0089B0BE 0607 0408 04FF             @running:	dc.b 6,	7, 4, 8, 4, afEnd
0089B0C4 0F04 0303 FF               @jump2:		dc.b $F, 4, 3, 3, afEnd
0089B0CA 00                         		even
0089B0CA 7E06 FF                    @starjump:	dc.b $7E, 6, afEnd
0089B0CE 00                         		even
0089B0CE 00                         		even
0089B0CE                            		include	"_maps\Eggman - Scrap Brain 2.asm"
0089B0CE                            ; ---------------------------------------------------------------------------
0089B0CE                            ; Sprite mappings - Eggman (SBZ2)
0089B0CE                            ; ---------------------------------------------------------------------------
0089B0CE 0000 0000                  Map_SEgg:	dc.w @stand-Map_SEgg, @laugh1-Map_SEgg
0089B0D2 0000 0000                  		dc.w @laugh2-Map_SEgg, @jump1-Map_SEgg
0089B0D6 0000 0000                  		dc.w @jump2-Map_SEgg, @surprise-Map_SEgg
0089B0DA 0000 0000                  		dc.w @starjump-Map_SEgg, @running1-Map_SEgg
0089B0DE 0000 0000                  		dc.w @running2-Map_SEgg, @intube-Map_SEgg
0089B0E2 0000                       		dc.w @cockpit-Map_SEgg
0089B0E4 03                         @stand:		dc.b 3
0089B0E5 FC00 008F E8               		dc.b $FC, 0, 0,	$8F, $E8
0089B0EA E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B0EF 000F 006F F0               		dc.b 0,	$F, 0, $6F, $F0
0089B0F4 04                         @laugh1:	dc.b 4
0089B0F5 E80D 000E F0               		dc.b $E8, $D, 0, $E, $F0
0089B0FA E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B0FF 000F 006F F0               		dc.b 0,	$F, 0, $6F, $F0
0089B104 FC00 008F E8               		dc.b $FC, 0, 0,	$8F, $E8
0089B109 00                         		dc.b 0
0089B10A 04                         @laugh2:	dc.b 4
0089B10B E90D 000E F0               		dc.b $E9, $D, 0, $E, $F0
0089B110 E90E 0000 F0               		dc.b $E9, $E, 0, 0, $F0
0089B115 010F 007F F0               		dc.b 1,	$F, 0, $7F, $F0
0089B11A FD00 008F E8               		dc.b $FD, 0, 0,	$8F, $E8
0089B11F 00                         		dc.b 0
0089B120 04                         @jump1:		dc.b 4
0089B121 F40F 0820 F0               		dc.b $F4, $F, 8, $20, $F0
0089B126 F504 0830 10               		dc.b $F5, 4, 8,	$30, $10
0089B12B 0809 084E F0               		dc.b 8,	9, 8, $4E, $F0
0089B130 EC0E 0000 F0               		dc.b $EC, $E, 0, 0, $F0
0089B135 00                         		dc.b 0
0089B136 04                         @jump2:		dc.b 4
0089B137 F00F 0820 F0               		dc.b $F0, $F, 8, $20, $F0
0089B13C F104 0830 10               		dc.b $F1, 4, 8,	$30, $10
0089B141 0806 083E F8               		dc.b 8,	6, 8, $3E, $F8
0089B146 E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B14B 00                         		dc.b 0
0089B14C 04                         @surprise:	dc.b 4
0089B14D E80D 0016 EC               		dc.b $E8, $D, 0, $16, $EC
0089B152 E801 001E 0C               		dc.b $E8, 1, 0,	$1E, $C
0089B157 E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B15C 000F 006F F0               		dc.b 0,	$F, 0, $6F, $F0
0089B161 00                         		dc.b 0
0089B162 07                         @starjump:	dc.b 7
0089B163 E80D 0016 EC               		dc.b $E8, $D, 0, $16, $EC
0089B168 E801 001E 0C               		dc.b $E8, 1, 0,	$1E, $C
0089B16D 0409 0834 00               		dc.b 4,	9, 8, $34, 0
0089B172 0405 083A E8               		dc.b 4,	5, 8, $3A, $E8
0089B177 F00F 0820 F0               		dc.b $F0, $F, 8, $20, $F0
0089B17C F104 0854 10               		dc.b $F1, 4, 8,	$54, $10
0089B181 F104 0054 E0               		dc.b $F1, 4, 0,	$54, $E0
0089B186 05                         @running1:	dc.b 5
0089B187 F00F 0820 F0               		dc.b $F0, $F, 8, $20, $F0
0089B18C F104 0830 10               		dc.b $F1, 4, 8,	$30, $10
0089B191 0409 0834 00               		dc.b 4,	9, 8, $34, 0
0089B196 0405 083A E8               		dc.b 4,	5, 8, $3A, $E8
0089B19B E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B1A0 06                         @running2:	dc.b 6
0089B1A1 EE0F 0820 F0               		dc.b $EE, $F, 8, $20, $F0
0089B1A6 EF04 0830 10               		dc.b $EF, 4, 8,	$30, $10
0089B1AB 0905 0844 00               		dc.b 9,	5, 8, $44, 0
0089B1B0 0301 0848 F8               		dc.b 3,	1, 8, $48, $F8
0089B1B5 0B05 084A E8               		dc.b $B, 5, 8, $4A, $E8
0089B1BA E60E 0000 F0               		dc.b $E6, $E, 0, 0, $F0
0089B1BF 00                         		dc.b 0
0089B1C0 08                         @intube:	dc.b 8
0089B1C1 E80D 0016 EC               		dc.b $E8, $D, 0, $16, $EC ; Eggman inside tube in Final Zone
0089B1C6 E801 001E 0C               		dc.b $E8, 1, 0,	$1E, $C
0089B1CB E80E 0000 F0               		dc.b $E8, $E, 0, 0, $F0
0089B1D0 000F 006F F0               		dc.b 0,	$F, 0, $6F, $F0
0089B1D5 E00D 3EF0 F0               		dc.b $E0, $D, $3E, $F0,	$F0
0089B1DA F00D 3EF0 F0               		dc.b $F0, $D, $3E, $F0,	$F0
0089B1DF 000D 3EF0 F0               		dc.b 0,	$D, $3E, $F0, $F0
0089B1E4 100D 3EF0 F0               		dc.b $10, $D, $3E, $F0,	$F0
0089B1E9 03                         @cockpit:	dc.b 3
0089B1EA EC0D 0056 E4               		dc.b $EC, $D, 0, $56, $E4 ; empty cockpit of Eggmobile in Final Zone
0089B1EF F408 005E 04               		dc.b $F4, 8, 0,	$5E, 4
0089B1F4 EC0D 0061 FC               		dc.b $EC, $D, 0, $61, $FC
0089B1FA 00                         		even
0089B1FA 00                         		even
0089B1FA                            		include	"_incObj\83 SBZ Eggman's Crumbling Floor.asm"
0089B1FA                            ; ---------------------------------------------------------------------------
0089B1FA                            ; Object 83 - blocks that disintegrate Eggman	presses	a switch (SBZ2)
0089B1FA                            ; ---------------------------------------------------------------------------
0089B1FA                            
0089B1FA                            FalseFloor:				; XREF: Obj_Index
0089B1FA 7000                       		moveq	#0,d0
0089B1FC 1028 0024                  		move.b	obRoutine(a0),d0
0089B200 323B 0000                  		move.w	FFloor_Index(pc,d0.w),d1
0089B204 4EFB 1000                  		jmp	FFloor_Index(pc,d1.w)
0089B208                            ; ===========================================================================
0089B208 0000                       FFloor_Index:	dc.w FFloor_Main-FFloor_Index
0089B20A 0000                       		dc.w FFloor_ChkBreak-FFloor_Index
0089B20C 0000                       		dc.w loc_19C36-FFloor_Index
0089B20E 0000                       		dc.w loc_19C62-FFloor_Index
0089B210 0000                       		dc.w loc_19C72-FFloor_Index
0089B212 0000                       		dc.w loc_19C80-FFloor_Index
0089B214                            ; ===========================================================================
0089B214                            
0089B214                            FFloor_Main:	; Routine 0
0089B214 317C 2080 0008             		move.w	#$2080,obX(a0)
0089B21A 317C 05D0 000C             		move.w	#$5D0,obY(a0)
0089B220 117C 0080 0019             		move.b	#$80,obActWid(a0)
0089B226 117C 0010 0016             		move.b	#$10,obHeight(a0)
0089B22C 117C 0004 0001             		move.b	#4,obRender(a0)
0089B232 08E8 0007 0001             		bset	#7,obRender(a0)
0089B238 7800                       		moveq	#0,d4
0089B23A 3A3C 2010                  		move.w	#$2010,d5
0089B23E 7C07                       		moveq	#7,d6
0089B240 45E8 0030                  		lea	$30(a0),a2
0089B244                            
0089B244                            FFloor_MakeBlock:
0089B244 4EB9 0088 E862             		jsr	FindFreeObj
0089B24A 6600                       		bne.s	FFloor_ExitMake
0089B24C 34C9                       		move.w	a1,(a2)+
0089B24E 12BC 0083                  		move.b	#id_FalseFloor,(a1) ; load block object
0089B252 237C 0000 0000 0004        		move.l	#Map_FFloor,obMap(a1)
0089B25A 337C 4518 0002             		move.w	#$4518,obGfx(a1)
0089B260 137C 0004 0001             		move.b	#4,obRender(a1)
0089B266 137C 0010 0019             		move.b	#$10,obActWid(a1)
0089B26C 137C 0010 0016             		move.b	#$10,obHeight(a1)
0089B272 137C 0003 0018             		move.b	#3,obPriority(a1)
0089B278 3345 0008                  		move.w	d5,obX(a1)	; set X	position
0089B27C 337C 05D0 000C             		move.w	#$5D0,obY(a1)
0089B282 0645 0020                  		addi.w	#$20,d5		; add $20 for next X position
0089B286 137C 0008 0024             		move.b	#8,obRoutine(a1)
0089B28C 51CE FFB6                  		dbf	d6,FFloor_MakeBlock ; repeat sequence 7 more times
0089B290                            
0089B290                            FFloor_ExitMake:
0089B290 5428 0024                  		addq.b	#2,obRoutine(a0)
0089B294 4E75                       		rts	
0089B296                            ; ===========================================================================
0089B296                            
0089B296                            FFloor_ChkBreak:; Routine 2
0089B296 0C68 474F 0028             		cmpi.w	#$474F,obSubtype(a0) ; is object set to disintegrate?
0089B29C 6600                       		bne.s	FFloor_Solid	; if not, branch
0089B29E 4228 001A                  		clr.b	obFrame(a0)
0089B2A2 5428 0024                  		addq.b	#2,obRoutine(a0) ; next subroutine
0089B2A6                            
0089B2A6                            FFloor_Solid:
0089B2A6 7000                       		moveq	#0,d0
0089B2A8 1028 001A                  		move.b	obFrame(a0),d0
0089B2AC 4400                       		neg.b	d0
0089B2AE 4880                       		ext.w	d0
0089B2B0 5040                       		addq.w	#8,d0
0089B2B2 E940                       		asl.w	#4,d0
0089B2B4 383C 2100                  		move.w	#$2100,d4
0089B2B8 9840                       		sub.w	d0,d4
0089B2BA 1140 0019                  		move.b	d0,obActWid(a0)
0089B2BE 3144 0008                  		move.w	d4,obX(a0)
0089B2C2 720B                       		moveq	#$B,d1
0089B2C4 D240                       		add.w	d0,d1
0089B2C6 7410                       		moveq	#$10,d2
0089B2C8 7611                       		moveq	#$11,d3
0089B2CA 4EF9 0089 07B6             		jmp	SolidObject
0089B2D0                            ; ===========================================================================
0089B2D0                            
0089B2D0                            loc_19C36:	; Routine 4
0089B2D0 0428 000E 001E             		subi.b	#$E,obTimeFrame(a0)
0089B2D6 6400                       		bcc.s	FFloor_Solid2
0089B2D8 70FF                       		moveq	#-1,d0
0089B2DA 1028 001A                  		move.b	obFrame(a0),d0
0089B2DE 4880                       		ext.w	d0
0089B2E0 D040                       		add.w	d0,d0
0089B2E2 3030 0030                  		move.w	$30(a0,d0.w),d0
0089B2E6 2240                       		movea.l	d0,a1
0089B2E8 337C 474F 0028             		move.w	#$474F,obSubtype(a1)
0089B2EE 5228 001A                  		addq.b	#1,obFrame(a0)
0089B2F2 0C28 0008 001A             		cmpi.b	#8,obFrame(a0)
0089B2F8 6700                       		beq.s	loc_19C62
0089B2FA                            
0089B2FA                            FFloor_Solid2:
0089B2FA 60AA                       		bra.s	FFloor_Solid
0089B2FC                            ; ===========================================================================
0089B2FC                            
0089B2FC                            loc_19C62:	; Routine 6
0089B2FC 08A8 0003 0022             		bclr	#3,obStatus(a0)
0089B302 08B8 0003 D022             		bclr	#3,(v_player+obStatus).w
0089B308 6000 FBBC                  		bra.w	loc_1982C
0089B30C                            ; ===========================================================================
0089B30C                            
0089B30C                            loc_19C72:	; Routine 8
0089B30C 0C68 474F 0028             		cmpi.w	#$474F,obSubtype(a0) ; is object set to disintegrate?
0089B312 6700                       		beq.s	FFloor_Break	; if yes, branch
0089B314 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B31A                            ; ===========================================================================
0089B31A                            
0089B31A                            loc_19C80:	; Routine $A
0089B31A 4A28 0001                  		tst.b	obRender(a0)
0089B31E 6A00 FBA6                  		bpl.w	loc_1982C
0089B322 4EB9 0088 E392             		jsr	ObjectMoveAndFall
0089B328 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B32E                            ; ===========================================================================
0089B32E                            
0089B32E                            FFloor_Break:				; XREF: loc_19C72
0089B32E 49FA 0000                  		lea	FFloor_FragSpeed(pc),a4
0089B332 4BFA 0000                  		lea	FFloor_FragPos(pc),a5
0089B336 7801                       		moveq	#1,d4
0089B338 7203                       		moveq	#3,d1
0089B33A 7438                       		moveq	#$38,d2
0089B33C 5428 0024                  		addq.b	#2,obRoutine(a0)
0089B340 117C 0008 0019             		move.b	#8,obActWid(a0)
0089B346 117C 0008 0016             		move.b	#8,obHeight(a0)
0089B34C 43D0                       		lea	(a0),a1
0089B34E 6000                       		bra.s	FFloor_MakeFrag
0089B350                            ; ===========================================================================
0089B350                            
0089B350                            FFloor_LoopFrag:
0089B350 4EB9 0088 E878             		jsr	FindNextFreeObj
0089B356 6600                       		bne.s	FFloor_BreakSnd
0089B358                            
0089B358                            FFloor_MakeFrag:				; XREF: FFloor_Break
0089B358 45D0                       		lea	(a0),a2
0089B35A 47D1                       		lea	(a1),a3
0089B35C 7603                       		moveq	#3,d3
0089B35E                            
0089B35E                            loc_19CC4:
0089B35E 26DA                       		move.l	(a2)+,(a3)+
0089B360 26DA                       		move.l	(a2)+,(a3)+
0089B362 26DA                       		move.l	(a2)+,(a3)+
0089B364 26DA                       		move.l	(a2)+,(a3)+
0089B366 51CB FFF6                  		dbf	d3,loc_19CC4
0089B36A                            
0089B36A 335C 0012                  		move.w	(a4)+,obVelY(a1)
0089B36E 361D                       		move.w	(a5)+,d3
0089B370 D769 0008                  		add.w	d3,obX(a1)
0089B374 361D                       		move.w	(a5)+,d3
0089B376 D769 000C                  		add.w	d3,obY(a1)
0089B37A 1344 001A                  		move.b	d4,obFrame(a1)
0089B37E 5244                       		addq.w	#1,d4
0089B380 51C9 FFCE                  		dbf	d1,FFloor_LoopFrag ; repeat sequence 3 more times
0089B384                            
0089B384                            FFloor_BreakSnd:
0089B38E 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B394                            ; ===========================================================================
0089B394 0080 0000                  FFloor_FragSpeed:dc.w $80, 0
0089B398 0120 00C0                  		dc.w $120, $C0
0089B39C FFF8 FFF8                  FFloor_FragPos:	dc.w -8, -8
0089B3A0 0010 0000                  		dc.w $10, 0
0089B3A4 0000 0010                  		dc.w 0,	$10
0089B3A8 0010 0010                  		dc.w $10, $10
0089B3A8 0010 0010                  		dc.w $10, $10
0089B3AC                            		include	"_maps\SBZ Eggman's Crumbling Floor.asm"
0089B3AC                            ; ---------------------------------------------------------------------------
0089B3AC                            ; Sprite mappings - blocks that	disintegrate when Eggman presses a switch
0089B3AC                            ; ---------------------------------------------------------------------------
0089B3AC 0000 0000                  Map_FFloor:	dc.w @wholeblock-Map_FFloor, @topleft-Map_FFloor
0089B3B0 0000 0000                  		dc.w @topright-Map_FFloor, @bottomleft-Map_FFloor
0089B3B4 0000                       		dc.w @bottomright-Map_FFloor
0089B3B6 01                         @wholeblock:	dc.b 1
0089B3B7 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
0089B3BC 02                         @topleft:	dc.b 2
0089B3BD F801 0000 F8               		dc.b $F8, 1, 0,	0, $F8
0089B3C2 F801 0004 00               		dc.b $F8, 1, 0,	4, 0
0089B3C7 00                         		dc.b 0
0089B3C8 02                         @topright:	dc.b 2
0089B3C9 F801 0008 F8               		dc.b $F8, 1, 0,	8, $F8
0089B3CE F801 000C 00               		dc.b $F8, 1, 0,	$C, 0
0089B3D3 00                         		dc.b 0
0089B3D4 02                         @bottomleft:	dc.b 2
0089B3D5 F801 0002 F8               		dc.b $F8, 1, 0,	2, $F8
0089B3DA F801 0006 00               		dc.b $F8, 1, 0,	6, 0
0089B3DF 00                         		dc.b 0
0089B3E0 02                         @bottomright:	dc.b 2
0089B3E1 F801 000A F8               		dc.b $F8, 1, 0,	$A, $F8
0089B3E6 F801 000E 00               		dc.b $F8, 1, 0,	$E, 0
0089B3EC 00                         		even
0089B3EC 00                         		even
0089B3EC                            		include	"_incObj\85 Boss - Final.asm"
0089B3EC                            ; ---------------------------------------------------------------------------
0089B3EC                            ; Object 85 - Eggman (FZ)
0089B3EC                            ; ---------------------------------------------------------------------------
0089B3EC                            
0089B3EC                            Obj85_Delete:
0089B3EC 4EF9 0088 E408             		jmp	DeleteObject
0089B3F2                            ; ===========================================================================
0089B3F2                            
0089B3F2                            BossFinal:				; XREF: Obj_Index
0089B3F2 7000                       		moveq	#0,d0
0089B3F4 1028 0024                  		move.b	obRoutine(a0),d0
0089B3F8 303B 0000                  		move.w	Obj85_Index(pc,d0.w),d0
0089B3FC 4EFB 0000                  		jmp	Obj85_Index(pc,d0.w)
0089B400                            ; ===========================================================================
0089B400 0000                       Obj85_Index:	dc.w Obj85_Main-Obj85_Index
0089B402 0000                       		dc.w Obj85_Eggman-Obj85_Index
0089B404 0000                       		dc.w loc_1A38E-Obj85_Index
0089B406 0000                       		dc.w loc_1A346-Obj85_Index
0089B408 0000                       		dc.w loc_1A2C6-Obj85_Index
0089B40A 0000                       		dc.w loc_1A3AC-Obj85_Index
0089B40C 0000                       		dc.w loc_1A264-Obj85_Index
0089B40E                            
0089B40E 0100 0100 0470             Obj85_ObjData:	dc.w $100, $100, $470	; X pos, Y pos,	VRAM setting
0089B414 0089 B0CE                  		dc.l Map_SEgg		; mappings pointer
0089B418 25B0 0590 0300             		dc.w $25B0, $590, $300
0089B41E 0000 0000                  		dc.l Map_EggCyl
0089B422 26E0 0596 03A0             		dc.w $26E0, $596, $3A0
0089B428 0000 0000                  		dc.l Map_FZLegs
0089B42C 26E0 0596 0470             		dc.w $26E0, $596, $470
0089B432 0089 B0CE                  		dc.l Map_SEgg
0089B436 26E0 0596 0400             		dc.w $26E0, $596, $400
0089B43C 0089 9394                  		dc.l Map_Eggman
0089B440 26E0 0596 0400             		dc.w $26E0, $596, $400
0089B446 0089 9394                  		dc.l Map_Eggman
0089B44A                            
0089B44A 0200 0420 19               Obj85_ObjData2:	dc.b 2,	0, 4, $20, $19	; routine num, animation, sprite priority, width, height
0089B44F 0400 0112 08               		dc.b 4,	0, 1, $12, 8
0089B454 0600 0300 00               		dc.b 6,	0, 3, 0, 0
0089B459 0800 0300 00               		dc.b 8,	0, 3, 0, 0
0089B45E 0A00 0320 20               		dc.b $A, 0, 3, $20, $20
0089B463 0C00 0300 00               		dc.b $C, 0, 3, 0, 0
0089B468                            ; ===========================================================================
0089B468                            
0089B468                            Obj85_Main:	; Routine 0
0089B468 45FA FFA4                  		lea	Obj85_ObjData(pc),a2
0089B46C 47FA FFDC                  		lea	Obj85_ObjData2(pc),a3
0089B470 2248                       		movea.l	a0,a1
0089B472 7205                       		moveq	#5,d1
0089B474 6000                       		bra.s	Obj85_LoadBoss
0089B476                            ; ===========================================================================
0089B476                            
0089B476                            Obj85_Loop:
0089B476 4EB9 0088 E878             		jsr	FindNextFreeObj
0089B47C 6600                       		bne.s	loc_19E20
0089B47E                            
0089B47E                            Obj85_LoadBoss:				; XREF: Obj85_Main
0089B47E 12BC 0085                  		move.b	#id_BossFinal,(a1)
0089B482 335A 0008                  		move.w	(a2)+,obX(a1)
0089B486 335A 000C                  		move.w	(a2)+,obY(a1)
0089B48A 335A 0002                  		move.w	(a2)+,obGfx(a1)
0089B48E 235A 0004                  		move.l	(a2)+,obMap(a1)
0089B492 135B 0024                  		move.b	(a3)+,obRoutine(a1)
0089B496 135B 001C                  		move.b	(a3)+,obAnim(a1)
0089B49A 135B 0018                  		move.b	(a3)+,obPriority(a1)
0089B49E                            
0089B49E 135B 0019                  		move.b	(a3)+,obActWid(a1)
0089B4A2                            
0089B4A2 135B 0016                  		move.b	(a3)+,obHeight(a1)
0089B4A6 137C 0004 0001             		move.b	#4,obRender(a1)
0089B4AC 08E8 0007 0001             		bset	#7,obRender(a0)
0089B4B2 2348 0034                  		move.l	a0,$34(a1)
0089B4B6 51C9 FFBE                  		dbf	d1,Obj85_Loop
0089B4BA                            
0089B4BA                            loc_19E20:
0089B4BA 45E8 0036                  		lea	$36(a0),a2
0089B4BE 4EB9 0088 E862             		jsr	FindFreeObj
0089B4C4 6600                       		bne.s	loc_19E5A
0089B4C6 12BC 0086                  		move.b	#id_BossPlasma,(a1) ; load energy ball object
0089B4CA 3489                       		move.w	a1,(a2)
0089B4CC 2348 0034                  		move.l	a0,$34(a1)
0089B4D0 45E8 0038                  		lea	$38(a0),a2
0089B4D4 7400                       		moveq	#0,d2
0089B4D6 7203                       		moveq	#3,d1
0089B4D8                            
0089B4D8                            loc_19E3E:
0089B4D8 4EB9 0088 E878             		jsr	FindNextFreeObj
0089B4DE 6600                       		bne.s	loc_19E5A
0089B4E0 34C9                       		move.w	a1,(a2)+
0089B4E2 12BC 0084                  		move.b	#id_EggmanCylinder,(a1) ; load crushing	cylinder object
0089B4E6 2348 0034                  		move.l	a0,$34(a1)
0089B4EA 1342 0028                  		move.b	d2,obSubtype(a1)
0089B4EE 5442                       		addq.w	#2,d2
0089B4F0 51C9 FFE6                  		dbf	d1,loc_19E3E
0089B4F4                            
0089B4F4                            loc_19E5A:
0089B4F4 317C 0000 0034             		move.w	#0,$34(a0)
0089B4FA 117C 0008 0021             		move.b	#8,obColProp(a0) ; set number of hits to 8
0089B500 317C FFFF 0030             		move.w	#-1,$30(a0)
0089B506                            
0089B506                            Obj85_Eggman:	; Routine 2
0089B506 7000                       		moveq	#0,d0
0089B508 1028 0034                  		move.b	$34(a0),d0
0089B50C 303B 0000                  		move.w	off_19E80(pc,d0.w),d0
0089B510 4EBB 0000                  		jsr	off_19E80(pc,d0.w)
0089B514 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B51A                            ; ===========================================================================
0089B51A 0000 0000                  off_19E80:	dc.w loc_19E90-off_19E80, loc_19EA8-off_19E80
0089B51E 0000 0000                  		dc.w loc_19FE6-off_19E80, loc_1A02A-off_19E80
0089B522 0000 0000                  		dc.w loc_1A074-off_19E80, loc_1A112-off_19E80
0089B526 0000 0000                  		dc.w loc_1A192-off_19E80, loc_1A1D4-off_19E80
0089B52A                            ; ===========================================================================
0089B52A                            
0089B52A                            loc_19E90:				; XREF: off_19E80
0089B52A 4AB8 F680                  		tst.l	(v_plc_buffer).w
0089B52E 6600                       		bne.s	loc_19EA2
0089B530 0C78 2450 F700             		cmpi.w	#$2450,(v_screenposx).w
0089B536 6500                       		bcs.s	loc_19EA2
0089B538 5428 0034                  		addq.b	#2,$34(a0)
0089B53C                            
0089B53C                            loc_19EA2:
0089B53C 52B8 F636                  		addq.l	#1,(v_random).w
0089B540 4E75                       		rts	
0089B542                            ; ===========================================================================
0089B542                            
0089B542                            loc_19EA8:				; XREF: off_19E80
0089B542 4A68 0030                  		tst.w	$30(a0)
0089B546 6A00                       		bpl.s	loc_19F10
0089B548 4268 0030                  		clr.w	$30(a0)
0089B54C 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089B552 0240 000C                  		andi.w	#$C,d0
0089B556 3200                       		move.w	d0,d1
0089B558 5441                       		addq.w	#2,d1
0089B55A 4A80                       		tst.l	d0
0089B55C 6A00                       		bpl.s	loc_19EC6
0089B55E C141                       		exg	d1,d0
0089B560                            
0089B560                            loc_19EC6:
0089B560 43FA 0000                  		lea	word_19FD6(pc),a1
0089B564 3031 0000                  		move.w	(a1,d0.w),d0
0089B568 3231 1000                  		move.w	(a1,d1.w),d1
0089B56C 3140 0030                  		move.w	d0,$30(a0)
0089B570 74FF                       		moveq	#-1,d2
0089B572 3430 0038                  		move.w	$38(a0,d0.w),d2
0089B576 2242                       		movea.l	d2,a1
0089B578 137C 00FF 0029             		move.b	#-1,$29(a1)
0089B57E 337C FFFF 0030             		move.w	#-1,$30(a1)
0089B584 3430 1038                  		move.w	$38(a0,d1.w),d2
0089B588 2242                       		movea.l	d2,a1
0089B58A 137C 0001 0029             		move.b	#1,$29(a1)
0089B590 337C 0000 0030             		move.w	#0,$30(a1)
0089B596 317C 0001 0032             		move.w	#1,$32(a0)
0089B59C 4228 0035                  		clr.b	$35(a0)
0089B5AA                            
0089B5AA                            loc_19F10:
0089B5AA 4A68 0032                  		tst.w	$32(a0)
0089B5AE 6B00 0000                  		bmi.w	loc_19FA6
0089B5B2 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089B5B8 3038 D008                  		move.w	(v_player+obX).w,d0
0089B5BC 9068 0008                  		sub.w	obX(a0),d0
0089B5C0 6500                       		bcs.s	loc_19F2E
0089B5C2 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B5C8                            
0089B5C8                            loc_19F2E:
0089B5C8 323C 002B                  		move.w	#$2B,d1
0089B5CC 343C 0014                  		move.w	#$14,d2
0089B5D0 363C 0014                  		move.w	#$14,d3
0089B5D4 3828 0008                  		move.w	obX(a0),d4
0089B5D8 4EB9 0089 07B6             		jsr	SolidObject
0089B5DE 4A44                       		tst.w	d4
0089B5E0 6E00                       		bgt.s	loc_19F50
0089B5E2                            
0089B5E2                            loc_19F48:
0089B5E2 4A28 0035                  		tst.b	$35(a0)
0089B5E6 6600                       		bne.s	loc_19F88
0089B5E8 6000                       		bra.s	loc_19F96
0089B5EA                            ; ===========================================================================
0089B5EA                            
0089B5EA                            loc_19F50:
0089B5EA 5E78 F636                  		addq.w	#7,(v_random).w
0089B5EE 0C38 0002 D01C             		cmpi.b	#2,(v_player+obAnim).w
0089B5F4 66EC                       		bne.s	loc_19F48
0089B5F6 303C 0300                  		move.w	#$300,d0
0089B5FA 0828 0000 0022             		btst	#0,obStatus(a0)
0089B600 6600                       		bne.s	loc_19F6A
0089B602 4440                       		neg.w	d0
0089B604                            
0089B604                            loc_19F6A:
0089B604 31C0 D010                  		move.w	d0,(v_player+obVelX).w
0089B608 4A28 0035                  		tst.b	$35(a0)
0089B60C 6600                       		bne.s	loc_19F88
0089B60E                            		
0089B60E                            	;Mercury FZ Boss Hitcount Fix
0089B60E 4A28 0021                  		tst.b	obColProp(a0)	;has the boss been defeated?
0089B612 6700                       		beq.s	loc_19F9C	;if so, don't let it be hit again.
0089B614                            	;end FZ Boss Hitcount Fix
0089B614                            	
0089B614 5328 0021                  		subq.b	#1,obColProp(a0)
0089B618                            	
0089B618 117C 0020 0035             		move.b	#FZBossInvulnModTime,$35(a0)
0089B61E                            	
0089B628                            
0089B628                            loc_19F88:
0089B628 5328 0035                  		subq.b	#1,$35(a0)
0089B62C 6700                       		beq.s	loc_19F96
0089B62E 117C 0003 001C             		move.b	#3,obAnim(a0)
0089B634 6000                       		bra.s	loc_19F9C
0089B636                            ; ===========================================================================
0089B636                            
0089B636                            loc_19F96:
0089B636 117C 0001 001C             		move.b	#1,obAnim(a0)
0089B63C                            
0089B63C                            loc_19F9C:
0089B63C 43FA FA5E                  		lea	Ani_SEgg(pc),a1
0089B640 4EF9 0088 B4B0             		jmp	AnimateSprite
0089B646                            ; ===========================================================================
0089B646                            
0089B646                            loc_19FA6:
0089B646 4A28 0021                  		tst.b	obColProp(a0)
0089B64A 6700                       		beq.s	loc_19FBC
0089B64C 5428 0034                  		addq.b	#2,$34(a0)
0089B650 317C FFFF 0030             		move.w	#-1,$30(a0)
0089B656 4268 0032                  		clr.w	$32(a0)
0089B65A 4E75                       		rts	
0089B65C                            ; ===========================================================================
0089B65C                            
0089B65C                            loc_19FBC:
0089B65C 7064                       		moveq	#100,d0
0089B65E 6100 0000                  		bsr	AddPoints
0089B662                            
0089B662 117C 0006 0034             		move.b	#6,$34(a0)
0089B668 317C 25C0 0008             		move.w	#$25C0,obX(a0)
0089B66E 317C 053C 000C             		move.w	#$53C,obY(a0)
0089B674 117C 0014 0016             		move.b	#$14,obHeight(a0)
0089B67A 4E75                       		rts	
0089B67C                            ; ===========================================================================
0089B67C 0000 0002 0002 0004 0004+  word_19FD6:	dc.w 0,	2, 2, 4, 4, 6, 6, 0
0089B68C                            ; ===========================================================================
0089B68C                            
0089B68C                            loc_19FE6:				; XREF: off_19E80
0089B68C 70FF                       		moveq	#-1,d0
0089B68E 3028 0036                  		move.w	$36(a0),d0
0089B692 2240                       		movea.l	d0,a1
0089B694 4A68 0030                  		tst.w	$30(a0)
0089B698 6A00                       		bpl.s	loc_1A000
0089B69A 4268 0030                  		clr.w	$30(a0)
0089B69E 137C 00FF 0029             		move.b	#-1,$29(a1)
0089B6A4 6100                       		bsr.s	loc_1A020
0089B6A6                            
0089B6A6                            loc_1A000:
0089B6A6 700F                       		moveq	#$F,d0
0089B6A8 C078 FE0E                  		and.w	(v_vbla_word).w,d0
0089B6AC 6600                       		bne.s	loc_1A00A
0089B6AE 6100                       		bsr.s	loc_1A020
0089B6B0                            
0089B6B0                            loc_1A00A:
0089B6B0 4A68 0032                  		tst.w	$32(a0)
0089B6B4 6700                       		beq.s	locret_1A01E
0089B6B6 5528 0034                  		subq.b	#2,$34(a0)
0089B6BA 317C FFFF 0030             		move.w	#-1,$30(a0)
0089B6C0 4268 0032                  		clr.w	$32(a0)
0089B6C4                            
0089B6C4                            locret_1A01E:
0089B6C4 4E75                       		rts	
0089B6C6                            ; ===========================================================================
0089B6C6                            
0089B6C6                            loc_1A020:
0089B6D0                            ; ===========================================================================
0089B6D0                            
0089B6D0                            loc_1A02A:				; XREF: off_19E80
0089B6D0                            
0089B6D0 117C 0030 0019             		move.b	#$30,obActWid(a0)
0089B6D6                            
0089B6D6 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B6DC 4EB9 0088 E3B2             		jsr	ObjectMove
0089B6E2 117C 0006 001A             		move.b	#6,obFrame(a0)
0089B6E8 0668 0010 0012             		addi.w	#$10,obVelY(a0)
0089B6EE 0C68 059C 000C             		cmpi.w	#$59C,obY(a0)
0089B6F4 6500                       		bcs.s	loc_1A070
0089B6F6 317C 059C 000C             		move.w	#$59C,obY(a0)
0089B6FC 5428 0034                  		addq.b	#2,$34(a0)
0089B700                            
0089B700 117C 0020 0019             		move.b	#$20,obActWid(a0)
0089B706                            
0089B706 317C 0100 0010             		move.w	#$100,obVelX(a0)
0089B70C 317C FF00 0012             		move.w	#-$100,obVelY(a0)
0089B712 5438 F742                  		addq.b	#2,(v_dle_routine).w
0089B716                            
0089B716                            loc_1A070:
0089B716 6000 0000                  		bra.w	loc_1A166
0089B71A                            ; ===========================================================================
0089B71A                            
0089B71A                            loc_1A074:				; XREF: off_19E80
0089B71A 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B720 117C 0004 001C             		move.b	#4,obAnim(a0)
0089B726 4EB9 0088 E3B2             		jsr	ObjectMove
0089B72C 0668 0010 0012             		addi.w	#$10,obVelY(a0)
0089B732 0C68 05A3 000C             		cmpi.w	#$5A3,obY(a0)
0089B738 6500                       		bcs.s	loc_1A09A
0089B73A 317C FFC0 0012             		move.w	#-$40,obVelY(a0)
0089B740                            
0089B740                            loc_1A09A:
0089B740 317C 0400 0010             		move.w	#$400,obVelX(a0)
0089B746 3028 0008                  		move.w	obX(a0),d0
0089B74A 9078 D008                  		sub.w	(v_player+obX).w,d0
0089B74E 6A00                       		bpl.s	loc_1A0B4
0089B750 317C 0500 0010             		move.w	#$500,obVelX(a0)
0089B756 6000 0000                  		bra.w	loc_1A0F2
0089B75A                            ; ===========================================================================
0089B75A                            
0089B75A                            loc_1A0B4:
0089B75A 0440 0070                  		subi.w	#$70,d0
0089B75E 6500                       		bcs.s	loc_1A0F2
0089B760 0468 0100 0010             		subi.w	#$100,obVelX(a0)
0089B766 5140                       		subq.w	#8,d0
0089B768 6500                       		bcs.s	loc_1A0F2
0089B76A 0468 0100 0010             		subi.w	#$100,obVelX(a0)
0089B770 5140                       		subq.w	#8,d0
0089B772 6500                       		bcs.s	loc_1A0F2
0089B774 0468 0080 0010             		subi.w	#$80,obVelX(a0)
0089B77A 5140                       		subq.w	#8,d0
0089B77C 6500                       		bcs.s	loc_1A0F2
0089B77E 0468 0080 0010             		subi.w	#$80,obVelX(a0)
0089B784 5140                       		subq.w	#8,d0
0089B786 6500                       		bcs.s	loc_1A0F2
0089B788 0468 0080 0010             		subi.w	#$80,obVelX(a0)
0089B78E 0440 0038                  		subi.w	#$38,d0
0089B792 6500                       		bcs.s	loc_1A0F2
0089B794 4268 0010                  		clr.w	obVelX(a0)
0089B798                            
0089B798                            loc_1A0F2:
0089B798 0C68 26A0 0008             		cmpi.w	#$26A0,obX(a0)
0089B79E 6500                       		bcs.s	loc_1A110
0089B7A0 317C 26A0 0008             		move.w	#$26A0,obX(a0)
0089B7A6 317C 0240 0010             		move.w	#$240,obVelX(a0)
0089B7AC 317C FB40 0012             		move.w	#-$4C0,obVelY(a0)
0089B7B2 5428 0034                  		addq.b	#2,$34(a0)
0089B7B6                            
0089B7B6                            loc_1A110:
0089B7B6 6000                       		bra.s	loc_1A15C
0089B7B8                            ; ===========================================================================
0089B7B8                            
0089B7B8                            loc_1A112:				; XREF: off_19E80
0089B7B8 4EB9 0088 E3B2             		jsr	ObjectMove
0089B7BE 0C68 26E0 0008             		cmpi.w	#$26E0,obX(a0)
0089B7C4 6500                       		bcs.s	loc_1A124
0089B7C6 4268 0010                  		clr.w	obVelX(a0)
0089B7CA                            
0089B7CA                            loc_1A124:
0089B7CA 0668 0034 0012             		addi.w	#$34,obVelY(a0)
0089B7D0 4A68 0012                  		tst.w	obVelY(a0)
0089B7D4 6B00                       		bmi.s	loc_1A142
0089B7D6 0C68 0592 000C             		cmpi.w	#$592,obY(a0)
0089B7DC 6500                       		bcs.s	loc_1A142
0089B7DE 317C 0592 000C             		move.w	#$592,obY(a0)
0089B7E4 4268 0012                  		clr.w	obVelY(a0)
0089B7E8                            
0089B7E8                            loc_1A142:
0089B7E8 3028 0010                  		move.w	obVelX(a0),d0
0089B7EC 8068 0012                  		or.w	obVelY(a0),d0
0089B7F0 6600                       		bne.s	loc_1A15C
0089B7F2 5428 0034                  		addq.b	#2,$34(a0)
0089B7F6 317C FE80 0012             		move.w	#-$180,obVelY(a0)
0089B7FC 117C 0001 0021             		move.b	#1,obColProp(a0)
0089B802                            
0089B802                            loc_1A15C:
0089B802 43FA F898                  		lea	Ani_SEgg(pc),a1
0089B806 4EB9 0088 B4B0             		jsr	AnimateSprite
0089B80C                            
0089B80C                            loc_1A166:
0089B80C 0C78 2700 F72A             		cmpi.w	#$2700,(v_limitright2).w
0089B812 6C00                       		bge.s	loc_1A172
0089B814 5478 F72A                  		addq.w	#2,(v_limitright2).w
0089B818                            
0089B818                            loc_1A172:
0089B818 0C28 000C 0034             		cmpi.b	#$C,$34(a0)
0089B81E 6C00                       		bge.s	locret_1A190
0089B820 323C 001B                  		move.w	#$1B,d1
0089B824 343C 0070                  		move.w	#$70,d2
0089B828 363C 0071                  		move.w	#$71,d3
0089B82C 3828 0008                  		move.w	obX(a0),d4
0089B830 4EF9 0089 07B6             		jmp	SolidObject
0089B836                            ; ===========================================================================
0089B836                            
0089B836                            locret_1A190:
0089B836 4E75                       		rts	
0089B838                            ; ===========================================================================
0089B838                            
0089B838                            loc_1A192:				; XREF: off_19E80
0089B838 217C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a0)
0089B840 317C 0400 0002             		move.w	#$400,obGfx(a0)
0089B846 117C 0000 001C             		move.b	#0,obAnim(a0)
0089B84C 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B852 4EB9 0088 E3B2             		jsr	ObjectMove
0089B858 0C68 0544 000C             		cmpi.w	#$544,obY(a0)
0089B85E 6400                       		bcc.s	loc_1A1D0
0089B860 317C 0180 0010             		move.w	#$180,obVelX(a0)
0089B866 317C FFE8 0012             		move.w	#-$18,obVelY(a0)
0089B86C 117C 000F 0020             		move.b	#$F,obColType(a0)
0089B872 5428 0034                  		addq.b	#2,$34(a0)
0089B876                            
0089B876                            loc_1A1D0:
0089B876 6000 FF8A                  		bra.w	loc_1A15C
0089B87A                            ; ===========================================================================
0089B87A                            
0089B87A                            loc_1A1D4:				; XREF: off_19E80
0089B87A 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B880 4EB9 0088 E3B2             		jsr	ObjectMove
0089B886 4A68 0030                  		tst.w	$30(a0)
0089B88A 6600                       		bne.s	loc_1A1FC
0089B88C 4A28 0020                  		tst.b	obColType(a0)
0089B890 6600                       		bne.s	loc_1A216
0089B892 317C 001E 0030             		move.w	#$1E,$30(a0)
0089B8A2                            
0089B8A2                            loc_1A1FC:
0089B8A2 5368 0030                  		subq.w	#1,$30(a0)
0089B8A6 6600                       		bne.s	loc_1A216
0089B8A8 4A28 0022                  		tst.b	obStatus(a0)
0089B8AC 6A00                       		bpl.s	loc_1A210
0089B8AE 317C 0060 0012             		move.w	#$60,obVelY(a0)
0089B8B4 6000                       		bra.s	loc_1A216
0089B8B6                            ; ===========================================================================
0089B8B6                            
0089B8B6                            loc_1A210:
0089B8B6 117C 000F 0020             		move.b	#$F,obColType(a0)
0089B8BC                            
0089B8BC                            loc_1A216:
0089B8BC 0C78 2790 D008             		cmpi.w	#$2790,(v_player+obX).w
0089B8C2 6D00                       		blt.s	loc_1A23A
0089B8C4 11FC 0001 F7CC             		move.b	#1,(f_lockctrl).w
0089B8CA 31FC 0000 F602             		move.w	#0,(v_jpadhold2).w
0089B8D0 4278 D014                  		clr.w	(v_player+obInertia).w
0089B8D4 4A68 0012                  		tst.w	obVelY(a0)
0089B8D8 6A00                       		bpl.s	loc_1A248
0089B8DA 31FC 0100 F602             		move.w	#$100,(v_jpadhold2).w
0089B8E0                            
0089B8E0                            loc_1A23A:
0089B8E0 0C78 27E0 D008             		cmpi.w	#$27E0,(v_player+obX).w
0089B8E6 6D00                       		blt.s	loc_1A248
0089B8E8 31FC 27E0 D008             		move.w	#$27E0,(v_player+obX).w
0089B8EE                            
0089B8EE                            loc_1A248:
0089B8EE 0C68 2900 0008             		cmpi.w	#$2900,obX(a0)
0089B8F4 6500                       		bcs.s	loc_1A260
0089B8F6 4A28 0001                  		tst.b	obRender(a0)
0089B8FA 6B00                       		bmi.s	loc_1A260
0089B8FC 11FC 0018 F600             		move.b	#$18,(v_gamemode).w
0089B902 6000 FAE8                  		bra.w	Obj85_Delete
0089B906                            ; ===========================================================================
0089B906                            
0089B906                            loc_1A260:
0089B906 6000 FEFA                  		bra.w	loc_1A15C
0089B90A                            ; ===========================================================================
0089B90A                            
0089B90A                            loc_1A264:	; Routine 4
0089B90A 2268 0034                  		movea.l	$34(a0),a1
0089B90E 1011                       		move.b	(a1),d0
0089B910 B010                       		cmp.b	(a0),d0
0089B912 6600 FAD8                  		bne.w	Obj85_Delete
0089B916 117C 0007 001C             		move.b	#7,obAnim(a0)
0089B91C 0C29 000C 0034             		cmpi.b	#$C,$34(a1)
0089B922 6C00                       		bge.s	loc_1A280
0089B924 6000                       		bra.s	loc_1A2A6
0089B926                            ; ===========================================================================
0089B926                            
0089B926                            loc_1A280:
0089B926 4A69 0010                  		tst.w	obVelX(a1)
0089B92A 6700                       		beq.s	loc_1A28C
0089B92C 117C 000B 001C             		move.b	#$B,obAnim(a0)
0089B932                            
0089B932                            loc_1A28C:
0089B932 43FA DA10                  		lea	Ani_Eggman(pc),a1
0089B936 4EB9 0088 B4B0             		jsr	AnimateSprite
0089B93C                            
0089B93C                            loc_1A296:
0089B93C 2268 0034                  		movea.l	$34(a0),a1
0089B940 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089B946 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089B94C                            
0089B94C                            loc_1A2A6:
0089B94C 2268 0034                  		movea.l	$34(a0),a1
0089B950 1169 0022 0022             		move.b	obStatus(a1),obStatus(a0)
0089B956 7003                       		moveq	#3,d0
0089B958 C028 0022                  		and.b	obStatus(a0),d0
0089B95C 0228 00FC 0001             		andi.b	#$FC,obRender(a0)
0089B962 8128 0001                  		or.b	d0,obRender(a0)
0089B966 4EF9 0088 E3CC             		jmp	DisplaySprite
0089B96C                            ; ===========================================================================
0089B96C                            
0089B96C                            loc_1A2C6:	; Routine 6
0089B96C 2268 0034                  		movea.l	$34(a0),a1
0089B970 1011                       		move.b	(a1),d0
0089B972 B010                       		cmp.b	(a0),d0
0089B974 6600 FA76                  		bne.w	Obj85_Delete
0089B978 0CA9 0089 9394 0004        		cmpi.l	#Map_Eggman,obMap(a1)
0089B980 6700                       		beq.s	loc_1A2E4
0089B982 117C 000A 001A             		move.b	#$A,obFrame(a0)
0089B988 60C2                       		bra.s	loc_1A2A6
0089B98A                            ; ===========================================================================
0089B98A                            
0089B98A                            loc_1A2E4:
0089B98A 117C 0001 001C             		move.b	#1,obAnim(a0)
0089B990 4A29 0021                  		tst.b	obColProp(a1)
0089B994 6F00                       		ble.s	loc_1A312
0089B996 117C 0006 001C             		move.b	#6,obAnim(a0)
0089B99C 217C 0089 9394 0004        		move.l	#Map_Eggman,obMap(a0)
0089B9A4 317C 0400 0002             		move.w	#$400,obGfx(a0)
0089B9AA 43FA D998                  		lea	Ani_Eggman(pc),a1
0089B9AE 4EB9 0088 B4B0             		jsr	AnimateSprite
0089B9B4 6000 FF86                  		bra.w	loc_1A296
0089B9B8                            ; ===========================================================================
0089B9B8                            
0089B9B8                            loc_1A312:
0089B9B8 4A28 0001                  		tst.b	1(a0)
0089B9BC 6A00 FA2E                  		bpl.w	Obj85_Delete
0089B9C0 6100 D526                  		bsr.w	BossDefeated
0089B9C4 117C 0002 0018             		move.b	#2,obPriority(a0)
0089B9CA 117C 0000 001C             		move.b	#0,obAnim(a0)
0089B9D0 217C 0000 0000 0004        		move.l	#Map_FZDamaged,obMap(a0)
0089B9D8 317C 03A0 0002             		move.w	#$3A0,obGfx(a0)
0089B9DE 43FA 0000                  		lea	Ani_FZEgg(pc),a1
0089B9E2 4EB9 0088 B4B0             		jsr	AnimateSprite
0089B9E8 6000 FF52                  		bra.w	loc_1A296
0089B9EC                            ; ===========================================================================
0089B9EC                            
0089B9EC                            loc_1A346:	; Routine 8
0089B9EC 08E8 0000 0022             		bset	#0,obStatus(a0)
0089B9F2 2268 0034                  		movea.l	$34(a0),a1
0089B9F6 0CA9 0089 9394 0004        		cmpi.l	#Map_Eggman,obMap(a1)
0089B9FE 6700                       		beq.s	loc_1A35E
0089BA00 6000 FF4A                  		bra.w	loc_1A2A6
0089BA04                            ; ===========================================================================
0089BA04                            
0089BA04                            loc_1A35E:
0089BA04 3169 0008 0008             		move.w	obX(a1),obX(a0)
0089BA0A 3169 000C 000C             		move.w	obY(a1),obY(a0)
0089BA10 4A28 001E                  		tst.b	obTimeFrame(a0)
0089BA14 6600                       		bne.s	loc_1A376
0089BA16 117C 0014 001E             		move.b	#$14,obTimeFrame(a0)
0089BA1C                            
0089BA1C                            loc_1A376:
0089BA1C 5328 001E                  		subq.b	#1,obTimeFrame(a0)
0089BA20 6E00                       		bgt.s	loc_1A38A
0089BA22 5228 001A                  		addq.b	#1,obFrame(a0)
0089BA26 0C28 0002 001A             		cmpi.b	#2,obFrame(a0)
0089BA2C 6E00 F9BE                  		bgt.w	Obj85_Delete
0089BA30                            
0089BA30                            loc_1A38A:
0089BA30 6000 FF0A                  		bra.w	loc_1A296
0089BA34                            ; ===========================================================================
0089BA34                            
0089BA34                            loc_1A38E:	; Routine $A
0089BA34 117C 000B 001A             		move.b	#$B,obFrame(a0)
0089BA3A 3038 D008                  		move.w	(v_player+obX).w,d0
0089BA3E 9068 0008                  		sub.w	obX(a0),d0
0089BA42 6500                       		bcs.s	loc_1A3A6
0089BA44 4A28 0001                  		tst.b	obRender(a0)
0089BA48 6A00 F9A2                  		bpl.w	Obj85_Delete
0089BA4C                            
0089BA4C                            loc_1A3A6:
0089BA4C 4EF9 0088 E3CC             		jmp	DisplaySprite
0089BA52                            ; ===========================================================================
0089BA52                            
0089BA52                            loc_1A3AC:	; Routine $C
0089BA52 117C 0000 001A             		move.b	#0,obFrame(a0)
0089BA58 08E8 0000 0022             		bset	#0,obStatus(a0)
0089BA5E 2268 0034                  		movea.l	$34(a0),a1
0089BA62 0C29 000C 0034             		cmpi.b	#$C,$34(a1)
0089BA68 6600                       		bne.s	loc_1A3D0
0089BA6A 0CA9 0089 9394 0004        		cmpi.l	#Map_Eggman,obMap(a1)
0089BA72 6700 F978                  		beq.w	Obj85_Delete
0089BA76                            
0089BA76                            loc_1A3D0:
0089BA76 6000 FED4                  		bra.w	loc_1A2A6
0089BA76 6000 FED4                  		bra.w	loc_1A2A6
0089BA7A                            		include	"_anim\FZ Eggman in Ship.asm"
0089BA7A                            ; ---------------------------------------------------------------------------
0089BA7A                            ; Animation script - Eggman (FZ)
0089BA7A                            ; ---------------------------------------------------------------------------
0089BA7A 0000                       Ani_FZEgg:	dc.w byte_1A3D6-Ani_FZEgg
0089BA7C 0300 01FF                  byte_1A3D6:	dc.b 3,	0, 1, afEnd
0089BA80                            		even
0089BA80                            		even
0089BA80                            		include	"_maps\FZ Damaged Eggmobile.asm"
0089BA80                            ; ---------------------------------------------------------------------------
0089BA80                            ; Sprite mappings - Eggman in broken eggmobile (FZ)
0089BA80                            ; ---------------------------------------------------------------------------
0089BA80 0000                       Map_FZDamaged:	dc.w @damage1-Map_FZDamaged
0089BA82 0000                       		dc.w @damage2-Map_FZDamaged
0089BA84 06                         @damage1:	dc.b 6
0089BA85 E408 0020 F4               		dc.b $E4, 8, 0,	$20, $F4
0089BA8A EC0D 0023 E4               		dc.b $EC, $D, 0, $23, $E4
0089BA8F EC09 002B 04               		dc.b $EC, 9, 0,	$2B, 4
0089BA94 FC05 203A E4               		dc.b $FC, 5, $20, $3A, $E4
0089BA99 FC0E 203E 04               		dc.b $FC, $E, $20, $3E,	4
0089BA9E 1404 204A 04               		dc.b $14, 4, $20, $4A, 4
0089BAA3 06                         @damage2:	dc.b 6
0089BAA4 E40A 0031 F4               		dc.b $E4, $A, 0, $31, $F4
0089BAA9 EC05 0023 E4               		dc.b $EC, 5, 0,	$23, $E4
0089BAAE EC09 002B 04               		dc.b $EC, 9, 0,	$2B, 4
0089BAB3 FC05 203A E4               		dc.b $FC, 5, $20, $3A, $E4
0089BAB8 FC0E 203E 04               		dc.b $FC, $E, $20, $3E,	4
0089BABD 1404 204A 04               		dc.b $14, 4, $20, $4A, 4
0089BAC2                            		even
0089BAC2                            		even
0089BAC2                            		include	"_maps\FZ Eggmobile Legs.asm"
0089BAC2                            ; ---------------------------------------------------------------------------
0089BAC2                            ; Sprite mappings - legs on Eggman's escape ship (FZ)
0089BAC2                            ; ---------------------------------------------------------------------------
0089BAC2 0000                       Map_FZLegs:	dc.w @extended-Map_FZLegs
0089BAC4 0000                       		dc.w @halfway-Map_FZLegs
0089BAC6 0000                       		dc.w @retracted-Map_FZLegs
0089BAC8 02                         @extended:	dc.b 2
0089BAC9 140E 2800 F4               		dc.b $14, $E, $28, 0, $F4
0089BACE 2400 280C EC               		dc.b $24, 0, $28, $C, $EC
0089BAD3 03                         @halfway:	dc.b 3
0089BAD4 0C05 280D 0C               		dc.b $C, 5, $28, $D, $C
0089BAD9 1C00 2811 0C               		dc.b $1C, 0, $28, $11, $C
0089BADE 140D 2812 EC               		dc.b $14, $D, $28, $12,	$EC
0089BAE3 02                         @retracted:	dc.b 2
0089BAE4 0C01 281A 0C               		dc.b $C, 1, $28, $1A, $C
0089BAE9 140C 281C EC               		dc.b $14, $C, $28, $1C,	$EC
0089BAEE                            		even
0089BAEE                            		even
0089BAEE                            		include	"_incObj\84 FZ Eggman's Cylinders.asm"
0089BAEE                            ; ---------------------------------------------------------------------------
0089BAEE                            ; Object 84 - cylinder Eggman hides in (FZ)
0089BAEE                            ; ---------------------------------------------------------------------------
0089BAEE                            
0089BAEE                            Obj84_Delete:
0089BAEE 4EF9 0088 E408             		jmp	DeleteObject
0089BAF4                            ; ===========================================================================
0089BAF4                            
0089BAF4                            EggmanCylinder:				; XREF: Obj_Index
0089BAF4 7000                       		moveq	#0,d0
0089BAF6 1028 0024                  		move.b	obRoutine(a0),d0
0089BAFA 303B 0000                  		move.w	Obj84_Index(pc,d0.w),d0
0089BAFE 4EFB 0000                  		jmp	Obj84_Index(pc,d0.w)
0089BB02                            ; ===========================================================================
0089BB02 0000                       Obj84_Index:	dc.w Obj84_Main-Obj84_Index
0089BB04 0000                       		dc.w loc_1A4CE-Obj84_Index
0089BB06 0000                       		dc.w loc_1A57E-Obj84_Index
0089BB08                            
0089BB08 24D0 0620                  Obj84_PosData:	dc.w $24D0, $620
0089BB0C 2550 0620                  		dc.w $2550, $620
0089BB10 2490 04C0                  		dc.w $2490, $4C0
0089BB14 2510 04C0                  		dc.w $2510, $4C0
0089BB18                            ; ===========================================================================
0089BB18                            
0089BB18                            Obj84_Main:	; Routine
0089BB18 43FA FFEE                  		lea	Obj84_PosData(pc),a1
0089BB1C 7000                       		moveq	#0,d0
0089BB1E 1028 0028                  		move.b	obSubtype(a0),d0
0089BB22 D040                       		add.w	d0,d0
0089BB24 D2C0                       		adda.w	d0,a1
0089BB26 117C 0004 0001             		move.b	#4,obRender(a0)
0089BB2C 08E8 0007 0001             		bset	#7,obRender(a0)
0089BB32 08E8 0004 0001             		bset	#4,obRender(a0)
0089BB38 317C 0300 0002             		move.w	#$300,obGfx(a0)
0089BB3E 217C 0000 0000 0004        		move.l	#Map_EggCyl,obMap(a0)
0089BB46 3159 0008                  		move.w	(a1)+,obX(a0)
0089BB4A 3151 000C                  		move.w	(a1),obY(a0)
0089BB4E 3159 0038                  		move.w	(a1)+,$38(a0)
0089BB52 117C 0020 0016             		move.b	#$20,obHeight(a0)
0089BB58 117C 0060 0017             		move.b	#$60,obWidth(a0)
0089BB5E 117C 0020 0019             		move.b	#$20,obActWid(a0)
0089BB64 117C 0060 0016             		move.b	#$60,obHeight(a0)
0089BB6A 117C 0003 0018             		move.b	#3,obPriority(a0)
0089BB70 5428 0024                  		addq.b	#2,obRoutine(a0)
0089BB74                            
0089BB74                            loc_1A4CE:	; Routine 2
0089BB74 0C28 0002 0028             		cmpi.b	#2,obSubtype(a0)
0089BB7A 6F00                       		ble.s	loc_1A4DC
0089BB7C 08E8 0001 0001             		bset	#1,obRender(a0)
0089BB82                            
0089BB82                            loc_1A4DC:
0089BB82 42A8 003C                  		clr.l	$3C(a0)
0089BB86 4A28 0029                  		tst.b	$29(a0)
0089BB8A 6700                       		beq.s	loc_1A4EA
0089BB8C 5428 0024                  		addq.b	#2,obRoutine(a0)
0089BB90                            
0089BB90                            loc_1A4EA:
0089BB90 2028 003C                  		move.l	$3C(a0),d0
0089BB94 2228 0038                  		move.l	$38(a0),d1
0089BB98 D280                       		add.l	d0,d1
0089BB9A 4841                       		swap	d1
0089BB9C 3141 000C                  		move.w	d1,obY(a0)
0089BBA0 0C28 0004 0024             		cmpi.b	#4,obRoutine(a0)
0089BBA6 6600                       		bne.s	loc_1A524
0089BBA8 4A68 0030                  		tst.w	$30(a0)
0089BBAC 6A00                       		bpl.s	loc_1A524
0089BBAE 70F6                       		moveq	#-$A,d0
0089BBB0 0C28 0002 0028             		cmpi.b	#2,obSubtype(a0)
0089BBB6 6F00                       		ble.s	loc_1A514
0089BBB8 700E                       		moveq	#$E,d0
0089BBBA                            
0089BBBA                            loc_1A514:
0089BBBA D240                       		add.w	d0,d1
0089BBBC 2268 0034                  		movea.l	$34(a0),a1
0089BBC0 3341 000C                  		move.w	d1,obY(a1)
0089BBC4 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089BBCA                            
0089BBCA                            loc_1A524:
0089BBCA 323C 002B                  		move.w	#$2B,d1
0089BBCE 343C 0060                  		move.w	#$60,d2
0089BBD2 363C 0061                  		move.w	#$61,d3
0089BBD6 3828 0008                  		move.w	obX(a0),d4
0089BBDA 4EB9 0089 07B6             		jsr	SolidObject
0089BBE0 7000                       		moveq	#0,d0
0089BBE2 3228 003C                  		move.w	$3C(a0),d1
0089BBE6 6A00                       		bpl.s	loc_1A550
0089BBE8 4441                       		neg.w	d1
0089BBEA 5141                       		subq.w	#8,d1
0089BBEC 6500                       		bcs.s	loc_1A55C
0089BBEE 5200                       		addq.b	#1,d0
0089BBF0 E841                       		asr.w	#4,d1
0089BBF2 D041                       		add.w	d1,d0
0089BBF4 6000                       		bra.s	loc_1A55C
0089BBF6                            ; ===========================================================================
0089BBF6                            
0089BBF6                            loc_1A550:
0089BBF6 0441 0027                  		subi.w	#$27,d1
0089BBFA 6500                       		bcs.s	loc_1A55C
0089BBFC 5200                       		addq.b	#1,d0
0089BBFE E841                       		asr.w	#4,d1
0089BC00 D041                       		add.w	d1,d0
0089BC02                            
0089BC02                            loc_1A55C:
0089BC02 1140 001A                  		move.b	d0,obFrame(a0)
0089BC06 3038 D008                  		move.w	(v_player+obX).w,d0
0089BC0A 9068 0008                  		sub.w	obX(a0),d0
0089BC0E 6B00                       		bmi.s	loc_1A578
0089BC10 0440 0140                  		subi.w	#$140,d0
0089BC14 6B00                       		bmi.s	loc_1A578
0089BC16 4A28 0001                  		tst.b	obRender(a0)
0089BC1A 6A00 FED2                  		bpl.w	Obj84_Delete
0089BC1E                            
0089BC1E                            loc_1A578:
0089BC1E 4EF9 0088 E3CC             		jmp	DisplaySprite
0089BC24                            ; ===========================================================================
0089BC24                            
0089BC24                            loc_1A57E:	; Routine 4
0089BC24 7000                       		moveq	#0,d0
0089BC26 1028 0028                  		move.b	obSubtype(a0),d0
0089BC2A 303B 0000                  		move.w	off_1A590(pc,d0.w),d0
0089BC2E 4EBB 0000                  		jsr	off_1A590(pc,d0.w)
0089BC32 6000 FF5C                  		bra.w	loc_1A4EA
0089BC36                            ; ===========================================================================
0089BC36 0000                       off_1A590:	dc.w loc_1A598-off_1A590
0089BC38 0000                       		dc.w loc_1A598-off_1A590
0089BC3A 0000                       		dc.w loc_1A604-off_1A590
0089BC3C 0000                       		dc.w loc_1A604-off_1A590
0089BC3E                            ; ===========================================================================
0089BC3E                            
0089BC3E                            loc_1A598:				; XREF: off_1A590
0089BC3E 4A28 0029                  		tst.b	$29(a0)
0089BC42 6600                       		bne.s	loc_1A5D4
0089BC44 2268 0034                  		movea.l	$34(a0),a1
0089BC48 4A29 0021                  		tst.b	obColProp(a1)
0089BC4C 6600                       		bne.s	loc_1A5B4
0089BC4E 6100 D298                  		bsr.w	BossDefeated
0089BC52 04A8 0001 0000 003C        		subi.l	#$10000,$3C(a0)
0089BC5A                            
0089BC5A                            loc_1A5B4:
0089BC5A 06A8 0002 0000 003C        		addi.l	#$20000,$3C(a0)
0089BC62 6400                       		bcc.s	locret_1A602
0089BC64 42A8 003C                  		clr.l	$3C(a0)
0089BC68 2268 0034                  		movea.l	$34(a0),a1
0089BC6C 5369 0032                  		subq.w	#1,$32(a1)
0089BC70 4269 0030                  		clr.w	$30(a1)
0089BC74 5528 0024                  		subq.b	#2,obRoutine(a0)
0089BC78 4E75                       		rts	
0089BC7A                            ; ===========================================================================
0089BC7A                            
0089BC7A                            loc_1A5D4:
0089BC7A 0C68 FFF0 003C             		cmpi.w	#-$10,$3C(a0)
0089BC80 6C00                       		bge.s	loc_1A5E4
0089BC82 04A8 0002 8000 003C        		subi.l	#$28000,$3C(a0)
0089BC8A                            
0089BC8A                            loc_1A5E4:
0089BC8A 04A8 0000 8000 003C        		subi.l	#$8000,$3C(a0)
0089BC92 0C68 FF60 003C             		cmpi.w	#-$A0,$3C(a0)
0089BC98 6E00                       		bgt.s	locret_1A602
0089BC9A 4268 003E                  		clr.w	$3E(a0)
0089BC9E 317C FF60 003C             		move.w	#-$A0,$3C(a0)
0089BCA4 4228 0029                  		clr.b	$29(a0)
0089BCA8                            
0089BCA8                            locret_1A602:
0089BCA8 4E75                       		rts	
0089BCAA                            ; ===========================================================================
0089BCAA                            
0089BCAA                            loc_1A604:				; XREF: off_1A590
0089BCAA 08E8 0001 0001             		bset	#1,obRender(a0)
0089BCB0 4A28 0029                  		tst.b	$29(a0)
0089BCB4 6600                       		bne.s	loc_1A646
0089BCB6 2268 0034                  		movea.l	$34(a0),a1
0089BCBA 4A29 0021                  		tst.b	obColProp(a1)
0089BCBE 6600                       		bne.s	loc_1A626
0089BCC0 6100 D226                  		bsr.w	BossDefeated
0089BCC4 06A8 0001 0000 003C        		addi.l	#$10000,$3C(a0)
0089BCCC                            
0089BCCC                            loc_1A626:
0089BCCC 04A8 0002 0000 003C        		subi.l	#$20000,$3C(a0)
0089BCD4 6400                       		bcc.s	locret_1A674
0089BCD6 42A8 003C                  		clr.l	$3C(a0)
0089BCDA 2268 0034                  		movea.l	$34(a0),a1
0089BCDE 5369 0032                  		subq.w	#1,$32(a1)
0089BCE2 4269 0030                  		clr.w	$30(a1)
0089BCE6 5528 0024                  		subq.b	#2,obRoutine(a0)
0089BCEA 4E75                       		rts	
0089BCEC                            ; ===========================================================================
0089BCEC                            
0089BCEC                            loc_1A646:
0089BCEC 0C68 0010 003C             		cmpi.w	#$10,$3C(a0)
0089BCF2 6D00                       		blt.s	loc_1A656
0089BCF4 06A8 0002 8000 003C        		addi.l	#$28000,$3C(a0)
0089BCFC                            
0089BCFC                            loc_1A656:
0089BCFC 06A8 0000 8000 003C        		addi.l	#$8000,$3C(a0)
0089BD04 0C68 00A0 003C             		cmpi.w	#$A0,$3C(a0)
0089BD0A 6D00                       		blt.s	locret_1A674
0089BD0C 4268 003E                  		clr.w	$3E(a0)
0089BD10 317C 00A0 003C             		move.w	#$A0,$3C(a0)
0089BD16 4228 0029                  		clr.b	$29(a0)
0089BD1A                            
0089BD1A                            locret_1A674:
0089BD1A 4E75                       		rts	
0089BD1A 4E75                       		rts	
0089BD1C                            		include	"_maps\FZ Eggman's Cylinders.asm"
0089BD1C                            ; ---------------------------------------------------------------------------
0089BD1C                            ; Sprite mappings - cylinders Eggman hides in (FZ)
0089BD1C                            ; ---------------------------------------------------------------------------
0089BD1C 0000 0000                  Map_EggCyl:	dc.w @flat-Map_EggCyl, @extending1-Map_EggCyl
0089BD20 0000 0000                  		dc.w @extending2-Map_EggCyl, @extending3-Map_EggCyl
0089BD24 0000 0000                  		dc.w @extending4-Map_EggCyl, @extendedfully-Map_EggCyl
0089BD28 0000 0000                  		dc.w @extendedfully-Map_EggCyl, @extendedfully-Map_EggCyl
0089BD2C 0000 0000                  		dc.w @extendedfully-Map_EggCyl, @extendedfully-Map_EggCyl
0089BD30 0000 0000                  		dc.w @extendedfully-Map_EggCyl, @controlpanel-Map_EggCyl
0089BD34 06                         @flat:		dc.b 6
0089BD35 A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BD3A A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BD3F B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BD44 B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BD49 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BD4E B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BD53 08                         @extending1:	dc.b 8
0089BD54 A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BD59 A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BD5E B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BD63 B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BD68 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BD6D B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BD72 D80F 4020 E0               		dc.b $D8, $F, $40, $20,	$E0
0089BD77 D80F 4820 00               		dc.b $D8, $F, $48, $20,	0
0089BD7C 0A                         @extending2:	dc.b $A
0089BD7D A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BD82 A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BD87 B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BD8C B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BD91 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BD96 B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BD9B D80F 4020 E0               		dc.b $D8, $F, $40, $20,	$E0
0089BDA0 D80F 4820 00               		dc.b $D8, $F, $48, $20,	0
0089BDA5 F80F 4030 E0               		dc.b $F8, $F, $40, $30,	$E0
0089BDAA F80F 4830 00               		dc.b $F8, $F, $48, $30,	0
0089BDAF 0C                         @extending3:	dc.b $C
0089BDB0 A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BDB5 A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BDBA B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BDBF B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BDC4 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BDC9 B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BDCE D80F 4020 E0               		dc.b $D8, $F, $40, $20,	$E0
0089BDD3 D80F 4820 00               		dc.b $D8, $F, $48, $20,	0
0089BDD8 F80F 4030 E0               		dc.b $F8, $F, $40, $30,	$E0
0089BDDD F80F 4830 00               		dc.b $F8, $F, $48, $30,	0
0089BDE2 180F 4040 E0               		dc.b $18, $F, $40, $40,	$E0
0089BDE7 180F 4840 00               		dc.b $18, $F, $48, $40,	0
0089BDEC 0D                         @extending4:	dc.b $D
0089BDED A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BDF2 A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BDF7 B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BDFC B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BE01 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BE06 B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BE0B D80F 4020 E0               		dc.b $D8, $F, $40, $20,	$E0
0089BE10 D80F 4820 00               		dc.b $D8, $F, $48, $20,	0
0089BE15 F80F 4030 E0               		dc.b $F8, $F, $40, $30,	$E0
0089BE1A F80F 4830 00               		dc.b $F8, $F, $48, $30,	0
0089BE1F 180F 4040 E0               		dc.b $18, $F, $40, $40,	$E0
0089BE24 180F 4840 00               		dc.b $18, $F, $48, $40,	0
0089BE29 380F 4050 F0               		dc.b $38, $F, $40, $50,	$F0
0089BE2E 0E                         @extendedfully:	dc.b $E
0089BE2F A00D 4000 E0               		dc.b $A0, $D, $40, 0, $E0
0089BE34 A00D 4800 00               		dc.b $A0, $D, $48, 0, 0
0089BE39 B00C 2008 E0               		dc.b $B0, $C, $20, 8, $E0
0089BE3E B00C 200C 00               		dc.b $B0, $C, $20, $C, 0
0089BE43 B80F 4010 E0               		dc.b $B8, $F, $40, $10,	$E0
0089BE48 B80F 4810 00               		dc.b $B8, $F, $48, $10,	0
0089BE4D D80F 4020 E0               		dc.b $D8, $F, $40, $20,	$E0
0089BE52 D80F 4820 00               		dc.b $D8, $F, $48, $20,	0
0089BE57 F80F 4030 E0               		dc.b $F8, $F, $40, $30,	$E0
0089BE5C F80F 4830 00               		dc.b $F8, $F, $48, $30,	0
0089BE61 180F 4040 E0               		dc.b $18, $F, $40, $40,	$E0
0089BE66 180F 4840 00               		dc.b $18, $F, $48, $40,	0
0089BE6B 380F 4050 F0               		dc.b $38, $F, $40, $50,	$F0
0089BE70 580F 4050 F0               		dc.b $58, $F, $40, $50,	$F0
0089BE75 02                         @controlpanel:	dc.b 2
0089BE76 F804 0068 F0               		dc.b $F8, 4, 0,	$68, $F0
0089BE7B 000C 006A F0               		dc.b 0,	$C, 0, $6A, $F0
0089BE80                            		even
0089BE80                            		even
0089BE80                            		include	"_incObj\86 FZ Plasma Ball Launcher.asm"
0089BE80                            ; ---------------------------------------------------------------------------
0089BE80                            ; Object 86 - energy balls (FZ)
0089BE80                            ; ---------------------------------------------------------------------------
0089BE80                            
0089BE80                            BossPlasma:				; XREF: Obj_Index
0089BE80 7000                       		moveq	#0,d0
0089BE82 1028 0024                  		move.b	obRoutine(a0),d0
0089BE86 303B 0000                  		move.w	Obj86_Index(pc,d0.w),d0
0089BE8A 4EFB 0000                  		jmp	Obj86_Index(pc,d0.w)
0089BE8E                            ; ===========================================================================
0089BE8E 0000                       Obj86_Index:	dc.w Obj86_Main-Obj86_Index
0089BE90 0000                       		dc.w Obj86_Generator-Obj86_Index
0089BE92 0000                       		dc.w Obj86_MakeBalls-Obj86_Index
0089BE94 0000                       		dc.w loc_1A962-Obj86_Index
0089BE96 0000                       		dc.w loc_1A982-Obj86_Index
0089BE98                            ; ===========================================================================
0089BE98                            
0089BE98                            Obj86_Main:	; Routine 0
0089BE98 317C 2588 0008             		move.w	#$2588,obX(a0)
0089BE9E 317C 053C 000C             		move.w	#$53C,obY(a0)
0089BEA4 317C 0300 0002             		move.w	#$300,obGfx(a0)
0089BEAA 217C 0000 0000 0004        		move.l	#Map_PLaunch,obMap(a0)
0089BEB2 117C 0000 001C             		move.b	#0,obAnim(a0)
0089BEB8 117C 0003 0018             		move.b	#3,obPriority(a0)
0089BEBE 117C 0008 0017             		move.b	#8,obWidth(a0)
0089BEC4 117C 0008 0016             		move.b	#8,obHeight(a0)
0089BECA 117C 0004 0001             		move.b	#4,obRender(a0)
0089BED0 08E8 0007 0001             		bset	#7,obRender(a0)
0089BED6 5428 0024                  		addq.b	#2,obRoutine(a0)
0089BEDA                            
0089BEDA                            Obj86_Generator:; Routine 2
0089BEDA 2268 0034                  		movea.l	$34(a0),a1
0089BEDE 0C29 0006 0034             		cmpi.b	#6,$34(a1)
0089BEE4 6600                       		bne.s	loc_1A850
0089BEE6 10BC 003F                  		move.b	#$3F,(a0)
0089BEEA 117C 0000 0024             		move.b	#0,obRoutine(a0)
0089BEF0 4EF9 0088 E3CC             		jmp	DisplaySprite
0089BEF6                            ; ===========================================================================
0089BEF6                            
0089BEF6                            loc_1A850:
0089BEF6 117C 0000 001C             		move.b	#0,obAnim(a0)
0089BEFC 4A28 0029                  		tst.b	$29(a0)
0089BF00 6700                       		beq.s	loc_1A86C
0089BF02 5428 0024                  		addq.b	#2,obRoutine(a0)
0089BF06 117C 0001 001C             		move.b	#1,obAnim(a0)
0089BF0C 117C 003E 0028             		move.b	#$3E,obSubtype(a0)
0089BF12                            
0089BF12                            loc_1A86C:
0089BF12 323C 0013                  		move.w	#$13,d1
0089BF16 343C 0008                  		move.w	#8,d2
0089BF1A 363C 0011                  		move.w	#$11,d3
0089BF1E 3828 0008                  		move.w	obX(a0),d4
0089BF22 4EB9 0089 07B6             		jsr	SolidObject
0089BF28 3038 D008                  		move.w	(v_player+obX).w,d0
0089BF2C 9068 0008                  		sub.w	obX(a0),d0
0089BF30 6B00                       		bmi.s	loc_1A89A
0089BF32 0440 0140                  		subi.w	#$140,d0
0089BF36 6B00                       		bmi.s	loc_1A89A
0089BF38 4A28 0001                  		tst.b	obRender(a0)
0089BF3C 6A00 FBB0                  		bpl.w	Obj84_Delete
0089BF40                            
0089BF40                            loc_1A89A:
0089BF40 43FA 0000                  		lea	Ani_PLaunch(pc),a1
0089BF44 4EB9 0088 B4B0             		jsr	AnimateSprite
0089BF4A 4EF9 0088 E3CC             		jmp	DisplaySprite
0089BF50                            ; ===========================================================================
0089BF50                            
0089BF50                            Obj86_MakeBalls:; Routine 4
0089BF50 4A28 0029                  		tst.b	$29(a0)
0089BF54 6700 0000                  		beq.w	loc_1A954
0089BF58 4228 0029                  		clr.b	$29(a0)
0089BF5C D068 0030                  		add.w	$30(a0),d0
0089BF60 0240 001E                  		andi.w	#$1E,d0
0089BF64 D4C0                       		adda.w	d0,a2
0089BF66 5868 0030                  		addq.w	#4,$30(a0)
0089BF6A 4268 0032                  		clr.w	$32(a0)
0089BF6E 7403                       		moveq	#3,d2
0089BF70                            
0089BF70                            Obj86_Loop:
0089BF70 4EB9 0088 E878             		jsr	FindNextFreeObj
0089BF76 6600 0000                  		bne.w	loc_1A954
0089BF7A 12BC 0086                  		move.b	#id_BossPlasma,(a1)
0089BF7E 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089BF84 337C 053C 000C             		move.w	#$53C,obY(a1)
0089BF8A 137C 0008 0024             		move.b	#8,obRoutine(a1)
0089BF90 337C 2300 0002             		move.w	#$2300,obGfx(a1)
0089BF96 237C 0000 0000 0004        		move.l	#Map_Plasma,obMap(a1)
0089BF9E 137C 000C 0016             		move.b	#$C,obHeight(a1)
0089BFA4 137C 000C 0017             		move.b	#$C,obWidth(a1)
0089BFAA 137C 0000 0020             		move.b	#0,obColType(a1)
0089BFB0 137C 0003 0018             		move.b	#3,obPriority(a1)
0089BFB6 337C 003E 0028             		move.w	#$3E,obSubtype(a1)
0089BFBC 137C 0004 0001             		move.b	#4,obRender(a1)
0089BFC2 08E9 0007 0001             		bset	#7,obRender(a1)
0089BFC8 2348 0034                  		move.l	a0,$34(a1)
0089BFCC 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089BFD2 3228 0032                  		move.w	$32(a0),d1
0089BFD6 C3FC FFB1                  		muls.w	#-$4F,d1
0089BFDA 0641 2578                  		addi.w	#$2578,d1
0089BFDE 0240 001F                  		andi.w	#$1F,d0
0089BFE2 0440 0010                  		subi.w	#$10,d0
0089BFE6 D041                       		add.w	d1,d0
0089BFE8 3340 0030                  		move.w	d0,$30(a1)
0089BFEC 5268 0032                  		addq.w	#1,$32(a0)
0089BFF0 3168 0032 0038             		move.w	$32(a0),$38(a0)
0089BFF6 51CA FF78                  		dbf	d2,Obj86_Loop	; repeat sequence 3 more times
0089BFFA                            
0089BFFA                            loc_1A954:
0089BFFA 4A68 0032                  		tst.w	$32(a0)
0089BFFE 6600                       		bne.s	loc_1A95E
0089C000 5428 0024                  		addq.b	#2,obRoutine(a0)
0089C004                            
0089C004                            loc_1A95E:
0089C004 6000 FF0C                  		bra.w	loc_1A86C
0089C008                            ; ===========================================================================
0089C008                            
0089C008                            loc_1A962:	; Routine 6
0089C008 117C 0002 001C             		move.b	#2,obAnim(a0)
0089C00E 4A68 0038                  		tst.w	$38(a0)
0089C012 6600                       		bne.s	loc_1A97E
0089C014 117C 0002 0024             		move.b	#2,obRoutine(a0)
0089C01A 2268 0034                  		movea.l	$34(a0),a1
0089C01E 337C FFFF 0032             		move.w	#-1,$32(a1)
0089C024                            
0089C024                            loc_1A97E:
0089C024 6000 FEEC                  		bra.w	loc_1A86C
0089C028                            ; ===========================================================================
0089C028                            
0089C028                            loc_1A982:	; Routine 8
0089C028 7000                       		moveq	#0,d0
0089C02A 1028 0025                  		move.b	ob2ndRout(a0),d0
0089C02E 303B 0000                  		move.w	Obj86_Index2(pc,d0.w),d0
0089C032 4EBB 0000                  		jsr	Obj86_Index2(pc,d0.w)
0089C036 43FA 0000                  		lea	Ani_Plasma(pc),a1
0089C03A 4EB9 0088 B4B0             		jsr	AnimateSprite
0089C040 4EF9 0088 E3CC             		jmp	DisplaySprite
0089C046                            ; ===========================================================================
0089C046 0000                       Obj86_Index2:	dc.w loc_1A9A6-Obj86_Index2
0089C048 0000                       		dc.w loc_1A9C0-Obj86_Index2
0089C04A 0000                       		dc.w loc_1AA1E-Obj86_Index2
0089C04C                            ; ===========================================================================
0089C04C                            
0089C04C                            loc_1A9A6:				; XREF: Obj86_Index2
0089C04C 3028 0030                  		move.w	$30(a0),d0
0089C050 9068 0008                  		sub.w	obX(a0),d0
0089C054 E940                       		asl.w	#4,d0
0089C056 3140 0010                  		move.w	d0,obVelX(a0)
0089C05A 317C 00B4 0028             		move.w	#$B4,obSubtype(a0)
0089C060 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089C064 4E75                       		rts	
0089C066                            ; ===========================================================================
0089C066                            
0089C066                            loc_1A9C0:				; XREF: Obj86_Index2
0089C066 4A68 0010                  		tst.w	obVelX(a0)
0089C06A 6700                       		beq.s	loc_1A9E6
0089C06C 4EB9 0088 E3B2             		jsr	ObjectMove
0089C072 3028 0008                  		move.w	obX(a0),d0
0089C076 9068 0030                  		sub.w	$30(a0),d0
0089C07A 6400                       		bcc.s	loc_1A9E6
0089C07C 4268 0010                  		clr.w	obVelX(a0)
0089C080 D168 0008                  		add.w	d0,obX(a0)
0089C084 2268 0034                  		movea.l	$34(a0),a1
0089C088 5369 0032                  		subq.w	#1,$32(a1)
0089C08C                            
0089C08C                            loc_1A9E6:
0089C08C 117C 0000 001C             		move.b	#0,obAnim(a0)
0089C092 5368 0028                  		subq.w	#1,obSubtype(a0)
0089C096 6600                       		bne.s	locret_1AA1C
0089C098 5428 0025                  		addq.b	#2,ob2ndRout(a0)
0089C09C 117C 0001 001C             		move.b	#1,obAnim(a0)
0089C0A2 117C 009A 0020             		move.b	#$9A,obColType(a0)
0089C0A8 317C 00B4 0028             		move.w	#$B4,obSubtype(a0)
0089C0AE 7000                       		moveq	#0,d0
0089C0B0 3038 D008                  		move.w	(v_player+obX).w,d0
0089C0B4 9068 0008                  		sub.w	obX(a0),d0
0089C0B8 3140 0010                  		move.w	d0,obVelX(a0)
0089C0BC 317C 0140 0012             		move.w	#$140,obVelY(a0)
0089C0C2                            
0089C0C2                            locret_1AA1C:
0089C0C2 4E75                       		rts	
0089C0C4                            ; ===========================================================================
0089C0C4                            
0089C0C4                            loc_1AA1E:				; XREF: Obj86_Index2
0089C0C4 4EB9 0088 E3B2             		jsr	ObjectMove
0089C0CA 0C68 05E0 000C             		cmpi.w	#$5E0,obY(a0)
0089C0D0 6400                       		bcc.s	loc_1AA34
0089C0D2 5368 0028                  		subq.w	#1,obSubtype(a0)
0089C0D6 6700                       		beq.s	loc_1AA34
0089C0D8 4E75                       		rts	
0089C0DA                            ; ===========================================================================
0089C0DA                            
0089C0DA                            loc_1AA34:
0089C0DA 2268 0034                  		movea.l	$34(a0),a1
0089C0DE 5369 0038                  		subq.w	#1,$38(a1)
0089C0E2 6000 FA0A                  		bra.w	Obj84_Delete
0089C0E2 6000 FA0A                  		bra.w	Obj84_Delete
0089C0E6                            		include	"_anim\Plasma Ball Launcher.asm"
0089C0E6                            ; ---------------------------------------------------------------------------
0089C0E6                            ; Animation script - energy ball launcher (FZ)
0089C0E6                            ; ---------------------------------------------------------------------------
0089C0E6 0000                       Ani_PLaunch:	dc.w @red-Ani_PLaunch
0089C0E8 0000                       		dc.w @redsparking-Ani_PLaunch
0089C0EA 0000                       		dc.w @whitesparking-Ani_PLaunch
0089C0EC 7E00 FF                    @red:		dc.b $7E, 0, afEnd
0089C0F0 00                         		even
0089C0F0 0100 0200 03FF             @redsparking:	dc.b 1,	0, 2, 0, 3, afEnd
0089C0F6                            		even
0089C0F6 0101 0201 03FF             @whitesparking:	dc.b 1,	1, 2, 1, 3, afEnd
0089C0FC                            		even
0089C0FC                            		even
0089C0FC                            		include	"_maps\Plasma Ball Launcher.asm"
0089C0FC                            ; ---------------------------------------------------------------------------
0089C0FC                            ; Sprite mappings - energy ball	launcher (FZ)
0089C0FC                            ; ---------------------------------------------------------------------------
0089C0FC 0000                       Map_PLaunch:	dc.w @red-Map_PLaunch
0089C0FE 0000                       		dc.w @white-Map_PLaunch
0089C100 0000                       		dc.w @sparking1-Map_PLaunch
0089C102 0000                       		dc.w @sparking2-Map_PLaunch
0089C104 01                         @red:		dc.b 1
0089C105 F805 006E F8               		dc.b $F8, 5, 0,	$6E, $F8
0089C10A 01                         @white:		dc.b 1
0089C10B F805 0076 F8               		dc.b $F8, 5, 0,	$76, $F8
0089C110 01                         @sparking1:	dc.b 1
0089C111 F805 0072 F8               		dc.b $F8, 5, 0,	$72, $F8
0089C116 01                         @sparking2:	dc.b 1
0089C117 F805 1072 F8               		dc.b $F8, 5, $10, $72, $F8
0089C11C                            		even
0089C11C                            		even
0089C11C                            		include	"_anim\Plasma Balls.asm"
0089C11C                            ; ---------------------------------------------------------------------------
0089C11C                            ; Animation script - energy balls (FZ)
0089C11C                            ; ---------------------------------------------------------------------------
0089C11C 0000                       Ani_Plasma:	dc.w @full-Ani_Plasma
0089C11E 0000                       		dc.w @short-Ani_Plasma
0089C120 0100 0A08 0A01 0A09 0A06+  @full:		dc.b 1,	0, $A, 8, $A, 1, $A, 9,	$A, 6, $A, 7, $A, 0, $A
0089C12F 080A 010A 090A 060A 070A+  		dc.b 8,	$A, 1, $A, 9, $A, 6, $A, 7, $A,	2, $A, 3, $A, 4
0089C13E 0A05 FF                    		dc.b $A, 5, afEnd
0089C142 00                         		even
0089C142 0006 0501 0507 0501 05FF   @short:		dc.b 0,	6, 5, 1, 5, 7, 5, 1, 5,	afEnd
0089C14C                            		even
0089C14C                            		even
0089C14C                            		include	"_maps\Plasma Balls.asm"
0089C14C                            ; ---------------------------------------------------------------------------
0089C14C                            ; Sprite mappings - energy balls (FZ)
0089C14C                            ; ---------------------------------------------------------------------------
0089C14C 0000 0000                  Map_Plasma:	dc.w @fuzzy1-Map_Plasma, @fuzzy2-Map_Plasma
0089C150 0000 0000                  		dc.w @white1-Map_Plasma, @white2-Map_Plasma
0089C154 0000 0000                  		dc.w @white3-Map_Plasma, @white4-Map_Plasma
0089C158 0000 0000                  		dc.w @fuzzy3-Map_Plasma, @fuzzy4-Map_Plasma
0089C15C 0000 0000                  		dc.w @fuzzy5-Map_Plasma, @fuzzy6-Map_Plasma
0089C160 0000                       		dc.w @blank-Map_Plasma
0089C162 02                         @fuzzy1:	dc.b 2
0089C163 F00D 007A F0               		dc.b $F0, $D, 0, $7A, $F0
0089C168 000D 187A F0               		dc.b 0,	$D, $18, $7A, $F0
0089C16D 02                         @fuzzy2:	dc.b 2
0089C16E F406 0082 F4               		dc.b $F4, 6, 0,	$82, $F4
0089C173 F402 1882 04               		dc.b $F4, 2, $18, $82, 4
0089C178 02                         @white1:	dc.b 2
0089C179 F804 0088 F8               		dc.b $F8, 4, 0,	$88, $F8
0089C17E 0004 1088 F8               		dc.b 0,	4, $10,	$88, $F8
0089C183 02                         @white2:	dc.b 2
0089C184 F804 008A F8               		dc.b $F8, 4, 0,	$8A, $F8
0089C189 0004 108A F8               		dc.b 0,	4, $10,	$8A, $F8
0089C18E 02                         @white3:	dc.b 2
0089C18F F804 008C F8               		dc.b $F8, 4, 0,	$8C, $F8
0089C194 0004 108C F8               		dc.b 0,	4, $10,	$8C, $F8
0089C199 02                         @white4:	dc.b 2
0089C19A F406 008E F4               		dc.b $F4, 6, 0,	$8E, $F4
0089C19F F402 188E 04               		dc.b $F4, 2, $18, $8E, 4
0089C1A4 01                         @fuzzy3:	dc.b 1
0089C1A5 F805 0094 F8               		dc.b $F8, 5, 0,	$94, $F8
0089C1AA 01                         @fuzzy4:	dc.b 1
0089C1AB F805 0098 F8               		dc.b $F8, 5, 0,	$98, $F8
0089C1B0 02                         @fuzzy5:	dc.b 2
0089C1B1 F00D 087A F0               		dc.b $F0, $D, 8, $7A, $F0
0089C1B6 000D 107A F0               		dc.b 0,	$D, $10, $7A, $F0
0089C1BB 02                         @fuzzy6:	dc.b 2
0089C1BC F406 1082 F4               		dc.b $F4, 6, $10, $82, $F4
0089C1C1 F402 0882 04               		dc.b $F4, 2, 8,	$82, 4
0089C1C6 00                         @blank:		dc.b 0
0089C1C8 00                         		even
0089C1C8 00                         		even
0089C1C8                            
0089C1C8                            		include	"_incObj\3E Prison Capsule.asm"
0089C1C8                            ; ---------------------------------------------------------------------------
0089C1C8                            ; Object 3E - prison capsule
0089C1C8                            ; ---------------------------------------------------------------------------
0089C1C8                            
0089C1C8                            Prison:					; XREF: Obj_Index
0089C1C8 7000                       		moveq	#0,d0
0089C1CA 1028 0024                  		move.b	obRoutine(a0),d0
0089C1CE 323B 0000                  		move.w	Pri_Index(pc,d0.w),d1
0089C1D2 4EBB 1000                  		jsr	Pri_Index(pc,d1.w)
0089C1F2 4EF9 0088 E3CC             		jmp	DisplaySprite
0089C1F8                            
0089C1F8                            	@delete:
0089C1F8 4EF9 0088 E408             		jmp	DeleteObject
0089C1FE                            ; ===========================================================================
0089C1FE 0000                       Pri_Index:	dc.w Pri_Main-Pri_Index
0089C200 0000                       		dc.w Pri_BodyMain-Pri_Index
0089C202 0000                       		dc.w Pri_Switched-Pri_Index
0089C204 0000                       		dc.w Pri_Explosion-Pri_Index
0089C206 0000                       		dc.w Pri_Explosion-Pri_Index
0089C208 0000                       		dc.w Pri_Explosion-Pri_Index
0089C20A 0000                       		dc.w Pri_Animals-Pri_Index
0089C20C 0000                       		dc.w Pri_EndAct-Pri_Index
0089C20E                            
0089C20E =00000030                  pri_origY:	= $30		; original y-axis position
0089C20E                            
0089C20E 0220 0400                  Pri_Var:	dc.b 2,	$20, 4,	0	; routine, width, priority, frame
0089C212 040C 0501                  		dc.b 4,	$C, 5, 1
0089C216 0610 0403                  		dc.b 6,	$10, 4,	3
0089C21A 0810 0305                  		dc.b 8,	$10, 3,	5
0089C21E                            ; ===========================================================================
0089C21E                            
0089C21E                            Pri_Main:	; Routine 0
0089C21E 217C 0000 0000 0004        		move.l	#Map_Pri,obMap(a0)
0089C226 317C 049D 0002             		move.w	#$49D,obGfx(a0)
0089C22C 117C 0004 0001             		move.b	#4,obRender(a0)
0089C232 3168 000C 0030             		move.w	obY(a0),pri_origY(a0)
0089C238 7000                       		moveq	#0,d0
0089C23A 1028 0028                  		move.b	obSubtype(a0),d0
0089C23E E548                       		lsl.w	#2,d0
0089C240 43FB 00CC                  		lea	Pri_Var(pc,d0.w),a1
0089C244 1159 0024                  		move.b	(a1)+,obRoutine(a0)
0089C248 1159 0019                  		move.b	(a1)+,obActWid(a0)
0089C24C 1159 0018                  		move.b	(a1)+,obPriority(a0)
0089C250 1159 001A                  		move.b	(a1)+,obFrame(a0)
0089C254 0C40 0008                  		cmpi.w	#8,d0		; is object type number	02?
0089C258 6600                       		bne.s	@not02		; if not, branch
0089C25A                            
0089C25A 117C 0006 0020             		move.b	#6,obColType(a0)
0089C260 117C 0008 0021             		move.b	#8,obColProp(a0)
0089C266                            
0089C266                            	@not02:
0089C266 4E75                       		rts	
0089C268                            ; ===========================================================================
0089C268                            
0089C268                            Pri_BodyMain:	; Routine 2
0089C268 0C38 0002 F7A7             		cmpi.b	#2,(v_bossstatus).w
0089C26E 6700                       		beq.s	@chkopened
0089C270 323C 002B                  		move.w	#$2B,d1
0089C274 343C 0018                  		move.w	#$18,d2
0089C278 363C 0018                  		move.w	#$18,d3
0089C27C 3828 0008                  		move.w	obX(a0),d4
0089C280 4EF9 0089 07B6             		jmp	SolidObject
0089C286                            ; ===========================================================================
0089C286                            
0089C286                            @chkopened:
0089C286 4A28 0025                  		tst.b	ob2ndRout(a0)	; has the prison been opened?
0089C28A 6700                       		beq.s	@open		; if yes, branch
0089C28C 4228 0025                  		clr.b	ob2ndRout(a0)
0089C290 08B8 0003 D022             		bclr	#3,(v_player+obStatus).w
0089C296 08F8 0001 D022             		bset	#1,(v_player+obStatus).w
0089C29C                            
0089C29C                            	@open:
0089C29C 117C 0002 001A             		move.b	#2,obFrame(a0)	; use frame number 2 (destroyed	prison)
0089C2A2 4E75                       		rts	
0089C2A4                            ; ===========================================================================
0089C2A4                            
0089C2A4                            Pri_Switched:	; Routine 4
0089C2A4 323C 0017                  		move.w	#$17,d1
0089C2A8 343C 0008                  		move.w	#8,d2
0089C2AC 363C 0008                  		move.w	#8,d3
0089C2B0 3828 0008                  		move.w	obX(a0),d4
0089C2B4 4EB9 0089 07B6             		jsr	SolidObject
0089C2BA 43F9 0000 0000             		lea	(Ani_Pri).l,a1
0089C2C0 4EB9 0088 B4B0             		jsr	AnimateSprite
0089C2C6 3168 0030 000C             		move.w	pri_origY(a0),obY(a0)
0089C2CC 4A28 0025                  		tst.b	ob2ndRout(a0)	; has prison already been opened?
0089C2D0 6700                       		beq.s	@open2		; if yes, branch
0089C2D2                            
0089C2D2 5068 000C                  		addq.w	#8,obY(a0)
0089C2D6 117C 000A 0024             		move.b	#$A,obRoutine(a0)
0089C2DC 317C 003C 001E             		move.w	#60,obTimeFrame(a0) ; set time between animal spawns
0089C2E2 4238 FE1E                  		clr.b	(f_timecount).w	; stop time counter
0089C2E6 4238 F7AA                  		clr.b	(f_lockscreen).w ; lock screen position
0089C2EA 11FC 0001 F7CC             		move.b	#1,(f_lockctrl).w ; lock controls
0089C2F0 31FC 0800 F602             		move.w	#(btnR<<8),(v_jpadhold2).w ; make Sonic run to the right
0089C2F6 4228 0025                  		clr.b	ob2ndRout(a0)
0089C2FA 08B8 0003 D022             		bclr	#3,(v_player+obStatus).w
0089C300 08F8 0001 D022             		bset	#1,(v_player+obStatus).w
0089C306                            
0089C306                            	@open2:
0089C306 4E75                       		rts	
0089C308                            ; ===========================================================================
0089C308                            
0089C308                            Pri_Explosion:	; Routine 6, 8, $A
0089C308 7007                       		moveq	#7,d0
0089C30A C038 FE0F                  		and.b	(v_vbla_byte).w,d0
0089C30E 6600                       		bne.s	@noexplosion
0089C310 4EB9 0088 E862             		jsr	FindFreeObj
0089C316 6600                       		bne.s	@noexplosion
0089C318 137C 003F 0000             		move.b	#id_ExplosionBomb,0(a1) ; load explosion object
0089C31E 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089C324 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089C32A 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089C330 7200                       		moveq	#0,d1
0089C332 1200                       		move.b	d0,d1
0089C334 E409                       		lsr.b	#2,d1
0089C336 0441 0020                  		subi.w	#$20,d1
0089C33A D369 0008                  		add.w	d1,obX(a1)
0089C33E E048                       		lsr.w	#8,d0
0089C340 E608                       		lsr.b	#3,d0
0089C342 D169 000C                  		add.w	d0,obY(a1)
0089C346                            
0089C346                            	@noexplosion:
0089C346 5368 001E                  		subq.w	#1,obTimeFrame(a0)
0089C34A 6700                       		beq.s	@makeanimal
0089C34C 4E75                       		rts	
0089C34E                            ; ===========================================================================
0089C34E                            
0089C34E                            @makeanimal:
0089C34E 11FC 0002 F7A7             		move.b	#2,(v_bossstatus).w
0089C354 117C 000C 0024             		move.b	#$C,obRoutine(a0)	; replace explosions with animals
0089C35A 117C 0006 001A             		move.b	#6,obFrame(a0)
0089C360 317C 0096 001E             		move.w	#150,obTimeFrame(a0)
0089C366 0668 0020 000C             		addi.w	#$20,obY(a0)
0089C36C 7C07                       		moveq	#7,d6
0089C36E 3A3C 009A                  		move.w	#$9A,d5
0089C372 78E4                       		moveq	#-$1C,d4
0089C374                            
0089C374                            	@loop:
0089C374 4EB9 0088 E862             		jsr	FindFreeObj
0089C37A 6600                       		bne.s	@fail
0089C37C 137C 0028 0000             		move.b	#id_Animals,0(a1) ; load animal object
0089C382 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089C388 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089C38E D969 0008                  		add.w	d4,obX(a1)
0089C392 5E44                       		addq.w	#7,d4
0089C394 3345 0036                  		move.w	d5,$36(a1)
0089C398 5145                       		subq.w	#8,d5
0089C39A 51CE FFD8                  		dbf	d6,@loop	; repeat 7 more	times
0089C39E                            
0089C39E                            	@fail:
0089C39E 4E75                       		rts	
0089C3A0                            ; ===========================================================================
0089C3A0                            
0089C3A0                            Pri_Animals:	; Routine $C
0089C3A0 7007                       		moveq	#7,d0
0089C3A2 C038 FE0F                  		and.b	(v_vbla_byte).w,d0
0089C3A6 6600                       		bne.s	@noanimal
0089C3A8 4EB9 0088 E862             		jsr	FindFreeObj
0089C3AE 6600                       		bne.s	@noanimal
0089C3B0 137C 0028 0000             		move.b	#id_Animals,0(a1) ; load animal object
0089C3B6 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089C3BC 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089C3C2 4EB9 0088 2FF6             		jsr	(RandomNumber).l
0089C3C8 0240 001F                  		andi.w	#$1F,d0
0089C3CC 5D40                       		subq.w	#6,d0
0089C3CE 4A41                       		tst.w	d1
0089C3D0 6A00                       		bpl.s	@ispositive
0089C3D2 4440                       		neg.w	d0
0089C3D4                            
0089C3D4                            	@ispositive:
0089C3D4 D169 0008                  		add.w	d0,obX(a1)
0089C3D8 337C 000C 0036             		move.w	#$C,$36(a1)
0089C3DE                            
0089C3DE                            	@noanimal:
0089C3DE 5368 001E                  		subq.w	#1,obTimeFrame(a0)
0089C3E2 6600                       		bne.s	@wait
0089C3E4 5428 0024                  		addq.b	#2,obRoutine(a0)
0089C3E8 317C 00B4 001E             		move.w	#180,obTimeFrame(a0)
0089C3EE                            
0089C3EE                            	@wait:
0089C3EE 4E75                       		rts	
0089C3F0                            ; ===========================================================================
0089C3F0                            
0089C3F0                            Pri_EndAct:	; Routine $E
0089C3F0 703E                       		moveq	#$3E,d0
0089C3F2 7228                       		moveq	#id_Animals,d1
0089C3F4 7440                       		moveq	#$40,d2
0089C3F6 43F8 D040                  		lea	(v_objspace+$40).w,a1 ; load object RAM
0089C3FA                            
0089C3FA                            	@findanimal:
0089C3FA B211                       		cmp.b	(a1),d1		; is object $28	(animal) loaded?
0089C3FC 6700                       		beq.s	@found		; if yes, branch
0089C3FE D2C2                       		adda.w	d2,a1		; next object RAM
0089C400 51C8 FFF8                  		dbf	d0,@findanimal	; repeat $3E times
0089C404                            
0089C404 4EB9 0088 FA6A             		jsr	GotThroughAct
0089C40A 4EF9 0088 E408             		jmp	DeleteObject
0089C410                            
0089C410                            	@found:
0089C410 4E75                       		rts	
0089C410 4E75                       		rts	
0089C412                            		include	"_anim\Prison Capsule.asm"
0089C412                            ; ---------------------------------------------------------------------------
0089C412                            ; Animation script - prison capsule
0089C412                            ; ---------------------------------------------------------------------------
0089C412 0000                       Ani_Pri:	dc.w @switchflash-Ani_Pri
0089C414 0000                       		dc.w @switchflash-Ani_Pri
0089C416 0201 03FF                  @switchflash:	dc.b 2,	1, 3, afEnd
0089C41A                            		even
0089C41A                            		even
0089C41A                            		include	"_maps\Prison Capsule.asm"
0089C41A                            ; ---------------------------------------------------------------------------
0089C41A                            ; Sprite mappings - prison capsule
0089C41A                            ; ---------------------------------------------------------------------------
0089C41A 0000 0000                  Map_Pri:	dc.w @capsule-Map_Pri, @switch1-Map_Pri
0089C41E 0000 0000                  		dc.w @broken-Map_Pri, @switch2-Map_Pri
0089C422 0000 0000                  		dc.w @unusedthing1-Map_Pri, @unusedthing2-Map_Pri
0089C426 0000                       		dc.w @blank-Map_Pri
0089C428 07                         @capsule:	dc.b 7
0089C429 E00C 2000 F0               		dc.b $E0, $C, $20, 0, $F0
0089C42E E80D 2004 E0               		dc.b $E8, $D, $20, 4, $E0
0089C433 E80D 200C 00               		dc.b $E8, $D, $20, $C, 0
0089C438 F80E 2014 E0               		dc.b $F8, $E, $20, $14,	$E0
0089C43D F80E 2020 00               		dc.b $F8, $E, $20, $20,	0
0089C442 100D 202C E0               		dc.b $10, $D, $20, $2C,	$E0
0089C447 100D 2034 00               		dc.b $10, $D, $20, $34,	0
0089C44C 01                         @switch1:	dc.b 1
0089C44D F809 003C F4               		dc.b $F8, 9, 0,	$3C, $F4
0089C452 06                         @broken:	dc.b 6
0089C453 0008 2042 E0               		dc.b 0,	8, $20,	$42, $E0
0089C458 080C 2045 E0               		dc.b 8,	$C, $20, $45, $E0
0089C45D 0004 2049 10               		dc.b 0,	4, $20,	$49, $10
0089C462 080C 204B 00               		dc.b 8,	$C, $20, $4B, 0
0089C467 100D 202C E0               		dc.b $10, $D, $20, $2C,	$E0
0089C46C 100D 2034 00               		dc.b $10, $D, $20, $34,	0
0089C471 01                         @switch2:	dc.b 1
0089C472 F809 004F F4               		dc.b $F8, 9, 0,	$4F, $F4
0089C477 02                         @unusedthing1:	dc.b 2
0089C478 E80E 2055 F0               		dc.b $E8, $E, $20, $55,	$F0
0089C47D 000E 2061 F0               		dc.b 0,	$E, $20, $61, $F0
0089C482 01                         @unusedthing2:	dc.b 1
0089C483 F007 206D F8               		dc.b $F0, 7, $20, $6D, $F8
0089C488 00                         @blank:		dc.b 0
0089C48A 00                         		even
0089C48A 00                         		even
0089C48A                            
0089C48A                            		include	"_incObj\sub ReactToItem.asm"
0089C48A                            ; ---------------------------------------------------------------------------
0089C48A                            ; Subroutine to react to obColType(a0)
0089C48A                            ; ---------------------------------------------------------------------------
0089C48A                            
0089C48A                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C48A                            
0089C48A                            
0089C48A                            ReactToItem:				; XREF: SonicPlayer
0089C48A 4E71                       		nop	
0089C48C 3428 0008                  		move.w	obX(a0),d2	; load Sonic's x-axis position
0089C490 3628 000C                  		move.w	obY(a0),d3	; load Sonic's y-axis position
0089C494 5142                       		subq.w	#8,d2
0089C496 7A00                       		moveq	#0,d5
0089C498 1A28 0016                  		move.b	obHeight(a0),d5	; load Sonic's height
0089C49C 5705                       		subq.b	#3,d5
0089C49E 9645                       		sub.w	d5,d3
0089C4A0                            		
0089C4A0                            	;Mercury Ducking Size Fix
0089C4A0                            	
0089C4A0 0C28 0020 001C             		cmpi.b	#id_SpinDash,obAnim(a0)
0089C4A6 6700                       		beq.s	@short
0089C4A8                            	
0089C4A8 0C28 0008 001C             		cmpi.b	#id_Duck,obAnim(a0)
0089C4AE 6600                       		bne.s	@notducking
0089C4B0                            		
0089C4B0                            	@short:
0089C4B0 0643 000C                  		addi.w	#$C,d3
0089C4B4 7A0A                       		moveq	#$A,d5
0089C4B6                            		
0089C4B6                            	@notducking:
0089C4B6                            	;end Ducking Size Fix
0089C4B6 383C 0010                  		move.w	#$10,d4
0089C4BA DA45                       		add.w	d5,d5
0089C4BC 43F8 D800                  		lea	(v_lvlobjspace).w,a1 ; set object RAM start address
0089C4C0 3C3C 005F                  		move.w	#$5F,d6
0089C4C4                            
0089C4C4                            @loop:
0089C4C4 4A29 0001                  		tst.b	obRender(a1)
0089C4C8 6A00                       		bpl.s	@next
0089C4CA 1029 0020                  		move.b	obColType(a1),d0 ; load collision type
0089C4CE 6600                       		bne.s	@proximity	; if nonzero, branch
0089C4D0                            
0089C4D0                            	@next:
0089C4D0 43E9 0040                  		lea	$40(a1),a1	; next object RAM
0089C4D4 51CE FFEE                  		dbf	d6,@loop	; repeat $5F more times
0089C4D8                            
0089C4D8 7000                       		moveq	#0,d0
0089C4DA 4E75                       		rts	
0089C4DC                            ; ===========================================================================
0089C4DC                            @sizes:		;   width, height
0089C4DC 1414                       		dc.b  $14, $14		; $01
0089C4DE 0C14                       		dc.b   $C, $14		; $02
0089C4E0 140C                       		dc.b  $14,  $C		; $03
0089C4E2 0410                       		dc.b	4, $10		; $04
0089C4E4 0C12                       		dc.b   $C, $12		; $05
0089C4E6 1010                       		dc.b  $10, $10		; $06
0089C4E8 0606                       		dc.b	6,   6		; $07
0089C4EA 180C                       		dc.b  $18,  $C		; $08
0089C4EC 0C10                       		dc.b   $C, $10		; $09
0089C4EE 100C                       		dc.b  $10,  $C		; $0A
0089C4F0 0808                       		dc.b	8,   8		; $0B
0089C4F2 1410                       		dc.b  $14, $10		; $0C
0089C4F4 1408                       		dc.b  $14,   8		; $0D
0089C4F6 0E0E                       		dc.b   $E,  $E		; $0E
0089C4F8 1818                       		dc.b  $18, $18		; $0F
0089C4FA 2810                       		dc.b  $28, $10		; $10
0089C4FC 1018                       		dc.b  $10, $18		; $11
0089C4FE 0810                       		dc.b	8, $10		; $12
0089C500 2070                       		dc.b  $20, $70		; $13
0089C502 4020                       		dc.b  $40, $20		; $14
0089C504 8020                       		dc.b  $80, $20		; $15
0089C506 2020                       		dc.b  $20, $20		; $16
0089C508 0808                       		dc.b	8,   8		; $17
0089C50A 0404                       		dc.b	4,   4		; $18
0089C50C 2008                       		dc.b  $20,   8		; $19
0089C50E 0C0C                       		dc.b   $C,  $C		; $1A
0089C510 0804                       		dc.b	8,   4		; $1B
0089C512 1804                       		dc.b  $18,   4		; $1C
0089C514 2804                       		dc.b  $28,   4		; $1D
0089C516 0408                       		dc.b	4,   8		; $1E
0089C518 0418                       		dc.b	4, $18		; $1F
0089C51A 0428                       		dc.b	4, $28		; $20
0089C51C 0420                       		dc.b	4, $20		; $21
0089C51E 1818                       		dc.b  $18, $18		; $22
0089C520 0C18                       		dc.b   $C, $18		; $23
0089C522 4808                       		dc.b  $48,   8		; $24
0089C524                            ; ===========================================================================
0089C524                            
0089C524                            @proximity:
0089C524 0240 003F                  		andi.w	#$3F,d0
0089C528 D040                       		add.w	d0,d0
0089C52A 45FB 00AE                  		lea	@sizes-2(pc,d0.w),a2
0089C52E 7200                       		moveq	#0,d1
0089C530 121A                       		move.b	(a2)+,d1
0089C532 3029 0008                  		move.w	obX(a1),d0
0089C536 9041                       		sub.w	d1,d0
0089C538 9042                       		sub.w	d2,d0
0089C53A 6400                       		bcc.s	@outsidex	; branch if not touching
0089C53C D241                       		add.w	d1,d1
0089C53E D041                       		add.w	d1,d0
0089C540 6500                       		bcs.s	@withinx	; branch if touching
0089C542 6000 FF8C                  		bra.w	@next
0089C546                            ; ===========================================================================
0089C546                            
0089C546                            @outsidex:
0089C546 B044                       		cmp.w	d4,d0
0089C548 6200 FF86                  		bhi.w	@next
0089C54C                            
0089C54C                            @withinx:
0089C54C 7200                       		moveq	#0,d1
0089C54E 121A                       		move.b	(a2)+,d1
0089C550 3029 000C                  		move.w	obY(a1),d0
0089C554 9041                       		sub.w	d1,d0
0089C556 9043                       		sub.w	d3,d0
0089C558 6400                       		bcc.s	@outsidey	; branch if not touching
0089C55A D241                       		add.w	d1,d1
0089C55C D240                       		add.w	d0,d1
0089C55E 6500                       		bcs.s	@withiny	; branch if touching
0089C560 6000 FF6E                  		bra.w	@next
0089C564                            ; ===========================================================================
0089C564                            
0089C564                            @outsidey:
0089C564 B045                       		cmp.w	d5,d0
0089C566 6200 FF68                  		bhi.w	@next
0089C56A                            
0089C56A                            @withiny:
0089C56A                            	@chktype:
0089C56A 1229 0020                  		move.b	obColType(a1),d1 ; load collision type
0089C56E 0201 00C0                  		andi.b	#$C0,d1		; is obColType $40 or higher?
0089C572 6700 0000                  		beq.w	React_Enemy	; if not, branch
0089C576 0C01 00C0                  		cmpi.b	#$C0,d1		; is obColType $C0 or higher?
0089C57A 6700 0000                  		beq.w	React_Special	; if yes, branch
0089C57E 4A01                       		tst.b	d1		; is obColType $80-$BF?
0089C580 6B00 0000                  		bmi.w	React_ChkHurt	; if yes, branch
0089C584                            
0089C584                            ; obColType is $40-$7F (powerups)
0089C584                            
0089C584 1029 0020                  		move.b	obColType(a1),d0
0089C588 0200 003F                  		andi.b	#$3F,d0
0089C58C 0C00 0006                  		cmpi.b	#6,d0		; is collision type $46	?
0089C590 6700                       		beq.s	React_Monitor	; if yes, branch
0089C592 0C68 005A 0030             		cmpi.w	#90,obInvuln(a0)	; is Sonic blinking?
0089C598 6400 0000                  		bcc.w	@return			; if yes, branch
0089C59C 5429 0024                  		addq.b	#2,obRoutine(a1) ; advance the object's routine counter
0089C5A0                            
0089C5A0                            	@return:
0089C5A0 4E75                       		rts	
0089C5A2                            ; ===========================================================================
0089C5A2                            
0089C5A2                            React_Monitor:
0089C5A2 4A68 0012                  		tst.w	obVelY(a0)	; is Sonic moving upwards?
0089C5A6 6A00                       		bpl.s	@movingdown	; if not, branch
0089C5A8                            
0089C5A8 3028 000C                  		move.w	obY(a0),d0
0089C5AC 0440 0010                  		subi.w	#$10,d0
0089C5B0 B069 000C                  		cmp.w	obY(a1),d0
0089C5B4 6500                       		bcs.s	@donothing
0089C5B6 4468 0012                  		neg.w	obVelY(a0)	; reverse Sonic's vertical speed
0089C5BA 337C FE80 0012             		move.w	#-$180,obVelY(a1)
0089C5C0 4A29 0025                  		tst.b	ob2ndRout(a1)
0089C5C4 6600                       		bne.s	@donothing
0089C5C6 5829 0025                  		addq.b	#4,ob2ndRout(a1) ; advance the monitor's routine counter
0089C5CA 4E75                       		rts	
0089C5CC                            ; ===========================================================================
0089C5CC                            
0089C5CC                            @movingdown:
0089C5CC 0C28 0002 001C             		cmpi.b	#id_Roll,obAnim(a0) ; is Sonic rolling/jumping?
0089C5D2 6600                       		bne.s	@donothing
0089C5D4 4468 0012                  		neg.w	obVelY(a0)	; reverse Sonic's y-motion
0089C5D8                            		
0089C5D8 117C 0001 003C             		move.b	#1,obJumping(a0)
0089C5DE                            		
0089C5DE 5429 0024                  		addq.b	#2,obRoutine(a1) ; advance the monitor's routine counter
0089C5E2                            
0089C5E2                            	@donothing:
0089C5E2 4E75                       		rts	
0089C5E4                            ; ===========================================================================
0089C5E4                            
0089C5E4                            React_Enemy:
0089C5E4 4A38 FE2D                  		tst.b	(v_invinc).w	; is Sonic invincible?
0089C5E8 6600                       		bne.s	@donthurtsonic	; if yes, branch
0089C5EA                            		
0089C5EA 0C28 0020 001C             		cmpi.b	#id_SpinDash,obAnim(a0)	; is Sonic Spin Dashing?
0089C5F0 6700 0000                  		beq.w	@breakenemy	; if yes, branch
0089C5F4                            		
0089C5F4 0C28 0002 001C             		cmpi.b	#id_Roll,obAnim(a0) ; is Sonic rolling/jumping?
0089C5FA 6600 0000                  		bne.w	React_ChkHurt	; if not, branch
0089C5FE                            
0089C5FE                            	@donthurtsonic:
0089C5FE 4A29 0021                  		tst.b	obColProp(a1)
0089C602 6700                       		beq.s	@breakenemy
0089C604                            
0089C604 4468 0010                  		neg.w	obVelX(a0)	; repel Sonic
0089C608 4468 0012                  		neg.w	obVelY(a0)
0089C60C E0E8 0010                  		asr	obVelX(a0)
0089C610 E0E8 0012                  		asr	obVelY(a0)
0089C614 137C 0000 0020             		move.b	#0,obColType(a1)
0089C61A 5329 0021                  		subq.b	#1,obColProp(a1)
0089C61E 6600                       		bne.s	@flagnotclear
0089C620 08E9 0007 0022             		bset	#7,obStatus(a1)
0089C626                            
0089C626                            	@flagnotclear:
0089C626 4E75                       		rts	
0089C628                            ; ===========================================================================
0089C628                            
0089C628                            @breakenemy:
0089C628 08E9 0007 0022             		bset	#7,obStatus(a1)
0089C62E 7000                       		moveq	#0,d0
0089C630 3038 F7D0                  		move.w	(v_itembonus).w,d0
0089C634 5478 F7D0                  		addq.w	#2,(v_itembonus).w ; add 2 to item bonus counter
0089C638 0C40 0006                  		cmpi.w	#6,d0
0089C63C 6500                       		bcs.s	@bonusokay
0089C63E 7006                       		moveq	#6,d0		; max bonus is lvl6
0089C640                            
0089C640                            	@bonusokay:
0089C640 3340 003E                  		move.w	d0,$3E(a1)
0089C644 303B 0000                  		move.w	@points(pc,d0.w),d0
0089C648 0C78 0020 F7D0             		cmpi.w	#$20,(v_itembonus).w ; have 16 enemies been destroyed?
0089C64E 6500                       		bcs.s	@lessthan16	; if not, branch
0089C650 303C 03E8                  		move.w	#1000,d0	; fix bonus to 10000
0089C654 337C 000A 003E             		move.w	#$A,$3E(a1)
0089C65A                            
0089C65A                            	@lessthan16:
0089C65A 6100 0000                  		bsr.w	AddPoints
0089C65E 137C 0027 0000             		move.b	#id_ExplosionItem,0(a1) ; change object to explosion
0089C664 137C 0000 0024             		move.b	#0,obRoutine(a1)
0089C66A 4A68 0012                  		tst.w	obVelY(a0)
0089C66E 6B00                       		bmi.s	@bouncedown
0089C670 3028 000C                  		move.w	obY(a0),d0
0089C674 B069 000C                  		cmp.w	obY(a1),d0
0089C678 6400                       		bcc.s	@bounceup
0089C67A 4468 0012                  		neg.w	obVelY(a0)
0089C67E                            		
0089C67E 117C 0001 003C             		move.b	#1,obJumping(a0)
0089C684                            		
0089C684 4E75                       		rts	
0089C686                            ; ===========================================================================
0089C686                            
0089C686                            	@bouncedown:
0089C686 0668 0100 0012             		addi.w	#$100,obVelY(a0)
0089C68C 4E75                       		rts	
0089C68E                            
0089C68E                            	@bounceup:
0089C68E 0468 0100 0012             		subi.w	#$100,obVelY(a0)
0089C694 4E75                       		rts	
0089C696                            
0089C696 000A 0014 0032 0064        @points:	dc.w 10, 20, 50, 100	; points awarded div 10
0089C69E                            
0089C69E                            ; ===========================================================================
0089C69E                            
0089C69E                            React_Caterkiller:
0089C69E                            
0089C69E 103C 0001                  		move.b	#1,d0
0089C6A2 3228 0014                  		move.w	obInertia(a0),d1
0089C6A6 6B00                       		bmi.s	@skip
0089C6A8 103C 0000                  		move.b	#0,d0
0089C6AC                            		
0089C6AC                            	@skip:
0089C6AC 1229 0022                  		move.b	obStatus(a1),d1
0089C6B0 0201 0001                  		andi.b	#1,d1
0089C6B4 B200                       		cmp.b	d0,d1			;are Sonic and the Caterkiller facing the same way?
0089C6B6 6600                       		bne.s	@hurt			;if not, move on
0089C6B8 0828 0001 0022             		btst	#staAir,obStatus(a0)	;is Sonic in the air?	;Mercury Constants
0089C6BE 6600                       		bne.s	@hurt			;if so, move on
0089C6C0 0828 0002 0022             		btst	#staSpin,obStatus(a0)	;is Sonic spinning?	;Mercury Constants
0089C6C6 6700                       		beq.s	@hurt			;if not, move on
0089C6C8 70FF                       		moveq	#-1,d0			;else, he's rolling on the ground, and shouldn't be hurt
0089C6CA 4E75                       		rts				
0089C6CC                            	
0089C6CC                            	@hurt:
0089C6CC                            
0089C6CC 08E9 0007 0022             		bset	#7,obStatus(a1)
0089C6D2                            
0089C6D2                            React_ChkHurt:
0089C6D2 4A38 FE2D                  		tst.b	(v_invinc).w	; is Sonic invincible?
0089C6D6 6700                       		beq.s	@notinvincible	; if not, branch
0089C6D8                            
0089C6D8                            	@isflashing:
0089C6D8 70FF                       		moveq	#-1,d0
0089C6DA 4E75                       		rts	
0089C6DC                            ; ===========================================================================
0089C6DC                            
0089C6DC                            	@notinvincible:
0089C6DC 4E71                       		nop	
0089C6DE 4A68 0030                  		tst.w	$30(a0)		; is Sonic flashing?
0089C6E2 66F4                       		bne.s	@isflashing	; if yes, branch
0089C6E4 2449                       		movea.l	a1,a2
0089C6E6                            
0089C6E6                            ; End of function ReactToItem
0089C6E6                            ; continue straight to HurtSonic
0089C6E6                            
0089C6E6                            ; ---------------------------------------------------------------------------
0089C6E6                            ; Hurting Sonic	subroutine
0089C6E6                            ; ---------------------------------------------------------------------------
0089C6E6                            
0089C6E6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C6E6                            
0089C6E6                            
0089C6E6                            HurtSonic:
0089C6E6 4A38 FE2C                  		tst.b	(v_shield).w	; does Sonic have a shield?
0089C6EA 6600                       		bne.s	@hasshield	; if yes, branch
0089C6EC 4A78 FE20                  		tst.w	(v_rings).w	; does Sonic have any rings?
0089C6F0 6700 0000                  		beq.w	@norings	; if not, branch
0089C6F4                            
0089C6F4 4EB9 0088 E862             		jsr	FindFreeObj
0089C6FA 6600                       		bne.s	@hasshield
0089C6FC 137C 0037 0000             		move.b	#id_RingLoss,0(a1) ; load bouncing multi rings object
0089C702 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089C708 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089C70E                            
0089C70E                            	@hasshield:
0089C70E 11FC 0000 FE2C             		move.b	#0,(v_shield).w	; remove shield
0089C714 117C 0004 0024             		move.b	#4,obRoutine(a0)
0089C71A 6100 84F8                  		bsr.w	Sonic_ResetOnFloor
0089C71E 08E8 0001 0022             		bset	#1,obStatus(a0)
0089C724 317C FC00 0012             		move.w	#-$400,obVelY(a0) ; make Sonic bounce away from the object
0089C72A 317C FE00 0010             		move.w	#-$200,obVelX(a0)
0089C730 0828 0006 0022             		btst	#6,obStatus(a0)	; is Sonic underwater?
0089C736 6700                       		beq.s	@isdry		; if not, branch
0089C738                            
0089C738 317C FE00 0012             		move.w	#-$200,obVelY(a0) ; slower bounce
0089C73E 317C FF00 0010             		move.w	#-$100,obVelX(a0)
0089C744                            
0089C744                            	@isdry:
0089C744 3028 0008                  		move.w	obX(a0),d0
0089C748 B06A 0008                  		cmp.w	obX(a2),d0
0089C74C 6500                       		bcs.s	@isleft		; if Sonic is left of the object, branch
0089C74E 4468 0010                  		neg.w	obVelX(a0)	; if Sonic is right of the object, reverse
0089C752                            
0089C752                            	@isleft:
0089C752                            	
0089C752 08A8 0001 0039             		bclr	#staDash,obStatus2(a0)	; clear Dash flag
0089C758                            	
0089C758 08A8 0000 0039             		bclr	#staSpinDash,obStatus2(a0)	; clear Spin Dash flag
0089C75E                            	
0089C75E 317C 0000 0014             		move.w	#0,obInertia(a0)
0089C764 117C 001A 001C             		move.b	#id_Hurt,obAnim(a0)
0089C76A 317C 0078 0032             		move.w	#120,obInvinc(a0)	; set temp invincible time to 2 seconds	;Mercury Constants
0089C770 303C 0035                  		move.w	#sfx_Death,d0	; load normal damage sound
0089C774 0C12 0036                  		cmpi.b	#id_Spikes,(a2)	; was damage caused by spikes?
0089C778                            		
0089C778 6700                       		beq.s	@setspikesound	; if so, branch
0089C77A 0C12 0016                  		cmpi.b	#id_Harpoon,(a2) ; was damage caused by LZ harpoon?
0089C77E 6600                       		bne.s	@sound		; if not, branch
0089C780                            
0089C780                            	@setspikesound:
0089C780                            		
0089C780 303C 0037                  		move.w	#sfx_HitSpikes,d0 ; load spikes damage sound
0089C784                            
0089C784                            	@sound:
0089C784 4EB9 0088 187C             		jsr	(PlaySound_Special).l
0089C78A 70FF                       		moveq	#-1,d0
0089C78C 4E75                       		rts	
0089C78E                            ; ===========================================================================
0089C78E                            
0089C78E                            @norings:
0089C78E 4A78 FFFA                  		tst.w	(f_debugmode).w	; is debug mode	cheat on?
0089C792 6600 FF7A                  		bne.w	@hasshield	; if yes, branch
0089C796                            
0089C796                            ; ---------------------------------------------------------------------------
0089C796                            ; Subroutine to	kill Sonic
0089C796                            ; ---------------------------------------------------------------------------
0089C796                            
0089C796                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C796                            
0089C796                            
0089C796                            KillSonic:
0089C796 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	active?
0089C79A                            		
0089C79A                            		
0089C79A 6600                       		bne.s	@dontdie	; if yes, branch
0089C79C                            		
0089C79C 11FC 0000 FE2D             		move.b	#0,(v_invinc).w	; remove invincibility
0089C7A2 117C 0006 0024             		move.b	#6,obRoutine(a0)
0089C7A8 6100 846A                  		bsr.w	Sonic_ResetOnFloor
0089C7AC 08E8 0001 0022             		bset	#staAir,obStatus(a0)	;Mercury Constants
0089C7B2 317C F900 0012             		move.w	#-$700,obVelY(a0)
0089C7B8 317C 0000 0010             		move.w	#0,obVelX(a0)
0089C7BE 317C 0000 0014             		move.w	#0,obInertia(a0)
0089C7C4                            		
0089C7C4                            		
0089C7C4 117C 0018 001C             		move.b	#id_Death,obAnim(a0)
0089C7CA 08E8 0007 0002             		bset	#7,obGfx(a0)
0089C7D0 303C 0035                  		move.w	#sfx_Death,d0	; play normal death sound
0089C7D4 0C12 0036                  		cmpi.b	#id_Spikes,(a2)	; check	if you were killed by spikes
0089C7D8 6600                       		bne.s	@sound
0089C7DA 303C 0037                  		move.w	#sfx_HitSpikes,d0 ; play spikes death sound
0089C7DE                            
0089C7DE                            	@sound:
0089C7DE 4EB9 0088 187C             		jsr	(PlaySound_Special).l
0089C7E4                            
0089C7E4                            	@dontdie:
0089C7E4 70FF                       		moveq	#-1,d0
0089C7E6 4E75                       		rts	
0089C7E8                            ; End of function KillSonic
0089C7E8                            
0089C7E8                            
0089C7E8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C7E8                            
0089C7E8                            
0089C7E8                            React_Special:
0089C7E8 1229 0020                  		move.b	obColType(a1),d1
0089C7EC 0201 003F                  		andi.b	#$3F,d1
0089C7F0 0C01 000B                  		cmpi.b	#$B,d1		; is collision type $CB	?
0089C7F4 6700                       		beq.s	@caterkiller	; if yes, branch
0089C7F6 0C01 000C                  		cmpi.b	#$C,d1		; is collision type $CC	?
0089C7FA 6700                       		beq.s	@yadrin		; if yes, branch
0089C7FC 0C01 0017                  		cmpi.b	#$17,d1		; is collision type $D7	?
0089C800 6700                       		beq.s	@D7orE1		; if yes, branch
0089C802 0C01 0021                  		cmpi.b	#$21,d1		; is collision type $E1	?
0089C806 6700                       		beq.s	@D7orE1		; if yes, branch
0089C808 4E75                       		rts	
0089C80A                            ; ===========================================================================
0089C80A                            
0089C80A                            @caterkiller:
0089C80A 6000 FE92                  		bra.w	React_Caterkiller
0089C80E                            ; ===========================================================================
0089C80E                            
0089C80E                            @yadrin:
0089C80E 9A40                       		sub.w	d0,d5
0089C810 0C45 0008                  		cmpi.w	#8,d5
0089C814 6400                       		bcc.s	@normalenemy
0089C816 3029 0008                  		move.w	obX(a1),d0
0089C81A 5940                       		subq.w	#4,d0
0089C81C 0829 0000 0022             		btst	#0,obStatus(a1)
0089C822 6700                       		beq.s	@noflip
0089C824 0440 0010                  		subi.w	#$10,d0
0089C828                            
0089C828                            	@noflip:
0089C828 9042                       		sub.w	d2,d0
0089C82A 6400                       		bcc.s	@loc_1B13C
0089C82C 0640 0018                  		addi.w	#$18,d0
0089C830 6500                       		bcs.s	@loc_1B140
0089C832 6000                       		bra.s	@normalenemy
0089C834                            ; ===========================================================================
0089C834                            
0089C834                            	@loc_1B13C:
0089C834 B044                       		cmp.w	d4,d0
0089C836 6200                       		bhi.s	@normalenemy
0089C838                            
0089C838                            	@loc_1B140:
0089C838 6000 FE98                  		bra.w	React_ChkHurt
0089C83C                            ; ===========================================================================
0089C83C                            
0089C83C                            	@normalenemy:
0089C83C 6000 FDA6                  		bra.w	React_Enemy
0089C840                            ; ===========================================================================
0089C840                            
0089C840                            @D7orE1:
0089C840 5229 0021                  		addq.b	#1,obColProp(a1)
0089C844 4E75                       		rts	
0089C846                            ; End of function React_Special
0089C846                            ; End of function React_Special
0089C846                            
0089C846                            ; ---------------------------------------------------------------------------
0089C846                            ; Subroutine to	show the special stage layout
0089C846                            ; ---------------------------------------------------------------------------
0089C846                            
0089C846                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C846                            
0089C846                            
0089C846                            SS_ShowLayout:				; XREF: GM_Special
0089C846 6100 0000                  		bsr.w	SS_AniWallsRings
0089C84A 6100 0000                  		bsr.w	SS_AniItems
0089C84E 3F05                       		move.w	d5,-(sp)
0089C850 43F8 8000                  		lea	($FFFF8000).w,a1
0089C854 1038 F780                  		move.b	(v_ssangle).w,d0
0089C858                            		;andi.b	#$FC,d0				; Yes, it's this easy
0089C858 4EB9 0088 301C             		jsr	(CalcSine).l
0089C85E 3800                       		move.w	d0,d4
0089C860 3A01                       		move.w	d1,d5
0089C862 C9FC 0018                  		muls.w	#$18,d4
0089C866 CBFC 0018                  		muls.w	#$18,d5
0089C86A 7400                       		moveq	#0,d2
0089C86C 3438 F700                  		move.w	(v_screenposx).w,d2
0089C870 84FC 0018                  		divu.w	#$18,d2
0089C874 4842                       		swap	d2
0089C876 4442                       		neg.w	d2
0089C878 0642 FF4C                  		addi.w	#-$B4,d2
0089C87C 7600                       		moveq	#0,d3
0089C87E 3638 F704                  		move.w	(v_screenposy).w,d3
0089C882 86FC 0018                  		divu.w	#$18,d3
0089C886 4843                       		swap	d3
0089C888 4443                       		neg.w	d3
0089C88A 0643 FF4C                  		addi.w	#-$B4,d3
0089C88E 3E3C 000F                  		move.w	#$F,d7
0089C892                            
0089C892                            loc_1B19E:
0089C892 48A7 E000                  		movem.w	d0-d2,-(sp)
0089C896 48A7 C000                  		movem.w	d0-d1,-(sp)
0089C89A 4440                       		neg.w	d0
0089C89C C3C2                       		muls.w	d2,d1
0089C89E C1C3                       		muls.w	d3,d0
0089C8A0 2C00                       		move.l	d0,d6
0089C8A2 DC81                       		add.l	d1,d6
0089C8A4 4C9F 0003                  		movem.w	(sp)+,d0-d1
0089C8A8 C1C2                       		muls.w	d2,d0
0089C8AA C3C3                       		muls.w	d3,d1
0089C8AC D280                       		add.l	d0,d1
0089C8AE 2406                       		move.l	d6,d2
0089C8B0 3C3C 000F                  		move.w	#$F,d6
0089C8B4                            
0089C8B4                            loc_1B1C0:
0089C8B4 2002                       		move.l	d2,d0
0089C8B6 E080                       		asr.l	#8,d0
0089C8B8 32C0                       		move.w	d0,(a1)+
0089C8BA 2001                       		move.l	d1,d0
0089C8BC E080                       		asr.l	#8,d0
0089C8BE 32C0                       		move.w	d0,(a1)+
0089C8C0 D485                       		add.l	d5,d2
0089C8C2 D284                       		add.l	d4,d1
0089C8C4 51CE FFEE                  		dbf	d6,loc_1B1C0
0089C8C8                            
0089C8C8 4C9F 0007                  		movem.w	(sp)+,d0-d2
0089C8CC 0643 0018                  		addi.w	#$18,d3
0089C8D0 51CF FFC0                  		dbf	d7,loc_1B19E
0089C8D4                            
0089C8D4 3A1F                       		move.w	(sp)+,d5
0089C8D6 41F9 00FF 0000             		lea	($FF0000).l,a0
0089C8DC 7000                       		moveq	#0,d0
0089C8DE 3038 F704                  		move.w	(v_screenposy).w,d0
0089C8E2 80FC 0018                  		divu.w	#$18,d0
0089C8E6 C0FC 0080                  		mulu.w	#$80,d0
0089C8EA D1C0                       		adda.l	d0,a0
0089C8EC 7000                       		moveq	#0,d0
0089C8EE 3038 F700                  		move.w	(v_screenposx).w,d0
0089C8F2 80FC 0018                  		divu.w	#$18,d0
0089C8F6 D0C0                       		adda.w	d0,a0
0089C8F8 49F8 8000                  		lea	($FFFF8000).w,a4
0089C8FC 3E3C 000F                  		move.w	#$F,d7
0089C900                            
0089C900                            loc_1B20C:
0089C900 3C3C 000F                  		move.w	#$F,d6
0089C904                            
0089C904                            loc_1B210:
0089C904 7000                       		moveq	#0,d0
0089C906 1018                       		move.b	(a0)+,d0
0089C908 6700                       		beq.s	loc_1B268
0089C90A 0C00 004E                  		cmpi.b	#$4E,d0
0089C90E 6200                       		bhi.s	loc_1B268
0089C910 3614                       		move.w	(a4),d3
0089C912 0643 0120                  		addi.w	#$120,d3
0089C916 0C43 0070                  		cmpi.w	#$70,d3
0089C91A 6500                       		bcs.s	loc_1B268
0089C91C 0C43 01D0                  		cmpi.w	#$1D0,d3
0089C920 6400                       		bcc.s	loc_1B268
0089C922 342C 0002                  		move.w	2(a4),d2
0089C926 0642 00F0                  		addi.w	#$F0,d2
0089C92A 0C42 0070                  		cmpi.w	#$70,d2
0089C92E 6500                       		bcs.s	loc_1B268
0089C930 0C42 0170                  		cmpi.w	#$170,d2
0089C934 6400                       		bcc.s	loc_1B268
0089C936 4BF9 00FF 4000             		lea	($FF4000).l,a5
0089C93C E748                       		lsl.w	#3,d0
0089C93E 4BF5 0000                  		lea	(a5,d0.w),a5
0089C942 225D                       		movea.l	(a5)+,a1
0089C944 321D                       		move.w	(a5)+,d1
0089C946 D241                       		add.w	d1,d1
0089C948 D2F1 1000                  		adda.w	(a1,d1.w),a1
0089C94C 365D                       		movea.w	(a5)+,a3
0089C94E 7200                       		moveq	#0,d1
0089C950 1219                       		move.b	(a1)+,d1
0089C952 5301                       		subq.b	#1,d1
0089C954 6B00                       		bmi.s	loc_1B268
0089C956 4EB9 0088 E52A             		jsr	sub_D762
0089C95C                            
0089C95C                            loc_1B268:
0089C95C 584C                       		addq.w	#4,a4
0089C95E 51CE FFA4                  		dbf	d6,loc_1B210
0089C962                            
0089C962 41E8 0070                  		lea	$70(a0),a0
0089C966 51CF FF98                  		dbf	d7,loc_1B20C
0089C96A                            
0089C96A 11C5 F62C                  		move.b	d5,(v_spritecount).w
0089C96E 0C05 0050                  		cmpi.b	#$50,d5
0089C972 6700                       		beq.s	loc_1B288
0089C974 24BC 0000 0000             		move.l	#0,(a2)
0089C97A 4E75                       		rts	
0089C97C                            ; ===========================================================================
0089C97C                            
0089C97C                            loc_1B288:
0089C97C 157C 0000 FFFB             		move.b	#0,-5(a2)
0089C982 4E75                       		rts	
0089C984                            ; End of function SS_ShowLayout
0089C984                            
0089C984                            ; ---------------------------------------------------------------------------
0089C984                            ; Subroutine to	animate	walls and rings	in the special stage
0089C984                            ; ---------------------------------------------------------------------------
0089C984                            
0089C984                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089C984                            
0089C984                            
0089C984                            SS_AniWallsRings:			; XREF: SS_ShowLayout
0089C984                            
0089C984 43F9 00FF 400C             		lea	($FF400C).l,a1
0089C98A 7000                       		moveq	#0,d0
0089C98C 1038 F780                  		move.b	(v_ssangle).w,d0
0089C990 E408                       		lsr.b	#2,d0
0089C992 0240 000F                  		andi.w	#$F,d0
0089C996 7223                       		moveq	#$23,d1
0089C998                            
0089C998                            loc_1B2A4:
0089C998 3280                       		move.w	d0,(a1)
0089C99A 5049                       		addq.w	#8,a1
0089C99C 51C9 FFFA                  		dbf	d1,loc_1B2A4
0089C9A0                            		
0089C9A0 43F9 00FF 4005             		lea	($FF4005).l,a1
0089C9A6 5338 FEC2                  		subq.b	#1,(v_ani1_time).w
0089C9AA 6A00                       		bpl.s	loc_1B2C8
0089C9AC 11FC 0007 FEC2             		move.b	#7,(v_ani1_time).w
0089C9B2 5238 FEC3                  		addq.b	#1,(v_ani1_frame).w
0089C9B6 0238 0003 FEC3             		andi.b	#3,(v_ani1_frame).w
0089C9BC                            
0089C9BC                            loc_1B2C8:
0089C9BC 1378 FEC3 01D0             		move.b	(v_ani1_frame).w,$1D0(a1)
0089C9C2 5338 FEC4                  		subq.b	#1,(v_ani2_time).w
0089C9C6 6A00                       		bpl.s	loc_1B2E4
0089C9C8 11FC 0007 FEC4             		move.b	#7,(v_ani2_time).w
0089C9CE 5238 FEC5                  		addq.b	#1,(v_ani2_frame).w
0089C9D2 0238 0001 FEC5             		andi.b	#1,(v_ani2_frame).w
0089C9D8                            
0089C9D8                            loc_1B2E4:
0089C9D8 1038 FEC5                  		move.b	(v_ani2_frame).w,d0
0089C9DC 1340 0138                  		move.b	d0,$138(a1)
0089C9E0 1340 0160                  		move.b	d0,$160(a1)
0089C9E4 1340 0148                  		move.b	d0,$148(a1)
0089C9E8 1340 0150                  		move.b	d0,$150(a1)
0089C9EC 1340 01D8                  		move.b	d0,$1D8(a1)
0089C9F0 1340 01E0                  		move.b	d0,$1E0(a1)
0089C9F4 1340 01E8                  		move.b	d0,$1E8(a1)
0089C9F8 1340 01F0                  		move.b	d0,$1F0(a1)
0089C9FC 1340 01F8                  		move.b	d0,$1F8(a1)
0089CA00 1340 0200                  		move.b	d0,$200(a1)
0089CA04 5338 FEC6                  		subq.b	#1,(v_ani3_time).w
0089CA08 6A00                       		bpl.s	loc_1B326
0089CA0A 11FC 0004 FEC6             		move.b	#4,(v_ani3_time).w
0089CA10 5238 FEC7                  		addq.b	#1,(v_ani3_frame).w
0089CA14 0238 0003 FEC7             		andi.b	#3,(v_ani3_frame).w
0089CA1A                            
0089CA1A                            loc_1B326:
0089CA1A 1038 FEC7                  		move.b	(v_ani3_frame).w,d0
0089CA1E 1340 0168                  		move.b	d0,$168(a1)
0089CA22 1340 0170                  		move.b	d0,$170(a1)
0089CA26 1340 0178                  		move.b	d0,$178(a1)
0089CA2A 1340 0180                  		move.b	d0,$180(a1)
0089CA2E 5338 FEC0                  		subq.b	#1,(v_ani0_time).w
0089CA32 6A00                       		bpl.s	loc_1B350
0089CA34 11FC 0007 FEC0             		move.b	#7,(v_ani0_time).w
0089CA3A 5338 FEC1                  		subq.b	#1,(v_ani0_frame).w
0089CA3E 0238 0007 FEC1             		andi.b	#7,(v_ani0_frame).w
0089CA44                            
0089CA44                            loc_1B350:
0089CA44 43F9 00FF 4016             		lea	($FF4016).l,a1
0089CA4A 41F9 0000 0000             		lea	(SS_WaRiVramSet).l,a0
0089CA50 7000                       		moveq	#0,d0
0089CA52 1038 FEC1                  		move.b	(v_ani0_frame).w,d0
0089CA56 D040                       		add.w	d0,d0
0089CA58 41F0 0000                  		lea	(a0,d0.w),a0
0089CA5C 3290                       		move.w	(a0),(a1)
0089CA5E 3368 0002 0008             		move.w	2(a0),8(a1)
0089CA64 3368 0004 0010             		move.w	4(a0),$10(a1)
0089CA6A 3368 0006 0018             		move.w	6(a0),$18(a1)
0089CA70 3368 0008 0020             		move.w	8(a0),$20(a1)
0089CA76 3368 000A 0028             		move.w	$A(a0),$28(a1)
0089CA7C 3368 000C 0030             		move.w	$C(a0),$30(a1)
0089CA82 3368 000E 0038             		move.w	$E(a0),$38(a1)
0089CA88 D0FC 0020                  		adda.w	#$20,a0
0089CA8C D2FC 0048                  		adda.w	#$48,a1
0089CA90 3290                       		move.w	(a0),(a1)
0089CA92 3368 0002 0008             		move.w	2(a0),8(a1)
0089CA98 3368 0004 0010             		move.w	4(a0),$10(a1)
0089CA9E 3368 0006 0018             		move.w	6(a0),$18(a1)
0089CAA4 3368 0008 0020             		move.w	8(a0),$20(a1)
0089CAAA 3368 000A 0028             		move.w	$A(a0),$28(a1)
0089CAB0 3368 000C 0030             		move.w	$C(a0),$30(a1)
0089CAB6 3368 000E 0038             		move.w	$E(a0),$38(a1)
0089CABC D0FC 0020                  		adda.w	#$20,a0
0089CAC0 D2FC 0048                  		adda.w	#$48,a1
0089CAC4 3290                       		move.w	(a0),(a1)
0089CAC6 3368 0002 0008             		move.w	2(a0),8(a1)
0089CACC 3368 0004 0010             		move.w	4(a0),$10(a1)
0089CAD2 3368 0006 0018             		move.w	6(a0),$18(a1)
0089CAD8 3368 0008 0020             		move.w	8(a0),$20(a1)
0089CADE 3368 000A 0028             		move.w	$A(a0),$28(a1)
0089CAE4 3368 000C 0030             		move.w	$C(a0),$30(a1)
0089CAEA 3368 000E 0038             		move.w	$E(a0),$38(a1)
0089CAF0 D0FC 0020                  		adda.w	#$20,a0
0089CAF4 D2FC 0048                  		adda.w	#$48,a1
0089CAF8 3290                       		move.w	(a0),(a1)
0089CAFA 3368 0002 0008             		move.w	2(a0),8(a1)
0089CB00 3368 0004 0010             		move.w	4(a0),$10(a1)
0089CB06 3368 0006 0018             		move.w	6(a0),$18(a1)
0089CB0C 3368 0008 0020             		move.w	8(a0),$20(a1)
0089CB12 3368 000A 0028             		move.w	$A(a0),$28(a1)
0089CB18 3368 000C 0030             		move.w	$C(a0),$30(a1)
0089CB1E 3368 000E 0038             		move.w	$E(a0),$38(a1)
0089CB24 D0FC 0020                  		adda.w	#$20,a0
0089CB28 D2FC 0048                  		adda.w	#$48,a1
0089CB2C 4E75                       		rts	
0089CB2E                            ; End of function SS_AniWallsRings
0089CB2E                            
0089CB2E                            
0089CB2E                            ; ===========================================================================
0089CB2E 0142 6142 0142 0142 0142+  SS_WaRiVramSet:	dc.w $142, $6142, $142,	$142, $142, $142, $142,	$6142
0089CB3E 0142 6142 0142 0142 0142+  		dc.w $142, $6142, $142,	$142, $142, $142, $142,	$6142
0089CB4E 2142 0142 2142 2142 2142+  		dc.w $2142, $142, $2142, $2142,	$2142, $2142, $2142, $142
0089CB5E 2142 0142 2142 2142 2142+  		dc.w $2142, $142, $2142, $2142,	$2142, $2142, $2142, $142
0089CB6E 4142 2142 4142 4142 4142+  		dc.w $4142, $2142, $4142, $4142, $4142,	$4142, $4142, $2142
0089CB7E 4142 2142 4142 4142 4142+  		dc.w $4142, $2142, $4142, $4142, $4142,	$4142, $4142, $2142
0089CB8E 6142 4142 6142 6142 6142+  		dc.w $6142, $4142, $6142, $6142, $6142,	$6142, $6142, $4142
0089CB9E 6142 4142 6142 6142 6142+  		dc.w $6142, $4142, $6142, $6142, $6142,	$6142, $6142, $4142
0089CBAE                            ; ---------------------------------------------------------------------------
0089CBAE                            ; Subroutine to	remove items when you collect them in the special stage
0089CBAE                            ; ---------------------------------------------------------------------------
0089CBAE                            
0089CBAE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089CBAE                            
0089CBAE                            
0089CBAE                            SS_RemoveCollectedItem:			; XREF: Obj09_ChkItems
0089CBAE 45F9 00FF 4400             		lea	($FF4400).l,a2
0089CBB4 303C 001F                  		move.w	#$1F,d0
0089CBB8                            
0089CBB8                            loc_1B4C4:
0089CBB8 4A12                       		tst.b	(a2)
0089CBBA 6700                       		beq.s	locret_1B4CE
0089CBBC 504A                       		addq.w	#8,a2
0089CBBE 51C8 FFF8                  		dbf	d0,loc_1B4C4
0089CBC2                            
0089CBC2                            locret_1B4CE:
0089CBC2 4E75                       		rts	
0089CBC4                            ; End of function SS_RemoveCollectedItem
0089CBC4                            
0089CBC4                            ; ---------------------------------------------------------------------------
0089CBC4                            ; Subroutine to	animate	special	stage items when you touch them
0089CBC4                            ; ---------------------------------------------------------------------------
0089CBC4                            
0089CBC4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089CBC4                            
0089CBC4                            
0089CBC4                            SS_AniItems:				; XREF: SS_ShowLayout
0089CBC4 41F9 00FF 4400             		lea	($FF4400).l,a0
0089CBCA 3E3C 001F                  		move.w	#$1F,d7
0089CBCE                            
0089CBCE                            loc_1B4DA:
0089CBCE 7000                       		moveq	#0,d0
0089CBD0 1010                       		move.b	(a0),d0
0089CBD2 6700                       		beq.s	loc_1B4E8
0089CBD4 E548                       		lsl.w	#2,d0
0089CBD6 227B 0000                  		movea.l	SS_AniIndex-4(pc,d0.w),a1
0089CBDA 4E91                       		jsr	(a1)
0089CBDC                            
0089CBDC                            loc_1B4E8:
0089CBDC 5048                       		addq.w	#8,a0
0089CBDE                            
0089CBDE                            loc_1B4EA:
0089CBDE 51CF FFEE                  		dbf	d7,loc_1B4DA
0089CBE2                            
0089CBE2 4E75                       		rts	
0089CBE4                            ; End of function SS_AniItems
0089CBE4                            
0089CBE4                            ; ===========================================================================
0089CBE4 0000 0000                  SS_AniIndex:	dc.l SS_AniRingSparks
0089CBE8 0000 0000                  		dc.l SS_AniBumper
0089CBEC 0000 0000                  		dc.l SS_Ani1Up
0089CBF0 0000 0000                  		dc.l SS_AniReverse
0089CBF4 0000 0000                  		dc.l SS_AniEmeraldSparks
0089CBF8 0000 0000                  		dc.l SS_AniGlassBlock
0089CBFC                            ; ===========================================================================
0089CBFC                            
0089CBFC                            SS_AniRingSparks:			; XREF: SS_AniIndex
0089CBFC 5328 0002                  		subq.b	#1,2(a0)
0089CC00 6A00                       		bpl.s	locret_1B530
0089CC02 117C 0005 0002             		move.b	#5,2(a0)
0089CC08 7000                       		moveq	#0,d0
0089CC0A 1028 0003                  		move.b	3(a0),d0
0089CC0E 5228 0003                  		addq.b	#1,3(a0)
0089CC12 2268 0004                  		movea.l	4(a0),a1
0089CC16 103B 0000                  		move.b	SS_AniRingData(pc,d0.w),d0
0089CC1A 1280                       		move.b	d0,(a1)
0089CC1C 6600                       		bne.s	locret_1B530
0089CC1E 4290                       		clr.l	(a0)
0089CC20 42A8 0004                  		clr.l	4(a0)
0089CC24                            
0089CC24                            locret_1B530:
0089CC24 4E75                       		rts	
0089CC26                            ; ===========================================================================
0089CC26 4243 4445 0000             SS_AniRingData:	dc.b $42, $43, $44, $45, 0, 0
0089CC2C                            ; ===========================================================================
0089CC2C                            
0089CC2C                            SS_AniBumper:				; XREF: SS_AniIndex
0089CC2C 5328 0002                  		subq.b	#1,2(a0)
0089CC30 6A00                       		bpl.s	locret_1B566
0089CC32 117C 0007 0002             		move.b	#7,2(a0)
0089CC38 7000                       		moveq	#0,d0
0089CC3A 1028 0003                  		move.b	3(a0),d0
0089CC3E 5228 0003                  		addq.b	#1,3(a0)
0089CC42 2268 0004                  		movea.l	4(a0),a1
0089CC46 103B 0000                  		move.b	SS_AniBumpData(pc,d0.w),d0
0089CC4A 6600                       		bne.s	loc_1B564
0089CC4C 4290                       		clr.l	(a0)
0089CC4E 42A8 0004                  		clr.l	4(a0)
0089CC52 12BC 0025                  		move.b	#$25,(a1)
0089CC56 4E75                       		rts	
0089CC58                            ; ===========================================================================
0089CC58                            
0089CC58                            loc_1B564:
0089CC58 1280                       		move.b	d0,(a1)
0089CC5A                            
0089CC5A                            locret_1B566:
0089CC5A 4E75                       		rts	
0089CC5C                            ; ===========================================================================
0089CC5C 3233 3233 0000             SS_AniBumpData:	dc.b $32, $33, $32, $33, 0, 0
0089CC62                            ; ===========================================================================
0089CC62                            
0089CC62                            SS_Ani1Up:				; XREF: SS_AniIndex
0089CC62 5328 0002                  		subq.b	#1,2(a0)
0089CC66 6A00                       		bpl.s	locret_1B596
0089CC68 117C 0005 0002             		move.b	#5,2(a0)
0089CC6E 7000                       		moveq	#0,d0
0089CC70 1028 0003                  		move.b	3(a0),d0
0089CC74 5228 0003                  		addq.b	#1,3(a0)
0089CC78 2268 0004                  		movea.l	4(a0),a1
0089CC7C 103B 0000                  		move.b	SS_Ani1UpData(pc,d0.w),d0
0089CC80 1280                       		move.b	d0,(a1)
0089CC82 6600                       		bne.s	locret_1B596
0089CC84 4290                       		clr.l	(a0)
0089CC86 42A8 0004                  		clr.l	4(a0)
0089CC8A                            		
0089CC8A 11FC 0004 D024             		move.b	#4,($FFFFD024).w
0089CC90                            
0089CC90                            locret_1B596:
0089CC90 4E75                       		rts	
0089CC92                            ; ===========================================================================
0089CC92 4647 4849 0000             SS_Ani1UpData:	dc.b $46, $47, $48, $49, 0, 0
0089CC98                            ; ===========================================================================
0089CC98                            
0089CC98                            SS_AniReverse:				; XREF: SS_AniIndex
0089CC98 5328 0002                  		subq.b	#1,2(a0)
0089CC9C 6A00                       		bpl.s	locret_1B5CC
0089CC9E 117C 0007 0002             		move.b	#7,2(a0)
0089CCA4 7000                       		moveq	#0,d0
0089CCA6 1028 0003                  		move.b	3(a0),d0
0089CCAA 5228 0003                  		addq.b	#1,3(a0)
0089CCAE 2268 0004                  		movea.l	4(a0),a1
0089CCB2 103B 0000                  		move.b	SS_AniRevData(pc,d0.w),d0
0089CCB6 6600                       		bne.s	loc_1B5CA
0089CCB8 4290                       		clr.l	(a0)
0089CCBA 42A8 0004                  		clr.l	4(a0)
0089CCBE 12BC 002B                  		move.b	#$2B,(a1)
0089CCC2 4E75                       		rts	
0089CCC4                            ; ===========================================================================
0089CCC4                            
0089CCC4                            loc_1B5CA:
0089CCC4 1280                       		move.b	d0,(a1)
0089CCC6                            
0089CCC6                            locret_1B5CC:
0089CCC6 4E75                       		rts	
0089CCC8                            ; ===========================================================================
0089CCC8 2B31 2B31 0000             SS_AniRevData:	dc.b $2B, $31, $2B, $31, 0, 0
0089CCCE                            ; ===========================================================================
0089CCCE                            
0089CCCE                            SS_AniEmeraldSparks:			; XREF: SS_AniIndex
0089CCCE 5328 0002                  		subq.b	#1,2(a0)
0089CCD2 6A00                       		bpl.s	locret_1B60C
0089CCD4 117C 0005 0002             		move.b	#5,2(a0)
0089CCDA 7000                       		moveq	#0,d0
0089CCDC 1028 0003                  		move.b	3(a0),d0
0089CCE0 5228 0003                  		addq.b	#1,3(a0)
0089CCE4 2268 0004                  		movea.l	4(a0),a1
0089CCE8 103B 0000                  		move.b	SS_AniEmerData(pc,d0.w),d0
0089CCEC 1280                       		move.b	d0,(a1)
0089CCEE 6600                       		bne.s	locret_1B60C
0089CCF0 4290                       		clr.l	(a0)
0089CCF2 42A8 0004                  		clr.l	4(a0)
0089CCF6 11FC 0004 D024             		move.b	#4,(v_player+obRoutine).w	; change Sonic's routine to ExitStage
0089CD06                            
0089CD06                            locret_1B60C:
0089CD06 4E75                       		rts	
0089CD08                            ; ===========================================================================
0089CD08 4647 4849 0000             SS_AniEmerData:	dc.b $46, $47, $48, $49, 0, 0
0089CD0E                            ; ===========================================================================
0089CD0E                            
0089CD0E                            SS_AniGlassBlock:			; XREF: SS_AniIndex
0089CD0E 5328 0002                  		subq.b	#1,2(a0)
0089CD12 6A00                       		bpl.s	locret_1B640
0089CD14 117C 0001 0002             		move.b	#1,2(a0)
0089CD1A 7000                       		moveq	#0,d0
0089CD1C 1028 0003                  		move.b	3(a0),d0
0089CD20 5228 0003                  		addq.b	#1,3(a0)
0089CD24 2268 0004                  		movea.l	4(a0),a1
0089CD28 103B 0000                  		move.b	SS_AniGlassData(pc,d0.w),d0
0089CD2C 1280                       		move.b	d0,(a1)
0089CD2E 6600                       		bne.s	locret_1B640
0089CD30 12A8 0004                  		move.b	4(a0),(a1)
0089CD34 4290                       		clr.l	(a0)
0089CD36 42A8 0004                  		clr.l	4(a0)
0089CD3A                            
0089CD3A                            locret_1B640:
0089CD3A 4E75                       		rts	
0089CD3C                            ; ===========================================================================
0089CD3C 4B4C 4D4E 4B4C 4D4E 0000   SS_AniGlassData:dc.b $4B, $4C, $4D, $4E, $4B, $4C, $4D,	$4E, 0,	0
0089CD46                            
0089CD46                            ; ---------------------------------------------------------------------------
0089CD46                            ; Special stage	layout pointers
0089CD46                            ; ---------------------------------------------------------------------------
0089CD46                            SS_LayoutIndex:
0089CD46 0000 0000                  		dc.l SS_1
0089CD4A 0000 0000                  		dc.l SS_2
0089CD4E 0000 0000                  		dc.l SS_3
0089CD52 0000 0000                  		dc.l SS_4
0089CD56 0000 0000                  		dc.l SS_5
0089CD5A 0000 0000                  		dc.l SS_6
0089CD5E                            		even
0089CD5E                            
0089CD5E                            ; ---------------------------------------------------------------------------
0089CD5E                            ; Special stage start locations
0089CD5E                            ; ---------------------------------------------------------------------------
0089CD5E                            SS_StartLoc:	include	"_inc\Start Location Array - Special Stages.asm"
0089CD5E                            ; ---------------------------------------------------------------------------
0089CD5E                            ; Special stage start locations
0089CD5E                            ; ---------------------------------------------------------------------------
0089CD5E                            
0089CD5E                            		incbin	"startpos\ss1.bin"
0089CD62                            		incbin	"startpos\ss2.bin"
0089CD66                            		incbin	"startpos\ss3.bin"
0089CD6A                            		incbin	"startpos\ss4.bin"
0089CD6E                            		incbin	"startpos\ss5.bin"
0089CD72                            		incbin	"startpos\ss6.bin"
0089CD76                            		even
0089CD76                            		even
0089CD76                            
0089CD76                            ; ---------------------------------------------------------------------------
0089CD76                            ; Subroutine to	load special stage layout
0089CD76                            ; ---------------------------------------------------------------------------
0089CD76                            
0089CD76                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089CD76                            
0089CD76                            
0089CD76                            SS_Load:				; XREF: GM_Special
0089CD76 7000                       		moveq	#0,d0
0089CD78 1038 FE16                  		move.b	(v_lastspecial).w,d0 ; load number of last special stage entered
0089CD7C                            		
0089CD7C 0C00 0006                  		cmpi.b	#6,d0
0089CD80 6500                       		bcs.s	SS_ChkEmldNum
0089CD82 103C 0000                  		move.b	#0,d0 ; reset if higher than 6
0089CD86 11C0 FE16                  		move.b	d0,(v_lastspecial).w
0089CD8A                            
0089CD8A                            SS_ChkEmldNum:
0089CD8A 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w ; do you have all emeralds?
0089CD90 6700                       		beq.s	SS_LoadData	; if yes, branch
0089CD92 7200                       		moveq	#0,d1
0089CD94 1238 FE57                  		move.b	(v_emeralds).w,d1
0089CD98 5301                       		subq.b	#1,d1
0089CD9A 6500                       		bcs.s	SS_LoadData
0089CD9C 47F8 FE58                  		lea	(v_emldlist).w,a3 ; check which emeralds you have
0089CDA0                            
0089CDA0                            SS_ChkEmldLoop:	
0089CDA0 B033 1000                  		cmp.b	(a3,d1.w),d0
0089CDA4 6600                       		bne.s	SS_ChkEmldRepeat
0089CDA6 60CE                       		bra.s	SS_Load
0089CDA8                            ; ===========================================================================
0089CDA8                            
0089CDA8                            SS_ChkEmldRepeat:
0089CDA8 51C9 FFF6                  		dbf	d1,SS_ChkEmldLoop
0089CDAC                            
0089CDAC                            SS_LoadData:
0089CDAC E548                       		lsl.w	#2,d0
0089CDAE 43FB 00AE                  		lea	SS_StartLoc(pc,d0.w),a1
0089CDB2 31D9 D008                  		move.w	(a1)+,(v_player+obX).w
0089CDB6 31D9 D00C                  		move.w	(a1)+,(v_player+obY).w
0089CDBA 207B 008A                  		movea.l	SS_LayoutIndex(pc,d0.w),a0
0089CDBE 43F9 00FF 4000             		lea	($FF4000).l,a1
0089CDC4 303C 0000                  		move.w	#0,d0
0089CDC8 4EB9 0088 1D40             		jsr	(EniDec).l
0089CDCE 43F9 00FF 0000             		lea	($FF0000).l,a1
0089CDD4 303C 0FFF                  		move.w	#$FFF,d0
0089CDD8                            
0089CDD8                            SS_ClrRAM3:
0089CDD8 4299                       		clr.l	(a1)+
0089CDDA 51C8 FFFC                  		dbf	d0,SS_ClrRAM3
0089CDDE                            
0089CDDE 43F9 00FF 1020             		lea	($FF1020).l,a1
0089CDE4 41F9 00FF 4000             		lea	($FF4000).l,a0
0089CDEA 723F                       		moveq	#$3F,d1
0089CDEC                            
0089CDEC                            loc_1B6F6:
0089CDEC 743F                       		moveq	#$3F,d2
0089CDEE                            
0089CDEE                            loc_1B6F8:
0089CDEE                            
0089CDEE 1018                       		move.b	(a0)+,d0	;load the layout item into d0
0089CDF0 0C00 003B                  		cmpi.b	#$3B,d0		; is the item an emerald?
0089CDF4 6500                       		bcs.s	@notem
0089CDF6 0C00 0040                  		cmpi.b	#$40,d0
0089CDFA 6200                       		bhi.s	@notem
0089CDFC 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w	;do you have all the emeralds?
0089CE02 6600                       		bne.s	@notem		;if not, branch
0089CE04 103C 0028                  		move.b	#$28,d0		;else, make a 1up
0089CE08                            		
0089CE08                            	@notem:
0089CE08 12C0                       		move.b	d0,(a1)+	;move the item into memory
0089CE0A                            
0089CE0A 51CA FFE2                  		dbf	d2,loc_1B6F8
0089CE0E                            
0089CE0E 43E9 0040                  		lea	$40(a1),a1
0089CE12 51C9 FFD8                  		dbf	d1,loc_1B6F6
0089CE16                            
0089CE16 43F9 00FF 4008             		lea	($FF4008).l,a1
0089CE1C 41F9 0000 0000             		lea	(SS_MapIndex).l,a0
0089CE22 724D                       		moveq	#$4D,d1
0089CE24                            
0089CE24                            loc_1B714:
0089CE24 22D8                       		move.l	(a0)+,(a1)+
0089CE26 32FC 0000                  		move.w	#0,(a1)+
0089CE2A 1368 FFFC FFFF             		move.b	-4(a0),-1(a1)
0089CE30 32D8                       		move.w	(a0)+,(a1)+
0089CE32 51C9 FFF0                  		dbf	d1,loc_1B714
0089CE36                            
0089CE36 43F9 00FF 4400             		lea	($FF4400).l,a1
0089CE3C 323C 003F                  		move.w	#$3F,d1
0089CE40                            
0089CE40                            loc_1B730:
0089CE40                            
0089CE40 4299                       		clr.l	(a1)+
0089CE42 51C9 FFFC                  		dbf	d1,loc_1B730
0089CE46                            
0089CE46 4E75                       		rts	
0089CE48                            ; End of function SS_Load
0089CE48                            
0089CE48                            ; ===========================================================================
0089CE48                            
0089CE48                            SS_MapIndex:
0089CE48                            		include	"_inc\Special Stage Mappings & VRAM Pointers.asm"
0089CE48                            ; ---------------------------------------------------------------------------
0089CE48                            ; Special stage	mappings and VRAM pointers
0089CE48                            ; ---------------------------------------------------------------------------
0089CE48 0000 0000                  	dc.l Map_SSWalls	; address of mappings
0089CE4C 0142                       	dc.w $142		; VRAM setting
0089CE4E 0000 0000                  	dc.l Map_SSWalls
0089CE52 0142                       	dc.w $142
0089CE54 0000 0000                  	dc.l Map_SSWalls
0089CE58 0142                       	dc.w $142
0089CE5A 0000 0000                  	dc.l Map_SSWalls
0089CE5E 0142                       	dc.w $142
0089CE60 0000 0000                  	dc.l Map_SSWalls
0089CE64 0142                       	dc.w $142
0089CE66 0000 0000                  	dc.l Map_SSWalls
0089CE6A 0142                       	dc.w $142
0089CE6C 0000 0000                  	dc.l Map_SSWalls
0089CE70 0142                       	dc.w $142
0089CE72 0000 0000                  	dc.l Map_SSWalls
0089CE76 0142                       	dc.w $142
0089CE78 0000 0000                  	dc.l Map_SSWalls
0089CE7C 0142                       	dc.w $142
0089CE7E 0000 0000                  	dc.l Map_SSWalls
0089CE82 2142                       	dc.w $2142
0089CE84 0000 0000                  	dc.l Map_SSWalls
0089CE88 2142                       	dc.w $2142
0089CE8A 0000 0000                  	dc.l Map_SSWalls
0089CE8E 2142                       	dc.w $2142
0089CE90 0000 0000                  	dc.l Map_SSWalls
0089CE94 2142                       	dc.w $2142
0089CE96 0000 0000                  	dc.l Map_SSWalls
0089CE9A 2142                       	dc.w $2142
0089CE9C 0000 0000                  	dc.l Map_SSWalls
0089CEA0 2142                       	dc.w $2142
0089CEA2 0000 0000                  	dc.l Map_SSWalls
0089CEA6 2142                       	dc.w $2142
0089CEA8 0000 0000                  	dc.l Map_SSWalls
0089CEAC 2142                       	dc.w $2142
0089CEAE 0000 0000                  	dc.l Map_SSWalls
0089CEB2 2142                       	dc.w $2142
0089CEB4 0000 0000                  	dc.l Map_SSWalls
0089CEB8 4142                       	dc.w $4142
0089CEBA 0000 0000                  	dc.l Map_SSWalls
0089CEBE 4142                       	dc.w $4142
0089CEC0 0000 0000                  	dc.l Map_SSWalls
0089CEC4 4142                       	dc.w $4142
0089CEC6 0000 0000                  	dc.l Map_SSWalls
0089CECA 4142                       	dc.w $4142
0089CECC 0000 0000                  	dc.l Map_SSWalls
0089CED0 4142                       	dc.w $4142
0089CED2 0000 0000                  	dc.l Map_SSWalls
0089CED6 4142                       	dc.w $4142
0089CED8 0000 0000                  	dc.l Map_SSWalls
0089CEDC 4142                       	dc.w $4142
0089CEDE 0000 0000                  	dc.l Map_SSWalls
0089CEE2 4142                       	dc.w $4142
0089CEE4 0000 0000                  	dc.l Map_SSWalls
0089CEE8 4142                       	dc.w $4142
0089CEEA 0000 0000                  	dc.l Map_SSWalls
0089CEEE 6142                       	dc.w $6142
0089CEF0 0000 0000                  	dc.l Map_SSWalls
0089CEF4 6142                       	dc.w $6142
0089CEF6 0000 0000                  	dc.l Map_SSWalls
0089CEFA 6142                       	dc.w $6142
0089CEFC 0000 0000                  	dc.l Map_SSWalls
0089CF00 6142                       	dc.w $6142
0089CF02 0000 0000                  	dc.l Map_SSWalls
0089CF06 6142                       	dc.w $6142
0089CF08 0000 0000                  	dc.l Map_SSWalls
0089CF0C 6142                       	dc.w $6142
0089CF0E 0000 0000                  	dc.l Map_SSWalls
0089CF12 6142                       	dc.w $6142
0089CF14 0000 0000                  	dc.l Map_SSWalls
0089CF18 6142                       	dc.w $6142
0089CF1A 0000 0000                  	dc.l Map_SSWalls
0089CF1E 6142                       	dc.w $6142
0089CF20 0088 F8E0                  	dc.l Map_Bump
0089CF24 023B                       	dc.w $23B
0089CF26 0000 0000                  	dc.l Map_SS_R
0089CF2A 0570                       	dc.w $570
0089CF2C 0000 0000                  	dc.l Map_SS_R
0089CF30 0251                       	dc.w $251
0089CF32 0000 0000                  	dc.l Map_SS_R
0089CF36 0370                       	dc.w $370
0089CF38 0000 0000                  	dc.l Map_SS_Up
0089CF3C 0263                       	dc.w $263
0089CF3E 0000 0000                  	dc.l Map_SS_Down
0089CF42 0263                       	dc.w $263
0089CF44 0000 0000                  	dc.l Map_SS_R
0089CF48 22F0                       	dc.w $22F0
0089CF4A 0000 0000                  	dc.l Map_SS_Glass
0089CF4E 0470                       	dc.w $470
0089CF50 0000 0000                  	dc.l Map_SS_Glass
0089CF54 05F0                       	dc.w $5F0
0089CF56 0000 0000                  	dc.l Map_SS_Glass
0089CF5A 65F0                       	dc.w $65F0
0089CF5C 0000 0000                  	dc.l Map_SS_Glass
0089CF60 25F0                       	dc.w $25F0
0089CF62 0000 0000                  	dc.l Map_SS_Glass
0089CF66 45F0                       	dc.w $45F0
0089CF68 0000 0000                  	dc.l Map_SS_R
0089CF6C 02F0                       	dc.w $2F0
0089CF6E 0188 F8E0                  	dc.l Map_Bump+$1000000	; add frame no.	* $1000000
0089CF72 023B                       	dc.w $23B
0089CF74 0288 F8E0                  	dc.l Map_Bump+$2000000
0089CF78 023B                       	dc.w $23B
0089CF7A 0000 0000                  	dc.l Map_SS_R
0089CF7E 0797                       	dc.w $797
0089CF80 0000 0000                  	dc.l Map_SS_R
0089CF84 07A0                       	dc.w $7A0
0089CF86 0000 0000                  	dc.l Map_SS_R
0089CF8A 07A9                       	dc.w $7A9
0089CF8C 0000 0000                  	dc.l Map_SS_R
0089CF90 0797                       	dc.w $797
0089CF92 0000 0000                  	dc.l Map_SS_R
0089CF96 07A0                       	dc.w $7A0
0089CF98 0000 0000                  	dc.l Map_SS_R
0089CF9C 07A9                       	dc.w $7A9
0089CF9E 0088 AD02                  	dc.l Map_Ring
0089CFA2 27B2                       	dc.w $27B2
0089CFA4 0000 0000                  	dc.l Map_SS_Chaos3
0089CFA8 0770                       	dc.w $770
0089CFAA 0000 0000                  	dc.l Map_SS_Chaos3
0089CFAE 2770                       	dc.w $2770
0089CFB0 0000 0000                  	dc.l Map_SS_Chaos3
0089CFB4 4770                       	dc.w $4770
0089CFB6 0000 0000                  	dc.l Map_SS_Chaos3
0089CFBA 6770                       	dc.w $6770
0089CFBC 0000 0000                  	dc.l Map_SS_Chaos1
0089CFC0 0770                       	dc.w $770
0089CFC2 0000 0000                  	dc.l Map_SS_Chaos2
0089CFC6 0770                       	dc.w $770
0089CFC8 0000 0000                  	dc.l Map_SS_R
0089CFCC 04F0                       	dc.w $4F0
0089CFCE 0488 AD02                  	dc.l Map_Ring+$4000000
0089CFD2 27B2                       	dc.w $27B2
0089CFD4 0588 AD02                  	dc.l Map_Ring+$5000000
0089CFD8 27B2                       	dc.w $27B2
0089CFDA 0688 AD02                  	dc.l Map_Ring+$6000000
0089CFDE 27B2                       	dc.w $27B2
0089CFE0 0788 AD02                  	dc.l Map_Ring+$7000000
0089CFE4 27B2                       	dc.w $27B2
0089CFE6 0000 0000                  	dc.l Map_SS_Glass
0089CFEA 23F0                       	dc.w $23F0
0089CFEC 0000 0000                  	dc.l Map_SS_Glass+$1000000
0089CFF0 23F0                       	dc.w $23F0
0089CFF2 0000 0000                  	dc.l Map_SS_Glass+$2000000
0089CFF6 23F0                       	dc.w $23F0
0089CFF8 0000 0000                  	dc.l Map_SS_Glass+$3000000
0089CFFC 23F0                       	dc.w $23F0
0089CFFE 0000 0000                  	dc.l Map_SS_R+$2000000
0089D002 04F0                       	dc.w $4F0
0089D004 0000 0000                  	dc.l Map_SS_Glass
0089D008 05F0                       	dc.w $5F0
0089D00A 0000 0000                  	dc.l Map_SS_Glass
0089D00E 65F0                       	dc.w $65F0
0089D010 0000 0000                  	dc.l Map_SS_Glass
0089D014 25F0                       	dc.w $25F0
0089D016 0000 0000                  	dc.l Map_SS_Glass
0089D01A 45F0                       	dc.w $45F0
0089D01A 45F0                       	dc.w $45F0
0089D01C                            
0089D01C                            		include	"_maps\SS R Block.asm"
0089D01C                            ; ---------------------------------------------------------------------------
0089D01C                            ; Sprite mappings - special stage "R" block
0089D01C                            ; ---------------------------------------------------------------------------
0089D01C 0000 0000                  Map_SS_R:	dc.w byte_1B912-Map_SS_R, byte_1B918-Map_SS_R
0089D020 0000                       		dc.w byte_1B91E-Map_SS_R
0089D022 01                         byte_1B912:	dc.b 1
0089D023 F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
0089D028 01                         byte_1B918:	dc.b 1
0089D029 F40A 0009 F4               		dc.b $F4, $A, 0, 9, $F4
0089D02E 00                         byte_1B91E:	dc.b 0
0089D030 00                         		even
0089D030 00                         		even
0089D030                            		include	"_maps\SS Glass Block.asm"
0089D030                            ; ---------------------------------------------------------------------------
0089D030                            ; Sprite mappings - special stage breakable glass blocks and red-white blocks
0089D030                            ; ---------------------------------------------------------------------------
0089D030 0000 0000                  Map_SS_Glass:	dc.w byte_1B928-Map_SS_Glass, byte_1B92E-Map_SS_Glass
0089D034 0000 0000                  		dc.w byte_1B934-Map_SS_Glass, byte_1B93A-Map_SS_Glass
0089D038 01                         byte_1B928:	dc.b 1
0089D039 F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
0089D03E 01                         byte_1B92E:	dc.b 1
0089D03F F40A 0800 F4               		dc.b $F4, $A, 8, 0, $F4
0089D044 01                         byte_1B934:	dc.b 1
0089D045 F40A 1800 F4               		dc.b $F4, $A, $18, 0, $F4
0089D04A 01                         byte_1B93A:	dc.b 1
0089D04B F40A 1000 F4               		dc.b $F4, $A, $10, 0, $F4
0089D050                            		even
0089D050                            		even
0089D050                            		include	"_maps\SS UP Block.asm"
0089D050                            ; ---------------------------------------------------------------------------
0089D050                            ; Sprite mappings - special stage "UP" block
0089D050                            ; ---------------------------------------------------------------------------
0089D050 0000                       Map_SS_Up:	dc.w byte_1B944-Map_SS_Up
0089D052 0000                       		dc.w byte_1B94A-Map_SS_Up
0089D054 01                         byte_1B944:	dc.b 1
0089D055 F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
0089D05A 01                         byte_1B94A:	dc.b 1
0089D05B F40A 0012 F4               		dc.b $F4, $A, 0, $12, $F4
0089D060                            		even
0089D060                            		even
0089D060                            		include	"_maps\SS DOWN Block.asm"
0089D060                            ; ---------------------------------------------------------------------------
0089D060                            ; Sprite mappings - special stage "DOWN" block
0089D060                            ; ---------------------------------------------------------------------------
0089D060 0000                       Map_SS_Down:	dc.w byte_1B954-Map_SS_Down
0089D062 0000                       		dc.w byte_1B95A-Map_SS_Down
0089D064 01                         byte_1B954:	dc.b 1
0089D065 F40A 0009 F4               		dc.b $F4, $A, 0, 9, $F4
0089D06A 01                         byte_1B95A:	dc.b 1
0089D06B F40A 0012 F4               		dc.b $F4, $A, 0, $12, $F4
0089D070                            		even
0089D070                            		even
0089D070                            		include	"_maps\SS Chaos Emeralds.asm"
0089D070                            ; ---------------------------------------------------------------------------
0089D070                            ; Sprite mappings - special stage chaos	emeralds
0089D070                            ; ---------------------------------------------------------------------------
0089D070 0000                       Map_SS_Chaos1:	dc.w byte_1B96C-Map_SS_Chaos1
0089D072 0000                       		dc.w byte_1B97E-Map_SS_Chaos1
0089D074 0000                       Map_SS_Chaos2:	dc.w byte_1B972-Map_SS_Chaos2
0089D076 0000                       		dc.w byte_1B97E-Map_SS_Chaos2
0089D078 0000                       Map_SS_Chaos3:	dc.w byte_1B978-Map_SS_Chaos3
0089D07A 0000                       		dc.w byte_1B97E-Map_SS_Chaos3
0089D07C 01                         byte_1B96C:	dc.b 1
0089D07D F805 0000 F8               		dc.b $F8, 5, 0,	0, $F8
0089D082 01                         byte_1B972:	dc.b 1
0089D083 F805 0004 F8               		dc.b $F8, 5, 0,	4, $F8
0089D088 01                         byte_1B978:	dc.b 1
0089D089 F805 0008 F8               		dc.b $F8, 5, 0,	8, $F8
0089D08E 01                         byte_1B97E:	dc.b 1
0089D08F F805 000C F8               		dc.b $F8, 5, 0,	$C, $F8
0089D094                            		even
0089D094                            		even
0089D094                            
0089D094                            		include	"_incObj\09 Sonic in Special Stage.asm"
0089D094                            ; ---------------------------------------------------------------------------
0089D094                            ; Object 09 - Sonic (special stage)
0089D094                            ; ---------------------------------------------------------------------------
0089D094                            
0089D094                            SonicSpecial:				; XREF: Obj_Index
0089D094 4A78 FE08                  		tst.w	(v_debuguse).w	; is debug mode	being used?
0089D098 6700                       		beq.s	Obj09_Normal	; if not, branch
0089D09A 6100 0000                  		bsr.w	SS_FixCamera
0089D09E 6000 0000                  		bra.w	DebugMode
0089D0A2                            ; ===========================================================================
0089D0A2                            
0089D0A2                            Obj09_Normal:
0089D0A2 7000                       		moveq	#0,d0
0089D0A4 1028 0024                  		move.b	obRoutine(a0),d0
0089D0A8 323B 0000                  		move.w	Obj09_Index(pc,d0.w),d1
0089D0AC 4EFB 1000                  		jmp	Obj09_Index(pc,d1.w)
0089D0B0                            ; ===========================================================================
0089D0B0 0000                       Obj09_Index:	dc.w Obj09_Main-Obj09_Index
0089D0B2 0000                       		dc.w Obj09_ChkDebug-Obj09_Index
0089D0B4 0000                       		dc.w Obj09_ExitStage-Obj09_Index
0089D0B6 0000                       		dc.w Obj09_Exit2-Obj09_Index
0089D0B8                            ; ===========================================================================
0089D0B8                            
0089D0B8                            Obj09_Main:	; Routine 0
0089D0B8 5428 0024                  		addq.b	#2,obRoutine(a0)
0089D0BC 117C 000E 0016             		move.b	#$E,obHeight(a0)
0089D0C2 117C 0007 0017             		move.b	#7,obWidth(a0)
0089D0C8 217C 0000 0000 0004        		move.l	#Map_Sonic,obMap(a0)
0089D0D0 317C 0780 0002             		move.w	#$780,obGfx(a0)
0089D0D6 117C 0004 0001             		move.b	#4,obRender(a0)
0089D0DC 117C 0000 0018             		move.b	#0,obPriority(a0)
0089D0E2 117C 0002 001C             		move.b	#id_Roll,obAnim(a0)
0089D0E8 08E8 0002 0022             		bset	#2,obStatus(a0)
0089D0EE 08E8 0001 0022             		bset	#1,obStatus(a0)
0089D0F4                            
0089D0F4                            Obj09_ChkDebug:	; Routine 2
0089D0F4 4A78 FFFA                  		tst.w	(f_debugmode).w	; is debug mode	cheat enabled?
0089D0F8 6700                       		beq.s	Obj09_NoDebug	; if not, branch
0089D0FA 0838 0004 F605             		btst	#bitB,(v_jpadpress1).w ; is button B pressed?
0089D100 6700                       		beq.s	Obj09_NoDebug	; if not, branch
0089D102 31FC 0001 FE08             		move.w	#1,(v_debuguse).w ; change Sonic into a ring
0089D108                            
0089D108                            Obj09_NoDebug:
0089D108 117C 0000 0030             		move.b	#0,$30(a0)
0089D10E 7000                       		moveq	#0,d0
0089D110 1028 0022                  		move.b	obStatus(a0),d0
0089D114 0240 0002                  		andi.w	#2,d0
0089D118 323B 0000                  		move.w	Obj09_Modes(pc,d0.w),d1
0089D11C 4EBB 1000                  		jsr	Obj09_Modes(pc,d1.w)
0089D120 4EB9 0089 510E             		jsr	Sonic_LoadGfx
0089D126 4EF9 0088 E3CC             		jmp	DisplaySprite
0089D12C                            ; ===========================================================================
0089D12C 0000                       Obj09_Modes:	dc.w Obj09_OnWall-Obj09_Modes
0089D12E 0000                       		dc.w Obj09_InAir-Obj09_Modes
0089D130                            ; ===========================================================================
0089D130                            
0089D130                            Obj09_OnWall:				; XREF: Obj09_Modes
0089D130                            
0089D130 08A8 0007 0022             		bclr	#7,obStatus(a0)	; clear "Sonic has jumped" flag
0089D136                            	
0089D136 6100 0000                  		bsr.w	Obj09_Jump
0089D13A 6100 0000                  		bsr.w	Obj09_Move
0089D13E 6100 0000                  		bsr.w	Obj09_Fall
0089D142 6000                       		bra.s	Obj09_Display
0089D144                            ; ===========================================================================
0089D144                            
0089D144                            Obj09_InAir:				; XREF: Obj09_Modes
0089D144                            
0089D144 6100 0000                  		bsr.w	Obj09_JumpHeight
0089D148                            
0089D148 6100 0000                  		bsr.w	Obj09_Move
0089D14C 6100 0000                  		bsr.w	Obj09_Fall
0089D150                            
0089D150                            Obj09_Display:				; XREF: Obj09_OnWall
0089D150 6100 0000                  		bsr.w	Obj09_ChkItems
0089D154 6100 0000                  		bsr.w	Obj09_ChkItems2
0089D158 4EB9 0088 E3B2             		jsr	ObjectMove
0089D15E 6100 0000                  		bsr.w	SS_FixCamera
0089D162 3038 F780                  		move.w	(v_ssangle).w,d0
0089D166 D078 F782                  		add.w	(v_ssrotate).w,d0
0089D16A 31C0 F780                  		move.w	d0,(v_ssangle).w
0089D16E 4EB9 0089 4E32             		jsr	Sonic_Animate
0089D174 4E75                       		rts	
0089D176                            
0089D176                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D176                            
0089D176                            
0089D176                            Obj09_Move:				; XREF: Obj09_OnWall; Obj09_InAir
0089D176 0838 0002 F602             		btst	#bitL,(v_jpadhold2).w ; is left being pressed?
0089D17C 6700                       		beq.s	Obj09_ChkRight	; if not, branch
0089D17E 6100 0000                  		bsr.w	Obj09_MoveLeft
0089D182                            
0089D182                            Obj09_ChkRight:
0089D182 0838 0003 F602             		btst	#bitR,(v_jpadhold2).w ; is right being pressed?
0089D188 6700                       		beq.s	loc_1BA78	; if not, branch
0089D18A 6100 0000                  		bsr.w	Obj09_MoveRight
0089D18E                            
0089D18E                            loc_1BA78:
0089D18E 1038 F602                  		move.b	(v_jpadhold2).w,d0
0089D192 0200 000C                  		andi.b	#btnL+btnR,d0
0089D196 6600                       		bne.s	loc_1BAA8
0089D198 3028 0014                  		move.w	obInertia(a0),d0
0089D19C 6700                       		beq.s	loc_1BAA8
0089D19E 6B00                       		bmi.s	loc_1BA9A
0089D1A0 0440 000C                  		subi.w	#$C,d0
0089D1A4 6400                       		bcc.s	loc_1BA94
0089D1A6 303C 0000                  		move.w	#0,d0
0089D1AA                            
0089D1AA                            loc_1BA94:
0089D1AA 3140 0014                  		move.w	d0,obInertia(a0)
0089D1AE 6000                       		bra.s	loc_1BAA8
0089D1B0                            ; ===========================================================================
0089D1B0                            
0089D1B0                            loc_1BA9A:
0089D1B0 0640 000C                  		addi.w	#$C,d0
0089D1B4 6400                       		bcc.s	loc_1BAA4
0089D1B6 303C 0000                  		move.w	#0,d0
0089D1BA                            
0089D1BA                            loc_1BAA4:
0089D1BA 3140 0014                  		move.w	d0,obInertia(a0)
0089D1BE                            
0089D1BE                            loc_1BAA8:
0089D1BE 1038 F780                  		move.b	(v_ssangle).w,d0
0089D1C2 0600 0020                  		addi.b	#$20,d0
0089D1C6 0200 00C0                  		andi.b	#$C0,d0
0089D1CA 4400                       		neg.b	d0
0089D1CC 4EB9 0088 301C             		jsr	(CalcSine).l
0089D1D2 C3E8 0014                  		muls.w	obInertia(a0),d1
0089D1D6 D3A8 0008                  		add.l	d1,obX(a0)
0089D1DA C1E8 0014                  		muls.w	obInertia(a0),d0
0089D1DE D1A8 000C                  		add.l	d0,obY(a0)
0089D1E2 48E7 C000                  		movem.l	d0-d1,-(sp)
0089D1E6 2428 000C                  		move.l	obY(a0),d2
0089D1EA 2628 0008                  		move.l	obX(a0),d3
0089D1EE 6100 0000                  		bsr.w	sub_1BCE8
0089D1F2 6700                       		beq.s	loc_1BAF2
0089D1F4 4CDF 0003                  		movem.l	(sp)+,d0-d1
0089D1F8 93A8 0008                  		sub.l	d1,obX(a0)
0089D1FC 91A8 000C                  		sub.l	d0,obY(a0)
0089D200 317C 0000 0014             		move.w	#0,obInertia(a0)
0089D206 4E75                       		rts	
0089D208                            ; ===========================================================================
0089D208                            
0089D208                            loc_1BAF2:
0089D208 4CDF 0003                  		movem.l	(sp)+,d0-d1
0089D20C 4E75                       		rts	
0089D20E                            ; End of function Obj09_Move
0089D20E                            
0089D20E                            
0089D20E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D20E                            
0089D20E                            
0089D20E                            Obj09_MoveLeft:				; XREF: Obj09_Move
0089D20E 08E8 0000 0022             		bset	#0,obStatus(a0)
0089D214 3028 0014                  		move.w	obInertia(a0),d0
0089D218 6700                       		beq.s	loc_1BB06
0089D21A 6A00                       		bpl.s	loc_1BB1A
0089D21C                            
0089D21C                            loc_1BB06:
0089D21C 0440 000C                  		subi.w	#$C,d0
0089D220 0C40 F800                  		cmpi.w	#-$800,d0
0089D224 6E00                       		bgt.s	loc_1BB14
0089D226 303C F800                  		move.w	#-$800,d0
0089D22A                            
0089D22A                            loc_1BB14:
0089D22A 3140 0014                  		move.w	d0,obInertia(a0)
0089D22E 4E75                       		rts	
0089D230                            ; ===========================================================================
0089D230                            
0089D230                            loc_1BB1A:
0089D230 0440 0040                  		subi.w	#$40,d0
0089D234 6400                       		bcc.s	loc_1BB22
0089D236 4E71                       		nop	
0089D238                            
0089D238                            loc_1BB22:
0089D238 3140 0014                  		move.w	d0,obInertia(a0)
0089D23C 4E75                       		rts	
0089D23E                            ; End of function Obj09_MoveLeft
0089D23E                            
0089D23E                            
0089D23E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D23E                            
0089D23E                            
0089D23E                            Obj09_MoveRight:			; XREF: Obj09_Move
0089D23E 08A8 0000 0022             		bclr	#0,obStatus(a0)
0089D244 3028 0014                  		move.w	obInertia(a0),d0
0089D248 6B00                       		bmi.s	loc_1BB48
0089D24A 0640 000C                  		addi.w	#$C,d0
0089D24E 0C40 0800                  		cmpi.w	#$800,d0
0089D252 6D00                       		blt.s	loc_1BB42
0089D254 303C 0800                  		move.w	#$800,d0
0089D258                            
0089D258                            loc_1BB42:
0089D258 3140 0014                  		move.w	d0,obInertia(a0)
0089D25C 6000                       		bra.s	locret_1BB54
0089D25E                            ; ===========================================================================
0089D25E                            
0089D25E                            loc_1BB48:
0089D25E 0640 0040                  		addi.w	#$40,d0
0089D262 6400                       		bcc.s	loc_1BB50
0089D264 4E71                       		nop	
0089D266                            
0089D266                            loc_1BB50:
0089D266 3140 0014                  		move.w	d0,obInertia(a0)
0089D26A                            
0089D26A                            locret_1BB54:
0089D26A 4E75                       		rts	
0089D26C                            ; End of function Obj09_MoveRight
0089D26C                            
0089D26C                            
0089D26C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D26C                            
0089D26C                            
0089D26C                            Obj09_Jump:				; XREF: Obj09_OnWall
0089D26C 1038 F603                  		move.b	(v_jpadpress2).w,d0
0089D270 0200 0070                  		andi.b	#btnABC,d0	; is A,	B or C pressed?
0089D274 6700                       		beq.s	Obj09_NoJump	; if not, branch
0089D276 1038 F780                  		move.b	(v_ssangle).w,d0
0089D27A 0200 00FC                  		andi.b	#$FC,d0
0089D27E 4400                       		neg.b	d0
0089D280 0400 0040                  		subi.b	#$40,d0
0089D284 4EB9 0088 301C             		jsr	(CalcSine).l
0089D28A C3FC 0680                  		muls.w	#$680,d1
0089D28E E081                       		asr.l	#8,d1
0089D290 3141 0010                  		move.w	d1,obVelX(a0)
0089D294 C1FC 0680                  		muls.w	#$680,d0
0089D298 E080                       		asr.l	#8,d0
0089D29A 3140 0012                  		move.w	d0,obVelY(a0)
0089D29E 08E8 0001 0022             		bset	#1,obStatus(a0)
0089D2A4                            		
0089D2A4 08E8 0007 0022             		bset	#7,obStatus(a0)	; set "Sonic has jumped" flag
0089D2AA                            	
0089D2B4                            
0089D2B4                            Obj09_NoJump:
0089D2B4 4E75                       		rts	
0089D2B6                            ; End of function Obj09_Jump
0089D2B6                            
0089D2B6                            ; ---------------------------------------------------------------------------
0089D2B6                            ; Subroutine to limit Sonic's upward vertical speed
0089D2B6                            ; ---------------------------------------------------------------------------
0089D2B6                            
0089D2B6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D2B6                            
0089D2B6                            Obj09_JumpHeight:				; XREF: Obj09_InAir
0089D2B6 1038 F602                  		move.b	(v_jpadhold2).w,d0	; is the jump button up?
0089D2BA 0200 0070                  		andi.b	#btnABC,d0
0089D2BE 6600                       		bne.s	locret_1BBB4		; if not, branch to return
0089D2C0 0828 0007 0022             		btst	#7,obStatus(a0)		; did Sonic jump or is he just falling or hit by a bumper?
0089D2C6 6700                       		beq.s	locret_1BBB4		; if not, branch to return
0089D2C8 1038 F780                  		move.b	(v_ssangle).w,d0	; get SS angle
0089D2CC 0200 00FC                  		andi.b	#$FC,d0
0089D2D0 4400                       		neg.b	d0
0089D2D2 0400 0040                  		subi.b	#$40,d0
0089D2D6 4EB9 0088 301C             		jsr (CalcSine).l			; calculate sine and cosine (d1 = cos, d0 = sin)
0089D2DC 3428 0012                  		move.w	obVelY(a0),d2		; get Y speed
0089D2E0 C1C2                       		muls.w	d2,d0				; multiply Y speed by sin
0089D2E2 E080                       		asr.l	#8,d0				; find the new Y speed
0089D2E4 3428 0010                  		move.w	obVelX(a0),d2		; get X speed
0089D2E8 C3C2                       		muls.w	d2,d1				; multiply X speed by cos
0089D2EA E081                       		asr.l	#8,d1				; find the new X speed
0089D2EC D240                       		add.w	d0,d1				; combine the two speeds
0089D2EE 0C41 0400                  		cmpi.w	#$400,d1			; compare the combined speed with the jump release speed
0089D2F2 6F00                       		ble.s	locret_1BBB4		; if it's less, branch to return
0089D2F4 1038 F780                  		move.b	(v_ssangle).w,d0
0089D2F8 0200 00FC                  		andi.b	#$FC,d0
0089D2FC 4400                       		neg.b	d0
0089D2FE 0400 0040                  		subi.b	#$40,d0
0089D302 4EB9 0088 301C             		jsr	(CalcSine).l
0089D308 C3FC 0400                  		muls.w	#$400,d1
0089D30C E081                       		asr.l	#8,d1
0089D30E 3141 0010                  		move.w	d1,obVelX(a0)
0089D312 C1FC 0400                  		muls.w	#$400,d0
0089D316 E080                       		asr.l	#8,d0
0089D318 3140 0012                  		move.w	d0,obVelY(a0)		; set the speed to the jump release speed
0089D31C 08A8 0007 0022             		bclr	#7,obStatus(a0)		; clear "Sonic has jumped" flag
0089D322                            		
0089D322                            locret_1BBB4:
0089D322 4E75                       		rts
0089D324                            
0089D324                            ; ---------------------------------------------------------------------------
0089D324                            ; Subroutine to	fix the	camera on Sonic's position (special stage)
0089D324                            ; ---------------------------------------------------------------------------
0089D324                            
0089D324                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D324                            
0089D324                            
0089D324                            SS_FixCamera:				; XREF: Obj09
0089D324 3428 000C                  		move.w	obY(a0),d2
0089D328 3628 0008                  		move.w	obX(a0),d3
0089D32C 3038 F700                  		move.w	(v_screenposx).w,d0
0089D330 0443 00A0                  		subi.w	#$A0,d3
0089D334 6500                       		bcs.s	loc_1BBCE
0089D336 9043                       		sub.w	d3,d0
0089D338 9178 F700                  		sub.w	d0,(v_screenposx).w
0089D33C                            
0089D33C                            loc_1BBCE:
0089D33C 3038 F704                  		move.w	(v_screenposy).w,d0
0089D340 0442 0070                  		subi.w	#$70,d2
0089D344 6500                       		bcs.s	locret_1BBDE
0089D346 9042                       		sub.w	d2,d0
0089D348 9178 F704                  		sub.w	d0,(v_screenposy).w
0089D34C                            
0089D34C                            locret_1BBDE:
0089D34C 4E75                       		rts	
0089D34E                            ; End of function SS_FixCamera
0089D34E                            
0089D34E                            ; ===========================================================================
0089D34E                            
0089D34E                            Obj09_ExitStage:			; XREF: Obj09_Index
0089D34E 0678 0040 F782             		addi.w	#$40,(v_ssrotate).w
0089D354 0C78 1800 F782             		cmpi.w	#$1800,(v_ssrotate).w
0089D35A 6600                       		bne.s	loc_1BBF4
0089D35C 11FC 0000 F600             		move.b	#id_Level,(v_gamemode).w
0089D362                            
0089D362                            loc_1BBF4:
0089D362 0C78 3000 F782             		cmpi.w	#$3000,(v_ssrotate).w
0089D368 6D00                       		blt.s	loc_1BC12
0089D36A 31FC 0000 F782             		move.w	#0,(v_ssrotate).w
0089D370 31FC 4000 F780             		move.w	#$4000,(v_ssangle).w
0089D376 5428 0024                  		addq.b	#2,obRoutine(a0)
0089D37A 317C 003C 0038             		move.w	#$3C,$38(a0)
0089D380                            
0089D380                            loc_1BC12:
0089D380 3038 F780                  		move.w	(v_ssangle).w,d0
0089D384 D078 F782                  		add.w	(v_ssrotate).w,d0
0089D388 31C0 F780                  		move.w	d0,(v_ssangle).w
0089D38C 4EB9 0089 4E32             		jsr	Sonic_Animate
0089D392 4EB9 0089 510E             		jsr	Sonic_LoadGfx
0089D398 6100 FF8A                  		bsr.w	SS_FixCamera
0089D39C 4EF9 0088 E3CC             		jmp	DisplaySprite
0089D3A2                            ; ===========================================================================
0089D3A2                            
0089D3A2                            Obj09_Exit2:				; XREF: Obj09_Index
0089D3A2 5368 0038                  		subq.w	#1,$38(a0)
0089D3A6 6600                       		bne.s	loc_1BC40
0089D3A8 11FC 0000 F600             		move.b	#id_Level,(v_gamemode).w
0089D3AE                            
0089D3AE                            loc_1BC40:
0089D3AE 4EB9 0089 4E32             		jsr	Sonic_Animate
0089D3B4 4EB9 0089 510E             		jsr	Sonic_LoadGfx
0089D3BA 6100 FF68                  		bsr.w	SS_FixCamera
0089D3BE 4EF9 0088 E3CC             		jmp	DisplaySprite
0089D3C4                            
0089D3C4                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D3C4                            
0089D3C4                            
0089D3C4                            Obj09_Fall:				; XREF: Obj09_OnWall; Obj09_InAir
0089D3C4 2428 000C                  		move.l	obY(a0),d2
0089D3C8 2628 0008                  		move.l	obX(a0),d3
0089D3CC 1038 F780                  		move.b	(v_ssangle).w,d0
0089D3D0 0200 00FC                  		andi.b	#$FC,d0
0089D3D4 4EB9 0088 301C             		jsr	(CalcSine).l
0089D3DA 3828 0010                  		move.w	obVelX(a0),d4
0089D3DE 48C4                       		ext.l	d4
0089D3E0 E184                       		asl.l	#8,d4
0089D3E2 C1FC 002A                  		muls.w	#$2A,d0
0089D3E6 D084                       		add.l	d4,d0
0089D3E8 3828 0012                  		move.w	obVelY(a0),d4
0089D3EC 48C4                       		ext.l	d4
0089D3EE E184                       		asl.l	#8,d4
0089D3F0 C3FC 002A                  		muls.w	#$2A,d1
0089D3F4 D284                       		add.l	d4,d1
0089D3F6 D680                       		add.l	d0,d3
0089D3F8 6100 0000                  		bsr.w	sub_1BCE8
0089D3FC 6700                       		beq.s	loc_1BCB0
0089D3FE 9680                       		sub.l	d0,d3
0089D400 7000                       		moveq	#0,d0
0089D402 3140 0010                  		move.w	d0,obVelX(a0)
0089D406 08A8 0001 0022             		bclr	#1,obStatus(a0)
0089D40C D481                       		add.l	d1,d2
0089D40E 6100 0000                  		bsr.w	sub_1BCE8
0089D412 6700                       		beq.s	loc_1BCC6
0089D414 9481                       		sub.l	d1,d2
0089D416 7200                       		moveq	#0,d1
0089D418 3141 0012                  		move.w	d1,obVelY(a0)
0089D41C 4E75                       		rts	
0089D41E                            ; ===========================================================================
0089D41E                            
0089D41E                            loc_1BCB0:
0089D41E D481                       		add.l	d1,d2
0089D420 6100 0000                  		bsr.w	sub_1BCE8
0089D424 6700                       		beq.s	loc_1BCD4
0089D426 9481                       		sub.l	d1,d2
0089D428 7200                       		moveq	#0,d1
0089D42A 3141 0012                  		move.w	d1,obVelY(a0)
0089D42E 08A8 0001 0022             		bclr	#1,obStatus(a0)
0089D434                            
0089D434                            loc_1BCC6:
0089D434 E080                       		asr.l	#8,d0
0089D436 E081                       		asr.l	#8,d1
0089D438 3140 0010                  		move.w	d0,obVelX(a0)
0089D43C 3141 0012                  		move.w	d1,obVelY(a0)
0089D440 4E75                       		rts	
0089D442                            ; ===========================================================================
0089D442                            
0089D442                            loc_1BCD4:
0089D442 E080                       		asr.l	#8,d0
0089D444 E081                       		asr.l	#8,d1
0089D446 3140 0010                  		move.w	d0,obVelX(a0)
0089D44A 3141 0012                  		move.w	d1,obVelY(a0)
0089D44E 08E8 0001 0022             		bset	#1,obStatus(a0)
0089D454 4E75                       		rts	
0089D456                            ; End of function Obj09_Fall
0089D456                            
0089D456                            
0089D456                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D456                            
0089D456                            
0089D456                            sub_1BCE8:				; XREF: Obj09_Move; Obj09_Fall
0089D456 43F9 00FF 0000             		lea	($FF0000).l,a1
0089D45C 7800                       		moveq	#0,d4
0089D45E 4842                       		swap	d2
0089D460 3802                       		move.w	d2,d4
0089D462 4842                       		swap	d2
0089D464 0644 0044                  		addi.w	#$44,d4
0089D468 88FC 0018                  		divu.w	#$18,d4
0089D46C C8FC 0080                  		mulu.w	#$80,d4
0089D470 D3C4                       		adda.l	d4,a1
0089D472 7800                       		moveq	#0,d4
0089D474 4843                       		swap	d3
0089D476 3803                       		move.w	d3,d4
0089D478 4843                       		swap	d3
0089D47A 0644 0014                  		addi.w	#$14,d4
0089D47E 88FC 0018                  		divu.w	#$18,d4
0089D482 D2C4                       		adda.w	d4,a1
0089D484 7A00                       		moveq	#0,d5
0089D486 1819                       		move.b	(a1)+,d4
0089D488 6100                       		bsr.s	sub_1BD30
0089D48A 1819                       		move.b	(a1)+,d4
0089D48C 6100                       		bsr.s	sub_1BD30
0089D48E D2FC 007E                  		adda.w	#$7E,a1
0089D492 1819                       		move.b	(a1)+,d4
0089D494 6100                       		bsr.s	sub_1BD30
0089D496 1819                       		move.b	(a1)+,d4
0089D498 6100                       		bsr.s	sub_1BD30
0089D49A 4A05                       		tst.b	d5
0089D49C 4E75                       		rts	
0089D49E                            ; End of function sub_1BCE8
0089D49E                            
0089D49E                            
0089D49E                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D49E                            
0089D49E                            
0089D49E                            sub_1BD30:				; XREF: sub_1BCE8
0089D49E 6700                       		beq.s	locret_1BD44
0089D4A0 0C04 0028                  		cmpi.b	#$28,d4
0089D4A4 6700                       		beq.s	locret_1BD44
0089D4A6 0C04 003A                  		cmpi.b	#$3A,d4
0089D4AA 6500                       		bcs.s	loc_1BD46
0089D4AC 0C04 004B                  		cmpi.b	#$4B,d4
0089D4B0 6400                       		bcc.s	loc_1BD46
0089D4B2                            
0089D4B2                            locret_1BD44:
0089D4B2 4E75                       		rts	
0089D4B4                            ; ===========================================================================
0089D4B4                            
0089D4B4                            loc_1BD46:
0089D4B4 1144 0030                  		move.b	d4,$30(a0)
0089D4B8 2149 0032                  		move.l	a1,$32(a0)
0089D4BC 7AFF                       		moveq	#-1,d5
0089D4BE 4E75                       		rts	
0089D4C0                            ; End of function sub_1BD30
0089D4C0                            
0089D4C0                            
0089D4C0                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D4C0                            
0089D4C0                            
0089D4C0                            Obj09_ChkItems:				; XREF: Obj09_Display
0089D4C0 43F9 00FF 0000             		lea	($FF0000).l,a1
0089D4C6 7800                       		moveq	#0,d4
0089D4C8 3828 000C                  		move.w	obY(a0),d4
0089D4CC 0644 0050                  		addi.w	#$50,d4
0089D4D0 88FC 0018                  		divu.w	#$18,d4
0089D4D4 C8FC 0080                  		mulu.w	#$80,d4
0089D4D8 D3C4                       		adda.l	d4,a1
0089D4DA 7800                       		moveq	#0,d4
0089D4DC 3828 0008                  		move.w	obX(a0),d4
0089D4E0 0644 0020                  		addi.w	#$20,d4
0089D4E4 88FC 0018                  		divu.w	#$18,d4
0089D4E8 D2C4                       		adda.w	d4,a1
0089D4EA 1811                       		move.b	(a1),d4
0089D4EC 6600                       		bne.s	Obj09_ChkCont
0089D4EE 4A28 003A                  		tst.b	$3A(a0)
0089D4F2 6600 0000                  		bne.w	Obj09_MakeGhostSolid
0089D4F6 7800                       		moveq	#0,d4
0089D4F8 4E75                       		rts	
0089D4FA                            ; ===========================================================================
0089D4FA                            
0089D4FA                            Obj09_ChkCont:
0089D4FA 0C04 003A                  		cmpi.b	#$3A,d4		; is the item a	ring?
0089D4FE 6600                       		bne.s	Obj09_Chk1Up
0089D500 6100 F6AC                  		bsr.w	SS_RemoveCollectedItem
0089D504 6600                       		bne.s	Obj09_GetCont
0089D506 14BC 0001                  		move.b	#1,(a2)
0089D50A 2549 0004                  		move.l	a1,4(a2)
0089D50E                            
0089D50E                            Obj09_GetCont:
0089D50E 4EB9 0088 A99C             		jsr	CollectRing
0089D514 0C78 0032 FE20             		cmpi.w	#50,(v_rings).w	; check if you have 50 rings
0089D51A 6500                       		bcs.s	Obj09_NoCont
0089D51C 08F8 0000 FE1B             		bset	#0,(v_lifecount).w
0089D522 6600                       		bne.s	Obj09_NoCont
0089D524 5238 FE18                  		addq.b	#1,(v_continues).w ; add 1 to number of continues
0089D528                            		
0089D528 08F8 0007 FE18             		bset	#7,(v_continues).w	; set "got continue" flag bit
0089D52E                            	
0089D52E 303C 00AC                  		move.w	#sfx_Continue,d0
0089D532 4EB9 0088 183C             		jsr	(PlaySound).l	; play extra continue sound
0089D538                            
0089D538                            Obj09_NoCont:
0089D538 7800                       		moveq	#0,d4
0089D53A 4E75                       		rts	
0089D53C                            ; ===========================================================================
0089D53C                            
0089D53C                            Obj09_Chk1Up:
0089D53C 0C04 0028                  		cmpi.b	#$28,d4		; is the item an extra life?
0089D540 6600                       		bne.s	Obj09_ChkEmer
0089D542 6100 F66A                  		bsr.w	SS_RemoveCollectedItem
0089D546 6600                       		bne.s	Obj09_Get1Up
0089D548 14BC 0003                  		move.b	#3,(a2)
0089D54C 2549 0004                  		move.l	a1,4(a2)
0089D550                            
0089D550                            Obj09_Get1Up:
0089D550                            	
0089D550 5238 FE18                  		addq.b	#1,(v_continues).w ; add 1 to number of continues
0089D554 08F8 0007 FE18             		bset	#7,(v_continues).w	; set "got continue" flag bit
0089D564                            	
0089D564 5238 FE16                  		addq.b	#1,(v_lastspecial).w	; inc SS index
0089D568                            	
0089D568                            
0089D568 7800                       		moveq	#0,d4
0089D56A 4E75                       		rts	
0089D56C                            		
0089D56C                            ; ===========================================================================
0089D56C                            
0089D56C                            Obj09_ChkEmer:
0089D56C 0C04 003B                  		cmpi.b	#$3B,d4		; is the item an emerald?
0089D570 6500                       		bcs.s	Obj09_ChkGhost
0089D572 0C04 0040                  		cmpi.b	#$40,d4
0089D576 6200                       		bhi.s	Obj09_ChkGhost
0089D578 6100 F634                  		bsr.w	SS_RemoveCollectedItem
0089D57C 6600                       		bne.s	Obj09_GetEmer
0089D57E 14BC 0005                  		move.b	#5,(a2)
0089D582 2549 0004                  		move.l	a1,4(a2)
0089D586                            
0089D586                            Obj09_GetEmer:
0089D586 0C38 0006 FE57             		cmpi.b	#6,(v_emeralds).w ; do you have all the emeralds?
0089D58C 6700                       		beq.s	Obj09_NoEmer	; if yes, branch
0089D58E 0404 003B                  		subi.b	#$3B,d4
0089D592 7000                       		moveq	#0,d0
0089D594 1038 FE57                  		move.b	(v_emeralds).w,d0
0089D598 45F8 FE58                  		lea	(v_emldlist).w,a2
0089D59C 1584 0000                  		move.b	d4,(a2,d0.w)
0089D5A0 5238 FE57                  		addq.b	#1,(v_emeralds).w ; add 1 to number of emeralds
0089D5A4                            		
0089D5A4 5238 FE16                  		addq.b	#1,(v_lastspecial).w	; inc SS index
0089D5A8                            		
0089D5A8                            
0089D5A8                            Obj09_NoEmer:
0089D5B2 7800                       		moveq	#0,d4
0089D5B4 4E75                       		rts	
0089D5B6                            ; ===========================================================================
0089D5B6                            
0089D5B6                            Obj09_ChkGhost:
0089D5B6 0C04 0041                  		cmpi.b	#$41,d4		; is the item a	ghost block?
0089D5BA 6600                       		bne.s	Obj09_ChkGhostTag
0089D5BC 117C 0001 003A             		move.b	#1,$3A(a0)	; mark the ghost block as "passed"
0089D5C2                            
0089D5C2                            Obj09_ChkGhostTag:
0089D5C2 0C04 004A                  		cmpi.b	#$4A,d4		; is the item a	switch for ghost blocks?
0089D5C6 6600                       		bne.s	Obj09_NoGhost
0089D5C8 0C28 0001 003A             		cmpi.b	#1,$3A(a0)	; have the ghost blocks	been passed?
0089D5CE 6600                       		bne.s	Obj09_NoGhost	; if not, branch
0089D5D0 117C 0002 003A             		move.b	#2,$3A(a0)	; mark the ghost blocks	as "solid"
0089D5D6                            
0089D5D6                            Obj09_NoGhost:
0089D5D6 78FF                       		moveq	#-1,d4
0089D5D8 4E75                       		rts	
0089D5DA                            ; ===========================================================================
0089D5DA                            
0089D5DA                            Obj09_MakeGhostSolid:
0089D5DA 0C28 0002 003A             		cmpi.b	#2,$3A(a0)	; is the ghost marked as "solid"?
0089D5E0 6600                       		bne.s	Obj09_GhostNotSolid ; if not, branch
0089D5E2 43F9 00FF 1020             		lea	($FF1020).l,a1
0089D5E8 723F                       		moveq	#$3F,d1
0089D5EA                            
0089D5EA                            Obj09_GhostLoop2:
0089D5EA 743F                       		moveq	#$3F,d2
0089D5EC                            
0089D5EC                            Obj09_GhostLoop:
0089D5EC 0C11 0041                  		cmpi.b	#$41,(a1)	; is the item a	ghost block?
0089D5F0 6600                       		bne.s	Obj09_NoReplace	; if not, branch
0089D5F2 12BC 002C                  		move.b	#$2C,(a1)	; replace ghost	block with a solid block
0089D5F6                            
0089D5F6                            Obj09_NoReplace:
0089D5F6 5249                       		addq.w	#1,a1
0089D5F8 51CA FFF2                  		dbf	d2,Obj09_GhostLoop
0089D5FC 43E9 0040                  		lea	$40(a1),a1
0089D600 51C9 FFE8                  		dbf	d1,Obj09_GhostLoop2
0089D604                            
0089D604                            Obj09_GhostNotSolid:
0089D604 4228 003A                  		clr.b	$3A(a0)
0089D608 7800                       		moveq	#0,d4
0089D60A 4E75                       		rts	
0089D60C                            ; End of function Obj09_ChkItems
0089D60C                            
0089D60C                            
0089D60C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D60C                            
0089D60C                            
0089D60C                            Obj09_ChkItems2:			; XREF: Obj09_Display
0089D60C 1028 0030                  		move.b	$30(a0),d0
0089D610 6600                       		bne.s	Obj09_ChkBumper
0089D612 5328 0036                  		subq.b	#1,$36(a0)
0089D616 6A00                       		bpl.s	loc_1BEA0
0089D618 117C 0000 0036             		move.b	#0,$36(a0)
0089D61E                            
0089D61E                            loc_1BEA0:
0089D61E 5328 0037                  		subq.b	#1,$37(a0)
0089D622 6A00                       		bpl.s	locret_1BEAC
0089D624 117C 0000 0037             		move.b	#0,$37(a0)
0089D62A                            
0089D62A                            locret_1BEAC:
0089D62A 4E75                       		rts	
0089D62C                            ; ===========================================================================
0089D62C                            
0089D62C                            Obj09_ChkBumper:
0089D62C 0C00 0025                  		cmpi.b	#$25,d0		; is the item a	bumper?
0089D630 6600                       		bne.s	Obj09_GOAL
0089D632 2228 0032                  		move.l	$32(a0),d1
0089D636 0481 00FF 0001             		subi.l	#$FF0001,d1
0089D63C 3401                       		move.w	d1,d2
0089D63E 0241 007F                  		andi.w	#$7F,d1
0089D642 C2FC 0018                  		mulu.w	#$18,d1
0089D646 0441 0014                  		subi.w	#$14,d1
0089D64A EE4A                       		lsr.w	#7,d2
0089D64C 0242 007F                  		andi.w	#$7F,d2
0089D650 C4FC 0018                  		mulu.w	#$18,d2
0089D654 0442 0044                  		subi.w	#$44,d2
0089D658 9268 0008                  		sub.w	obX(a0),d1
0089D65C 9468 000C                  		sub.w	obY(a0),d2
0089D660 4EB9 0088 32B4             		jsr	(CalcAngle).l
0089D666 4EB9 0088 301C             		jsr	(CalcSine).l
0089D66C C3FC F900                  		muls.w	#-$700,d1
0089D670 E081                       		asr.l	#8,d1
0089D672 3141 0010                  		move.w	d1,obVelX(a0)
0089D676 C1FC F900                  		muls.w	#-$700,d0
0089D67A E080                       		asr.l	#8,d0
0089D67C 3140 0012                  		move.w	d0,obVelY(a0)
0089D680 08E8 0001 0022             		bset	#1,obStatus(a0)
0089D686                            		
0089D686 08A8 0007 0022             		bclr	#7,obStatus(a0)	; clear "Sonic has jumped" flag
0089D68C                            	
0089D68C 6100 F520                  		bsr.w	SS_RemoveCollectedItem
0089D690 6600                       		bne.s	Obj09_BumpSnd
0089D692 14BC 0002                  		move.b	#2,(a2)
0089D696 2028 0032                  		move.l	$32(a0),d0
0089D69A 5380                       		subq.l	#1,d0
0089D69C 2540 0004                  		move.l	d0,4(a2)
0089D6A0                            
0089D6A0                            Obj09_BumpSnd:
0089D6AA                            ; ===========================================================================
0089D6AA                            
0089D6AA                            Obj09_GOAL:
0089D6AA 0C00 0027                  		cmpi.b	#$27,d0		; is the item a	"GOAL"?
0089D6AE 6600                       		bne.s	Obj09_UPblock
0089D6B0 5428 0024                  		addq.b	#2,obRoutine(a0) ; run routine "Obj09_ExitStage"
0089D6B4                            		
0089D6B4                            		
0089D6BE 4E75                       		rts	
0089D6C0                            ; ===========================================================================
0089D6C0                            
0089D6C0                            Obj09_UPblock:
0089D6C0 0C00 0029                  		cmpi.b	#$29,d0		; is the item an "UP" block?
0089D6C4 6600                       		bne.s	Obj09_DOWNblock
0089D6C6 4A28 0036                  		tst.b	$36(a0)
0089D6CA 6600 0000                  		bne.w	Obj09_NoGlass
0089D6CE 117C 001E 0036             		move.b	#$1E,$36(a0)
0089D6D4 0838 0006 F783             		btst	#6,($FFFFF783).w
0089D6DA 6700                       		beq.s	Obj09_UPsnd
0089D6DC E1F8 F782                  		asl	(v_ssrotate).w	; increase stage rotation speed
0089D6E0 2268 0032                  		movea.l	$32(a0),a1
0089D6E4 5389                       		subq.l	#1,a1
0089D6E6 12BC 002A                  		move.b	#$2A,(a1)	; change item to a "DOWN" block
0089D6EA                            
0089D6EA                            Obj09_UPsnd:
0089D6F4                            ; ===========================================================================
0089D6F4                            
0089D6F4                            Obj09_DOWNblock:
0089D6F4 0C00 002A                  		cmpi.b	#$2A,d0		; is the item a	"DOWN" block?
0089D6F8 6600                       		bne.s	Obj09_Rblock
0089D6FA 4A28 0036                  		tst.b	$36(a0)
0089D6FE 6600 0000                  		bne.w	Obj09_NoGlass
0089D702 117C 001E 0036             		move.b	#$1E,$36(a0)
0089D708 0838 0006 F783             		btst	#6,(v_ssrotate+1).w
0089D70E 6600                       		bne.s	Obj09_DOWNsnd
0089D710 E0F8 F782                  		asr	(v_ssrotate).w	; reduce stage rotation speed
0089D714 2268 0032                  		movea.l	$32(a0),a1
0089D718 5389                       		subq.l	#1,a1
0089D71A 12BC 0029                  		move.b	#$29,(a1)	; change item to an "UP" block
0089D71E                            
0089D71E                            Obj09_DOWNsnd:
0089D728                            ; ===========================================================================
0089D728                            
0089D728                            Obj09_Rblock:
0089D728 0C00 002B                  		cmpi.b	#$2B,d0		; is the item an "R" block?
0089D72C 6600                       		bne.s	Obj09_ChkGlass
0089D72E 4A28 0037                  		tst.b	$37(a0)
0089D732 6600 0000                  		bne.w	Obj09_NoGlass
0089D736 117C 001E 0037             		move.b	#$1E,$37(a0)
0089D73C 6100 F470                  		bsr.w	SS_RemoveCollectedItem
0089D740 6600                       		bne.s	Obj09_RevStage
0089D742 14BC 0004                  		move.b	#4,(a2)
0089D746 2028 0032                  		move.l	$32(a0),d0
0089D74A 5380                       		subq.l	#1,d0
0089D74C 2540 0004                  		move.l	d0,4(a2)
0089D750                            
0089D750                            Obj09_RevStage:
0089D750 4478 F782                  		neg.w	(v_ssrotate).w	; reverse stage rotation
0089D75E                            ; ===========================================================================
0089D75E                            
0089D75E                            Obj09_ChkGlass:
0089D75E 0C00 002D                  		cmpi.b	#$2D,d0		; is the item a	glass block?
0089D762 6700                       		beq.s	Obj09_Glass	; if yes, branch
0089D764 0C00 002E                  		cmpi.b	#$2E,d0
0089D768 6700                       		beq.s	Obj09_Glass
0089D76A 0C00 002F                  		cmpi.b	#$2F,d0
0089D76E 6700                       		beq.s	Obj09_Glass
0089D770 0C00 0030                  		cmpi.b	#$30,d0
0089D774 6600                       		bne.s	Obj09_NoGlass	; if not, branch
0089D776                            
0089D776                            Obj09_Glass:
0089D776 6100 F436                  		bsr.w	SS_RemoveCollectedItem
0089D77A 6600                       		bne.s	Obj09_GlassSnd
0089D77C 14BC 0006                  		move.b	#6,(a2)
0089D780 2268 0032                  		movea.l	$32(a0),a1
0089D784 5389                       		subq.l	#1,a1
0089D786 2549 0004                  		move.l	a1,4(a2)
0089D78A 1011                       		move.b	(a1),d0
0089D78C 5200                       		addq.b	#1,d0		; change glass type when touched
0089D78E 0C00 0030                  		cmpi.b	#$30,d0
0089D792 6300                       		bls.s	Obj09_GlassUpdate ; if glass is	still there, branch
0089D794 4200                       		clr.b	d0		; remove the glass block when it's destroyed
0089D796                            
0089D796                            Obj09_GlassUpdate:
0089D796 1540 0004                  		move.b	d0,4(a2)	; update the stage layout
0089D79A                            
0089D79A                            Obj09_GlassSnd:
0089D7A4                            ; ===========================================================================
0089D7A4                            
0089D7A4                            Obj09_NoGlass:
0089D7A4 4E75                       		rts	
0089D7A6                            ; End of function Obj09_ChkItems2
0089D7A6                            ; End of function Obj09_ChkItems2
0089D7A6                            
0089D7A6                            		include	"_incObj\10.asm"
0089D7A6                            ; ---------------------------------------------------------------------------
0089D7A6                            ; Object 10 - blank
0089D7A6                            ; ---------------------------------------------------------------------------
0089D7A6                            
0089D7A6                            Obj10:					; XREF: Obj_Index
0089D7A6 4E75                       		rts	
0089D7A6 4E75                       		rts	
0089D7A8                            
0089D7A8                            		include	"_inc\AnimateLevelGfx.asm"
0089D7A8                            ; ---------------------------------------------------------------------------
0089D7A8                            ; Subroutine to	animate	level graphics
0089D7A8                            ; ---------------------------------------------------------------------------
0089D7A8                            
0089D7A8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089D7A8                            
0089D7A8                            
0089D7A8                            AnimateLevelGfx:			; XREF: Demo_Time; VBla_0C_NoChg
0089D7A8 4A78 F63A                  		tst.w	(f_pause).w	; is the game paused?
0089D7AC 6600                       		bne.s	@ispaused	; if yes, branch
0089D7AE 4DF9 00C0 0000             		lea	(vdp_data_port).l,a6
0089D7B4 6100 0000                  		bsr.w	AniArt_GiantRing
0089D7B8 7000                       		moveq	#0,d0
0089D7BA 1038 FE10                  		move.b	(v_zone).w,d0
0089D7BE D040                       		add.w	d0,d0
0089D7C0 303B 0000                  		move.w	AniArt_Index(pc,d0.w),d0
0089D7C4 4EFB 0000                  		jmp	AniArt_Index(pc,d0.w)
0089D7C8                            
0089D7C8                            	@ispaused:
0089D7C8 4E75                       		rts	
0089D7CA                            
0089D7CA                            ; ===========================================================================
0089D7CA 0000 0000                  AniArt_Index:	dc.w AniArt_GHZ-AniArt_Index, AniArt_none-AniArt_Index
0089D7CE 0000 0000                  		dc.w AniArt_MZ-AniArt_Index, AniArt_none-AniArt_Index
0089D7D2 0000 0000                  		dc.w AniArt_none-AniArt_Index, AniArt_SBZ-AniArt_Index
0089D7D6 0000                       		dc.w AniArt_Ending-AniArt_Index
0089D7D8                            ; ===========================================================================
0089D7D8                            ; ---------------------------------------------------------------------------
0089D7D8                            ; Animated pattern routine - Green Hill
0089D7D8                            ; ---------------------------------------------------------------------------
0089D7D8                            
0089D7D8                            AniArt_GHZ:				; XREF: AniArt_Index
0089D7D8                            
0089D7D8                            AniArt_GHZ_Waterfall:
0089D7D8                            
0089D7D8 =00000008                  @size:		= 8	; number of tiles per frame
0089D7D8                            
0089D7D8 5338 F7B1                  		subq.b	#1,(v_lani0_time).w ; decrement timer
0089D7DC 6A00                       		bpl.s	AniArt_GHZ_Bigflower ; branch if not 0
0089D7DE                            
0089D7DE 11FC 0005 F7B1             		move.b	#5,(v_lani0_time).w ; time to display each frame
0089D7E4 43F9 0000 0000             		lea	(Art_GhzWater).l,a1 ; load waterfall patterns
0089D7EA 1038 F7B0                  		move.b	(v_lani0_frame).w,d0
0089D7EE 5238 F7B0                  		addq.b	#1,(v_lani0_frame).w ; increment frame counter
0089D7F2 0240 0001                  		andi.w	#1,d0		; there are only 2 frames
0089D7F6 6700                       		beq.s	@isframe0	; branch if frame 0
0089D7F8 43E9 0100                  		lea	@size*$20(a1),a1 ; use graphics for frame 1
0089D7FC                            
0089D7FC                            	@isframe0:
0089D806 323C 0007                  		move.w	#@size-1,d1	; number of 8x8	tiles
0089D80A 6000 0000                  		bra.w	LoadTiles
0089D80E                            ; ===========================================================================
0089D80E                            
0089D80E                            AniArt_GHZ_Bigflower:
0089D80E                            
0089D80E =00000010                  @size:		= 16	; number of tiles per frame
0089D80E                            
0089D80E 5338 F7B3                  		subq.b	#1,(v_lani1_time).w
0089D812 6A00                       		bpl.s	AniArt_GHZ_Smallflower
0089D814                            
0089D814 11FC 000F F7B3             		move.b	#$F,(v_lani1_time).w
0089D81A 43F9 0000 0000             		lea	(Art_GhzFlower1).l,a1 ;	load big flower	patterns
0089D820 1038 F7B2                  		move.b	(v_lani1_frame).w,d0
0089D824 5238 F7B2                  		addq.b	#1,(v_lani1_frame).w
0089D828 0240 0001                  		andi.w	#1,d0
0089D82C 6700                       		beq.s	@isframe0
0089D82E 43E9 0200                  		lea	@size*$20(a1),a1
0089D832                            
0089D832                            	@isframe0:
0089D83C 323C 000F                  		move.w	#@size-1,d1
0089D840 6000 0000                  		bra.w	LoadTiles
0089D844                            ; ===========================================================================
0089D844                            
0089D844                            AniArt_GHZ_Smallflower:
0089D844 5338 F7B5                  		subq.b	#1,(v_lani2_time).w
0089D848 6A00                       		bpl.s	@end
0089D84A                            
0089D84A 11FC 0007 F7B5             		move.b	#7,(v_lani2_time).w
0089D850 1038 F7B4                  		move.b	(v_lani2_frame).w,d0
0089D854 5238 F7B4                  		addq.b	#1,(v_lani2_frame).w ; increment frame counter
0089D858 0240 0003                  		andi.w	#3,d0		; there are 4 frames
0089D85C 103B 0000                  		move.b	@sequence(pc,d0.w),d0
0089D860 0800 0000                  		btst	#0,d0		; is frame 0 or 2? (actual frame, not frame counter)
0089D864 6600                       		bne.s	@isframe1	; if not, branch
0089D866 11FC 007F F7B5             		move.b	#$7F,(v_lani2_time).w ; set longer duration for frames 0 and 2
0089D86C                            
0089D86C                            	@isframe1:
0089D86C EF48                       		lsl.w	#7,d0		; multiply frame num by $80
0089D86E 3200                       		move.w	d0,d1
0089D870 D040                       		add.w	d0,d0
0089D872 D041                       		add.w	d1,d0		; multiply that by 3 (i.e. frame num times 12 * $20)
0089D87E 43F9 0000 0000             		lea	(Art_GhzFlower2).l,a1 ;	load small flower patterns
0089D884 43F1 0000                  		lea	(a1,d0.w),a1	; jump to appropriate tile
0089D888 323C 000B                  		move.w	#11,d1
0089D88C 6100 0000                  		bsr.w	LoadTiles
0089D890                            
0089D890                            @end:
0089D890 4E75                       		rts	
0089D892                            
0089D892 0001 0201                  @sequence:	dc.b 0,	1, 2, 1
0089D896                            ; ===========================================================================
0089D896                            ; ---------------------------------------------------------------------------
0089D896                            ; Animated pattern routine - Marble
0089D896                            ; ---------------------------------------------------------------------------
0089D896                            
0089D896                            AniArt_MZ:				; XREF: AniArt_Index
0089D896                            
0089D896                            AniArt_MZ_Lava:
0089D896                            
0089D896 =00000008                  @size:		= 8	; number of tiles per frame
0089D896                            
0089D896 5338 F7B1                  		subq.b	#1,(v_lani0_time).w ; decrement timer
0089D89A 6A00                       		bpl.s	AniArt_MZ_Magma	; branch if not 0
0089D89C                            
0089D89C 11FC 0013 F7B1             		move.b	#$13,(v_lani0_time).w ; time to display each frame
0089D8A2 43F9 0000 0000             		lea	(Art_MzLava1).l,a1 ; load lava surface patterns
0089D8A8 7000                       		moveq	#0,d0
0089D8AA 1038 F7B0                  		move.b	(v_lani0_frame).w,d0
0089D8AE 5200                       		addq.b	#1,d0		; increment frame counter
0089D8B0 0C00 0003                  		cmpi.b	#3,d0		; there are 3 frames
0089D8B4 6600                       		bne.s	@frame01or2	; branch if frame 0, 1 or 2
0089D8B6 7000                       		moveq	#0,d0
0089D8B8                            
0089D8B8                            	@frame01or2:
0089D8B8 11C0 F7B0                  		move.b	d0,(v_lani0_frame).w
0089D8BC C0FC 0100                  		mulu.w	#@size*$20,d0
0089D8C0 D2C0                       		adda.w	d0,a1		; jump to appropriate tile
0089D8CC 323C 0007                  		move.w	#@size-1,d1
0089D8D0 6100 0000                  		bsr.w	LoadTiles
0089D8D4                            
0089D8D4                            AniArt_MZ_Magma:
0089D8D4 5338 F7B3                  		subq.b	#1,(v_lani1_time).w ; decrement timer
0089D8D8 6A00                       		bpl.s	AniArt_MZ_Torch	; branch if not 0
0089D8DA                            		
0089D8DA 11FC 0001 F7B3             		move.b	#1,(v_lani1_time).w ; time between each gfx change
0089D8E0 7000                       		moveq	#0,d0
0089D8E2 1038 F7B0                  		move.b	(v_lani0_frame).w,d0 ; get surface lava frame number
0089D8E6 49F9 0000 0000             		lea	(Art_MzLava2).l,a4 ; load magma gfx
0089D8EC EE58                       		ror.w	#7,d0		; multiply frame num by $200
0089D8EE D8C0                       		adda.w	d0,a4		; jump to appropriate tile
0089D8FA 7600                       		moveq	#0,d3
0089D8FC 1638 F7B2                  		move.b	(v_lani1_frame).w,d3
0089D900 5238 F7B2                  		addq.b	#1,(v_lani1_frame).w ; increment frame counter (unused)
0089D904 1638 FE68                  		move.b	(v_oscillate+$A).w,d3 ; get oscillating value
0089D908 343C 0003                  		move.w	#3,d2
0089D90C                            
0089D90C                            	@loop:
0089D90C 3003                       		move.w	d3,d0
0089D90E D040                       		add.w	d0,d0
0089D910 0240 001E                  		andi.w	#$1E,d0
0089D914 47F9 0000 0000             		lea	(AniArt_MZextra).l,a3
0089D91A 3033 0000                  		move.w	(a3,d0.w),d0
0089D91E 47F3 0000                  		lea	(a3,d0.w),a3
0089D922 224C                       		movea.l	a4,a1
0089D924 323C 001F                  		move.w	#$1F,d1
0089D928 4E93                       		jsr	(a3)
0089D92A 5843                       		addq.w	#4,d3
0089D92C 51CA FFDE                  		dbf	d2,@loop
0089D930 4E75                       		rts	
0089D932                            ; ===========================================================================
0089D932                            
0089D932                            AniArt_MZ_Torch:
0089D932                            
0089D932 =00000006                  @size:		= 6	; number of tiles per frame
0089D932                            
0089D932 5338 F7B5                  		subq.b	#1,(v_lani2_time).w ; decrement timer
0089D936 6A00 0000                  		bpl.w	@end		; branch if not 0
0089D93A                            		
0089D93A 11FC 0007 F7B5             		move.b	#7,(v_lani2_time).w ; time to display each frame
0089D940 43F9 0000 0000             		lea	(Art_MzTorch).l,a1 ; load torch	patterns
0089D946 7000                       		moveq	#0,d0
0089D948 1038 F7B6                  		move.b	(v_lani3_frame).w,d0
0089D94C 5238 F7B6                  		addq.b	#1,(v_lani3_frame).w ; increment frame counter
0089D950 0238 0003 F7B6             		andi.b	#3,(v_lani3_frame).w ; there are 3 frames
0089D956 C0FC 00C0                  		mulu.w	#@size*$20,d0
0089D95A D2C0                       		adda.w	d0,a1		; jump to appropriate tile
0089D966 323C 0005                  		move.w	#@size-1,d1
0089D96A 6000 0000                  		bra.w	LoadTiles
0089D96E                            
0089D96E                            @end:
0089D96E 4E75                       		rts	
0089D970                            ; ===========================================================================
0089D970                            ; ---------------------------------------------------------------------------
0089D970                            ; Animated pattern routine - Scrap Brain
0089D970                            ; ---------------------------------------------------------------------------
0089D970                            
0089D970                            AniArt_SBZ:				; XREF: AniArt_Index
0089D970                            
0089D970 =0000000C                  @size:		= 12	; number of tiles per frame
0089D970                            
0089D970 4A38 F7B4                  		tst.b	(v_lani2_frame).w
0089D974 6700                       		beq.s	@smokepuff	; branch if counter hits 0
0089D976                            		
0089D976 5338 F7B4                  		subq.b	#1,(v_lani2_frame).w ; decrement counter
0089D97A 6000                       		bra.s	@chk_smokepuff2
0089D97C                            ; ===========================================================================
0089D97C                            
0089D97C                            @smokepuff:
0089D97C 5338 F7B1                  		subq.b	#1,(v_lani0_time).w ; decrement timer
0089D980 6A00                       		bpl.s	@chk_smokepuff2 ; branch if not 0
0089D982                            		
0089D982 11FC 0007 F7B1             		move.b	#7,(v_lani0_time).w ; time to display each frame
0089D988 43F9 0000 0000             		lea	(Art_SbzSmoke).l,a1 ; load smoke patterns
0089D998 1038 F7B0                  		move.b	(v_lani0_frame).w,d0
0089D99C 5238 F7B0                  		addq.b	#1,(v_lani0_frame).w ; increment frame counter
0089D9A0 0240 0007                  		andi.w	#7,d0
0089D9A4 6700                       		beq.s	@untilnextpuff	; branch if frame 0
0089D9A6 5340                       		subq.w	#1,d0
0089D9A8 C0FC 0180                  		mulu.w	#@size*$20,d0
0089D9AC 43F1 0000                  		lea	(a1,d0.w),a1
0089D9B0 323C 000B                  		move.w	#@size-1,d1
0089D9B4 6000 0000                  		bra.w	LoadTiles
0089D9B8                            ; ===========================================================================
0089D9B8                            
0089D9B8                            @untilnextpuff:
0089D9B8 11FC 00B4 F7B4             		move.b	#180,(v_lani2_frame).w ; time between smoke puffs (3 seconds)
0089D9BE                            
0089D9BE                            @clearsky:
0089D9BE 323C 0005                  		move.w	#(@size/2)-1,d1
0089D9C2 6100 0000                  		bsr.w	LoadTiles
0089D9C6 43F9 0000 0000             		lea	(Art_SbzSmoke).l,a1
0089D9CC 323C 0005                  		move.w	#(@size/2)-1,d1
0089D9D0 6000 0000                  		bra.w	LoadTiles	; load blank tiles for no smoke puff
0089D9D4                            ; ===========================================================================
0089D9D4                            
0089D9D4                            @chk_smokepuff2:
0089D9D4 4A38 F7B5                  		tst.b	(v_lani2_time).w
0089D9D8 6700                       		beq.s	@smokepuff2	; branch if counter hits 0
0089D9DA                            		
0089D9DA 5338 F7B5                  		subq.b	#1,(v_lani2_time).w ; decrement counter
0089D9DE 6000                       		bra.s	@end
0089D9E0                            ; ===========================================================================
0089D9E0                            
0089D9E0                            @smokepuff2:
0089D9E0 5338 F7B3                  		subq.b	#1,(v_lani1_time).w ; decrement timer
0089D9E4 6A00                       		bpl.s	@end		; branch if not 0
0089D9E6                            		
0089D9E6 11FC 0007 F7B3             		move.b	#7,(v_lani1_time).w ; time to display each frame
0089D9EC 43F9 0000 0000             		lea	(Art_SbzSmoke).l,a1 ; load smoke patterns
0089D9FC 1038 F7B2                  		move.b	(v_lani1_frame).w,d0
0089DA00 5238 F7B2                  		addq.b	#1,(v_lani1_frame).w ; increment frame counter
0089DA04 0240 0007                  		andi.w	#7,d0
0089DA08 6700                       		beq.s	@untilnextpuff2	; branch if frame 0
0089DA0A 5340                       		subq.w	#1,d0
0089DA0C C0FC 0180                  		mulu.w	#@size*$20,d0
0089DA10 43F1 0000                  		lea	(a1,d0.w),a1
0089DA14 323C 000B                  		move.w	#@size-1,d1
0089DA18 6000 0000                  		bra.w	LoadTiles
0089DA1C                            ; ===========================================================================
0089DA1C                            
0089DA1C                            @untilnextpuff2:
0089DA1C 11FC 0078 F7B5             		move.b	#120,(v_lani2_time).w ; time between smoke puffs (2 seconds)
0089DA22 609A                       		bra.s	@clearsky
0089DA24                            ; ===========================================================================
0089DA24                            
0089DA24                            @end:
0089DA24 4E75                       		rts	
0089DA26                            ; ===========================================================================
0089DA26                            ; ---------------------------------------------------------------------------
0089DA26                            ; Animated pattern routine - ending sequence
0089DA26                            ; ---------------------------------------------------------------------------
0089DA26                            
0089DA26                            AniArt_Ending:				; XREF: AniArt_Index
0089DA26                            
0089DA26                            AniArt_Ending_BigFlower:
0089DA26                            
0089DA26 =00000010                  @size:		= 16	; number of tiles per frame
0089DA26                            
0089DA26 5338 F7B3                  		subq.b	#1,(v_lani1_time).w ; decrement timer
0089DA2A 6A00                       		bpl.s	AniArt_Ending_SmallFlower ; branch if not 0
0089DA2C                            		
0089DA2C 11FC 0007 F7B3             		move.b	#7,(v_lani1_time).w
0089DA32 43F9 0000 0000             		lea	(Art_GhzFlower1).l,a1 ;	load big flower	patterns
0089DA38 45F8 9400                  		lea	($FFFF9400).w,a2 ; load 2nd big flower from RAM
0089DA3C 1038 F7B2                  		move.b	(v_lani1_frame).w,d0
0089DA40 5238 F7B2                  		addq.b	#1,(v_lani1_frame).w ; increment frame counter
0089DA44 0240 0001                  		andi.w	#1,d0		; only 2 frames
0089DA48 6700                       		beq.s	@isframe0	; branch if frame 0
0089DA4A 43E9 0200                  		lea	@size*$20(a1),a1
0089DA4E 45EA 0200                  		lea	@size*$20(a2),a2
0089DA52                            
0089DA52                            	@isframe0:
0089DA5C 323C 000F                  		move.w	#@size-1,d1
0089DA60 6100 0000                  		bsr.w	LoadTiles
0089DA64 224A                       		movea.l	a2,a1
0089DA70 323C 000F                  		move.w	#@size-1,d1
0089DA74 6000 0000                  		bra.w	LoadTiles
0089DA78                            ; ===========================================================================
0089DA78                            
0089DA78                            AniArt_Ending_SmallFlower:
0089DA78                            
0089DA78 =0000000C                  @size:		= 12	; number of tiles per frame
0089DA78                            
0089DA78 5338 F7B5                  		subq.b	#1,(v_lani2_time).w ; decrement timer
0089DA7C 6A00                       		bpl.s	AniArt_Ending_Flower3 ; branch if not 0
0089DA7E                            		
0089DA7E 11FC 0007 F7B5             		move.b	#7,(v_lani2_time).w
0089DA84 1038 F7B4                  		move.b	(v_lani2_frame).w,d0
0089DA88 5238 F7B4                  		addq.b	#1,(v_lani2_frame).w ; increment frame counter
0089DA8C 0240 0007                  		andi.w	#7,d0		; max 8 frames
0089DA90 103B 0000                  		move.b	@sequence(pc,d0.w),d0 ; get actual frame num from sequence data
0089DA94 EF48                       		lsl.w	#7,d0		; multiply by $80
0089DA96 3200                       		move.w	d0,d1
0089DA98 D040                       		add.w	d0,d0
0089DA9A D041                       		add.w	d1,d0		; multiply by 3
0089DAA6 43F9 0000 0000             		lea	(Art_GhzFlower2).l,a1 ;	load small flower patterns
0089DAAC 43F1 0000                  		lea	(a1,d0.w),a1	; jump to appropriate tile
0089DAB0 323C 000B                  		move.w	#@size-1,d1
0089DAB4 6000 0000                  		bra.w	LoadTiles
0089DAB8                            ; ===========================================================================
0089DAB8 0000 0001 0202 0201        @sequence:	dc.b 0,	0, 0, 1, 2, 2, 2, 1
0089DAC0                            ; ===========================================================================
0089DAC0                            
0089DAC0                            AniArt_Ending_Flower3:
0089DAC0                            
0089DAC0 =00000010                  @size:		= 16	; number of tiles per frame
0089DAC0                            
0089DAC0 5338 F7B9                  		subq.b	#1,(v_lani4_time).w ; decrement timer
0089DAC4 6A00                       		bpl.s	AniArt_Ending_Flower4 ; branch if not 0
0089DAC6                            		
0089DAC6 11FC 000E F7B9             		move.b	#$E,(v_lani4_time).w
0089DACC 1038 F7B8                  		move.b	(v_lani4_frame).w,d0
0089DAD0 5238 F7B8                  		addq.b	#1,(v_lani4_frame).w ; increment frame counter
0089DAD4 0240 0003                  		andi.w	#3,d0		; max 4 frames
0089DAD8 103B 0000                  		move.b	AniArt_Ending_Flower3_sequence(pc,d0.w),d0 ; get actual frame num from sequence data
0089DADC E148                       		lsl.w	#8,d0		; multiply by $100
0089DADE D040                       		add.w	d0,d0		; multiply by 2
0089DAEA 43F8 9800                  		lea	($FFFF9800).w,a1 ; load	special	flower patterns	(from RAM)
0089DAEE 43F1 0000                  		lea	(a1,d0.w),a1	; jump to appropriate tile
0089DAF2 323C 000F                  		move.w	#@size-1,d1
0089DAF6 6000 0000                  		bra.w	LoadTiles
0089DAFA                            ; ===========================================================================
0089DAFA 0001 0201                  AniArt_Ending_Flower3_sequence:	dc.b 0,	1, 2, 1
0089DAFE                            ; ===========================================================================
0089DAFE                            
0089DAFE                            AniArt_Ending_Flower4:
0089DAFE                            
0089DAFE =00000010                  @size:		= 16	; number of tiles per frame
0089DAFE                            
0089DAFE 5338 F7BB                  		subq.b	#1,(v_lani5_time).w ; decrement timer
0089DB02 6A00                       		bpl.s	@end		; branch if not 0
0089DB04                            		
0089DB04 11FC 000B F7BB             		move.b	#$B,(v_lani5_time).w
0089DB0A 1038 F7BA                  		move.b	(v_lani5_frame).w,d0
0089DB0E 5238 F7BA                  		addq.b	#1,(v_lani5_frame).w ; increment frame counter
0089DB12 0240 0003                  		andi.w	#3,d0
0089DB16 103B 00E2                  		move.b	AniArt_Ending_Flower3_sequence(pc,d0.w),d0 ; get actual frame num from sequence data
0089DB1A E148                       		lsl.w	#8,d0		; multiply by $100
0089DB1C D040                       		add.w	d0,d0		; multiply by 2
0089DB28 43F8 9E00                  		lea	($FFFF9E00).w,a1 ; load	special	flower patterns	(from RAM)
0089DB2C 43F1 0000                  		lea	(a1,d0.w),a1	; jump to appropriate tile
0089DB30 323C 000F                  		move.w	#@size-1,d1
0089DB34 6000 0000                  		bra.w	LoadTiles
0089DB38                            ; ===========================================================================
0089DB38                            
0089DB38                            @end:
0089DB38 4E75                       		rts	
0089DB3A                            ; ===========================================================================
0089DB3A                            
0089DB3A                            AniArt_none:				; XREF: AniArt_Index
0089DB3A 4E75                       		rts	
0089DB3C                            
0089DB3C                            ; ---------------------------------------------------------------------------
0089DB3C                            ; Subroutine to	transfer graphics to VRAM
0089DB3C                            
0089DB3C                            ; input:
0089DB3C                            ;	a1 = source address
0089DB3C                            ;	a6 = vdp_data_port ($C00000)
0089DB3C                            ;	d1 = number of tiles to load (minus one)
0089DB3C                            ; ---------------------------------------------------------------------------
0089DB3C                            
0089DB3C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DB3C                            
0089DB3C                            
0089DB3C                            LoadTiles:
0089DB3C 2C99                       		move.l	(a1)+,(a6)
0089DB3E 2C99                       		move.l	(a1)+,(a6)
0089DB40 2C99                       		move.l	(a1)+,(a6)
0089DB42 2C99                       		move.l	(a1)+,(a6)
0089DB44 2C99                       		move.l	(a1)+,(a6)
0089DB46 2C99                       		move.l	(a1)+,(a6)
0089DB48 2C99                       		move.l	(a1)+,(a6)
0089DB4A 2C99                       		move.l	(a1)+,(a6)
0089DB4C 51C9 FFEE                  		dbf	d1,LoadTiles
0089DB50 4E75                       		rts	
0089DB52                            ; End of function LoadTiles
0089DB52                            
0089DB52                            ; ===========================================================================
0089DB52                            ; ---------------------------------------------------------------------------
0089DB52                            ; Animated pattern routine - more Marble Zone
0089DB52                            ; ---------------------------------------------------------------------------
0089DB52 0000 0000                  AniArt_MZextra:	dc.w loc_1C3EE-AniArt_MZextra, loc_1C3FA-AniArt_MZextra
0089DB56 0000 0000                  		dc.w loc_1C410-AniArt_MZextra, loc_1C41E-AniArt_MZextra
0089DB5A 0000 0000                  		dc.w loc_1C434-AniArt_MZextra, loc_1C442-AniArt_MZextra
0089DB5E 0000 0000                  		dc.w loc_1C458-AniArt_MZextra, loc_1C466-AniArt_MZextra
0089DB62 0000 0000                  		dc.w loc_1C47C-AniArt_MZextra, loc_1C48A-AniArt_MZextra
0089DB66 0000 0000                  		dc.w loc_1C4A0-AniArt_MZextra, loc_1C4AE-AniArt_MZextra
0089DB6A 0000 0000                  		dc.w loc_1C4C4-AniArt_MZextra, loc_1C4D2-AniArt_MZextra
0089DB6E 0000 0000                  		dc.w loc_1C4E8-AniArt_MZextra, loc_1C4FA-AniArt_MZextra
0089DB72                            ; ===========================================================================
0089DB72                            
0089DB72                            loc_1C3EE:				; XREF: AniArt_MZextra
0089DB72 2C91                       		move.l	(a1),(a6)
0089DB74 43E9 0010                  		lea	$10(a1),a1
0089DB78 51C9 FFF8                  		dbf	d1,loc_1C3EE
0089DB7C 4E75                       		rts	
0089DB7E                            ; ===========================================================================
0089DB7E                            
0089DB7E                            loc_1C3FA:				; XREF: AniArt_MZextra
0089DB7E 2029 0002                  		move.l	2(a1),d0
0089DB82 1029 0001                  		move.b	1(a1),d0
0089DB86 E098                       		ror.l	#8,d0
0089DB88 2C80                       		move.l	d0,(a6)
0089DB8A 43E9 0010                  		lea	$10(a1),a1
0089DB8E 51C9 FFEE                  		dbf	d1,loc_1C3FA
0089DB92 4E75                       		rts	
0089DB94                            ; ===========================================================================
0089DB94                            
0089DB94                            loc_1C410:				; XREF: AniArt_MZextra
0089DB94 2CA9 0002                  		move.l	2(a1),(a6)
0089DB98 43E9 0010                  		lea	$10(a1),a1
0089DB9C 51C9 FFF6                  		dbf	d1,loc_1C410
0089DBA0 4E75                       		rts	
0089DBA2                            ; ===========================================================================
0089DBA2                            
0089DBA2                            loc_1C41E:				; XREF: AniArt_MZextra
0089DBA2 2029 0004                  		move.l	4(a1),d0
0089DBA6 1029 0003                  		move.b	3(a1),d0
0089DBAA E098                       		ror.l	#8,d0
0089DBAC 2C80                       		move.l	d0,(a6)
0089DBAE 43E9 0010                  		lea	$10(a1),a1
0089DBB2 51C9 FFEE                  		dbf	d1,loc_1C41E
0089DBB6 4E75                       		rts	
0089DBB8                            ; ===========================================================================
0089DBB8                            
0089DBB8                            loc_1C434:				; XREF: AniArt_MZextra
0089DBB8 2CA9 0004                  		move.l	4(a1),(a6)
0089DBBC 43E9 0010                  		lea	$10(a1),a1
0089DBC0 51C9 FFF6                  		dbf	d1,loc_1C434
0089DBC4 4E75                       		rts	
0089DBC6                            ; ===========================================================================
0089DBC6                            
0089DBC6                            loc_1C442:				; XREF: AniArt_MZextra
0089DBC6 2029 0006                  		move.l	6(a1),d0
0089DBCA 1029 0005                  		move.b	5(a1),d0
0089DBCE E098                       		ror.l	#8,d0
0089DBD0 2C80                       		move.l	d0,(a6)
0089DBD2 43E9 0010                  		lea	$10(a1),a1
0089DBD6 51C9 FFEE                  		dbf	d1,loc_1C442
0089DBDA 4E75                       		rts	
0089DBDC                            ; ===========================================================================
0089DBDC                            
0089DBDC                            loc_1C458:				; XREF: AniArt_MZextra
0089DBDC 2CA9 0006                  		move.l	6(a1),(a6)
0089DBE0 43E9 0010                  		lea	$10(a1),a1
0089DBE4 51C9 FFF6                  		dbf	d1,loc_1C458
0089DBE8 4E75                       		rts	
0089DBEA                            ; ===========================================================================
0089DBEA                            
0089DBEA                            loc_1C466:				; XREF: AniArt_MZextra
0089DBEA 2029 0008                  		move.l	8(a1),d0
0089DBEE 1029 0007                  		move.b	7(a1),d0
0089DBF2 E098                       		ror.l	#8,d0
0089DBF4 2C80                       		move.l	d0,(a6)
0089DBF6 43E9 0010                  		lea	$10(a1),a1
0089DBFA 51C9 FFEE                  		dbf	d1,loc_1C466
0089DBFE 4E75                       		rts	
0089DC00                            ; ===========================================================================
0089DC00                            
0089DC00                            loc_1C47C:				; XREF: AniArt_MZextra
0089DC00 2CA9 0008                  		move.l	8(a1),(a6)
0089DC04 43E9 0010                  		lea	$10(a1),a1
0089DC08 51C9 FFF6                  		dbf	d1,loc_1C47C
0089DC0C 4E75                       		rts	
0089DC0E                            ; ===========================================================================
0089DC0E                            
0089DC0E                            loc_1C48A:				; XREF: AniArt_MZextra
0089DC0E 2029 000A                  		move.l	$A(a1),d0
0089DC12 1029 0009                  		move.b	9(a1),d0
0089DC16 E098                       		ror.l	#8,d0
0089DC18 2C80                       		move.l	d0,(a6)
0089DC1A 43E9 0010                  		lea	$10(a1),a1
0089DC1E 51C9 FFEE                  		dbf	d1,loc_1C48A
0089DC22 4E75                       		rts	
0089DC24                            ; ===========================================================================
0089DC24                            
0089DC24                            loc_1C4A0:				; XREF: AniArt_MZextra
0089DC24 2CA9 000A                  		move.l	$A(a1),(a6)
0089DC28 43E9 0010                  		lea	$10(a1),a1
0089DC2C 51C9 FFF6                  		dbf	d1,loc_1C4A0
0089DC30 4E75                       		rts	
0089DC32                            ; ===========================================================================
0089DC32                            
0089DC32                            loc_1C4AE:				; XREF: AniArt_MZextra
0089DC32 2029 000C                  		move.l	$C(a1),d0
0089DC36 1029 000B                  		move.b	$B(a1),d0
0089DC3A E098                       		ror.l	#8,d0
0089DC3C 2C80                       		move.l	d0,(a6)
0089DC3E 43E9 0010                  		lea	$10(a1),a1
0089DC42 51C9 FFEE                  		dbf	d1,loc_1C4AE
0089DC46 4E75                       		rts	
0089DC48                            ; ===========================================================================
0089DC48                            
0089DC48                            loc_1C4C4:				; XREF: AniArt_MZextra
0089DC48 2CA9 000C                  		move.l	$C(a1),(a6)
0089DC4C 43E9 0010                  		lea	$10(a1),a1
0089DC50 51C9 FFF6                  		dbf	d1,loc_1C4C4
0089DC54 4E75                       		rts	
0089DC56                            ; ===========================================================================
0089DC56                            
0089DC56                            loc_1C4D2:				; XREF: AniArt_MZextra
0089DC56 2029 000C                  		move.l	$C(a1),d0
0089DC5A E198                       		rol.l	#8,d0
0089DC5C 1029 0000                  		move.b	0(a1),d0
0089DC60 2C80                       		move.l	d0,(a6)
0089DC62 43E9 0010                  		lea	$10(a1),a1
0089DC66 51C9 FFEE                  		dbf	d1,loc_1C4D2
0089DC6A 4E75                       		rts	
0089DC6C                            ; ===========================================================================
0089DC6C                            
0089DC6C                            loc_1C4E8:				; XREF: AniArt_MZextra
0089DC6C 3CA9 000E                  		move.w	$E(a1),(a6)
0089DC70 3CA9 0000                  		move.w	0(a1),(a6)
0089DC74 43E9 0010                  		lea	$10(a1),a1
0089DC78 51C9 FFF2                  		dbf	d1,loc_1C4E8
0089DC7C 4E75                       		rts	
0089DC7E                            ; ===========================================================================
0089DC7E                            
0089DC7E                            loc_1C4FA:				; XREF: AniArt_MZextra
0089DC7E 2029 0000                  		move.l	0(a1),d0
0089DC82 1029 000F                  		move.b	$F(a1),d0
0089DC86 E098                       		ror.l	#8,d0
0089DC88 2C80                       		move.l	d0,(a6)
0089DC8A 43E9 0010                  		lea	$10(a1),a1
0089DC8E 51C9 FFEE                  		dbf	d1,loc_1C4FA
0089DC92 4E75                       		rts	
0089DC94                            
0089DC94                            ; ---------------------------------------------------------------------------
0089DC94                            ; Animated pattern routine - giant ring
0089DC94                            ; ---------------------------------------------------------------------------
0089DC94                            
0089DC94                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DC94                            
0089DC94                            
0089DC94                            AniArt_GiantRing:			; XREF: AnimateLevelGfx
0089DC94 4A78 F7BE                  		tst.w	(v_gfxbigring).w
0089DC98 6600                       		bne.s	loc_1C518
0089DC9A 4E75                       		rts	
0089DC9C                            ; ===========================================================================
0089DC9C                            
0089DC9C                            loc_1C518:
0089DC9C 0478 01C0 F7BE             		subi.w	#$1C0,(v_gfxbigring).w
0089DCA2 43F9 0000 0000             		lea	(Art_BigRing).l,a1 ; load giant	ring patterns
0089DCA8 7000                       		moveq	#0,d0
0089DCAA 3038 F7BE                  		move.w	(v_gfxbigring).w,d0
0089DCAE 43F1 0000                  		lea	(a1,d0.w),a1
0089DCB2 0640 8000                  		addi.w	#$8000,d0
0089DCB6 E588                       		lsl.l	#2,d0
0089DCB8 E448                       		lsr.w	#2,d0
0089DCBA 0040 4000                  		ori.w	#$4000,d0
0089DCBE 4840                       		swap	d0
0089DCC0 2D40 0004                  		move.l	d0,4(a6)
0089DCC4 323C 000D                  		move.w	#$D,d1
0089DCC8 6000 FE72                  		bra.w	LoadTiles
0089DCCC                            
0089DCCC                            ; End of function AniArt_GiantRing
0089DCCC                            ; End of function AniArt_GiantRing
0089DCCC                            
0089DCCC                            		include	"_incObj\21 HUD.asm"
0089DCCC                            ; ---------------------------------------------------------------------------
0089DCCC                            ; Object 21 - SCORE, TIME, RINGS
0089DCCC                            ; ---------------------------------------------------------------------------
0089DCCC                            
0089DCCC                            HUD:					; XREF: Obj_Index
0089DCCC 7000                       		moveq	#0,d0
0089DCCE 1028 0024                  		move.b	obRoutine(a0),d0
0089DCD2 323B 0000                  		move.w	HUD_Index(pc,d0.w),d1
0089DCD6 4EFB 1000                  		jmp	HUD_Index(pc,d1.w)
0089DCDA                            ; ===========================================================================
0089DCDA 0000                       HUD_Index:	dc.w HUD_Main-HUD_Index
0089DCDC 0000                       		dc.w HUD_Flash-HUD_Index
0089DCDE                            ; ===========================================================================
0089DCDE                            
0089DCDE                            HUD_Main:	; Routine 0
0089DCDE 5428 0024                  		addq.b	#2,obRoutine(a0)
0089DCE2 317C 0090 0008             		move.w	#$90,obX(a0)
0089DCE8 317C 0108 000A             		move.w	#$108,obScreenY(a0)
0089DCEE 217C 0000 0000 0004        		move.l	#Map_HUD,obMap(a0)
0089DCF6 317C 06BA 0002             		move.w	#$6CA-(HUDCentiseconds*$10),obGfx(a0)	;Mercury HUD Centiseconds
0089DCFC                            		
0089DCFC                            		
0089DCFC 117C 0000 0001             		move.b	#0,obRender(a0)
0089DD02 117C 0000 0018             		move.b	#0,obPriority(a0)
0089DD08                            
0089DD08                            HUD_Flash:	; Routine 2
0089DD08                            
0089DD08 7000                       		moveq	#0,d0	; d0 will be the frame to display; default is 0
0089DD0A 0838 0003 FE05             		btst	#3,(v_framebyte).w	; check the third bit of the frame counter byte. It's 0 for 4 frames, and then 1 for frames, and then repeats - perfect for flashing the HUD every 4 frames.
0089DD10 6600                       		bne.s	@display	; if it's on, skip straight to displaying the sprite using frame 0
0089DD12 4A78 FE20                  		tst.w	(v_rings).w	; do you have any rings?
0089DD16 6600                       		bne.s	@skip	; if so, skip the line that adds 1 to the frame (making RINGS red) 
0089DD18 5240                       		addq.w	#1,d0		; make ring counter flash red
0089DD1A                            	@skip:
0089DD1A                            	
0089DD1A                            	
0089DD1A 0C38 0009 FE23             		cmpi.b	#9,(v_timemin).w ; have	9 minutes elapsed?
0089DD20 6600                       		bne.s	@display	; if not, skip the line that adds 2 to the frame (making TIME red) 
0089DD22                            		
0089DD22                            	@add2:
0089DD22 5440                       		addq.w	#2,d0		; make time counter flash red
0089DD24                            
0089DD24                            	@display:
0089DD24 1140 001A                  		move.b	d0,obFrame(a0)
0089DD28 4EF9 0088 E3CC             		jmp	DisplaySprite
0089DD28 4EF9 0088 E3CC             		jmp	DisplaySprite
0089DD2E                            		
0089DD2E                            
0089DD2E                            		include	"_maps\(Mercury) HUD (centiseconds).asm"
0089DD2E                            ; ---------------------------------------------------------------------------
0089DD2E                            ; Sprite mappings - SCORE, TIME, RINGS
0089DD2E                            ; ---------------------------------------------------------------------------
0089DD2E 0000 0000                  Map_HUD:	dc.w @allyellow-Map_HUD, @ringred-Map_HUD
0089DD32 0000 0000                  		dc.w @timered-Map_HUD, @allred-Map_HUD
0089DD36                            		
0089DD36 0B                         @allyellow:	dc.b $B
0089DD37 800D 8010 00               		dc.b $80, $D, $80, $10, 0	; SCOR
0089DD3C 800D 8028 20               		dc.b $80, $D, $80, $28,	$20	; E nnn
0089DD41 800D 8030 40               		dc.b $80, $D, $80, $30,	$40	; nnnn
0089DD46 900D 8020 00               		dc.b $90, $D, $80, $20,	0	; TIME
0089DD4B 900D 8038 28               		dc.b $90, $D, $80, $38,	$28	; n'nn
0089DD50 9009 8000 48               			dc.b $90, 9, $80, $0,	$48	; "nn
0089DD55 A00D 8018 00               		dc.b $A0, $D, $80, $18, 0	; RING
0089DD5A A001 8010 20               		dc.b $A0, 1, $80, $10, $20	; S
0089DD5F A009 8040 30               		dc.b $A0, 9, $80, $40, $30	; rings
0089DD64 4005 811A 00               		dc.b $40, 5, $81, $1A, 0	; icon
0089DD69 400D 811E 10               		dc.b $40, $D, $81, $1E, $10	; SONIC x nn
0089DD6E 00                         		dc.b 0
0089DD6F 09                         @ringred:	dc.b $9
0089DD70 800D 8010 00               		dc.b $80, $D, $80, $10, 0	; SCOR
0089DD75 800D 8028 20               		dc.b $80, $D, $80, $28,	$20	; E nnn
0089DD7A 800D 8030 40               		dc.b $80, $D, $80, $30,	$40	; nnnn
0089DD7F 900D 8020 00               		dc.b $90, $D, $80, $20,	0	; TIME
0089DD84 900D 8038 28               		dc.b $90, $D, $80, $38,	$28	; n'nn
0089DD89 9009 8000 48               			dc.b $90, 9, $80, $0,	$48	; "nn
0089DD8E A009 8040 30               		dc.b $A0, 9, $80, $40, $30	; rings
0089DD93 4005 811A 00               		dc.b $40, 5, $81, $1A, 0	; icon
0089DD98 400D 811E 10               		dc.b $40, $D, $81, $1E, $10	; SONIC x nn
0089DD9D 00                         		dc.b 0
0089DD9E 0A                         @timered:	dc.b $A
0089DD9F 800D 8010 00               		dc.b $80, $D, $80, $10, 0	; SCOR
0089DDA4 800D 8028 20               		dc.b $80, $D, $80, $28,	$20	; E nnn
0089DDA9 800D 8030 40               		dc.b $80, $D, $80, $30,	$40	; nnnn
0089DDAE 900D 8038 28               		dc.b $90, $D, $80, $38,	$28	; n'nn
0089DDB3 9009 8000 48               			dc.b $90, 9, $80, $0,	$48	; "nn
0089DDB8 A00D 8018 00               		dc.b $A0, $D, $80, $18, 0	; RING
0089DDBD A001 8010 20               		dc.b $A0, 1, $80, $10, $20	; S
0089DDC2 A009 8040 30               		dc.b $A0, 9, $80, $40, $30	; rings
0089DDC7 4005 811A 00               		dc.b $40, 5, $81, $1A, 0	; icon
0089DDCC 400D 811E 10               		dc.b $40, $D, $81, $1E, $10	; SONIC x nn
0089DDD1 00                         		dc.b 0
0089DDD2 08                         @allred:	dc.b $8
0089DDD3 800D 8010 00               		dc.b $80, $D, $80, $10, 0	; SCOR
0089DDD8 800D 8028 20               		dc.b $80, $D, $80, $28,	$20	; E nnn
0089DDDD 800D 8030 40               		dc.b $80, $D, $80, $30,	$40	; nnnn
0089DDE2 900D 8038 28               		dc.b $90, $D, $80, $38,	$28	; n'nn
0089DDE7 9009 8000 48               			dc.b $90, 9, $80, $0,	$48	; "nn
0089DDEC A009 8040 30               		dc.b $A0, 9, $80, $40, $30	; rings
0089DDF1 4005 811A 00               		dc.b $40, 5, $81, $1A, 0	; icon
0089DDF6 400D 811E 10               		dc.b $40, $D, $81, $1E, $10	; SONIC x nn
0089DDFB                            		
0089DDFC 00                         		even
0089DDFC 00                         		even
0089DDFC                            	
0089DDFC                            	
0089DDFC                            
0089DDFC                            ; ---------------------------------------------------------------------------
0089DDFC                            ; Add points subroutine
0089DDFC                            ; ---------------------------------------------------------------------------
0089DDFC                            
0089DDFC                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DDFC                            
0089DDFC                            
0089DDFC                            AddPoints:
0089DDFC 11FC 0001 FE1F             		move.b	#1,(f_scorecount).w ; set score counter to update
0089DE02                            
0089DE02 47F8 FE26                  		lea     (v_score).w,a3
0089DE06 D193                       		add.l   d0,(a3)
0089DE08 223C 000F 423F             		move.l  #999999,d1
0089DE0E B293                       		cmp.l   (a3),d1 ; is score below 999999?
0089DE10 6200                       		bhi.s   @belowmax ; if yes, branch
0089DE12 2681                       		move.l  d1,(a3) ; reset score to 999999
0089DE14                            	@belowmax:
0089DE14 2013                       		move.l  (a3),d0
0089DE16 B0B8 FFC0                  		cmp.l   (v_scorelife).w,d0 ; has Sonic got 50000+ points?
0089DE1A 6500                       		bcs.s   @noextralife ; if not, branch
0089DE1C                            
0089DE1C 06B8 0000 1388 FFC0        		addi.l  #5000,(v_scorelife).w ; increase requirement by 50000
0089DE24 4A38 FFF8                  		tst.b   (v_megadrive).w
0089DE28 6B00                       		bmi.s   @noextralife ; branch if Mega Drive is Japanese
0089DE2A                            			
0089DE2A                            	;Mercury Lives Over/Underflow Fix
0089DE2A 0C38 0063 FE12             		cmpi.b	#$63,(v_lives).w	; are lives at max?
0089DE30 6700                       		beq.s	@playbgm
0089DE32 5238 FE12                  		addq.b	#1,(v_lives).w	; add 1 to number of lives
0089DE36 5238 FE1C                  		addq.b	#1,(f_lifecount).w ; update the lives counter
0089DE3A                            	@playbgm:
0089DE3A                            	;end Lives Over/Underflow Fix
0089DE3A                            			
0089DE44                            
0089DE44                            @locret_1C6B6:
0089DE44                            @noextralife:
0089DE44 4E75                       		rts	
0089DE46                            ; End of function AddPoints
0089DE46                            
0089DE46                            		include	"_inc\HUD_Update.asm"
0089DE46                            ; ---------------------------------------------------------------------------
0089DE46                            ; Subroutine to	update the HUD
0089DE46                            ; ---------------------------------------------------------------------------
0089DE46                            
0089DE46                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DE46                            
0089DE46                            hudVRAM:	macro loc
0089DE46                            		move.l	#($40000000+((loc&$3FFF)<<16)+((loc&$C000)>>14)),d0
0089DE46                            		endm
0089DE46                            
0089DE46                            
0089DE46                            HUD_Update:
0089DE46 4A78 FFFA                  		tst.w	(f_debugmode).w	; is debug mode	on?
0089DE4A 6600 0000                  		bne.w	HudDebug	; if yes, branch
0089DE4E 4A38 FE1F                  		tst.b	(f_scorecount).w ; does the score need updating?
0089DE52 6700                       		beq.s	@chkrings	; if not, branch
0089DE54                            
0089DE54 4238 FE1F                  		clr.b	(f_scorecount).w
0089DE58 203C 5C80 0003             		hudVRAM	$DC80		; set VRAM address
0089DE5E 2238 FE26                  		move.l	(v_score).w,d1	; load score
0089DE62 6100 0000                  		bsr.w	Hud_Score
0089DE66                            
0089DE66                            	@chkrings:
0089DE66 4A38 FE1D                  		tst.b	(f_ringcount).w	; does the ring	counter	need updating?
0089DE6A 6700                       		beq.s	@chktime	; if not, branch
0089DE6C 6A00                       		bpl.s	@notzero
0089DE6E 6100 0000                  		bsr.w	Hud_LoadZero	; reset rings to 0 if Sonic is hit
0089DE72                            
0089DE72                            	@notzero:
0089DE72 4238 FE1D                  		clr.b	(f_ringcount).w
0089DE76 203C 5F40 0003             		hudVRAM	$DF40		; set VRAM address
0089DE7C 7200                       		moveq	#0,d1
0089DE7E 3238 FE20                  		move.w	(v_rings).w,d1	; load number of rings
0089DE82 6100 0000                  		bsr.w	Hud_Rings
0089DE86                            
0089DE86                            	@chktime:
0089DE86 4A38 FE1E                  		tst.b	(f_timecount).w	; does the time	need updating?
0089DE8A 6700 0000                  		beq.w	@chklives	; if not, branch
0089DE8E 4A78 F63A                  		tst.w	(f_pause).w	; is the game paused?
0089DE92 6600 0000                  		bne.w	@chklives	; if yes, branch
0089DE96 43F8 FE22                  		lea	(v_time).w,a1
0089DE9A                            		
0089DE9A 0C99 0009 3B63             		cmpi.l	#$93B63,(a1)+	; is the time 9'59"99?
0089DEA0 6700 0000                  		beq.w	TimeOver	; if yes, branch	;Mercury HUD In Special Stage (bsr.s => bsr.w)
0089DEA4 1238 FEBF                  		move.b	(v_centstep).w,d1
0089DEA8 0601 0001                  		addi.b	#1,d1
0089DEAC 0C01 0003                  		cmpi.b	#3,d1
0089DEB0 6600                       		bne.s	@skip
0089DEB2 123C 0000                  		move.b	#0,d1
0089DEB6                            		
0089DEB6                            	@skip:
0089DEB6 11C1 FEBF                  		move.b	d1,(v_centstep).w
0089DEBA 0C01 0002                  		cmpi.b	#2,d1
0089DEBE 6700                       		beq.s	@skip2
0089DEC0 0601 0001                  		addi.b	#1,d1
0089DEC4                            		
0089DEC4                            	@skip2:
0089DEC4 D321                       		add.b	d1,-(a1)
0089DEC6 0C11 0064                  		cmpi.b	#100,(a1)
0089DECA 6500                       		bcs.s	@DoCent
0089DECC                            	
0089DECC 12BC 0000                  		move.b	#0,(a1)
0089DED0 5221                       		addq.b	#1,-(a1)	; increment second counter
0089DED2 0C11 003C                  		cmpi.b	#60,(a1)	; check if passed 60
0089DED6 6500                       		bcs.s	@updatetime
0089DED8 12BC 0000                  		move.b	#0,(a1)
0089DEDC 5221                       		addq.b	#1,-(a1)	; increment minute counter
0089DEDE 0C11 0009                  		cmpi.b	#9,(a1)		; check if passed 9
0089DEE2 6500                       		bcs.s	@updatetime
0089DEE4 12BC 0009                  		move.b	#9,(a1)		; keep as 9
0089DEE8                            
0089DEE8                            	@updatetime:
0089DEE8 203C 5E40 0003             		hudVRAM	$DE40
0089DEEE 7200                       		moveq	#0,d1
0089DEF0 1238 FE23                  		move.b	(v_timemin).w,d1 ; load	minutes
0089DEF4 6100 0000                  		bsr.w	Hud_Mins
0089DEF8 203C 5EC0 0003             		hudVRAM	$DEC0
0089DEFE 7200                       		moveq	#0,d1
0089DF00 1238 FE24                  		move.b	(v_timesec).w,d1 ; load	seconds
0089DF04 6100 0000                  		bsr.w	Hud_Secs
0089DF08                            		
0089DF08                            	@DoCent:
0089DF08 203C 5780 0003             		hudVRAM	$D780	;Mercury Macros
0089DF0E 7200                       		moveq	#0,d1
0089DF10 1238 FE25                  		move.b	(v_timecent).w,d1 ; load	seconds
0089DF14 6100 0000                  		bsr.w	Hud_Secs
0089DF18                            
0089DF18                            	@chklives:
0089DF18 4A38 FE1C                  		tst.b	(f_lifecount).w ; does the lives counter need updating?
0089DF1C 6700                       		beq.s	@chkbonus	; if not, branch
0089DF1E 4238 FE1C                  		clr.b	(f_lifecount).w
0089DF22 6100 0000                  		bsr.w	Hud_Lives
0089DF26                            
0089DF26                            	@chkbonus:
0089DF26 4A38 F7D6                  		tst.b	(f_endactbonus).w ; do time/ring bonus counters need updating?
0089DF2A 6700                       		beq.s	@finish		; if not, branch
0089DF2C 4238 F7D6                  		clr.b	(f_endactbonus).w
0089DF3A 7200                       		moveq	#0,d1
0089DF3C 3238 F7D2                  		move.w	(v_timebonus).w,d1 ; load time bonus
0089DF40 6100 0000                  		bsr.w	Hud_TimeRingBonus
0089DF44 7200                       		moveq	#0,d1
0089DF46 3238 F7D4                  		move.w	(v_ringbonus).w,d1 ; load ring bonus
0089DF4A 6100 0000                  		bsr.w	Hud_TimeRingBonus
0089DF4E                            
0089DF4E                            	@finish:
0089DF4E 4E75                       		rts	
0089DF50                            ; ===========================================================================
0089DF50                            
0089DF50                            TimeOver:				; XREF: @chktime
0089DF50 4238 FE1E                  		clr.b	(f_timecount).w
0089DF54 41F8 D000                  		lea	(v_player).w,a0
0089DF58 2448                       		movea.l	a0,a2
0089DF5A 6100 E83A                  		bsr.w	KillSonic
0089DF5E 11FC 0001 FE1A             		move.b	#1,(f_timeover).w
0089DF64 4E75                       		rts	
0089DF66                            ; ===========================================================================
0089DF66                            
0089DF66                            HudDebug:				; XREF: HUD_Update
0089DF66 6100 0000                  		bsr.w	HudDb_XY
0089DF6A 4A38 FE1D                  		tst.b	(f_ringcount).w	; does the ring	counter	need updating?
0089DF6E 6700                       		beq.s	@objcounter	; if not, branch
0089DF70 6A00                       		bpl.s	@notzero
0089DF72 6100 0000                  		bsr.w	Hud_LoadZero	; reset rings to 0 if Sonic is hit
0089DF76                            
0089DF76                            	@notzero:
0089DF76 4238 FE1D                  		clr.b	(f_ringcount).w
0089DF7A 203C 5F40 0003             		hudVRAM	$DF40		; set VRAM address
0089DF80 7200                       		moveq	#0,d1
0089DF82 3238 FE20                  		move.w	(v_rings).w,d1	; load number of rings
0089DF86 6100 0000                  		bsr.w	Hud_Rings
0089DF8A                            
0089DF8A                            	@objcounter:
0089DF8A 203C 5EC0 0003             		hudVRAM	$DEC0		; set VRAM address
0089DF90 7200                       		moveq	#0,d1
0089DF92 1238 F62C                  		move.b	(v_spritecount).w,d1 ; load "number of objects" counter
0089DF96 6100 0000                  		bsr.w	Hud_Secs
0089DF9A 4A38 FE1C                  		tst.b	(f_lifecount).w ; does the lives counter need updating?
0089DF9E 6700                       		beq.s	@chkbonus	; if not, branch
0089DFA0 4238 FE1C                  		clr.b	(f_lifecount).w
0089DFA4 6100 0000                  		bsr.w	Hud_Lives
0089DFA8                            
0089DFA8                            	@chkbonus:
0089DFA8 4A38 F7D6                  		tst.b	(f_endactbonus).w ; does the ring/time bonus counter need updating?
0089DFAC 6700                       		beq.s	@finish		; if not, branch
0089DFAE 4238 F7D6                  		clr.b	(f_endactbonus).w
0089DFBC 7200                       		moveq	#0,d1
0089DFBE 3238 F7D2                  		move.w	(v_timebonus).w,d1 ; load time bonus
0089DFC2 6100 0000                  		bsr.w	Hud_TimeRingBonus
0089DFC6 7200                       		moveq	#0,d1
0089DFC8 3238 F7D4                  		move.w	(v_ringbonus).w,d1 ; load ring bonus
0089DFCC 6100 0000                  		bsr.w	Hud_TimeRingBonus
0089DFD0                            
0089DFD0                            	@finish:
0089DFD0 4E75                       		rts	
0089DFD2                            ; End of function HUD_Update
0089DFD2                            
0089DFD2                            ; ---------------------------------------------------------------------------
0089DFD2                            ; Subroutine to	load "0" on the	HUD
0089DFD2                            ; ---------------------------------------------------------------------------
0089DFD2                            
0089DFD2                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DFD2                            
0089DFD2                            
0089DFD2                            Hud_LoadZero:				; XREF: HUD_Update
0089DFDC 45FA 0000                  		lea	Hud_TilesZero(pc),a2
0089DFE0 343C 0002                  		move.w	#2,d2
0089DFE4 6000                       		bra.s	loc_1C83E
0089DFE6                            ; End of function Hud_LoadZero
0089DFE6                            
0089DFE6                            ; ---------------------------------------------------------------------------
0089DFE6                            ; Subroutine to	load " on the	HUD
0089DFE6                            ; ---------------------------------------------------------------------------
0089DFE6                            
0089DFE6                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DFE6                            
0089DFE6                            
0089DFE6                            Hud_LoadMarks:				; XREF: HUD_Update
0089DFF0 45FA 0000                  		lea	Hud_TilesMarks(pc),a2
0089DFF4 343C 0002                  		move.w	#2,d2
0089DFF8 6000                       		bra.s	loc_1C83E
0089DFFA                            ; End of function Hud_LoadMarks
0089DFFA                            
0089DFFA                            ; ---------------------------------------------------------------------------
0089DFFA                            ; Subroutine to	load uncompressed HUD patterns ("E", "0", colon)
0089DFFA                            ; ---------------------------------------------------------------------------
0089DFFA                            
0089DFFA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089DFFA                            
0089DFFA                            
0089DFFA                            Hud_Base:				; XREF: GM_Level; SS_EndLoop; GM_Ending
0089DFFA 4DF9 00C0 0000             		lea	($C00000).l,a6
0089E000 6100 0000                  		bsr.w	Hud_Lives
0089E004                            		
0089E004 61E0                       		bsr.s	Hud_LoadMarks
0089E006                            		
0089E010 45FA 0000                  		lea	Hud_TilesBase(pc),a2
0089E014 343C 000E                  		move.w	#$E,d2
0089E018                            
0089E018                            loc_1C83E:				; XREF: Hud_LoadZero
0089E018 43FA 0000                  		lea	Art_Hud(pc),a1
0089E01C                            
0089E01C                            loc_1C842:
0089E01C 323C 000F                  		move.w	#$F,d1
0089E020 101A                       		move.b	(a2)+,d0
0089E022 6B00                       		bmi.s	loc_1C85E
0089E024 4880                       		ext.w	d0
0089E026 EB48                       		lsl.w	#5,d0
0089E028 47F1 0000                  		lea	(a1,d0.w),a3
0089E02C                            
0089E02C                            loc_1C852:
0089E02C 2C9B                       		move.l	(a3)+,(a6)
0089E02E 51C9 FFFC                  		dbf	d1,loc_1C852
0089E032                            
0089E032                            loc_1C858:
0089E032 51CA FFE8                  		dbf	d2,loc_1C842
0089E036                            
0089E036 4E75                       		rts	
0089E038                            ; ===========================================================================
0089E038                            
0089E038                            loc_1C85E:
0089E038 2CBC 0000 0000             		move.l	#0,(a6)
0089E03E 51C9 FFF8                  		dbf	d1,loc_1C85E
0089E042                            
0089E042 60EE                       		bra.s	loc_1C858
0089E044                            ; End of function Hud_Base
0089E044                            
0089E044                            ; ===========================================================================
0089E044                            
0089E044 1A00 0000                  Hud_TilesMarks:	dc.b $1A, 0, 0, 0
0089E048 16FF FFFF FFFF FF00 0018+  Hud_TilesBase:	dc.b $16, $FF, $FF, $FF, $FF, $FF, $FF,	0, 0, $18, 0, 0
0089E054                            
0089E054 FFFF 0000                  Hud_TilesZero:	dc.b $FF, $FF, 0, 0
0089E058                            ; ---------------------------------------------------------------------------
0089E058                            ; Subroutine to	load debug mode	numbers	patterns
0089E058                            ; ---------------------------------------------------------------------------
0089E058                            
0089E058                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E058                            
0089E058                            
0089E058                            HudDb_XY:				; XREF: HudDebug
0089E062 3238 F700                  		move.w	(v_screenposx).w,d1 ; load camera x-position
0089E066 4841                       		swap	d1
0089E068 3238 D008                  		move.w	(v_player+obX).w,d1 ; load Sonic's x-position
0089E06C 6100                       		bsr.s	HudDb_XY2
0089E06E 3238 F704                  		move.w	(v_screenposy).w,d1 ; load camera y-position
0089E072 4841                       		swap	d1
0089E074 3238 D00C                  		move.w	(v_player+obY).w,d1 ; load Sonic's y-position
0089E078                            ; End of function HudDb_XY
0089E078                            
0089E078                            
0089E078                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E078                            
0089E078                            
0089E078                            HudDb_XY2:
0089E078 7C07                       		moveq	#7,d6
0089E07A 43F9 0088 0B0A             		lea	(Art_Text).l,a1
0089E080                            
0089E080                            HudDb_XYLoop:
0089E080 E959                       		rol.w	#4,d1
0089E082 3401                       		move.w	d1,d2
0089E084 0242 000F                  		andi.w	#$F,d2
0089E088 0C42 000A                  		cmpi.w	#$A,d2
0089E08C 6500                       		bcs.s	loc_1C8B2
0089E08E 5E42                       		addq.w	#7,d2
0089E090                            
0089E090                            loc_1C8B2:
0089E090 EB4A                       		lsl.w	#5,d2
0089E092 47F1 2000                  		lea	(a1,d2.w),a3
0089E096 2C9B                       		move.l	(a3)+,(a6)
0089E098 2C9B                       		move.l	(a3)+,(a6)
0089E09A 2C9B                       		move.l	(a3)+,(a6)
0089E09C 2C9B                       		move.l	(a3)+,(a6)
0089E09E 2C9B                       		move.l	(a3)+,(a6)
0089E0A0 2C9B                       		move.l	(a3)+,(a6)
0089E0A2 2C9B                       		move.l	(a3)+,(a6)
0089E0A4 2C9B                       		move.l	(a3)+,(a6)
0089E0A6 4841                       		swap	d1
0089E0A8 51CE FFD6                  		dbf	d6,HudDb_XYLoop	; repeat 7 more	times
0089E0AC                            
0089E0AC 4E75                       		rts	
0089E0AE                            ; End of function HudDb_XY2
0089E0AE                            
0089E0AE                            ; ---------------------------------------------------------------------------
0089E0AE                            ; Subroutine to	load rings numbers patterns
0089E0AE                            ; ---------------------------------------------------------------------------
0089E0AE                            
0089E0AE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E0AE                            
0089E0AE                            
0089E0AE                            Hud_Rings:				; XREF: HUD_Update
0089E0AE 45F9 0000 0000             		lea	(Hud_100).l,a2
0089E0B4 7C02                       		moveq	#2,d6
0089E0B6 6000                       		bra.s	Hud_LoadArt
0089E0B8                            ; End of function Hud_Rings
0089E0B8                            
0089E0B8                            ; ---------------------------------------------------------------------------
0089E0B8                            ; Subroutine to	load score numbers patterns
0089E0B8                            ; ---------------------------------------------------------------------------
0089E0B8                            
0089E0B8                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E0B8                            
0089E0B8                            
0089E0B8                            Hud_Score:				; XREF: HUD_Update
0089E0B8 45F9 0000 0000             		lea	(Hud_100000).l,a2
0089E0BE 7C05                       		moveq	#5,d6
0089E0C0                            
0089E0C0                            Hud_LoadArt:
0089E0C0 7800                       		moveq	#0,d4
0089E0C2 43FA 0000                  		lea	Art_Hud(pc),a1
0089E0C6                            
0089E0C6                            Hud_ScoreLoop:
0089E0C6 7400                       		moveq	#0,d2
0089E0C8 261A                       		move.l	(a2)+,d3
0089E0CA                            
0089E0CA                            loc_1C8EC:
0089E0CA 9283                       		sub.l	d3,d1
0089E0CC 6500                       		bcs.s	loc_1C8F4
0089E0CE 5242                       		addq.w	#1,d2
0089E0D0 60F8                       		bra.s	loc_1C8EC
0089E0D2                            ; ===========================================================================
0089E0D2                            
0089E0D2                            loc_1C8F4:
0089E0D2 D283                       		add.l	d3,d1
0089E0D4 4A42                       		tst.w	d2
0089E0D6 6700                       		beq.s	loc_1C8FE
0089E0D8 383C 0001                  		move.w	#1,d4
0089E0DC                            
0089E0DC                            loc_1C8FE:
0089E0DC                            	
0089E0DC 4A44                       		tst.w	d4
0089E0DE 6700                       		beq.s	loc_1C92C
0089E0E0                            	
0089E0E0 ED4A                       		lsl.w	#6,d2
0089E0E2 2D40 0004                  		move.l	d0,4(a6)
0089E0E6 47F1 2000                  		lea	(a1,d2.w),a3
0089E0EA 2C9B                       		move.l	(a3)+,(a6)
0089E0EC 2C9B                       		move.l	(a3)+,(a6)
0089E0EE 2C9B                       		move.l	(a3)+,(a6)
0089E0F0 2C9B                       		move.l	(a3)+,(a6)
0089E0F2 2C9B                       		move.l	(a3)+,(a6)
0089E0F4 2C9B                       		move.l	(a3)+,(a6)
0089E0F6 2C9B                       		move.l	(a3)+,(a6)
0089E0F8 2C9B                       		move.l	(a3)+,(a6)
0089E0FA 2C9B                       		move.l	(a3)+,(a6)
0089E0FC 2C9B                       		move.l	(a3)+,(a6)
0089E0FE 2C9B                       		move.l	(a3)+,(a6)
0089E100 2C9B                       		move.l	(a3)+,(a6)
0089E102 2C9B                       		move.l	(a3)+,(a6)
0089E104 2C9B                       		move.l	(a3)+,(a6)
0089E106 2C9B                       		move.l	(a3)+,(a6)
0089E108 2C9B                       		move.l	(a3)+,(a6)
0089E10A                            
0089E10A                            loc_1C92C:
0089E10A 0680 0040 0000             		addi.l	#$400000,d0
0089E110 51CE FFB4                  		dbf	d6,Hud_ScoreLoop
0089E114                            
0089E114 4E75                       		rts	
0089E116                            
0089E116                            ; End of function Hud_Score
0089E116                            
0089E116                            
0089E116                            ; ---------------------------------------------------------------------------
0089E116                            ; Subroutine to	load countdown numbers on the continue screen
0089E116                            ; ---------------------------------------------------------------------------
0089E116                            
0089E116                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E116                            
0089E116                            
0089E116                            ContScrCounter:				; XREF: GM_Continue
0089E120 4DF9 00C0 0000             		lea	($C00000).l,a6
0089E126 45F9 0000 0000             		lea	(Hud_10).l,a2
0089E12C 7C01                       		moveq	#1,d6
0089E12E 7800                       		moveq	#0,d4
0089E130 43FA 0000                  		lea	Art_Hud(pc),a1 ; load numbers patterns
0089E134                            
0089E134                            ContScr_Loop:
0089E134 7400                       		moveq	#0,d2
0089E136 261A                       		move.l	(a2)+,d3
0089E138                            
0089E138                            loc_1C95A:
0089E138 9283                       		sub.l	d3,d1
0089E13A 6500                       		bcs.s	loc_1C962
0089E13C 5242                       		addq.w	#1,d2
0089E13E 60F8                       		bra.s	loc_1C95A
0089E140                            ; ===========================================================================
0089E140                            
0089E140                            loc_1C962:
0089E140 D283                       		add.l	d3,d1
0089E142 ED4A                       		lsl.w	#6,d2
0089E144 47F1 2000                  		lea	(a1,d2.w),a3
0089E148 2C9B                       		move.l	(a3)+,(a6)
0089E14A 2C9B                       		move.l	(a3)+,(a6)
0089E14C 2C9B                       		move.l	(a3)+,(a6)
0089E14E 2C9B                       		move.l	(a3)+,(a6)
0089E150 2C9B                       		move.l	(a3)+,(a6)
0089E152 2C9B                       		move.l	(a3)+,(a6)
0089E154 2C9B                       		move.l	(a3)+,(a6)
0089E156 2C9B                       		move.l	(a3)+,(a6)
0089E158 2C9B                       		move.l	(a3)+,(a6)
0089E15A 2C9B                       		move.l	(a3)+,(a6)
0089E15C 2C9B                       		move.l	(a3)+,(a6)
0089E15E 2C9B                       		move.l	(a3)+,(a6)
0089E160 2C9B                       		move.l	(a3)+,(a6)
0089E162 2C9B                       		move.l	(a3)+,(a6)
0089E164 2C9B                       		move.l	(a3)+,(a6)
0089E166 2C9B                       		move.l	(a3)+,(a6)
0089E168 51CE FFCA                  		dbf	d6,ContScr_Loop	; repeat 1 more	time
0089E16C                            
0089E16C 4E75                       		rts	
0089E16E                            ; End of function ContScrCounter
0089E16E                            
0089E16E                            ; ===========================================================================
0089E16E                            ; ---------------------------------------------------------------------------
0089E16E                            ; HUD counter sizes
0089E16E                            ; ---------------------------------------------------------------------------
0089E16E 0001 86A0                  Hud_100000:	dc.l 100000		; XREF: Hud_Score
0089E172 0000 2710                  Hud_10000:	dc.l 10000
0089E176 0000 03E8                  Hud_1000:	dc.l 1000		; XREF: Hud_TimeRingBonus
0089E17A 0000 0064                  Hud_100:	dc.l 100		; XREF: Hud_Rings
0089E17E 0000 000A                  Hud_10:		dc.l 10			; XREF: ContScrCounter; Hud_Secs; Hud_Lives
0089E182 0000 0001                  Hud_1:		dc.l 1			; XREF: Hud_Mins
0089E186                            
0089E186                            ; ---------------------------------------------------------------------------
0089E186                            ; Subroutine to	load time numbers patterns
0089E186                            ; ---------------------------------------------------------------------------
0089E186                            
0089E186                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E186                            
0089E186                            
0089E186                            Hud_Mins:				; XREF: Hud_ChkTime
0089E186 45F9 0089 E182             		lea	(Hud_1).l,a2
0089E18C 7C00                       		moveq	#0,d6
0089E18E 6000                       		bra.s	loc_1C9BA
0089E190                            ; End of function Hud_Mins
0089E190                            
0089E190                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E190                            
0089E190                            
0089E190                            Hud_Secs:				; XREF: Hud_ChkTime
0089E190 45F9 0089 E17E             		lea	(Hud_10).l,a2
0089E196 7C01                       		moveq	#1,d6
0089E198                            
0089E198                            loc_1C9BA:
0089E198 7800                       		moveq	#0,d4
0089E19A 43FA 0000                  		lea	Art_Hud(pc),a1
0089E19E                            
0089E19E                            Hud_TimeLoop:
0089E19E 7400                       		moveq	#0,d2
0089E1A0 261A                       		move.l	(a2)+,d3
0089E1A2                            
0089E1A2                            loc_1C9C4:
0089E1A2 9283                       		sub.l	d3,d1
0089E1A4 6500                       		bcs.s	loc_1C9CC
0089E1A6 5242                       		addq.w	#1,d2
0089E1A8 60F8                       		bra.s	loc_1C9C4
0089E1AA                            ; ===========================================================================
0089E1AA                            
0089E1AA                            loc_1C9CC:
0089E1AA D283                       		add.l	d3,d1
0089E1AC 4A42                       		tst.w	d2
0089E1AE 6700                       		beq.s	loc_1C9D6
0089E1B0 383C 0001                  		move.w	#1,d4
0089E1B4                            
0089E1B4                            loc_1C9D6:
0089E1B4 ED4A                       		lsl.w	#6,d2
0089E1B6 2D40 0004                  		move.l	d0,4(a6)
0089E1BA 47F1 2000                  		lea	(a1,d2.w),a3
0089E1BE 2C9B                       		move.l	(a3)+,(a6)
0089E1C0 2C9B                       		move.l	(a3)+,(a6)
0089E1C2 2C9B                       		move.l	(a3)+,(a6)
0089E1C4 2C9B                       		move.l	(a3)+,(a6)
0089E1C6 2C9B                       		move.l	(a3)+,(a6)
0089E1C8 2C9B                       		move.l	(a3)+,(a6)
0089E1CA 2C9B                       		move.l	(a3)+,(a6)
0089E1CC 2C9B                       		move.l	(a3)+,(a6)
0089E1CE 2C9B                       		move.l	(a3)+,(a6)
0089E1D0 2C9B                       		move.l	(a3)+,(a6)
0089E1D2 2C9B                       		move.l	(a3)+,(a6)
0089E1D4 2C9B                       		move.l	(a3)+,(a6)
0089E1D6 2C9B                       		move.l	(a3)+,(a6)
0089E1D8 2C9B                       		move.l	(a3)+,(a6)
0089E1DA 2C9B                       		move.l	(a3)+,(a6)
0089E1DC 2C9B                       		move.l	(a3)+,(a6)
0089E1DE 0680 0040 0000             		addi.l	#$400000,d0
0089E1E4 51CE FFB8                  		dbf	d6,Hud_TimeLoop
0089E1E8                            
0089E1E8 4E75                       		rts	
0089E1EA                            ; End of function Hud_Secs
0089E1EA                            
0089E1EA                            ; ---------------------------------------------------------------------------
0089E1EA                            ; Subroutine to	load time/ring bonus numbers patterns
0089E1EA                            ; ---------------------------------------------------------------------------
0089E1EA                            
0089E1EA                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E1EA                            
0089E1EA                            
0089E1EA                            Hud_TimeRingBonus:			; XREF: Hud_ChkBonus
0089E1EA 45F9 0089 E176             		lea	(Hud_1000).l,a2
0089E1F0 7C03                       		moveq	#3,d6
0089E1F2 7800                       		moveq	#0,d4
0089E1F4 43FA 0000                  		lea	Art_Hud(pc),a1
0089E1F8                            
0089E1F8                            Hud_BonusLoop:
0089E1F8 7400                       		moveq	#0,d2
0089E1FA 261A                       		move.l	(a2)+,d3
0089E1FC                            
0089E1FC                            loc_1CA1E:
0089E1FC 9283                       		sub.l	d3,d1
0089E1FE 6500                       		bcs.s	loc_1CA26
0089E200 5242                       		addq.w	#1,d2
0089E202 60F8                       		bra.s	loc_1CA1E
0089E204                            ; ===========================================================================
0089E204                            
0089E204                            loc_1CA26:
0089E204 D283                       		add.l	d3,d1
0089E206 4A42                       		tst.w	d2
0089E208 6700                       		beq.s	loc_1CA30
0089E20A 383C 0001                  		move.w	#1,d4
0089E20E                            
0089E20E                            loc_1CA30:
0089E20E 4A44                       		tst.w	d4
0089E210 6700                       		beq.s	Hud_ClrBonus
0089E212 ED4A                       		lsl.w	#6,d2
0089E214 47F1 2000                  		lea	(a1,d2.w),a3
0089E218 2C9B                       		move.l	(a3)+,(a6)
0089E21A 2C9B                       		move.l	(a3)+,(a6)
0089E21C 2C9B                       		move.l	(a3)+,(a6)
0089E21E 2C9B                       		move.l	(a3)+,(a6)
0089E220 2C9B                       		move.l	(a3)+,(a6)
0089E222 2C9B                       		move.l	(a3)+,(a6)
0089E224 2C9B                       		move.l	(a3)+,(a6)
0089E226 2C9B                       		move.l	(a3)+,(a6)
0089E228 2C9B                       		move.l	(a3)+,(a6)
0089E22A 2C9B                       		move.l	(a3)+,(a6)
0089E22C 2C9B                       		move.l	(a3)+,(a6)
0089E22E 2C9B                       		move.l	(a3)+,(a6)
0089E230 2C9B                       		move.l	(a3)+,(a6)
0089E232 2C9B                       		move.l	(a3)+,(a6)
0089E234 2C9B                       		move.l	(a3)+,(a6)
0089E236 2C9B                       		move.l	(a3)+,(a6)
0089E238                            
0089E238                            loc_1CA5A:
0089E238 51CE FFBE                  		dbf	d6,Hud_BonusLoop ; repeat 3 more times
0089E23C                            
0089E23C 4E75                       		rts	
0089E23E                            ; ===========================================================================
0089E23E                            
0089E23E                            Hud_ClrBonus:
0089E23E 7A0F                       		moveq	#$F,d5
0089E240                            
0089E240                            Hud_ClrBonusLoop:
0089E240 2CBC 0000 0000             		move.l	#0,(a6)
0089E246 51CD FFF8                  		dbf	d5,Hud_ClrBonusLoop
0089E24A                            
0089E24A 60EC                       		bra.s	loc_1CA5A
0089E24C                            ; End of function Hud_TimeRingBonus
0089E24C                            
0089E24C                            ; ---------------------------------------------------------------------------
0089E24C                            ; Subroutine to	load uncompressed lives	counter	patterns
0089E24C                            ; ---------------------------------------------------------------------------
0089E24C                            
0089E24C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E24C                            
0089E24C                            
0089E24C                            Hud_Lives:				; XREF: Hud_ChkLives
0089E24C 203C 7BA0 0003             		locVRAMd0	$FBA0	; move.l	#$7BA00003,d0	; set VRAM address ;Mercury Macros
0089E252 7200                       		moveq	#0,d1
0089E254 1238 FE12                  		move.b	(v_lives).w,d1	; load number of lives
0089E258 45F9 0089 E17E             		lea	(Hud_10).l,a2
0089E25E 7C01                       		moveq	#1,d6
0089E260 7800                       		moveq	#0,d4
0089E262 43FA 0000                  		lea	Art_LivesNums(pc),a1
0089E266                            
0089E266                            Hud_LivesLoop:
0089E266 2D40 0004                  		move.l	d0,4(a6)
0089E26A 7400                       		moveq	#0,d2
0089E26C 261A                       		move.l	(a2)+,d3
0089E26E                            
0089E26E                            loc_1CA90:
0089E26E 9283                       		sub.l	d3,d1
0089E270 6500                       		bcs.s	loc_1CA98
0089E272 5242                       		addq.w	#1,d2
0089E274 60F8                       		bra.s	loc_1CA90
0089E276                            ; ===========================================================================
0089E276                            
0089E276                            loc_1CA98:
0089E276 D283                       		add.l	d3,d1
0089E278 4A42                       		tst.w	d2
0089E27A 6700                       		beq.s	loc_1CAA2
0089E27C 383C 0001                  		move.w	#1,d4
0089E280                            
0089E280                            loc_1CAA2:
0089E280                            
0089E280 4A44                       		tst.w	d4
0089E282 6700                       		beq.s	Hud_ClrLives
0089E284                            
0089E284                            loc_1CAA6:
0089E284 EB4A                       		lsl.w	#5,d2
0089E286 47F1 2000                  		lea	(a1,d2.w),a3
0089E28A 2C9B                       		move.l	(a3)+,(a6)
0089E28C 2C9B                       		move.l	(a3)+,(a6)
0089E28E 2C9B                       		move.l	(a3)+,(a6)
0089E290 2C9B                       		move.l	(a3)+,(a6)
0089E292 2C9B                       		move.l	(a3)+,(a6)
0089E294 2C9B                       		move.l	(a3)+,(a6)
0089E296 2C9B                       		move.l	(a3)+,(a6)
0089E298 2C9B                       		move.l	(a3)+,(a6)
0089E29A                            
0089E29A                            loc_1CABC:
0089E29A 0680 0040 0000             		addi.l	#$400000,d0
0089E2A0 51CE FFC4                  		dbf	d6,Hud_LivesLoop ; repeat 1 more time
0089E2A4                            
0089E2A4 4E75                       		rts	
0089E2A6                            ; ===========================================================================
0089E2A6                            
0089E2A6                            Hud_ClrLives:
0089E2A6 4A46                       		tst.w	d6
0089E2A8 67DA                       		beq.s	loc_1CAA6
0089E2AA 7A07                       		moveq	#7,d5
0089E2AC                            
0089E2AC                            Hud_ClrLivesLoop:
0089E2AC 2CBC 0000 0000             		move.l	#0,(a6)
0089E2B2 51CD FFF8                  		dbf	d5,Hud_ClrLivesLoop
0089E2B6 60E2                       		bra.s	loc_1CABC
0089E2B8                            ; End of function Hud_Lives
0089E2B8                            ; End of function Hud_Lives
0089E2B8                            
0089E2B8                            
0089E2B8                            ; ===========================================================================
0089E2B8                            
0089E2B8                            Art_Hud:	incbin	"artunc\(Mercury) HUD Numbers (centiseconds).bin" ; 8x16 pixel numbers on HUD
0089E638                            		even
0089E638                            
0089E638                            Art_LivesNums:	incbin	"artunc\Lives Counter Numbers.bin" ; 8x8 pixel numbers on lives counter
0089E778                            		even
0089E778                            
0089E778                            		include	"_incObj\DebugMode.asm"
0089E778                            ; ---------------------------------------------------------------------------
0089E778                            ; When debug mode is currently in use
0089E778                            ; ---------------------------------------------------------------------------
0089E778                            
0089E778                            DebugMode:				; XREF: SonicPlayer; SpecialPlayer
0089E778 7000                       		moveq	#0,d0
0089E77A 1038 FE08                  		move.b	(v_debuguse).w,d0
0089E77E 323B 0000                  		move.w	Debug_Index(pc,d0.w),d1
0089E782 4EFB 1000                  		jmp	Debug_Index(pc,d1.w)
0089E786                            ; ===========================================================================
0089E786 0000                       Debug_Index:	dc.w Debug_Main-Debug_Index
0089E788 0000                       		dc.w Debug_Action-Debug_Index
0089E78A                            ; ===========================================================================
0089E78A                            
0089E78A                            Debug_Main:	; Routine 0
0089E78A 5438 FE08                  		addq.b	#2,(v_debuguse).w
0089E78E 31F8 F72C FEF0             		move.w	(v_limittop2).w,(v_limittopdb).w ; buffer level x-boundary
0089E794 31F8 F726 FEF2             		move.w	(v_limitbtm1).w,(v_limitbtmdb).w ; buffer level y-boundary
0089E79A 31FC 0000 F72C             		move.w	#0,(v_limittop2).w
0089E7A0 31FC 0720 F726             		move.w	#$720,(v_limitbtm1).w
0089E7A6 0278 07FF D00C             		andi.w	#$7FF,(v_player+obY).w
0089E7AC 0278 07FF F704             		andi.w	#$7FF,(v_screenposy).w
0089E7B2 0278 03FF F70C             		andi.w	#$3FF,($FFFFF70C).w
0089E7B8 117C 0000 001A             		move.b	#0,obFrame(a0)
0089E7BE 117C 0000 001C             		move.b	#id_Walk,obAnim(a0)
0089E7C4                            		
0089E7C4                            	;Mercury Debug Improvements
0089E7C4 4268 0010                  		clr.w	obVelX(a0)
0089E7C8 4268 0012                  		clr.w	obVelY(a0)
0089E7CC 4268 0014                  		clr.w	obInertia(a0)
0089E7D0 0828 0003 0022             		btst	#staOnObj,obStatus(a0)	; is Sonic standing on an object?	;Mercury Constants
0089E7D6 6700                       		beq.s	@setpos		; if not, branch
0089E7D8 08A8 0003 0022             		bclr	#staOnObj,obStatus(a0)	; clear Sonic's standing flag	;Mercury Constants
0089E7DE 7000                       		moveq	#0,d0
0089E7E0 1028 003D                  		move.b	obPlatformID(a0),d0	; get object id	;Mercury Constants
0089E7E4 4228 003D                  		clr.b	obPlatformID(a0)	; clear object id	;Mercury Constants
0089E7E8 ED48                       		lsl.w	#6,d0
0089E7EA 0680 00FF D000             		addi.l	#v_objspace&$FFFFFF,d0
0089E7F0 2440                       		movea.l	d0,a2
0089E7F2 08AA 0003 0022             		bclr	#staOnObj,obStatus(a2)	; clear object's standing flag	;Mercury Constants
0089E7F8 422A 0025                  		clr.b	obSolid(a2)
0089E7FC                            	@setpos:
0089E7FC                            	;end Debug Improvements
0089E7FC                            		
0089E7FC 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w ; is game mode $10 (special stage)?
0089E802 6600                       		bne.s	@islevel	; if not, branch
0089E804                            
0089E804 31FC 0000 F782             		move.w	#0,(v_ssrotate).w ; stop special stage rotating
0089E80A 31FC 0000 F780             		move.w	#0,(v_ssangle).w ; make	special	stage "upright"
0089E810 7006                       		moveq	#6,d0		; use 6th debug	item list
0089E812 6000                       		bra.s	@selectlist
0089E814                            ; ===========================================================================
0089E814                            
0089E814                            @islevel:
0089E814 7000                       		moveq	#0,d0
0089E816 1038 FE10                  		move.b	(v_zone).w,d0
0089E81A                            
0089E81A                            @selectlist:
0089E81A 45F9 0000 0000             		lea	(DebugList).l,a2
0089E820 D040                       		add.w	d0,d0
0089E822 D4F2 0000                  		adda.w	(a2,d0.w),a2
0089E826 3C1A                       		move.w	(a2)+,d6
0089E828 BC38 FE06                  		cmp.b	(v_debugitem).w,d6 ; have you gone past the last item?
0089E82C 6200                       		bhi.s	@noreset	; if not, branch
0089E82E 11FC 0000 FE06             		move.b	#0,(v_debugitem).w ; back to start of list
0089E834                            
0089E834                            	@noreset:
0089E834 6100 0000                  		bsr.w	Debug_ShowItem
0089E838 11FC 000C FE0A             		move.b	#12,(v_debugxspeed).w
0089E83E 11FC 0001 FE0B             		move.b	#1,(v_debugyspeed).w
0089E844                            
0089E844                            Debug_Action:	; Routine 2
0089E844 7006                       		moveq	#6,d0
0089E846 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w
0089E84C 6700                       		beq.s	@isntlevel
0089E84E                            
0089E84E 7000                       		moveq	#0,d0
0089E850 1038 FE10                  		move.b	(v_zone).w,d0
0089E854                            
0089E854                            	@isntlevel:
0089E854 45F9 0000 0000             		lea	(DebugList).l,a2
0089E85A D040                       		add.w	d0,d0
0089E85C D4F2 0000                  		adda.w	(a2,d0.w),a2
0089E860 3C1A                       		move.w	(a2)+,d6
0089E862 6100 0000                  		bsr.w	Debug_Control
0089E866 4EF9 0088 E3CC             		jmp	DisplaySprite
0089E86C                            
0089E86C                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E86C                            
0089E86C                            
0089E86C                            Debug_Control:
0089E86C 7800                       		moveq	#0,d4
0089E86E 323C 0001                  		move.w	#1,d1
0089E872 1838 F605                  		move.b	(v_jpadpress1).w,d4
0089E876 0244 000F                  		andi.w	#btnDir,d4	; is up/down/left/right	pressed?
0089E87A 6600                       		bne.s	@dirpressed	; if yes, branch
0089E87C                            
0089E87C 1038 F604                  		move.b	(v_jpadhold1).w,d0
0089E880 0240 000F                  		andi.w	#btnDir,d0	; is up/down/left/right	held?
0089E884 6600                       		bne.s	@dirheld	; if yes, branch
0089E886                            
0089E886 11FC 000C FE0A             		move.b	#12,(v_debugxspeed).w
0089E88C 11FC 000F FE0B             		move.b	#15,(v_debugyspeed).w
0089E892 6000 0000                  		bra.w	Debug_ChgItem
0089E896                            ; ===========================================================================
0089E896                            
0089E896                            @dirheld:
0089E896 5338 FE0A                  		subq.b	#1,(v_debugxspeed).w
0089E89A 6600                       		bne.s	loc_1D01C
0089E89C 11FC 0001 FE0A             		move.b	#1,(v_debugxspeed).w
0089E8A2 5238 FE0B                  		addq.b	#1,(v_debugyspeed).w
0089E8A6 6600                       		bne.s	@dirpressed
0089E8A8 11FC 00FF FE0B             		move.b	#-1,(v_debugyspeed).w
0089E8AE                            
0089E8AE                            @dirpressed:
0089E8AE 1838 F604                  		move.b	(v_jpadhold1).w,d4
0089E8B2                            
0089E8B2                            loc_1D01C:
0089E8B2 7200                       		moveq	#0,d1
0089E8B4 1238 FE0B                  		move.b	(v_debugyspeed).w,d1
0089E8B8 5241                       		addq.w	#1,d1
0089E8BA 4841                       		swap	d1
0089E8BC E881                       		asr.l	#4,d1
0089E8BE 2428 000C                  		move.l	obY(a0),d2
0089E8C2 2628 0008                  		move.l	obX(a0),d3
0089E8C6 0804 0000                  		btst	#bitUp,d4	; is up	being pressed?
0089E8CA 6700                       		beq.s	loc_1D03C	; if not, branch
0089E8CC 9481                       		sub.l	d1,d2
0089E8CE 6400                       		bcc.s	loc_1D03C
0089E8D0 7400                       		moveq	#0,d2
0089E8D2                            
0089E8D2                            loc_1D03C:
0089E8D2 0804 0001                  		btst	#bitDn,d4	; is down being	pressed?
0089E8D6 6700                       		beq.s	loc_1D052	; if not, branch
0089E8D8 D481                       		add.l	d1,d2
0089E8DA 0C82 07FF 0000             		cmpi.l	#$7FF0000,d2
0089E8E0 6500                       		bcs.s	loc_1D052
0089E8E2 243C 07FF 0000             		move.l	#$7FF0000,d2
0089E8E8                            
0089E8E8                            loc_1D052:
0089E8E8 0804 0002                  		btst	#bitL,d4
0089E8EC 6700                       		beq.s	loc_1D05E
0089E8EE 9681                       		sub.l	d1,d3
0089E8F0 6400                       		bcc.s	loc_1D05E
0089E8F2 7600                       		moveq	#0,d3
0089E8F4                            
0089E8F4                            loc_1D05E:
0089E8F4 0804 0003                  		btst	#bitR,d4
0089E8F8 6700                       		beq.s	loc_1D066
0089E8FA D681                       		add.l	d1,d3
0089E8FC                            
0089E8FC                            loc_1D066:
0089E8FC 2142 000C                  		move.l	d2,obY(a0)
0089E900 2143 0008                  		move.l	d3,obX(a0)
0089E904                            
0089E904                            Debug_ChgItem:
0089E904 0838 0006 F604             		btst	#bitA,(v_jpadhold1).w ; is button A pressed?
0089E90A 6700                       		beq.s	@createitem	; if not, branch
0089E90C 0838 0005 F605             		btst	#bitC,(v_jpadpress1).w ; is button C pressed?
0089E912 6700                       		beq.s	@nextitem	; if not, branch
0089E914 5338 FE06                  		subq.b	#1,(v_debugitem).w ; go back 1 item
0089E918 6400                       		bcc.s	@display
0089E91A DD38 FE06                  		add.b	d6,(v_debugitem).w
0089E91E 6000                       		bra.s	@display
0089E920                            ; ===========================================================================
0089E920                            
0089E920                            @nextitem:
0089E920 0838 0006 F605             		btst	#bitA,(v_jpadpress1).w ; is button A pressed?
0089E926 6700                       		beq.s	@createitem	; if not, branch
0089E928 5238 FE06                  		addq.b	#1,(v_debugitem).w ; go forwards 1 item
0089E92C BC38 FE06                  		cmp.b	(v_debugitem).w,d6
0089E930 6200                       		bhi.s	@display
0089E932 11FC 0000 FE06             		move.b	#0,(v_debugitem).w ; loop back to first item
0089E938                            
0089E938                            	@display:
0089E938 6000 0000                  		bra.w	Debug_ShowItem
0089E93C                            ; ===========================================================================
0089E93C                            
0089E93C                            @createitem:
0089E93C 0838 0005 F605             		btst	#bitC,(v_jpadpress1).w ; is button C pressed?
0089E942 6700                       		beq.s	@backtonormal	; if not, branch
0089E944 4EB9 0088 E862             		jsr	FindFreeObj
0089E94A 6600                       		bne.s	@backtonormal
0089E94C                            		
0089E94C                            	;Mercury Debug Improvements
0089E94C 11FC 0000 FC02             		move.b	#0,(v_objstate+2).w
0089E952                            	;end ;Mercury Debug Improvements
0089E952                            		
0089E952 3368 0008 0008             		move.w	obX(a0),obX(a1)
0089E958 3368 000C 000C             		move.w	obY(a0),obY(a1)
0089E95E 1368 0004 0000             		move.b	4(a0),0(a1)	; create object
0089E964 1368 0001 0001             		move.b	obRender(a0),obRender(a1)
0089E96A 1368 0001 0022             		move.b	obRender(a0),obStatus(a1)
0089E970 0229 007F 0022             		andi.b	#$7F,obStatus(a1)
0089E976 7000                       		moveq	#0,d0
0089E978 1038 FE06                  		move.b	(v_debugitem).w,d0
0089E97C E748                       		lsl.w	#3,d0
0089E97E 1372 0004 0028             		move.b	4(a2,d0.w),obSubtype(a1)
0089E984 4E75                       		rts	
0089E986                            ; ===========================================================================
0089E986                            
0089E986                            @backtonormal:
0089E986 0838 0004 F605             		btst	#bitB,(v_jpadpress1).w ; is button B pressed?
0089E98C 6700                       		beq.s	@stayindebug	; if not, branch
0089E98E 7000                       		moveq	#0,d0
0089E990 31C0 FE08                  		move.w	d0,(v_debuguse).w ; deactivate debug mode
0089E994 21FC 0000 0000 D004        		move.l	#Map_Sonic,(v_player+obMap).w
0089E99C 31FC 0780 D002             		move.w	#$780,(v_player+obGfx).w
0089E9A2 11C0 D01C                  		move.b	d0,(v_player+obAnim).w
0089E9A6 3140 000A                  		move.w	d0,obX+2(a0)
0089E9AA 3140 000E                  		move.w	d0,obY+2(a0)
0089E9AE 31F8 FEF0 F72C             		move.w	(v_limittopdb).w,(v_limittop2).w ; restore level boundaries
0089E9B4 31F8 FEF2 F726             		move.w	(v_limitbtmdb).w,(v_limitbtm1).w
0089E9BA 0C38 0000 F600             		cmpi.b	#id_Special,(v_gamemode).w ; are you in the special stage?
0089E9C0 6600                       		bne.s	@stayindebug	; if not, branch
0089E9C2                            
0089E9C2 4278 F780                  		clr.w	(v_ssangle).w
0089E9C6 31FC 0040 F782             		move.w	#$40,(v_ssrotate).w ; set new level rotation speed
0089E9CC 21FC 0000 0000 D004        		move.l	#Map_Sonic,(v_player+obMap).w
0089E9D4 31FC 0780 D002             		move.w	#$780,(v_player+obGfx).w
0089E9DA 11FC 0002 D01C             		move.b	#id_Roll,(v_player+obAnim).w
0089E9E0 08F8 0002 D022             		bset	#2,(v_player+obStatus).w
0089E9E6 08F8 0001 D022             		bset	#1,(v_player+obStatus).w
0089E9EC                            
0089E9EC                            	@stayindebug:
0089E9EC 4E75                       		rts	
0089E9EE                            ; End of function Debug_Control
0089E9EE                            
0089E9EE                            
0089E9EE                            ; ||||||||||||||| S U B	R O U T	I N E |||||||||||||||||||||||||||||||||||||||
0089E9EE                            
0089E9EE                            
0089E9EE                            Debug_ShowItem:
0089E9EE 7000                       		moveq	#0,d0
0089E9F0 1038 FE06                  		move.b	(v_debugitem).w,d0
0089E9F4 E748                       		lsl.w	#3,d0
0089E9F6 2172 0000 0004             		move.l	(a2,d0.w),obMap(a0) ; load mappings for item
0089E9FC 3172 0006 0002             		move.w	6(a2,d0.w),obGfx(a0) ; load VRAM setting for item
0089EA02 1172 0005 001A             		move.b	5(a2,d0.w),obFrame(a0) ; load frame number for item
0089EA08 4E75                       		rts	
0089EA0A                            ; End of function Debug_ShowItem
0089EA0A                            ; End of function Debug_ShowItem
0089EA0A                            		include	"_inc\DebugList.asm"
0089EA0A                            ; ---------------------------------------------------------------------------
0089EA0A                            ; Debug	mode item lists
0089EA0A                            ; ---------------------------------------------------------------------------
0089EA0A                            DebugList:
0089EA0A 0000                       	dc.w @GHZ-DebugList
0089EA0C 0000                       	dc.w @LZ-DebugList
0089EA0E 0000                       	dc.w @MZ-DebugList
0089EA10 0000                       	dc.w @SLZ-DebugList
0089EA12 0000                       	dc.w @SYZ-DebugList
0089EA14 0000                       	dc.w @SBZ-DebugList
0089EA16 0000                       	dc.w @Ending-DebugList
0089EA18                            
0089EA18                            dbug:	macro map,object,subtype,frame,vram
0089EA18                            	dc.l map+(object<<24)
0089EA18                            	dc.b subtype,frame
0089EA18                            	dc.w vram
0089EA18                            	endm
0089EA18                            
0089EA18                            @GHZ:
0089EA18 0000                       	dc.w (@GHZend-@GHZ-2)/8
0089EA1A                            
0089EA1A                            ;		mappings	object		subtype	frame	VRAM setting
0089EA1A 2588 AD02 0000 27B2        	dbug 	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EA22 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089EA2A 1F88 A3AE 0000 0400        	dbug	Map_Crab,	id_Crabmeat,	0,	0,	$400
0089EA32 2288 A694 0000 0444        	dbug	Map_Buzz,	id_BuzzBomber,	0,	0,	$444
0089EA3A 2B88 B962 0000 047B        	dbug	Map_Chop,	id_Chopper,	0,	0,	$47B
0089EA42 3688 DDD4 0000 051B        	dbug	Map_Spike,	id_Spikes,	0,	0,	$51B
0089EA4A 1888 8D70 0000 4000        	dbug	Map_Plat_GHZ,	id_BasicPlatform, 0,	0,	$4000
0089EA52 3B88 DEEE 0000 63D0        	dbug	Map_PRock,	id_PurpleRock,	0,	0,	$63D0
0089EA5A 4089 0580 0000 04F0        	dbug	Map_Moto,	id_MotoBug,	0,	0,	$4F0
0089EA62 4188 EAF4 0000 0523        	dbug	Map_Spring,	id_Springs,	0,	0,	$523
0089EA6A 4288 ED2A 0000 249B        	dbug	Map_Newt,	id_Newtron,	0,	0,	$249B
0089EA72 4488 F038 0000 434C        	dbug	Map_Edge,	id_EdgeWalls,	0,	0,	$434C
0089EA7A 1988 8DDE 0000 43AA        	dbug	Map_GBall,	id_Obj19,	0,	0,	$43AA
0089EA82 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089EA8A 4B88 AD46 0000 2400        	dbug	Map_GRing,	id_GiantRing,	0,	0,	$2400
0089EA92 7D89 88D0 0101 84B6        	dbug	Map_Bonus,	id_HiddenBonus,	1,	1,	$84B6
0089EA9A                            	@GHZend:
0089EA9A                            
0089EA9A                            @LZ:
0089EA9A 0000                       	dc.w (@LZend-@LZ-2)/8
0089EA9C                            
0089EA9C                            ;		mappings	object		subtype	frame	VRAM setting
0089EA9C 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EAA4 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089EAAC 4188 EAF4 0000 0523        	dbug	Map_Spring,	id_Springs,	0,	0,	$523
0089EAB4 2C88 BA08 0800 2486        	dbug	Map_Jaws,	id_Jaws,	8,	0,	$2486
0089EABC 2D88 BBF4 0002 84A6        	dbug	Map_Burro,	id_Burrobot,	0,	2,	$84A6
0089EAC4 1689 2E88 0000 03CC        	dbug	Map_Harp,	id_Harpoon,	0,	0,	$3CC
0089EACC 1689 2E88 0203 03CC        	dbug	Map_Harp,	id_Harpoon,	2,	3,	$3CC
0089EAD4 3388 D07E 0000 43DE        	dbug	Map_Push,	id_PushBlock,	0,	0,	$43DE
0089EADC 3288 CC3C 0000 0513        	dbug	Map_But,	id_Button,	0,	0,	$513
0089EAE4 3688 DDD4 0000 051B        	dbug	Map_Spike,	id_Spikes,	0,	0,	$51B
0089EAEC 5289 0EAA 0400 43BC        	dbug	Map_MBlockLZ,	id_MovingBlock,	4,	0,	$43BC
0089EAF4 6189 30B8 0100 43E6        	dbug	Map_LBlock,	id_LabyrinthBlock, 1,	0,	$43E6
0089EAFC 6189 30B8 1301 43E6        	dbug	Map_LBlock,	id_LabyrinthBlock, $13,	1,	$43E6
0089EB04 6189 30B8 0500 43E6        	dbug	Map_LBlock,	id_LabyrinthBlock, 5,	0,	$43E6
0089EB0C 6289 320E 0000 443E        	dbug	Map_Gar,	id_Gargoyle,	0,	0,	$443E
0089EB14 6189 30B8 2702 43E6        	dbug	Map_LBlock,	id_LabyrinthBlock, $27,	2,	$43E6
0089EB1C 6189 30B8 3003 43E6        	dbug	Map_LBlock,	id_LabyrinthBlock, $30,	3,	$43E6
0089EB24 6389 3572 7F00 03F6        	dbug	Map_LConv,	id_LabyrinthConvey, $7F, 0,	$3F6
0089EB2C 6089 2DD2 0000 0467        	dbug	Map_Orb,	id_Orbinaut,	0,	0,	$467
0089EB34 6489 38C4 8413 8348        	dbug	Map_Bub,	id_Bubble,	$84,	$13,	$8348
0089EB3C 6589 3A4C 0202 C259        	dbug	Map_WFall,	id_Waterfall,	2,	2,	$C259
0089EB44 6589 3A4C 0909 C259        	dbug	Map_WFall,	id_Waterfall,	9,	9,	$C259
0089EB4C 0B89 2174 0000 43DE        	dbug	Map_Pole,	id_Pole,	0,	0,	$43DE
0089EB54 0C89 2244 0200 4328        	dbug	Map_Flap,	id_FlapDoor,	2,	0,	$4328
0089EB5C 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089EB64                            	@LZend:
0089EB64                            
0089EB64                            @MZ:
0089EB64 0000                       	dc.w (@MZend-@MZ-2)/8
0089EB66                            
0089EB66                            ;		mappings	object		subtype	frame	VRAM setting
0089EB66 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EB6E 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089EB76 2288 A694 0000 0444        	dbug	Map_Buzz,	id_BuzzBomber,	0,	0,	$444
0089EB7E 3688 DDD4 0000 051B        	dbug	Map_Spike,	id_Spikes,	0,	0,	$51B
0089EB86 4188 EAF4 0000 0523        	dbug	Map_Spring,	id_Springs,	0,	0,	$523
0089EB8E 1388 C106 0000 0345        	dbug	Map_Fire,	id_LavaMaker,	0,	0,	$345
0089EB96 4688 F6EA 0000 4000        	dbug	Map_Brick,	id_MarbleBrick,	0,	0,	$4000
0089EB9E 4C89 002A 0000 63A8        	dbug	Map_Geyser,	id_GeyserMaker,	0,	0,	$63A8
0089EBA6 4E89 030E 0000 63A8        	dbug	Map_LWall,	id_LavaWall,	0,	0,	$63A8
0089EBAE 3388 D07E 0000 42B8        	dbug	Map_Push,	id_PushBlock,	0,	0,	$42B8
0089EBB6 5089 070E 0000 247B        	dbug	Map_Yad,	id_Yadrin,	0,	0,	$247B
0089EBBE 5189 0BDE 0000 42B8        	dbug	Map_Smab,	id_SmashBlock,	0,	0,	$42B8
0089EBC6 5289 0E54 0000 02B8        	dbug	Map_MBlock,	id_MovingBlock,	0,	0,	$2B8
0089EBCE 5388 937A 0000 62B8        	dbug	Map_CFlo,	id_CollapseFloor, 0,	0,	$62B8
0089EBD6 5488 FFF0 0000 8680        	dbug	Map_LTag,	id_LavaTag,	0,	0,	$8680
0089EBDE 5589 1048 0000 04B8        	dbug	Map_Bas,	id_Basaran,	0,	0,	$4B8
0089EBE6 7889 83F6 0000 24FF        	dbug	Map_Cat,	id_Caterkiller,	0,	0,	$24FF
0089EBEE 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089EBF6                            	@MZend:
0089EBF6                            
0089EBF6                            @SLZ:
0089EBF6 0000                       	dc.w (@SLZend-@SLZ-2)/8
0089EBF8                            
0089EBF8                            ;		mappings	object		subtype	frame	VRAM setting
0089EBF8 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EC00 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089EC08 5989 1B9A 0000 4000        	dbug	Map_Elev,	id_Elevator,	0,	0,	$4000
0089EC10 5388 937A 0002 44E0        	dbug	Map_CFlo,	id_CollapseFloor, 0,	2,	$44E0
0089EC18 1888 8DCE 0000 4000        	dbug	Map_Plat_SLZ,	id_BasicPlatform, 0,	0,	$4000
0089EC20 5A89 1CD4 0000 4000        	dbug	Map_Circ,	id_CirclingPlatform, 0,	0,	$4000
0089EC28 5B89 1E8E 0000 4000        	dbug	Map_Stair,	id_Staircase,	0,	0,	$4000
0089EC30 5D89 2466 0000 43A0        	dbug	Map_Fan,	id_Fan,		0,	0,	$43A0
0089EC38 5E89 27FA 0000 0374        	dbug	Map_Seesaw,	id_Seesaw,	0,	0,	$374
0089EC40 4188 EAF4 0000 0523        	dbug	Map_Spring,	id_Springs,	0,	0,	$523
0089EC48 1388 C106 0000 0480        	dbug	Map_Fire,	id_LavaMaker,	0,	0,	$480
0089EC50 1C88 948A 0000 44D8        	dbug	Map_Scen,	id_Scenery,	0,	0,	$44D8
0089EC58 5F89 2A7E 0000 0400        	dbug	Map_Bomb,	id_Bomb,	0,	0,	$400
0089EC60 6089 2DD2 0000 2429        	dbug	Map_Orb,	id_Orbinaut,	0,	0,	$2429
0089EC68 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089EC70                            	@SLZend:
0089EC70                            
0089EC70                            @SYZ:
0089EC70 0000                       	dc.w (@SYZend-@SYZ-2)/8
0089EC72                            
0089EC72                            ;		mappings	object		subtype	frame	VRAM setting
0089EC72 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EC7A 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089EC82 3688 DDD4 0000 051B        	dbug	Map_Spike,	id_Spikes,	0,	0,	$51B
0089EC8A 4188 EAF4 0000 0523        	dbug	Map_Spring,	id_Springs,	0,	0,	$523
0089EC92 4388 EF8A 0000 04B8        	dbug	Map_Roll,	id_Roller,	0,	0,	$4B8
0089EC9A 1288 F768 0000 0000        	dbug	Map_Light,	id_SpinningLight, 0,	0,	0
0089ECA2 4788 F8E0 0000 0380        	dbug	Map_Bump,	id_Bumper,	0,	0,	$380
0089ECAA 1F88 A3AE 0000 0400        	dbug	Map_Crab,	id_Crabmeat,	0,	0,	$400
0089ECB2 2288 A694 0000 0444        	dbug	Map_Buzz,	id_BuzzBomber,	0,	0,	$444
0089ECBA 5089 070E 0000 247B        	dbug	Map_Yad,	id_Yadrin,	0,	0,	$247B
0089ECC2 1888 8DBC 0000 4000        	dbug	Map_Plat_SYZ,	id_BasicPlatform, 0,	0,	$4000
0089ECCA 5689 1552 0000 4000        	dbug	Map_FBlock,	id_FloatingBlock, 0,	0,	$4000
0089ECD2 3288 CC3C 0000 0513        	dbug	Map_But,	id_Button,	0,	0,	$513
0089ECDA 7889 83F6 0000 24FF        	dbug	Map_Cat,	id_Caterkiller,	0,	0,	$24FF
0089ECE2 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089ECEA                            	@SYZend:
0089ECEA                            
0089ECEA                            @SBZ:
0089ECEA 0000                       	dc.w (@SBZend-@SBZ-2)/8
0089ECEC                            
0089ECEC                            ;		mappings	object		subtype	frame	VRAM setting
0089ECEC 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089ECF4 2688 B322 0000 0680        	dbug	Map_Monitor,	id_Monitor,	0,	0,	$680
0089ECFC 5F89 2A7E 0000 0400        	dbug	Map_Bomb,	id_Bomb,	0,	0,	$400
0089ED04 6089 2DD2 0000 0429        	dbug	Map_Orb,	id_Orbinaut,	0,	0,	$429
0089ED0C 7889 83F6 0000 22B0        	dbug	Map_Cat,	id_Caterkiller,	0,	0,	$22B0
0089ED14 1589 18F2 0702 4391        	dbug	Map_BBall,	id_SwingingPlatform, 7,	2,	$4391
0089ED1C 6789 6CC4 E000 C344        	dbug	Map_Disc,	id_RunningDisc,	$E0,	0,	$C344
0089ED24 5289 0E54 2802 22C0        	dbug	Map_MBlock,	id_MovingBlock,	$28,	2,	$22C0
0089ED2C 3288 CC3C 0000 0513        	dbug	Map_But,	id_Button,	0,	0,	$513
0089ED34 6989 6F1E 0300 4492        	dbug	Map_Trap,	id_SpinPlatform, 3,	0,	$4492
0089ED3C 6989 6F78 8300 04DF        	dbug	Map_Spin,	id_SpinPlatform, $83,	0,	$4DF
0089ED44 6A89 71D6 0200 43B5        	dbug	Map_Saw,	id_Saws,	2,	0,	$43B5
0089ED4C 5388 937A 0000 43F5        	dbug	Map_CFlo,	id_CollapseFloor, 0,	0,	$43F5
0089ED54 5289 0E54 3903 4460        	dbug	Map_MBlock,	id_MovingBlock,	$39,	3,	$4460
0089ED5C 6B89 75A6 0000 22C0        	dbug	Map_Stomp,	id_ScrapStomp,	0,	0,	$22C0
0089ED64 2A88 9620 0000 42E8        	dbug	Map_ADoor,	id_AutoDoor,	0,	0,	$42E8
0089ED6C 6B89 75A6 1301 22C0        	dbug	Map_Stomp,	id_ScrapStomp,	$13,	1,	$22C0
0089ED74 6A89 71D6 0100 43B5        	dbug	Map_Saw,	id_Saws,	1,	0,	$43B5
0089ED7C 6B89 75A6 2401 22C0        	dbug	Map_Stomp,	id_ScrapStomp,	$24,	1,	$22C0
0089ED84 6A89 71D6 0402 43B5        	dbug	Map_Saw,	id_Saws,	4,	2,	$43B5
0089ED8C 6B89 75A6 3401 22C0        	dbug	Map_Stomp,	id_ScrapStomp,	$34,	1,	$22C0
0089ED94 6C89 7768 0000 44C3        	dbug	Map_VanP,	id_VanishPlatform, 0,	0,	$44C3
0089ED9C 6D88 F3DC 6400 83D9        	dbug	Map_Flame,	id_Flamethrower, $64,	0,	$83D9
0089EDA4 6D88 F3DC 640B 83D9        	dbug	Map_Flame,	id_Flamethrower, $64,	$B,	$83D9
0089EDAC 6E89 781E 0400 047E        	dbug	Map_Elec,	id_Electro,	4,	0,	$47E
0089EDB4 7089 7C66 0000 42F0        	dbug	Map_Gird,	id_Girder,	0,	0,	$42F0
0089EDBC 7189 2308 1100 8680        	dbug	Map_Invis,	id_Invisibarrier, $11,	0,	$8680
0089EDC4 1E88 9AC0 0400 2302        	dbug	Map_Hog,	id_BallHog,	4,	0,	$2302
0089EDCC 7989 8780 0100 07A0        	dbug	Map_Lamp,	id_Lamppost,	1,	0,	$7A0
0089EDD4                            	@SBZend:
0089EDD4                            
0089EDD4                            @Ending:
0089EDD4 0000                       	dc.w (@Endingend-@Ending-2)/8
0089EDD6                            
0089EDD6                            ;		mappings	object		subtype	frame	VRAM setting
0089EDD6 2588 AD02 0000 27B2        	dbug	Map_Ring,	id_Rings,	0,	0,	$27B2
0089EDDE 2588 AD02 0008 27B2        	dbug	Map_Ring,	id_Rings,	0,	8,	$27B2
0089EDE6                            	@Endingend:
0089EDE6                            
0089EDE6                            	even
0089EDE6                            	even
0089EDE6                            		include	"_inc\LevelHeaders.asm"
0089EDE6                            ; ---------------------------------------------------------------------------
0089EDE6                            ; Level Headers
0089EDE6                            ; ---------------------------------------------------------------------------
0089EDE6                            
0089EDE6                            LevelHeaders:
0089EDE6                            
0089EDE6                            lhead:	macro plc1,lvlgfx,plc2,sixteen,twofivesix,music,pal
0089EDE6                            	dc.l (plc1<<24)+lvlgfx
0089EDE6                            	dc.l (plc2<<24)+sixteen
0089EDE6                            	dc.l twofivesix
0089EDE6                            	dc.b 0, music, pal, pal
0089EDE6                            	endm
0089EDE6                            
0089EDE6                            ; 1st PLC, level gfx, 2nd PLC, 16x16 data, 256x256 data,
0089EDE6                            ; music (unused), palette (unused), palette
0089EDE6                            
0089EDE6                            ;		1st PLC				2nd PLC				256x256 data			palette
0089EDE6                            ;				level gfx			16x16 data			music*
0089EDE6                            
0089EDE6 0000 0000 0000 0000 0000+  	lhead	plcid_GHZ,	Nem_GHZ_2nd,	plcid_GHZ2,	Blk16_GHZ,	Blk256_GHZ,	bgm_GHZ,	palid_GHZ	; Green Hill
0089EDF6 0000 0000 0000 0000 0000+  	lhead	plcid_LZ,	Nem_LZ,		plcid_LZ2,	Blk16_LZ,	Blk256_LZ,	bgm_LZ,		palid_LZ	; Labyrinth
0089EE06 0000 0000 0000 0000 0000+  	lhead	plcid_MZ,	Nem_MZ,		plcid_MZ2,	Blk16_MZ,	Blk256_MZ,	bgm_MZ,		palid_MZ	; Marble
0089EE16 0000 0000 0000 0000 0000+  	lhead	plcid_SLZ,	Nem_SLZ,	plcid_SLZ2,	Blk16_SLZ,	Blk256_SLZ,	bgm_SLZ,	palid_SLZ	; Star Light
0089EE26 0000 0000 0000 0000 0000+  	lhead	plcid_SYZ,	Nem_SYZ,	plcid_SYZ2,	Blk16_SYZ,	Blk256_SYZ,	bgm_SYZ,	palid_SYZ	; Spring Yard
0089EE36 0000 0000 0000 0000 0000+  	lhead	plcid_SBZ,	Nem_SBZ,	plcid_SBZ2,	Blk16_SBZ,	Blk256_SBZ,	bgm_SBZ,	palid_SBZ1	; Scrap Brain
0089EE46 0000 0000 0000 0000 0000+  	lhead	0,		Nem_GHZ_2nd,	0,		Blk16_GHZ,	Blk256_GHZ,	bgm_SBZ,	palid_Ending	; Ending
0089EE56                            	even
0089EE56                            
0089EE56                            ;	* music is actually set elsewhere, so these values are useless
0089EE56                            ;	* music is actually set elsewhere, so these values are useless
0089EE56                            		include	"_inc\Pattern Load Cues.asm"
0089EE56                            ; ---------------------------------------------------------------------------
0089EE56                            ; Pattern load cues
0089EE56                            ; ---------------------------------------------------------------------------
0089EE56                            ArtLoadCues:
0089EE56                            
0089EE56 0000                       ptr_PLC_Main:		dc.w PLC_Main-ArtLoadCues
0089EE58 0000                       ptr_PLC_Main2:		dc.w PLC_Main2-ArtLoadCues
0089EE5A 0000                       ptr_PLC_Explode:	dc.w PLC_Explode-ArtLoadCues
0089EE5C 0000                       ptr_PLC_GameOver:	dc.w PLC_GameOver-ArtLoadCues
0089EE5E                            PLC_Levels:
0089EE5E 0000                       ptr_PLC_GHZ:		dc.w PLC_GHZ-ArtLoadCues
0089EE60 0000                       ptr_PLC_GHZ2:		dc.w PLC_GHZ2-ArtLoadCues
0089EE62 0000                       ptr_PLC_LZ:		dc.w PLC_LZ-ArtLoadCues
0089EE64 0000                       ptr_PLC_LZ2:		dc.w PLC_LZ2-ArtLoadCues
0089EE66 0000                       ptr_PLC_MZ:		dc.w PLC_MZ-ArtLoadCues
0089EE68 0000                       ptr_PLC_MZ2:		dc.w PLC_MZ2-ArtLoadCues
0089EE6A 0000                       ptr_PLC_SLZ:		dc.w PLC_SLZ-ArtLoadCues
0089EE6C 0000                       ptr_PLC_SLZ2:		dc.w PLC_SLZ2-ArtLoadCues
0089EE6E 0000                       ptr_PLC_SYZ:		dc.w PLC_SYZ-ArtLoadCues
0089EE70 0000                       ptr_PLC_SYZ2:		dc.w PLC_SYZ2-ArtLoadCues
0089EE72 0000                       ptr_PLC_SBZ:		dc.w PLC_SBZ-ArtLoadCues
0089EE74 0000                       ptr_PLC_SBZ2:		dc.w PLC_SBZ2-ArtLoadCues
0089EE76 0000                       ptr_PLC_TitleCard:	dc.w PLC_TitleCard-ArtLoadCues
0089EE78 0000                       ptr_PLC_Boss:		dc.w PLC_Boss-ArtLoadCues
0089EE7A 0000                       ptr_PLC_Signpost:	dc.w PLC_Signpost-ArtLoadCues
0089EE7C 0000                       ptr_PLC_Warp:		dc.w 0
0089EE7E 0000                       ptr_PLC_SpecialStage:	dc.w PLC_SpecialStage-ArtLoadCues
0089EE80                            PLC_Animals:
0089EE80 0000                       ptr_PLC_GHZAnimals:	dc.w PLC_GHZAnimals-ArtLoadCues
0089EE82 0000                       ptr_PLC_LZAnimals:	dc.w PLC_LZAnimals-ArtLoadCues
0089EE84 0000                       ptr_PLC_MZAnimals:	dc.w PLC_MZAnimals-ArtLoadCues
0089EE86 0000                       ptr_PLC_SLZAnimals:	dc.w PLC_SLZAnimals-ArtLoadCues
0089EE88 0000                       ptr_PLC_SYZAnimals:	dc.w PLC_SYZAnimals-ArtLoadCues
0089EE8A 0000                       ptr_PLC_SBZAnimals:	dc.w PLC_SBZAnimals-ArtLoadCues
0089EE8C 0000                       ptr_PLC_SSResult:	dc.w PLC_SSResult-ArtLoadCues
0089EE8E 0000                       ptr_PLC_Ending:		dc.w PLC_Ending-ArtLoadCues
0089EE90 0000                       ptr_PLC_TryAgain:	dc.w PLC_TryAgain-ArtLoadCues
0089EE92 0000                       ptr_PLC_EggmanSBZ2:	dc.w PLC_EggmanSBZ2-ArtLoadCues
0089EE94 0000                       ptr_PLC_FZBoss:		dc.w PLC_FZBoss-ArtLoadCues
0089EE96                            
0089EE96                            
0089EE96                            plcm:	macro gfx,vram
0089EE96                            	dc.l gfx
0089EE96                            	dc.w vram
0089EE96                            	endm
0089EE96                            
0089EE96                            ; ---------------------------------------------------------------------------
0089EE96                            ; Pattern load cues - standard block 1
0089EE96                            ; ---------------------------------------------------------------------------
0089EE96 0000                       PLC_Main:	dc.w ((PLC_Mainend-PLC_Main-2)/6)-1
0089EE98                            
0089EE98 0000 0000 D800             		plcm	Nem_Lamp, $D800		; lamppost
0089EE9E                            		
0089EE9E 0000 0000 D940             		plcm	Nem_Hud, $D940		; HUD
0089EEA4 0000 0000 FA80             		plcm	Nem_Lives, $FA80	; lives	counter
0089EEAA 0000 0000 F640             		plcm	Nem_Ring, $F640 	; rings
0089EEB0 0000 0000 F2E0             		plcm	Nem_Points, $F2E0	; points from enemy
0089EEB6                            	PLC_Mainend:
0089EEB6                            ; ---------------------------------------------------------------------------
0089EEB6                            ; Pattern load cues - standard block 2
0089EEB6                            ; ---------------------------------------------------------------------------
0089EEB6 0000                       PLC_Main2:	dc.w ((PLC_Main2end-PLC_Main2-2)/6)-1
0089EEB8 0000 0000 D000             		plcm	Nem_Monitors, $D000	; monitors
0089EEBE 0000 0000 A820             		plcm	Nem_Shield, $A820	; shield
0089EEC4 0000 0000 AB80             		plcm	Nem_Stars, $AB80	; invincibility	stars
0089EECA                            	PLC_Main2end:
0089EECA                            ; ---------------------------------------------------------------------------
0089EECA                            ; Pattern load cues - explosion
0089EECA                            ; ---------------------------------------------------------------------------
0089EECA 0000                       PLC_Explode:	dc.w ((PLC_Explodeend-PLC_Explode-2)/6)-1
0089EECC 0000 0000 B400             		plcm	Nem_Explode, $B400	; explosion
0089EED2                            	PLC_Explodeend:
0089EED2                            ; ---------------------------------------------------------------------------
0089EED2                            ; Pattern load cues - game/time	over
0089EED2                            ; ---------------------------------------------------------------------------
0089EED2 0000                       PLC_GameOver:	dc.w ((PLC_GameOverend-PLC_GameOver-2)/6)-1
0089EED4 0000 0000 ABC0             		plcm	Nem_GameOver, $ABC0	; game/time over
0089EEDA                            	PLC_GameOverend:
0089EEDA                            ; ---------------------------------------------------------------------------
0089EEDA                            ; Pattern load cues - Green Hill
0089EEDA                            ; ---------------------------------------------------------------------------
0089EEDA 0000                       PLC_GHZ:	dc.w ((PLC_GHZ2-PLC_GHZ-2)/6)-1
0089EEDC 0000 0000 0000             		plcm	Nem_GHZ_1st, 0		; GHZ main patterns
0089EEE2 0000 0000 39A0             		plcm	Nem_GHZ_2nd, $39A0	; GHZ secondary	patterns
0089EEE8 0000 0000 6B00             		plcm	Nem_Stalk, $6B00	; flower stalk
0089EEEE 0000 0000 7A00             		plcm	Nem_PplRock, $7A00	; purple rock
0089EEF4 0000 0000 8000             		plcm	Nem_Crabmeat, $8000	; crabmeat enemy
0089EEFA 0000 0000 8880             		plcm	Nem_Buzz, $8880		; buzz bomber enemy
0089EF00 0000 0000 8F60             		plcm	Nem_Chopper, $8F60	; chopper enemy
0089EF06 0000 0000 9360             		plcm	Nem_Newtron, $9360	; newtron enemy
0089EF0C 0000 0000 9E00             		plcm	Nem_Motobug, $9E00	; motobug enemy
0089EF12 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089EF18 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089EF1E 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089EF24                            
0089EF24 0000                       PLC_GHZ2:	dc.w ((PLC_GHZ2end-PLC_GHZ2-2)/6)-1
0089EF26 0000 0000 7000             		plcm	Nem_Swing, $7000	; swinging platform
0089EF2C 0000 0000 71C0             		plcm	Nem_Bridge, $71C0	; bridge
0089EF32 0000 0000 7300             		plcm	Nem_SpikePole, $7300	; spiked pole
0089EF38 0000 0000 7540             		plcm	Nem_Ball, $7540		; giant	ball
0089EF3E 0000 0000 A1E0             		plcm	Nem_GhzWall1, $A1E0	; breakable wall
0089EF44 0000 0000 6980             		plcm	Nem_GhzWall2, $6980	; normal wall
0089EF4A                            	PLC_GHZ2end:
0089EF4A                            ; ---------------------------------------------------------------------------
0089EF4A                            ; Pattern load cues - Labyrinth
0089EF4A                            ; ---------------------------------------------------------------------------
0089EF4A 0000                       PLC_LZ:		dc.w ((PLC_LZ2-PLC_LZ-2)/6)-1
0089EF4C 0000 0000 0000             		plcm	Nem_LZ,0		; LZ main patterns
0089EF52 0000 0000 3C00             		plcm	Nem_LzBlock1, $3C00	; block
0089EF58 0000 0000 3E00             		plcm	Nem_LzBlock2, $3E00	; blocks
0089EF5E 0000 0000 4B20             		plcm	Nem_Splash, $4B20	; waterfalls and splash
0089EF64 0000 0000 6000             		plcm	Nem_Water, $6000	; water	surface
0089EF6A 0000 0000 6200             		plcm	Nem_LzSpikeBall, $6200	; spiked ball
0089EF70 0000 0000 6500             		plcm	Nem_FlapDoor, $6500	; flapping door
0089EF76 0000 0000 6900             		plcm	Nem_Bubbles, $6900	; bubbles and numbers
0089EF7C 0000 0000 7780             		plcm	Nem_LzBlock3, $7780	; block
0089EF82 0000 0000 7880             		plcm	Nem_LzDoor1, $7880	; vertical door
0089EF88                            		
0089EF88                            	;Mercury SBZ3 Button PLC Fix
0089EF88                            		;plcm	Nem_Harpoon, $7980	; harpoon	
0089EF88 0000 0000 A1E0             		plcm	Nem_LzSwitch, $A1E0	; switch
0089EF8E                            	;end SBZ3 Button PLC Fix
0089EF8E                            	
0089EF8E 0000 0000 94C0             		plcm	Nem_Burrobot, $94C0	; burrobot enemy
0089EF94                            
0089EF94 0000                       PLC_LZ2:	dc.w ((PLC_LZ2end-PLC_LZ2-2)/6)-1
0089EF96 0000 0000 7BC0             		plcm	Nem_LzPole, $7BC0	; pole that breaks
0089EF9C 0000 0000 7CC0             		plcm	Nem_LzDoor2, $7CC0	; large	horizontal door
0089EFA2 0000 0000 7EC0             		plcm	Nem_LzWheel, $7EC0	; wheel
0089EFA8 0000 0000 5D20             		plcm	Nem_Gargoyle, $5D20	; gargoyle head
0089EFAE 0000 0000 89E0             		plcm	Nem_LzPlatfm, $89E0	; rising platform
0089EFB4 0000 0000 8CE0             		plcm	Nem_Orbinaut, $8CE0	; orbinaut enemy
0089EFBA 0000 0000 90C0             		plcm	Nem_Jaws, $90C0		; jaws enemy
0089EFC0                            		
0089EFC0                            	;Mercury SBZ3 Button PLC Fix
0089EFC0 0000 0000 7980             		plcm	Nem_Harpoon, $7980	; harpoon	
0089EFC6                            		;plcm	Nem_LzSwitch, $A1E0	; switch
0089EFC6                            	;end SBZ3 Button PLC Fix
0089EFC6                            		
0089EFC6 0000 0000 A1E0             		plcm	Nem_LzSwitch, $A1E0	; switch
0089EFCC 0000 0000 A000             		plcm	Nem_Cork, $A000		; cork block
0089EFD2 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089EFD8 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089EFDE 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089EFE4                            	PLC_LZ2end:
0089EFE4                            ; ---------------------------------------------------------------------------
0089EFE4                            ; Pattern load cues - Marble
0089EFE4                            ; ---------------------------------------------------------------------------
0089EFE4 0000                       PLC_MZ:		dc.w ((PLC_MZ2-PLC_MZ-2)/6)-1
0089EFE6 0000 0000 0000             		plcm	Nem_MZ,0		; MZ main patterns
0089EFEC 0000 0000 6000             		plcm	Nem_MzMetal, $6000	; metal	blocks
0089EFF2 0000 0000 68A0             		plcm	Nem_MzFire, $68A0	; fireballs
0089EFF8 0000 0000 7000             		plcm	Nem_Swing, $7000	; swinging platform
0089EFFE 0000 0000 71C0             		plcm	Nem_MzGlass, $71C0	; green	glassy block
0089F004 0000 0000 7500             		plcm	Nem_Lava, $7500		; lava
0089F00A 0000 0000 8880             		plcm	Nem_Buzz, $8880		; buzz bomber enemy
0089F010 0000 0000 8F60             		plcm	Nem_Yadrin, $8F60	; yadrin enemy
0089F016 0000 0000 9700             		plcm	Nem_Basaran, $9700	; basaran enemy
0089F01C 0000 0000 9FE0             		plcm	Nem_Cater, $9FE0	; caterkiller enemy
0089F022                            
0089F022 0000                       PLC_MZ2:	dc.w ((PLC_MZ2end-PLC_MZ2-2)/6)-1
0089F024 0000 0000 A260             		plcm	Nem_MzSwitch, $A260	; switch
0089F02A 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089F030 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089F036 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089F03C 0000 0000 5700             		plcm	Nem_MzBlock, $5700	; green	stone block
0089F042                            	PLC_MZ2end:
0089F042                            ; ---------------------------------------------------------------------------
0089F042                            ; Pattern load cues - Star Light
0089F042                            ; ---------------------------------------------------------------------------
0089F042 0000                       PLC_SLZ:	dc.w ((PLC_SLZ2-PLC_SLZ-2)/6)-1
0089F044 0000 0000 0000             		plcm	Nem_SLZ,0		; SLZ main patterns
0089F04A 0000 0000 8000             		plcm	Nem_Bomb, $8000		; bomb enemy
0089F050 0000 0000 8520             		plcm	Nem_Orbinaut, $8520	; orbinaut enemy
0089F056 0000 0000 9000             		plcm	Nem_MzFire, $9000	; fireballs
0089F05C 0000 0000 9C00             		plcm	Nem_SlzBlock, $9C00	; block
0089F062 0000 0000 A260             		plcm	Nem_SlzWall, $A260	; breakable wall
0089F068 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089F06E 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089F074 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089F07A                            
0089F07A 0000                       PLC_SLZ2:	dc.w ((PLC_SLZ2end-PLC_SLZ2-2)/6)-1
0089F07C 0000 0000 6E80             		plcm	Nem_Seesaw, $6E80	; seesaw
0089F082 0000 0000 7400             		plcm	Nem_Fan, $7400		; fan
0089F088 0000 0000 7980             		plcm	Nem_Pylon, $7980	; foreground pylon
0089F08E 0000 0000 7B80             		plcm	Nem_SlzSwing, $7B80	; swinging platform
0089F094 0000 0000 9B00             		plcm	Nem_SlzCannon, $9B00	; fireball launcher
0089F09A 0000 0000 9E00             		plcm	Nem_SlzSpike, $9E00	; spikeball
0089F0A0                            	PLC_SLZ2end:
0089F0A0                            ; ---------------------------------------------------------------------------
0089F0A0                            ; Pattern load cues - Spring Yard
0089F0A0                            ; ---------------------------------------------------------------------------
0089F0A0 0000                       PLC_SYZ:	dc.w ((PLC_SYZ2-PLC_SYZ-2)/6)-1
0089F0A2 0000 0000 0000             		plcm	Nem_SYZ,0		; SYZ main patterns
0089F0A8 0000 0000 8000             		plcm	Nem_Crabmeat, $8000	; crabmeat enemy
0089F0AE 0000 0000 8880             		plcm	Nem_Buzz, $8880		; buzz bomber enemy
0089F0B4 0000 0000 8F60             		plcm	Nem_Yadrin, $8F60	; yadrin enemy
0089F0BA 0000 0000 9700             		plcm	Nem_Roller, $9700	; roller enemy
0089F0C0                            
0089F0C0 0000                       PLC_SYZ2:	dc.w ((PLC_SYZ2end-PLC_SYZ2-2)/6)-1
0089F0C2 0000 0000 7000             		plcm	Nem_Bumper, $7000	; bumper
0089F0C8 0000 0000 72C0             		plcm	Nem_SyzSpike1, $72C0	; large	spikeball
0089F0CE 0000 0000 7740             		plcm	Nem_SyzSpike2, $7740	; small	spikeball
0089F0D4                            		;plcm	Nem_Cater, $9FE0	; caterkiller enemy	;Mercury Roller Art Fix
0089F0D4 0000 0000 A1E0             		plcm	Nem_LzSwitch, $A1E0	; switch
0089F0DA 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089F0E0 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089F0E6 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089F0EC                            	PLC_SYZ2end:
0089F0EC                            ; ---------------------------------------------------------------------------
0089F0EC                            ; Pattern load cues - Scrap Brain
0089F0EC                            ; ---------------------------------------------------------------------------
0089F0EC 0000                       PLC_SBZ:	dc.w ((PLC_SBZ2-PLC_SBZ-2)/6)-1
0089F0EE 0000 0000 0000             		plcm	Nem_SBZ,0		; SBZ main patterns
0089F0F4 0000 0000 5800             		plcm	Nem_Stomper, $5800	; moving platform and stomper
0089F0FA 0000 0000 5D00             		plcm	Nem_SbzDoor1, $5D00	; door
0089F100 0000 0000 5E00             		plcm	Nem_Girder, $5E00	; girder
0089F106 0000 0000 6040             		plcm	Nem_BallHog, $6040	; ball hog enemy
0089F10C 0000 0000 6880             		plcm	Nem_SbzWheel1, $6880	; spot on large	wheel
0089F112 0000 0000 6900             		plcm	Nem_SbzWheel2, $6900	; wheel	that grabs Sonic
0089F118 0000 0000 7220             		plcm	Nem_SyzSpike1, $7220	; large	spikeball
0089F11E 0000 0000 76A0             		plcm	Nem_Cutter, $76A0	; pizza	cutter
0089F124 0000 0000 7B20             		plcm	Nem_FlamePipe, $7B20	; flaming pipe
0089F12A 0000 0000 7EA0             		plcm	Nem_SbzFloor, $7EA0	; collapsing floor
0089F130 0000 0000 9860             		plcm	Nem_SbzBlock, $9860	; vanishing block
0089F136                            
0089F136 0000                       PLC_SBZ2:	dc.w ((PLC_SBZ2end-PLC_SBZ2-2)/6)-1
0089F138 0000 0000 5600             		plcm	Nem_Cater, $5600	; caterkiller enemy
0089F13E 0000 0000 8000             		plcm	Nem_Bomb, $8000		; bomb enemy
0089F144 0000 0000 8520             		plcm	Nem_Orbinaut, $8520	; orbinaut enemy
0089F14A 0000 0000 8C00             		plcm	Nem_SlideFloor, $8C00	; floor	that slides away
0089F150 0000 0000 8DE0             		plcm	Nem_SbzDoor2, $8DE0	; horizontal door
0089F156 0000 0000 8FC0             		plcm	Nem_Electric, $8FC0	; electric orb
0089F15C 0000 0000 9240             		plcm	Nem_TrapDoor, $9240	; trapdoor
0089F162 0000 0000 7F20             		plcm	Nem_SbzFloor, $7F20	; collapsing floor
0089F168 0000 0000 9BE0             		plcm	Nem_SpinPform, $9BE0	; small	spinning platform
0089F16E 0000 0000 A1E0             		plcm	Nem_LzSwitch, $A1E0	; switch
0089F174 0000 0000 A360             		plcm	Nem_Spikes, $A360	; spikes
0089F17A 0000 0000 A460             		plcm	Nem_HSpring, $A460	; horizontal spring
0089F180 0000 0000 A660             		plcm	Nem_VSpring, $A660	; vertical spring
0089F186                            	PLC_SBZ2end:
0089F186                            ; ---------------------------------------------------------------------------
0089F186                            ; Pattern load cues - title card
0089F186                            ; ---------------------------------------------------------------------------
0089F186 0000                       PLC_TitleCard:	dc.w ((PLC_TitleCardend-PLC_TitleCard-2)/6)-1
0089F188 0000 0000 B000             		plcm	Nem_TitleCard, $B000
0089F18E                            	PLC_TitleCardend:
0089F18E                            ; ---------------------------------------------------------------------------
0089F18E                            ; Pattern load cues - act 3 boss
0089F18E                            ; ---------------------------------------------------------------------------
0089F18E 0000                       PLC_Boss:	dc.w ((PLC_Bossend-PLC_Boss-2)/6)-1
0089F190 0000 0000 8000             		plcm	Nem_Eggman, $8000	; Eggman main patterns
0089F196 0000 0000 8D80             		plcm	Nem_Weapons, $8D80	; Eggman's weapons
0089F19C 0000 0000 93A0             		plcm	Nem_Prison, $93A0	; prison capsule
0089F1A2 0000 0000 A300             		plcm	Nem_Bomb, $A300		; bomb enemy ((gets overwritten)
0089F1A8 0000 0000 A300             		plcm	Nem_SlzSpike, $A300	; spikeball ((SLZ boss)
0089F1AE 0000 0000 A540             		plcm	Nem_Exhaust, $A540	; exhaust flame
0089F1B4                            	PLC_Bossend:
0089F1B4                            ; ---------------------------------------------------------------------------
0089F1B4                            ; Pattern load cues - act 1/2 signpost
0089F1B4                            ; ---------------------------------------------------------------------------
0089F1B4 0000                       PLC_Signpost:	dc.w ((PLC_Signpostend-PLC_Signpost-2)/6)-1
0089F1B6 0000 0000 D000             		plcm	Nem_SignPost, $D000	; signpost
0089F1BC 0000 0000 96C0             		plcm	Nem_Bonus, $96C0	; hidden bonus points
0089F1C2 0000 0000 8C40             		plcm	Nem_BigFlash, $8C40	; giant	ring flash effect
0089F1C8                            	PLC_Signpostend:
0089F1C8                            
0089F1C8                            ; ---------------------------------------------------------------------------
0089F1C8                            ; Pattern load cues - special stage
0089F1C8                            ; ---------------------------------------------------------------------------
0089F1C8 0000                       PLC_SpecialStage:	dc.w ((PLC_SpeStageend-PLC_SpecialStage-2)/6)-1
0089F1CA 0000 0000 0000             		plcm	Nem_SSBgCloud, 0	; bubble and cloud background
0089F1D0 0000 0000 0A20             		plcm	Nem_SSBgFish, $A20	; bird and fish	background
0089F1D6 0000 0000 2840             		plcm	Nem_SSWalls, $2840	; walls
0089F1DC 0000 0000 4760             		plcm	Nem_Bumper, $4760	; bumper
0089F1E2 0000 0000 4A20             		plcm	Nem_SSGOAL, $4A20	; GOAL block
0089F1E8 0000 0000 4C60             		plcm	Nem_SSUpDown, $4C60	; UP and DOWN blocks
0089F1EE 0000 0000 5E00             		plcm	Nem_SSRBlock, $5E00	; R block
0089F1F4 0000 0000 6E00             		plcm	Nem_SS1UpBlock, $6E00	; 1UP block
0089F1FA 0000 0000 7E00             		plcm	Nem_SSEmStars, $7E00	; emerald collection stars
0089F200 0000 0000 8E00             		plcm	Nem_SSRedWhite, $8E00	; red and white	block
0089F206 0000 0000 9E00             		plcm	Nem_SSGhost, $9E00	; ghost	block
0089F20C 0000 0000 AE00             		plcm	Nem_SSWBlock, $AE00	; W block
0089F212 0000 0000 BE00             		plcm	Nem_SSGlass, $BE00	; glass	block
0089F218 0000 0000 EE00             		plcm	Nem_SSEmerald, $EE00	; emeralds
0089F21E 0000 0000 F2E0             		plcm	Nem_SSZone1, $F2E0	; ZONE 1 block
0089F224 0000 0000 F400             		plcm	Nem_SSZone2, $F400	; ZONE 2 block
0089F22A 0000 0000 F520             		plcm	Nem_SSZone3, $F520	; ZONE 3 block
0089F230                            	PLC_SpeStageend:
0089F230 0000 0000 F2E0             		plcm	Nem_SSZone4, $F2E0	; ZONE 4 block
0089F236 0000 0000 F400             		plcm	Nem_SSZone5, $F400	; ZONE 5 block
0089F23C 0000 0000 F520             		plcm	Nem_SSZone6, $F520	; ZONE 6 block
0089F242                            ; ---------------------------------------------------------------------------
0089F242                            ; Pattern load cues - GHZ animals
0089F242                            ; ---------------------------------------------------------------------------
0089F242 0000                       PLC_GHZAnimals:	dc.w ((PLC_GHZAnimalsend-PLC_GHZAnimals-2)/6)-1
0089F244 0000 0000 B000             		plcm	Nem_Rabbit, $B000	; rabbit
0089F24A 0000 0000 B240             		plcm	Nem_Flicky, $B240	; flicky
0089F250                            	PLC_GHZAnimalsend:
0089F250                            ; ---------------------------------------------------------------------------
0089F250                            ; Pattern load cues - LZ animals
0089F250                            ; ---------------------------------------------------------------------------
0089F250 0000                       PLC_LZAnimals:	dc.w ((PLC_LZAnimalsend-PLC_LZAnimals-2)/6)-1
0089F252 0000 0000 B000             		plcm	Nem_BlackBird, $B000	; blackbird
0089F258 0000 0000 B240             		plcm	Nem_Seal, $B240		; seal
0089F25E                            	PLC_LZAnimalsend:
0089F25E                            ; ---------------------------------------------------------------------------
0089F25E                            ; Pattern load cues - MZ animals
0089F25E                            ; ---------------------------------------------------------------------------
0089F25E 0000                       PLC_MZAnimals:	dc.w ((PLC_MZAnimalsend-PLC_MZAnimals-2)/6)-1
0089F260 0000 0000 B000             		plcm	Nem_Squirrel, $B000	; squirrel
0089F266 0000 0000 B240             		plcm	Nem_Seal, $B240		; seal
0089F26C                            	PLC_MZAnimalsend:
0089F26C                            ; ---------------------------------------------------------------------------
0089F26C                            ; Pattern load cues - SLZ animals
0089F26C                            ; ---------------------------------------------------------------------------
0089F26C 0000                       PLC_SLZAnimals:	dc.w ((PLC_SLZAnimalsend-PLC_SLZAnimals-2)/6)-1
0089F26E 0000 0000 B000             		plcm	Nem_Pig, $B000		; pig
0089F274 0000 0000 B240             		plcm	Nem_Flicky, $B240	; flicky
0089F27A                            	PLC_SLZAnimalsend:
0089F27A                            ; ---------------------------------------------------------------------------
0089F27A                            ; Pattern load cues - SYZ animals
0089F27A                            ; ---------------------------------------------------------------------------
0089F27A 0000                       PLC_SYZAnimals:	dc.w ((PLC_SYZAnimalsend-PLC_SYZAnimals-2)/6)-1
0089F27C 0000 0000 B000             		plcm	Nem_Pig, $B000		; pig
0089F282 0000 0000 B240             		plcm	Nem_Chicken, $B240	; chicken
0089F288                            	PLC_SYZAnimalsend:
0089F288                            ; ---------------------------------------------------------------------------
0089F288                            ; Pattern load cues - SBZ animals
0089F288                            ; ---------------------------------------------------------------------------
0089F288 0000                       PLC_SBZAnimals:	dc.w ((PLC_SBZAnimalsend-PLC_SBZAnimals-2)/6)-1
0089F28A 0000 0000 B000             		plcm	Nem_Rabbit, $B000		; rabbit
0089F290 0000 0000 B240             		plcm	Nem_Chicken, $B240	; chicken
0089F296                            	PLC_SBZAnimalsend:
0089F296                            ; ---------------------------------------------------------------------------
0089F296                            ; Pattern load cues - special stage results screen
0089F296                            ; ---------------------------------------------------------------------------
0089F296 0000                       PLC_SSResult:dc.w ((PLC_SpeStResultend-PLC_SSResult-2)/6)-1
0089F298 0000 0000 A820             		plcm	Nem_ResultEm, $A820	; emeralds
0089F29E 0000 0000 AA20             		plcm	Nem_MiniSonic, $AA20	; mini Sonic
0089F2A4                            	PLC_SpeStResultend:
0089F2A4                            ; ---------------------------------------------------------------------------
0089F2A4                            ; Pattern load cues - ending sequence
0089F2A4                            ; ---------------------------------------------------------------------------
0089F2A4 0000                       PLC_Ending:	dc.w ((PLC_Endingend-PLC_Ending-2)/6)-1
0089F2A6 0000 0000 0000             		plcm	Nem_GHZ_1st,0		; GHZ main patterns
0089F2AC 0000 0000 39A0             		plcm	Nem_GHZ_2nd, $39A0	; GHZ secondary	patterns
0089F2B2 0000 0000 6B00             		plcm	Nem_Stalk, $6B00	; flower stalk
0089F2B8 0000 0000 7400             		plcm	Nem_EndFlower, $7400	; flowers
0089F2BE 0000 0000 78A0             		plcm	Nem_EndEm, $78A0	; emeralds
0089F2C4 0000 0000 7C20             		plcm	Nem_EndSonic, $7C20	; Sonic
0089F2CA 0000 0000 AA60             		plcm	Nem_Rabbit, $AA60	; rabbit
0089F2D0 0000 0000 ACA0             		plcm	Nem_Chicken, $ACA0	; chicken
0089F2D6 0000 0000 AE60             		plcm	Nem_BlackBird, $AE60	; blackbird
0089F2DC 0000 0000 B0A0             		plcm	Nem_Seal, $B0A0		; seal
0089F2E2 0000 0000 B260             		plcm	Nem_Pig, $B260		; pig
0089F2E8 0000 0000 B4A0             		plcm	Nem_Flicky, $B4A0	; flicky
0089F2EE 0000 0000 B660             		plcm	Nem_Squirrel, $B660	; squirrel
0089F2F4 0000 0000 B8A0             		plcm	Nem_EndStH, $B8A0	; "SONIC THE HEDGEHOG"
0089F2FA                            	PLC_Endingend:
0089F2FA                            ; ---------------------------------------------------------------------------
0089F2FA                            ; Pattern load cues - "TRY AGAIN" and "END" screens
0089F2FA                            ; ---------------------------------------------------------------------------
0089F2FA 0000                       PLC_TryAgain:	dc.w ((PLC_TryAgainend-PLC_TryAgain-2)/6)-1
0089F2FC 0000 0000 78A0             		plcm	Nem_EndEm, $78A0	; emeralds
0089F302 0000 0000 7C20             		plcm	Nem_TryAgain, $7C20	; Eggman
0089F308 0000 0000 B400             		plcm	Nem_CreditText, $B400	; credits alphabet
0089F30E                            	PLC_TryAgainend:
0089F30E                            ; ---------------------------------------------------------------------------
0089F30E                            ; Pattern load cues - Eggman on SBZ 2
0089F30E                            ; ---------------------------------------------------------------------------
0089F30E 0000                       PLC_EggmanSBZ2:	dc.w ((PLC_EggmanSBZ2end-PLC_EggmanSBZ2-2)/6)-1
0089F310                            
0089F310 0000 0000 A300             		plcm	Nem_SbzBlock, $A300	; block
0089F316 0000 0000 8000             		plcm	Nem_Sbz2Eggman, $8000	; Eggman
0089F31C 0000 0000 9400             		plcm	Nem_LzSwitch, $9400	; switch
0089F322                            	PLC_EggmanSBZ2end:
0089F322                            ; ---------------------------------------------------------------------------
0089F322                            ; Pattern load cues - final boss
0089F322                            ; ---------------------------------------------------------------------------
0089F322 0000                       PLC_FZBoss:	dc.w ((PLC_FZBossend-PLC_FZBoss-2)/6)-1
0089F324 0000 0000 7400             		plcm	Nem_FzEggman, $7400	; Eggman after boss
0089F32A 0000 0000 6000             		plcm	Nem_FzBoss, $6000	; FZ boss
0089F330 0000 0000 8000             		plcm	Nem_Eggman, $8000	; Eggman main patterns
0089F336 0000 0000 8E00             		plcm	Nem_Sbz2Eggman, $8E00	; Eggman without ship
0089F33C 0000 0000 A540             		plcm	Nem_Exhaust, $A540	; exhaust flame
0089F342                            	PLC_FZBossend:
0089F342                            
0089F342                            
0089F342                            		even
0089F342                            
0089F342                            ; ---------------------------------------------------------------------------
0089F342                            ; Pattern load cue IDs
0089F342                            ; ---------------------------------------------------------------------------
0089F342 =00000000                  plcid_Main:		equ (ptr_PLC_Main-ArtLoadCues)/2	; 0
0089F342 =00000001                  plcid_Main2:		equ (ptr_PLC_Main2-ArtLoadCues)/2	; 1
0089F342 =00000002                  plcid_Explode:		equ (ptr_PLC_Explode-ArtLoadCues)/2	; 2
0089F342 =00000003                  plcid_GameOver:		equ (ptr_PLC_GameOver-ArtLoadCues)/2	; 3
0089F342 =00000004                  plcid_GHZ:		equ (ptr_PLC_GHZ-ArtLoadCues)/2		; 4
0089F342 =00000005                  plcid_GHZ2:		equ (ptr_PLC_GHZ2-ArtLoadCues)/2	; 5
0089F342 =00000006                  plcid_LZ:		equ (ptr_PLC_LZ-ArtLoadCues)/2		; 6
0089F342 =00000007                  plcid_LZ2:		equ (ptr_PLC_LZ2-ArtLoadCues)/2		; 7
0089F342 =00000008                  plcid_MZ:		equ (ptr_PLC_MZ-ArtLoadCues)/2		; 8
0089F342 =00000009                  plcid_MZ2:		equ (ptr_PLC_MZ2-ArtLoadCues)/2		; 9
0089F342 =0000000A                  plcid_SLZ:		equ (ptr_PLC_SLZ-ArtLoadCues)/2		; $A
0089F342 =0000000B                  plcid_SLZ2:		equ (ptr_PLC_SLZ2-ArtLoadCues)/2	; $B
0089F342 =0000000C                  plcid_SYZ:		equ (ptr_PLC_SYZ-ArtLoadCues)/2		; $C
0089F342 =0000000D                  plcid_SYZ2:		equ (ptr_PLC_SYZ2-ArtLoadCues)/2	; $D
0089F342 =0000000E                  plcid_SBZ:		equ (ptr_PLC_SBZ-ArtLoadCues)/2		; $E
0089F342 =0000000F                  plcid_SBZ2:		equ (ptr_PLC_SBZ2-ArtLoadCues)/2	; $F
0089F342 =00000010                  plcid_TitleCard:	equ (ptr_PLC_TitleCard-ArtLoadCues)/2	; $10
0089F342 =00000011                  plcid_Boss:		equ (ptr_PLC_Boss-ArtLoadCues)/2	; $11
0089F342 =00000012                  plcid_Signpost:		equ (ptr_PLC_Signpost-ArtLoadCues)/2	; $12
0089F342 =00000013                  plcid_Warp:		equ (ptr_PLC_Warp-ArtLoadCues)/2	; $13
0089F342 =00000014                  plcid_SpecialStage:	equ (ptr_PLC_SpecialStage-ArtLoadCues)/2 ; $14
0089F342 =00000015                  plcid_GHZAnimals:	equ (ptr_PLC_GHZAnimals-ArtLoadCues)/2	; $15
0089F342 =00000016                  plcid_LZAnimals:	equ (ptr_PLC_LZAnimals-ArtLoadCues)/2	; $16
0089F342 =00000017                  plcid_MZAnimals:	equ (ptr_PLC_MZAnimals-ArtLoadCues)/2	; $17
0089F342 =00000018                  plcid_SLZAnimals:	equ (ptr_PLC_SLZAnimals-ArtLoadCues)/2	; $18
0089F342 =00000019                  plcid_SYZAnimals:	equ (ptr_PLC_SYZAnimals-ArtLoadCues)/2	; $19
0089F342 =0000001A                  plcid_SBZAnimals:	equ (ptr_PLC_SBZAnimals-ArtLoadCues)/2	; $1A
0089F342 =0000001B                  plcid_SSResult:		equ (ptr_PLC_SSResult-ArtLoadCues)/2	; $1B
0089F342 =0000001C                  plcid_Ending:		equ (ptr_PLC_Ending-ArtLoadCues)/2	; $1C
0089F342 =0000001D                  plcid_TryAgain:		equ (ptr_PLC_TryAgain-ArtLoadCues)/2	; $1D
0089F342 =0000001E                  plcid_EggmanSBZ2:	equ (ptr_PLC_EggmanSBZ2-ArtLoadCues)/2	; $1E
0089F342 =0000001F                  plcid_FZBoss:		equ (ptr_PLC_FZBoss-ArtLoadCues)/2	; $1F
0089F342 =0000001F                  plcid_FZBoss:		equ (ptr_PLC_FZBoss-ArtLoadCues)/2	; $1F
0089F342                            
0089F342                            		; Sound driver must start at $8A0000
008A0000                            SoundDriver:
008A0000                            		incbin "..\SMPS\SMPS.bin"
008EA0A8                            		OBJEND
0006A0A8                            ; ---------------------------------------------------------------------------
0006A0A8                            ; Second half of bank 0, SH-2 access only!
0006A0A8                            ; ---------------------------------------------------------------------------	
00080000                            		
00080000                            ; ---------------------------------------------------------------------------
00080000                            ; SH-2 Binary blob
00080000                            ; ---------------------------------------------------------------------------
00080000                            SH2_Binary:
00080000                            		incbin "..\sh2\sh2.bin"
000828E0                            SH2_END:
000828E0                            
000828E0                            ; ---------------------------------------------------------------------------
000828E0                            ; Start of Bank 1
000828E0                            ; ---------------------------------------------------------------------------
00100000                            		obj $900000		
00900000                            
00900000                            Nem_SegaLogo:	incbin	"artnem\Sega Logo (JP1).bin" ; large Sega logo
00900470                            		even
00900470                            Eni_SegaLogo:	incbin	"tilemaps\Sega Logo (JP1).bin" ; large Sega logo (mappings)
0090056C                            		even
0090056C                            		
0090056C                            Eni_Title:	incbin	"tilemaps\Title Screen (Uncompressed).bin" ; title screen foreground (mappings)
00900B44                            		even
00900B44                            Nem_TitleFg:	incbin	"artnem\Title Screen Foreground.bin"
00901B04 00                         		even
00901B04                            Nem_TitleSonic:	incbin	"artnem\Title Screen Sonic.bin"
009034D2                            		even
009034D2                            Nem_TitleTM:	incbin	"artnem\Title Screen TM.bin"
00903506                            		even
00903506                            Eni_JapNames:	incbin	"tilemaps\Hidden Japanese Credits.bin" ; Japanese credits (mappings)
009035C4                            		even
009035C4                            Nem_JapNames:	incbin	"artnem\Hidden Japanese Credits.bin"
00903A6C                            		even
00903A6C                            
00903A6C                            		include	"_maps\Sonic.asm"
00903A6C                            ; ---------------------------------------------------------------------------
00903A6C                            ; Sprite mappings - Sonic
00903A6C                            ; ---------------------------------------------------------------------------
00903A6C                            Map_Sonic:
00903A6C                            
00903A6C 0000                       ptr_MS_Null:	dc.w MS_Null-Map_Sonic
00903A6E 0000                       ptr_MS_Stand:	dc.w MS_Stand-Map_Sonic
00903A70 0000                       ptr_MS_Wait1:	dc.w MS_Wait1-Map_Sonic
00903A72 0000                       ptr_MS_Wait2:	dc.w MS_Wait2-Map_Sonic
00903A74 0000                       ptr_MS_Wait3:	dc.w MS_Wait3-Map_Sonic
00903A76 0000                       ptr_MS_LookUp:	dc.w MS_LookUp-Map_Sonic
00903A78 0000                       ptr_MS_Walk11:	dc.w MS_Walk11-Map_Sonic
00903A7A 0000                       ptr_MS_Walk12:	dc.w MS_Walk12-Map_Sonic
00903A7C 0000                       ptr_MS_Walk13:	dc.w MS_Walk13-Map_Sonic
00903A7E 0000                       ptr_MS_Walk14:	dc.w MS_Walk14-Map_Sonic
00903A80 0000                       ptr_MS_Walk15:	dc.w MS_Walk15-Map_Sonic
00903A82 0000                       ptr_MS_Walk16:	dc.w MS_Walk16-Map_Sonic
00903A84 0000                       ptr_MS_Walk21:	dc.w MS_Walk21-Map_Sonic
00903A86 0000                       ptr_MS_Walk22:	dc.w MS_Walk22-Map_Sonic
00903A88 0000                       ptr_MS_Walk23:	dc.w MS_Walk23-Map_Sonic
00903A8A 0000                       ptr_MS_Walk24:	dc.w MS_Walk24-Map_Sonic
00903A8C 0000                       ptr_MS_Walk25:	dc.w MS_Walk25-Map_Sonic
00903A8E 0000                       ptr_MS_Walk26:	dc.w MS_Walk26-Map_Sonic
00903A90 0000                       ptr_MS_Walk31:	dc.w MS_Walk31-Map_Sonic
00903A92 0000                       ptr_MS_Walk32:	dc.w MS_Walk32-Map_Sonic
00903A94 0000                       ptr_MS_Walk33:	dc.w MS_Walk33-Map_Sonic
00903A96 0000                       ptr_MS_Walk34:	dc.w MS_Walk34-Map_Sonic
00903A98 0000                       ptr_MS_Walk35:	dc.w MS_Walk35-Map_Sonic
00903A9A 0000                       ptr_MS_Walk36:	dc.w MS_Walk36-Map_Sonic
00903A9C 0000                       ptr_MS_Walk41:	dc.w MS_Walk41-Map_Sonic
00903A9E 0000                       ptr_MS_Walk42:	dc.w MS_Walk42-Map_Sonic
00903AA0 0000                       ptr_MS_Walk43:	dc.w MS_Walk43-Map_Sonic
00903AA2 0000                       ptr_MS_Walk44:	dc.w MS_Walk44-Map_Sonic
00903AA4 0000                       ptr_MS_Walk45:	dc.w MS_Walk45-Map_Sonic
00903AA6 0000                       ptr_MS_Walk46:	dc.w MS_Walk46-Map_Sonic
00903AA8 0000                       ptr_MS_Run11:	dc.w MS_Run11-Map_Sonic
00903AAA 0000                       ptr_MS_Run12:	dc.w MS_Run12-Map_Sonic
00903AAC 0000                       ptr_MS_Run13:	dc.w MS_Run13-Map_Sonic
00903AAE 0000                       ptr_MS_Run14:	dc.w MS_Run14-Map_Sonic
00903AB0 0000                       ptr_MS_Run21:	dc.w MS_Run21-Map_Sonic
00903AB2 0000                       ptr_MS_Run22:	dc.w MS_Run22-Map_Sonic
00903AB4 0000                       ptr_MS_Run23:	dc.w MS_Run23-Map_Sonic
00903AB6 0000                       ptr_MS_Run24:	dc.w MS_Run24-Map_Sonic
00903AB8 0000                       ptr_MS_Run31:	dc.w MS_Run31-Map_Sonic
00903ABA 0000                       ptr_MS_Run32:	dc.w MS_Run32-Map_Sonic
00903ABC 0000                       ptr_MS_Run33:	dc.w MS_Run33-Map_Sonic
00903ABE 0000                       ptr_MS_Run34:	dc.w MS_Run34-Map_Sonic
00903AC0 0000                       ptr_MS_Run41:	dc.w MS_Run41-Map_Sonic
00903AC2 0000                       ptr_MS_Run42:	dc.w MS_Run42-Map_Sonic
00903AC4 0000                       ptr_MS_Run43:	dc.w MS_Run43-Map_Sonic
00903AC6 0000                       ptr_MS_Run44:	dc.w MS_Run44-Map_Sonic
00903AC8 0000                       ptr_MS_Roll1:	dc.w MS_Roll1-Map_Sonic
00903ACA 0000                       ptr_MS_Roll2:	dc.w MS_Roll2-Map_Sonic
00903ACC 0000                       ptr_MS_Roll3:	dc.w MS_Roll3-Map_Sonic
00903ACE 0000                       ptr_MS_Roll4:	dc.w MS_Roll4-Map_Sonic
00903AD0 0000                       ptr_MS_Roll5:	dc.w MS_Roll5-Map_Sonic
00903AD2 0000                       ptr_MS_Warp1:	dc.w MS_Warp1-Map_Sonic
00903AD4 0000                       ptr_MS_Warp2:	dc.w MS_Warp2-Map_Sonic
00903AD6 0000                       ptr_MS_Warp3:	dc.w MS_Warp3-Map_Sonic
00903AD8 0000                       ptr_MS_Warp4:	dc.w MS_Warp4-Map_Sonic
00903ADA 0000                       ptr_MS_Stop1:	dc.w MS_Stop1-Map_Sonic
00903ADC 0000                       ptr_MS_Stop2:	dc.w MS_Stop2-Map_Sonic
00903ADE 0000                       ptr_MS_Duck:	dc.w MS_Duck-Map_Sonic
00903AE0 0000                       ptr_MS_Balance1:dc.w MS_Balance1-Map_Sonic
00903AE2 0000                       ptr_MS_Balance2:dc.w MS_Balance2-Map_Sonic
00903AE4 0000                       ptr_MS_Float1:	dc.w MS_Float1-Map_Sonic
00903AE6 0000                       ptr_MS_Float2:	dc.w MS_Float2-Map_Sonic
00903AE8 0000                       ptr_MS_Float3:	dc.w MS_Float3-Map_Sonic
00903AEA 0000                       ptr_MS_Float4:	dc.w MS_Float4-Map_Sonic
00903AEC 0000                       ptr_MS_Spring:	dc.w MS_Spring-Map_Sonic
00903AEE 0000                       ptr_MS_Hang1:	dc.w MS_Hang1-Map_Sonic
00903AF0 0000                       ptr_MS_Hang2:	dc.w MS_Hang2-Map_Sonic
00903AF2 0000                       ptr_MS_Leap1:	dc.w MS_Leap1-Map_Sonic
00903AF4 0000                       ptr_MS_Leap2:	dc.w MS_Leap2-Map_Sonic
00903AF6 0000                       ptr_MS_Push1:	dc.w MS_Push1-Map_Sonic
00903AF8 0000                       ptr_MS_Push2:	dc.w MS_Push2-Map_Sonic
00903AFA 0000                       ptr_MS_Push3:	dc.w MS_Push3-Map_Sonic
00903AFC 0000                       ptr_MS_Push4:	dc.w MS_Push4-Map_Sonic
00903AFE 0000                       ptr_MS_Surf:	dc.w MS_Surf-Map_Sonic
00903B00 0000                       ptr_MS_BubStand:dc.w MS_BubStand-Map_Sonic
00903B02 0000                       ptr_MS_Burnt:	dc.w MS_Burnt-Map_Sonic
00903B04 0000                       ptr_MS_Drown:	dc.w MS_Drown-Map_Sonic
00903B06 0000                       ptr_MS_Death:	dc.w MS_Death-Map_Sonic
00903B08 0000                       ptr_MS_Shrink1:	dc.w MS_Shrink1-Map_Sonic
00903B0A 0000                       ptr_MS_Shrink2:	dc.w MS_Shrink2-Map_Sonic
00903B0C 0000                       ptr_MS_Shrink3:	dc.w MS_Shrink3-Map_Sonic
00903B0E 0000                       ptr_MS_Shrink4:	dc.w MS_Shrink4-Map_Sonic
00903B10 0000                       ptr_MS_Shrink5:	dc.w MS_Shrink5-Map_Sonic
00903B12 0000                       ptr_MS_Float5:	dc.w MS_Float5-Map_Sonic
00903B14 0000                       ptr_MS_Float6:	dc.w MS_Float6-Map_Sonic
00903B16 0000                       ptr_MS_Injury:	dc.w MS_Injury-Map_Sonic
00903B18 0000                       ptr_MS_GetAir:	dc.w MS_GetAir-Map_Sonic
00903B1A 0000                       ptr_MS_WaterSlide:dc.w MS_WaterSlide-Map_Sonic
00903B1C                            
00903B1C 0000                       ptr_MS_WallJump:dc.w MS_WallJump-Map_Sonic
00903B1E =00000058                  fr_WallJump:	equ (ptr_MS_WallJump-Map_Sonic)/2
00903B1E                            	
00903B1E 0000                       ptr_MS_SpinDash1:dc.w MS_SpinDash-Map_Sonic
00903B20 0000                       ptr_MS_SpinDash2:dc.w MS_SpinDash-Map_Sonic
00903B22 0000                       ptr_MS_SpinDash3:dc.w MS_SpinDash-Map_Sonic
00903B24 0000                       ptr_MS_SpinDash4:dc.w MS_SpinDash-Map_Sonic
00903B26 0000                       ptr_MS_SpinDash5:dc.w MS_SpinDash-Map_Sonic
00903B28 0000                       ptr_MS_SpinDash6:dc.w MS_SpinDash-Map_Sonic
00903B2A =00000059                  fr_SpinDash1:	equ (ptr_MS_SpinDash1-Map_Sonic)/2
00903B2A =0000005A                  fr_SpinDash2:	equ (ptr_MS_SpinDash2-Map_Sonic)/2
00903B2A =0000005B                  fr_SpinDash3:	equ (ptr_MS_SpinDash3-Map_Sonic)/2
00903B2A =0000005C                  fr_SpinDash4:	equ (ptr_MS_SpinDash4-Map_Sonic)/2
00903B2A =0000005D                  fr_SpinDash5:	equ (ptr_MS_SpinDash5-Map_Sonic)/2
00903B2A =0000005E                  fr_SpinDash6:	equ (ptr_MS_SpinDash6-Map_Sonic)/2
00903B2A                            
00903B2A 0000                       ptr_MS_Dash11:dc.w	Map_Sonic_07D4-Map_Sonic
00903B2C 0000                       ptr_MS_Dash12:dc.w	Map_Sonic_07E0-Map_Sonic
00903B2E 0000                       ptr_MS_Dash13:dc.w	Map_Sonic_07EC-Map_Sonic
00903B30 0000                       ptr_MS_Dash14:dc.w	Map_Sonic_07F8-Map_Sonic
00903B32 0000                       ptr_MS_Dash21:dc.w	Map_Sonic_0804-Map_Sonic
00903B34 0000                       ptr_MS_Dash22:dc.w	Map_Sonic_081E-Map_Sonic
00903B36 0000                       ptr_MS_Dash23:dc.w	Map_Sonic_082E-Map_Sonic
00903B38 0000                       ptr_MS_Dash24:dc.w	Map_Sonic_0848-Map_Sonic
00903B3A 0000                       ptr_MS_Dash31:dc.w	Map_Sonic_0858-Map_Sonic
00903B3C 0000                       ptr_MS_Dash32:dc.w	Map_Sonic_0864-Map_Sonic
00903B3E 0000                       ptr_MS_Dash33:dc.w	Map_Sonic_0870-Map_Sonic
00903B40 0000                       ptr_MS_Dash34:dc.w	Map_Sonic_087C-Map_Sonic
00903B42 0000                       ptr_MS_Dash41:dc.w	Map_Sonic_0888-Map_Sonic
00903B44 0000                       ptr_MS_Dash42:dc.w	Map_Sonic_089E-Map_Sonic
00903B46 0000                       ptr_MS_Dash43:dc.w	Map_Sonic_08AE-Map_Sonic
00903B48 0000                       ptr_MS_Dash44:dc.w	Map_Sonic_08C8-Map_Sonic
00903B4A =0000005F                  fr_Dash11:	equ (ptr_MS_Dash11-Map_Sonic)/2
00903B4A =00000060                  fr_Dash12:	equ (ptr_MS_Dash12-Map_Sonic)/2
00903B4A =00000061                  fr_Dash13:	equ (ptr_MS_Dash13-Map_Sonic)/2
00903B4A =00000062                  fr_Dash14:	equ (ptr_MS_Dash14-Map_Sonic)/2
00903B4A =00000063                  fr_Dash21:	equ (ptr_MS_Dash21-Map_Sonic)/2
00903B4A =00000064                  fr_Dash22:	equ (ptr_MS_Dash22-Map_Sonic)/2
00903B4A =00000065                  fr_Dash23:	equ (ptr_MS_Dash23-Map_Sonic)/2
00903B4A =00000066                  fr_Dash24:	equ (ptr_MS_Dash24-Map_Sonic)/2
00903B4A =00000067                  fr_Dash31:	equ (ptr_MS_Dash31-Map_Sonic)/2
00903B4A =00000068                  fr_Dash32:	equ (ptr_MS_Dash32-Map_Sonic)/2
00903B4A =00000069                  fr_Dash33:	equ (ptr_MS_Dash33-Map_Sonic)/2
00903B4A =0000006A                  fr_Dash34:	equ (ptr_MS_Dash34-Map_Sonic)/2
00903B4A =0000006B                  fr_Dash41:	equ (ptr_MS_Dash41-Map_Sonic)/2
00903B4A =0000006C                  fr_Dash42:	equ (ptr_MS_Dash42-Map_Sonic)/2
00903B4A =0000006D                  fr_Dash43:	equ (ptr_MS_Dash43-Map_Sonic)/2
00903B4A =0000006E                  fr_Dash44:	equ (ptr_MS_Dash44-Map_Sonic)/2
00903B4A                            
00903B4A 0000                       ptr_MS_BalanceForward1:dc.w MS_BalanceForward1-Map_Sonic
00903B4C 0000                       ptr_MS_BalanceForward2:dc.w MS_BalanceForward2-Map_Sonic
00903B4E 0000                       ptr_MS_BalanceForward3:dc.w MS_BalanceForward3-Map_Sonic
00903B50 0000                       ptr_MS_BalanceForward4:dc.w MS_BalanceForward4-Map_Sonic
00903B52 0000                       ptr_MS_BalanceBack1:dc.w MS_BalanceBack1-Map_Sonic
00903B54 0000                       ptr_MS_BalanceBack2:dc.w MS_BalanceBack2-Map_Sonic
00903B56 0000                       ptr_MS_BalanceBack3:dc.w MS_BalanceBack3-Map_Sonic
00903B58 0000                       ptr_MS_BalanceBack4:dc.w MS_BalanceBack4-Map_Sonic
00903B5A =0000006F                  fr_BalanceForward1:	equ (ptr_MS_BalanceForward1-Map_Sonic)/2
00903B5A =00000070                  fr_BalanceForward2:	equ (ptr_MS_BalanceForward2-Map_Sonic)/2
00903B5A =00000071                  fr_BalanceForward3:	equ (ptr_MS_BalanceForward3-Map_Sonic)/2
00903B5A =00000072                  fr_BalanceForward4:	equ (ptr_MS_BalanceForward4-Map_Sonic)/2
00903B5A =00000073                  fr_BalanceBack1:	equ (ptr_MS_BalanceBack1-Map_Sonic)/2
00903B5A =00000074                  fr_BalanceBack2:	equ (ptr_MS_BalanceBack2-Map_Sonic)/2
00903B5A =00000075                  fr_BalanceBack3:	equ (ptr_MS_BalanceBack3-Map_Sonic)/2
00903B5A =00000076                  fr_BalanceBack4:	equ (ptr_MS_BalanceBack4-Map_Sonic)/2
00903B5A                            	
00903B5A 00                         MS_Null:	dc.b 0
00903B5B 04                         MS_Stand:	dc.b 4			; standing
00903B5C EC08 0000 F0               		dc.b $EC, 8, 0,	0, $F0
00903B61 F40D 0003 F0               		dc.b $F4, $D, 0, 3, $F0
00903B66 0408 000B F0               		dc.b 4,	8, 0, $B, $F0
00903B6B 0C08 000E F8               		dc.b $C, 8, 0, $E, $F8
00903B70 03                         MS_Wait1:	dc.b 3			; waiting 1
00903B71 EC09 0000 F0               		dc.b $EC, 9, 0,	0, $F0
00903B76 FC09 0006 F0               		dc.b $FC, 9, 0,	6, $F0
00903B7B 0C08 000C F8               		dc.b $C, 8, 0, $C, $F8
00903B80 03                         MS_Wait2:	dc.b 3			; waiting 2
00903B81 EC09 0000 F0               		dc.b $EC, 9, 0,	0, $F0
00903B86 FC09 0006 F0               		dc.b $FC, 9, 0,	6, $F0
00903B8B 0C08 000C F8               		dc.b $C, 8, 0, $C, $F8
00903B90 03                         MS_Wait3:	dc.b 3			; waiting 3
00903B91 EC09 0000 F0               		dc.b $EC, 9, 0,	0, $F0
00903B96 FC09 0006 F0               		dc.b $FC, 9, 0,	6, $F0
00903B9B 0C08 000C F8               		dc.b $C, 8, 0, $C, $F8
00903BA0 03                         MS_LookUp:	dc.b 3			; looking up
00903BA1 EC0A 0000 F0               		dc.b $EC, $A, 0, 0, $F0
00903BA6 0408 0009 F0               		dc.b 4,	8, 0, 9, $F0
00903BAB 0C08 000C F8               		dc.b $C, 8, 0, $C, $F8
00903BB0 04                         MS_Walk11:	dc.b 4			; walking 1-1
00903BB1 EB0D 0000 EC               		dc.b $EB, $D, 0, 0, $EC
00903BB6 FB09 0008 EC               		dc.b $FB, 9, 0,	8, $EC
00903BBB FB06 000E 04               		dc.b $FB, 6, 0,	$E, 4
00903BC0 0B04 0014 EC               		dc.b $B, 4, 0, $14, $EC
00903BC5 02                         MS_Walk12:	dc.b 2			; walking 1-2
00903BC6 EC0D 0000 ED               		dc.b $EC, $D, 0, 0, $ED
00903BCB FC0E 0008 F5               		dc.b $FC, $E, 0, 8, $F5
00903BD0 02                         MS_Walk13:	dc.b 2			; walking 1-3
00903BD1 ED09 0000 F3               		dc.b $ED, 9, 0,	0, $F3
00903BD6 FD0A 0006 F3               		dc.b $FD, $A, 0, 6, $F3
00903BDB 04                         MS_Walk14:	dc.b 4			; walking 1-4
00903BDC EB09 0000 F4               		dc.b $EB, 9, 0,	0, $F4
00903BE1 FB09 0006 EC               		dc.b $FB, 9, 0,	6, $EC
00903BE6 FB06 000C 04               		dc.b $FB, 6, 0,	$C, 4
00903BEB 0B04 0012 EC               		dc.b $B, 4, 0, $12, $EC
00903BF0 02                         MS_Walk15:	dc.b 2			; walking 1-5
00903BF1 EC09 0000 F3               		dc.b $EC, 9, 0,	0, $F3
00903BF6 FC0E 0006 EB               		dc.b $FC, $E, 0, 6, $EB
00903BFB 03                         MS_Walk16:	dc.b 3			; walking 1-6
00903BFC ED0D 0000 EC               		dc.b $ED, $D, 0, 0, $EC
00903C01 FD0C 0008 F4               		dc.b $FD, $C, 0, 8, $F4
00903C06 0509 000C F4               		dc.b 5,	9, 0, $C, $F4
00903C0B 05                         MS_Walk21:	dc.b 5			; walking 2-1
00903C0C EB09 0000 EB               		dc.b $EB, 9, 0,	0, $EB
00903C11 EB06 0006 03               		dc.b $EB, 6, 0,	6, 3
00903C16 FB08 000C EB               		dc.b $FB, 8, 0,	$C, $EB
00903C1B 0309 000F F3               		dc.b 3,	9, 0, $F, $F3
00903C20 1300 0015 FB               		dc.b $13, 0, 0,	$15, $FB
00903C25 06                         MS_Walk22:	dc.b 6			; walking 2-2
00903C26 EC09 0000 EC               		dc.b $EC, 9, 0,	0, $EC
00903C2B EC01 0006 04               		dc.b $EC, 1, 0,	6, 4
00903C30 FC0C 0008 EC               		dc.b $FC, $C, 0, 8, $EC
00903C35 0409 000C F4               		dc.b 4,	9, 0, $C, $F4
00903C3A FC05 0012 0C               		dc.b $FC, 5, 0,	$12, $C
00903C3F F400 0016 14               		dc.b $F4, 0, 0,	$16, $14
00903C44 04                         MS_Walk23:	dc.b 4			; walking 2-3
00903C45 ED09 0000 ED               		dc.b $ED, 9, 0,	0, $ED
00903C4A ED01 0006 05               		dc.b $ED, 1, 0,	6, 5
00903C4F FD0D 0008 F5               		dc.b $FD, $D, 0, 8, $F5
00903C54 0D08 0010 FD               		dc.b $D, 8, 0, $10, $FD
00903C59 05                         MS_Walk24:	dc.b 5			; walking 2-4
00903C5A EB09 0000 EB               		dc.b $EB, 9, 0,	0, $EB
00903C5F EB05 0006 03               		dc.b $EB, 5, 0,	6, 3
00903C64 FB0D 000A F3               		dc.b $FB, $D, 0, $A, $F3
00903C69 0B08 0012 F3               		dc.b $B, 8, 0, $12, $F3
00903C6E 1304 0015 FB               		dc.b $13, 4, 0,	$15, $FB
00903C73 04                         MS_Walk25:	dc.b 4			; walking 2-5
00903C74 EC09 0000 EC               		dc.b $EC, 9, 0,	0, $EC
00903C79 EC01 0006 04               		dc.b $EC, 1, 0,	6, 4
00903C7E FC0D 0008 F4               		dc.b $FC, $D, 0, 8, $F4
00903C83 0C08 0010 FC               		dc.b $C, 8, 0, $10, $FC
00903C88 05                         MS_Walk26:	dc.b 5			; walking 2-6
00903C89 ED09 0000 ED               		dc.b $ED, 9, 0,	0, $ED
00903C8E ED01 0006 05               		dc.b $ED, 1, 0,	6, 5
00903C93 FD00 0008 ED               		dc.b $FD, 0, 0,	8, $ED
00903C98 FD0D 0009 F5               		dc.b $FD, $D, 0, 9, $F5
00903C9D 0D08 0011 FD               		dc.b $D, 8, 0, $11, $FD
00903CA2 04                         MS_Walk31:	dc.b 4			; walking 3-1
00903CA3 F407 0000 EB               		dc.b $F4, 7, 0,	0, $EB
00903CA8 EC09 0008 FB               		dc.b $EC, 9, 0,	8, $FB
00903CAD FC04 000E FB               		dc.b $FC, 4, 0,	$E, $FB
00903CB2 0409 0010 FB               		dc.b 4,	9, 0, $10, $FB
00903CB7 02                         MS_Walk32:	dc.b 2			; walking 3-2
00903CB8 F407 0000 EC               		dc.b $F4, 7, 0,	0, $EC
00903CBD EC0B 0008 FC               		dc.b $EC, $B, 0, 8, $FC
00903CC2 02                         MS_Walk33:	dc.b 2			; walking 3-3
00903CC3 F406 0000 ED               		dc.b $F4, 6, 0,	0, $ED
00903CC8 F40A 0006 FD               		dc.b $F4, $A, 0, 6, $FD
00903CCD 04                         MS_Walk34:	dc.b 4			; walking 3-4
00903CCE F406 0000 EB               		dc.b $F4, 6, 0,	0, $EB
00903CD3 EC09 0006 FB               		dc.b $EC, 9, 0,	6, $FB
00903CD8 FC04 000C FB               		dc.b $FC, 4, 0,	$C, $FB
00903CDD 0409 000E FB               		dc.b 4,	9, 0, $E, $FB
00903CE2 02                         MS_Walk35:	dc.b 2			; walking 3-5
00903CE3 F406 0000 EC               		dc.b $F4, 6, 0,	0, $EC
00903CE8 F40B 0006 FC               		dc.b $F4, $B, 0, 6, $FC
00903CED 03                         MS_Walk36:	dc.b 3			; walking 3-6
00903CEE F407 0000 ED               		dc.b $F4, 7, 0,	0, $ED
00903CF3 EC00 0008 FD               		dc.b $EC, 0, 0,	8, $FD
00903CF8 F40A 0009 FD               		dc.b $F4, $A, 0, 9, $FD
00903CFD 06                         MS_Walk41:	dc.b 6			; walking 4-1
00903CFE FD06 0000 EB               		dc.b $FD, 6, 0,	0, $EB
00903D03 ED04 0006 F3               		dc.b $ED, 4, 0,	6, $F3
00903D08 F504 0008 EB               		dc.b $F5, 4, 0,	8, $EB
00903D0D F50A 000A FB               		dc.b $F5, $A, 0, $A, $FB
00903D12 0D00 0013 FB               		dc.b $D, 0, 0, $13, $FB
00903D17 FD00 0014 13               		dc.b $FD, 0, 0,	$14, $13
00903D1C 06                         MS_Walk42:	dc.b 6			; walking 4-2
00903D1D FC06 0000 EC               		dc.b $FC, 6, 0,	0, $EC
00903D22 E408 0006 F4               		dc.b $E4, 8, 0,	6, $F4
00903D27 EC04 0009 FC               		dc.b $EC, 4, 0,	9, $FC
00903D2C F404 000B EC               		dc.b $F4, 4, 0,	$B, $EC
00903D31 F40A 000D FC               		dc.b $F4, $A, 0, $D, $FC
00903D36 0C00 0016 FC               		dc.b $C, 0, 0, $16, $FC
00903D3B 04                         MS_Walk43:	dc.b 4			; walking 4-3
00903D3C FB06 0000 ED               		dc.b $FB, 6, 0,	0, $ED
00903D41 F304 0006 ED               		dc.b $F3, 4, 0,	6, $ED
00903D46 EB0A 0008 FD               		dc.b $EB, $A, 0, 8, $FD
00903D4B 0304 0011 FD               		dc.b 3,	4, 0, $11, $FD
00903D50 05                         MS_Walk44:	dc.b 5			; walking 4-4
00903D51 FD06 0000 EB               		dc.b $FD, 6, 0,	0, $EB
00903D56 ED08 0006 F3               		dc.b $ED, 8, 0,	6, $F3
00903D5B F504 0009 EB               		dc.b $F5, 4, 0,	9, $EB
00903D60 F50D 000B FB               		dc.b $F5, $D, 0, $B, $FB
00903D65 0508 0013 FB               		dc.b 5,	8, 0, $13, $FB
00903D6A 04                         MS_Walk45:	dc.b 4			; walking 4-5
00903D6B FC06 0000 EC               		dc.b $FC, 6, 0,	0, $EC
00903D70 F404 0006 EC               		dc.b $F4, 4, 0,	6, $EC
00903D75 EC0A 0008 FC               		dc.b $EC, $A, 0, 8, $FC
00903D7A 0404 0011 FC               		dc.b 4,	4, 0, $11, $FC
00903D7F 05                         MS_Walk46:	dc.b 5			; walking 4-6
00903D80 FB06 0000 ED               		dc.b $FB, 6, 0,	0, $ED
00903D85 EB0A 0006 FD               		dc.b $EB, $A, 0, 6, $FD
00903D8A F304 000F ED               		dc.b $F3, 4, 0,	$F, $ED
00903D8F 0304 0011 FD               		dc.b 3,	4, 0, $11, $FD
00903D94 0B00 0013 FD               		dc.b $B, 0, 0, $13, $FD
00903D99 02                         MS_Run11:	dc.b 2			; running 1-1
00903D9A EE09 0000 F4               		dc.b $EE, 9, 0,	0, $F4
00903D9F FE0E 0006 EC               		dc.b $FE, $E, 0, 6, $EC
00903DA4 02                         MS_Run12:	dc.b 2			; running 1-2
00903DA5 EE09 0000 F4               		dc.b $EE, 9, 0,	0, $F4
00903DAA FE0E 0006 EC               		dc.b $FE, $E, 0, 6, $EC
00903DAF 02                         MS_Run13:	dc.b 2			; running 1-3
00903DB0 EE09 0000 F4               		dc.b $EE, 9, 0,	0, $F4
00903DB5 FE0E 0006 EC               		dc.b $FE, $E, 0, 6, $EC
00903DBA 02                         MS_Run14:	dc.b 2			; running 1-4
00903DBB EE09 0000 F4               		dc.b $EE, 9, 0,	0, $F4
00903DC0 FE0E 0006 EC               		dc.b $FE, $E, 0, 6, $EC
00903DC5 04                         MS_Run21:	dc.b 4			; running 2-1
00903DC6 EE09 0000 EE               		dc.b $EE, 9, 0,	0, $EE
00903DCB EE01 0006 06               		dc.b $EE, 1, 0,	6, 6
00903DD0 FE0E 0008 F6               		dc.b $FE, $E, 0, 8, $F6
00903DD5 FE00 0014 EE               		dc.b $FE, 0, 0,	$14, $EE
00903DDA 03                         MS_Run22:	dc.b 3			; running 2-2
00903DDB EE09 0000 EE               		dc.b $EE, 9, 0,	0, $EE
00903DE0 EE01 0006 06               		dc.b $EE, 1, 0,	6, 6
00903DE5 FE0E 0008 F6               		dc.b $FE, $E, 0, 8, $F6
00903DEA 04                         MS_Run23:	dc.b 4			; running 2-3
00903DEB EE09 0000 EE               		dc.b $EE, 9, 0,	0, $EE
00903DF0 EE01 0006 06               		dc.b $EE, 1, 0,	6, 6
00903DF5 FE0E 0008 F6               		dc.b $FE, $E, 0, 8, $F6
00903DFA FE00 0014 EE               		dc.b $FE, 0, 0,	$14, $EE
00903DFF 03                         MS_Run24:	dc.b 3			; running 2-4
00903E00 EE09 0000 EE               		dc.b $EE, 9, 0,	0, $EE
00903E05 EE01 0006 06               		dc.b $EE, 1, 0,	6, 6
00903E0A FE0E 0008 F6               		dc.b $FE, $E, 0, 8, $F6
00903E0F 02                         MS_Run31:	dc.b 2			; running 3-1
00903E10 F406 0000 EE               		dc.b $F4, 6, 0,	0, $EE
00903E15 F40B 0006 FE               		dc.b $F4, $B, 0, 6, $FE
00903E1A 02                         MS_Run32:	dc.b 2			; running 3-2
00903E1B F406 0000 EE               		dc.b $F4, 6, 0,	0, $EE
00903E20 F40B 0006 FE               		dc.b $F4, $B, 0, 6, $FE
00903E25 02                         MS_Run33:	dc.b 2			; running 3-3
00903E26 F406 0000 EE               		dc.b $F4, 6, 0,	0, $EE
00903E2B F40B 0006 FE               		dc.b $F4, $B, 0, 6, $FE
00903E30 02                         MS_Run34:	dc.b 2			; running 3-4
00903E31 F406 0000 EE               		dc.b $F4, 6, 0,	0, $EE
00903E36 F40B 0006 FE               		dc.b $F4, $B, 0, 6, $FE
00903E3B 04                         MS_Run41:	dc.b 4			; running 4-1
00903E3C FA06 0000 EE               		dc.b $FA, 6, 0,	0, $EE
00903E41 F204 0006 EE               		dc.b $F2, 4, 0,	6, $EE
00903E46 EA0B 0008 FE               		dc.b $EA, $B, 0, 8, $FE
00903E4B 0A00 0014 FE               		dc.b $A, 0, 0, $14, $FE
00903E50 02                         MS_Run42:	dc.b 2			; running 4-2
00903E51 F207 0000 EE               		dc.b $F2, 7, 0,	0, $EE
00903E56 EA0B 0008 FE               		dc.b $EA, $B, 0, 8, $FE
00903E5B 04                         MS_Run43:	dc.b 4			; running 4-3
00903E5C FA06 0000 EE               		dc.b $FA, 6, 0,	0, $EE
00903E61 F204 0006 EE               		dc.b $F2, 4, 0,	6, $EE
00903E66 EA0B 0008 FE               		dc.b $EA, $B, 0, 8, $FE
00903E6B 0A00 0014 FE               		dc.b $A, 0, 0, $14, $FE
00903E70 02                         MS_Run44:	dc.b 2			; running 4-4
00903E71 F207 0000 EE               		dc.b $F2, 7, 0,	0, $EE
00903E76 EA0B 0008 FE               		dc.b $EA, $B, 0, 8, $FE
00903E7B 01                         MS_Roll1:	dc.b 1			; rolling 1
00903E7C F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903E81 01                         MS_Roll2:	dc.b 1			; rolling 2
00903E82 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903E87 01                         MS_Roll3:	dc.b 1			; rolling 3
00903E88 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903E8D 01                         MS_Roll4:	dc.b 1			; rolling 4
00903E8E F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903E93 01                         MS_Roll5:	dc.b 1			; rolling 5
00903E94 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903E99 02                         MS_Warp1:	dc.b 2			; warped 1 (unused)
00903E9A F40E 0000 EC               		dc.b $F4, $E, 0, 0, $EC
00903E9F F402 000C 0C               		dc.b $F4, 2, 0,	$C, $C
00903EA4 01                         MS_Warp2:	dc.b 1			; warped 2 (unused)
00903EA5 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903EAA 02                         MS_Warp3:	dc.b 2			; warped 3 (unused)
00903EAB EC0B 0000 F4               		dc.b $EC, $B, 0, 0, $F4
00903EB0 0C08 000C F4               		dc.b $C, 8, 0, $C, $F4
00903EB5 01                         MS_Warp4:	dc.b 1			; warped 4 (unused)
00903EB6 F00F 0000 F0               		dc.b $F0, $F, 0, 0, $F0
00903EBB 02                         MS_Stop1:	dc.b 2			; stopping 1
00903EBC ED09 0000 F0               		dc.b $ED, 9, 0,	0, $F0
00903EC1 FD0E 0006 F0               		dc.b $FD, $E, 0, 6, $F0
00903EC6 04                         MS_Stop2:	dc.b 4			; stopping 2
00903EC7 ED09 0000 F0               		dc.b $ED, 9, 0,	0, $F0
00903ECC FD0D 0006 F0               		dc.b $FD, $D, 0, 6, $F0
00903ED1 0D04 000E 00               		dc.b $D, 4, 0, $E, 0
00903ED6 0500 0010 E8               		dc.b 5,	0, 0, $10, $E8
00903EDB 04                         MS_Duck:	dc.b 4			; ducking
00903EDC F404 0000 FC               		dc.b $F4, 4, 0,	0, $FC
00903EE1 FC0D 0002 F4               		dc.b $FC, $D, 0, 2, $F4
00903EE6 0C08 000A F4               		dc.b $C, 8, 0, $A, $F4
00903EEB 0400 000D EC               		dc.b 4,	0, 0, $D, $EC
00903EF0 03                         MS_Balance1:	dc.b 3			; balancing 1
00903EF1 EC08 0800 E8               		dc.b $EC, 8, 8,	0, $E8
00903EF6 F402 0803 00               		dc.b $F4, 2, 8,	3, 0
00903EFB F40F 0806 E0               		dc.b $F4, $F, 8, 6, $E0
00903F00 03                         MS_Balance2:	dc.b 3			; balancing 2
00903F01 EC0E 0800 E8               		dc.b $EC, $E, 8, 0, $E8
00903F06 040D 080C E0               		dc.b 4,	$D, 8, $C, $E0
00903F0B 0C00 1814 00               		dc.b $C, 0, $18, $14, 0
00903F10 03                         MS_Float1:	dc.b 3			; spinning 1 (LZ)
00903F11 F40D 0000 FC               		dc.b $F4, $D, 0, 0, $FC
00903F16 FC05 0008 EC               		dc.b $FC, 5, 0,	8, $EC
00903F1B 0408 000C FC               		dc.b 4,	8, 0, $C, $FC
00903F20 02                         MS_Float2:	dc.b 2			; spinning 2 (LZ)
00903F21 F40A 0000 E8               		dc.b $F4, $A, 0, 0, $E8
00903F26 F40A 0800 00               		dc.b $F4, $A, 8, 0, 0
00903F2B 03                         MS_Float3:	dc.b 3			; spinning 3 (LZ)
00903F2C F40D 0000 E4               		dc.b $F4, $D, 0, 0, $E4
00903F31 FC00 0008 04               		dc.b $FC, 0, 0,	8, 4
00903F36 040C 0009 EC               		dc.b 4,	$C, 0, 9, $EC
00903F3B 03                         MS_Float4:	dc.b 3			; spinning 4 (LZ)
00903F3C F40D 0000 FC               		dc.b $F4, $D, 0, 0, $FC
00903F41 FC05 0008 EC               		dc.b $FC, 5, 0,	8, $EC
00903F46 0408 000C FC               		dc.b 4,	8, 0, $C, $FC
00903F4B 03                         MS_Spring:	dc.b 3			; bouncing on a spring
00903F4C E80B 0000 F0               		dc.b $E8, $B, 0, 0, $F0
00903F51 0804 000C F8               		dc.b 8,	4, 0, $C, $F8
00903F56 1000 000E F8               		dc.b $10, 0, 0,	$E, $F8
00903F5B 04                         MS_Hang1:	dc.b 4			; hanging 1 (LZ)
00903F5C F80E 0000 E8               		dc.b $F8, $E, 0, 0, $E8
00903F61 0005 000C 08               		dc.b 0,	5, 0, $C, 8
00903F66 F800 0010 08               		dc.b $F8, 0, 0,	$10, 8
00903F6B F000 0011 F8               		dc.b $F0, 0, 0,	$11, $F8
00903F70 04                         MS_Hang2:	dc.b 4			; hanging 2 (LZ)
00903F71 F80E 0000 E8               		dc.b $F8, $E, 0, 0, $E8
00903F76 0005 000C 08               		dc.b 0,	5, 0, $C, 8
00903F7B F800 0010 08               		dc.b $F8, 0, 0,	$10, 8
00903F80 F000 0011 F8               		dc.b $F0, 0, 0,	$11, $F8
00903F85 05                         MS_Leap1:	dc.b 5			; celebration leap 1 (unused)
00903F86 E80A 0000 F4               		dc.b $E8, $A, 0, 0, $F4
00903F8B F001 0009 0C               		dc.b $F0, 1, 0,	9, $C
00903F90 0009 000B F4               		dc.b 0,	9, 0, $B, $F4
00903F95 1004 0011 F4               		dc.b $10, 4, 0,	$11, $F4
00903F9A 0000 0013 EC               		dc.b 0,	0, 0, $13, $EC
00903F9F 05                         MS_Leap2:	dc.b 5			; celebration leap 2 (unused)
00903FA0 E80A 0000 F4               		dc.b $E8, $A, 0, 0, $F4
00903FA5 E801 0009 0C               		dc.b $E8, 1, 0,	9, $C
00903FAA 0009 000B F4               		dc.b 0,	9, 0, $B, $F4
00903FAF 1004 0011 F4               		dc.b $10, 4, 0,	$11, $F4
00903FB4 0000 0013 EC               		dc.b 0,	0, 0, $13, $EC
00903FB9 02                         MS_Push1:	dc.b 2			; pushing 1
00903FBA ED0A 0000 F3               		dc.b $ED, $A, 0, 0, $F3
00903FBF 050D 0009 EB               		dc.b 5,	$D, 0, 9, $EB
00903FC4 03                         MS_Push2:	dc.b 3			; pushing 2
00903FC5 EC0A 0000 F3               		dc.b $EC, $A, 0, 0, $F3
00903FCA 0408 0009 F3               		dc.b 4,	8, 0, 9, $F3
00903FCF 0C04 000C F3               		dc.b $C, 4, 0, $C, $F3
00903FD4 02                         MS_Push3:	dc.b 2			; pushing 3
00903FD5 ED0A 0000 F3               		dc.b $ED, $A, 0, 0, $F3
00903FDA 050D 0009 EB               		dc.b 5,	$D, 0, 9, $EB
00903FDF 03                         MS_Push4:	dc.b 3			; pushing 4
00903FE0 EC0A 0000 F3               		dc.b $EC, $A, 0, 0, $F3
00903FE5 0408 0009 F3               		dc.b 4,	8, 0, 9, $F3
00903FEA 0C04 000C F3               		dc.b $C, 4, 0, $C, $F3
00903FEF 02                         MS_Surf:	dc.b 2			; surfing or sliding (unused)
00903FF0 EC09 0000 F0               		dc.b $EC, 9, 0,	0, $F0
00903FF5 FC0E 0006 F0               		dc.b $FC, $E, 0, 6, $F0
00903FFA 03                         MS_BubStand:	dc.b 3			; collecting bubble (unused)
00903FFB EC0A 0000 F0               		dc.b $EC, $A, 0, 0, $F0
00904000 0405 0009 F8               		dc.b 4,	5, 0, 9, $F8
00904005 E400 000D F8               		dc.b $E4, 0, 0,	$D, $F8
0090400A 03                         MS_Burnt:	dc.b 3			; grey death
0090400B E80D 0000 EC               		dc.b $E8, $D, 0, 0, $EC
00904010 E801 0008 0C               		dc.b $E8, 1, 0,	8, $C
00904015 F80B 000A F4               		dc.b $F8, $B, 0, $A, $F4
0090401A 05                         MS_Drown:	dc.b 5			; drowning
0090401B E80D 0000 EC               		dc.b $E8, $D, 0, 0, $EC
00904020 E801 0008 0C               		dc.b $E8, 1, 0,	8, $C
00904025 F809 000A F4               		dc.b $F8, 9, 0,	$A, $F4
0090402A 080C 0010 F4               		dc.b 8,	$C, 0, $10, $F4
0090402F 1000 0014 F4               		dc.b $10, 0, 0,	$14, $F4
00904034 05                         MS_Death:	dc.b 5			; death
00904035 E80D 0000 EC               		dc.b $E8, $D, 0, 0, $EC
0090403A E801 0008 0C               		dc.b $E8, 1, 0,	8, $C
0090403F F809 000A F4               		dc.b $F8, 9, 0,	$A, $F4
00904044 080C 0010 F4               		dc.b 8,	$C, 0, $10, $F4
00904049 1000 0014 F4               		dc.b $10, 0, 0,	$14, $F4
0090404E 02                         MS_Shrink1:	dc.b 2			; shrinking 1 (unused)
0090404F EC08 0000 F0               		dc.b $EC, 8, 0,	0, $F0
00904054 F40F 0003 F0               		dc.b $F4, $F, 0, 3, $F0
00904059 03                         MS_Shrink2:	dc.b 3			; shrinking 2 (unused)
0090405A EC08 0000 F0               		dc.b $EC, 8, 0,	0, $F0
0090405F F40E 0003 F0               		dc.b $F4, $E, 0, 3, $F0
00904064 0C08 000F F8               		dc.b $C, 8, 0, $F, $F8
00904069 01                         MS_Shrink3:	dc.b 1			; shrinking 3 (unused)
0090406A F00B 0000 F4               		dc.b $F0, $B, 0, 0, $F4
0090406F 01                         MS_Shrink4:	dc.b 1			; shrinking 4 (unused)
00904070 F406 0000 F8               		dc.b $F4, 6, 0,	0, $F8
00904075 01                         MS_Shrink5:	dc.b 1			; shrinking 5 (unused)
00904076 F801 0000 FC               		dc.b $F8, 1, 0,	0, $FC
0090407B 03                         MS_Float5:	dc.b 3			; spinning 5 (LZ)
0090407C F40D 0800 E4               		dc.b $F4, $D, 8, 0, $E4
00904081 FC05 0808 04               		dc.b $FC, 5, 8,	8, 4
00904086 0408 080C EC               		dc.b 4,	8, 8, $C, $EC
0090408B 03                         MS_Float6:	dc.b 3			; spinning 6 (LZ)
0090408C F40D 0800 FC               		dc.b $F4, $D, 8, 0, $FC
00904091 FC00 0808 F4               		dc.b $FC, 0, 8,	8, $F4
00904096 040C 0809 F4               		dc.b 4,	$C, 8, 9, $F4
0090409B 03                         MS_Injury:	dc.b 3			; injury
0090409C F00E 0000 EC               		dc.b $F0, $E, 0, 0, $EC
009040A1 F801 000C 0C               		dc.b $F8, 1, 0,	$C, $C
009040A6 080C 000E F4               		dc.b 8,	$C, 0, $E, $F4
009040AB 03                         MS_GetAir:	dc.b 3			; collecting bubble (LZ)
009040AC EB09 0000 F4               		dc.b $EB, 9, 0,	0, $F4
009040B1 FB0E 0006 EC               		dc.b $FB, $E, 0, 6, $EC
009040B6 0301 0012 0C               		dc.b 3,	1, 0, $12, $C
009040BB 02                         MS_WaterSlide:	dc.b 2			; water	slide (LZ)
009040BC F00F 0000 EC               		dc.b $F0, $F, 0, 0, $EC
009040C1 F802 0010 0C               		dc.b $F8, 2, 0,	$10, $C
009040C6                            		
009040C6 02                         MS_WallJump:	dc.b 2			; Wall Jump
009040C7 ED09 0000 EE               		dc.b $ED, 9, 0,	0, $EE
009040CC FD0E 0006 EE               		dc.b $FD, $E, 0, 6, $EE
009040D1                            	
009040D1 01                         MS_SpinDash:	dc.b 1
009040D2 F80F 0000 F4               	SpriteMap	-12, -8, 4, 4, 0, 0, 0, 0, 0
009040D7                            	
009040D7 02                         Map_Sonic_07D4:	dc.b	2
009040D8 F802 0000 EC               	SpriteMap	-20, -8, 1, 3, 0, 0, 0, 0, 0x0000
009040DD F00F 0003 F4               	SpriteMap	-12, -16, 4, 4, 0, 0, 0, 0, 0x0003
009040E2                            
009040E2 02                         Map_Sonic_07E0:	dc.b	2
009040E3 F802 0000 EC               	SpriteMap	-20, -8, 1, 3, 0, 0, 0, 0, 0x0000
009040E8 F00F 0003 F4               	SpriteMap	-12, -16, 4, 4, 0, 0, 0, 0, 0x0003
009040ED                            
009040ED 02                         Map_Sonic_07EC:	dc.b	2
009040EE F802 0000 EC               	SpriteMap	-20, -8, 1, 3, 0, 0, 0, 0, 0x0000
009040F3 F00F 0003 F4               	SpriteMap	-12, -16, 4, 4, 0, 0, 0, 0, 0x0003
009040F8                            
009040F8 02                         Map_Sonic_07F8:	dc.b	2
009040F9 F801 0000 EC               	SpriteMap	-20, -8, 1, 2, 0, 0, 0, 0, 0x0000
009040FE F00F 0002 F4               	SpriteMap	-12, -16, 4, 4, 0, 0, 0, 0, 0x0002
00904103                            
00904103 05                         Map_Sonic_0804:	dc.b	5
00904104 EB08 0000 F4               	SpriteMap	-12, -21, 3, 1, 0, 0, 0, 0, 0x0000
00904109 F30E 0003 EC               	SpriteMap	-20, -13, 4, 3, 0, 0, 0, 0, 0x0003
0090410E F302 000F 0C               	SpriteMap	12, -13, 1, 3, 0, 0, 0, 0, 0x000F
00904113 0B05 0012 EC               	SpriteMap	-20, 11, 2, 2, 0, 0, 0, 0, 0x0012
00904118 0B00 0016 FC               	SpriteMap	-4, 11, 1, 1, 0, 0, 0, 0, 0x0016
0090411D                            
0090411D 03                         Map_Sonic_081E:	dc.b	3
0090411E EC08 0000 F4               	SpriteMap	-12, -20, 3, 1, 0, 0, 0, 0, 0x0000
00904123 F40F 0003 EC               	SpriteMap	-20, -12, 4, 4, 0, 0, 0, 0, 0x0003
00904128 FC01 0013 0C               	SpriteMap	12, -4, 1, 2, 0, 0, 0, 0, 0x0013
0090412D                            
0090412D 05                         Map_Sonic_082E:	dc.b	5
0090412E EC08 0000 F3               	SpriteMap	-13, -20, 3, 1, 0, 0, 0, 0, 0x0000
00904133 F40E 0003 F3               	SpriteMap	-13, -12, 4, 3, 0, 0, 0, 0, 0x0003
00904138 FC02 000F EB               	SpriteMap	-21, -4, 1, 3, 0, 0, 0, 0, 0x000F
0090413D 0C05 0012 F3               	SpriteMap	-13, 12, 2, 2, 0, 0, 0, 0, 0x0012
00904142 0C00 0016 03               	SpriteMap	3, 12, 1, 1, 0, 0, 0, 0, 0x0016
00904147                            
00904147 03                         Map_Sonic_0848:	dc.b	3
00904148 EB08 0000 F4               	SpriteMap	-12, -21, 3, 1, 0, 0, 0, 0, 0x0000
0090414D F30F 0003 EC               	SpriteMap	-20, -13, 4, 4, 0, 0, 0, 0, 0x0003
00904152 FB01 0013 0C               	SpriteMap	12, -5, 1, 2, 0, 0, 0, 0, 0x0013
00904157                            
00904157 02                         Map_Sonic_0858:	dc.b	2
00904158 EC0F 0000 F0               	SpriteMap	-16, -20, 4, 4, 0, 0, 0, 0, 0x0000
0090415D 0C08 0010 F8               	SpriteMap	-8, 12, 3, 1, 0, 0, 0, 0, 0x0010
00904162                            
00904162 02                         Map_Sonic_0864:	dc.b	2
00904163 EC0F 0000 F0               	SpriteMap	-16, -20, 4, 4, 0, 0, 0, 0, 0x0000
00904168 0C08 0010 F8               	SpriteMap	-8, 12, 3, 1, 0, 0, 0, 0, 0x0010
0090416D                            
0090416D 02                         Map_Sonic_0870:	dc.b	2
0090416E EC0F 0000 F0               	SpriteMap	-16, -20, 4, 4, 0, 0, 0, 0, 0x0000
00904173 0C08 0010 F8               	SpriteMap	-8, 12, 3, 1, 0, 0, 0, 0, 0x0010
00904178                            
00904178 02                         Map_Sonic_087C:	dc.b	2
00904179 EC0F 0000 F0               	SpriteMap	-16, -20, 4, 4, 0, 0, 0, 0, 0x0000
0090417E 0C04 0010 F8               	SpriteMap	-8, 12, 2, 1, 0, 0, 0, 0, 0x0010
00904183                            
00904183 04                         Map_Sonic_0888:	dc.b	4
00904184 EC09 0000 F3               	SpriteMap	-13, -20, 3, 2, 0, 0, 0, 0, 0x0000
00904189 F402 0006 EB               	SpriteMap	-21, -12, 1, 3, 0, 0, 0, 0, 0x0006
0090418E FC0E 0009 F3               	SpriteMap	-13, -4, 4, 3, 0, 0, 0, 0, 0x0009
00904193 0401 0015 13               	SpriteMap	19, 4, 1, 2, 0, 0, 0, 0, 0x0015
00904198                            
00904198 03                         Map_Sonic_089E:	dc.b	3
00904199 EC04 0000 FC               	SpriteMap	-4, -20, 2, 1, 0, 0, 0, 0, 0x0000
0090419E F402 0002 EC               	SpriteMap	-20, -12, 1, 3, 0, 0, 0, 0, 0x0002
009041A3 F40F 0005 F4               	SpriteMap	-12, -12, 4, 4, 0, 0, 0, 0, 0x0005
009041A8                            
009041A8 05                         Map_Sonic_08AE:	dc.b	5
009041A9 ED08 0000 F4               	SpriteMap	-12, -19, 3, 1, 0, 0, 0, 0, 0x0000
009041AE F502 0003 EC               	SpriteMap	-20, -11, 1, 3, 0, 0, 0, 0, 0x0003
009041B3 F50E 0006 F4               	SpriteMap	-12, -11, 4, 3, 0, 0, 0, 0, 0x0006
009041B8 FD01 0012 14               	SpriteMap	20, -3, 1, 2, 0, 0, 0, 0, 0x0012
009041BD 0D08 0014 FC               	SpriteMap	-4, 13, 3, 1, 0, 0, 0, 0, 0x0014
009041C2                            
009041C2 03                         Map_Sonic_08C8:	dc.b	3
009041C3 EC04 0000 FB               	SpriteMap	-5, -20, 2, 1, 0, 0, 0, 0, 0x0000
009041C8 F402 0002 EB               	SpriteMap	-21, -12, 1, 3, 0, 0, 0, 0, 0x0002
009041CD F40F 0005 F3               	SpriteMap	-13, -12, 4, 4, 0, 0, 0, 0, 0x0005
009041D2                            	
009041D2 04                         MS_BalanceForward1:	dc.b 4
009041D3 EC08 0800 EA               	SpriteMap	-22, -20, 3, 1, 1, 0, 0, 0, 0
009041D8 F40E 0803 EA               	SpriteMap	-22, -12, 4, 3, 1, 0, 0, 0, 3
009041DD FC00 080F E2               	SpriteMap	-30, -4, 1, 1, 1, 0, 0, 0, $F
009041E2 0C0C 0810 E2               	SpriteMap	-30, 12, 4, 1, 1, 0, 0, 0, $10
009041E7 03                         MS_BalanceForward2:	dc.b 3
009041E8 EC08 0800 EA               	SpriteMap	-22, -20, 3, 1, 1, 0, 0, 0, 0
009041ED F402 0803 02               	SpriteMap	2, -12, 1, 3, 1, 0, 0, 0, 3
009041F2 F40F 0806 E2               	SpriteMap	-30, -12, 4, 4, 1, 0, 0, 0, 6
009041F7 03                         MS_BalanceForward3:	dc.b 3
009041F8 EC0E 0800 EA               	SpriteMap	-22, -20, 4, 3, 1, 0, 0, 0, 0
009041FD 040C 080C E2               	SpriteMap	-30, 4, 4, 1, 1, 0, 0, 0, $C
00904202 0C0C 0810 EA               	SpriteMap	-22, 12, 4, 1, 1, 0, 0, 0, $10	
00904207 02                         MS_BalanceForward4:	dc.b 2		
00904208 EC0E 0800 EA               	SpriteMap	-22, -20, 4, 3, 1, 0, 0, 0, 0
0090420D 040D 080C E2               	SpriteMap	-30, 4, 4, 2, 1, 0, 0, 0, $C	
00904212 03                         MS_BalanceBack1:	dc.b 3		
00904213 EC0E 0800 F0               	SpriteMap	-16, -20, 4, 3, 1, 0, 0, 0, 0
00904218 F402 080C 10               	SpriteMap	16, -12, 1, 3, 1, 0, 0, 0, $C
0090421D 0409 080F F8               	SpriteMap	-8, 4, 3, 2, 1, 0, 0, 0, $F		
00904222 04                         MS_BalanceBack2:	dc.b 4
00904223 EC0E 0800 F0               	SpriteMap	-16, -20, 4, 3, 1, 0, 0, 0, 0
00904228 FC01 080C 10               	SpriteMap	16, -4, 1, 2, 1, 0, 0, 0, $C
0090422D 0405 080E 00               	SpriteMap	0, 4, 2, 2, 1, 0, 0, 0, $E
00904232 0400 0812 F8               	SpriteMap	-8, 4, 1, 1, 1, 0, 0, 0, $12
00904237 04                         MS_BalanceBack3:	dc.b 4
00904238 EC0E 0800 F0               	SpriteMap	-16, -20, 4, 3, 1, 0, 0, 0, 0
0090423D FC01 0810 10               	SpriteMap	16, -4, 1, 2, 1, 0, 0, 0, $10
00904242 0405 080C 00               	SpriteMap	0, 4, 2, 2, 1, 0, 0, 0, $C
00904247 0400 0816 F8               	SpriteMap	-8, 4, 1, 1, 1, 0, 0, 0, $16
0090424C 04                         MS_BalanceBack4:	dc.b 4
0090424D EC0E 0800 F0               	SpriteMap	-16, -20, 4, 3, 1, 0, 0, 0, 0
00904252 F402 080C 10               	SpriteMap	16, -12, 1, 3, 1, 0, 0, 0, $C
00904257 0408 080F F0               	SpriteMap	-16, 4, 3, 1, 1, 0, 0, 0, $F
0090425C 0C04 0812 00               	SpriteMap	0, 12, 2, 1, 1, 0, 0, 0, $12
00904261                            
00904262 00                         		even
00904262                            
00904262 =00000000                  fr_Null:	equ (ptr_MS_Null-Map_Sonic)/2		; 0
00904262 =00000001                  fr_Stand:	equ (ptr_MS_Stand-Map_Sonic)/2		; 1
00904262 =00000002                  fr_Wait1:	equ (ptr_MS_Wait1-Map_Sonic)/2		; 2
00904262 =00000003                  fr_Wait2:	equ (ptr_MS_Wait2-Map_Sonic)/2		; 3
00904262 =00000004                  fr_Wait3:	equ (ptr_MS_Wait3-Map_Sonic)/2		; 4
00904262 =00000005                  fr_LookUp:	equ (ptr_MS_LookUp-Map_Sonic)/2		; 5
00904262 =00000006                  fr_Walk11:	equ (ptr_MS_Walk11-Map_Sonic)/2		; 6
00904262 =00000007                  fr_Walk12:	equ (ptr_MS_Walk12-Map_Sonic)/2		; 7
00904262 =00000008                  fr_Walk13:	equ (ptr_MS_Walk13-Map_Sonic)/2		; 8
00904262 =00000009                  fr_Walk14:	equ (ptr_MS_Walk14-Map_Sonic)/2		; 9
00904262 =0000000A                  fr_Walk15:	equ (ptr_MS_Walk15-Map_Sonic)/2		; $A
00904262 =0000000B                  fr_Walk16:	equ (ptr_MS_Walk16-Map_Sonic)/2		; $B
00904262 =0000000C                  fr_Walk21:	equ (ptr_MS_Walk21-Map_Sonic)/2		; $C
00904262 =0000000D                  fr_Walk22:	equ (ptr_MS_Walk22-Map_Sonic)/2		; $D
00904262 =0000000E                  fr_Walk23:	equ (ptr_MS_Walk23-Map_Sonic)/2		; $E
00904262 =0000000F                  fr_Walk24:	equ (ptr_MS_Walk24-Map_Sonic)/2		; $F
00904262 =00000010                  fr_Walk25:	equ (ptr_MS_Walk25-Map_Sonic)/2		; $10
00904262 =00000011                  fr_Walk26:	equ (ptr_MS_Walk26-Map_Sonic)/2		; $11
00904262 =00000012                  fr_Walk31:	equ (ptr_MS_Walk31-Map_Sonic)/2		; $12
00904262 =00000013                  fr_Walk32:	equ (ptr_MS_Walk32-Map_Sonic)/2		; $13
00904262 =00000014                  fr_Walk33:	equ (ptr_MS_Walk33-Map_Sonic)/2		; $14
00904262 =00000015                  fr_Walk34:	equ (ptr_MS_Walk34-Map_Sonic)/2		; $15
00904262 =00000016                  fr_Walk35:	equ (ptr_MS_Walk35-Map_Sonic)/2		; $16
00904262 =00000017                  fr_Walk36:	equ (ptr_MS_Walk36-Map_Sonic)/2		; $17
00904262 =00000018                  fr_Walk41:	equ (ptr_MS_Walk41-Map_Sonic)/2		; $18
00904262 =00000019                  fr_Walk42:	equ (ptr_MS_Walk42-Map_Sonic)/2		; $19
00904262 =0000001A                  fr_Walk43:	equ (ptr_MS_Walk43-Map_Sonic)/2		; $1A
00904262 =0000001B                  fr_Walk44:	equ (ptr_MS_Walk44-Map_Sonic)/2		; $1B
00904262 =0000001C                  fr_Walk45:	equ (ptr_MS_Walk45-Map_Sonic)/2		; $1C
00904262 =0000001D                  fr_Walk46:	equ (ptr_MS_Walk46-Map_Sonic)/2		; $1D
00904262 =0000001E                  fr_Run11:	equ (ptr_MS_Run11-Map_Sonic)/2		; $1E
00904262 =0000001F                  fr_Run12:	equ (ptr_MS_Run12-Map_Sonic)/2		; $1F
00904262 =00000020                  fr_Run13:	equ (ptr_MS_Run13-Map_Sonic)/2		; $20
00904262 =00000021                  fr_Run14:	equ (ptr_MS_Run14-Map_Sonic)/2		; $21
00904262 =00000022                  fr_Run21:	equ (ptr_MS_Run21-Map_Sonic)/2		; $22
00904262 =00000023                  fr_Run22:	equ (ptr_MS_Run22-Map_Sonic)/2		; $23
00904262 =00000024                  fr_Run23:	equ (ptr_MS_Run23-Map_Sonic)/2		; $24
00904262 =00000025                  fr_Run24:	equ (ptr_MS_Run24-Map_Sonic)/2		; $25
00904262 =00000026                  fr_Run31:	equ (ptr_MS_Run31-Map_Sonic)/2		; $26
00904262 =00000027                  fr_Run32:	equ (ptr_MS_Run32-Map_Sonic)/2		; $27
00904262 =00000028                  fr_Run33:	equ (ptr_MS_Run33-Map_Sonic)/2		; $28
00904262 =00000029                  fr_Run34:	equ (ptr_MS_Run34-Map_Sonic)/2		; $29
00904262 =0000002A                  fr_Run41:	equ (ptr_MS_Run41-Map_Sonic)/2		; $2A
00904262 =0000002B                  fr_Run42:	equ (ptr_MS_Run42-Map_Sonic)/2		; $2B
00904262 =0000002C                  fr_Run43:	equ (ptr_MS_Run43-Map_Sonic)/2		; $2C
00904262 =0000002D                  fr_Run44:	equ (ptr_MS_Run44-Map_Sonic)/2		; $2D
00904262 =0000002E                  fr_Roll1:	equ (ptr_MS_Roll1-Map_Sonic)/2		; $2E
00904262 =0000002F                  fr_Roll2:	equ (ptr_MS_Roll2-Map_Sonic)/2		; $2F
00904262 =00000030                  fr_Roll3:	equ (ptr_MS_Roll3-Map_Sonic)/2		; $30
00904262 =00000031                  fr_Roll4:	equ (ptr_MS_Roll4-Map_Sonic)/2		; $31
00904262 =00000032                  fr_Roll5:	equ (ptr_MS_Roll5-Map_Sonic)/2		; $32
00904262 =00000033                  fr_Warp1:	equ (ptr_MS_Warp1-Map_Sonic)/2		; $33
00904262 =00000034                  fr_Warp2:	equ (ptr_MS_Warp2-Map_Sonic)/2		; $34
00904262 =00000035                  fr_Warp3:	equ (ptr_MS_Warp3-Map_Sonic)/2		; $35
00904262 =00000036                  fr_Warp4:	equ (ptr_MS_Warp4-Map_Sonic)/2		; $36
00904262 =00000037                  fr_Stop1:	equ (ptr_MS_Stop1-Map_Sonic)/2		; $37
00904262 =00000038                  fr_Stop2:	equ (ptr_MS_Stop2-Map_Sonic)/2		; $38
00904262 =00000039                  fr_Duck:	equ (ptr_MS_Duck-Map_Sonic)/2		; $39
00904262 =0000003A                  fr_Balance1:	equ (ptr_MS_Balance1-Map_Sonic)/2	; $3A
00904262 =0000003B                  fr_Balance2:	equ (ptr_MS_Balance2-Map_Sonic)/2	; $3B
00904262 =0000003C                  fr_Float1:	equ (ptr_MS_Float1-Map_Sonic)/2		; $3C
00904262 =0000003D                  fr_Float2:	equ (ptr_MS_Float2-Map_Sonic)/2		; $3D
00904262 =0000003E                  fr_Float3:	equ (ptr_MS_Float3-Map_Sonic)/2		; $3E
00904262 =0000003F                  fr_Float4:	equ (ptr_MS_Float4-Map_Sonic)/2		; $3F
00904262 =00000040                  fr_Spring:	equ (ptr_MS_Spring-Map_Sonic)/2		; $40
00904262 =00000041                  fr_Hang1:	equ (ptr_MS_Hang1-Map_Sonic)/2		; $41
00904262 =00000042                  fr_Hang2:	equ (ptr_MS_Hang2-Map_Sonic)/2		; $42
00904262 =00000043                  fr_Leap1:	equ (ptr_MS_Leap1-Map_Sonic)/2		; $43
00904262 =00000044                  fr_Leap2:	equ (ptr_MS_Leap2-Map_Sonic)/2		; $44
00904262 =00000045                  fr_Push1:	equ (ptr_MS_Push1-Map_Sonic)/2		; $45
00904262 =00000046                  fr_Push2:	equ (ptr_MS_Push2-Map_Sonic)/2		; $46
00904262 =00000047                  fr_Push3:	equ (ptr_MS_Push3-Map_Sonic)/2		; $47
00904262 =00000048                  fr_Push4:	equ (ptr_MS_Push4-Map_Sonic)/2		; $48
00904262 =00000049                  fr_Surf:	equ (ptr_MS_Surf-Map_Sonic)/2		; $49
00904262 =0000004A                  fr_BubStand:	equ (ptr_MS_BubStand-Map_Sonic)/2	; $4A
00904262 =0000004B                  fr_Burnt:	equ (ptr_MS_Burnt-Map_Sonic)/2		; $4B
00904262 =0000004C                  fr_Drown:	equ (ptr_MS_Drown-Map_Sonic)/2		; $4C
00904262 =0000004D                  fr_Death:	equ (ptr_MS_Death-Map_Sonic)/2		; $4D
00904262 =0000004E                  fr_Shrink1:	equ (ptr_MS_Shrink1-Map_Sonic)/2	; $4E
00904262 =0000004F                  fr_Shrink2:	equ (ptr_MS_Shrink2-Map_Sonic)/2	; $4F
00904262 =00000050                  fr_Shrink3:	equ (ptr_MS_Shrink3-Map_Sonic)/2	; $50
00904262 =00000051                  fr_Shrink4:	equ (ptr_MS_Shrink4-Map_Sonic)/2	; $51
00904262 =00000052                  fr_Shrink5:	equ (ptr_MS_Shrink5-Map_Sonic)/2	; $52
00904262 =00000053                  fr_Float5:	equ (ptr_MS_Float5-Map_Sonic)/2		; $53
00904262 =00000054                  fr_Float6:	equ (ptr_MS_Float6-Map_Sonic)/2		; $54
00904262 =00000055                  fr_Injury:	equ (ptr_MS_Injury-Map_Sonic)/2		; $55
00904262 =00000056                  fr_GetAir:	equ (ptr_MS_GetAir-Map_Sonic)/2		; $56
00904262 =00000057                  fr_WaterSlide:	equ (ptr_MS_WaterSlide-Map_Sonic)/2	; $57
00904262 =00000057                  fr_WaterSlide:	equ (ptr_MS_WaterSlide-Map_Sonic)/2	; $57
00904262                            		include	"_maps\Sonic - Dynamic Gfx Script.asm"
00904262                            ; ---------------------------------------------------------------------------
00904262                            ; Uncompressed graphics	loading	array for Sonic
00904262                            ; ---------------------------------------------------------------------------
00904262 0000                       SonicDynPLC:	dc.w SonPLC_Null-SonicDynPLC
00904264 0000                       		dc.w SonPLC_Stand-SonicDynPLC
00904266 0000                       		dc.w SonPLC_Wait1-SonicDynPLC
00904268 0000                       		dc.w SonPLC_Wait2-SonicDynPLC
0090426A 0000                       		dc.w SonPLC_Wait3-SonicDynPLC
0090426C 0000                       		dc.w SonPLC_LookUp-SonicDynPLC
0090426E 0000                       		dc.w SonPLC_Walk11-SonicDynPLC
00904270 0000                       		dc.w SonPLC_Walk12-SonicDynPLC
00904272 0000                       		dc.w SonPLC_Walk13-SonicDynPLC
00904274 0000                       		dc.w SonPLC_Walk14-SonicDynPLC
00904276 0000                       		dc.w SonPLC_Walk15-SonicDynPLC
00904278 0000                       		dc.w SonPLC_Walk16-SonicDynPLC
0090427A 0000                       		dc.w SonPLC_Walk21-SonicDynPLC
0090427C 0000                       		dc.w SonPLC_Walk22-SonicDynPLC
0090427E 0000                       		dc.w SonPLC_Walk23-SonicDynPLC
00904280 0000                       		dc.w SonPLC_Walk24-SonicDynPLC
00904282 0000                       		dc.w SonPLC_Walk25-SonicDynPLC
00904284 0000                       		dc.w SonPLC_Walk26-SonicDynPLC
00904286 0000                       		dc.w SonPLC_Walk31-SonicDynPLC
00904288 0000                       		dc.w SonPLC_Walk32-SonicDynPLC
0090428A 0000                       		dc.w SonPLC_Walk33-SonicDynPLC
0090428C 0000                       		dc.w SonPLC_Walk34-SonicDynPLC
0090428E 0000                       		dc.w SonPLC_Walk35-SonicDynPLC
00904290 0000                       		dc.w SonPLC_Walk36-SonicDynPLC
00904292 0000                       		dc.w SonPLC_Walk41-SonicDynPLC
00904294 0000                       		dc.w SonPLC_Walk42-SonicDynPLC
00904296 0000                       		dc.w SonPLC_Walk43-SonicDynPLC
00904298 0000                       		dc.w SonPLC_Walk44-SonicDynPLC
0090429A 0000                       		dc.w SonPLC_Walk45-SonicDynPLC
0090429C 0000                       		dc.w SonPLC_Walk46-SonicDynPLC
0090429E 0000                       		dc.w SonPLC_Run11-SonicDynPLC
009042A0 0000                       		dc.w SonPLC_Run12-SonicDynPLC
009042A2 0000                       		dc.w SonPLC_Run13-SonicDynPLC
009042A4 0000                       		dc.w SonPLC_Run14-SonicDynPLC
009042A6 0000                       		dc.w SonPLC_Run21-SonicDynPLC
009042A8 0000                       		dc.w SonPLC_Run22-SonicDynPLC
009042AA 0000                       		dc.w SonPLC_Run23-SonicDynPLC
009042AC 0000                       		dc.w SonPLC_Run24-SonicDynPLC
009042AE 0000                       		dc.w SonPLC_Run31-SonicDynPLC
009042B0 0000                       		dc.w SonPLC_Run32-SonicDynPLC
009042B2 0000                       		dc.w SonPLC_Run33-SonicDynPLC
009042B4 0000                       		dc.w SonPLC_Run34-SonicDynPLC
009042B6 0000                       		dc.w SonPLC_Run41-SonicDynPLC
009042B8 0000                       		dc.w SonPLC_Run42-SonicDynPLC
009042BA 0000                       		dc.w SonPLC_Run43-SonicDynPLC
009042BC 0000                       		dc.w SonPLC_Run44-SonicDynPLC
009042BE 0000                       		dc.w SonPLC_Roll1-SonicDynPLC
009042C0 0000                       		dc.w SonPLC_Roll2-SonicDynPLC
009042C2 0000                       		dc.w SonPLC_Roll3-SonicDynPLC
009042C4 0000                       		dc.w SonPLC_Roll4-SonicDynPLC
009042C6 0000                       		dc.w SonPLC_Roll5-SonicDynPLC
009042C8 0000                       		dc.w SonPLC_Warp1-SonicDynPLC
009042CA 0000                       		dc.w SonPLC_Warp2-SonicDynPLC
009042CC 0000                       		dc.w SonPLC_Warp3-SonicDynPLC
009042CE 0000                       		dc.w SonPLC_Warp4-SonicDynPLC
009042D0 0000                       		dc.w SonPLC_Stop1-SonicDynPLC
009042D2 0000                       		dc.w SonPLC_Stop2-SonicDynPLC
009042D4 0000                       		dc.w SonPLC_Duck-SonicDynPLC
009042D6 0000                       		dc.w SonPLC_Balance1-SonicDynPLC
009042D8 0000                       		dc.w SonPLC_Balance2-SonicDynPLC
009042DA 0000                       		dc.w SonPLC_Float1-SonicDynPLC
009042DC 0000                       		dc.w SonPLC_Float2-SonicDynPLC
009042DE 0000                       		dc.w SonPLC_Float3-SonicDynPLC
009042E0 0000                       		dc.w SonPLC_Float4-SonicDynPLC
009042E2 0000                       		dc.w SonPLC_Spring-SonicDynPLC
009042E4 0000                       		dc.w SonPLC_Hang1-SonicDynPLC
009042E6 0000                       		dc.w SonPLC_Hang2-SonicDynPLC
009042E8 0000                       		dc.w SonPLC_Leap1-SonicDynPLC
009042EA 0000                       		dc.w SonPLC_Leap2-SonicDynPLC
009042EC 0000                       		dc.w SonPLC_Push1-SonicDynPLC
009042EE 0000                       		dc.w SonPLC_Push2-SonicDynPLC
009042F0 0000                       		dc.w SonPLC_Push3-SonicDynPLC
009042F2 0000                       		dc.w SonPLC_Push4-SonicDynPLC
009042F4 0000                       		dc.w SonPLC_Surf-SonicDynPLC
009042F6 0000                       		dc.w SonPLC_BubStand-SonicDynPLC
009042F8 0000                       		dc.w SonPLC_Death-SonicDynPLC
009042FA 0000                       		dc.w SonPLC_Drown-SonicDynPLC
009042FC 0000                       		dc.w SonPLC_Burnt-SonicDynPLC
009042FE 0000                       		dc.w SonPLC_Shrink1-SonicDynPLC
00904300 0000                       		dc.w SonPLC_Shrink2-SonicDynPLC
00904302 0000                       		dc.w SonPLC_Shrink3-SonicDynPLC
00904304 0000                       		dc.w SonPLC_Shrink4-SonicDynPLC
00904306 0000                       		dc.w SonPLC_Shrink5-SonicDynPLC
00904308 0000                       		dc.w SonPLC_Float1-SonicDynPLC
0090430A 0000                       		dc.w SonPLC_Float3-SonicDynPLC
0090430C 0000                       		dc.w SonPLC_Injury-SonicDynPLC
0090430E 0000                       		dc.w SonPLC_GetAir-SonicDynPLC
00904310 0000                       		dc.w SonPLC_WaterSlide-SonicDynPLC
00904312                            
00904312 0000                       		dc.w SonPLC_WallJump-SonicDynPLC
00904314                            	
00904314 0000                       		dc.w SonPLC_SpinDash1-SonicDynPLC
00904316 0000                       		dc.w SonPLC_SpinDash2-SonicDynPLC
00904318 0000                       		dc.w SonPLC_SpinDash3-SonicDynPLC
0090431A 0000                       		dc.w SonPLC_SpinDash4-SonicDynPLC
0090431C 0000                       		dc.w SonPLC_SpinDash5-SonicDynPLC
0090431E 0000                       		dc.w SonPLC_SpinDash6-SonicDynPLC
00904320                            	
00904320 0000                       		dc.w SonPLC_0464-SonicDynPLC
00904322 0000                       		dc.w SonPLC_046A-SonicDynPLC
00904324 0000                       		dc.w SonPLC_0470-SonicDynPLC
00904326 0000                       		dc.w SonPLC_0476-SonicDynPLC
00904328 0000                       		dc.w SonPLC_047C-SonicDynPLC
0090432A 0000                       		dc.w SonPLC_0488-SonicDynPLC
0090432C 0000                       		dc.w SonPLC_0490-SonicDynPLC
0090432E 0000                       		dc.w SonPLC_049C-SonicDynPLC
00904330 0000                       		dc.w SonPLC_04A4-SonicDynPLC
00904332 0000                       		dc.w SonPLC_04AA-SonicDynPLC
00904334 0000                       		dc.w SonPLC_04B0-SonicDynPLC
00904336 0000                       		dc.w SonPLC_04B6-SonicDynPLC
00904338 0000                       		dc.w SonPLC_04BC-SonicDynPLC
0090433A 0000                       		dc.w SonPLC_04C6-SonicDynPLC
0090433C 0000                       		dc.w SonPLC_04CE-SonicDynPLC
0090433E 0000                       		dc.w SonPLC_04DA-SonicDynPLC
00904340                            	
00904340 0000                       		dc.w SonPLC_BalanceForward1-SonicDynPLC
00904342 0000                       		dc.w SonPLC_BalanceForward2-SonicDynPLC
00904344 0000                       		dc.w SonPLC_BalanceForward3-SonicDynPLC
00904346 0000                       		dc.w SonPLC_BalanceForward4-SonicDynPLC
00904348 0000                       		dc.w SonPLC_BalanceBack1-SonicDynPLC
0090434A 0000                       		dc.w SonPLC_BalanceBack2-SonicDynPLC
0090434C 0000                       		dc.w SonPLC_BalanceBack3-SonicDynPLC
0090434E 0000                       		dc.w SonPLC_BalanceBack4-SonicDynPLC
00904350                            
00904350 00                         SonPLC_Null:	dc.b 0
00904351 0420 0070 0320 0B20 0E     SonPLC_Stand:	dc.b 4,	$20, 0,	$70, 3,	$20, $B, $20, $E
0090435A 0350 1150 1720 1D          SonPLC_Wait1:	dc.b 3,	$50, $11, $50, $17, $20, $1D
00904361 0350 2050 1720 1D          SonPLC_Wait2:	dc.b 3,	$50, $20, $50, $17, $20, $1D
00904368 0350 2050 1720 26          SonPLC_Wait3:	dc.b 3,	$50, $20, $50, $17, $20, $26
0090436F 0380 2920 0B20 0E          SonPLC_LookUp:	dc.b 3,	$80, $29, $20, $B, $20,	$E
00904376 0470 3250 3A50 4010 46     SonPLC_Walk11:	dc.b 4,	$70, $32, $50, $3A, $50, $40, $10, $46
0090437F 0270 32B0 48               SonPLC_Walk12:	dc.b 2,	$70, $32, $B0, $48
00904384 0250 5480 5A               SonPLC_Walk13:	dc.b 2,	$50, $54, $80, $5A
00904389 0450 5450 6350 6910 6F     SonPLC_Walk14:	dc.b 4,	$50, $54, $50, $63, $50, $69, $10, $6F
00904392 0250 54B0 71               SonPLC_Walk15:	dc.b 2,	$50, $54, $B0, $71
00904397 0370 3230 7D50 81          SonPLC_Walk16:	dc.b 3,	$70, $32, $30, $7D, $50, $81
0090439E 0550 8750 8D20 9350 9600+  SonPLC_Walk21:	dc.b 5,	$50, $87, $50, $8D, $20, $93, $50, $96,	0, $9C
009043A9 0650 8710 9D30 9F50 A330+  SonPLC_Walk22:	dc.b 6,	$50, $87, $10, $9D, $30, $9F, $50, $A3,	$30, $A9, 0, $AD
009043B6 0450 AE10 B470 B620 BE     SonPLC_Walk23:	dc.b 4,	$50, $AE, $10, $B4, $70, $B6, $20, $BE
009043BF 0550 C130 C770 CB20 D310+  SonPLC_Walk24:	dc.b 5,	$50, $C1, $30, $C7, $70, $CB, $20, $D3,	$10, $D6
009043CA 0450 C110 D870 DA20 E2     SonPLC_Walk25:	dc.b 4,	$50, $C1, $10, $D8, $70, $DA, $20, $E2
009043D3 0550 8710 9D00 9370 E520+  SonPLC_Walk26:	dc.b 5,	$50, $87, $10, $9D, 0, $93, $70, $E5, $20, $ED
009043DE 0470 F050 F810 FE51 00     SonPLC_Walk31:	dc.b 4,	$70, $F0, $50, $F8, $10, $FE, $51, 0
009043E7 0270 F0B1 06               SonPLC_Walk32:	dc.b 2,	$70, $F0, $B1, 6
009043EC 0251 1281 18               SonPLC_Walk33:	dc.b 2,	$51, $12, $81, $18
009043F1 0451 1251 2111 2751 29     SonPLC_Walk34:	dc.b 4,	$51, $12, $51, $21, $11, $27, $51, $29
009043FA 0251 12B1 2F               SonPLC_Walk35:	dc.b 2,	$51, $12, $B1, $2F
009043FF 0370 F001 0681 3B          SonPLC_Walk36:	dc.b 3,	$70, $F0, 1, 6,	$81, $3B
00904406 0651 4411 4A11 4C81 4E01+  SonPLC_Walk41:	dc.b 6,	$51, $44, $11, $4A, $11, $4C, $81, $4E,	1, $57,	1, $58
00904413 0651 4421 5911 5C11 5E81+  SonPLC_Walk42:	dc.b 6,	$51, $44, $21, $59, $11, $5C, $11, $5E,	$81, $60, 1, $57
00904420 0451 6911 6F81 7111 7A     SonPLC_Walk43:	dc.b 4,	$51, $69, $11, $6F, $81, $71, $11, $7A
00904429 0551 7C21 8211 8571 8721+  SonPLC_Walk44:	dc.b 5,	$51, $7C, $21, $82, $11, $85, $71, $87,	$21, $8F
00904434 0451 7C11 9281 9411 9D     SonPLC_Walk45:	dc.b 4,	$51, $7C, $11, $92, $81, $94, $11, $9D
0090443D 0551 4481 9F11 5E11 A801+  SonPLC_Walk46:	dc.b 5,	$51, $44, $81, $9F, $11, $5E, $11, $A8,	1, $57
00904448 0251 AAB1 B0               SonPLC_Run11:	dc.b 2,	$51, $AA, $B1, $B0
0090444D 0250 54B1 BC               SonPLC_Run12:	dc.b 2,	$50, $54, $B1, $BC
00904452 0251 AAB1 C8               SonPLC_Run13:	dc.b 2,	$51, $AA, $B1, $C8
00904457 0250 54B1 D4               SonPLC_Run14:	dc.b 2,	$50, $54, $B1, $D4
0090445C 0451 E011 E6B1 E801 F4     SonPLC_Run21:	dc.b 4,	$51, $E0, $11, $E6, $B1, $E8, 1, $F4
00904465 0351 F511 FBB1 FD          SonPLC_Run22:	dc.b 3,	$51, $F5, $11, $FB, $B1, $FD
0090446C 0451 E012 09B2 0B01 F4     SonPLC_Run23:	dc.b 4,	$51, $E0, $12, 9, $B2, $B, 1, $F4
00904475 0351 F511 FBB2 17          SonPLC_Run24:	dc.b 3,	$51, $F5, $11, $FB, $B2, $17
0090447C 0252 23B2 29               SonPLC_Run31:	dc.b 2,	$52, $23, $B2, $29
00904481 0251 12B2 35               SonPLC_Run32:	dc.b 2,	$51, $12, $B2, $35
00904486 0252 23B2 41               SonPLC_Run33:	dc.b 2,	$52, $23, $B2, $41
0090448B 0251 12B2 4D               SonPLC_Run34:	dc.b 2,	$51, $12, $B2, $4D
00904490 0452 5912 5FB2 6102 6D     SonPLC_Run41:	dc.b 4,	$52, $59, $12, $5F, $B2, $61, 2, $6D
00904499 0272 6EB2 76               SonPLC_Run42:	dc.b 2,	$72, $6E, $B2, $76
0090449E 0452 5912 82B2 8402 6D     SonPLC_Run43:	dc.b 4,	$52, $59, $12, $82, $B2, $84, 2, $6D
009044A7 0272 6EB2 90               SonPLC_Run44:	dc.b 2,	$72, $6E, $B2, $90
009044AC 01F2 9C                    SonPLC_Roll1:	dc.b 1,	$F2, $9C
009044AF 01F2 AC                    SonPLC_Roll2:	dc.b 1,	$F2, $AC
009044B2 01F2 BC                    SonPLC_Roll3:	dc.b 1,	$F2, $BC
009044B5 01F2 CC                    SonPLC_Roll4:	dc.b 1,	$F2, $CC
009044B8 01F2 DC                    SonPLC_Roll5:	dc.b 1,	$F2, $DC
009044BB 02B2 EC22 F8               SonPLC_Warp1:	dc.b 2,	$B2, $EC, $22, $F8
009044C0 01F2 FB                    SonPLC_Warp2:	dc.b 1,	$F2, $FB
009044C3 02B3 0B23 17               SonPLC_Warp3:	dc.b 2,	$B3, $B, $23, $17
009044C8 01F3 1A                    SonPLC_Warp4:	dc.b 1,	$F3, $1A
009044CB 0253 2AB3 30               SonPLC_Stop1:	dc.b 2,	$53, $2A, $B3, $30
009044D0 0453 3C73 4213 4A03 4C     SonPLC_Stop2:	dc.b 4,	$53, $3C, $73, $42, $13, $4A, 3, $4C
009044D9 0413 4D73 4F23 5703 5A     SonPLC_Duck:	dc.b 4,	$13, $4D, $73, $4F, $23, $57, 3, $5A
009044E2 0323 5B23 5EF3 61          SonPLC_Balance1:dc.b 3,	$23, $5B, $23, $5E, $F3, $61
009044E9 03B3 7173 7D00 71          SonPLC_Balance2:dc.b 3,	$B3, $71, $73, $7D, 0, $71
009044F0 0373 8533 8D23 91          SonPLC_Float1:	dc.b 3,	$73, $85, $33, $8D, $23, $91
009044F7 0183 94                    SonPLC_Float2:	dc.b 1,	$83, $94
009044FA 0373 9D03 A533 A6          SonPLC_Float3:	dc.b 3,	$73, $9D, 3, $A5, $33, $A6
00904501 0373 AA33 B223 B6          SonPLC_Float4:	dc.b 3,	$73, $AA, $33, $B2, $23, $B6
00904508 03B3 B913 C503 C7          SonPLC_Spring:	dc.b 3,	$B3, $B9, $13, $C5, 3, $C7
0090450F 04B3 C833 D403 D803 D9     SonPLC_Hang1:	dc.b 4,	$B3, $C8, $33, $D4, 3, $D8, 3, $D9
00904518 04B3 DA33 E603 EA03 EB     SonPLC_Hang2:	dc.b 4,	$B3, $DA, $33, $E6, 3, $EA, 3, $EB
00904521 0583 EC13 F553 F713 FD03+  SonPLC_Leap1:	dc.b 5,	$83, $EC, $13, $F5, $53, $F7, $13, $FD,	3, $FF
0090452C 0584 0014 0953 F713 FD03+  SonPLC_Leap2:	dc.b 5,	$84, 0,	$14, 9,	$53, $F7, $13, $FD, 3, $FF
00904537 0284 0B74 14               SonPLC_Push1:	dc.b 2,	$84, $B, $74, $14
0090453C 0384 1C24 2514 28          SonPLC_Push2:	dc.b 3,	$84, $1C, $24, $25, $14, $28
00904543 0284 2A74 33               SonPLC_Push3:	dc.b 2,	$84, $2A, $74, $33
00904548 0384 1C24 3B14 3E          SonPLC_Push4:	dc.b 3,	$84, $1C, $24, $3B, $14, $3E
0090454F 0254 40B4 46               SonPLC_Surf:	dc.b 2,	$54, $40, $B4, $46
00904554 0384 5234 5B04 5F          SonPLC_BubStand:dc.b 3,	$84, $52, $34, $5B, 4, $5F
0090455B 0374 6014 68B4 6A          SonPLC_Death:	dc.b 3,	$74, $60, $14, $68, $B4, $6A
00904562 0574 7614 7E54 8034 8604+  SonPLC_Drown:	dc.b 5,	$74, $76, $14, $7E, $54, $80, $34, $86,	4, $8A
0090456D 0574 8B14 7E54 9334 8604+  SonPLC_Burnt:	dc.b 5,	$74, $8B, $14, $7E, $54, $93, $34, $86,	4, $8A
00904578 0224 99F4 9C               SonPLC_Shrink1:	dc.b 2,	$24, $99, $F4, $9C
0090457D 0324 ACB4 AF24 BB          SonPLC_Shrink2:	dc.b 3,	$24, $AC, $B4, $AF, $24, $BB
00904584 01B4 BE                    SonPLC_Shrink3:	dc.b 1,	$B4, $BE
00904587 0154 CA                    SonPLC_Shrink4:	dc.b 1,	$54, $CA
0090458A 0114 D0                    SonPLC_Shrink5:	dc.b 1,	$14, $D0
0090458D 03B4 D214 DE34 E0          SonPLC_Injury:	dc.b 3,	$B4, $D2, $14, $DE, $34, $E0
00904594 0354 E4B4 EA10 6D          SonPLC_GetAir:	dc.b 3,	$54, $E4, $B4, $EA, $10, $6D
0090459B 02F4 F625 06               SonPLC_WaterSlide:dc.b 2, $F4, $F6, $25, 6
009045A0                            
009045A0 02                         SonPLC_WallJump:	dc.b 2
009045A5                            	
009045A5 01                         SonPLC_SpinDash1:	dc.b 1
009045A8 01                         SonPLC_SpinDash2:	dc.b 1
009045AB 01                         SonPLC_SpinDash3:	dc.b 1
009045AE 01                         SonPLC_SpinDash4:	dc.b 1
009045B1 01                         SonPLC_SpinDash5:	dc.b 1
009045B4 01                         SonPLC_SpinDash6:	dc.b 1
009045B7                            	
009045B7 02                         SonPLC_0464:	dc.b	2
009045BC                            
009045BC 02                         SonPLC_046A:	dc.b	2
009045C1                            
009045C1 02                         SonPLC_0470:	dc.b	2
009045C6                            
009045C6 02                         SonPLC_0476:	dc.b	2
009045CB                            
009045CB 05                         SonPLC_047C:	dc.b	5
009045D6                            
009045D6 03                         SonPLC_0488:	dc.b	3
009045DD                            
009045DD 05                         SonPLC_0490:	dc.b	5
009045E8                            
009045E8 03                         SonPLC_049C:	dc.b	3
009045EF                            
009045EF 02                         SonPLC_04A4:	dc.b	2
009045F4                            
009045F4 02                         SonPLC_04AA:	dc.b	2
009045F9                            
009045F9 02                         SonPLC_04B0:	dc.b	2
009045FE                            
009045FE 02                         SonPLC_04B6:	dc.b	2
00904603                            
00904603 04                         SonPLC_04BC:	dc.b	4
0090460C                            
0090460C 03                         SonPLC_04C6:	dc.b	3
00904613                            
00904613 05                         SonPLC_04CE:	dc.b	5
0090461E                            
0090461E 03                         SonPLC_04DA:	dc.b	3
00904625                            	
00904625 02                         SonPLC_BalanceForward1:	dc.b 2
0090462A 03                         SonPLC_BalanceForward2:	dc.b 3
00904631 02                         SonPLC_BalanceForward3:	dc.b 2
00904636 02                         SonPLC_BalanceForward4:	dc.b 2
0090463B 02                         SonPLC_BalanceBack1:	dc.b 2
00904640 02                         SonPLC_BalanceBack2:	dc.b 2
00904645 02                         SonPLC_BalanceBack3:	dc.b 2
0090464A 02                         SonPLC_BalanceBack4:	dc.b 2
0090464F                            
00904650 00                         		even
00904650                            		
00904650                            		
00904650                            
00904650                            ; ---------------------------------------------------------------------------
00904650                            ; Uncompressed graphics	- Sonic
00904650                            ; ---------------------------------------------------------------------------
00904650                            Art_Sonic:	incbin	"artunc\Sonic.bin"	; Sonic
0090E770                            		even
0090E770                            		
0090E770                            Art_SonicWallJump:	incbin	"artunc\(Mercury) Sonic WallJump.bin"
0090E9B0                            		even
0090E9B0                            	
0090E9B0                            Art_SonicSpinDash:	incbin	"artunc\(Mercury) Sonic SpinDash.bin"
0090F5B0                            		even
0090F5B0                            
0090F5B0                            Art_SonicBalanceCD:	incbin	"artunc\(Mercury) Sonic BalanceCD.bin"
009109B0                            		even
009109B0                            	
009109B0                            Art_SonicDashCD:	incbin	"artunc\(Mercury) Sonic DashCD.bin"
00913270                            		even
00913270                            	
00913270                            	
00913270                            Art_Dust:	incbin	"artunc\(Mercury) SpinDash Dust.bin"
00913BB0                            		even
00913BB0                            
00913BB0                            ; ---------------------------------------------------------------------------
00913BB0                            ; Compressed graphics - various
00913BB0                            ; ---------------------------------------------------------------------------
00913BB0                            		
00913BB0                            Nem_Shield:	incbin	"artnem\Shield.bin"
00913D46                            		even
00913D46                            		
00913D46                            Nem_Stars:	incbin	"artnem\Invincibility Stars.bin"
00913E8E                            		even
00913E8E                            
00913E8E                            		include	"_maps\SS Walls.asm"
00913E8E                            ; ---------------------------------------------------------------------------
00913E8E                            ; Sprite mappings - walls of the special stage
00913E8E                            ; ---------------------------------------------------------------------------
00913E8E 0000 0000                  Map_SSWalls:	dc.w byte_2C584-Map_SSWalls, byte_2C58A-Map_SSWalls
00913E92 0000 0000                  		dc.w byte_2C590-Map_SSWalls, byte_2C596-Map_SSWalls
00913E96 0000 0000                  		dc.w byte_2C59C-Map_SSWalls, byte_2C5A2-Map_SSWalls
00913E9A 0000 0000                  		dc.w byte_2C5A8-Map_SSWalls, byte_2C5AE-Map_SSWalls
00913E9E 0000 0000                  		dc.w byte_2C5B4-Map_SSWalls, byte_2C5BA-Map_SSWalls
00913EA2 0000 0000                  		dc.w byte_2C5C0-Map_SSWalls, byte_2C5C6-Map_SSWalls
00913EA6 0000 0000                  		dc.w byte_2C5CC-Map_SSWalls, byte_2C5D2-Map_SSWalls
00913EAA 0000 0000                  		dc.w byte_2C5D8-Map_SSWalls, byte_2C5DE-Map_SSWalls
00913EAE 01                         byte_2C584:	dc.b 1
00913EAF F40A 0000 F4               		dc.b $F4, $A, 0, 0, $F4
00913EB4 01                         byte_2C58A:	dc.b 1
00913EB5 F00F 0009 F0               		dc.b $F0, $F, 0, 9, $F0
00913EBA 01                         byte_2C590:	dc.b 1
00913EBB F00F 0019 F0               		dc.b $F0, $F, 0, $19, $F0
00913EC0 01                         byte_2C596:	dc.b 1
00913EC1 F00F 0029 F0               		dc.b $F0, $F, 0, $29, $F0
00913EC6 01                         byte_2C59C:	dc.b 1
00913EC7 F00F 0039 F0               		dc.b $F0, $F, 0, $39, $F0
00913ECC 01                         byte_2C5A2:	dc.b 1
00913ECD F00F 0049 F0               		dc.b $F0, $F, 0, $49, $F0
00913ED2 01                         byte_2C5A8:	dc.b 1
00913ED3 F00F 0059 F0               		dc.b $F0, $F, 0, $59, $F0
00913ED8 01                         byte_2C5AE:	dc.b 1
00913ED9 F00F 0069 F0               		dc.b $F0, $F, 0, $69, $F0
00913EDE 01                         byte_2C5B4:	dc.b 1
00913EDF F00F 0079 F0               		dc.b $F0, $F, 0, $79, $F0
00913EE4 01                         byte_2C5BA:	dc.b 1
00913EE5 F00F 0089 F0               		dc.b $F0, $F, 0, $89, $F0
00913EEA 01                         byte_2C5C0:	dc.b 1
00913EEB F00F 0099 F0               		dc.b $F0, $F, 0, $99, $F0
00913EF0 01                         byte_2C5C6:	dc.b 1
00913EF1 F00F 00A9 F0               		dc.b $F0, $F, 0, $A9, $F0
00913EF6 01                         byte_2C5CC:	dc.b 1
00913EF7 F00F 00B9 F0               		dc.b $F0, $F, 0, $B9, $F0
00913EFC 01                         byte_2C5D2:	dc.b 1
00913EFD F00F 00C9 F0               		dc.b $F0, $F, 0, $C9, $F0
00913F02 01                         byte_2C5D8:	dc.b 1
00913F03 F00F 00D9 F0               		dc.b $F0, $F, 0, $D9, $F0
00913F08 01                         byte_2C5DE:	dc.b 1
00913F09 F00F 00E9 F0               		dc.b $F0, $F, 0, $E9, $F0
00913F0E                            		even
00913F0E                            		even
00913F0E                            
00913F0E                            ; ---------------------------------------------------------------------------
00913F0E                            ; Compressed graphics - special stage
00913F0E                            ; ---------------------------------------------------------------------------
00913F0E                            
00913F0E                            Nem_SSWalls:	incbin	"artnem\Special Walls.bin" ; special stage walls
00914846                            		even
00914846                            
00914846                            Eni_SSBg1:	incbin	"tilemaps\SS Background 1.bin" ; special stage background (mappings)
0091497A                            		even
0091497A                            Nem_SSBgFish:	incbin	"artnem\Special Birds & Fish.bin" ; special stage birds and fish background
0091560A                            		even
0091560A                            Eni_SSBg2:	incbin	"tilemaps\SS Background 2.bin" ; special stage background (mappings)
0091590A                            		even
0091590A                            Nem_SSBgCloud:	incbin	"artnem\Special Clouds.bin" ; special stage clouds background
00915DFE                            		even
00915DFE                            Nem_SSGOAL:	incbin	"artnem\Special GOAL.bin" ; special stage GOAL block
00915EEC                            		even
00915EEC                            Nem_SSRBlock:	incbin	"artnem\Special R.bin"	; special stage R block
00915FBC                            		even
00915FBC                            Nem_SS1UpBlock:	incbin	"artnem\Special 1UP.bin" ; special stage 1UP block
009160B2                            		even
009160B2                            Nem_SSEmStars:	incbin	"artnem\Special Emerald Twinkle.bin" ; special stage stars from a collected emerald
00916110                            		even
00916110                            Nem_SSRedWhite:	incbin	"artnem\Special Red-White.bin" ; special stage red/white block
009161A2                            		even
009161A2                            Nem_SSZone1:	incbin	"artnem\Special ZONE1.bin" ; special stage ZONE1 block
00916264                            		even
00916264                            Nem_SSZone2:	incbin	"artnem\Special ZONE2.bin" ; ZONE2 block
00916332                            		even
00916332                            Nem_SSZone3:	incbin	"artnem\Special ZONE3.bin" ; ZONE3 block
009163FE                            		even
009163FE                            Nem_SSZone4:	incbin	"artnem\Special ZONE4.bin" ; ZONE4 block
009164C6                            		even
009164C6                            Nem_SSZone5:	incbin	"artnem\Special ZONE5.bin" ; ZONE5 block
00916590                            		even
00916590                            Nem_SSZone6:	incbin	"artnem\Special ZONE6.bin" ; ZONE6 block
00916660                            		even
00916660                            Nem_SSUpDown:	incbin	"artnem\Special UP-DOWN.bin" ; special stage UP/DOWN block
00916854                            		even
00916854                            Nem_SSEmerald:	incbin	"artnem\Special Emeralds.bin" ; special stage chaos emeralds
009169BC                            		even
009169BC                            Nem_SSGhost:	incbin	"artnem\Special Ghost.bin" ; special stage ghost block
00916A6C                            		even
00916A6C                            Nem_SSWBlock:	incbin	"artnem\Special W.bin"	; special stage W block
00916B46                            		even
00916B46                            Nem_SSGlass:	incbin	"artnem\Special Glass.bin" ; special stage destroyable glass block
00916BCA                            		even
00916BCA                            Nem_ResultEm:	incbin	"artnem\Special Result Emeralds.bin" ; chaos emeralds on special stage results screen
00916D48                            		even
00916D48                            ; ---------------------------------------------------------------------------
00916D48                            ; Compressed graphics - GHZ stuff
00916D48                            ; ---------------------------------------------------------------------------
00916D48                            Nem_Stalk:	incbin	"artnem\GHZ Flower Stalk.bin"
00916D92                            		even
00916D92                            Nem_Swing:	incbin	"artnem\GHZ Swinging Platform.bin"
00916EAC                            		even
00916EAC                            Nem_Bridge:	incbin	"artnem\GHZ Bridge.bin"
00916F98                            		even
00916F98                            Nem_GhzUnkBlock:incbin	"artnem\Unused - GHZ Block.bin"
00916FE0                            		even
00916FE0                            Nem_Ball:	incbin	"artnem\GHZ Giant Ball.bin"
0091717E                            		even
0091717E                            Nem_Spikes:	incbin	"artnem\Spikes.bin"
009171FA                            		even
009171FA                            Nem_GhzLog:	incbin	"artnem\Unused - GHZ Log.bin"
0091740E                            		even
0091740E                            Nem_SpikePole:	incbin	"artnem\GHZ Spiked Log.bin"
0091753A                            		even
0091753A                            Nem_PplRock:	incbin	"artnem\GHZ Purple Rock.bin"
00917668                            		even
00917668                            Nem_GhzWall1:	incbin	"artnem\GHZ Breakable Wall.bin"
00917706                            		even
00917706                            Nem_GhzWall2:	incbin	"artnem\GHZ Edge Wall.bin"
00917766                            		even
00917766                            ; ---------------------------------------------------------------------------
00917766                            ; Compressed graphics - LZ stuff
00917766                            ; ---------------------------------------------------------------------------
00917766                            Nem_Water:	incbin	"artnem\LZ Water Surface.bin"
0091788A                            		even
0091788A                            Nem_Splash:	incbin	"artnem\LZ Water & Splashes.bin"
0091807E                            		even
0091807E                            Nem_LzSpikeBall:incbin	"artnem\LZ Spiked Ball & Chain.bin"
009181FE                            		even
009181FE                            Nem_FlapDoor:	incbin	"artnem\LZ Flapping Door.bin"
00918368                            		even
00918368                            Nem_Bubbles:	incbin	"artnem\LZ Bubbles & Countdown.bin"
009189BE                            		even
009189BE                            Nem_LzBlock3:	incbin	"artnem\LZ 32x16 Block.bin"
00918A74                            		even
00918A74                            Nem_LzDoor1:	incbin	"artnem\LZ Vertical Door.bin"
00918B16                            		even
00918B16                            Nem_Harpoon:	incbin	"artnem\LZ Harpoon.bin"
00918C72                            		even
00918C72                            Nem_LzPole:	incbin	"artnem\LZ Breakable Pole.bin"
00918CD6                            		even
00918CD6                            Nem_LzDoor2:	incbin	"artnem\LZ Horizontal Door.bin"
00918E28                            		even
00918E28                            Nem_LzWheel:	incbin	"artnem\LZ Wheel.bin"
0091930A                            		even
0091930A                            Nem_Gargoyle:	incbin	"artnem\LZ Gargoyle & Fireball.bin"
0091947A                            		even
0091947A                            Nem_LzBlock2:	incbin	"artnem\LZ Blocks.bin"
00919732                            		even
00919732                            Nem_LzPlatfm:	incbin	"artnem\LZ Rising Platform.bin"
0091986A                            		even
0091986A                            Nem_Cork:	incbin	"artnem\LZ Cork.bin"
00919994                            		even
00919994                            Nem_LzBlock1:	incbin	"artnem\LZ 32x32 Block.bin"
00919AA4                            		even
00919AA4                            ; ---------------------------------------------------------------------------
00919AA4                            ; Compressed graphics - MZ stuff
00919AA4                            ; ---------------------------------------------------------------------------
00919AA4                            Nem_MzMetal:	incbin	"artnem\MZ Metal Blocks.bin"
00919D32                            		even
00919D32                            Nem_MzSwitch:	incbin	"artnem\MZ Switch.bin"
00919DF0                            		even
00919DF0                            Nem_MzGlass:	incbin	"artnem\MZ Green Glass Block.bin"
00919EA8                            		even
00919EA8                            Nem_UnkGrass:	incbin	"artnem\Unused - Grass.bin"
00919EFC                            		even
00919EFC                            Nem_MzFire:	incbin	"artnem\Fireballs.bin"
0091A1DA                            		even
0091A1DA                            Nem_Lava:	incbin	"artnem\MZ Lava.bin"
0091AAF0                            		even
0091AAF0                            Nem_MzBlock:	incbin	"artnem\MZ Green Pushable Block.bin"
0091AC54                            		even
0091AC54                            Nem_MzUnkBlock:	incbin	"artnem\Unused - MZ Background.bin"
0091ACDC                            		even
0091ACDC                            ; ---------------------------------------------------------------------------
0091ACDC                            ; Compressed graphics - SLZ stuff
0091ACDC                            ; ---------------------------------------------------------------------------
0091ACDC                            Nem_Seesaw:	incbin	"artnem\SLZ Seesaw.bin"
0091AF18                            		even
0091AF18                            Nem_SlzSpike:	incbin	"artnem\SLZ Little Spikeball.bin"
0091B05E                            		even
0091B05E                            Nem_Fan:	incbin	"artnem\SLZ Fan.bin"
0091B2A2                            		even
0091B2A2                            Nem_SlzWall:	incbin	"artnem\SLZ Breakable Wall.bin"
0091B304                            		even
0091B304                            Nem_Pylon:	incbin	"artnem\SLZ Pylon.bin"
0091B3E6                            		even
0091B3E6                            Nem_SlzSwing:	incbin	"artnem\SLZ Swinging Platform.bin"
0091B5C8                            		even
0091B5C8                            Nem_SlzBlock:	incbin	"artnem\SLZ 32x32 Block.bin"
0091B6D4                            		even
0091B6D4                            Nem_SlzCannon:	incbin	"artnem\SLZ Cannon.bin"
0091B778                            		even
0091B778                            ; ---------------------------------------------------------------------------
0091B778                            ; Compressed graphics - SYZ stuff
0091B778                            ; ---------------------------------------------------------------------------
0091B778                            Nem_Bumper:	incbin	"artnem\SYZ Bumper.bin"
0091B8E2                            		even
0091B8E2                            Nem_SyzSpike2:	incbin	"artnem\SYZ Small Spikeball.bin"
0091B944                            		even
0091B944                            Nem_LzSwitch:	incbin	"artnem\Switch.bin"
0091BA26                            		even
0091BA26                            Nem_SyzSpike1:	incbin	"artnem\SYZ Large Spikeball.bin"
0091BCB4                            		even
0091BCB4                            ; ---------------------------------------------------------------------------
0091BCB4                            ; Compressed graphics - SBZ stuff
0091BCB4                            ; ---------------------------------------------------------------------------
0091BCB4                            Nem_SbzWheel1:	incbin	"artnem\SBZ Running Disc.bin"
0091BD08                            		even
0091BD08                            Nem_SbzWheel2:	incbin	"artnem\SBZ Junction Wheel.bin"
0091BFA4                            		even
0091BFA4                            Nem_Cutter:	incbin	"artnem\SBZ Pizza Cutter.bin"
0091C1A8                            		even
0091C1A8                            Nem_Stomper:	incbin	"artnem\SBZ Stomper.bin"
0091C346                            		even
0091C346                            Nem_SpinPform:	incbin	"artnem\SBZ Spinning Platform.bin"
0091C676                            		even
0091C676                            Nem_TrapDoor:	incbin	"artnem\SBZ Trapdoor.bin"
0091C854                            		even
0091C854                            Nem_SbzFloor:	incbin	"artnem\SBZ Collapsing Floor.bin"
0091C8AC                            		even
0091C8AC                            Nem_Electric:	incbin	"artnem\SBZ Electrocuter.bin"
0091CA2C                            		even
0091CA2C                            Nem_SbzBlock:	incbin	"artnem\SBZ Vanishing Block.bin"
0091CB2A                            		even
0091CB2A                            Nem_FlamePipe:	incbin	"artnem\SBZ Flaming Pipe.bin"
0091CCB6                            		even
0091CCB6                            Nem_SbzDoor1:	incbin	"artnem\SBZ Small Vertical Door.bin"
0091CD06                            		even
0091CD06                            Nem_SlideFloor:	incbin	"artnem\SBZ Sliding Floor Trap.bin"
0091CD5E                            		even
0091CD5E                            Nem_SbzDoor2:	incbin	"artnem\SBZ Large Horizontal Door.bin"
0091CE5A                            		even
0091CE5A                            Nem_Girder:	incbin	"artnem\SBZ Crushing Girder.bin"
0091CF70                            		even
0091CF70                            ; ---------------------------------------------------------------------------
0091CF70                            ; Compressed graphics - enemies
0091CF70                            ; ---------------------------------------------------------------------------
0091CF70                            Nem_BallHog:	incbin	"artnem\Enemy Ball Hog.bin"
0091D330                            		even
0091D330                            Nem_Crabmeat:	incbin	"artnem\Enemy Crabmeat.bin"
0091D81E                            		even
0091D81E                            Nem_Buzz:	incbin	"artnem\Enemy Buzz Bomber.bin"
0091DBC4                            		even
0091DBC4                            Nem_UnkExplode:	incbin	"artnem\Unused - Explosion.bin"
0091DDAC                            		even
0091DDAC                            Nem_Burrobot:	incbin	"artnem\Enemy Burrobot.bin"
0091E496                            		even
0091E496                            Nem_Chopper:	incbin	"artnem\Enemy Chopper.bin"
0091E6FE                            		even
0091E6FE                            Nem_Jaws:	incbin	"artnem\Enemy Jaws.bin"
0091E988                            		even
0091E988                            Nem_Roller:	incbin	"artnem\Enemy Roller.bin"
0091EEAC                            		even
0091EEAC                            Nem_Motobug:	incbin	"artnem\Enemy Motobug.bin"
0091F136                            		even
0091F136                            Nem_Newtron:	incbin	"artnem\Enemy Newtron.bin"
0091F754                            		even
0091F754                            Nem_Yadrin:	incbin	"artnem\Enemy Yadrin.bin"
0091FB3C                            		even
0091FB3C                            Nem_Basaran:	incbin	"artnem\Enemy Basaran.bin"
0091FE38                            		even
0091FE38                            Nem_Splats:	incbin	"artnem\Enemy Splats.bin"
00920080                            		even
00920080                            Nem_Bomb:	incbin	"artnem\Enemy Bomb.bin"
00920318                            		even
00920318                            		
00920318                            Nem_Orbinaut:	incbin	"artnem\(Mercury) Enemy Orbinaut (SLZ).bin"
009204EE                            		
009204EE                            		even
009204EE                            Nem_Cater:	incbin	"artnem\Enemy Caterkiller.bin"
0092067C                            		even
0092067C                            ; ---------------------------------------------------------------------------
0092067C                            ; Compressed graphics - various
0092067C                            ; ---------------------------------------------------------------------------
0092067C                            Nem_TitleCard:	incbin	"artnem\Title Cards.bin"
00920C8A                            		even
00920C8A                            Nem_Hud:	incbin	"artnem\HUD.bin"	; HUD (rings, time, score)
00920D80                            		even
00920D80                            Nem_Lives:	incbin	"artnem\HUD - Life Counter Icon.bin"
00920E86                            		even
00920E86                            Nem_Ring:	incbin	"artnem\Rings.bin"
00920F7A                            		even
00920F7A                            		
00920F7A                            Nem_Monitors:	incbin	"artnem\(Mercury) Monitors (optimised).bin"
009213EC 00                         		even
009213EC                            		
009213EC                            Nem_Explode:	incbin	"artnem\Explosion.bin"
00921A52                            		even
00921A52                            Nem_Points:	incbin	"artnem\Points.bin"	; points from destroyed enemy or object
00921B02                            		even
00921B02                            Nem_GameOver:	incbin	"artnem\Game Over.bin"	; game over / time over
00921C94                            		even
00921C94                            Nem_HSpring:	incbin	"artnem\Spring Horizontal.bin"
00921D96                            		even
00921D96                            Nem_VSpring:	incbin	"artnem\Spring Vertical.bin"
00921E72                            		even
00921E72                            Nem_SignPost:	incbin	"artnem\Signpost.bin"	; end of level signpost
009222EE                            		even
009222EE                            Nem_Lamp:	incbin	"artnem\Lamppost.bin"
009223AE                            		even
009223AE                            Nem_BigFlash:	incbin	"artnem\Giant Ring Flash.bin"
00922522                            		even
00922522                            Nem_Bonus:	incbin	"artnem\Hidden Bonuses.bin" ; hidden bonuses at end of a level
00922824                            		even
00922824                            ; ---------------------------------------------------------------------------
00922824                            ; Compressed graphics - continue screen
00922824                            ; ---------------------------------------------------------------------------
00922824                            Nem_ContSonic:	incbin	"artnem\Continue Screen Sonic.bin"
00922AD4 00                         		even
00922AD4                            Nem_MiniSonic:	incbin	"artnem\Continue Screen Stuff.bin"
00922D0E                            		even
00922D0E                            ; ---------------------------------------------------------------------------
00922D0E                            ; Compressed graphics - animals
00922D0E                            ; ---------------------------------------------------------------------------
00922D0E                            Nem_Rabbit:	incbin	"artnem\Animal Rabbit.bin"
00922E66                            		even
00922E66                            Nem_Chicken:	incbin	"artnem\Animal Chicken.bin"
00922FC2                            		even
00922FC2                            Nem_BlackBird:	incbin	"artnem\Animal Blackbird.bin"
0092313E                            		even
0092313E                            Nem_Seal:	incbin	"artnem\Animal Seal.bin"
0092325A                            		even
0092325A                            Nem_Pig:	incbin	"artnem\Animal Pig.bin"
00923390                            		even
00923390                            Nem_Flicky:	incbin	"artnem\Animal Flicky.bin"
009234CA                            		even
009234CA                            Nem_Squirrel:	incbin	"artnem\Animal Squirrel.bin"
00923626                            		even
00923626                            ; ---------------------------------------------------------------------------
00923626                            ; Compressed graphics - primary patterns and block mappings
00923626                            ; ---------------------------------------------------------------------------
00923626                            
00923626                            Blk16_GHZ:	incbin	"map16\GHZ.bin"
009243DE                            		even
009243DE                            Nem_GHZ_1st:	incbin	"artnem\8x8 - GHZ1.bin"	; GHZ primary patterns
009259D2                            		even
009259D2                            Nem_GHZ_2nd:	incbin	"artnem\8x8 - GHZ2.bin"	; GHZ secondary patterns
00926D7A                            		even
00926D7A                            		
00926D7A                            Blk256_GHZ:	incbin	"map256\GHZ.bin"
0093117A                            		even
0093117A                            Blk16_LZ:	incbin	"map16\LZ.bin"
0093179A                            		even
0093179A                            Nem_LZ:		incbin	"artnem\8x8 - LZ.bin"	; LZ primary patterns
00933220                            		even
00933220                            Blk256_LZ:	incbin	"map256\LZ.bin"
0093D620                            		even
0093D620                            Blk16_MZ:	incbin	"map16\MZ.bin"
0093E1D0                            		even
0093E1D0                            Nem_MZ:		incbin	"artnem\8x8 - MZ.bin"	; MZ primary patterns
00940A14                            		even
00940A14                            		
00940A14                            Blk256_MZ:
00940A14                            		incbin	"map256\MZ (JP1).bin"
0094AE14                            		even
0094AE14                            
0094AE14                            Blk16_SLZ:	incbin	"map16\SLZ.bin"
0094BB04                            		even
0094BB04                            Nem_SLZ:	incbin	"artnem\8x8 - SLZ.bin"	; SLZ primary patterns
0094F658                            		even
0094F658                            		
0094F658                            Blk256_SLZ:	incbin	"map256\SLZ.bin"
00959A58                            		even
00959A58                            		
00959A58                            Blk16_SYZ:	incbin	"map16\SYZ.bin"
0095A7D0                            
0095A7D0                            		even
0095A7D0                            Nem_SYZ:	incbin	"artnem\8x8 - SYZ.bin"	; SYZ primary patterns
0095DDB6                            		even
0095DDB6                            		
0095DDB6                            
0095DDB6                            Blk256_SYZ:	incbin	"map256\SYZ.bin"
009681B6                            
009681B6                            		even
009681B6                            Blk16_SBZ:	incbin	"map16\SBZ.bin"
0096948E                            		even
0096948E                            Nem_SBZ:	incbin	"artnem\8x8 - SBZ.bin"	; SBZ primary patterns
0096BB5C                            		even
0096BB5C                            		
0096BB5C                            Blk256_SBZ:
0096BB5C                            		incbin	"map256\SBZ (JP1).bin"
00975F5C                            
00975F5C                            		even
00975F5C                            ; ---------------------------------------------------------------------------
00975F5C                            ; Compressed graphics - bosses and ending sequence
00975F5C                            ; ---------------------------------------------------------------------------
00975F5C                            Nem_Eggman:	incbin	"artnem\Boss - Main.bin"
009767C0                            		even
009767C0                            Nem_Weapons:	incbin	"artnem\Boss - Weapons.bin"
00976AAA                            		even
00976AAA                            Nem_Prison:	incbin	"artnem\Prison Capsule.bin"
0097732E                            		even
0097732E                            Nem_Sbz2Eggman:	incbin	"artnem\Boss - Eggman in SBZ2 & FZ.bin"
00977B5A                            		even
00977B5A                            Nem_FzBoss:	incbin	"artnem\Boss - Final Zone.bin"
009782C2                            		even
009782C2                            Nem_FzEggman:	incbin	"artnem\Boss - Eggman after FZ Fight.bin"
00978842                            		even
00978842                            Nem_Exhaust:	incbin	"artnem\Boss - Exhaust Flame.bin"
00978962                            		even
00978962                            Nem_EndEm:	incbin	"artnem\Ending - Emeralds.bin"
00978B60                            		even
00978B60                            Nem_EndSonic:	incbin	"artnem\Ending - Sonic.bin"
00979D3E                            		even
00979D3E                            Nem_TryAgain:	incbin	"artnem\Ending - Try Again.bin"
0097A682                            		even
0097A682                            Kos_EndFlowers:	incbin	"artkos\Flowers at Ending.bin" ; ending sequence animated flowers
0097AC12                            		even
0097AC12                            Nem_EndFlower:	incbin	"artnem\Ending - Flowers.bin"
0097AE9A                            		even
0097AE9A                            Nem_CreditText:	incbin	"artnem\Ending - Credits.bin"
0097B498                            		even
0097B498                            Nem_EndStH:	incbin	"artnem\Ending - StH Logo.bin"
0097B720                            		even
0097B720                            
0097B720                            ; ---------------------------------------------------------------------------
0097B720                            ; Collision data
0097B720                            ; ---------------------------------------------------------------------------
0097B720                            AngleMap:	incbin	"collide\Angle Map.bin"
0097B820                            		even
0097B820                            CollArray1:	incbin	"collide\Collision Array (Normal).bin"
0097C820                            		even
0097C820                            CollArray2:	incbin	"collide\Collision Array (Rotated).bin"
0097D820                            		even
0097D820                            Col_GHZ:	incbin	"collide\GHZ.bin"	; GHZ index
0097D9D8                            		even
0097D9D8                            Col_LZ:		incbin	"collide\LZ.bin"	; LZ index
0097DA9C                            		even
0097DA9C                            Col_MZ:		incbin	"collide\MZ.bin"	; MZ index
0097DC2C                            		even
0097DC2C                            Col_SLZ:	incbin	"collide\SLZ.bin"	; SLZ index
0097DE20                            		even
0097DE20                            Col_SYZ:	incbin	"collide\SYZ.bin"	; SYZ index
0097DFD0                            		even
0097DFD0                            Col_SBZ:	incbin	"collide\SBZ.bin"	; SBZ index
0097E22C                            		even
0097E22C                            ; ---------------------------------------------------------------------------
0097E22C                            ; Special Stage layouts
0097E22C                            ; ---------------------------------------------------------------------------
0097E22C                            SS_1:		incbin	"sslayout\1.bin"
0097E4A6                            		even
0097E4A6                            SS_2:		incbin	"sslayout\2.bin"
0097E8B8                            		even
0097E8B8                            SS_3:		incbin	"sslayout\3.bin"
0097EC14                            		even
0097EC14                            SS_4:		incbin	"sslayout\4.bin"
0097F0EE                            		even
0097F0EE                            
0097F0EE                            SS_5:		incbin	"sslayout\5 (JP1).bin"
0097F59E                            		even
0097F59E                            SS_6:		incbin	"sslayout\6 (JP1).bin"
0097F890                            		even
0097F890                            ; ---------------------------------------------------------------------------
0097F890                            ; Animated uncompressed graphics
0097F890                            ; ---------------------------------------------------------------------------
0097F890                            Art_GhzWater:	incbin	"artunc\GHZ Waterfall.bin"
0097FA90                            		even
0097FA90                            Art_GhzFlower1:	incbin	"artunc\GHZ Flower Large.bin"
0097FE90                            		even
0097FE90                            Art_GhzFlower2:	incbin	"artunc\GHZ Flower Small.bin"
00980310                            		even
00980310                            Art_MzLava1:	incbin	"artunc\MZ Lava Surface.bin"
00980610                            		even
00980610                            Art_MzLava2:	incbin	"artunc\MZ Lava.bin"
00980C10                            		even
00980C10                            Art_MzTorch:	incbin	"artunc\MZ Background Torch.bin"
00980F10                            		even
00980F10                            Art_SbzSmoke:	incbin	"artunc\SBZ Background Smoke.bin"
00981990                            		even
00981990                            
00981990                            ; ---------------------------------------------------------------------------
00981990                            ; Level	layout index
00981990                            ; ---------------------------------------------------------------------------
00981990 0000 0000 0000             Level_Index:	dc.w Level_GHZ1-Level_Index, Level_GHZbg-Level_Index, byte_68D70-Level_Index
00981996 0000 0000 0000             		dc.w Level_GHZ2-Level_Index, Level_GHZbg-Level_Index, byte_68E3C-Level_Index
0098199C 0000 0000 0000             		dc.w Level_GHZ3-Level_Index, Level_GHZbg-Level_Index, byte_68F84-Level_Index
009819A2 0000 0000 0000             		dc.w byte_68F88-Level_Index, byte_68F88-Level_Index, byte_68F88-Level_Index
009819A8 0000 0000 0000             		dc.w Level_LZ1-Level_Index, Level_LZbg-Level_Index, byte_69190-Level_Index
009819AE 0000 0000 0000             		dc.w Level_LZ2-Level_Index, Level_LZbg-Level_Index, byte_6922E-Level_Index
009819B4 0000 0000 0000             		dc.w Level_LZ3-Level_Index, Level_LZbg-Level_Index, byte_6934C-Level_Index
009819BA 0000 0000 0000             		dc.w Level_SBZ3-Level_Index, Level_LZbg-Level_Index, byte_6940A-Level_Index
009819C0 0000 0000 0000             		dc.w Level_MZ1-Level_Index, Level_MZ1bg-Level_Index, Level_MZ1-Level_Index
009819C6 0000 0000 0000             		dc.w Level_MZ2-Level_Index, Level_MZ2bg-Level_Index, byte_6965C-Level_Index
009819CC 0000 0000 0000             		dc.w Level_MZ3-Level_Index, Level_MZ3bg-Level_Index, byte_697E6-Level_Index
009819D2 0000 0000 0000             		dc.w byte_697EA-Level_Index, byte_697EA-Level_Index, byte_697EA-Level_Index
009819D8 0000 0000 0000             		dc.w Level_SLZ1-Level_Index, Level_SLZbg-Level_Index, byte_69B84-Level_Index
009819DE 0000 0000 0000             		dc.w Level_SLZ2-Level_Index, Level_SLZbg-Level_Index, byte_69B84-Level_Index
009819E4 0000 0000 0000             		dc.w Level_SLZ3-Level_Index, Level_SLZbg-Level_Index, byte_69B84-Level_Index
009819EA 0000 0000 0000             		dc.w byte_69B84-Level_Index, byte_69B84-Level_Index, byte_69B84-Level_Index
009819F0 0000 0000 0000             		dc.w Level_SYZ1-Level_Index, Level_SYZbg-Level_Index, byte_69C7E-Level_Index
009819F6 0000 0000 0000             		dc.w Level_SYZ2-Level_Index, Level_SYZbg-Level_Index, byte_69D86-Level_Index
009819FC 0000 0000 0000             		dc.w Level_SYZ3-Level_Index, Level_SYZbg-Level_Index, byte_69EE4-Level_Index
00981A02 0000 0000 0000             		dc.w byte_69EE8-Level_Index, byte_69EE8-Level_Index, byte_69EE8-Level_Index
00981A08 0000 0000 0000             		dc.w Level_SBZ1-Level_Index, Level_SBZ1bg-Level_Index, Level_SBZ1bg-Level_Index
00981A0E 0000 0000 0000             		dc.w Level_SBZ2-Level_Index, Level_SBZ2bg-Level_Index, Level_SBZ2bg-Level_Index
00981A14 0000 0000 0000             		dc.w Level_SBZ2-Level_Index, Level_SBZ2bg-Level_Index, byte_6A2F8-Level_Index
00981A1A 0000 0000 0000             		dc.w byte_6A2FC-Level_Index, byte_6A2FC-Level_Index, byte_6A2FC-Level_Index
00981A20 0000 0000 0000             		dc.w Level_End-Level_Index, Level_GHZbg-Level_Index, byte_6A320-Level_Index
00981A26 0000 0000 0000             		dc.w Level_End-Level_Index, Level_GHZbg-Level_Index, byte_6A320-Level_Index
00981A2C 0000 0000 0000             		dc.w byte_6A320-Level_Index, byte_6A320-Level_Index, byte_6A320-Level_Index
00981A32 0000 0000 0000             		dc.w byte_6A320-Level_Index, byte_6A320-Level_Index, byte_6A320-Level_Index
00981A38                            
00981A38                            Level_GHZ1:	incbin	levels\ghz1.bin
00981B2A                            		even
00981B2A 0000 0000                  byte_68D70:	dc.b 0,	0, 0, 0
00981B2E                            Level_GHZ2:	incbin	levels\ghz2.bin
00981BF6                            		even
00981BF6 0000 0000                  byte_68E3C:	dc.b 0,	0, 0, 0
00981BFA                            Level_GHZ3:	incbin	levels\ghz3.bin
00981D1C                            		even
00981D1C                            Level_GHZbg:	incbin	levels\ghzbg.bin
00981D3E                            		even
00981D3E 0000 0000                  byte_68F84:	dc.b 0,	0, 0, 0
00981D42 0000 0000                  byte_68F88:	dc.b 0,	0, 0, 0
00981D46                            
00981D46                            Level_LZ1:	incbin	levels\lz1.bin
00981E48                            		even
00981E48                            Level_LZbg:	incbin	levels\lzbg.bin
00981F4A                            		even
00981F4A 0000 0000                  byte_69190:	dc.b 0,	0, 0, 0
00981F4E                            Level_LZ2:	incbin	levels\lz2.bin
00981FE8                            		even
00981FE8 0000 0000                  byte_6922E:	dc.b 0,	0, 0, 0
00981FEC                            Level_LZ3:	incbin	levels\lz3.bin
00982106                            		even
00982106 0000 0000                  byte_6934C:	dc.b 0,	0, 0, 0
0098210A                            Level_SBZ3:	incbin	levels\sbz3.bin
009821C4                            		even
009821C4 0000 0000                  byte_6940A:	dc.b 0,	0, 0, 0
009821C8                            
009821C8                            Level_MZ1:	incbin	levels\mz1.bin
00982266                            		even
00982266                            Level_MZ1bg:	incbin	levels\mz1bg.bin
009822E0                            		even
009822E0                            Level_MZ2:	incbin	levels\mz2.bin
00982384                            		even
00982384                            Level_MZ2bg:	incbin	levels\mz2bg.bin
00982416                            		even
00982416 0000 0000                  byte_6965C:	dc.b 0,	0, 0, 0
0098241A                            Level_MZ3:	incbin	levels\mz3.bin
009824FC                            		even
009824FC                            Level_MZ3bg:	incbin	levels\mz3bg.bin
009825A0                            		even
009825A0 0000 0000                  byte_697E6:	dc.b 0,	0, 0, 0
009825A4 0000 0000                  byte_697EA:	dc.b 0,	0, 0, 0
009825A8                            
009825A8                            Level_SLZ1:	incbin	levels\slz1.bin
009826BA                            		even
009826BA                            Level_SLZbg:	incbin	levels\slzbg.bin
00982734                            		even
00982734                            Level_SLZ2:	incbin	levels\slz2.bin
00982824                            		even
00982824                            Level_SLZ3:	incbin	levels\slz3.bin
0098293E                            		even
0098293E 0000 0000                  byte_69B84:	dc.b 0,	0, 0, 0
00982942                            
00982942                            Level_SYZ1:	incbin	levels\syz1.bin
009829FE                            		even
009829FE                            Level_SYZbg:	incbin	"levels\syzbg (JP1).bin"
00982A38                            		even
00982A38 0000 0000                  byte_69C7E:	dc.b 0,	0, 0, 0
00982A3C                            Level_SYZ2:	incbin	levels\syz2.bin
00982B40                            		even
00982B40 0000 0000                  byte_69D86:	dc.b 0,	0, 0, 0
00982B44                            Level_SYZ3:	incbin	levels\syz3.bin
00982C9E                            		even
00982C9E 0000 0000                  byte_69EE4:	dc.b 0,	0, 0, 0
00982CA2 0000 0000                  byte_69EE8:	dc.b 0,	0, 0, 0
00982CA6                            
00982CA6                            Level_SBZ1:	incbin	levels\sbz1.bin
00982DC8                            		even
00982DC8                            Level_SBZ1bg:	incbin	levels\sbz1bg.bin
00982E06                            		even
00982E06                            Level_SBZ2:	incbin	levels\sbz2.bin
00982F48                            		even
00982F48                            Level_SBZ2bg:	incbin	levels\sbz2bg.bin
009830B2                            		even
009830B2 0000 0000                  byte_6A2F8:	dc.b 0,	0, 0, 0
009830B6 0000 0000                  byte_6A2FC:	dc.b 0,	0, 0, 0
009830BA                            Level_End:	incbin	levels\ending.bin
009830DA                            		even
009830DA 0000 0000                  byte_6A320:	dc.b 0,	0, 0, 0
009830DE                            
009830DE                            
009830DE                            Art_BigRing:	incbin	"artunc\Giant Ring.bin"
00983D1E                            		even
00983D1E                            
00983D1E                            ; ---------------------------------------------------------------------------
00983D1E                            ; Sprite locations index
00983D1E                            ; ---------------------------------------------------------------------------
00983D1E 0000 0000                  ObjPos_Index:	dc.w ObjPos_GHZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D22 0000 0000                  		dc.w ObjPos_GHZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D26 0000 0000                  		dc.w ObjPos_GHZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D2A 0000 0000                  		dc.w ObjPos_GHZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D2E 0000 0000                  		dc.w ObjPos_LZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D32 0000 0000                  		dc.w ObjPos_LZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D36 0000 0000                  		dc.w ObjPos_LZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D3A 0000 0000                  		dc.w ObjPos_SBZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D3E 0000 0000                  		dc.w ObjPos_MZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D42 0000 0000                  		dc.w ObjPos_MZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D46 0000 0000                  		dc.w ObjPos_MZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D4A 0000 0000                  		dc.w ObjPos_MZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D4E 0000 0000                  		dc.w ObjPos_SLZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D52 0000 0000                  		dc.w ObjPos_SLZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D56 0000 0000                  		dc.w ObjPos_SLZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D5A 0000 0000                  		dc.w ObjPos_SLZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D5E 0000 0000                  		dc.w ObjPos_SYZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D62 0000 0000                  		dc.w ObjPos_SYZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D66 0000 0000                  		dc.w ObjPos_SYZ3-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D6A 0000 0000                  		dc.w ObjPos_SYZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D6E 0000 0000                  		dc.w ObjPos_SBZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D72 0000 0000                  		dc.w ObjPos_SBZ2-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D76 0000 0000                  		dc.w ObjPos_FZ-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D7A 0000 0000                  		dc.w ObjPos_SBZ1-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D7E 0000 0000                  		dc.w ObjPos_End-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D82 0000 0000                  		dc.w ObjPos_End-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D86 0000 0000                  		dc.w ObjPos_End-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D8A 0000 0000                  		dc.w ObjPos_End-ObjPos_Index, ObjPos_Null-ObjPos_Index
00983D8E                            		; --- Put extra object data here. ---
00983D8E                            
00983D8E 0000 0000                  		dc.w ObjPos_LZ1pf1-ObjPos_Index, ObjPos_LZ1pf2-ObjPos_Index
00983D92 0000 0000                  		dc.w ObjPos_LZ2pf1-ObjPos_Index, ObjPos_LZ2pf2-ObjPos_Index
00983D96 0000 0000                  		dc.w ObjPos_LZ3pf1-ObjPos_Index, ObjPos_LZ3pf2-ObjPos_Index
00983D9A 0000 0000                  		dc.w ObjPos_LZ1pf1-ObjPos_Index, ObjPos_LZ1pf2-ObjPos_Index
00983D9E 0000 0000                  		dc.w ObjPos_SBZ1pf1-ObjPos_Index, ObjPos_SBZ1pf2-ObjPos_Index
00983DA2 0000 0000                  		dc.w ObjPos_SBZ1pf3-ObjPos_Index, ObjPos_SBZ1pf4-ObjPos_Index
00983DA6 0000 0000                  		dc.w ObjPos_SBZ1pf5-ObjPos_Index, ObjPos_SBZ1pf6-ObjPos_Index
00983DAA 0000 0000                  		dc.w ObjPos_SBZ1pf1-ObjPos_Index, ObjPos_SBZ1pf2-ObjPos_Index
00983DAE FFFF 0000 0000             		dc.b $FF, $FF, 0, 0, 0,	0
00983DB4                            ObjPos_GHZ1:	incbin	objpos\ghz1.bin
009842BE                            		even
009842BE                            ObjPos_GHZ2:	incbin	objpos\ghz2.bin
0098487C                            		even
0098487C                            ObjPos_GHZ3:
0098487C                            		incbin	"objpos\ghz3 (JP1).bin"
00984F36                            		even
00984F36                            ObjPos_LZ1:
00984F36                            		incbin	"objpos\lz1 (JP1).bin"
009853AA                            		even
009853AA                            ObjPos_LZ2:	incbin	objpos\lz2.bin
009856EC                            		even
009856EC                            ObjPos_LZ3:	incbin	"objpos\lz3 (JP1).bin"
00985CB0                            		even
00985CB0                            ObjPos_SBZ3:	incbin	objpos\sbz3.bin
0098614E                            		even
0098614E                            ObjPos_LZ1pf1:	incbin	objpos\lz1pf1.bin
00986180                            		even
00986180                            ObjPos_LZ1pf2:	incbin	objpos\lz1pf2.bin
009861B2                            		even
009861B2                            ObjPos_LZ2pf1:	incbin	objpos\lz2pf1.bin
009861E4                            		even
009861E4                            ObjPos_LZ2pf2:	incbin	objpos\lz2pf2.bin
00986216                            		even
00986216                            ObjPos_LZ3pf1:	incbin	objpos\lz3pf1.bin
00986260                            		even
00986260                            ObjPos_LZ3pf2:	incbin	objpos\lz3pf2.bin
0098629E                            		even
0098629E                            ObjPos_MZ1:
0098629E                            		incbin	"objpos\mz1 (JP1).bin"
0098660A                            		even
0098660A                            ObjPos_MZ2:	incbin	objpos\mz2.bin
00986AB4                            		even
00986AB4                            ObjPos_MZ3:	incbin	objpos\mz3.bin
0098702A                            		even
0098702A                            ObjPos_SLZ1:	incbin	objpos\slz1.bin
00987564                            		even
00987564                            ObjPos_SLZ2:	incbin	objpos\slz2.bin
009879C6                            		even
009879C6                            ObjPos_SLZ3:	incbin	objpos\slz3.bin
00987FA2                            		even
00987FA2                            ObjPos_SYZ1:	incbin	objpos\syz1.bin
0098842E                            		even
0098842E                            ObjPos_SYZ2:	incbin	objpos\syz2.bin
00988998                            		even
00988998                            ObjPos_SYZ3:	incbin	"objpos\syz3 (JP1).bin"
00988FA4                            		even
00988FA4                            ObjPos_SBZ1:
00988FA4                            		incbin	"objpos\sbz1 (JP1).bin"
009896E8                            		even
009896E8                            ObjPos_SBZ2:	incbin	objpos\sbz2.bin
00989DD2                            		even
00989DD2                            ObjPos_FZ:	incbin	objpos\fz.bin
00989DE4                            		even
00989DE4                            ObjPos_SBZ1pf1:	incbin	objpos\sbz1pf1.bin
00989E16                            		even
00989E16                            ObjPos_SBZ1pf2:	incbin	objpos\sbz1pf2.bin
00989E48                            		even
00989E48                            ObjPos_SBZ1pf3:	incbin	objpos\sbz1pf3.bin
00989E7A                            		even
00989E7A                            ObjPos_SBZ1pf4:	incbin	objpos\sbz1pf4.bin
00989EAC                            		even
00989EAC                            ObjPos_SBZ1pf5:	incbin	objpos\sbz1pf5.bin
00989EDE                            		even
00989EDE                            ObjPos_SBZ1pf6:	incbin	objpos\sbz1pf6.bin
00989F16                            		even
00989F16                            ObjPos_End:	incbin	objpos\ending.bin
0098A072                            		even
0098A072 FFFF 0000 0000             ObjPos_Null:	dc.b $FF, $FF, 0, 0, 0,	0		
0098A078                            		
0098A078                            		OBJEND
0018A078                            
0018A078                            ; end of 'ROM'
0018A078                            
0018A078                            ; ---------------------------------------------------------------------------
0018A078                            ; Start of Bank 2 [Contains 32X data to be used by the SH-2
0018A078                            ; ---------------------------------------------------------------------------
00200000                            		obj $02200000 	; 2MB within 32X ROM
02200000                            EndOfRom: 
